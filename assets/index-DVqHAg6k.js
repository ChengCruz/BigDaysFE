var E2=e=>{throw TypeError(e)};var im=(e,t,r)=>t.has(e)||E2("Cannot "+r);var ae=(e,t,r)=>(im(e,t,"read from private field"),r?r.call(e):t.get(e)),Ye=(e,t,r)=>t.has(e)?E2("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ge=(e,t,r,a)=>(im(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),mt=(e,t,r)=>(im(e,t,"access private method"),r);var Af=(e,t,r,a)=>({set _(n){Ge(e,t,n,r)},get _(){return ae(e,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function UT(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),r}var lm={exports:{}},n0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _2;function zT(){if(_2)return n0;_2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,l){var o=null;if(l!==void 0&&(o=""+l),n.key!==void 0&&(o=""+n.key),"key"in n){l={};for(var u in n)u!=="key"&&(l[u]=n[u])}else l=n;return n=l.ref,{$$typeof:e,type:a,key:o,ref:n!==void 0?n:null,props:l}}return n0.Fragment=t,n0.jsx=r,n0.jsxs=r,n0}var k2;function HT(){return k2||(k2=1,lm.exports=zT()),lm.exports}var f=HT(),om={exports:{}},ht={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T2;function GT(){if(T2)return ht;T2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function v(B){return B===null||typeof B!="object"?null:(B=g&&B[g]||B["@@iterator"],typeof B=="function"?B:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function E(B,Z,L){this.props=B,this.context=Z,this.refs=w,this.updater=L||b}E.prototype.isReactComponent={},E.prototype.setState=function(B,Z){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Z,"setState")},E.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function k(){}k.prototype=E.prototype;function N(B,Z,L){this.props=B,this.context=Z,this.refs=w,this.updater=L||b}var _=N.prototype=new k;_.constructor=N,y(_,E.prototype),_.isPureReactComponent=!0;var R=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function T(B,Z,L,G,V,Q){return L=Q.ref,{$$typeof:e,type:B,key:Z,ref:L!==void 0?L:null,props:Q}}function F(B,Z){return T(B.type,Z,void 0,void 0,void 0,B.props)}function O(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function U(B){var Z={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(L){return Z[L]})}var q=/\/+/g;function z(B,Z){return typeof B=="object"&&B!==null&&B.key!=null?U(""+B.key):Z.toString(36)}function te(){}function ce(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(te,te):(B.status="pending",B.then(function(Z){B.status==="pending"&&(B.status="fulfilled",B.value=Z)},function(Z){B.status==="pending"&&(B.status="rejected",B.reason=Z)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function de(B,Z,L,G,V){var Q=typeof B;(Q==="undefined"||Q==="boolean")&&(B=null);var le=!1;if(B===null)le=!0;else switch(Q){case"bigint":case"string":case"number":le=!0;break;case"object":switch(B.$$typeof){case e:case t:le=!0;break;case m:return le=B._init,de(le(B._payload),Z,L,G,V)}}if(le)return V=V(B),le=G===""?"."+z(B,0):G,R(V)?(L="",le!=null&&(L=le.replace(q,"$&/")+"/"),de(V,Z,L,"",function(Ne){return Ne})):V!=null&&(O(V)&&(V=F(V,L+(V.key==null||B&&B.key===V.key?"":(""+V.key).replace(q,"$&/")+"/")+le)),Z.push(V)),1;le=0;var _e=G===""?".":G+":";if(R(B))for(var Ee=0;Ee<B.length;Ee++)G=B[Ee],Q=_e+z(G,Ee),le+=de(G,Z,L,Q,V);else if(Ee=v(B),typeof Ee=="function")for(B=Ee.call(B),Ee=0;!(G=B.next()).done;)G=G.value,Q=_e+z(G,Ee++),le+=de(G,Z,L,Q,V);else if(Q==="object"){if(typeof B.then=="function")return de(ce(B),Z,L,G,V);throw Z=String(B),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return le}function ee(B,Z,L){if(B==null)return B;var G=[],V=0;return de(B,G,"","",function(Q){return Z.call(L,Q,V++)}),G}function ie(B){if(B._status===-1){var Z=B._result;Z=Z(),Z.then(function(L){(B._status===0||B._status===-1)&&(B._status=1,B._result=L)},function(L){(B._status===0||B._status===-1)&&(B._status=2,B._result=L)}),B._status===-1&&(B._status=0,B._result=Z)}if(B._status===1)return B._result.default;throw B._result}var Te=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)};function ne(){}return ht.Children={map:ee,forEach:function(B,Z,L){ee(B,function(){Z.apply(this,arguments)},L)},count:function(B){var Z=0;return ee(B,function(){Z++}),Z},toArray:function(B){return ee(B,function(Z){return Z})||[]},only:function(B){if(!O(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},ht.Component=E,ht.Fragment=r,ht.Profiler=n,ht.PureComponent=N,ht.StrictMode=a,ht.Suspense=h,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ht.__COMPILER_RUNTIME={__proto__:null,c:function(B){return A.H.useMemoCache(B)}},ht.cache=function(B){return function(){return B.apply(null,arguments)}},ht.cloneElement=function(B,Z,L){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var G=y({},B.props),V=B.key,Q=void 0;if(Z!=null)for(le in Z.ref!==void 0&&(Q=void 0),Z.key!==void 0&&(V=""+Z.key),Z)!D.call(Z,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&Z.ref===void 0||(G[le]=Z[le]);var le=arguments.length-2;if(le===1)G.children=L;else if(1<le){for(var _e=Array(le),Ee=0;Ee<le;Ee++)_e[Ee]=arguments[Ee+2];G.children=_e}return T(B.type,V,void 0,void 0,Q,G)},ht.createContext=function(B){return B={$$typeof:o,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},ht.createElement=function(B,Z,L){var G,V={},Q=null;if(Z!=null)for(G in Z.key!==void 0&&(Q=""+Z.key),Z)D.call(Z,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(V[G]=Z[G]);var le=arguments.length-2;if(le===1)V.children=L;else if(1<le){for(var _e=Array(le),Ee=0;Ee<le;Ee++)_e[Ee]=arguments[Ee+2];V.children=_e}if(B&&B.defaultProps)for(G in le=B.defaultProps,le)V[G]===void 0&&(V[G]=le[G]);return T(B,Q,void 0,void 0,null,V)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(B){return{$$typeof:u,render:B}},ht.isValidElement=O,ht.lazy=function(B){return{$$typeof:m,_payload:{_status:-1,_result:B},_init:ie}},ht.memo=function(B,Z){return{$$typeof:x,type:B,compare:Z===void 0?null:Z}},ht.startTransition=function(B){var Z=A.T,L={};A.T=L;try{var G=B(),V=A.S;V!==null&&V(L,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(ne,Te)}catch(Q){Te(Q)}finally{A.T=Z}},ht.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ht.use=function(B){return A.H.use(B)},ht.useActionState=function(B,Z,L){return A.H.useActionState(B,Z,L)},ht.useCallback=function(B,Z){return A.H.useCallback(B,Z)},ht.useContext=function(B){return A.H.useContext(B)},ht.useDebugValue=function(){},ht.useDeferredValue=function(B,Z){return A.H.useDeferredValue(B,Z)},ht.useEffect=function(B,Z,L){var G=A.H;if(typeof L=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return G.useEffect(B,Z)},ht.useId=function(){return A.H.useId()},ht.useImperativeHandle=function(B,Z,L){return A.H.useImperativeHandle(B,Z,L)},ht.useInsertionEffect=function(B,Z){return A.H.useInsertionEffect(B,Z)},ht.useLayoutEffect=function(B,Z){return A.H.useLayoutEffect(B,Z)},ht.useMemo=function(B,Z){return A.H.useMemo(B,Z)},ht.useOptimistic=function(B,Z){return A.H.useOptimistic(B,Z)},ht.useReducer=function(B,Z,L){return A.H.useReducer(B,Z,L)},ht.useRef=function(B){return A.H.useRef(B)},ht.useState=function(B){return A.H.useState(B)},ht.useSyncExternalStore=function(B,Z,L){return A.H.useSyncExternalStore(B,Z,L)},ht.useTransition=function(){return A.H.useTransition()},ht.version="19.1.0",ht}var N2;function Q0(){return N2||(N2=1,om.exports=GT()),om.exports}var C=Q0();const Oi=sS(C);var cm={exports:{}},s0={},um={exports:{}},fm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2;function VT(){return C2||(C2=1,function(e){function t(ee,ie){var Te=ee.length;ee.push(ie);e:for(;0<Te;){var ne=Te-1>>>1,B=ee[ne];if(0<n(B,ie))ee[ne]=ie,ee[Te]=B,Te=ne;else break e}}function r(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var ie=ee[0],Te=ee.pop();if(Te!==ie){ee[0]=Te;e:for(var ne=0,B=ee.length,Z=B>>>1;ne<Z;){var L=2*(ne+1)-1,G=ee[L],V=L+1,Q=ee[V];if(0>n(G,Te))V<B&&0>n(Q,G)?(ee[ne]=Q,ee[V]=Te,ne=V):(ee[ne]=G,ee[L]=Te,ne=L);else if(V<B&&0>n(Q,Te))ee[ne]=Q,ee[V]=Te,ne=V;else break e}}return ie}function n(ee,ie){var Te=ee.sortIndex-ie.sortIndex;return Te!==0?Te:ee.id-ie.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var h=[],x=[],m=1,g=null,v=3,b=!1,y=!1,w=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function R(ee){for(var ie=r(x);ie!==null;){if(ie.callback===null)a(x);else if(ie.startTime<=ee)a(x),ie.sortIndex=ie.expirationTime,t(h,ie);else break;ie=r(x)}}function A(ee){if(w=!1,R(ee),!y)if(r(h)!==null)y=!0,D||(D=!0,z());else{var ie=r(x);ie!==null&&de(A,ie.startTime-ee)}}var D=!1,T=-1,F=5,O=-1;function U(){return E?!0:!(e.unstable_now()-O<F)}function q(){if(E=!1,D){var ee=e.unstable_now();O=ee;var ie=!0;try{e:{y=!1,w&&(w=!1,N(T),T=-1),b=!0;var Te=v;try{t:{for(R(ee),g=r(h);g!==null&&!(g.expirationTime>ee&&U());){var ne=g.callback;if(typeof ne=="function"){g.callback=null,v=g.priorityLevel;var B=ne(g.expirationTime<=ee);if(ee=e.unstable_now(),typeof B=="function"){g.callback=B,R(ee),ie=!0;break t}g===r(h)&&a(h),R(ee)}else a(h);g=r(h)}if(g!==null)ie=!0;else{var Z=r(x);Z!==null&&de(A,Z.startTime-ee),ie=!1}}break e}finally{g=null,v=Te,b=!1}ie=void 0}}finally{ie?z():D=!1}}}var z;if(typeof _=="function")z=function(){_(q)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ce=te.port2;te.port1.onmessage=q,z=function(){ce.postMessage(null)}}else z=function(){k(q,0)};function de(ee,ie){T=k(function(){ee(e.unstable_now())},ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(ee){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var Te=v;v=ie;try{return ee()}finally{v=Te}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(ee,ie){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Te=v;v=ee;try{return ie()}finally{v=Te}},e.unstable_scheduleCallback=function(ee,ie,Te){var ne=e.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?ne+Te:ne):Te=ne,ee){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Te+B,ee={id:m++,callback:ie,priorityLevel:ee,startTime:Te,expirationTime:B,sortIndex:-1},Te>ne?(ee.sortIndex=Te,t(x,ee),r(h)===null&&ee===r(x)&&(w?(N(T),T=-1):w=!0,de(A,Te-ne))):(ee.sortIndex=B,t(h,ee),y||b||(y=!0,D||(D=!0,z()))),ee},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(ee){var ie=v;return function(){var Te=v;v=ie;try{return ee.apply(this,arguments)}finally{v=Te}}}}(fm)),fm}var A2;function qT(){return A2||(A2=1,um.exports=VT()),um.exports}var dm={exports:{}},ia={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j2;function WT(){if(j2)return ia;j2=1;var e=Q0();function t(h){var x="https://react.dev/errors/"+h;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)x+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function l(h,x,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:g==null?null:""+g,children:h,containerInfo:x,implementation:m}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,x){if(h==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return ia.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ia.createPortal=function(h,x){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return l(h,x,null,m)},ia.flushSync=function(h){var x=o.T,m=a.p;try{if(o.T=null,a.p=2,h)return h()}finally{o.T=x,a.p=m,a.d.f()}},ia.preconnect=function(h,x){typeof h=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,a.d.C(h,x))},ia.prefetchDNS=function(h){typeof h=="string"&&a.d.D(h)},ia.preinit=function(h,x){if(typeof h=="string"&&x&&typeof x.as=="string"){var m=x.as,g=u(m,x.crossOrigin),v=typeof x.integrity=="string"?x.integrity:void 0,b=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;m==="style"?a.d.S(h,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:b}):m==="script"&&a.d.X(h,{crossOrigin:g,integrity:v,fetchPriority:b,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},ia.preinitModule=function(h,x){if(typeof h=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var m=u(x.as,x.crossOrigin);a.d.M(h,{crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&a.d.M(h)},ia.preload=function(h,x){if(typeof h=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var m=x.as,g=u(m,x.crossOrigin);a.d.L(h,m,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},ia.preloadModule=function(h,x){if(typeof h=="string")if(x){var m=u(x.as,x.crossOrigin);a.d.m(h,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else a.d.m(h)},ia.requestFormReset=function(h){a.d.r(h)},ia.unstable_batchedUpdates=function(h,x){return h(x)},ia.useFormState=function(h,x,m){return o.H.useFormState(h,x,m)},ia.useFormStatus=function(){return o.H.useHostTransitionStatus()},ia.version="19.1.0",ia}var R2;function Cd(){if(R2)return dm.exports;R2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),dm.exports=WT(),dm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D2;function XT(){if(D2)return s0;D2=1;var e=qT(),t=Q0(),r=Cd();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function u(s){if(l(s)!==s)throw Error(a(188))}function h(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(a(188));return i!==s?null:s}for(var c=s,d=i;;){var p=c.return;if(p===null)break;var S=p.alternate;if(S===null){if(d=p.return,d!==null){c=d;continue}break}if(p.child===S.child){for(S=p.child;S;){if(S===c)return u(p),s;if(S===d)return u(p),i;S=S.sibling}throw Error(a(188))}if(c.return!==d.return)c=p,d=S;else{for(var j=!1,P=p.child;P;){if(P===c){j=!0,c=p,d=S;break}if(P===d){j=!0,d=p,c=S;break}P=P.sibling}if(!j){for(P=S.child;P;){if(P===c){j=!0,c=S,d=p;break}if(P===d){j=!0,d=S,c=p;break}P=P.sibling}if(!j)throw Error(a(189))}}if(c.alternate!==d)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?s:i}function x(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=x(s),i!==null)return i;s=s.sibling}return null}var m=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),_=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var te=Symbol.for("react.client.reference");function ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===te?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case y:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case O:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case _:return(s.displayName||"Context")+".Provider";case N:return(s._context.displayName||"Context")+".Consumer";case R:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return i=s.displayName||null,i!==null?i:ce(s.type)||"Memo";case F:i=s._payload,s=s._init;try{return ce(s(i))}catch{}}return null}var de=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},ne=[],B=-1;function Z(s){return{current:s}}function L(s){0>B||(s.current=ne[B],ne[B]=null,B--)}function G(s,i){B++,ne[B]=s.current,s.current=i}var V=Z(null),Q=Z(null),le=Z(null),_e=Z(null);function Ee(s,i){switch(G(le,i),G(Q,s),G(V,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?Qy(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=Qy(i),s=Zy(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}L(V),G(V,s)}function Ne(){L(V),L(Q),L(le)}function Re(s){s.memoizedState!==null&&G(_e,s);var i=V.current,c=Zy(i,s.type);i!==c&&(G(Q,s),G(V,c))}function Ze(s){Q.current===s&&(L(V),L(Q)),_e.current===s&&(L(_e),Jc._currentValue=Te)}var K=Object.prototype.hasOwnProperty,Ae=e.unstable_scheduleCallback,lt=e.unstable_cancelCallback,kt=e.unstable_shouldYield,ot=e.unstable_requestPaint,Oe=e.unstable_now,Wt=e.unstable_getCurrentPriorityLevel,fr=e.unstable_ImmediatePriority,Kr=e.unstable_UserBlockingPriority,Hr=e.unstable_NormalPriority,Ca=e.unstable_LowPriority,Pe=e.unstable_IdlePriority,pt=e.log,dr=e.unstable_setDisableYieldValue,yr=null,lr=null;function Ft(s){if(typeof pt=="function"&&dr(s),lr&&typeof lr.setStrictMode=="function")try{lr.setStrictMode(yr,s)}catch{}}var st=Math.clz32?Math.clz32:na,ct=Math.log,Jt=Math.LN2;function na(s){return s>>>=0,s===0?32:31-(ct(s)/Jt|0)|0}var Xt=256,Aa=4194304;function za(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Gs(s,i,c){var d=s.pendingLanes;if(d===0)return 0;var p=0,S=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var P=d&134217727;return P!==0?(d=P&~S,d!==0?p=za(d):(j&=P,j!==0?p=za(j):c||(c=P&~s,c!==0&&(p=za(c))))):(P=d&~S,P!==0?p=za(P):j!==0?p=za(j):c||(c=d&~s,c!==0&&(p=za(c)))),p===0?0:i!==0&&i!==p&&(i&S)===0&&(S=p&-p,c=i&-i,S>=c||S===32&&(c&4194048)!==0)?i:p}function us(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Gl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vs(){var s=Xt;return Xt<<=1,(Xt&4194048)===0&&(Xt=256),s}function qs(){var s=Aa;return Aa<<=1,(Aa&62914560)===0&&(Aa=4194304),s}function Ws(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function re(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ue(s,i,c,d,p,S){var j=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var P=s.entanglements,J=s.expirationTimes,he=s.hiddenUpdates;for(c=j&~c;0<c;){var Se=31-st(c),Ce=1<<Se;P[Se]=0,J[Se]=-1;var pe=he[Se];if(pe!==null)for(he[Se]=null,Se=0;Se<pe.length;Se++){var ve=pe[Se];ve!==null&&(ve.lane&=-536870913)}c&=~Ce}d!==0&&$e(s,d,0),S!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=S&~(j&~i))}function $e(s,i,c){s.pendingLanes|=i,s.suspendedLanes&=~i;var d=31-st(i);s.entangledLanes|=i,s.entanglements[d]=s.entanglements[d]|1073741824|c&4194090}function Xe(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var d=31-st(c),p=1<<d;p&i|s[d]&i&&(s[d]|=i),c&=~p}}function rt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $t(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function br(){var s=ie.p;return s!==0?s:(s=window.event,s===void 0?32:g2(s.type))}function Xs(s,i){var c=ie.p;try{return ie.p=s,i()}finally{ie.p=c}}var Ha=Math.random().toString(36).slice(2),wr="__reactFiber$"+Ha,Sr="__reactProps$"+Ha,Nn="__reactContainer$"+Ha,fc="__reactEvents$"+Ha,rh="__reactListeners$"+Ha,M="__reactHandles$"+Ha,X="__reactResources$"+Ha,I="__reactMarker$"+Ha;function H(s){delete s[wr],delete s[Sr],delete s[fc],delete s[rh],delete s[M]}function W(s){var i=s[wr];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Nn]||c[wr]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=r2(s);s!==null;){if(c=s[wr])return c;s=r2(s)}return i}s=c,c=s.parentNode}return null}function Y(s){if(s=s[wr]||s[Nn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function xe(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function be(s){var i=s[X];return i||(i=s[X]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ue(s){s[I]=!0}var me=new Set,ge={};function De(s,i){Le(s,i),Le(s+"Capture",i)}function Le(s,i){for(ge[s]=i,s=0;s<i.length;s++)me.add(i[s])}var He=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},ze={};function it(s){return K.call(ze,s)?!0:K.call(Me,s)?!1:He.test(s)?ze[s]=!0:(Me[s]=!0,!1)}function Ut(s,i,c){if(it(i))if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+c)}}function zt(s,i,c){if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+c)}}function Kt(s,i,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(i,c,""+d)}}var fs,Ys;function rn(s){if(fs===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);fs=i&&i[1]||"",Ys=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fs+s+Ys}var Cn=!1;function Wi(s,i){if(!s||Cn)return"";Cn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(ve){var pe=ve}Reflect.construct(s,[],Ce)}else{try{Ce.call()}catch(ve){pe=ve}s.call(Ce.prototype)}}else{try{throw Error()}catch(ve){pe=ve}(Ce=s())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(ve){if(ve&&pe&&typeof ve.stack=="string")return[ve.stack,pe.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=d.DetermineComponentFrameRoot(),j=S[0],P=S[1];if(j&&P){var J=j.split(`
`),he=P.split(`
`);for(p=d=0;d<J.length&&!J[d].includes("DetermineComponentFrameRoot");)d++;for(;p<he.length&&!he[p].includes("DetermineComponentFrameRoot");)p++;if(d===J.length||p===he.length)for(d=J.length-1,p=he.length-1;1<=d&&0<=p&&J[d]!==he[p];)p--;for(;1<=d&&0<=p;d--,p--)if(J[d]!==he[p]){if(d!==1||p!==1)do if(d--,p--,0>p||J[d]!==he[p]){var Se=`
`+J[d].replace(" at new "," at ");return s.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",s.displayName)),Se}while(1<=d&&0<=p);break}}}finally{Cn=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?rn(c):""}function An(s){switch(s.tag){case 26:case 27:case 5:return rn(s.type);case 16:return rn("Lazy");case 13:return rn("Suspense");case 19:return rn("SuspenseList");case 0:case 15:return Wi(s.type,!1);case 11:return Wi(s.type.render,!1);case 1:return Wi(s.type,!0);case 31:return rn("Activity");default:return""}}function qg(s){try{var i="";do i+=An(s),s=s.return;while(s);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function an(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Wg(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function M_(s){var i=Wg(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),d=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,S=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return p.call(this)},set:function(j){d=""+j,S.call(this,j)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(j){d=""+j},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function bu(s){s._valueTracker||(s._valueTracker=M_(s))}function Xg(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return s&&(d=Wg(s)?s.checked?"true":"false":s.value),s=d,s!==c?(i.setValue(s),!0):!1}function wu(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var L_=/[\n"\\]/g;function nn(s){return s.replace(L_,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function ah(s,i,c,d,p,S,j,P){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),i!=null?j==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+an(i)):s.value!==""+an(i)&&(s.value=""+an(i)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),i!=null?nh(s,j,an(i)):c!=null?nh(s,j,an(c)):d!=null&&s.removeAttribute("value"),p==null&&S!=null&&(s.defaultChecked=!!S),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?s.name=""+an(P):s.removeAttribute("name")}function Yg(s,i,c,d,p,S,j,P){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.type=S),i!=null||c!=null){if(!(S!=="submit"&&S!=="reset"||i!=null))return;c=c!=null?""+an(c):"",i=i!=null?""+an(i):c,P||i===s.value||(s.value=i),s.defaultValue=i}d=d??p,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=P?s.checked:!!d,s.defaultChecked=!!d,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j)}function nh(s,i,c){i==="number"&&wu(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Vl(s,i,c,d){if(s=s.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<s.length;c++)p=i.hasOwnProperty("$"+s[c].value),s[c].selected!==p&&(s[c].selected=p),p&&d&&(s[c].defaultSelected=!0)}else{for(c=""+an(c),i=null,p=0;p<s.length;p++){if(s[p].value===c){s[p].selected=!0,d&&(s[p].defaultSelected=!0);return}i!==null||s[p].disabled||(i=s[p])}i!==null&&(i.selected=!0)}}function $g(s,i,c){if(i!=null&&(i=""+an(i),i!==s.value&&(s.value=i),c==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=c!=null?""+an(c):""}function Kg(s,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(a(92));if(de(d)){if(1<d.length)throw Error(a(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=an(i),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d)}function ql(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var B_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qg(s,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":d?s.setProperty(i,c):typeof c!="number"||c===0||B_.has(i)?i==="float"?s.cssFloat=c:s[i]=(""+c).trim():s[i]=c+"px"}function Zg(s,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var p in i)d=i[p],i.hasOwnProperty(p)&&c[p]!==d&&Qg(s,p,d)}else for(var S in i)i.hasOwnProperty(S)&&Qg(s,S,i[S])}function sh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),I_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Su(s){return I_.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ih=null;function lh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Wl=null,Xl=null;function Jg(s){var i=Y(s);if(i&&(s=i.stateNode)){var c=s[Sr]||null;e:switch(s=i.stateNode,i.type){case"input":if(ah(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+nn(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==s&&d.form===s.form){var p=d[Sr]||null;if(!p)throw Error(a(90));ah(d,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===s.form&&Xg(d)}break e;case"textarea":$g(s,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Vl(s,!!c.multiple,i,!1)}}}var oh=!1;function e1(s,i,c){if(oh)return s(i,c);oh=!0;try{var d=s(i);return d}finally{if(oh=!1,(Wl!==null||Xl!==null)&&(of(),Wl&&(i=Wl,s=Xl,Xl=Wl=null,Jg(i),s)))for(i=0;i<s.length;i++)Jg(s[i])}}function dc(s,i){var c=s.stateNode;if(c===null)return null;var d=c[Sr]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ch=!1;if(ds)try{var hc={};Object.defineProperty(hc,"passive",{get:function(){ch=!0}}),window.addEventListener("test",hc,hc),window.removeEventListener("test",hc,hc)}catch{ch=!1}var $s=null,uh=null,Eu=null;function t1(){if(Eu)return Eu;var s,i=uh,c=i.length,d,p="value"in $s?$s.value:$s.textContent,S=p.length;for(s=0;s<c&&i[s]===p[s];s++);var j=c-s;for(d=1;d<=j&&i[c-d]===p[S-d];d++);return Eu=p.slice(s,1<d?1-d:void 0)}function _u(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ku(){return!0}function r1(){return!1}function ja(s){function i(c,d,p,S,j){this._reactName=c,this._targetInst=p,this.type=d,this.nativeEvent=S,this.target=j,this.currentTarget=null;for(var P in s)s.hasOwnProperty(P)&&(c=s[P],this[P]=c?c(S):S[P]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?ku:r1,this.isPropagationStopped=r1,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ku)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ku)},persist:function(){},isPersistent:ku}),i}var Xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tu=ja(Xi),xc=m({},Xi,{view:0,detail:0}),U_=ja(xc),fh,dh,mc,Nu=m({},xc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==mc&&(mc&&s.type==="mousemove"?(fh=s.screenX-mc.screenX,dh=s.screenY-mc.screenY):dh=fh=0,mc=s),fh)},movementY:function(s){return"movementY"in s?s.movementY:dh}}),a1=ja(Nu),z_=m({},Nu,{dataTransfer:0}),H_=ja(z_),G_=m({},xc,{relatedTarget:0}),hh=ja(G_),V_=m({},Xi,{animationName:0,elapsedTime:0,pseudoElement:0}),q_=ja(V_),W_=m({},Xi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),X_=ja(W_),Y_=m({},Xi,{data:0}),n1=ja(Y_),$_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},K_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z_(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Q_[s])?!!i[s]:!1}function xh(){return Z_}var J_=m({},xc,{key:function(s){if(s.key){var i=$_[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=_u(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?K_[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xh,charCode:function(s){return s.type==="keypress"?_u(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?_u(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ek=ja(J_),tk=m({},Nu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s1=ja(tk),rk=m({},xc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xh}),ak=ja(rk),nk=m({},Xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),sk=ja(nk),ik=m({},Nu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),lk=ja(ik),ok=m({},Xi,{newState:0,oldState:0}),ck=ja(ok),uk=[9,13,27,32],mh=ds&&"CompositionEvent"in window,pc=null;ds&&"documentMode"in document&&(pc=document.documentMode);var fk=ds&&"TextEvent"in window&&!pc,i1=ds&&(!mh||pc&&8<pc&&11>=pc),l1=" ",o1=!1;function c1(s,i){switch(s){case"keyup":return uk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u1(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Yl=!1;function dk(s,i){switch(s){case"compositionend":return u1(i);case"keypress":return i.which!==32?null:(o1=!0,l1);case"textInput":return s=i.data,s===l1&&o1?null:s;default:return null}}function hk(s,i){if(Yl)return s==="compositionend"||!mh&&c1(s,i)?(s=t1(),Eu=uh=$s=null,Yl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return i1&&i.locale!=="ko"?null:i.data;default:return null}}var xk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function f1(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!xk[s.type]:i==="textarea"}function d1(s,i,c,d){Wl?Xl?Xl.push(d):Xl=[d]:Wl=d,i=xf(i,"onChange"),0<i.length&&(c=new Tu("onChange","change",null,c,d),s.push({event:c,listeners:i}))}var gc=null,vc=null;function mk(s){Wy(s,0)}function Cu(s){var i=xe(s);if(Xg(i))return s}function h1(s,i){if(s==="change")return i}var x1=!1;if(ds){var ph;if(ds){var gh="oninput"in document;if(!gh){var m1=document.createElement("div");m1.setAttribute("oninput","return;"),gh=typeof m1.oninput=="function"}ph=gh}else ph=!1;x1=ph&&(!document.documentMode||9<document.documentMode)}function p1(){gc&&(gc.detachEvent("onpropertychange",g1),vc=gc=null)}function g1(s){if(s.propertyName==="value"&&Cu(vc)){var i=[];d1(i,vc,s,lh(s)),e1(mk,i)}}function pk(s,i,c){s==="focusin"?(p1(),gc=i,vc=c,gc.attachEvent("onpropertychange",g1)):s==="focusout"&&p1()}function gk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Cu(vc)}function vk(s,i){if(s==="click")return Cu(i)}function yk(s,i){if(s==="input"||s==="change")return Cu(i)}function bk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ga=typeof Object.is=="function"?Object.is:bk;function yc(s,i){if(Ga(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var p=c[d];if(!K.call(i,p)||!Ga(s[p],i[p]))return!1}return!0}function v1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function y1(s,i){var c=v1(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=i&&d>=i)return{node:c,offset:i-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=v1(c)}}function b1(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?b1(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function w1(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=wu(s.document);i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=wu(s.document)}return i}function vh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var wk=ds&&"documentMode"in document&&11>=document.documentMode,$l=null,yh=null,bc=null,bh=!1;function S1(s,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;bh||$l==null||$l!==wu(d)||(d=$l,"selectionStart"in d&&vh(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),bc&&yc(bc,d)||(bc=d,d=xf(yh,"onSelect"),0<d.length&&(i=new Tu("onSelect","select",null,i,c),s.push({event:i,listeners:d}),i.target=$l)))}function Yi(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var Kl={animationend:Yi("Animation","AnimationEnd"),animationiteration:Yi("Animation","AnimationIteration"),animationstart:Yi("Animation","AnimationStart"),transitionrun:Yi("Transition","TransitionRun"),transitionstart:Yi("Transition","TransitionStart"),transitioncancel:Yi("Transition","TransitionCancel"),transitionend:Yi("Transition","TransitionEnd")},wh={},E1={};ds&&(E1=document.createElement("div").style,"AnimationEvent"in window||(delete Kl.animationend.animation,delete Kl.animationiteration.animation,delete Kl.animationstart.animation),"TransitionEvent"in window||delete Kl.transitionend.transition);function $i(s){if(wh[s])return wh[s];if(!Kl[s])return s;var i=Kl[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in E1)return wh[s]=i[c];return s}var _1=$i("animationend"),k1=$i("animationiteration"),T1=$i("animationstart"),Sk=$i("transitionrun"),Ek=$i("transitionstart"),_k=$i("transitioncancel"),N1=$i("transitionend"),C1=new Map,Sh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Sh.push("scrollEnd");function jn(s,i){C1.set(s,i),De(i,[s])}var A1=new WeakMap;function sn(s,i){if(typeof s=="object"&&s!==null){var c=A1.get(s);return c!==void 0?c:(i={value:s,source:i,stack:qg(i)},A1.set(s,i),i)}return{value:s,source:i,stack:qg(i)}}var ln=[],Ql=0,Eh=0;function Au(){for(var s=Ql,i=Eh=Ql=0;i<s;){var c=ln[i];ln[i++]=null;var d=ln[i];ln[i++]=null;var p=ln[i];ln[i++]=null;var S=ln[i];if(ln[i++]=null,d!==null&&p!==null){var j=d.pending;j===null?p.next=p:(p.next=j.next,j.next=p),d.pending=p}S!==0&&j1(c,p,S)}}function ju(s,i,c,d){ln[Ql++]=s,ln[Ql++]=i,ln[Ql++]=c,ln[Ql++]=d,Eh|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function _h(s,i,c,d){return ju(s,i,c,d),Ru(s)}function Zl(s,i){return ju(s,null,null,i),Ru(s)}function j1(s,i,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var p=!1,S=s.return;S!==null;)S.childLanes|=c,d=S.alternate,d!==null&&(d.childLanes|=c),S.tag===22&&(s=S.stateNode,s===null||s._visibility&1||(p=!0)),s=S,S=S.return;return s.tag===3?(S=s.stateNode,p&&i!==null&&(p=31-st(c),s=S.hiddenUpdates,d=s[p],d===null?s[p]=[i]:d.push(i),i.lane=c|536870912),S):null}function Ru(s){if(50<qc)throw qc=0,jx=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Jl={};function kk(s,i,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Va(s,i,c,d){return new kk(s,i,c,d)}function kh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function hs(s,i){var c=s.alternate;return c===null?(c=Va(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function R1(s,i){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,i=c.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Du(s,i,c,d,p,S){var j=0;if(d=s,typeof s=="function")kh(s)&&(j=1);else if(typeof s=="string")j=NT(s,c,V.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case O:return s=Va(31,c,i,p),s.elementType=O,s.lanes=S,s;case y:return Ki(c.children,p,S,i);case w:j=8,p|=24;break;case E:return s=Va(12,c,i,p|2),s.elementType=E,s.lanes=S,s;case A:return s=Va(13,c,i,p),s.elementType=A,s.lanes=S,s;case D:return s=Va(19,c,i,p),s.elementType=D,s.lanes=S,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case k:case _:j=10;break e;case N:j=9;break e;case R:j=11;break e;case T:j=14;break e;case F:j=16,d=null;break e}j=29,c=Error(a(130,s===null?"null":typeof s,"")),d=null}return i=Va(j,c,i,p),i.elementType=s,i.type=d,i.lanes=S,i}function Ki(s,i,c,d){return s=Va(7,s,d,i),s.lanes=c,s}function Th(s,i,c){return s=Va(6,s,null,i),s.lanes=c,s}function Nh(s,i,c){return i=Va(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var eo=[],to=0,Fu=null,Ou=0,on=[],cn=0,Qi=null,xs=1,ms="";function Zi(s,i){eo[to++]=Ou,eo[to++]=Fu,Fu=s,Ou=i}function D1(s,i,c){on[cn++]=xs,on[cn++]=ms,on[cn++]=Qi,Qi=s;var d=xs;s=ms;var p=32-st(d)-1;d&=~(1<<p),c+=1;var S=32-st(i)+p;if(30<S){var j=p-p%5;S=(d&(1<<j)-1).toString(32),d>>=j,p-=j,xs=1<<32-st(i)+p|c<<p|d,ms=S+s}else xs=1<<S|c<<p|d,ms=s}function Ch(s){s.return!==null&&(Zi(s,1),D1(s,1,0))}function Ah(s){for(;s===Fu;)Fu=eo[--to],eo[to]=null,Ou=eo[--to],eo[to]=null;for(;s===Qi;)Qi=on[--cn],on[cn]=null,ms=on[--cn],on[cn]=null,xs=on[--cn],on[cn]=null}var ga=null,hr=null,Dt=!1,Ji=null,Wn=!1,jh=Error(a(519));function el(s){var i=Error(a(418,""));throw Ec(sn(i,s)),jh}function F1(s){var i=s.stateNode,c=s.type,d=s.memoizedProps;switch(i[wr]=s,i[Sr]=d,c){case"dialog":St("cancel",i),St("close",i);break;case"iframe":case"object":case"embed":St("load",i);break;case"video":case"audio":for(c=0;c<Xc.length;c++)St(Xc[c],i);break;case"source":St("error",i);break;case"img":case"image":case"link":St("error",i),St("load",i);break;case"details":St("toggle",i);break;case"input":St("invalid",i),Yg(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),bu(i);break;case"select":St("invalid",i);break;case"textarea":St("invalid",i),Kg(i,d.value,d.defaultValue,d.children),bu(i)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||Ky(i.textContent,c)?(d.popover!=null&&(St("beforetoggle",i),St("toggle",i)),d.onScroll!=null&&St("scroll",i),d.onScrollEnd!=null&&St("scrollend",i),d.onClick!=null&&(i.onclick=mf),i=!0):i=!1,i||el(s)}function O1(s){for(ga=s.return;ga;)switch(ga.tag){case 5:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:ga=ga.return}}function wc(s){if(s!==ga)return!1;if(!Dt)return O1(s),Dt=!0,!1;var i=s.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||Wx(s.type,s.memoizedProps)),c=!c),c&&hr&&el(s),O1(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(i===0){hr=Dn(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;s=s.nextSibling}hr=null}}else i===27?(i=hr,fi(s.type)?(s=Kx,Kx=null,hr=s):hr=i):hr=ga?Dn(s.stateNode.nextSibling):null;return!0}function Sc(){hr=ga=null,Dt=!1}function M1(){var s=Ji;return s!==null&&(Fa===null?Fa=s:Fa.push.apply(Fa,s),Ji=null),s}function Ec(s){Ji===null?Ji=[s]:Ji.push(s)}var Rh=Z(null),tl=null,ps=null;function Ks(s,i,c){G(Rh,i._currentValue),i._currentValue=c}function gs(s){s._currentValue=Rh.current,L(Rh)}function Dh(s,i,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===c)break;s=s.return}}function Fh(s,i,c,d){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var S=p.dependencies;if(S!==null){var j=p.child;S=S.firstContext;e:for(;S!==null;){var P=S;S=p;for(var J=0;J<i.length;J++)if(P.context===i[J]){S.lanes|=c,P=S.alternate,P!==null&&(P.lanes|=c),Dh(S.return,c,s),d||(j=null);break e}S=P.next}}else if(p.tag===18){if(j=p.return,j===null)throw Error(a(341));j.lanes|=c,S=j.alternate,S!==null&&(S.lanes|=c),Dh(j,c,s),j=null}else j=p.child;if(j!==null)j.return=p;else for(j=p;j!==null;){if(j===s){j=null;break}if(p=j.sibling,p!==null){p.return=j.return,j=p;break}j=j.return}p=j}}function _c(s,i,c,d){s=null;for(var p=i,S=!1;p!==null;){if(!S){if((p.flags&524288)!==0)S=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var j=p.alternate;if(j===null)throw Error(a(387));if(j=j.memoizedProps,j!==null){var P=p.type;Ga(p.pendingProps.value,j.value)||(s!==null?s.push(P):s=[P])}}else if(p===_e.current){if(j=p.alternate,j===null)throw Error(a(387));j.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(Jc):s=[Jc])}p=p.return}s!==null&&Fh(i,s,c,d),i.flags|=262144}function Mu(s){for(s=s.firstContext;s!==null;){if(!Ga(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function rl(s){tl=s,ps=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function sa(s){return L1(tl,s)}function Lu(s,i){return tl===null&&rl(s),L1(s,i)}function L1(s,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},ps===null){if(s===null)throw Error(a(308));ps=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else ps=ps.next=i;return c}var Tk=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){i.aborted=!0,s.forEach(function(c){return c()})}},Nk=e.unstable_scheduleCallback,Ck=e.unstable_NormalPriority,Lr={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Oh(){return{controller:new Tk,data:new Map,refCount:0}}function kc(s){s.refCount--,s.refCount===0&&Nk(Ck,function(){s.controller.abort()})}var Tc=null,Mh=0,ro=0,ao=null;function Ak(s,i){if(Tc===null){var c=Tc=[];Mh=0,ro=Bx(),ao={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Mh++,i.then(B1,B1),i}function B1(){if(--Mh===0&&Tc!==null){ao!==null&&(ao.status="fulfilled");var s=Tc;Tc=null,ro=0,ao=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function jk(s,i){var c=[],d={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return s.then(function(){d.status="fulfilled",d.value=i;for(var p=0;p<c.length;p++)(0,c[p])(i)},function(p){for(d.status="rejected",d.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),d}var P1=ee.S;ee.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&Ak(s,i),P1!==null&&P1(s,i)};var al=Z(null);function Lh(){var s=al.current;return s!==null?s:Qt.pooledCache}function Bu(s,i){i===null?G(al,al.current):G(al,i.pool)}function I1(){var s=Lh();return s===null?null:{parent:Lr._currentValue,pool:s}}var Nc=Error(a(460)),U1=Error(a(474)),Pu=Error(a(542)),Bh={then:function(){}};function z1(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Iu(){}function H1(s,i,c){switch(c=s[c],c===void 0?s.push(i):c!==i&&(i.then(Iu,Iu),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,V1(s),s;default:if(typeof i.status=="string")i.then(Iu,Iu);else{if(s=Qt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(d){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=d}},function(d){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,V1(s),s}throw Cc=i,Nc}}var Cc=null;function G1(){if(Cc===null)throw Error(a(459));var s=Cc;return Cc=null,s}function V1(s){if(s===Nc||s===Pu)throw Error(a(483))}var Qs=!1;function Ph(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ih(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Zs(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Js(s,i,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Mt&2)!==0){var p=d.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i,i=Ru(s),j1(s,null,c),i}return ju(s,d,i,c),Ru(s)}function Ac(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,Xe(s,c)}}function Uh(s,i){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var p=null,S=null;if(c=c.firstBaseUpdate,c!==null){do{var j={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};S===null?p=S=j:S=S.next=j,c=c.next}while(c!==null);S===null?p=S=i:S=S.next=i}else p=S=i;c={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:S,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}var zh=!1;function jc(){if(zh){var s=ao;if(s!==null)throw s}}function Rc(s,i,c,d){zh=!1;var p=s.updateQueue;Qs=!1;var S=p.firstBaseUpdate,j=p.lastBaseUpdate,P=p.shared.pending;if(P!==null){p.shared.pending=null;var J=P,he=J.next;J.next=null,j===null?S=he:j.next=he,j=J;var Se=s.alternate;Se!==null&&(Se=Se.updateQueue,P=Se.lastBaseUpdate,P!==j&&(P===null?Se.firstBaseUpdate=he:P.next=he,Se.lastBaseUpdate=J))}if(S!==null){var Ce=p.baseState;j=0,Se=he=J=null,P=S;do{var pe=P.lane&-536870913,ve=pe!==P.lane;if(ve?(Tt&pe)===pe:(d&pe)===pe){pe!==0&&pe===ro&&(zh=!0),Se!==null&&(Se=Se.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var at=s,Ke=P;pe=i;var Vt=c;switch(Ke.tag){case 1:if(at=Ke.payload,typeof at=="function"){Ce=at.call(Vt,Ce,pe);break e}Ce=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=Ke.payload,pe=typeof at=="function"?at.call(Vt,Ce,pe):at,pe==null)break e;Ce=m({},Ce,pe);break e;case 2:Qs=!0}}pe=P.callback,pe!==null&&(s.flags|=64,ve&&(s.flags|=8192),ve=p.callbacks,ve===null?p.callbacks=[pe]:ve.push(pe))}else ve={lane:pe,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Se===null?(he=Se=ve,J=Ce):Se=Se.next=ve,j|=pe;if(P=P.next,P===null){if(P=p.shared.pending,P===null)break;ve=P,P=ve.next,ve.next=null,p.lastBaseUpdate=ve,p.shared.pending=null}}while(!0);Se===null&&(J=Ce),p.baseState=J,p.firstBaseUpdate=he,p.lastBaseUpdate=Se,S===null&&(p.shared.lanes=0),li|=j,s.lanes=j,s.memoizedState=Ce}}function q1(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function W1(s,i){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)q1(c[s],i)}var no=Z(null),Uu=Z(0);function X1(s,i){s=_s,G(Uu,s),G(no,i),_s=s|i.baseLanes}function Hh(){G(Uu,_s),G(no,no.current)}function Gh(){_s=Uu.current,L(no),L(Uu)}var ei=0,gt=null,Ht=null,jr=null,zu=!1,so=!1,nl=!1,Hu=0,Dc=0,io=null,Rk=0;function Er(){throw Error(a(321))}function Vh(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!Ga(s[c],i[c]))return!1;return!0}function qh(s,i,c,d,p,S){return ei=S,gt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ee.H=s===null||s.memoizedState===null?jv:Rv,nl=!1,S=c(d,p),nl=!1,so&&(S=$1(i,c,d,p)),Y1(s),S}function Y1(s){ee.H=Yu;var i=Ht!==null&&Ht.next!==null;if(ei=0,jr=Ht=gt=null,zu=!1,Dc=0,io=null,i)throw Error(a(300));s===null||Gr||(s=s.dependencies,s!==null&&Mu(s)&&(Gr=!0))}function $1(s,i,c,d){gt=s;var p=0;do{if(so&&(io=null),Dc=0,so=!1,25<=p)throw Error(a(301));if(p+=1,jr=Ht=null,s.updateQueue!=null){var S=s.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}ee.H=Pk,S=i(c,d)}while(so);return S}function Dk(){var s=ee.H,i=s.useState()[0];return i=typeof i.then=="function"?Fc(i):i,s=s.useState()[0],(Ht!==null?Ht.memoizedState:null)!==s&&(gt.flags|=1024),i}function Wh(){var s=Hu!==0;return Hu=0,s}function Xh(s,i,c){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~c}function Yh(s){if(zu){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}zu=!1}ei=0,jr=Ht=gt=null,so=!1,Dc=Hu=0,io=null}function Ra(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?gt.memoizedState=jr=s:jr=jr.next=s,jr}function Rr(){if(Ht===null){var s=gt.alternate;s=s!==null?s.memoizedState:null}else s=Ht.next;var i=jr===null?gt.memoizedState:jr.next;if(i!==null)jr=i,Ht=s;else{if(s===null)throw gt.alternate===null?Error(a(467)):Error(a(310));Ht=s,s={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},jr===null?gt.memoizedState=jr=s:jr=jr.next=s}return jr}function $h(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Fc(s){var i=Dc;return Dc+=1,io===null&&(io=[]),s=H1(io,s,i),i=gt,(jr===null?i.memoizedState:jr.next)===null&&(i=i.alternate,ee.H=i===null||i.memoizedState===null?jv:Rv),s}function Gu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Fc(s);if(s.$$typeof===_)return sa(s)}throw Error(a(438,String(s)))}function Kh(s){var i=null,c=gt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=gt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=$h(),gt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(s),d=0;d<s;d++)c[d]=U;return i.index++,c}function vs(s,i){return typeof i=="function"?i(s):i}function Vu(s){var i=Rr();return Qh(i,Ht,s)}function Qh(s,i,c){var d=s.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=c;var p=s.baseQueue,S=d.pending;if(S!==null){if(p!==null){var j=p.next;p.next=S.next,S.next=j}i.baseQueue=p=S,d.pending=null}if(S=s.baseState,p===null)s.memoizedState=S;else{i=p.next;var P=j=null,J=null,he=i,Se=!1;do{var Ce=he.lane&-536870913;if(Ce!==he.lane?(Tt&Ce)===Ce:(ei&Ce)===Ce){var pe=he.revertLane;if(pe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Ce===ro&&(Se=!0);else if((ei&pe)===pe){he=he.next,pe===ro&&(Se=!0);continue}else Ce={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},J===null?(P=J=Ce,j=S):J=J.next=Ce,gt.lanes|=pe,li|=pe;Ce=he.action,nl&&c(S,Ce),S=he.hasEagerState?he.eagerState:c(S,Ce)}else pe={lane:Ce,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},J===null?(P=J=pe,j=S):J=J.next=pe,gt.lanes|=Ce,li|=Ce;he=he.next}while(he!==null&&he!==i);if(J===null?j=S:J.next=P,!Ga(S,s.memoizedState)&&(Gr=!0,Se&&(c=ao,c!==null)))throw c;s.memoizedState=S,s.baseState=j,s.baseQueue=J,d.lastRenderedState=S}return p===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Zh(s){var i=Rr(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=s;var d=c.dispatch,p=c.pending,S=i.memoizedState;if(p!==null){c.pending=null;var j=p=p.next;do S=s(S,j.action),j=j.next;while(j!==p);Ga(S,i.memoizedState)||(Gr=!0),i.memoizedState=S,i.baseQueue===null&&(i.baseState=S),c.lastRenderedState=S}return[S,d]}function K1(s,i,c){var d=gt,p=Rr(),S=Dt;if(S){if(c===void 0)throw Error(a(407));c=c()}else c=i();var j=!Ga((Ht||p).memoizedState,c);j&&(p.memoizedState=c,Gr=!0),p=p.queue;var P=J1.bind(null,d,p,s);if(Oc(2048,8,P,[s]),p.getSnapshot!==i||j||jr!==null&&jr.memoizedState.tag&1){if(d.flags|=2048,lo(9,qu(),Z1.bind(null,d,p,c,i),null),Qt===null)throw Error(a(349));S||(ei&124)!==0||Q1(d,i,c)}return c}function Q1(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=gt.updateQueue,i===null?(i=$h(),gt.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function Z1(s,i,c,d){i.value=c,i.getSnapshot=d,ev(i)&&tv(s)}function J1(s,i,c){return c(function(){ev(i)&&tv(s)})}function ev(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!Ga(s,c)}catch{return!0}}function tv(s){var i=Zl(s,2);i!==null&&$a(i,s,2)}function Jh(s){var i=Ra();if(typeof s=="function"){var c=s;if(s=c(),nl){Ft(!0);try{c()}finally{Ft(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:s},i}function rv(s,i,c,d){return s.baseState=c,Qh(s,Ht,typeof d=="function"?d:vs)}function Fk(s,i,c,d,p){if(Xu(s))throw Error(a(485));if(s=i.action,s!==null){var S={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){S.listeners.push(j)}};ee.T!==null?c(!0):S.isTransition=!1,d(S),c=i.pending,c===null?(S.next=i.pending=S,av(i,S)):(S.next=c.next,i.pending=c.next=S)}}function av(s,i){var c=i.action,d=i.payload,p=s.state;if(i.isTransition){var S=ee.T,j={};ee.T=j;try{var P=c(p,d),J=ee.S;J!==null&&J(j,P),nv(s,i,P)}catch(he){ex(s,i,he)}finally{ee.T=S}}else try{S=c(p,d),nv(s,i,S)}catch(he){ex(s,i,he)}}function nv(s,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){sv(s,i,d)},function(d){return ex(s,i,d)}):sv(s,i,c)}function sv(s,i,c){i.status="fulfilled",i.value=c,iv(i),s.state=c,i=s.pending,i!==null&&(c=i.next,c===i?s.pending=null:(c=c.next,i.next=c,av(s,c)))}function ex(s,i,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,iv(i),i=i.next;while(i!==d)}s.action=null}function iv(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function lv(s,i){return i}function ov(s,i){if(Dt){var c=Qt.formState;if(c!==null){e:{var d=gt;if(Dt){if(hr){t:{for(var p=hr,S=Wn;p.nodeType!==8;){if(!S){p=null;break t}if(p=Dn(p.nextSibling),p===null){p=null;break t}}S=p.data,p=S==="F!"||S==="F"?p:null}if(p){hr=Dn(p.nextSibling),d=p.data==="F!";break e}}el(d)}d=!1}d&&(i=c[0])}}return c=Ra(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lv,lastRenderedState:i},c.queue=d,c=Nv.bind(null,gt,d),d.dispatch=c,d=Jh(!1),S=sx.bind(null,gt,!1,d.queue),d=Ra(),p={state:i,dispatch:null,action:s,pending:null},d.queue=p,c=Fk.bind(null,gt,p,S,c),p.dispatch=c,d.memoizedState=s,[i,c,!1]}function cv(s){var i=Rr();return uv(i,Ht,s)}function uv(s,i,c){if(i=Qh(s,i,lv)[0],s=Vu(vs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Fc(i)}catch(j){throw j===Nc?Pu:j}else d=i;i=Rr();var p=i.queue,S=p.dispatch;return c!==i.memoizedState&&(gt.flags|=2048,lo(9,qu(),Ok.bind(null,p,c),null)),[d,S,s]}function Ok(s,i){s.action=i}function fv(s){var i=Rr(),c=Ht;if(c!==null)return uv(i,c,s);Rr(),i=i.memoizedState,c=Rr();var d=c.queue.dispatch;return c.memoizedState=s,[i,d,!1]}function lo(s,i,c,d){return s={tag:s,create:c,deps:d,inst:i,next:null},i=gt.updateQueue,i===null&&(i=$h(),gt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,i.lastEffect=s),s}function qu(){return{destroy:void 0,resource:void 0}}function dv(){return Rr().memoizedState}function Wu(s,i,c,d){var p=Ra();d=d===void 0?null:d,gt.flags|=s,p.memoizedState=lo(1|i,qu(),c,d)}function Oc(s,i,c,d){var p=Rr();d=d===void 0?null:d;var S=p.memoizedState.inst;Ht!==null&&d!==null&&Vh(d,Ht.memoizedState.deps)?p.memoizedState=lo(i,S,c,d):(gt.flags|=s,p.memoizedState=lo(1|i,S,c,d))}function hv(s,i){Wu(8390656,8,s,i)}function xv(s,i){Oc(2048,8,s,i)}function mv(s,i){return Oc(4,2,s,i)}function pv(s,i){return Oc(4,4,s,i)}function gv(s,i){if(typeof i=="function"){s=s();var c=i(s);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function vv(s,i,c){c=c!=null?c.concat([s]):null,Oc(4,4,gv.bind(null,i,s),c)}function tx(){}function yv(s,i){var c=Rr();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&Vh(i,d[1])?d[0]:(c.memoizedState=[s,i],s)}function bv(s,i){var c=Rr();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&Vh(i,d[1]))return d[0];if(d=s(),nl){Ft(!0);try{s()}finally{Ft(!1)}}return c.memoizedState=[d,i],d}function rx(s,i,c){return c===void 0||(ei&1073741824)!==0?s.memoizedState=i:(s.memoizedState=c,s=Ey(),gt.lanes|=s,li|=s,c)}function wv(s,i,c,d){return Ga(c,i)?c:no.current!==null?(s=rx(s,c,d),Ga(s,i)||(Gr=!0),s):(ei&42)===0?(Gr=!0,s.memoizedState=c):(s=Ey(),gt.lanes|=s,li|=s,i)}function Sv(s,i,c,d,p){var S=ie.p;ie.p=S!==0&&8>S?S:8;var j=ee.T,P={};ee.T=P,sx(s,!1,i,c);try{var J=p(),he=ee.S;if(he!==null&&he(P,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var Se=jk(J,d);Mc(s,i,Se,Ya(s))}else Mc(s,i,d,Ya(s))}catch(Ce){Mc(s,i,{then:function(){},status:"rejected",reason:Ce},Ya())}finally{ie.p=S,ee.T=j}}function Mk(){}function ax(s,i,c,d){if(s.tag!==5)throw Error(a(476));var p=Ev(s).queue;Sv(s,p,i,Te,c===null?Mk:function(){return _v(s),c(d)})}function Ev(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:Te},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vs,lastRenderedState:c},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function _v(s){var i=Ev(s).next.queue;Mc(s,i,{},Ya())}function nx(){return sa(Jc)}function kv(){return Rr().memoizedState}function Tv(){return Rr().memoizedState}function Lk(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var c=Ya();s=Zs(c);var d=Js(i,s,c);d!==null&&($a(d,i,c),Ac(d,i,c)),i={cache:Oh()},s.payload=i;return}i=i.return}}function Bk(s,i,c){var d=Ya();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Xu(s)?Cv(i,c):(c=_h(s,i,c,d),c!==null&&($a(c,s,d),Av(c,i,d)))}function Nv(s,i,c){var d=Ya();Mc(s,i,c,d)}function Mc(s,i,c,d){var p={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Xu(s))Cv(i,p);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=i.lastRenderedReducer,S!==null))try{var j=i.lastRenderedState,P=S(j,c);if(p.hasEagerState=!0,p.eagerState=P,Ga(P,j))return ju(s,i,p,0),Qt===null&&Au(),!1}catch{}finally{}if(c=_h(s,i,p,d),c!==null)return $a(c,s,d),Av(c,i,d),!0}return!1}function sx(s,i,c,d){if(d={lane:2,revertLane:Bx(),action:d,hasEagerState:!1,eagerState:null,next:null},Xu(s)){if(i)throw Error(a(479))}else i=_h(s,c,d,2),i!==null&&$a(i,s,2)}function Xu(s){var i=s.alternate;return s===gt||i!==null&&i===gt}function Cv(s,i){so=zu=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function Av(s,i,c){if((c&4194048)!==0){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,Xe(s,c)}}var Yu={readContext:sa,use:Gu,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useLayoutEffect:Er,useInsertionEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useSyncExternalStore:Er,useId:Er,useHostTransitionStatus:Er,useFormState:Er,useActionState:Er,useOptimistic:Er,useMemoCache:Er,useCacheRefresh:Er},jv={readContext:sa,use:Gu,useCallback:function(s,i){return Ra().memoizedState=[s,i===void 0?null:i],s},useContext:sa,useEffect:hv,useImperativeHandle:function(s,i,c){c=c!=null?c.concat([s]):null,Wu(4194308,4,gv.bind(null,i,s),c)},useLayoutEffect:function(s,i){return Wu(4194308,4,s,i)},useInsertionEffect:function(s,i){Wu(4,2,s,i)},useMemo:function(s,i){var c=Ra();i=i===void 0?null:i;var d=s();if(nl){Ft(!0);try{s()}finally{Ft(!1)}}return c.memoizedState=[d,i],d},useReducer:function(s,i,c){var d=Ra();if(c!==void 0){var p=c(i);if(nl){Ft(!0);try{c(i)}finally{Ft(!1)}}}else p=i;return d.memoizedState=d.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},d.queue=s,s=s.dispatch=Bk.bind(null,gt,s),[d.memoizedState,s]},useRef:function(s){var i=Ra();return s={current:s},i.memoizedState=s},useState:function(s){s=Jh(s);var i=s.queue,c=Nv.bind(null,gt,i);return i.dispatch=c,[s.memoizedState,c]},useDebugValue:tx,useDeferredValue:function(s,i){var c=Ra();return rx(c,s,i)},useTransition:function(){var s=Jh(!1);return s=Sv.bind(null,gt,s.queue,!0,!1),Ra().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,c){var d=gt,p=Ra();if(Dt){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),Qt===null)throw Error(a(349));(Tt&124)!==0||Q1(d,i,c)}p.memoizedState=c;var S={value:c,getSnapshot:i};return p.queue=S,hv(J1.bind(null,d,S,s),[s]),d.flags|=2048,lo(9,qu(),Z1.bind(null,d,S,c,i),null),c},useId:function(){var s=Ra(),i=Qt.identifierPrefix;if(Dt){var c=ms,d=xs;c=(d&~(1<<32-st(d)-1)).toString(32)+c,i=""+i+"R"+c,c=Hu++,0<c&&(i+="H"+c.toString(32)),i+=""}else c=Rk++,i=""+i+"r"+c.toString(32)+"";return s.memoizedState=i},useHostTransitionStatus:nx,useFormState:ov,useActionState:ov,useOptimistic:function(s){var i=Ra();i.memoizedState=i.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=sx.bind(null,gt,!0,c),c.dispatch=i,[s,i]},useMemoCache:Kh,useCacheRefresh:function(){return Ra().memoizedState=Lk.bind(null,gt)}},Rv={readContext:sa,use:Gu,useCallback:yv,useContext:sa,useEffect:xv,useImperativeHandle:vv,useInsertionEffect:mv,useLayoutEffect:pv,useMemo:bv,useReducer:Vu,useRef:dv,useState:function(){return Vu(vs)},useDebugValue:tx,useDeferredValue:function(s,i){var c=Rr();return wv(c,Ht.memoizedState,s,i)},useTransition:function(){var s=Vu(vs)[0],i=Rr().memoizedState;return[typeof s=="boolean"?s:Fc(s),i]},useSyncExternalStore:K1,useId:kv,useHostTransitionStatus:nx,useFormState:cv,useActionState:cv,useOptimistic:function(s,i){var c=Rr();return rv(c,Ht,s,i)},useMemoCache:Kh,useCacheRefresh:Tv},Pk={readContext:sa,use:Gu,useCallback:yv,useContext:sa,useEffect:xv,useImperativeHandle:vv,useInsertionEffect:mv,useLayoutEffect:pv,useMemo:bv,useReducer:Zh,useRef:dv,useState:function(){return Zh(vs)},useDebugValue:tx,useDeferredValue:function(s,i){var c=Rr();return Ht===null?rx(c,s,i):wv(c,Ht.memoizedState,s,i)},useTransition:function(){var s=Zh(vs)[0],i=Rr().memoizedState;return[typeof s=="boolean"?s:Fc(s),i]},useSyncExternalStore:K1,useId:kv,useHostTransitionStatus:nx,useFormState:fv,useActionState:fv,useOptimistic:function(s,i){var c=Rr();return Ht!==null?rv(c,Ht,s,i):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Kh,useCacheRefresh:Tv},oo=null,Lc=0;function $u(s){var i=Lc;return Lc+=1,oo===null&&(oo=[]),H1(oo,s,i)}function Bc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function Ku(s,i){throw i.$$typeof===g?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Dv(s){var i=s._init;return i(s._payload)}function Fv(s){function i(oe,se){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[se],oe.flags|=16):fe.push(se)}}function c(oe,se){if(!s)return null;for(;se!==null;)i(oe,se),se=se.sibling;return null}function d(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function p(oe,se){return oe=hs(oe,se),oe.index=0,oe.sibling=null,oe}function S(oe,se,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<se?(oe.flags|=67108866,se):fe):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function j(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function P(oe,se,fe,ke){return se===null||se.tag!==6?(se=Th(fe,oe.mode,ke),se.return=oe,se):(se=p(se,fe),se.return=oe,se)}function J(oe,se,fe,ke){var Ve=fe.type;return Ve===y?Se(oe,se,fe.props.children,ke,fe.key):se!==null&&(se.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===F&&Dv(Ve)===se.type)?(se=p(se,fe.props),Bc(se,fe),se.return=oe,se):(se=Du(fe.type,fe.key,fe.props,null,oe.mode,ke),Bc(se,fe),se.return=oe,se)}function he(oe,se,fe,ke){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=Nh(fe,oe.mode,ke),se.return=oe,se):(se=p(se,fe.children||[]),se.return=oe,se)}function Se(oe,se,fe,ke,Ve){return se===null||se.tag!==7?(se=Ki(fe,oe.mode,ke,Ve),se.return=oe,se):(se=p(se,fe),se.return=oe,se)}function Ce(oe,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Th(""+se,oe.mode,fe),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case v:return fe=Du(se.type,se.key,se.props,null,oe.mode,fe),Bc(fe,se),fe.return=oe,fe;case b:return se=Nh(se,oe.mode,fe),se.return=oe,se;case F:var ke=se._init;return se=ke(se._payload),Ce(oe,se,fe)}if(de(se)||z(se))return se=Ki(se,oe.mode,fe,null),se.return=oe,se;if(typeof se.then=="function")return Ce(oe,$u(se),fe);if(se.$$typeof===_)return Ce(oe,Lu(oe,se),fe);Ku(oe,se)}return null}function pe(oe,se,fe,ke){var Ve=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Ve!==null?null:P(oe,se,""+fe,ke);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case v:return fe.key===Ve?J(oe,se,fe,ke):null;case b:return fe.key===Ve?he(oe,se,fe,ke):null;case F:return Ve=fe._init,fe=Ve(fe._payload),pe(oe,se,fe,ke)}if(de(fe)||z(fe))return Ve!==null?null:Se(oe,se,fe,ke,null);if(typeof fe.then=="function")return pe(oe,se,$u(fe),ke);if(fe.$$typeof===_)return pe(oe,se,Lu(oe,fe),ke);Ku(oe,fe)}return null}function ve(oe,se,fe,ke,Ve){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return oe=oe.get(fe)||null,P(se,oe,""+ke,Ve);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case v:return oe=oe.get(ke.key===null?fe:ke.key)||null,J(se,oe,ke,Ve);case b:return oe=oe.get(ke.key===null?fe:ke.key)||null,he(se,oe,ke,Ve);case F:var yt=ke._init;return ke=yt(ke._payload),ve(oe,se,fe,ke,Ve)}if(de(ke)||z(ke))return oe=oe.get(fe)||null,Se(se,oe,ke,Ve,null);if(typeof ke.then=="function")return ve(oe,se,fe,$u(ke),Ve);if(ke.$$typeof===_)return ve(oe,se,fe,Lu(se,ke),Ve);Ku(se,ke)}return null}function at(oe,se,fe,ke){for(var Ve=null,yt=null,qe=se,Je=se=0,qr=null;qe!==null&&Je<fe.length;Je++){qe.index>Je?(qr=qe,qe=null):qr=qe.sibling;var jt=pe(oe,qe,fe[Je],ke);if(jt===null){qe===null&&(qe=qr);break}s&&qe&&jt.alternate===null&&i(oe,qe),se=S(jt,se,Je),yt===null?Ve=jt:yt.sibling=jt,yt=jt,qe=qr}if(Je===fe.length)return c(oe,qe),Dt&&Zi(oe,Je),Ve;if(qe===null){for(;Je<fe.length;Je++)qe=Ce(oe,fe[Je],ke),qe!==null&&(se=S(qe,se,Je),yt===null?Ve=qe:yt.sibling=qe,yt=qe);return Dt&&Zi(oe,Je),Ve}for(qe=d(qe);Je<fe.length;Je++)qr=ve(qe,oe,Je,fe[Je],ke),qr!==null&&(s&&qr.alternate!==null&&qe.delete(qr.key===null?Je:qr.key),se=S(qr,se,Je),yt===null?Ve=qr:yt.sibling=qr,yt=qr);return s&&qe.forEach(function(pi){return i(oe,pi)}),Dt&&Zi(oe,Je),Ve}function Ke(oe,se,fe,ke){if(fe==null)throw Error(a(151));for(var Ve=null,yt=null,qe=se,Je=se=0,qr=null,jt=fe.next();qe!==null&&!jt.done;Je++,jt=fe.next()){qe.index>Je?(qr=qe,qe=null):qr=qe.sibling;var pi=pe(oe,qe,jt.value,ke);if(pi===null){qe===null&&(qe=qr);break}s&&qe&&pi.alternate===null&&i(oe,qe),se=S(pi,se,Je),yt===null?Ve=pi:yt.sibling=pi,yt=pi,qe=qr}if(jt.done)return c(oe,qe),Dt&&Zi(oe,Je),Ve;if(qe===null){for(;!jt.done;Je++,jt=fe.next())jt=Ce(oe,jt.value,ke),jt!==null&&(se=S(jt,se,Je),yt===null?Ve=jt:yt.sibling=jt,yt=jt);return Dt&&Zi(oe,Je),Ve}for(qe=d(qe);!jt.done;Je++,jt=fe.next())jt=ve(qe,oe,Je,jt.value,ke),jt!==null&&(s&&jt.alternate!==null&&qe.delete(jt.key===null?Je:jt.key),se=S(jt,se,Je),yt===null?Ve=jt:yt.sibling=jt,yt=jt);return s&&qe.forEach(function(IT){return i(oe,IT)}),Dt&&Zi(oe,Je),Ve}function Vt(oe,se,fe,ke){if(typeof fe=="object"&&fe!==null&&fe.type===y&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case v:e:{for(var Ve=fe.key;se!==null;){if(se.key===Ve){if(Ve=fe.type,Ve===y){if(se.tag===7){c(oe,se.sibling),ke=p(se,fe.props.children),ke.return=oe,oe=ke;break e}}else if(se.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===F&&Dv(Ve)===se.type){c(oe,se.sibling),ke=p(se,fe.props),Bc(ke,fe),ke.return=oe,oe=ke;break e}c(oe,se);break}else i(oe,se);se=se.sibling}fe.type===y?(ke=Ki(fe.props.children,oe.mode,ke,fe.key),ke.return=oe,oe=ke):(ke=Du(fe.type,fe.key,fe.props,null,oe.mode,ke),Bc(ke,fe),ke.return=oe,oe=ke)}return j(oe);case b:e:{for(Ve=fe.key;se!==null;){if(se.key===Ve)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){c(oe,se.sibling),ke=p(se,fe.children||[]),ke.return=oe,oe=ke;break e}else{c(oe,se);break}else i(oe,se);se=se.sibling}ke=Nh(fe,oe.mode,ke),ke.return=oe,oe=ke}return j(oe);case F:return Ve=fe._init,fe=Ve(fe._payload),Vt(oe,se,fe,ke)}if(de(fe))return at(oe,se,fe,ke);if(z(fe)){if(Ve=z(fe),typeof Ve!="function")throw Error(a(150));return fe=Ve.call(fe),Ke(oe,se,fe,ke)}if(typeof fe.then=="function")return Vt(oe,se,$u(fe),ke);if(fe.$$typeof===_)return Vt(oe,se,Lu(oe,fe),ke);Ku(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,se!==null&&se.tag===6?(c(oe,se.sibling),ke=p(se,fe),ke.return=oe,oe=ke):(c(oe,se),ke=Th(fe,oe.mode,ke),ke.return=oe,oe=ke),j(oe)):c(oe,se)}return function(oe,se,fe,ke){try{Lc=0;var Ve=Vt(oe,se,fe,ke);return oo=null,Ve}catch(qe){if(qe===Nc||qe===Pu)throw qe;var yt=Va(29,qe,null,oe.mode);return yt.lanes=ke,yt.return=oe,yt}finally{}}}var co=Fv(!0),Ov=Fv(!1),un=Z(null),Xn=null;function ti(s){var i=s.alternate;G(Br,Br.current&1),G(un,s),Xn===null&&(i===null||no.current!==null||i.memoizedState!==null)&&(Xn=s)}function Mv(s){if(s.tag===22){if(G(Br,Br.current),G(un,s),Xn===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Xn=s)}}else ri()}function ri(){G(Br,Br.current),G(un,un.current)}function ys(s){L(un),Xn===s&&(Xn=null),L(Br)}var Br=Z(0);function Qu(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||$x(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function ix(s,i,c,d){i=s.memoizedState,c=c(d,i),c=c==null?i:m({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var lx={enqueueSetState:function(s,i,c){s=s._reactInternals;var d=Ya(),p=Zs(d);p.payload=i,c!=null&&(p.callback=c),i=Js(s,p,d),i!==null&&($a(i,s,d),Ac(i,s,d))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var d=Ya(),p=Zs(d);p.tag=1,p.payload=i,c!=null&&(p.callback=c),i=Js(s,p,d),i!==null&&($a(i,s,d),Ac(i,s,d))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=Ya(),d=Zs(c);d.tag=2,i!=null&&(d.callback=i),i=Js(s,d,c),i!==null&&($a(i,s,c),Ac(i,s,c))}};function Lv(s,i,c,d,p,S,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,S,j):i.prototype&&i.prototype.isPureReactComponent?!yc(c,d)||!yc(p,S):!0}function Bv(s,i,c,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==s&&lx.enqueueReplaceState(i,i.state,null)}function sl(s,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(s=s.defaultProps){c===i&&(c=m({},c));for(var p in s)c[p]===void 0&&(c[p]=s[p])}return c}var Zu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Pv(s){Zu(s)}function Iv(s){console.error(s)}function Uv(s){Zu(s)}function Ju(s,i){try{var c=s.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function zv(s,i,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function ox(s,i,c){return c=Zs(c),c.tag=3,c.payload={element:null},c.callback=function(){Ju(s,i)},c}function Hv(s){return s=Zs(s),s.tag=3,s}function Gv(s,i,c,d){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var S=d.value;s.payload=function(){return p(S)},s.callback=function(){zv(i,c,d)}}var j=c.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){zv(i,c,d),typeof p!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var P=d.stack;this.componentDidCatch(d.value,{componentStack:P!==null?P:""})})}function Ik(s,i,c,d,p){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&_c(i,c,p,!0),c=un.current,c!==null){switch(c.tag){case 13:return Xn===null?Dx():c.alternate===null&&xr===0&&(xr=3),c.flags&=-257,c.flags|=65536,c.lanes=p,d===Bh?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),Ox(s,d,p)),!1;case 22:return c.flags|=65536,d===Bh?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),Ox(s,d,p)),!1}throw Error(a(435,c.tag))}return Ox(s,d,p),Dx(),!1}if(Dt)return i=un.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,d!==jh&&(s=Error(a(422),{cause:d}),Ec(sn(s,c)))):(d!==jh&&(i=Error(a(423),{cause:d}),Ec(sn(i,c))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,d=sn(d,c),p=ox(s.stateNode,d,p),Uh(s,p),xr!==4&&(xr=2)),!1;var S=Error(a(520),{cause:d});if(S=sn(S,c),Vc===null?Vc=[S]:Vc.push(S),xr!==4&&(xr=2),i===null)return!0;d=sn(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,s=p&-p,c.lanes|=s,s=ox(c.stateNode,d,s),Uh(c,s),!1;case 1:if(i=c.type,S=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(oi===null||!oi.has(S))))return c.flags|=65536,p&=-p,c.lanes|=p,p=Hv(p),Gv(p,s,c,d),Uh(c,p),!1}c=c.return}while(c!==null);return!1}var Vv=Error(a(461)),Gr=!1;function Qr(s,i,c,d){i.child=s===null?Ov(i,null,c,d):co(i,s.child,c,d)}function qv(s,i,c,d,p){c=c.render;var S=i.ref;if("ref"in d){var j={};for(var P in d)P!=="ref"&&(j[P]=d[P])}else j=d;return rl(i),d=qh(s,i,c,j,S,p),P=Wh(),s!==null&&!Gr?(Xh(s,i,p),bs(s,i,p)):(Dt&&P&&Ch(i),i.flags|=1,Qr(s,i,d,p),i.child)}function Wv(s,i,c,d,p){if(s===null){var S=c.type;return typeof S=="function"&&!kh(S)&&S.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=S,Xv(s,i,S,d,p)):(s=Du(c.type,null,d,i,i.mode,p),s.ref=i.ref,s.return=i,i.child=s)}if(S=s.child,!px(s,p)){var j=S.memoizedProps;if(c=c.compare,c=c!==null?c:yc,c(j,d)&&s.ref===i.ref)return bs(s,i,p)}return i.flags|=1,s=hs(S,d),s.ref=i.ref,s.return=i,i.child=s}function Xv(s,i,c,d,p){if(s!==null){var S=s.memoizedProps;if(yc(S,d)&&s.ref===i.ref)if(Gr=!1,i.pendingProps=d=S,px(s,p))(s.flags&131072)!==0&&(Gr=!0);else return i.lanes=s.lanes,bs(s,i,p)}return cx(s,i,c,d,p)}function Yv(s,i,c){var d=i.pendingProps,p=d.children,S=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((i.flags&128)!==0){if(d=S!==null?S.baseLanes|c:c,s!==null){for(p=i.child=s.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;i.childLanes=S&~d}else i.childLanes=0,i.child=null;return $v(s,i,d,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Bu(i,S!==null?S.cachePool:null),S!==null?X1(i,S):Hh(),Mv(i);else return i.lanes=i.childLanes=536870912,$v(s,i,S!==null?S.baseLanes|c:c,c)}else S!==null?(Bu(i,S.cachePool),X1(i,S),ri(),i.memoizedState=null):(s!==null&&Bu(i,null),Hh(),ri());return Qr(s,i,p,c),i.child}function $v(s,i,c,d){var p=Lh();return p=p===null?null:{parent:Lr._currentValue,pool:p},i.memoizedState={baseLanes:c,cachePool:p},s!==null&&Bu(i,null),Hh(),Mv(i),s!==null&&_c(s,i,d,!0),null}function ef(s,i){var c=i.ref;if(c===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(s===null||s.ref!==c)&&(i.flags|=4194816)}}function cx(s,i,c,d,p){return rl(i),c=qh(s,i,c,d,void 0,p),d=Wh(),s!==null&&!Gr?(Xh(s,i,p),bs(s,i,p)):(Dt&&d&&Ch(i),i.flags|=1,Qr(s,i,c,p),i.child)}function Kv(s,i,c,d,p,S){return rl(i),i.updateQueue=null,c=$1(i,d,c,p),Y1(s),d=Wh(),s!==null&&!Gr?(Xh(s,i,S),bs(s,i,S)):(Dt&&d&&Ch(i),i.flags|=1,Qr(s,i,c,S),i.child)}function Qv(s,i,c,d,p){if(rl(i),i.stateNode===null){var S=Jl,j=c.contextType;typeof j=="object"&&j!==null&&(S=sa(j)),S=new c(d,S),i.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=lx,i.stateNode=S,S._reactInternals=i,S=i.stateNode,S.props=d,S.state=i.memoizedState,S.refs={},Ph(i),j=c.contextType,S.context=typeof j=="object"&&j!==null?sa(j):Jl,S.state=i.memoizedState,j=c.getDerivedStateFromProps,typeof j=="function"&&(ix(i,c,j,d),S.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(j=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),j!==S.state&&lx.enqueueReplaceState(S,S.state,null),Rc(i,d,S,p),jc(),S.state=i.memoizedState),typeof S.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(s===null){S=i.stateNode;var P=i.memoizedProps,J=sl(c,P);S.props=J;var he=S.context,Se=c.contextType;j=Jl,typeof Se=="object"&&Se!==null&&(j=sa(Se));var Ce=c.getDerivedStateFromProps;Se=typeof Ce=="function"||typeof S.getSnapshotBeforeUpdate=="function",P=i.pendingProps!==P,Se||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(P||he!==j)&&Bv(i,S,d,j),Qs=!1;var pe=i.memoizedState;S.state=pe,Rc(i,d,S,p),jc(),he=i.memoizedState,P||pe!==he||Qs?(typeof Ce=="function"&&(ix(i,c,Ce,d),he=i.memoizedState),(J=Qs||Lv(i,c,J,d,pe,he,j))?(Se||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=he),S.props=d,S.state=he,S.context=j,d=J):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{S=i.stateNode,Ih(s,i),j=i.memoizedProps,Se=sl(c,j),S.props=Se,Ce=i.pendingProps,pe=S.context,he=c.contextType,J=Jl,typeof he=="object"&&he!==null&&(J=sa(he)),P=c.getDerivedStateFromProps,(he=typeof P=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(j!==Ce||pe!==J)&&Bv(i,S,d,J),Qs=!1,pe=i.memoizedState,S.state=pe,Rc(i,d,S,p),jc();var ve=i.memoizedState;j!==Ce||pe!==ve||Qs||s!==null&&s.dependencies!==null&&Mu(s.dependencies)?(typeof P=="function"&&(ix(i,c,P,d),ve=i.memoizedState),(Se=Qs||Lv(i,c,Se,d,pe,ve,J)||s!==null&&s.dependencies!==null&&Mu(s.dependencies))?(he||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(d,ve,J),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(d,ve,J)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ve),S.props=d,S.state=ve,S.context=J,d=Se):(typeof S.componentDidUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),d=!1)}return S=d,ef(s,i),d=(i.flags&128)!==0,S||d?(S=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:S.render(),i.flags|=1,s!==null&&d?(i.child=co(i,s.child,null,p),i.child=co(i,null,c,p)):Qr(s,i,c,p),i.memoizedState=S.state,s=i.child):s=bs(s,i,p),s}function Zv(s,i,c,d){return Sc(),i.flags|=256,Qr(s,i,c,d),i.child}var ux={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fx(s){return{baseLanes:s,cachePool:I1()}}function dx(s,i,c){return s=s!==null?s.childLanes&~c:0,i&&(s|=fn),s}function Jv(s,i,c){var d=i.pendingProps,p=!1,S=(i.flags&128)!==0,j;if((j=S)||(j=s!==null&&s.memoizedState===null?!1:(Br.current&2)!==0),j&&(p=!0,i.flags&=-129),j=(i.flags&32)!==0,i.flags&=-33,s===null){if(Dt){if(p?ti(i):ri(),Dt){var P=hr,J;if(J=P){e:{for(J=P,P=Wn;J.nodeType!==8;){if(!P){P=null;break e}if(J=Dn(J.nextSibling),J===null){P=null;break e}}P=J}P!==null?(i.memoizedState={dehydrated:P,treeContext:Qi!==null?{id:xs,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},J=Va(18,null,null,0),J.stateNode=P,J.return=i,i.child=J,ga=i,hr=null,J=!0):J=!1}J||el(i)}if(P=i.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return $x(P)?i.lanes=32:i.lanes=536870912,null;ys(i)}return P=d.children,d=d.fallback,p?(ri(),p=i.mode,P=tf({mode:"hidden",children:P},p),d=Ki(d,p,c,null),P.return=i,d.return=i,P.sibling=d,i.child=P,p=i.child,p.memoizedState=fx(c),p.childLanes=dx(s,j,c),i.memoizedState=ux,d):(ti(i),hx(i,P))}if(J=s.memoizedState,J!==null&&(P=J.dehydrated,P!==null)){if(S)i.flags&256?(ti(i),i.flags&=-257,i=xx(s,i,c)):i.memoizedState!==null?(ri(),i.child=s.child,i.flags|=128,i=null):(ri(),p=d.fallback,P=i.mode,d=tf({mode:"visible",children:d.children},P),p=Ki(p,P,c,null),p.flags|=2,d.return=i,p.return=i,d.sibling=p,i.child=d,co(i,s.child,null,c),d=i.child,d.memoizedState=fx(c),d.childLanes=dx(s,j,c),i.memoizedState=ux,i=p);else if(ti(i),$x(P)){if(j=P.nextSibling&&P.nextSibling.dataset,j)var he=j.dgst;j=he,d=Error(a(419)),d.stack="",d.digest=j,Ec({value:d,source:null,stack:null}),i=xx(s,i,c)}else if(Gr||_c(s,i,c,!1),j=(c&s.childLanes)!==0,Gr||j){if(j=Qt,j!==null&&(d=c&-c,d=(d&42)!==0?1:rt(d),d=(d&(j.suspendedLanes|c))!==0?0:d,d!==0&&d!==J.retryLane))throw J.retryLane=d,Zl(s,d),$a(j,s,d),Vv;P.data==="$?"||Dx(),i=xx(s,i,c)}else P.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=J.treeContext,hr=Dn(P.nextSibling),ga=i,Dt=!0,Ji=null,Wn=!1,s!==null&&(on[cn++]=xs,on[cn++]=ms,on[cn++]=Qi,xs=s.id,ms=s.overflow,Qi=i),i=hx(i,d.children),i.flags|=4096);return i}return p?(ri(),p=d.fallback,P=i.mode,J=s.child,he=J.sibling,d=hs(J,{mode:"hidden",children:d.children}),d.subtreeFlags=J.subtreeFlags&65011712,he!==null?p=hs(he,p):(p=Ki(p,P,c,null),p.flags|=2),p.return=i,d.return=i,d.sibling=p,i.child=d,d=p,p=i.child,P=s.child.memoizedState,P===null?P=fx(c):(J=P.cachePool,J!==null?(he=Lr._currentValue,J=J.parent!==he?{parent:he,pool:he}:J):J=I1(),P={baseLanes:P.baseLanes|c,cachePool:J}),p.memoizedState=P,p.childLanes=dx(s,j,c),i.memoizedState=ux,d):(ti(i),c=s.child,s=c.sibling,c=hs(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,s!==null&&(j=i.deletions,j===null?(i.deletions=[s],i.flags|=16):j.push(s)),i.child=c,i.memoizedState=null,c)}function hx(s,i){return i=tf({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function tf(s,i){return s=Va(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function xx(s,i,c){return co(i,s.child,null,c),s=hx(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function ey(s,i,c){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),Dh(s.return,i,c)}function mx(s,i,c,d,p){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:p}:(S.isBackwards=i,S.rendering=null,S.renderingStartTime=0,S.last=d,S.tail=c,S.tailMode=p)}function ty(s,i,c){var d=i.pendingProps,p=d.revealOrder,S=d.tail;if(Qr(s,i,d.children,c),d=Br.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ey(s,c,i);else if(s.tag===19)ey(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(G(Br,d),p){case"forwards":for(c=i.child,p=null;c!==null;)s=c.alternate,s!==null&&Qu(s)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),mx(i,!1,p,c,S);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(s=p.alternate,s!==null&&Qu(s)===null){i.child=p;break}s=p.sibling,p.sibling=c,c=p,p=s}mx(i,!0,c,null,S);break;case"together":mx(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function bs(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),li|=i.lanes,(c&i.childLanes)===0)if(s!==null){if(_c(s,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,c=hs(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=hs(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function px(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Mu(s)))}function Uk(s,i,c){switch(i.tag){case 3:Ee(i,i.stateNode.containerInfo),Ks(i,Lr,s.memoizedState.cache),Sc();break;case 27:case 5:Re(i);break;case 4:Ee(i,i.stateNode.containerInfo);break;case 10:Ks(i,i.type,i.memoizedProps.value);break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(ti(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Jv(s,i,c):(ti(i),s=bs(s,i,c),s!==null?s.sibling:null);ti(i);break;case 19:var p=(s.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(_c(s,i,c,!1),d=(c&i.childLanes)!==0),p){if(d)return ty(s,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),G(Br,Br.current),d)break;return null;case 22:case 23:return i.lanes=0,Yv(s,i,c);case 24:Ks(i,Lr,s.memoizedState.cache)}return bs(s,i,c)}function ry(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps)Gr=!0;else{if(!px(s,c)&&(i.flags&128)===0)return Gr=!1,Uk(s,i,c);Gr=(s.flags&131072)!==0}else Gr=!1,Dt&&(i.flags&1048576)!==0&&D1(i,Ou,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var d=i.elementType,p=d._init;if(d=p(d._payload),i.type=d,typeof d=="function")kh(d)?(s=sl(d,s),i.tag=1,i=Qv(null,i,d,s,c)):(i.tag=0,i=cx(null,i,d,s,c));else{if(d!=null){if(p=d.$$typeof,p===R){i.tag=11,i=qv(null,i,d,s,c);break e}else if(p===T){i.tag=14,i=Wv(null,i,d,s,c);break e}}throw i=ce(d)||d,Error(a(306,i,""))}}return i;case 0:return cx(s,i,i.type,i.pendingProps,c);case 1:return d=i.type,p=sl(d,i.pendingProps),Qv(s,i,d,p,c);case 3:e:{if(Ee(i,i.stateNode.containerInfo),s===null)throw Error(a(387));d=i.pendingProps;var S=i.memoizedState;p=S.element,Ih(s,i),Rc(i,d,null,c);var j=i.memoizedState;if(d=j.cache,Ks(i,Lr,d),d!==S.cache&&Fh(i,[Lr],c,!0),jc(),d=j.element,S.isDehydrated)if(S={element:d,isDehydrated:!1,cache:j.cache},i.updateQueue.baseState=S,i.memoizedState=S,i.flags&256){i=Zv(s,i,d,c);break e}else if(d!==p){p=sn(Error(a(424)),i),Ec(p),i=Zv(s,i,d,c);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(hr=Dn(s.firstChild),ga=i,Dt=!0,Ji=null,Wn=!0,c=Ov(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Sc(),d===p){i=bs(s,i,c);break e}Qr(s,i,d,c)}i=i.child}return i;case 26:return ef(s,i),s===null?(c=i2(i.type,null,i.pendingProps,null))?i.memoizedState=c:Dt||(c=i.type,s=i.pendingProps,d=pf(le.current).createElement(c),d[wr]=i,d[Sr]=s,Jr(d,c,s),ue(d),i.stateNode=d):i.memoizedState=i2(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Re(i),s===null&&Dt&&(d=i.stateNode=a2(i.type,i.pendingProps,le.current),ga=i,Wn=!0,p=hr,fi(i.type)?(Kx=p,hr=Dn(d.firstChild)):hr=p),Qr(s,i,i.pendingProps.children,c),ef(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Dt&&((p=d=hr)&&(d=xT(d,i.type,i.pendingProps,Wn),d!==null?(i.stateNode=d,ga=i,hr=Dn(d.firstChild),Wn=!1,p=!0):p=!1),p||el(i)),Re(i),p=i.type,S=i.pendingProps,j=s!==null?s.memoizedProps:null,d=S.children,Wx(p,S)?d=null:j!==null&&Wx(p,j)&&(i.flags|=32),i.memoizedState!==null&&(p=qh(s,i,Dk,null,null,c),Jc._currentValue=p),ef(s,i),Qr(s,i,d,c),i.child;case 6:return s===null&&Dt&&((s=c=hr)&&(c=mT(c,i.pendingProps,Wn),c!==null?(i.stateNode=c,ga=i,hr=null,s=!0):s=!1),s||el(i)),null;case 13:return Jv(s,i,c);case 4:return Ee(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=co(i,null,d,c):Qr(s,i,d,c),i.child;case 11:return qv(s,i,i.type,i.pendingProps,c);case 7:return Qr(s,i,i.pendingProps,c),i.child;case 8:return Qr(s,i,i.pendingProps.children,c),i.child;case 12:return Qr(s,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,Ks(i,i.type,d.value),Qr(s,i,d.children,c),i.child;case 9:return p=i.type._context,d=i.pendingProps.children,rl(i),p=sa(p),d=d(p),i.flags|=1,Qr(s,i,d,c),i.child;case 14:return Wv(s,i,i.type,i.pendingProps,c);case 15:return Xv(s,i,i.type,i.pendingProps,c);case 19:return ty(s,i,c);case 31:return d=i.pendingProps,c=i.mode,d={mode:d.mode,children:d.children},s===null?(c=tf(d,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=hs(s.child,d),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return Yv(s,i,c);case 24:return rl(i),d=sa(Lr),s===null?(p=Lh(),p===null&&(p=Qt,S=Oh(),p.pooledCache=S,S.refCount++,S!==null&&(p.pooledCacheLanes|=c),p=S),i.memoizedState={parent:d,cache:p},Ph(i),Ks(i,Lr,p)):((s.lanes&c)!==0&&(Ih(s,i),Rc(i,null,null,c),jc()),p=s.memoizedState,S=i.memoizedState,p.parent!==d?(p={parent:d,cache:d},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),Ks(i,Lr,d)):(d=S.cache,Ks(i,Lr,d),d!==p.cache&&Fh(i,[Lr],c,!0))),Qr(s,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function ws(s){s.flags|=4}function ay(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!f2(i)){if(i=un.current,i!==null&&((Tt&4194048)===Tt?Xn!==null:(Tt&62914560)!==Tt&&(Tt&536870912)===0||i!==Xn))throw Cc=Bh,U1;s.flags|=8192}}function rf(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?qs():536870912,s.lanes|=i,xo|=i)}function Pc(s,i){if(!Dt)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function or(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(i)for(var p=s.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags&65011712,d|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)c|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=d,s.childLanes=c,i}function zk(s,i,c){var d=i.pendingProps;switch(Ah(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(i),null;case 1:return or(i),null;case 3:return c=i.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),gs(Lr),Ne(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(wc(i)?ws(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,M1())),or(i),null;case 26:return c=i.memoizedState,s===null?(ws(i),c!==null?(or(i),ay(i,c)):(or(i),i.flags&=-16777217)):c?c!==s.memoizedState?(ws(i),or(i),ay(i,c)):(or(i),i.flags&=-16777217):(s.memoizedProps!==d&&ws(i),or(i),i.flags&=-16777217),null;case 27:Ze(i),c=le.current;var p=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==d&&ws(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return or(i),null}s=V.current,wc(i)?F1(i):(s=a2(p,d,c),i.stateNode=s,ws(i))}return or(i),null;case 5:if(Ze(i),c=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==d&&ws(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return or(i),null}if(s=V.current,wc(i))F1(i);else{switch(p=pf(le.current),s){case 1:s=p.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=p.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=p.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?p.createElement("select",{is:d.is}):p.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?p.createElement(c,{is:d.is}):p.createElement(c)}}s[wr]=i,s[Sr]=d;e:for(p=i.child;p!==null;){if(p.tag===5||p.tag===6)s.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break e;for(;p.sibling===null;){if(p.return===null||p.return===i)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}i.stateNode=s;e:switch(Jr(s,c,d),c){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ws(i)}}return or(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==d&&ws(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(a(166));if(s=le.current,wc(i)){if(s=i.stateNode,c=i.memoizedProps,d=null,p=ga,p!==null)switch(p.tag){case 27:case 5:d=p.memoizedProps}s[wr]=i,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Ky(s.nodeValue,c)),s||el(i)}else s=pf(s).createTextNode(d),s[wr]=i,i.stateNode=s}return or(i),null;case 13:if(d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=wc(i),d!==null&&d.dehydrated!==null){if(s===null){if(!p)throw Error(a(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(a(317));p[wr]=i}else Sc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;or(i),p=!1}else p=M1(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(ys(i),i):(ys(i),null)}if(ys(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=d!==null,s=s!==null&&s.memoizedState!==null,c){d=i.child,p=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(p=d.alternate.memoizedState.cachePool.pool);var S=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),S!==p&&(d.flags|=2048)}return c!==s&&c&&(i.child.flags|=8192),rf(i,i.updateQueue),or(i),null;case 4:return Ne(),s===null&&zx(i.stateNode.containerInfo),or(i),null;case 10:return gs(i.type),or(i),null;case 19:if(L(Br),p=i.memoizedState,p===null)return or(i),null;if(d=(i.flags&128)!==0,S=p.rendering,S===null)if(d)Pc(p,!1);else{if(xr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(S=Qu(s),S!==null){for(i.flags|=128,Pc(p,!1),s=S.updateQueue,i.updateQueue=s,rf(i,s),i.subtreeFlags=0,s=c,c=i.child;c!==null;)R1(c,s),c=c.sibling;return G(Br,Br.current&1|2),i.child}s=s.sibling}p.tail!==null&&Oe()>sf&&(i.flags|=128,d=!0,Pc(p,!1),i.lanes=4194304)}else{if(!d)if(s=Qu(S),s!==null){if(i.flags|=128,d=!0,s=s.updateQueue,i.updateQueue=s,rf(i,s),Pc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!S.alternate&&!Dt)return or(i),null}else 2*Oe()-p.renderingStartTime>sf&&c!==536870912&&(i.flags|=128,d=!0,Pc(p,!1),i.lanes=4194304);p.isBackwards?(S.sibling=i.child,i.child=S):(s=p.last,s!==null?s.sibling=S:i.child=S,p.last=S)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=Oe(),i.sibling=null,s=Br.current,G(Br,d?s&1|2:s&1),i):(or(i),null);case 22:case 23:return ys(i),Gh(),d=i.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(or(i),i.subtreeFlags&6&&(i.flags|=8192)):or(i),c=i.updateQueue,c!==null&&rf(i,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),s!==null&&L(al),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),gs(Lr),or(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Hk(s,i){switch(Ah(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return gs(Lr),Ne(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Ze(i),null;case 13:if(ys(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Sc()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return L(Br),null;case 4:return Ne(),null;case 10:return gs(i.type),null;case 22:case 23:return ys(i),Gh(),s!==null&&L(al),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return gs(Lr),null;case 25:return null;default:return null}}function ny(s,i){switch(Ah(i),i.tag){case 3:gs(Lr),Ne();break;case 26:case 27:case 5:Ze(i);break;case 4:Ne();break;case 13:ys(i);break;case 19:L(Br);break;case 10:gs(i.type);break;case 22:case 23:ys(i),Gh(),s!==null&&L(al);break;case 24:gs(Lr)}}function Ic(s,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var p=d.next;c=p;do{if((c.tag&s)===s){d=void 0;var S=c.create,j=c.inst;d=S(),j.destroy=d}c=c.next}while(c!==p)}}catch(P){Yt(i,i.return,P)}}function ai(s,i,c){try{var d=i.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var S=p.next;d=S;do{if((d.tag&s)===s){var j=d.inst,P=j.destroy;if(P!==void 0){j.destroy=void 0,p=i;var J=c,he=P;try{he()}catch(Se){Yt(p,J,Se)}}}d=d.next}while(d!==S)}}catch(Se){Yt(i,i.return,Se)}}function sy(s){var i=s.updateQueue;if(i!==null){var c=s.stateNode;try{W1(i,c)}catch(d){Yt(s,s.return,d)}}}function iy(s,i,c){c.props=sl(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){Yt(s,i,d)}}function Uc(s,i){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(p){Yt(s,i,p)}}function Yn(s,i){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(p){Yt(s,i,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){Yt(s,i,p)}else c.current=null}function ly(s){var i=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(p){Yt(s,s.return,p)}}function gx(s,i,c){try{var d=s.stateNode;cT(d,s.type,c,i),d[Sr]=i}catch(p){Yt(s,s.return,p)}}function oy(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&fi(s.type)||s.tag===4}function vx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||oy(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&fi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yx(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(s),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=mf));else if(d!==4&&(d===27&&fi(s.type)&&(c=s.stateNode,i=null),s=s.child,s!==null))for(yx(s,i,c),s=s.sibling;s!==null;)yx(s,i,c),s=s.sibling}function af(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(d!==4&&(d===27&&fi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(af(s,i,c),s=s.sibling;s!==null;)af(s,i,c),s=s.sibling}function cy(s){var i=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);Jr(i,d,c),i[wr]=s,i[Sr]=c}catch(S){Yt(s,s.return,S)}}var Ss=!1,_r=!1,bx=!1,uy=typeof WeakSet=="function"?WeakSet:Set,Vr=null;function Gk(s,i){if(s=s.containerInfo,Vx=Sf,s=w1(s),vh(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var p=d.anchorOffset,S=d.focusNode;d=d.focusOffset;try{c.nodeType,S.nodeType}catch{c=null;break e}var j=0,P=-1,J=-1,he=0,Se=0,Ce=s,pe=null;t:for(;;){for(var ve;Ce!==c||p!==0&&Ce.nodeType!==3||(P=j+p),Ce!==S||d!==0&&Ce.nodeType!==3||(J=j+d),Ce.nodeType===3&&(j+=Ce.nodeValue.length),(ve=Ce.firstChild)!==null;)pe=Ce,Ce=ve;for(;;){if(Ce===s)break t;if(pe===c&&++he===p&&(P=j),pe===S&&++Se===d&&(J=j),(ve=Ce.nextSibling)!==null)break;Ce=pe,pe=Ce.parentNode}Ce=ve}c=P===-1||J===-1?null:{start:P,end:J}}else c=null}c=c||{start:0,end:0}}else c=null;for(qx={focusedElem:s,selectionRange:c},Sf=!1,Vr=i;Vr!==null;)if(i=Vr,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Vr=s;else for(;Vr!==null;){switch(i=Vr,S=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&S!==null){s=void 0,c=i,p=S.memoizedProps,S=S.memoizedState,d=c.stateNode;try{var at=sl(c.type,p,c.elementType===c.type);s=d.getSnapshotBeforeUpdate(at,S),d.__reactInternalSnapshotBeforeUpdate=s}catch(Ke){Yt(c,c.return,Ke)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,c=s.nodeType,c===9)Yx(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Yx(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Vr=s;break}Vr=i.return}}function fy(s,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ni(s,c),d&4&&Ic(5,c);break;case 1:if(ni(s,c),d&4)if(s=c.stateNode,i===null)try{s.componentDidMount()}catch(j){Yt(c,c.return,j)}else{var p=sl(c.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(p,i,s.__reactInternalSnapshotBeforeUpdate)}catch(j){Yt(c,c.return,j)}}d&64&&sy(c),d&512&&Uc(c,c.return);break;case 3:if(ni(s,c),d&64&&(s=c.updateQueue,s!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{W1(s,i)}catch(j){Yt(c,c.return,j)}}break;case 27:i===null&&d&4&&cy(c);case 26:case 5:ni(s,c),i===null&&d&4&&ly(c),d&512&&Uc(c,c.return);break;case 12:ni(s,c);break;case 13:ni(s,c),d&4&&xy(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=Zk.bind(null,c),pT(s,c))));break;case 22:if(d=c.memoizedState!==null||Ss,!d){i=i!==null&&i.memoizedState!==null||_r,p=Ss;var S=_r;Ss=d,(_r=i)&&!S?si(s,c,(c.subtreeFlags&8772)!==0):ni(s,c),Ss=p,_r=S}break;case 30:break;default:ni(s,c)}}function dy(s){var i=s.alternate;i!==null&&(s.alternate=null,dy(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&H(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nr=null,Da=!1;function Es(s,i,c){for(c=c.child;c!==null;)hy(s,i,c),c=c.sibling}function hy(s,i,c){if(lr&&typeof lr.onCommitFiberUnmount=="function")try{lr.onCommitFiberUnmount(yr,c)}catch{}switch(c.tag){case 26:_r||Yn(c,i),Es(s,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:_r||Yn(c,i);var d=nr,p=Da;fi(c.type)&&(nr=c.stateNode,Da=!1),Es(s,i,c),$c(c.stateNode),nr=d,Da=p;break;case 5:_r||Yn(c,i);case 6:if(d=nr,p=Da,nr=null,Es(s,i,c),nr=d,Da=p,nr!==null)if(Da)try{(nr.nodeType===9?nr.body:nr.nodeName==="HTML"?nr.ownerDocument.body:nr).removeChild(c.stateNode)}catch(S){Yt(c,i,S)}else try{nr.removeChild(c.stateNode)}catch(S){Yt(c,i,S)}break;case 18:nr!==null&&(Da?(s=nr,t2(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),a0(s)):t2(nr,c.stateNode));break;case 4:d=nr,p=Da,nr=c.stateNode.containerInfo,Da=!0,Es(s,i,c),nr=d,Da=p;break;case 0:case 11:case 14:case 15:_r||ai(2,c,i),_r||ai(4,c,i),Es(s,i,c);break;case 1:_r||(Yn(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&iy(c,i,d)),Es(s,i,c);break;case 21:Es(s,i,c);break;case 22:_r=(d=_r)||c.memoizedState!==null,Es(s,i,c),_r=d;break;default:Es(s,i,c)}}function xy(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{a0(s)}catch(c){Yt(i,i.return,c)}}function Vk(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new uy),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new uy),i;default:throw Error(a(435,s.tag))}}function wx(s,i){var c=Vk(s);i.forEach(function(d){var p=Jk.bind(null,s,d);c.has(d)||(c.add(d),d.then(p,p))})}function qa(s,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var p=c[d],S=s,j=i,P=j;e:for(;P!==null;){switch(P.tag){case 27:if(fi(P.type)){nr=P.stateNode,Da=!1;break e}break;case 5:nr=P.stateNode,Da=!1;break e;case 3:case 4:nr=P.stateNode.containerInfo,Da=!0;break e}P=P.return}if(nr===null)throw Error(a(160));hy(S,j,p),nr=null,Da=!1,S=p.alternate,S!==null&&(S.return=null),p.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)my(i,s),i=i.sibling}var Rn=null;function my(s,i){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:qa(i,s),Wa(s),d&4&&(ai(3,s,s.return),Ic(3,s),ai(5,s,s.return));break;case 1:qa(i,s),Wa(s),d&512&&(_r||c===null||Yn(c,c.return)),d&64&&Ss&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var p=Rn;if(qa(i,s),Wa(s),d&512&&(_r||c===null||Yn(c,c.return)),d&4){var S=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,p=p.ownerDocument||p;t:switch(d){case"title":S=p.getElementsByTagName("title")[0],(!S||S[I]||S[wr]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=p.createElement(d),p.head.insertBefore(S,p.querySelector("head > title"))),Jr(S,d,c),S[wr]=s,ue(S),d=S;break e;case"link":var j=c2("link","href",p).get(d+(c.href||""));if(j){for(var P=0;P<j.length;P++)if(S=j[P],S.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&S.getAttribute("rel")===(c.rel==null?null:c.rel)&&S.getAttribute("title")===(c.title==null?null:c.title)&&S.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){j.splice(P,1);break t}}S=p.createElement(d),Jr(S,d,c),p.head.appendChild(S);break;case"meta":if(j=c2("meta","content",p).get(d+(c.content||""))){for(P=0;P<j.length;P++)if(S=j[P],S.getAttribute("content")===(c.content==null?null:""+c.content)&&S.getAttribute("name")===(c.name==null?null:c.name)&&S.getAttribute("property")===(c.property==null?null:c.property)&&S.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&S.getAttribute("charset")===(c.charSet==null?null:c.charSet)){j.splice(P,1);break t}}S=p.createElement(d),Jr(S,d,c),p.head.appendChild(S);break;default:throw Error(a(468,d))}S[wr]=s,ue(S),d=S}s.stateNode=d}else u2(p,s.type,s.stateNode);else s.stateNode=o2(p,d,s.memoizedProps);else S!==d?(S===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):S.count--,d===null?u2(p,s.type,s.stateNode):o2(p,d,s.memoizedProps)):d===null&&s.stateNode!==null&&gx(s,s.memoizedProps,c.memoizedProps)}break;case 27:qa(i,s),Wa(s),d&512&&(_r||c===null||Yn(c,c.return)),c!==null&&d&4&&gx(s,s.memoizedProps,c.memoizedProps);break;case 5:if(qa(i,s),Wa(s),d&512&&(_r||c===null||Yn(c,c.return)),s.flags&32){p=s.stateNode;try{ql(p,"")}catch(ve){Yt(s,s.return,ve)}}d&4&&s.stateNode!=null&&(p=s.memoizedProps,gx(s,p,c!==null?c.memoizedProps:p)),d&1024&&(bx=!0);break;case 6:if(qa(i,s),Wa(s),d&4){if(s.stateNode===null)throw Error(a(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(ve){Yt(s,s.return,ve)}}break;case 3:if(yf=null,p=Rn,Rn=gf(i.containerInfo),qa(i,s),Rn=p,Wa(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{a0(i.containerInfo)}catch(ve){Yt(s,s.return,ve)}bx&&(bx=!1,py(s));break;case 4:d=Rn,Rn=gf(s.stateNode.containerInfo),qa(i,s),Wa(s),Rn=d;break;case 12:qa(i,s),Wa(s);break;case 13:qa(i,s),Wa(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Nx=Oe()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,wx(s,d)));break;case 22:p=s.memoizedState!==null;var J=c!==null&&c.memoizedState!==null,he=Ss,Se=_r;if(Ss=he||p,_r=Se||J,qa(i,s),_r=Se,Ss=he,Wa(s),d&8192)e:for(i=s.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(c===null||J||Ss||_r||il(s)),c=null,i=s;;){if(i.tag===5||i.tag===26){if(c===null){J=c=i;try{if(S=J.stateNode,p)j=S.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{P=J.stateNode;var Ce=J.memoizedProps.style,pe=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;P.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(ve){Yt(J,J.return,ve)}}}else if(i.tag===6){if(c===null){J=i;try{J.stateNode.nodeValue=p?"":J.memoizedProps}catch(ve){Yt(J,J.return,ve)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,wx(s,c))));break;case 19:qa(i,s),Wa(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,wx(s,d)));break;case 30:break;case 21:break;default:qa(i,s),Wa(s)}}function Wa(s){var i=s.flags;if(i&2){try{for(var c,d=s.return;d!==null;){if(oy(d)){c=d;break}d=d.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var p=c.stateNode,S=vx(s);af(s,S,p);break;case 5:var j=c.stateNode;c.flags&32&&(ql(j,""),c.flags&=-33);var P=vx(s);af(s,P,j);break;case 3:case 4:var J=c.stateNode.containerInfo,he=vx(s);yx(s,he,J);break;default:throw Error(a(161))}}catch(Se){Yt(s,s.return,Se)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function py(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;py(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function ni(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)fy(s,i.alternate,i),i=i.sibling}function il(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:ai(4,i,i.return),il(i);break;case 1:Yn(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&iy(i,i.return,c),il(i);break;case 27:$c(i.stateNode);case 26:case 5:Yn(i,i.return),il(i);break;case 22:i.memoizedState===null&&il(i);break;case 30:il(i);break;default:il(i)}s=s.sibling}}function si(s,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,p=s,S=i,j=S.flags;switch(S.tag){case 0:case 11:case 15:si(p,S,c),Ic(4,S);break;case 1:if(si(p,S,c),d=S,p=d.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(he){Yt(d,d.return,he)}if(d=S,p=d.updateQueue,p!==null){var P=d.stateNode;try{var J=p.shared.hiddenCallbacks;if(J!==null)for(p.shared.hiddenCallbacks=null,p=0;p<J.length;p++)q1(J[p],P)}catch(he){Yt(d,d.return,he)}}c&&j&64&&sy(S),Uc(S,S.return);break;case 27:cy(S);case 26:case 5:si(p,S,c),c&&d===null&&j&4&&ly(S),Uc(S,S.return);break;case 12:si(p,S,c);break;case 13:si(p,S,c),c&&j&4&&xy(p,S);break;case 22:S.memoizedState===null&&si(p,S,c),Uc(S,S.return);break;case 30:break;default:si(p,S,c)}i=i.sibling}}function Sx(s,i){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&kc(c))}function Ex(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&kc(s))}function $n(s,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)gy(s,i,c,d),i=i.sibling}function gy(s,i,c,d){var p=i.flags;switch(i.tag){case 0:case 11:case 15:$n(s,i,c,d),p&2048&&Ic(9,i);break;case 1:$n(s,i,c,d);break;case 3:$n(s,i,c,d),p&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&kc(s)));break;case 12:if(p&2048){$n(s,i,c,d),s=i.stateNode;try{var S=i.memoizedProps,j=S.id,P=S.onPostCommit;typeof P=="function"&&P(j,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Yt(i,i.return,J)}}else $n(s,i,c,d);break;case 13:$n(s,i,c,d);break;case 23:break;case 22:S=i.stateNode,j=i.alternate,i.memoizedState!==null?S._visibility&2?$n(s,i,c,d):zc(s,i):S._visibility&2?$n(s,i,c,d):(S._visibility|=2,uo(s,i,c,d,(i.subtreeFlags&10256)!==0)),p&2048&&Sx(j,i);break;case 24:$n(s,i,c,d),p&2048&&Ex(i.alternate,i);break;default:$n(s,i,c,d)}}function uo(s,i,c,d,p){for(p=p&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var S=s,j=i,P=c,J=d,he=j.flags;switch(j.tag){case 0:case 11:case 15:uo(S,j,P,J,p),Ic(8,j);break;case 23:break;case 22:var Se=j.stateNode;j.memoizedState!==null?Se._visibility&2?uo(S,j,P,J,p):zc(S,j):(Se._visibility|=2,uo(S,j,P,J,p)),p&&he&2048&&Sx(j.alternate,j);break;case 24:uo(S,j,P,J,p),p&&he&2048&&Ex(j.alternate,j);break;default:uo(S,j,P,J,p)}i=i.sibling}}function zc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=s,d=i,p=d.flags;switch(d.tag){case 22:zc(c,d),p&2048&&Sx(d.alternate,d);break;case 24:zc(c,d),p&2048&&Ex(d.alternate,d);break;default:zc(c,d)}i=i.sibling}}var Hc=8192;function fo(s){if(s.subtreeFlags&Hc)for(s=s.child;s!==null;)vy(s),s=s.sibling}function vy(s){switch(s.tag){case 26:fo(s),s.flags&Hc&&s.memoizedState!==null&&AT(Rn,s.memoizedState,s.memoizedProps);break;case 5:fo(s);break;case 3:case 4:var i=Rn;Rn=gf(s.stateNode.containerInfo),fo(s),Rn=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Hc,Hc=16777216,fo(s),Hc=i):fo(s));break;default:fo(s)}}function yy(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Gc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];Vr=d,wy(d,s)}yy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)by(s),s=s.sibling}function by(s){switch(s.tag){case 0:case 11:case 15:Gc(s),s.flags&2048&&ai(9,s,s.return);break;case 3:Gc(s);break;case 12:Gc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,nf(s)):Gc(s);break;default:Gc(s)}}function nf(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];Vr=d,wy(d,s)}yy(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:ai(8,i,i.return),nf(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,nf(i));break;default:nf(i)}s=s.sibling}}function wy(s,i){for(;Vr!==null;){var c=Vr;switch(c.tag){case 0:case 11:case 15:ai(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:kc(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Vr=d;else e:for(c=s;Vr!==null;){d=Vr;var p=d.sibling,S=d.return;if(dy(d),d===c){Vr=null;break e}if(p!==null){p.return=S,Vr=p;break e}Vr=S}}}var qk={getCacheForType:function(s){var i=sa(Lr),c=i.data.get(s);return c===void 0&&(c=s(),i.data.set(s,c)),c}},Wk=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Qt=null,wt=null,Tt=0,Lt=0,Xa=null,ii=!1,ho=!1,_x=!1,_s=0,xr=0,li=0,ll=0,kx=0,fn=0,xo=0,Vc=null,Fa=null,Tx=!1,Nx=0,sf=1/0,lf=null,oi=null,Zr=0,ci=null,mo=null,po=0,Cx=0,Ax=null,Sy=null,qc=0,jx=null;function Ya(){if((Mt&2)!==0&&Tt!==0)return Tt&-Tt;if(ee.T!==null){var s=ro;return s!==0?s:Bx()}return br()}function Ey(){fn===0&&(fn=(Tt&536870912)===0||Dt?Vs():536870912);var s=un.current;return s!==null&&(s.flags|=32),fn}function $a(s,i,c){(s===Qt&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)&&(go(s,0),ui(s,Tt,fn,!1)),re(s,c),((Mt&2)===0||s!==Qt)&&(s===Qt&&((Mt&2)===0&&(ll|=c),xr===4&&ui(s,Tt,fn,!1)),Kn(s))}function _y(s,i,c){if((Mt&6)!==0)throw Error(a(327));var d=!c&&(i&124)===0&&(i&s.expiredLanes)===0||us(s,i),p=d?$k(s,i):Fx(s,i,!0),S=d;do{if(p===0){ho&&!d&&ui(s,i,0,!1);break}else{if(c=s.current.alternate,S&&!Xk(c)){p=Fx(s,i,!1),S=!1;continue}if(p===2){if(S=i,s.errorRecoveryDisabledLanes&S)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){i=j;e:{var P=s;p=Vc;var J=P.current.memoizedState.isDehydrated;if(J&&(go(P,j).flags|=256),j=Fx(P,j,!1),j!==2){if(_x&&!J){P.errorRecoveryDisabledLanes|=S,ll|=S,p=4;break e}S=Fa,Fa=p,S!==null&&(Fa===null?Fa=S:Fa.push.apply(Fa,S))}p=j}if(S=!1,p!==2)continue}}if(p===1){go(s,0),ui(s,i,0,!0);break}e:{switch(d=s,S=p,S){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:ui(d,i,fn,!ii);break e;case 2:Fa=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(p=Nx+300-Oe(),10<p)){if(ui(d,i,fn,!ii),Gs(d,0,!0)!==0)break e;d.timeoutHandle=Jy(ky.bind(null,d,c,Fa,lf,Tx,i,fn,ll,xo,ii,S,2,-0,0),p);break e}ky(d,c,Fa,lf,Tx,i,fn,ll,xo,ii,S,0,-0,0)}}break}while(!0);Kn(s)}function ky(s,i,c,d,p,S,j,P,J,he,Se,Ce,pe,ve){if(s.timeoutHandle=-1,Ce=i.subtreeFlags,(Ce&8192||(Ce&16785408)===16785408)&&(Zc={stylesheets:null,count:0,unsuspend:CT},vy(i),Ce=jT(),Ce!==null)){s.cancelPendingCommit=Ce(Dy.bind(null,s,i,S,c,d,p,j,P,J,Se,1,pe,ve)),ui(s,S,j,!he);return}Dy(s,i,S,c,d,p,j,P,J)}function Xk(s){for(var i=s;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var p=c[d],S=p.getSnapshot;p=p.value;try{if(!Ga(S(),p))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ui(s,i,c,d){i&=~kx,i&=~ll,s.suspendedLanes|=i,s.pingedLanes&=~i,d&&(s.warmLanes|=i),d=s.expirationTimes;for(var p=i;0<p;){var S=31-st(p),j=1<<S;d[S]=-1,p&=~j}c!==0&&$e(s,c,i)}function of(){return(Mt&6)===0?(Wc(0),!1):!0}function Rx(){if(wt!==null){if(Lt===0)var s=wt.return;else s=wt,ps=tl=null,Yh(s),oo=null,Lc=0,s=wt;for(;s!==null;)ny(s.alternate,s),s=s.return;wt=null}}function go(s,i){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,fT(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Rx(),Qt=s,wt=c=hs(s.current,null),Tt=i,Lt=0,Xa=null,ii=!1,ho=us(s,i),_x=!1,xo=fn=kx=ll=li=xr=0,Fa=Vc=null,Tx=!1,(i&8)!==0&&(i|=i&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=i;0<d;){var p=31-st(d),S=1<<p;i|=s[p],d&=~S}return _s=i,Au(),c}function Ty(s,i){gt=null,ee.H=Yu,i===Nc||i===Pu?(i=G1(),Lt=3):i===U1?(i=G1(),Lt=4):Lt=i===Vv?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Xa=i,wt===null&&(xr=1,Ju(s,sn(i,s.current)))}function Ny(){var s=ee.H;return ee.H=Yu,s===null?Yu:s}function Cy(){var s=ee.A;return ee.A=qk,s}function Dx(){xr=4,ii||(Tt&4194048)!==Tt&&un.current!==null||(ho=!0),(li&134217727)===0&&(ll&134217727)===0||Qt===null||ui(Qt,Tt,fn,!1)}function Fx(s,i,c){var d=Mt;Mt|=2;var p=Ny(),S=Cy();(Qt!==s||Tt!==i)&&(lf=null,go(s,i)),i=!1;var j=xr;e:do try{if(Lt!==0&&wt!==null){var P=wt,J=Xa;switch(Lt){case 8:Rx(),j=6;break e;case 3:case 2:case 9:case 6:un.current===null&&(i=!0);var he=Lt;if(Lt=0,Xa=null,vo(s,P,J,he),c&&ho){j=0;break e}break;default:he=Lt,Lt=0,Xa=null,vo(s,P,J,he)}}Yk(),j=xr;break}catch(Se){Ty(s,Se)}while(!0);return i&&s.shellSuspendCounter++,ps=tl=null,Mt=d,ee.H=p,ee.A=S,wt===null&&(Qt=null,Tt=0,Au()),j}function Yk(){for(;wt!==null;)Ay(wt)}function $k(s,i){var c=Mt;Mt|=2;var d=Ny(),p=Cy();Qt!==s||Tt!==i?(lf=null,sf=Oe()+500,go(s,i)):ho=us(s,i);e:do try{if(Lt!==0&&wt!==null){i=wt;var S=Xa;t:switch(Lt){case 1:Lt=0,Xa=null,vo(s,i,S,1);break;case 2:case 9:if(z1(S)){Lt=0,Xa=null,jy(i);break}i=function(){Lt!==2&&Lt!==9||Qt!==s||(Lt=7),Kn(s)},S.then(i,i);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:z1(S)?(Lt=0,Xa=null,jy(i)):(Lt=0,Xa=null,vo(s,i,S,7));break;case 5:var j=null;switch(wt.tag){case 26:j=wt.memoizedState;case 5:case 27:var P=wt;if(!j||f2(j)){Lt=0,Xa=null;var J=P.sibling;if(J!==null)wt=J;else{var he=P.return;he!==null?(wt=he,cf(he)):wt=null}break t}}Lt=0,Xa=null,vo(s,i,S,5);break;case 6:Lt=0,Xa=null,vo(s,i,S,6);break;case 8:Rx(),xr=6;break e;default:throw Error(a(462))}}Kk();break}catch(Se){Ty(s,Se)}while(!0);return ps=tl=null,ee.H=d,ee.A=p,Mt=c,wt!==null?0:(Qt=null,Tt=0,Au(),xr)}function Kk(){for(;wt!==null&&!kt();)Ay(wt)}function Ay(s){var i=ry(s.alternate,s,_s);s.memoizedProps=s.pendingProps,i===null?cf(s):wt=i}function jy(s){var i=s,c=i.alternate;switch(i.tag){case 15:case 0:i=Kv(c,i,i.pendingProps,i.type,void 0,Tt);break;case 11:i=Kv(c,i,i.pendingProps,i.type.render,i.ref,Tt);break;case 5:Yh(i);default:ny(c,i),i=wt=R1(i,_s),i=ry(c,i,_s)}s.memoizedProps=s.pendingProps,i===null?cf(s):wt=i}function vo(s,i,c,d){ps=tl=null,Yh(i),oo=null,Lc=0;var p=i.return;try{if(Ik(s,p,i,c,Tt)){xr=1,Ju(s,sn(c,s.current)),wt=null;return}}catch(S){if(p!==null)throw wt=p,S;xr=1,Ju(s,sn(c,s.current)),wt=null;return}i.flags&32768?(Dt||d===1?s=!0:ho||(Tt&536870912)!==0?s=!1:(ii=s=!0,(d===2||d===9||d===3||d===6)&&(d=un.current,d!==null&&d.tag===13&&(d.flags|=16384))),Ry(i,s)):cf(i)}function cf(s){var i=s;do{if((i.flags&32768)!==0){Ry(i,ii);return}s=i.return;var c=zk(i.alternate,i,_s);if(c!==null){wt=c;return}if(i=i.sibling,i!==null){wt=i;return}wt=i=s}while(i!==null);xr===0&&(xr=5)}function Ry(s,i){do{var c=Hk(s.alternate,s);if(c!==null){c.flags&=32767,wt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(s=s.sibling,s!==null)){wt=s;return}wt=s=c}while(s!==null);xr=6,wt=null}function Dy(s,i,c,d,p,S,j,P,J){s.cancelPendingCommit=null;do uf();while(Zr!==0);if((Mt&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(S=i.lanes|i.childLanes,S|=Eh,Ue(s,c,S,j,P,J),s===Qt&&(wt=Qt=null,Tt=0),mo=i,ci=s,po=c,Cx=S,Ax=p,Sy=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,eT(Hr,function(){return By(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=ee.T,ee.T=null,p=ie.p,ie.p=2,j=Mt,Mt|=4;try{Gk(s,i,c)}finally{Mt=j,ie.p=p,ee.T=d}}Zr=1,Fy(),Oy(),My()}}function Fy(){if(Zr===1){Zr=0;var s=ci,i=mo,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null;var d=ie.p;ie.p=2;var p=Mt;Mt|=4;try{my(i,s);var S=qx,j=w1(s.containerInfo),P=S.focusedElem,J=S.selectionRange;if(j!==P&&P&&P.ownerDocument&&b1(P.ownerDocument.documentElement,P)){if(J!==null&&vh(P)){var he=J.start,Se=J.end;if(Se===void 0&&(Se=he),"selectionStart"in P)P.selectionStart=he,P.selectionEnd=Math.min(Se,P.value.length);else{var Ce=P.ownerDocument||document,pe=Ce&&Ce.defaultView||window;if(pe.getSelection){var ve=pe.getSelection(),at=P.textContent.length,Ke=Math.min(J.start,at),Vt=J.end===void 0?Ke:Math.min(J.end,at);!ve.extend&&Ke>Vt&&(j=Vt,Vt=Ke,Ke=j);var oe=y1(P,Ke),se=y1(P,Vt);if(oe&&se&&(ve.rangeCount!==1||ve.anchorNode!==oe.node||ve.anchorOffset!==oe.offset||ve.focusNode!==se.node||ve.focusOffset!==se.offset)){var fe=Ce.createRange();fe.setStart(oe.node,oe.offset),ve.removeAllRanges(),Ke>Vt?(ve.addRange(fe),ve.extend(se.node,se.offset)):(fe.setEnd(se.node,se.offset),ve.addRange(fe))}}}}for(Ce=[],ve=P;ve=ve.parentNode;)ve.nodeType===1&&Ce.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<Ce.length;P++){var ke=Ce[P];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Sf=!!Vx,qx=Vx=null}finally{Mt=p,ie.p=d,ee.T=c}}s.current=i,Zr=2}}function Oy(){if(Zr===2){Zr=0;var s=ci,i=mo,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ee.T,ee.T=null;var d=ie.p;ie.p=2;var p=Mt;Mt|=4;try{fy(s,i.alternate,i)}finally{Mt=p,ie.p=d,ee.T=c}}Zr=3}}function My(){if(Zr===4||Zr===3){Zr=0,ot();var s=ci,i=mo,c=po,d=Sy;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Zr=5:(Zr=0,mo=ci=null,Ly(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&(oi=null),$t(c),i=i.stateNode,lr&&typeof lr.onCommitFiberRoot=="function")try{lr.onCommitFiberRoot(yr,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=ee.T,p=ie.p,ie.p=2,ee.T=null;try{for(var S=s.onRecoverableError,j=0;j<d.length;j++){var P=d[j];S(P.value,{componentStack:P.stack})}}finally{ee.T=i,ie.p=p}}(po&3)!==0&&uf(),Kn(s),p=s.pendingLanes,(c&4194090)!==0&&(p&42)!==0?s===jx?qc++:(qc=0,jx=s):qc=0,Wc(0)}}function Ly(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,kc(i)))}function uf(s){return Fy(),Oy(),My(),By()}function By(){if(Zr!==5)return!1;var s=ci,i=Cx;Cx=0;var c=$t(po),d=ee.T,p=ie.p;try{ie.p=32>c?32:c,ee.T=null,c=Ax,Ax=null;var S=ci,j=po;if(Zr=0,mo=ci=null,po=0,(Mt&6)!==0)throw Error(a(331));var P=Mt;if(Mt|=4,by(S.current),gy(S,S.current,j,c),Mt=P,Wc(0,!1),lr&&typeof lr.onPostCommitFiberRoot=="function")try{lr.onPostCommitFiberRoot(yr,S)}catch{}return!0}finally{ie.p=p,ee.T=d,Ly(s,i)}}function Py(s,i,c){i=sn(c,i),i=ox(s.stateNode,i,2),s=Js(s,i,2),s!==null&&(re(s,2),Kn(s))}function Yt(s,i,c){if(s.tag===3)Py(s,s,c);else for(;i!==null;){if(i.tag===3){Py(i,s,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(oi===null||!oi.has(d))){s=sn(c,s),c=Hv(2),d=Js(i,c,2),d!==null&&(Gv(c,d,i,s),re(d,2),Kn(d));break}}i=i.return}}function Ox(s,i,c){var d=s.pingCache;if(d===null){d=s.pingCache=new Wk;var p=new Set;d.set(i,p)}else p=d.get(i),p===void 0&&(p=new Set,d.set(i,p));p.has(c)||(_x=!0,p.add(c),s=Qk.bind(null,s,i,c),i.then(s,s))}function Qk(s,i,c){var d=s.pingCache;d!==null&&d.delete(i),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,Qt===s&&(Tt&c)===c&&(xr===4||xr===3&&(Tt&62914560)===Tt&&300>Oe()-Nx?(Mt&2)===0&&go(s,0):kx|=c,xo===Tt&&(xo=0)),Kn(s)}function Iy(s,i){i===0&&(i=qs()),s=Zl(s,i),s!==null&&(re(s,i),Kn(s))}function Zk(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),Iy(s,c)}function Jk(s,i){var c=0;switch(s.tag){case 13:var d=s.stateNode,p=s.memoizedState;p!==null&&(c=p.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(a(314))}d!==null&&d.delete(i),Iy(s,c)}function eT(s,i){return Ae(s,i)}var ff=null,yo=null,Mx=!1,df=!1,Lx=!1,ol=0;function Kn(s){s!==yo&&s.next===null&&(yo===null?ff=yo=s:yo=yo.next=s),df=!0,Mx||(Mx=!0,rT())}function Wc(s,i){if(!Lx&&df){Lx=!0;do for(var c=!1,d=ff;d!==null;){if(s!==0){var p=d.pendingLanes;if(p===0)var S=0;else{var j=d.suspendedLanes,P=d.pingedLanes;S=(1<<31-st(42|s)+1)-1,S&=p&~(j&~P),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(c=!0,Gy(d,S))}else S=Tt,S=Gs(d,d===Qt?S:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(S&3)===0||us(d,S)||(c=!0,Gy(d,S));d=d.next}while(c);Lx=!1}}function tT(){Uy()}function Uy(){df=Mx=!1;var s=0;ol!==0&&(uT()&&(s=ol),ol=0);for(var i=Oe(),c=null,d=ff;d!==null;){var p=d.next,S=zy(d,i);S===0?(d.next=null,c===null?ff=p:c.next=p,p===null&&(yo=c)):(c=d,(s!==0||(S&3)!==0)&&(df=!0)),d=p}Wc(s)}function zy(s,i){for(var c=s.suspendedLanes,d=s.pingedLanes,p=s.expirationTimes,S=s.pendingLanes&-62914561;0<S;){var j=31-st(S),P=1<<j,J=p[j];J===-1?((P&c)===0||(P&d)!==0)&&(p[j]=Gl(P,i)):J<=i&&(s.expiredLanes|=P),S&=~P}if(i=Qt,c=Tt,c=Gs(s,s===i?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===i&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&lt(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||us(s,c)){if(i=c&-c,i===s.callbackPriority)return i;switch(d!==null&&lt(d),$t(c)){case 2:case 8:c=Kr;break;case 32:c=Hr;break;case 268435456:c=Pe;break;default:c=Hr}return d=Hy.bind(null,s),c=Ae(c,d),s.callbackPriority=i,s.callbackNode=c,i}return d!==null&&d!==null&&lt(d),s.callbackPriority=2,s.callbackNode=null,2}function Hy(s,i){if(Zr!==0&&Zr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(uf()&&s.callbackNode!==c)return null;var d=Tt;return d=Gs(s,s===Qt?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(_y(s,d,i),zy(s,Oe()),s.callbackNode!=null&&s.callbackNode===c?Hy.bind(null,s):null)}function Gy(s,i){if(uf())return null;_y(s,i,!0)}function rT(){dT(function(){(Mt&6)!==0?Ae(fr,tT):Uy()})}function Bx(){return ol===0&&(ol=Vs()),ol}function Vy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Su(""+s)}function qy(s,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,s.id&&c.setAttribute("form",s.id),i.parentNode.insertBefore(c,i),s=new FormData(s),c.parentNode.removeChild(c),s}function aT(s,i,c,d,p){if(i==="submit"&&c&&c.stateNode===p){var S=Vy((p[Sr]||null).action),j=d.submitter;j&&(i=(i=j[Sr]||null)?Vy(i.formAction):j.getAttribute("formAction"),i!==null&&(S=i,j=null));var P=new Tu("action","action",null,d,p);s.push({event:P,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ol!==0){var J=j?qy(p,j):new FormData(p);ax(c,{pending:!0,data:J,method:p.method,action:S},null,J)}}else typeof S=="function"&&(P.preventDefault(),J=j?qy(p,j):new FormData(p),ax(c,{pending:!0,data:J,method:p.method,action:S},S,J))},currentTarget:p}]})}}for(var Px=0;Px<Sh.length;Px++){var Ix=Sh[Px],nT=Ix.toLowerCase(),sT=Ix[0].toUpperCase()+Ix.slice(1);jn(nT,"on"+sT)}jn(_1,"onAnimationEnd"),jn(k1,"onAnimationIteration"),jn(T1,"onAnimationStart"),jn("dblclick","onDoubleClick"),jn("focusin","onFocus"),jn("focusout","onBlur"),jn(Sk,"onTransitionRun"),jn(Ek,"onTransitionStart"),jn(_k,"onTransitionCancel"),jn(N1,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),De("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),De("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),De("onBeforeInput",["compositionend","keypress","textInput","paste"]),De("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),De("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xc));function Wy(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],p=d.event;d=d.listeners;e:{var S=void 0;if(i)for(var j=d.length-1;0<=j;j--){var P=d[j],J=P.instance,he=P.currentTarget;if(P=P.listener,J!==S&&p.isPropagationStopped())break e;S=P,p.currentTarget=he;try{S(p)}catch(Se){Zu(Se)}p.currentTarget=null,S=J}else for(j=0;j<d.length;j++){if(P=d[j],J=P.instance,he=P.currentTarget,P=P.listener,J!==S&&p.isPropagationStopped())break e;S=P,p.currentTarget=he;try{S(p)}catch(Se){Zu(Se)}p.currentTarget=null,S=J}}}}function St(s,i){var c=i[fc];c===void 0&&(c=i[fc]=new Set);var d=s+"__bubble";c.has(d)||(Xy(i,s,2,!1),c.add(d))}function Ux(s,i,c){var d=0;i&&(d|=4),Xy(c,s,d,i)}var hf="_reactListening"+Math.random().toString(36).slice(2);function zx(s){if(!s[hf]){s[hf]=!0,me.forEach(function(c){c!=="selectionchange"&&(iT.has(c)||Ux(c,!1,s),Ux(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[hf]||(i[hf]=!0,Ux("selectionchange",!1,i))}}function Xy(s,i,c,d){switch(g2(i)){case 2:var p=FT;break;case 8:p=OT;break;default:p=tm}c=p.bind(null,i,c,s),p=void 0,!ch||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),d?p!==void 0?s.addEventListener(i,c,{capture:!0,passive:p}):s.addEventListener(i,c,!0):p!==void 0?s.addEventListener(i,c,{passive:p}):s.addEventListener(i,c,!1)}function Hx(s,i,c,d,p){var S=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var j=d.tag;if(j===3||j===4){var P=d.stateNode.containerInfo;if(P===p)break;if(j===4)for(j=d.return;j!==null;){var J=j.tag;if((J===3||J===4)&&j.stateNode.containerInfo===p)return;j=j.return}for(;P!==null;){if(j=W(P),j===null)return;if(J=j.tag,J===5||J===6||J===26||J===27){d=S=j;continue e}P=P.parentNode}}d=d.return}e1(function(){var he=S,Se=lh(c),Ce=[];e:{var pe=C1.get(s);if(pe!==void 0){var ve=Tu,at=s;switch(s){case"keypress":if(_u(c)===0)break e;case"keydown":case"keyup":ve=ek;break;case"focusin":at="focus",ve=hh;break;case"focusout":at="blur",ve=hh;break;case"beforeblur":case"afterblur":ve=hh;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=a1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=H_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=ak;break;case _1:case k1:case T1:ve=q_;break;case N1:ve=sk;break;case"scroll":case"scrollend":ve=U_;break;case"wheel":ve=lk;break;case"copy":case"cut":case"paste":ve=X_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=s1;break;case"toggle":case"beforetoggle":ve=ck}var Ke=(i&4)!==0,Vt=!Ke&&(s==="scroll"||s==="scrollend"),oe=Ke?pe!==null?pe+"Capture":null:pe;Ke=[];for(var se=he,fe;se!==null;){var ke=se;if(fe=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||fe===null||oe===null||(ke=dc(se,oe),ke!=null&&Ke.push(Yc(se,ke,fe))),Vt)break;se=se.return}0<Ke.length&&(pe=new ve(pe,at,null,c,Se),Ce.push({event:pe,listeners:Ke}))}}if((i&7)===0){e:{if(pe=s==="mouseover"||s==="pointerover",ve=s==="mouseout"||s==="pointerout",pe&&c!==ih&&(at=c.relatedTarget||c.fromElement)&&(W(at)||at[Nn]))break e;if((ve||pe)&&(pe=Se.window===Se?Se:(pe=Se.ownerDocument)?pe.defaultView||pe.parentWindow:window,ve?(at=c.relatedTarget||c.toElement,ve=he,at=at?W(at):null,at!==null&&(Vt=l(at),Ke=at.tag,at!==Vt||Ke!==5&&Ke!==27&&Ke!==6)&&(at=null)):(ve=null,at=he),ve!==at)){if(Ke=a1,ke="onMouseLeave",oe="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(Ke=s1,ke="onPointerLeave",oe="onPointerEnter",se="pointer"),Vt=ve==null?pe:xe(ve),fe=at==null?pe:xe(at),pe=new Ke(ke,se+"leave",ve,c,Se),pe.target=Vt,pe.relatedTarget=fe,ke=null,W(Se)===he&&(Ke=new Ke(oe,se+"enter",at,c,Se),Ke.target=fe,Ke.relatedTarget=Vt,ke=Ke),Vt=ke,ve&&at)t:{for(Ke=ve,oe=at,se=0,fe=Ke;fe;fe=bo(fe))se++;for(fe=0,ke=oe;ke;ke=bo(ke))fe++;for(;0<se-fe;)Ke=bo(Ke),se--;for(;0<fe-se;)oe=bo(oe),fe--;for(;se--;){if(Ke===oe||oe!==null&&Ke===oe.alternate)break t;Ke=bo(Ke),oe=bo(oe)}Ke=null}else Ke=null;ve!==null&&Yy(Ce,pe,ve,Ke,!1),at!==null&&Vt!==null&&Yy(Ce,Vt,at,Ke,!0)}}e:{if(pe=he?xe(he):window,ve=pe.nodeName&&pe.nodeName.toLowerCase(),ve==="select"||ve==="input"&&pe.type==="file")var Ve=h1;else if(f1(pe))if(x1)Ve=yk;else{Ve=gk;var yt=pk}else ve=pe.nodeName,!ve||ve.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?he&&sh(he.elementType)&&(Ve=h1):Ve=vk;if(Ve&&(Ve=Ve(s,he))){d1(Ce,Ve,c,Se);break e}yt&&yt(s,pe,he),s==="focusout"&&he&&pe.type==="number"&&he.memoizedProps.value!=null&&nh(pe,"number",pe.value)}switch(yt=he?xe(he):window,s){case"focusin":(f1(yt)||yt.contentEditable==="true")&&($l=yt,yh=he,bc=null);break;case"focusout":bc=yh=$l=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,S1(Ce,c,Se);break;case"selectionchange":if(wk)break;case"keydown":case"keyup":S1(Ce,c,Se)}var qe;if(mh)e:{switch(s){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else Yl?c1(s,c)&&(Je="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Je="onCompositionStart");Je&&(i1&&c.locale!=="ko"&&(Yl||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&Yl&&(qe=t1()):($s=Se,uh="value"in $s?$s.value:$s.textContent,Yl=!0)),yt=xf(he,Je),0<yt.length&&(Je=new n1(Je,s,null,c,Se),Ce.push({event:Je,listeners:yt}),qe?Je.data=qe:(qe=u1(c),qe!==null&&(Je.data=qe)))),(qe=fk?dk(s,c):hk(s,c))&&(Je=xf(he,"onBeforeInput"),0<Je.length&&(yt=new n1("onBeforeInput","beforeinput",null,c,Se),Ce.push({event:yt,listeners:Je}),yt.data=qe)),aT(Ce,s,he,c,Se)}Wy(Ce,i)})}function Yc(s,i,c){return{instance:s,listener:i,currentTarget:c}}function xf(s,i){for(var c=i+"Capture",d=[];s!==null;){var p=s,S=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||S===null||(p=dc(s,c),p!=null&&d.unshift(Yc(s,p,S)),p=dc(s,i),p!=null&&d.push(Yc(s,p,S))),s.tag===3)return d;s=s.return}return[]}function bo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Yy(s,i,c,d,p){for(var S=i._reactName,j=[];c!==null&&c!==d;){var P=c,J=P.alternate,he=P.stateNode;if(P=P.tag,J!==null&&J===d)break;P!==5&&P!==26&&P!==27||he===null||(J=he,p?(he=dc(c,S),he!=null&&j.unshift(Yc(c,he,J))):p||(he=dc(c,S),he!=null&&j.push(Yc(c,he,J)))),c=c.return}j.length!==0&&s.push({event:i,listeners:j})}var lT=/\r\n?/g,oT=/\u0000|\uFFFD/g;function $y(s){return(typeof s=="string"?s:""+s).replace(lT,`
`).replace(oT,"")}function Ky(s,i){return i=$y(i),$y(s)===i}function mf(){}function Gt(s,i,c,d,p,S){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||ql(s,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&ql(s,""+d);break;case"className":zt(s,"class",d);break;case"tabIndex":zt(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":zt(s,c,d);break;case"style":Zg(s,d,S);break;case"data":if(i!=="object"){zt(s,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Su(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(c==="formAction"?(i!=="input"&&Gt(s,i,"name",p.name,p,null),Gt(s,i,"formEncType",p.formEncType,p,null),Gt(s,i,"formMethod",p.formMethod,p,null),Gt(s,i,"formTarget",p.formTarget,p,null)):(Gt(s,i,"encType",p.encType,p,null),Gt(s,i,"method",p.method,p,null),Gt(s,i,"target",p.target,p,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Su(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=mf);break;case"onScroll":d!=null&&St("scroll",s);break;case"onScrollEnd":d!=null&&St("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=Su(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":St("beforetoggle",s),St("toggle",s),Ut(s,"popover",d);break;case"xlinkActuate":Kt(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Kt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Kt(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Kt(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Kt(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Kt(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Ut(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=P_.get(c)||c,Ut(s,c,d))}}function Gx(s,i,c,d,p,S){switch(c){case"style":Zg(s,d,S);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(p.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"children":typeof d=="string"?ql(s,d):(typeof d=="number"||typeof d=="bigint")&&ql(s,""+d);break;case"onScroll":d!=null&&St("scroll",s);break;case"onScrollEnd":d!=null&&St("scrollend",s);break;case"onClick":d!=null&&(s.onclick=mf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),i=c.slice(2,p?c.length-7:void 0),S=s[Sr]||null,S=S!=null?S[c]:null,typeof S=="function"&&s.removeEventListener(i,S,p),typeof d=="function")){typeof S!="function"&&S!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(i,d,p);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):Ut(s,c,d)}}}function Jr(s,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":St("error",s),St("load",s);var d=!1,p=!1,S;for(S in c)if(c.hasOwnProperty(S)){var j=c[S];if(j!=null)switch(S){case"src":d=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Gt(s,i,S,j,c,null)}}p&&Gt(s,i,"srcSet",c.srcSet,c,null),d&&Gt(s,i,"src",c.src,c,null);return;case"input":St("invalid",s);var P=S=j=p=null,J=null,he=null;for(d in c)if(c.hasOwnProperty(d)){var Se=c[d];if(Se!=null)switch(d){case"name":p=Se;break;case"type":j=Se;break;case"checked":J=Se;break;case"defaultChecked":he=Se;break;case"value":S=Se;break;case"defaultValue":P=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(a(137,i));break;default:Gt(s,i,d,Se,c,null)}}Yg(s,S,P,J,he,j,p,!1),bu(s);return;case"select":St("invalid",s),d=j=S=null;for(p in c)if(c.hasOwnProperty(p)&&(P=c[p],P!=null))switch(p){case"value":S=P;break;case"defaultValue":j=P;break;case"multiple":d=P;default:Gt(s,i,p,P,c,null)}i=S,c=j,s.multiple=!!d,i!=null?Vl(s,!!d,i,!1):c!=null&&Vl(s,!!d,c,!0);return;case"textarea":St("invalid",s),S=p=d=null;for(j in c)if(c.hasOwnProperty(j)&&(P=c[j],P!=null))switch(j){case"value":d=P;break;case"defaultValue":p=P;break;case"children":S=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(a(91));break;default:Gt(s,i,j,P,c,null)}Kg(s,d,p,S),bu(s);return;case"option":for(J in c)if(c.hasOwnProperty(J)&&(d=c[J],d!=null))switch(J){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Gt(s,i,J,d,c,null)}return;case"dialog":St("beforetoggle",s),St("toggle",s),St("cancel",s),St("close",s);break;case"iframe":case"object":St("load",s);break;case"video":case"audio":for(d=0;d<Xc.length;d++)St(Xc[d],s);break;case"image":St("error",s),St("load",s);break;case"details":St("toggle",s);break;case"embed":case"source":case"link":St("error",s),St("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in c)if(c.hasOwnProperty(he)&&(d=c[he],d!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Gt(s,i,he,d,c,null)}return;default:if(sh(i)){for(Se in c)c.hasOwnProperty(Se)&&(d=c[Se],d!==void 0&&Gx(s,i,Se,d,c,void 0));return}}for(P in c)c.hasOwnProperty(P)&&(d=c[P],d!=null&&Gt(s,i,P,d,c,null))}function cT(s,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,S=null,j=null,P=null,J=null,he=null,Se=null;for(ve in c){var Ce=c[ve];if(c.hasOwnProperty(ve)&&Ce!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":J=Ce;default:d.hasOwnProperty(ve)||Gt(s,i,ve,null,d,Ce)}}for(var pe in d){var ve=d[pe];if(Ce=c[pe],d.hasOwnProperty(pe)&&(ve!=null||Ce!=null))switch(pe){case"type":S=ve;break;case"name":p=ve;break;case"checked":he=ve;break;case"defaultChecked":Se=ve;break;case"value":j=ve;break;case"defaultValue":P=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(a(137,i));break;default:ve!==Ce&&Gt(s,i,pe,ve,d,Ce)}}ah(s,j,P,J,he,Se,S,p);return;case"select":ve=j=P=pe=null;for(S in c)if(J=c[S],c.hasOwnProperty(S)&&J!=null)switch(S){case"value":break;case"multiple":ve=J;default:d.hasOwnProperty(S)||Gt(s,i,S,null,d,J)}for(p in d)if(S=d[p],J=c[p],d.hasOwnProperty(p)&&(S!=null||J!=null))switch(p){case"value":pe=S;break;case"defaultValue":P=S;break;case"multiple":j=S;default:S!==J&&Gt(s,i,p,S,d,J)}i=P,c=j,d=ve,pe!=null?Vl(s,!!c,pe,!1):!!d!=!!c&&(i!=null?Vl(s,!!c,i,!0):Vl(s,!!c,c?[]:"",!1));return;case"textarea":ve=pe=null;for(P in c)if(p=c[P],c.hasOwnProperty(P)&&p!=null&&!d.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Gt(s,i,P,null,d,p)}for(j in d)if(p=d[j],S=c[j],d.hasOwnProperty(j)&&(p!=null||S!=null))switch(j){case"value":pe=p;break;case"defaultValue":ve=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(a(91));break;default:p!==S&&Gt(s,i,j,p,d,S)}$g(s,pe,ve);return;case"option":for(var at in c)if(pe=c[at],c.hasOwnProperty(at)&&pe!=null&&!d.hasOwnProperty(at))switch(at){case"selected":s.selected=!1;break;default:Gt(s,i,at,null,d,pe)}for(J in d)if(pe=d[J],ve=c[J],d.hasOwnProperty(J)&&pe!==ve&&(pe!=null||ve!=null))switch(J){case"selected":s.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:Gt(s,i,J,pe,d,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in c)pe=c[Ke],c.hasOwnProperty(Ke)&&pe!=null&&!d.hasOwnProperty(Ke)&&Gt(s,i,Ke,null,d,pe);for(he in d)if(pe=d[he],ve=c[he],d.hasOwnProperty(he)&&pe!==ve&&(pe!=null||ve!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,i));break;default:Gt(s,i,he,pe,d,ve)}return;default:if(sh(i)){for(var Vt in c)pe=c[Vt],c.hasOwnProperty(Vt)&&pe!==void 0&&!d.hasOwnProperty(Vt)&&Gx(s,i,Vt,void 0,d,pe);for(Se in d)pe=d[Se],ve=c[Se],!d.hasOwnProperty(Se)||pe===ve||pe===void 0&&ve===void 0||Gx(s,i,Se,pe,d,ve);return}}for(var oe in c)pe=c[oe],c.hasOwnProperty(oe)&&pe!=null&&!d.hasOwnProperty(oe)&&Gt(s,i,oe,null,d,pe);for(Ce in d)pe=d[Ce],ve=c[Ce],!d.hasOwnProperty(Ce)||pe===ve||pe==null&&ve==null||Gt(s,i,Ce,pe,d,ve)}var Vx=null,qx=null;function pf(s){return s.nodeType===9?s:s.ownerDocument}function Qy(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zy(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Wx(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Xx=null;function uT(){var s=window.event;return s&&s.type==="popstate"?s===Xx?!1:(Xx=s,!0):(Xx=null,!1)}var Jy=typeof setTimeout=="function"?setTimeout:void 0,fT=typeof clearTimeout=="function"?clearTimeout:void 0,e2=typeof Promise=="function"?Promise:void 0,dT=typeof queueMicrotask=="function"?queueMicrotask:typeof e2<"u"?function(s){return e2.resolve(null).then(s).catch(hT)}:Jy;function hT(s){setTimeout(function(){throw s})}function fi(s){return s==="head"}function t2(s,i){var c=i,d=0,p=0;do{var S=c.nextSibling;if(s.removeChild(c),S&&S.nodeType===8)if(c=S.data,c==="/$"){if(0<d&&8>d){c=d;var j=s.ownerDocument;if(c&1&&$c(j.documentElement),c&2&&$c(j.body),c&4)for(c=j.head,$c(c),j=c.firstChild;j;){var P=j.nextSibling,J=j.nodeName;j[I]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&j.rel.toLowerCase()==="stylesheet"||c.removeChild(j),j=P}}if(p===0){s.removeChild(S),a0(i);return}p--}else c==="$"||c==="$?"||c==="$!"?p++:d=c.charCodeAt(0)-48;else d=0;c=S}while(c);a0(i)}function Yx(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Yx(c),H(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function xT(s,i,c,d){for(;s.nodeType===1;){var p=c;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[I])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(S=s.getAttribute("rel"),S==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(S!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(S=s.getAttribute("src"),(S!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&S&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var S=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===S)return s}else return s;if(s=Dn(s.nextSibling),s===null)break}return null}function mT(s,i,c){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Dn(s.nextSibling),s===null))return null;return s}function $x(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function pT(s,i){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Dn(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var Kx=null;function r2(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}function a2(s,i,c){switch(i=pf(c),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function $c(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);H(s)}var dn=new Map,n2=new Set;function gf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ks=ie.d;ie.d={f:gT,r:vT,D:yT,C:bT,L:wT,m:ST,X:_T,S:ET,M:kT};function gT(){var s=ks.f(),i=of();return s||i}function vT(s){var i=Y(s);i!==null&&i.tag===5&&i.type==="form"?_v(i):ks.r(s)}var wo=typeof document>"u"?null:document;function s2(s,i,c){var d=wo;if(d&&typeof i=="string"&&i){var p=nn(i);p='link[rel="'+s+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),n2.has(p)||(n2.add(p),s={rel:s,crossOrigin:c,href:i},d.querySelector(p)===null&&(i=d.createElement("link"),Jr(i,"link",s),ue(i),d.head.appendChild(i)))}}function yT(s){ks.D(s),s2("dns-prefetch",s,null)}function bT(s,i){ks.C(s,i),s2("preconnect",s,i)}function wT(s,i,c){ks.L(s,i,c);var d=wo;if(d&&s&&i){var p='link[rel="preload"][as="'+nn(i)+'"]';i==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+nn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+nn(c.imageSizes)+'"]')):p+='[href="'+nn(s)+'"]';var S=p;switch(i){case"style":S=So(s);break;case"script":S=Eo(s)}dn.has(S)||(s=m({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:s,as:i},c),dn.set(S,s),d.querySelector(p)!==null||i==="style"&&d.querySelector(Kc(S))||i==="script"&&d.querySelector(Qc(S))||(i=d.createElement("link"),Jr(i,"link",s),ue(i),d.head.appendChild(i)))}}function ST(s,i){ks.m(s,i);var c=wo;if(c&&s){var d=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+nn(d)+'"][href="'+nn(s)+'"]',S=p;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Eo(s)}if(!dn.has(S)&&(s=m({rel:"modulepreload",href:s},i),dn.set(S,s),c.querySelector(p)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Qc(S)))return}d=c.createElement("link"),Jr(d,"link",s),ue(d),c.head.appendChild(d)}}}function ET(s,i,c){ks.S(s,i,c);var d=wo;if(d&&s){var p=be(d).hoistableStyles,S=So(s);i=i||"default";var j=p.get(S);if(!j){var P={loading:0,preload:null};if(j=d.querySelector(Kc(S)))P.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":i},c),(c=dn.get(S))&&Qx(s,c);var J=j=d.createElement("link");ue(J),Jr(J,"link",s),J._p=new Promise(function(he,Se){J.onload=he,J.onerror=Se}),J.addEventListener("load",function(){P.loading|=1}),J.addEventListener("error",function(){P.loading|=2}),P.loading|=4,vf(j,i,d)}j={type:"stylesheet",instance:j,count:1,state:P},p.set(S,j)}}}function _T(s,i){ks.X(s,i);var c=wo;if(c&&s){var d=be(c).hoistableScripts,p=Eo(s),S=d.get(p);S||(S=c.querySelector(Qc(p)),S||(s=m({src:s,async:!0},i),(i=dn.get(p))&&Zx(s,i),S=c.createElement("script"),ue(S),Jr(S,"link",s),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},d.set(p,S))}}function kT(s,i){ks.M(s,i);var c=wo;if(c&&s){var d=be(c).hoistableScripts,p=Eo(s),S=d.get(p);S||(S=c.querySelector(Qc(p)),S||(s=m({src:s,async:!0,type:"module"},i),(i=dn.get(p))&&Zx(s,i),S=c.createElement("script"),ue(S),Jr(S,"link",s),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},d.set(p,S))}}function i2(s,i,c,d){var p=(p=le.current)?gf(p):null;if(!p)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=So(c.href),c=be(p).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=So(c.href);var S=be(p).hoistableStyles,j=S.get(s);if(j||(p=p.ownerDocument||p,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(s,j),(S=p.querySelector(Kc(s)))&&!S._p&&(j.instance=S,j.state.loading=5),dn.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},dn.set(s,c),S||TT(p,s,c,j.state))),i&&d===null)throw Error(a(528,""));return j}if(i&&d!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Eo(c),c=be(p).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function So(s){return'href="'+nn(s)+'"'}function Kc(s){return'link[rel="stylesheet"]['+s+"]"}function l2(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function TT(s,i,c,d){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=s.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),Jr(i,"link",c),ue(i),s.head.appendChild(i))}function Eo(s){return'[src="'+nn(s)+'"]'}function Qc(s){return"script[async]"+s}function o2(s,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=s.querySelector('style[data-href~="'+nn(c.href)+'"]');if(d)return i.instance=d,ue(d),d;var p=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),ue(d),Jr(d,"style",p),vf(d,c.precedence,s),i.instance=d;case"stylesheet":p=So(c.href);var S=s.querySelector(Kc(p));if(S)return i.state.loading|=4,i.instance=S,ue(S),S;d=l2(c),(p=dn.get(p))&&Qx(d,p),S=(s.ownerDocument||s).createElement("link"),ue(S);var j=S;return j._p=new Promise(function(P,J){j.onload=P,j.onerror=J}),Jr(S,"link",d),i.state.loading|=4,vf(S,c.precedence,s),i.instance=S;case"script":return S=Eo(c.src),(p=s.querySelector(Qc(S)))?(i.instance=p,ue(p),p):(d=c,(p=dn.get(S))&&(d=m({},c),Zx(d,p)),s=s.ownerDocument||s,p=s.createElement("script"),ue(p),Jr(p,"link",d),s.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,vf(d,c.precedence,s));return i.instance}function vf(s,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=d.length?d[d.length-1]:null,S=p,j=0;j<d.length;j++){var P=d[j];if(P.dataset.precedence===i)S=P;else if(S!==p)break}S?S.parentNode.insertBefore(s,S.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(s,i.firstChild))}function Qx(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function Zx(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var yf=null;function c2(s,i,c){if(yf===null){var d=new Map,p=yf=new Map;p.set(c,d)}else p=yf,d=p.get(c),d||(d=new Map,p.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),p=0;p<c.length;p++){var S=c[p];if(!(S[I]||S[wr]||s==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var j=S.getAttribute(i)||"";j=s+j;var P=d.get(j);P?P.push(S):d.set(j,[S])}}return d}function u2(s,i,c){s=s.ownerDocument||s,s.head.insertBefore(c,i==="title"?s.querySelector("head > title"):null)}function NT(s,i,c){if(c===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function f2(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Zc=null;function CT(){}function AT(s,i,c){if(Zc===null)throw Error(a(475));var d=Zc;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var p=So(c.href),S=s.querySelector(Kc(p));if(S){s=S._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=bf.bind(d),s.then(d,d)),i.state.loading|=4,i.instance=S,ue(S);return}S=s.ownerDocument||s,c=l2(c),(p=dn.get(p))&&Qx(c,p),S=S.createElement("link"),ue(S);var j=S;j._p=new Promise(function(P,J){j.onload=P,j.onerror=J}),Jr(S,"link",c),i.instance=S}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(d.count++,i=bf.bind(d),s.addEventListener("load",i),s.addEventListener("error",i))}}function jT(){if(Zc===null)throw Error(a(475));var s=Zc;return s.stylesheets&&s.count===0&&Jx(s,s.stylesheets),0<s.count?function(i){var c=setTimeout(function(){if(s.stylesheets&&Jx(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(c)}}:null}function bf(){if(this.count--,this.count===0){if(this.stylesheets)Jx(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var wf=null;function Jx(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,wf=new Map,i.forEach(RT,s),wf=null,bf.call(s))}function RT(s,i){if(!(i.state.loading&4)){var c=wf.get(s);if(c)var d=c.get(null);else{c=new Map,wf.set(s,c);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<p.length;S++){var j=p[S];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(c.set(j.dataset.precedence,j),d=j)}d&&c.set(null,d)}p=i.instance,j=p.getAttribute("data-precedence"),S=c.get(j)||d,S===d&&c.set(null,p),c.set(j,p),this.count++,d=bf.bind(this),p.addEventListener("load",d),p.addEventListener("error",d),S?S.parentNode.insertBefore(p,S.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),i.state.loading|=4}}var Jc={$$typeof:_,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function DT(s,i,c,d,p,S,j,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ws(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ws(0),this.hiddenUpdates=Ws(null),this.identifierPrefix=d,this.onUncaughtError=p,this.onCaughtError=S,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function d2(s,i,c,d,p,S,j,P,J,he,Se,Ce){return s=new DT(s,i,c,j,P,J,he,Ce),i=1,S===!0&&(i|=24),S=Va(3,null,null,i),s.current=S,S.stateNode=s,i=Oh(),i.refCount++,s.pooledCache=i,i.refCount++,S.memoizedState={element:d,isDehydrated:c,cache:i},Ph(S),s}function h2(s){return s?(s=Jl,s):Jl}function x2(s,i,c,d,p,S){p=h2(p),d.context===null?d.context=p:d.pendingContext=p,d=Zs(i),d.payload={element:c},S=S===void 0?null:S,S!==null&&(d.callback=S),c=Js(s,d,i),c!==null&&($a(c,s,i),Ac(c,s,i))}function m2(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function em(s,i){m2(s,i),(s=s.alternate)&&m2(s,i)}function p2(s){if(s.tag===13){var i=Zl(s,67108864);i!==null&&$a(i,s,67108864),em(s,67108864)}}var Sf=!0;function FT(s,i,c,d){var p=ee.T;ee.T=null;var S=ie.p;try{ie.p=2,tm(s,i,c,d)}finally{ie.p=S,ee.T=p}}function OT(s,i,c,d){var p=ee.T;ee.T=null;var S=ie.p;try{ie.p=8,tm(s,i,c,d)}finally{ie.p=S,ee.T=p}}function tm(s,i,c,d){if(Sf){var p=rm(d);if(p===null)Hx(s,i,d,Ef,c),v2(s,d);else if(LT(p,s,i,c,d))d.stopPropagation();else if(v2(s,d),i&4&&-1<MT.indexOf(s)){for(;p!==null;){var S=Y(p);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var j=za(S.pendingLanes);if(j!==0){var P=S;for(P.pendingLanes|=2,P.entangledLanes|=2;j;){var J=1<<31-st(j);P.entanglements[1]|=J,j&=~J}Kn(S),(Mt&6)===0&&(sf=Oe()+500,Wc(0))}}break;case 13:P=Zl(S,2),P!==null&&$a(P,S,2),of(),em(S,2)}if(S=rm(d),S===null&&Hx(s,i,d,Ef,c),S===p)break;p=S}p!==null&&d.stopPropagation()}else Hx(s,i,d,null,c)}}function rm(s){return s=lh(s),am(s)}var Ef=null;function am(s){if(Ef=null,s=W(s),s!==null){var i=l(s);if(i===null)s=null;else{var c=i.tag;if(c===13){if(s=o(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Ef=s,null}function g2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case fr:return 2;case Kr:return 8;case Hr:case Ca:return 32;case Pe:return 268435456;default:return 32}default:return 32}}var nm=!1,di=null,hi=null,xi=null,e0=new Map,t0=new Map,mi=[],MT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function v2(s,i){switch(s){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":hi=null;break;case"mouseover":case"mouseout":xi=null;break;case"pointerover":case"pointerout":e0.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":t0.delete(i.pointerId)}}function r0(s,i,c,d,p,S){return s===null||s.nativeEvent!==S?(s={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:S,targetContainers:[p]},i!==null&&(i=Y(i),i!==null&&p2(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),s)}function LT(s,i,c,d,p){switch(i){case"focusin":return di=r0(di,s,i,c,d,p),!0;case"dragenter":return hi=r0(hi,s,i,c,d,p),!0;case"mouseover":return xi=r0(xi,s,i,c,d,p),!0;case"pointerover":var S=p.pointerId;return e0.set(S,r0(e0.get(S)||null,s,i,c,d,p)),!0;case"gotpointercapture":return S=p.pointerId,t0.set(S,r0(t0.get(S)||null,s,i,c,d,p)),!0}return!1}function y2(s){var i=W(s.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){s.blockedOn=i,Xs(s.priority,function(){if(c.tag===13){var d=Ya();d=rt(d);var p=Zl(c,d);p!==null&&$a(p,c,d),em(c,d)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function _f(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=rm(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);ih=d,c.target.dispatchEvent(d),ih=null}else return i=Y(c),i!==null&&p2(i),s.blockedOn=c,!1;i.shift()}return!0}function b2(s,i,c){_f(s)&&c.delete(i)}function BT(){nm=!1,di!==null&&_f(di)&&(di=null),hi!==null&&_f(hi)&&(hi=null),xi!==null&&_f(xi)&&(xi=null),e0.forEach(b2),t0.forEach(b2)}function kf(s,i){s.blockedOn===i&&(s.blockedOn=null,nm||(nm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,BT)))}var Tf=null;function w2(s){Tf!==s&&(Tf=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Tf===s&&(Tf=null);for(var i=0;i<s.length;i+=3){var c=s[i],d=s[i+1],p=s[i+2];if(typeof d!="function"){if(am(d||c)===null)continue;break}var S=Y(c);S!==null&&(s.splice(i,3),i-=3,ax(S,{pending:!0,data:p,method:c.method,action:d},d,p))}}))}function a0(s){function i(J){return kf(J,s)}di!==null&&kf(di,s),hi!==null&&kf(hi,s),xi!==null&&kf(xi,s),e0.forEach(i),t0.forEach(i);for(var c=0;c<mi.length;c++){var d=mi[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<mi.length&&(c=mi[0],c.blockedOn===null);)y2(c),c.blockedOn===null&&mi.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var p=c[d],S=c[d+1],j=p[Sr]||null;if(typeof S=="function")j||w2(c);else if(j){var P=null;if(S&&S.hasAttribute("formAction")){if(p=S,j=S[Sr]||null)P=j.formAction;else if(am(p)!==null)continue}else P=j.action;typeof P=="function"?c[d+1]=P:(c.splice(d,3),d-=3),w2(c)}}}function sm(s){this._internalRoot=s}Nf.prototype.render=sm.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,d=Ya();x2(c,d,s,i,null,null)},Nf.prototype.unmount=sm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;x2(s.current,2,null,s,null,null),of(),i[Nn]=null}};function Nf(s){this._internalRoot=s}Nf.prototype.unstable_scheduleHydration=function(s){if(s){var i=br();s={blockedOn:null,target:s,priority:i};for(var c=0;c<mi.length&&i!==0&&i<mi[c].priority;c++);mi.splice(c,0,s),c===0&&y2(s)}};var S2=t.version;if(S2!=="19.1.0")throw Error(a(527,S2,"19.1.0"));ie.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=h(i),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var PT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cf.isDisabled&&Cf.supportsFiber)try{yr=Cf.inject(PT),lr=Cf}catch{}}return s0.createRoot=function(s,i){if(!n(s))throw Error(a(299));var c=!1,d="",p=Pv,S=Iv,j=Uv,P=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(S=i.onCaughtError),i.onRecoverableError!==void 0&&(j=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(P=i.unstable_transitionCallbacks)),i=d2(s,1,!1,null,null,c,d,p,S,j,P,null),s[Nn]=i.current,zx(s),new sm(i)},s0.hydrateRoot=function(s,i,c){if(!n(s))throw Error(a(299));var d=!1,p="",S=Pv,j=Iv,P=Uv,J=null,he=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(j=c.onCaughtError),c.onRecoverableError!==void 0&&(P=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(J=c.unstable_transitionCallbacks),c.formState!==void 0&&(he=c.formState)),i=d2(s,1,!0,i,c??null,d,p,S,j,P,J,he),i.context=h2(null),c=i.current,d=Ya(),d=rt(d),p=Zs(d),p.callback=null,Js(c,p,d),c=d,i.current.lanes=c,re(i,c),Kn(i),s[Nn]=i.current,zx(s),new Nf(i)},s0.version="19.1.0",s0}var F2;function YT(){if(F2)return cm.exports;F2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),cm.exports=XT(),cm.exports}var $T=YT(),i0={},O2;function KT(){if(O2)return i0;O2=1,Object.defineProperty(i0,"__esModule",{value:!0}),i0.parse=o,i0.serialize=x;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,l=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,b){const y=new l,w=v.length;if(w<2)return y;const E=(b==null?void 0:b.decode)||m;let k=0;do{const N=v.indexOf("=",k);if(N===-1)break;const _=v.indexOf(";",k),R=_===-1?w:_;if(N>R){k=v.lastIndexOf(";",N-1)+1;continue}const A=u(v,k,N),D=h(v,N,A),T=v.slice(A,D);if(y[T]===void 0){let F=u(v,N+1,R),O=h(v,R,F);const U=E(v.slice(F,O));y[T]=U}k=R+1}while(k<w);return y}function u(v,b,y){do{const w=v.charCodeAt(b);if(w!==32&&w!==9)return b}while(++b<y);return y}function h(v,b,y){for(;b>y;){const w=v.charCodeAt(--b);if(w!==32&&w!==9)return b+1}return y}function x(v,b,y){const w=(y==null?void 0:y.encode)||encodeURIComponent;if(!e.test(v))throw new TypeError(`argument name is invalid: ${v}`);const E=w(b);if(!t.test(E))throw new TypeError(`argument val is invalid: ${b}`);let k=v+"="+E;if(!y)return k;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);k+="; Max-Age="+y.maxAge}if(y.domain){if(!r.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);k+="; Domain="+y.domain}if(y.path){if(!a.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);k+="; Path="+y.path}if(y.expires){if(!g(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);k+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(k+="; HttpOnly"),y.secure&&(k+="; Secure"),y.partitioned&&(k+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return k}function m(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function g(v){return n.call(v)==="[object Date]"}return i0}KT();var M2="popstate";function QT(e={}){function t(a,n){let{pathname:l,search:o,hash:u}=a.location;return Hm("",{pathname:l,search:o,hash:u},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:T0(n)}return JT(t,r,null,e)}function ir(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function En(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ZT(){return Math.random().toString(36).substring(2,10)}function L2(e,t){return{usr:e.state,key:e.key,idx:t}}function Hm(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Jo(t):t,state:r,key:t&&t.key||a||ZT()}}function T0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Jo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function JT(e,t,r,a={}){let{window:n=document.defaultView,v5Compat:l=!1}=a,o=n.history,u="POP",h=null,x=m();x==null&&(x=0,o.replaceState({...o.state,idx:x},""));function m(){return(o.state||{idx:null}).idx}function g(){u="POP";let E=m(),k=E==null?null:E-x;x=E,h&&h({action:u,location:w.location,delta:k})}function v(E,k){u="PUSH";let N=Hm(w.location,E,k);x=m()+1;let _=L2(N,x),R=w.createHref(N);try{o.pushState(_,"",R)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;n.location.assign(R)}l&&h&&h({action:u,location:w.location,delta:1})}function b(E,k){u="REPLACE";let N=Hm(w.location,E,k);x=m();let _=L2(N,x),R=w.createHref(N);o.replaceState(_,"",R),l&&h&&h({action:u,location:w.location,delta:0})}function y(E){return e3(E)}let w={get action(){return u},get location(){return e(n,o)},listen(E){if(h)throw new Error("A history only accepts one active listener");return n.addEventListener(M2,g),h=E,()=>{n.removeEventListener(M2,g),h=null}},createHref(E){return t(n,E)},createURL:y,encodeLocation(E){let k=y(E);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:v,replace:b,go(E){return o.go(E)}};return w}function e3(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),ir(r,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:T0(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function iS(e,t,r="/"){return t3(e,t,r,!1)}function t3(e,t,r,a){let n=typeof t=="string"?Jo(t):t,l=Bs(n.pathname||"/",r);if(l==null)return null;let o=lS(e);r3(o);let u=null;for(let h=0;u==null&&h<o.length;++h){let x=h3(l);u=f3(o[h],x,a)}return u}function lS(e,t=[],r=[],a=""){let n=(l,o,u)=>{let h={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};h.relativePath.startsWith("/")&&(ir(h.relativePath.startsWith(a),`Absolute route path "${h.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(a.length));let x=Ds([a,h.relativePath]),m=r.concat(h);l.children&&l.children.length>0&&(ir(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),lS(l.children,t,m,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:c3(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))n(l,o);else for(let h of oS(l.path))n(l,o,h)}),t}function oS(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),l=r.replace(/\?$/,"");if(a.length===0)return n?[l,""]:[l];let o=oS(a.join("/")),u=[];return u.push(...o.map(h=>h===""?l:[l,h].join("/"))),n&&u.push(...o),u.map(h=>e.startsWith("/")&&h===""?"/":h)}function r3(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:u3(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var a3=/^:[\w-]+$/,n3=3,s3=2,i3=1,l3=10,o3=-2,B2=e=>e==="*";function c3(e,t){let r=e.split("/"),a=r.length;return r.some(B2)&&(a+=o3),t&&(a+=s3),r.filter(n=>!B2(n)).reduce((n,l)=>n+(a3.test(l)?n3:l===""?i3:l3),a)}function u3(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function f3(e,t,r=!1){let{routesMeta:a}=e,n={},l="/",o=[];for(let u=0;u<a.length;++u){let h=a[u],x=u===a.length-1,m=l==="/"?t:t.slice(l.length)||"/",g=cd({path:h.relativePath,caseSensitive:h.caseSensitive,end:x},m),v=h.route;if(!g&&x&&r&&!a[a.length-1].route.index&&(g=cd({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!g)return null;Object.assign(n,g.params),o.push({params:n,pathname:Ds([l,g.pathname]),pathnameBase:g3(Ds([l,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(l=Ds([l,g.pathnameBase]))}return o}function cd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=d3(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let l=n[0],o=l.replace(/(.)\/+$/,"$1"),u=n.slice(1);return{params:a.reduce((x,{paramName:m,isOptional:g},v)=>{if(m==="*"){let y=u[v]||"";o=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const b=u[v];return g&&!b?x[m]=void 0:x[m]=(b||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function d3(e,t=!1,r=!0){En(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,h)=>(a.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function h3(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return En(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Bs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function x3(e,t="/"){let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?Jo(e):e;return{pathname:r?r.startsWith("/")?r:m3(r,t):t,search:v3(a),hash:y3(n)}}function m3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function hm(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function p3(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Rp(e){let t=p3(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function Dp(e,t,r,a=!1){let n;typeof e=="string"?n=Jo(e):(n={...e},ir(!n.pathname||!n.pathname.includes("?"),hm("?","pathname","search",n)),ir(!n.pathname||!n.pathname.includes("#"),hm("#","pathname","hash",n)),ir(!n.search||!n.search.includes("#"),hm("#","search","hash",n)));let l=e===""||n.pathname==="",o=l?"/":n.pathname,u;if(o==null)u=r;else{let g=t.length-1;if(!a&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),g-=1;n.pathname=v.join("/")}u=g>=0?t[g]:"/"}let h=x3(n,u),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(x||m)&&(h.pathname+="/"),h}var Ds=e=>e.join("/").replace(/\/\/+/g,"/"),g3=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),v3=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,y3=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function b3(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var cS=["POST","PUT","PATCH","DELETE"];new Set(cS);var w3=["GET",...cS];new Set(w3);var ec=C.createContext(null);ec.displayName="DataRouter";var Ad=C.createContext(null);Ad.displayName="DataRouterState";var uS=C.createContext({isTransitioning:!1});uS.displayName="ViewTransition";var S3=C.createContext(new Map);S3.displayName="Fetchers";var E3=C.createContext(null);E3.displayName="Await";var Hn=C.createContext(null);Hn.displayName="Navigation";var Z0=C.createContext(null);Z0.displayName="Location";var kn=C.createContext({outlet:null,matches:[],isDataRoute:!1});kn.displayName="Route";var Fp=C.createContext(null);Fp.displayName="RouteError";function _3(e,{relative:t}={}){ir(tc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=C.useContext(Hn),{hash:n,pathname:l,search:o}=J0(e,{relative:t}),u=l;return r!=="/"&&(u=l==="/"?r:Ds([r,l])),a.createHref({pathname:u,search:o,hash:n})}function tc(){return C.useContext(Z0)!=null}function ls(){return ir(tc(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(Z0).location}var fS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dS(e){C.useContext(Hn).static||C.useLayoutEffect(e)}function Na(){let{isDataRoute:e}=C.useContext(kn);return e?I3():k3()}function k3(){ir(tc(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(ec),{basename:t,navigator:r}=C.useContext(Hn),{matches:a}=C.useContext(kn),{pathname:n}=ls(),l=JSON.stringify(Rp(a)),o=C.useRef(!1);return dS(()=>{o.current=!0}),C.useCallback((h,x={})=>{if(En(o.current,fS),!o.current)return;if(typeof h=="number"){r.go(h);return}let m=Dp(h,JSON.parse(l),n,x.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Ds([t,m.pathname])),(x.replace?r.replace:r.push)(m,x.state,x)},[t,r,l,n,e])}var T3=C.createContext(null);function N3(e){let t=C.useContext(kn).outlet;return t&&C.createElement(T3.Provider,{value:e},t)}function Gn(){let{matches:e}=C.useContext(kn),t=e[e.length-1];return t?t.params:{}}function J0(e,{relative:t}={}){let{matches:r}=C.useContext(kn),{pathname:a}=ls(),n=JSON.stringify(Rp(r));return C.useMemo(()=>Dp(e,JSON.parse(n),a,t==="path"),[e,n,a,t])}function C3(e,t){return hS(e,t)}function hS(e,t,r,a){var k;ir(tc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=C.useContext(Hn),{matches:l}=C.useContext(kn),o=l[l.length-1],u=o?o.params:{},h=o?o.pathname:"/",x=o?o.pathnameBase:"/",m=o&&o.route;{let N=m&&m.path||"";xS(h,!m||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let g=ls(),v;if(t){let N=typeof t=="string"?Jo(t):t;ir(x==="/"||((k=N.pathname)==null?void 0:k.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=g;let b=v.pathname||"/",y=b;if(x!=="/"){let N=x.replace(/^\//,"").split("/");y="/"+b.replace(/^\//,"").split("/").slice(N.length).join("/")}let w=iS(e,{pathname:y});En(m||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),En(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=F3(w&&w.map(N=>Object.assign({},N,{params:Object.assign({},u,N.params),pathname:Ds([x,n.encodeLocation?n.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?x:Ds([x,n.encodeLocation?n.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,r,a);return t&&E?C.createElement(Z0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function A3(){let e=P3(),t=b3(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:l},"ErrorBoundary")," or"," ",C.createElement("code",{style:l},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:n},r):null,o)}var j3=C.createElement(A3,null),R3=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(kn.Provider,{value:this.props.routeContext},C.createElement(Fp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function D3({routeContext:e,match:t,children:r}){let a=C.useContext(ec);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(kn.Provider,{value:e},r)}function F3(e,t=[],r=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,l=r==null?void 0:r.errors;if(l!=null){let h=n.findIndex(x=>x.route.id&&(l==null?void 0:l[x.route.id])!==void 0);ir(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),n=n.slice(0,Math.min(n.length,h+1))}let o=!1,u=-1;if(r)for(let h=0;h<n.length;h++){let x=n[h];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(u=h),x.route.id){let{loaderData:m,errors:g}=r,v=x.route.loader&&!m.hasOwnProperty(x.route.id)&&(!g||g[x.route.id]===void 0);if(x.route.lazy||v){o=!0,u>=0?n=n.slice(0,u+1):n=[n[0]];break}}}return n.reduceRight((h,x,m)=>{let g,v=!1,b=null,y=null;r&&(g=l&&x.route.id?l[x.route.id]:void 0,b=x.route.errorElement||j3,o&&(u<0&&m===0?(xS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,y=null):u===m&&(v=!0,y=x.route.hydrateFallbackElement||null)));let w=t.concat(n.slice(0,m+1)),E=()=>{let k;return g?k=b:v?k=y:x.route.Component?k=C.createElement(x.route.Component,null):x.route.element?k=x.route.element:k=h,C.createElement(D3,{match:x,routeContext:{outlet:h,matches:w,isDataRoute:r!=null},children:k})};return r&&(x.route.ErrorBoundary||x.route.errorElement||m===0)?C.createElement(R3,{location:r.location,revalidation:r.revalidation,component:b,error:g,children:E(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):E()},null)}function Op(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function O3(e){let t=C.useContext(ec);return ir(t,Op(e)),t}function M3(e){let t=C.useContext(Ad);return ir(t,Op(e)),t}function L3(e){let t=C.useContext(kn);return ir(t,Op(e)),t}function Mp(e){let t=L3(e),r=t.matches[t.matches.length-1];return ir(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function B3(){return Mp("useRouteId")}function P3(){var a;let e=C.useContext(Fp),t=M3("useRouteError"),r=Mp("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[r]}function I3(){let{router:e}=O3("useNavigate"),t=Mp("useNavigate"),r=C.useRef(!1);return dS(()=>{r.current=!0}),C.useCallback(async(n,l={})=>{En(r.current,fS),r.current&&(typeof n=="number"?e.navigate(n):await e.navigate(n,{fromRouteId:t,...l}))},[e,t])}var P2={};function xS(e,t,r){!t&&!P2[e]&&(P2[e]=!0,En(!1,r))}C.memo(U3);function U3({routes:e,future:t,state:r}){return hS(e,void 0,r,t)}function xm({to:e,replace:t,state:r,relative:a}){ir(tc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=C.useContext(Hn);En(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=C.useContext(kn),{pathname:o}=ls(),u=Na(),h=Dp(e,Rp(l),o,a==="path"),x=JSON.stringify(h);return C.useEffect(()=>{u(JSON.parse(x),{replace:t,state:r,relative:a})},[u,x,a,t,r]),null}function js(e){return N3(e.context)}function ut(e){ir(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function z3({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:l=!1}){ir(!tc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:o,navigator:n,static:l,future:{}}),[o,n,l]);typeof r=="string"&&(r=Jo(r));let{pathname:h="/",search:x="",hash:m="",state:g=null,key:v="default"}=r,b=C.useMemo(()=>{let y=Bs(h,o);return y==null?null:{location:{pathname:y,search:x,hash:m,state:g,key:v},navigationType:a}},[o,h,x,m,g,v,a]);return En(b!=null,`<Router basename="${o}"> is not able to match the URL "${h}${x}${m}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:C.createElement(Hn.Provider,{value:u},C.createElement(Z0.Provider,{children:t,value:b}))}function H3({children:e,location:t}){return C3(Gm(e),t)}function Gm(e,t=[]){let r=[];return C.Children.forEach(e,(a,n)=>{if(!C.isValidElement(a))return;let l=[...t,n];if(a.type===C.Fragment){r.push.apply(r,Gm(a.props.children,l));return}ir(a.type===ut,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ir(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=Gm(a.props.children,l)),r.push(o)}),r}var Zf="get",Jf="application/x-www-form-urlencoded";function jd(e){return e!=null&&typeof e.tagName=="string"}function G3(e){return jd(e)&&e.tagName.toLowerCase()==="button"}function V3(e){return jd(e)&&e.tagName.toLowerCase()==="form"}function q3(e){return jd(e)&&e.tagName.toLowerCase()==="input"}function W3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function X3(e,t){return e.button===0&&(!t||t==="_self")&&!W3(e)}function Vm(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function Y3(e,t){let r=Vm(e);return t&&t.forEach((a,n)=>{r.has(n)||t.getAll(n).forEach(l=>{r.append(n,l)})}),r}var Rf=null;function $3(){if(Rf===null)try{new FormData(document.createElement("form"),0),Rf=!1}catch{Rf=!0}return Rf}var K3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mm(e){return e!=null&&!K3.has(e)?(En(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jf}"`),null):e}function Q3(e,t){let r,a,n,l,o;if(V3(e)){let u=e.getAttribute("action");a=u?Bs(u,t):null,r=e.getAttribute("method")||Zf,n=mm(e.getAttribute("enctype"))||Jf,l=new FormData(e)}else if(G3(e)||q3(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=e.getAttribute("formaction")||u.getAttribute("action");if(a=h?Bs(h,t):null,r=e.getAttribute("formmethod")||u.getAttribute("method")||Zf,n=mm(e.getAttribute("formenctype"))||mm(u.getAttribute("enctype"))||Jf,l=new FormData(u,e),!$3()){let{name:x,type:m,value:g}=e;if(m==="image"){let v=x?`${x}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else x&&l.append(x,g)}}else{if(jd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Zf,a=null,n=Jf,o=e}return l&&n==="text/plain"&&(o=l,l=void 0),{action:a,method:r.toLowerCase(),encType:n,formData:l,body:o}}function Lp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function Z3(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function J3(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function eN(e,t,r){let a=await Promise.all(e.map(async n=>{let l=t.routes[n.route.id];if(l){let o=await Z3(l,r);return o.links?o.links():[]}return[]}));return nN(a.flat(1).filter(J3).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function I2(e,t,r,a,n,l){let o=(h,x)=>r[x]?h.route.id!==r[x].route.id:!0,u=(h,x)=>{var m;return r[x].pathname!==h.pathname||((m=r[x].route.path)==null?void 0:m.endsWith("*"))&&r[x].params["*"]!==h.params["*"]};return l==="assets"?t.filter((h,x)=>o(h,x)||u(h,x)):l==="data"?t.filter((h,x)=>{var g;let m=a.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(o(h,x)||u(h,x))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function tN(e,t,{includeHydrateFallback:r}={}){return rN(e.map(a=>{let n=t.routes[a.route.id];if(!n)return[];let l=[n.module];return n.clientActionModule&&(l=l.concat(n.clientActionModule)),n.clientLoaderModule&&(l=l.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(l=l.concat(n.hydrateFallbackModule)),n.imports&&(l=l.concat(n.imports)),l}).flat(1))}function rN(e){return[...new Set(e)]}function aN(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function nN(e,t){let r=new Set;return new Set(t),e.reduce((a,n)=>{let l=JSON.stringify(aN(n));return r.has(l)||(r.add(l),a.push({key:l,link:n})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var sN=new Set([100,101,204,205]);function iN(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Bs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function mS(){let e=C.useContext(ec);return Lp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function lN(){let e=C.useContext(Ad);return Lp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Bp=C.createContext(void 0);Bp.displayName="FrameworkContext";function pS(){let e=C.useContext(Bp);return Lp(e,"You must render this element inside a <HydratedRouter> element"),e}function oN(e,t){let r=C.useContext(Bp),[a,n]=C.useState(!1),[l,o]=C.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:x,onMouseLeave:m,onTouchStart:g}=t,v=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let w=k=>{k.forEach(N=>{o(N.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[e]),C.useEffect(()=>{if(a){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[a]);let b=()=>{n(!0)},y=()=>{n(!1),o(!1)};return r?e!=="intent"?[l,v,{}]:[l,v,{onFocus:l0(u,b),onBlur:l0(h,y),onMouseEnter:l0(x,b),onMouseLeave:l0(m,y),onTouchStart:l0(g,b)}]:[!1,v,{}]}function l0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function cN({page:e,...t}){let{router:r}=mS(),a=C.useMemo(()=>iS(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?C.createElement(fN,{page:e,matches:a,...t}):null}function uN(e){let{manifest:t,routeModules:r}=pS(),[a,n]=C.useState([]);return C.useEffect(()=>{let l=!1;return eN(e,t,r).then(o=>{l||n(o)}),()=>{l=!0}},[e,t,r]),a}function fN({page:e,matches:t,...r}){let a=ls(),{manifest:n,routeModules:l}=pS(),{basename:o}=mS(),{loaderData:u,matches:h}=lN(),x=C.useMemo(()=>I2(e,t,h,n,a,"data"),[e,t,h,n,a]),m=C.useMemo(()=>I2(e,t,h,n,a,"assets"),[e,t,h,n,a]),g=C.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let y=new Set,w=!1;if(t.forEach(k=>{var _;let N=n.routes[k.route.id];!N||!N.hasLoader||(!x.some(R=>R.route.id===k.route.id)&&k.route.id in u&&((_=l[k.route.id])!=null&&_.shouldRevalidate)||N.hasClientLoader?w=!0:y.add(k.route.id))}),y.size===0)return[];let E=iN(e,o);return w&&y.size>0&&E.searchParams.set("_routes",t.filter(k=>y.has(k.route.id)).map(k=>k.route.id).join(",")),[E.pathname+E.search]},[o,u,a,n,x,t,e,l]),v=C.useMemo(()=>tN(m,n),[m,n]),b=uN(m);return C.createElement(C.Fragment,null,g.map(y=>C.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),v.map(y=>C.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),b.map(({key:y,link:w})=>C.createElement("link",{key:y,...w})))}function dN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var gS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{gS&&(window.__reactRouterVersion="7.6.2")}catch{}function hN({basename:e,children:t,window:r}){let a=C.useRef();a.current==null&&(a.current=QT({window:r,v5Compat:!0}));let n=a.current,[l,o]=C.useState({action:n.action,location:n.location}),u=C.useCallback(h=>{C.startTransition(()=>o(h))},[o]);return C.useLayoutEffect(()=>n.listen(u),[n,u]),C.createElement(z3,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:n})}var vS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eu=C.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:n,reloadDocument:l,replace:o,state:u,target:h,to:x,preventScrollReset:m,viewTransition:g,...v},b){let{basename:y}=C.useContext(Hn),w=typeof x=="string"&&vS.test(x),E,k=!1;if(typeof x=="string"&&w&&(E=x,gS))try{let O=new URL(window.location.href),U=x.startsWith("//")?new URL(O.protocol+x):new URL(x),q=Bs(U.pathname,y);U.origin===O.origin&&q!=null?x=q+U.search+U.hash:k=!0}catch{En(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=_3(x,{relative:n}),[_,R,A]=oN(a,v),D=pN(x,{replace:o,state:u,target:h,preventScrollReset:m,relative:n,viewTransition:g});function T(O){t&&t(O),O.defaultPrevented||D(O)}let F=C.createElement("a",{...v,...A,href:E||N,onClick:k||l?t:T,ref:dN(b,R),target:h,"data-discover":!w&&r==="render"?"true":void 0});return _&&!w?C.createElement(C.Fragment,null,F,C.createElement(cN,{page:N})):F});eu.displayName="Link";var N0=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:n=!1,style:l,to:o,viewTransition:u,children:h,...x},m){let g=J0(o,{relative:x.relative}),v=ls(),b=C.useContext(Ad),{navigator:y,basename:w}=C.useContext(Hn),E=b!=null&&SN(g)&&u===!0,k=y.encodeLocation?y.encodeLocation(g).pathname:g.pathname,N=v.pathname,_=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(N=N.toLowerCase(),_=_?_.toLowerCase():null,k=k.toLowerCase()),_&&w&&(_=Bs(_,w)||_);const R=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let A=N===k||!n&&N.startsWith(k)&&N.charAt(R)==="/",D=_!=null&&(_===k||!n&&_.startsWith(k)&&_.charAt(k.length)==="/"),T={isActive:A,isPending:D,isTransitioning:E},F=A?t:void 0,O;typeof a=="function"?O=a(T):O=[a,A?"active":null,D?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let U=typeof l=="function"?l(T):l;return C.createElement(eu,{...x,"aria-current":F,className:O,ref:m,style:U,to:o,viewTransition:u},typeof h=="function"?h(T):h)});N0.displayName="NavLink";var xN=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:l,method:o=Zf,action:u,onSubmit:h,relative:x,preventScrollReset:m,viewTransition:g,...v},b)=>{let y=bN(),w=wN(u,{relative:x}),E=o.toLowerCase()==="get"?"get":"post",k=typeof u=="string"&&vS.test(u),N=_=>{if(h&&h(_),_.defaultPrevented)return;_.preventDefault();let R=_.nativeEvent.submitter,A=(R==null?void 0:R.getAttribute("formmethod"))||o;y(R||_.currentTarget,{fetcherKey:t,method:A,navigate:r,replace:n,state:l,relative:x,preventScrollReset:m,viewTransition:g})};return C.createElement("form",{ref:b,method:E,action:w,onSubmit:a?h:N,...v,"data-discover":!k&&e==="render"?"true":void 0})});xN.displayName="Form";function mN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yS(e){let t=C.useContext(ec);return ir(t,mN(e)),t}function pN(e,{target:t,replace:r,state:a,preventScrollReset:n,relative:l,viewTransition:o}={}){let u=Na(),h=ls(),x=J0(e,{relative:l});return C.useCallback(m=>{if(X3(m,t)){m.preventDefault();let g=r!==void 0?r:T0(h)===T0(x);u(e,{replace:g,state:a,preventScrollReset:n,relative:l,viewTransition:o})}},[h,u,x,r,a,t,e,n,l,o])}function gN(e){En(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=C.useRef(Vm(e)),r=C.useRef(!1),a=ls(),n=C.useMemo(()=>Y3(a.search,r.current?null:t.current),[a.search]),l=Na(),o=C.useCallback((u,h)=>{const x=Vm(typeof u=="function"?u(n):u);r.current=!0,l("?"+x,h)},[l,n]);return[n,o]}var vN=0,yN=()=>`__${String(++vN)}__`;function bN(){let{router:e}=yS("useSubmit"),{basename:t}=C.useContext(Hn),r=B3();return C.useCallback(async(a,n={})=>{let{action:l,method:o,encType:u,formData:h,body:x}=Q3(a,t);if(n.navigate===!1){let m=n.fetcherKey||yN();await e.fetch(m,r,n.action||l,{preventScrollReset:n.preventScrollReset,formData:h,body:x,formMethod:n.method||o,formEncType:n.encType||u,flushSync:n.flushSync})}else await e.navigate(n.action||l,{preventScrollReset:n.preventScrollReset,formData:h,body:x,formMethod:n.method||o,formEncType:n.encType||u,replace:n.replace,state:n.state,fromRouteId:r,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,r])}function wN(e,{relative:t}={}){let{basename:r}=C.useContext(Hn),a=C.useContext(kn);ir(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),l={...J0(e||".",{relative:t})},o=ls();if(e==null){l.search=o.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(m=>m==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let m=u.toString();l.search=m?`?${m}`:""}}return(!e||e===".")&&n.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:Ds([r,l.pathname])),T0(l)}function SN(e,t={}){let r=C.useContext(uS);ir(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=yS("useViewTransitionState"),n=J0(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=Bs(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=Bs(r.nextLocation.pathname,a)||r.nextLocation.pathname;return cd(n.pathname,o)!=null||cd(n.pathname,l)!=null}[...sN];var bS=Cd();const wS=C.createContext({theme:"light",toggle:()=>{}}),EN=()=>C.useContext(wS);function _N({children:e}){const[t,r]=C.useState("light"),a=()=>r(n=>n==="light"?"dark":"light");return C.useEffect(()=>{document.documentElement.classList.toggle("dark",t==="dark")},[t]),f.jsx(wS.Provider,{value:{theme:t,toggle:a},children:e})}function SS(e,t){return function(){return e.apply(t,arguments)}}const{toString:kN}=Object.prototype,{getPrototypeOf:Pp}=Object,{iterator:Rd,toStringTag:ES}=Symbol,Dd=(e=>t=>{const r=kN.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Vn=e=>(e=e.toLowerCase(),t=>Dd(t)===e),Fd=e=>t=>typeof t===e,{isArray:rc}=Array,C0=Fd("undefined");function TN(e){return e!==null&&!C0(e)&&e.constructor!==null&&!C0(e.constructor)&&Ba(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _S=Vn("ArrayBuffer");function NN(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&_S(e.buffer),t}const CN=Fd("string"),Ba=Fd("function"),kS=Fd("number"),Od=e=>e!==null&&typeof e=="object",AN=e=>e===!0||e===!1,ed=e=>{if(Dd(e)!=="object")return!1;const t=Pp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ES in e)&&!(Rd in e)},jN=Vn("Date"),RN=Vn("File"),DN=Vn("Blob"),FN=Vn("FileList"),ON=e=>Od(e)&&Ba(e.pipe),MN=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ba(e.append)&&((t=Dd(e))==="formdata"||t==="object"&&Ba(e.toString)&&e.toString()==="[object FormData]"))},LN=Vn("URLSearchParams"),[BN,PN,IN,UN]=["ReadableStream","Request","Response","Headers"].map(Vn),zN=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tu(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),rc(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let u;for(a=0;a<o;a++)u=l[a],t.call(null,e[u],u,e)}}function TS(e,t){t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ul=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,NS=e=>!C0(e)&&e!==ul;function qm(){const{caseless:e}=NS(this)&&this||{},t={},r=(a,n)=>{const l=e&&TS(t,n)||n;ed(t[l])&&ed(a)?t[l]=qm(t[l],a):ed(a)?t[l]=qm({},a):rc(a)?t[l]=a.slice():t[l]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&tu(arguments[a],r);return t}const HN=(e,t,r,{allOwnKeys:a}={})=>(tu(t,(n,l)=>{r&&Ba(n)?e[l]=SS(n,r):e[l]=n},{allOwnKeys:a}),e),GN=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),VN=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},qN=(e,t,r,a)=>{let n,l,o;const u={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),l=n.length;l-- >0;)o=n[l],(!a||a(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=r!==!1&&Pp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},WN=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},XN=e=>{if(!e)return null;if(rc(e))return e;let t=e.length;if(!kS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},YN=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Pp(Uint8Array)),$N=(e,t)=>{const a=(e&&e[Rd]).call(e);let n;for(;(n=a.next())&&!n.done;){const l=n.value;t.call(e,l[0],l[1])}},KN=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},QN=Vn("HTMLFormElement"),ZN=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),U2=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),JN=Vn("RegExp"),CS=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};tu(r,(n,l)=>{let o;(o=t(n,l,e))!==!1&&(a[l]=o||n)}),Object.defineProperties(e,a)},eC=e=>{CS(e,(t,r)=>{if(Ba(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(Ba(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},tC=(e,t)=>{const r={},a=n=>{n.forEach(l=>{r[l]=!0})};return rc(e)?a(e):a(String(e).split(t)),r},rC=()=>{},aC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function nC(e){return!!(e&&Ba(e.append)&&e[ES]==="FormData"&&e[Rd])}const sC=e=>{const t=new Array(10),r=(a,n)=>{if(Od(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[n]=a;const l=rc(a)?[]:{};return tu(a,(o,u)=>{const h=r(o,n+1);!C0(h)&&(l[u]=h)}),t[n]=void 0,l}}return a};return r(e,0)},iC=Vn("AsyncFunction"),lC=e=>e&&(Od(e)||Ba(e))&&Ba(e.then)&&Ba(e.catch),AS=((e,t)=>e?setImmediate:t?((r,a)=>(ul.addEventListener("message",({source:n,data:l})=>{n===ul&&l===r&&a.length&&a.shift()()},!1),n=>{a.push(n),ul.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ba(ul.postMessage)),oC=typeof queueMicrotask<"u"?queueMicrotask.bind(ul):typeof process<"u"&&process.nextTick||AS,cC=e=>e!=null&&Ba(e[Rd]),ye={isArray:rc,isArrayBuffer:_S,isBuffer:TN,isFormData:MN,isArrayBufferView:NN,isString:CN,isNumber:kS,isBoolean:AN,isObject:Od,isPlainObject:ed,isReadableStream:BN,isRequest:PN,isResponse:IN,isHeaders:UN,isUndefined:C0,isDate:jN,isFile:RN,isBlob:DN,isRegExp:JN,isFunction:Ba,isStream:ON,isURLSearchParams:LN,isTypedArray:YN,isFileList:FN,forEach:tu,merge:qm,extend:HN,trim:zN,stripBOM:GN,inherits:VN,toFlatObject:qN,kindOf:Dd,kindOfTest:Vn,endsWith:WN,toArray:XN,forEachEntry:$N,matchAll:KN,isHTMLForm:QN,hasOwnProperty:U2,hasOwnProp:U2,reduceDescriptors:CS,freezeMethods:eC,toObjectSet:tC,toCamelCase:ZN,noop:rC,toFiniteNumber:aC,findKey:TS,global:ul,isContextDefined:NS,isSpecCompliantForm:nC,toJSONObject:sC,isAsyncFn:iC,isThenable:lC,setImmediate:AS,asap:oC,isIterable:cC};function ft(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}ye.inherits(ft,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ye.toJSONObject(this.config),code:this.code,status:this.status}}});const jS=ft.prototype,RS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{RS[e]={value:e}});Object.defineProperties(ft,RS);Object.defineProperty(jS,"isAxiosError",{value:!0});ft.from=(e,t,r,a,n,l)=>{const o=Object.create(jS);return ye.toFlatObject(e,o,function(h){return h!==Error.prototype},u=>u!=="isAxiosError"),ft.call(o,e.message,t,r,a,n),o.cause=e,o.name=e.name,l&&Object.assign(o,l),o};const uC=null;function Wm(e){return ye.isPlainObject(e)||ye.isArray(e)}function DS(e){return ye.endsWith(e,"[]")?e.slice(0,-2):e}function z2(e,t,r){return e?e.concat(t).map(function(n,l){return n=DS(n),!r&&l?"["+n+"]":n}).join(r?".":""):t}function fC(e){return ye.isArray(e)&&!e.some(Wm)}const dC=ye.toFlatObject(ye,{},null,function(t){return/^is[A-Z]/.test(t)});function Md(e,t,r){if(!ye.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ye.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,E){return!ye.isUndefined(E[w])});const a=r.metaTokens,n=r.visitor||m,l=r.dots,o=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&ye.isSpecCompliantForm(t);if(!ye.isFunction(n))throw new TypeError("visitor must be a function");function x(y){if(y===null)return"";if(ye.isDate(y))return y.toISOString();if(!h&&ye.isBlob(y))throw new ft("Blob is not supported. Use a Buffer instead.");return ye.isArrayBuffer(y)||ye.isTypedArray(y)?h&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,w,E){let k=y;if(y&&!E&&typeof y=="object"){if(ye.endsWith(w,"{}"))w=a?w:w.slice(0,-2),y=JSON.stringify(y);else if(ye.isArray(y)&&fC(y)||(ye.isFileList(y)||ye.endsWith(w,"[]"))&&(k=ye.toArray(y)))return w=DS(w),k.forEach(function(_,R){!(ye.isUndefined(_)||_===null)&&t.append(o===!0?z2([w],R,l):o===null?w:w+"[]",x(_))}),!1}return Wm(y)?!0:(t.append(z2(E,w,l),x(y)),!1)}const g=[],v=Object.assign(dC,{defaultVisitor:m,convertValue:x,isVisitable:Wm});function b(y,w){if(!ye.isUndefined(y)){if(g.indexOf(y)!==-1)throw Error("Circular reference detected in "+w.join("."));g.push(y),ye.forEach(y,function(k,N){(!(ye.isUndefined(k)||k===null)&&n.call(t,k,ye.isString(N)?N.trim():N,w,v))===!0&&b(k,w?w.concat(N):[N])}),g.pop()}}if(!ye.isObject(e))throw new TypeError("data must be an object");return b(e),t}function H2(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function Ip(e,t){this._pairs=[],e&&Md(e,this,t)}const FS=Ip.prototype;FS.append=function(t,r){this._pairs.push([t,r])};FS.toString=function(t){const r=t?function(a){return t.call(this,a,H2)}:H2;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function hC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function OS(e,t,r){if(!t)return e;const a=r&&r.encode||hC;ye.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(t,r):l=ye.isURLSearchParams(t)?t.toString():new Ip(t,r).toString(a),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class G2{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ye.forEach(this.handlers,function(a){a!==null&&t(a)})}}const MS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xC=typeof URLSearchParams<"u"?URLSearchParams:Ip,mC=typeof FormData<"u"?FormData:null,pC=typeof Blob<"u"?Blob:null,gC={isBrowser:!0,classes:{URLSearchParams:xC,FormData:mC,Blob:pC},protocols:["http","https","file","blob","url","data"]},Up=typeof window<"u"&&typeof document<"u",Xm=typeof navigator=="object"&&navigator||void 0,vC=Up&&(!Xm||["ReactNative","NativeScript","NS"].indexOf(Xm.product)<0),yC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",bC=Up&&window.location.href||"http://localhost",wC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Up,hasStandardBrowserEnv:vC,hasStandardBrowserWebWorkerEnv:yC,navigator:Xm,origin:bC},Symbol.toStringTag,{value:"Module"})),da={...wC,...gC};function SC(e,t){return Md(e,new da.classes.URLSearchParams,Object.assign({visitor:function(r,a,n,l){return da.isNode&&ye.isBuffer(r)?(this.append(a,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function EC(e){return ye.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function _C(e){const t={},r=Object.keys(e);let a;const n=r.length;let l;for(a=0;a<n;a++)l=r[a],t[l]=e[l];return t}function LS(e){function t(r,a,n,l){let o=r[l++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),h=l>=r.length;return o=!o&&ye.isArray(n)?n.length:o,h?(ye.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!u):((!n[o]||!ye.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],l)&&ye.isArray(n[o])&&(n[o]=_C(n[o])),!u)}if(ye.isFormData(e)&&ye.isFunction(e.entries)){const r={};return ye.forEachEntry(e,(a,n)=>{t(EC(a),n,r,0)}),r}return null}function kC(e,t,r){if(ye.isString(e))try{return(t||JSON.parse)(e),ye.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const ru={transitional:MS,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,l=ye.isObject(t);if(l&&ye.isHTMLForm(t)&&(t=new FormData(t)),ye.isFormData(t))return n?JSON.stringify(LS(t)):t;if(ye.isArrayBuffer(t)||ye.isBuffer(t)||ye.isStream(t)||ye.isFile(t)||ye.isBlob(t)||ye.isReadableStream(t))return t;if(ye.isArrayBufferView(t))return t.buffer;if(ye.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return SC(t,this.formSerializer).toString();if((u=ye.isFileList(t))||a.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Md(u?{"files[]":t}:t,h&&new h,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),kC(t)):t}],transformResponse:[function(t){const r=this.transitional||ru.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(ye.isResponse(t)||ye.isReadableStream(t))return t;if(t&&ye.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?ft.from(u,ft.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:da.classes.FormData,Blob:da.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ye.forEach(["delete","get","head","post","put","patch"],e=>{ru.headers[e]={}});const TC=ye.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NC=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&TC[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},V2=Symbol("internals");function o0(e){return e&&String(e).trim().toLowerCase()}function td(e){return e===!1||e==null?e:ye.isArray(e)?e.map(td):String(e)}function CC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const AC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function pm(e,t,r,a,n){if(ye.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!ye.isString(t)){if(ye.isString(a))return t.indexOf(a)!==-1;if(ye.isRegExp(a))return a.test(t)}}function jC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function RC(e,t){const r=ye.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,l,o){return this[a].call(this,t,n,l,o)},configurable:!0})})}let Pa=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function l(u,h,x){const m=o0(h);if(!m)throw new Error("header name must be a non-empty string");const g=ye.findKey(n,m);(!g||n[g]===void 0||x===!0||x===void 0&&n[g]!==!1)&&(n[g||h]=td(u))}const o=(u,h)=>ye.forEach(u,(x,m)=>l(x,m,h));if(ye.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ye.isString(t)&&(t=t.trim())&&!AC(t))o(NC(t),r);else if(ye.isObject(t)&&ye.isIterable(t)){let u={},h,x;for(const m of t){if(!ye.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[x=m[0]]=(h=u[x])?ye.isArray(h)?[...h,m[1]]:[h,m[1]]:m[1]}o(u,r)}else t!=null&&l(r,t,a);return this}get(t,r){if(t=o0(t),t){const a=ye.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return CC(n);if(ye.isFunction(r))return r.call(this,n,a);if(ye.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=o0(t),t){const a=ye.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||pm(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function l(o){if(o=o0(o),o){const u=ye.findKey(a,o);u&&(!r||pm(a,a[u],u,r))&&(delete a[u],n=!0)}}return ye.isArray(t)?t.forEach(l):l(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const l=r[a];(!t||pm(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const r=this,a={};return ye.forEach(this,(n,l)=>{const o=ye.findKey(a,l);if(o){r[o]=td(n),delete r[l];return}const u=t?jC(l):String(l).trim();u!==l&&delete r[l],r[u]=td(n),a[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ye.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&ye.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[V2]=this[V2]={accessors:{}}).accessors,n=this.prototype;function l(o){const u=o0(o);a[u]||(RC(n,o),a[u]=!0)}return ye.isArray(t)?t.forEach(l):l(t),this}};Pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ye.reduceDescriptors(Pa.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});ye.freezeMethods(Pa);function gm(e,t){const r=this||ru,a=t||r,n=Pa.from(a.headers);let l=a.data;return ye.forEach(e,function(u){l=u.call(r,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function BS(e){return!!(e&&e.__CANCEL__)}function ac(e,t,r){ft.call(this,e??"canceled",ft.ERR_CANCELED,t,r),this.name="CanceledError"}ye.inherits(ac,ft,{__CANCEL__:!0});function PS(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new ft("Request failed with status code "+r.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function DC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function FC(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,l=0,o;return t=t!==void 0?t:1e3,function(h){const x=Date.now(),m=a[l];o||(o=x),r[n]=h,a[n]=x;let g=l,v=0;for(;g!==n;)v+=r[g++],g=g%e;if(n=(n+1)%e,n===l&&(l=(l+1)%e),x-o<t)return;const b=m&&x-m;return b?Math.round(v*1e3/b):void 0}}function OC(e,t){let r=0,a=1e3/t,n,l;const o=(x,m=Date.now())=>{r=m,n=null,l&&(clearTimeout(l),l=null),e.apply(null,x)};return[(...x)=>{const m=Date.now(),g=m-r;g>=a?o(x,m):(n=x,l||(l=setTimeout(()=>{l=null,o(n)},a-g)))},()=>n&&o(n)]}const ud=(e,t,r=3)=>{let a=0;const n=FC(50,250);return OC(l=>{const o=l.loaded,u=l.lengthComputable?l.total:void 0,h=o-a,x=n(h),m=o<=u;a=o;const g={loaded:o,total:u,progress:u?o/u:void 0,bytes:h,rate:x||void 0,estimated:x&&u&&m?(u-o)/x:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(g)},r)},q2=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},W2=e=>(...t)=>ye.asap(()=>e(...t)),MC=da.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,da.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(da.origin),da.navigator&&/(msie|trident)/i.test(da.navigator.userAgent)):()=>!0,LC=da.hasStandardBrowserEnv?{write(e,t,r,a,n,l){const o=[e+"="+encodeURIComponent(t)];ye.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),ye.isString(a)&&o.push("path="+a),ye.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function BC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function PC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function IS(e,t,r){let a=!BC(t);return e&&(a||r==!1)?PC(e,t):t}const X2=e=>e instanceof Pa?{...e}:e;function Nl(e,t){t=t||{};const r={};function a(x,m,g,v){return ye.isPlainObject(x)&&ye.isPlainObject(m)?ye.merge.call({caseless:v},x,m):ye.isPlainObject(m)?ye.merge({},m):ye.isArray(m)?m.slice():m}function n(x,m,g,v){if(ye.isUndefined(m)){if(!ye.isUndefined(x))return a(void 0,x,g,v)}else return a(x,m,g,v)}function l(x,m){if(!ye.isUndefined(m))return a(void 0,m)}function o(x,m){if(ye.isUndefined(m)){if(!ye.isUndefined(x))return a(void 0,x)}else return a(void 0,m)}function u(x,m,g){if(g in t)return a(x,m);if(g in e)return a(void 0,x)}const h={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(x,m,g)=>n(X2(x),X2(m),g,!0)};return ye.forEach(Object.keys(Object.assign({},e,t)),function(m){const g=h[m]||n,v=g(e[m],t[m],m);ye.isUndefined(v)&&g!==u||(r[m]=v)}),r}const US=e=>{const t=Nl({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:u}=t;t.headers=o=Pa.from(o),t.url=OS(IS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let h;if(ye.isFormData(r)){if(da.hasStandardBrowserEnv||da.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((h=o.getContentType())!==!1){const[x,...m]=h?h.split(";").map(g=>g.trim()).filter(Boolean):[];o.setContentType([x||"multipart/form-data",...m].join("; "))}}if(da.hasStandardBrowserEnv&&(a&&ye.isFunction(a)&&(a=a(t)),a||a!==!1&&MC(t.url))){const x=n&&l&&LC.read(l);x&&o.set(n,x)}return t},IC=typeof XMLHttpRequest<"u",UC=IC&&function(e){return new Promise(function(r,a){const n=US(e);let l=n.data;const o=Pa.from(n.headers).normalize();let{responseType:u,onUploadProgress:h,onDownloadProgress:x}=n,m,g,v,b,y;function w(){b&&b(),y&&y(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function k(){if(!E)return;const _=Pa.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),A={data:!u||u==="text"||u==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:_,config:e,request:E};PS(function(T){r(T),w()},function(T){a(T),w()},A),E=null}"onloadend"in E?E.onloadend=k:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(k)},E.onabort=function(){E&&(a(new ft("Request aborted",ft.ECONNABORTED,e,E)),E=null)},E.onerror=function(){a(new ft("Network Error",ft.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let R=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||MS;n.timeoutErrorMessage&&(R=n.timeoutErrorMessage),a(new ft(R,A.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,e,E)),E=null},l===void 0&&o.setContentType(null),"setRequestHeader"in E&&ye.forEach(o.toJSON(),function(R,A){E.setRequestHeader(A,R)}),ye.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),u&&u!=="json"&&(E.responseType=n.responseType),x&&([v,y]=ud(x,!0),E.addEventListener("progress",v)),h&&E.upload&&([g,b]=ud(h),E.upload.addEventListener("progress",g),E.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(m=_=>{E&&(a(!_||_.type?new ac(null,e,E):_),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const N=DC(n.url);if(N&&da.protocols.indexOf(N)===-1){a(new ft("Unsupported protocol "+N+":",ft.ERR_BAD_REQUEST,e));return}E.send(l||null)})},zC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const l=function(x){if(!n){n=!0,u();const m=x instanceof Error?x:this.reason;a.abort(m instanceof ft?m:new ac(m instanceof Error?m.message:m))}};let o=t&&setTimeout(()=>{o=null,l(new ft(`timeout ${t} of ms exceeded`,ft.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:h}=a;return h.unsubscribe=()=>ye.asap(u),h}},HC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},GC=async function*(e,t){for await(const r of VC(e))yield*HC(r,t)},VC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},Y2=(e,t,r,a)=>{const n=GC(e,t);let l=0,o,u=h=>{o||(o=!0,a&&a(h))};return new ReadableStream({async pull(h){try{const{done:x,value:m}=await n.next();if(x){u(),h.close();return}let g=m.byteLength;if(r){let v=l+=g;r(v)}h.enqueue(new Uint8Array(m))}catch(x){throw u(x),x}},cancel(h){return u(h),n.return()}},{highWaterMark:2})},Ld=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",zS=Ld&&typeof ReadableStream=="function",qC=Ld&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),HS=(e,...t)=>{try{return!!e(...t)}catch{return!1}},WC=zS&&HS(()=>{let e=!1;const t=new Request(da.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),$2=64*1024,Ym=zS&&HS(()=>ye.isReadableStream(new Response("").body)),fd={stream:Ym&&(e=>e.body)};Ld&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!fd[t]&&(fd[t]=ye.isFunction(e[t])?r=>r[t]():(r,a)=>{throw new ft(`Response type '${t}' is not supported`,ft.ERR_NOT_SUPPORT,a)})})})(new Response);const XC=async e=>{if(e==null)return 0;if(ye.isBlob(e))return e.size;if(ye.isSpecCompliantForm(e))return(await new Request(da.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ye.isArrayBufferView(e)||ye.isArrayBuffer(e))return e.byteLength;if(ye.isURLSearchParams(e)&&(e=e+""),ye.isString(e))return(await qC(e)).byteLength},YC=async(e,t)=>{const r=ye.toFiniteNumber(e.getContentLength());return r??XC(t)},$C=Ld&&(async e=>{let{url:t,method:r,data:a,signal:n,cancelToken:l,timeout:o,onDownloadProgress:u,onUploadProgress:h,responseType:x,headers:m,withCredentials:g="same-origin",fetchOptions:v}=US(e);x=x?(x+"").toLowerCase():"text";let b=zC([n,l&&l.toAbortSignal()],o),y;const w=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let E;try{if(h&&WC&&r!=="get"&&r!=="head"&&(E=await YC(m,a))!==0){let A=new Request(t,{method:"POST",body:a,duplex:"half"}),D;if(ye.isFormData(a)&&(D=A.headers.get("content-type"))&&m.setContentType(D),A.body){const[T,F]=q2(E,ud(W2(h)));a=Y2(A.body,$2,T,F)}}ye.isString(g)||(g=g?"include":"omit");const k="credentials"in Request.prototype;y=new Request(t,{...v,signal:b,method:r.toUpperCase(),headers:m.normalize().toJSON(),body:a,duplex:"half",credentials:k?g:void 0});let N=await fetch(y);const _=Ym&&(x==="stream"||x==="response");if(Ym&&(u||_&&w)){const A={};["status","statusText","headers"].forEach(O=>{A[O]=N[O]});const D=ye.toFiniteNumber(N.headers.get("content-length")),[T,F]=u&&q2(D,ud(W2(u),!0))||[];N=new Response(Y2(N.body,$2,T,()=>{F&&F(),w&&w()}),A)}x=x||"text";let R=await fd[ye.findKey(fd,x)||"text"](N,e);return!_&&w&&w(),await new Promise((A,D)=>{PS(A,D,{data:R,headers:Pa.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:y})})}catch(k){throw w&&w(),k&&k.name==="TypeError"&&/Load failed|fetch/i.test(k.message)?Object.assign(new ft("Network Error",ft.ERR_NETWORK,e,y),{cause:k.cause||k}):ft.from(k,k&&k.code,e,y)}}),$m={http:uC,xhr:UC,fetch:$C};ye.forEach($m,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const K2=e=>`- ${e}`,KC=e=>ye.isFunction(e)||e===null||e===!1,GS={getAdapter:e=>{e=ye.isArray(e)?e:[e];const{length:t}=e;let r,a;const n={};for(let l=0;l<t;l++){r=e[l];let o;if(a=r,!KC(r)&&(a=$m[(o=String(r)).toLowerCase()],a===void 0))throw new ft(`Unknown adapter '${o}'`);if(a)break;n[o||"#"+l]=a}if(!a){const l=Object.entries(n).map(([u,h])=>`adapter ${u} `+(h===!1?"is not supported by the environment":"is not available in the build"));let o=t?l.length>1?`since :
`+l.map(K2).join(`
`):" "+K2(l[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:$m};function vm(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ac(null,e)}function Q2(e){return vm(e),e.headers=Pa.from(e.headers),e.data=gm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),GS.getAdapter(e.adapter||ru.adapter)(e).then(function(a){return vm(e),a.data=gm.call(e,e.transformResponse,a),a.headers=Pa.from(a.headers),a},function(a){return BS(a)||(vm(e),a&&a.response&&(a.response.data=gm.call(e,e.transformResponse,a.response),a.response.headers=Pa.from(a.response.headers))),Promise.reject(a)})}const VS="1.9.0",Bd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Bd[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Z2={};Bd.transitional=function(t,r,a){function n(l,o){return"[Axios v"+VS+"] Transitional option '"+l+"'"+o+(a?". "+a:"")}return(l,o,u)=>{if(t===!1)throw new ft(n(o," has been removed"+(r?" in "+r:"")),ft.ERR_DEPRECATED);return r&&!Z2[o]&&(Z2[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,o,u):!0}};Bd.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function QC(e,t,r){if(typeof e!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const l=a[n],o=t[l];if(o){const u=e[l],h=u===void 0||o(u,l,e);if(h!==!0)throw new ft("option "+l+" must be "+h,ft.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ft("Unknown option "+l,ft.ERR_BAD_OPTION)}}const rd={assertOptions:QC,validators:Bd},Qn=rd.validators;let Sl=class{constructor(t){this.defaults=t||{},this.interceptors={request:new G2,response:new G2}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Nl(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:l}=r;a!==void 0&&rd.assertOptions(a,{silentJSONParsing:Qn.transitional(Qn.boolean),forcedJSONParsing:Qn.transitional(Qn.boolean),clarifyTimeoutError:Qn.transitional(Qn.boolean)},!1),n!=null&&(ye.isFunction(n)?r.paramsSerializer={serialize:n}:rd.assertOptions(n,{encode:Qn.function,serialize:Qn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),rd.assertOptions(r,{baseUrl:Qn.spelling("baseURL"),withXsrfToken:Qn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&ye.merge(l.common,l[r.method]);l&&ye.forEach(["delete","get","head","post","put","patch","common"],y=>{delete l[y]}),r.headers=Pa.concat(o,l);const u=[];let h=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(r)===!1||(h=h&&w.synchronous,u.unshift(w.fulfilled,w.rejected))});const x=[];this.interceptors.response.forEach(function(w){x.push(w.fulfilled,w.rejected)});let m,g=0,v;if(!h){const y=[Q2.bind(this),void 0];for(y.unshift.apply(y,u),y.push.apply(y,x),v=y.length,m=Promise.resolve(r);g<v;)m=m.then(y[g++],y[g++]);return m}v=u.length;let b=r;for(g=0;g<v;){const y=u[g++],w=u[g++];try{b=y(b)}catch(E){w.call(this,E);break}}try{m=Q2.call(this,b)}catch(y){return Promise.reject(y)}for(g=0,v=x.length;g<v;)m=m.then(x[g++],x[g++]);return m}getUri(t){t=Nl(this.defaults,t);const r=IS(t.baseURL,t.url,t.allowAbsoluteUrls);return OS(r,t.params,t.paramsSerializer)}};ye.forEach(["delete","get","head","options"],function(t){Sl.prototype[t]=function(r,a){return this.request(Nl(a||{},{method:t,url:r,data:(a||{}).data}))}});ye.forEach(["post","put","patch"],function(t){function r(a){return function(l,o,u){return this.request(Nl(u||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Sl.prototype[t]=r(),Sl.prototype[t+"Form"]=r(!0)});let ZC=class qS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const a=this;this.promise.then(n=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](n);a._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(u=>{a.subscribe(u),l=u}).then(n);return o.cancel=function(){a.unsubscribe(l)},o},t(function(l,o,u){a.reason||(a.reason=new ac(l,o,u),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new qS(function(n){t=n}),cancel:t}}};function JC(e){return function(r){return e.apply(null,r)}}function eA(e){return ye.isObject(e)&&e.isAxiosError===!0}const Km={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Km).forEach(([e,t])=>{Km[t]=e});function WS(e){const t=new Sl(e),r=SS(Sl.prototype.request,t);return ye.extend(r,Sl.prototype,t,{allOwnKeys:!0}),ye.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return WS(Nl(e,n))},r}const Cr=WS(ru);Cr.Axios=Sl;Cr.CanceledError=ac;Cr.CancelToken=ZC;Cr.isCancel=BS;Cr.VERSION=VS;Cr.toFormData=Md;Cr.AxiosError=ft;Cr.Cancel=Cr.CanceledError;Cr.all=function(t){return Promise.all(t)};Cr.spread=JC;Cr.isAxiosError=eA;Cr.mergeConfig=Nl;Cr.AxiosHeaders=Pa;Cr.formToJSON=e=>LS(ye.isHTMLForm(e)?new FormData(e):e);Cr.getAdapter=GS.getAdapter;Cr.HttpStatusCode=Km;Cr.default=Cr;const{Axios:UU,AxiosError:zU,CanceledError:HU,isCancel:GU,CancelToken:VU,VERSION:qU,all:WU,Cancel:XU,isAxiosError:YU,spread:$U,toFormData:KU,AxiosHeaders:QU,HttpStatusCode:ZU,formToJSON:JU,getAdapter:ez,mergeConfig:tz}=Cr,Qe=Cr.create({baseURL:"https://api.bigdaysmanager.com/api/v1",withCredentials:!0,headers:{"Content-Type":"application/json"}});Qe.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const r="abcd1234",a="my-big-day-prod";return e.headers.apiKey=r,e.headers.author=a,e});var nc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Cl=typeof window>"u"||"Deno"in globalThis;function wa(){}function tA(e,t){return typeof e=="function"?e(t):e}function Qm(e){return typeof e=="number"&&e>=0&&e!==1/0}function XS(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Mi(e,t){return typeof e=="function"?e(t):e}function Bn(e,t){return typeof e=="function"?e(t):e}function J2(e,t){const{type:r="all",exact:a,fetchStatus:n,predicate:l,queryKey:o,stale:u}=e;if(o){if(a){if(t.queryHash!==zp(o,t.options))return!1}else if(!A0(t.queryKey,o))return!1}if(r!=="all"){const h=t.isActive();if(r==="active"&&!h||r==="inactive"&&h)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||n&&n!==t.state.fetchStatus||l&&!l(t))}function eb(e,t){const{exact:r,status:a,predicate:n,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(Al(t.options.mutationKey)!==Al(l))return!1}else if(!A0(t.options.mutationKey,l))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function zp(e,t){return((t==null?void 0:t.queryKeyHashFn)||Al)(e)}function Al(e){return JSON.stringify(e,(t,r)=>Zm(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function A0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>A0(e[r],t[r])):!1}function YS(e,t){if(e===t)return e;const r=tb(e)&&tb(t);if(r||Zm(e)&&Zm(t)){const a=r?e:Object.keys(e),n=a.length,l=r?t:Object.keys(t),o=l.length,u=r?[]:{},h=new Set(a);let x=0;for(let m=0;m<o;m++){const g=r?m:l[m];(!r&&h.has(g)||r)&&e[g]===void 0&&t[g]===void 0?(u[g]=void 0,x++):(u[g]=YS(e[g],t[g]),u[g]===e[g]&&e[g]!==void 0&&x++)}return n===o&&x===n?e:u}return t}function dd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function tb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Zm(e){if(!rb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!rb(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function rb(e){return Object.prototype.toString.call(e)==="[object Object]"}function rA(e){return new Promise(t=>{setTimeout(t,e)})}function Jm(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?YS(e,t):t}function aA(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function nA(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var Hp=Symbol();function $S(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Hp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function KS(e,t){return typeof e=="function"?e(...t):!!e}var xl,Si,Lo,$w,sA=($w=class extends nc{constructor(){super();Ye(this,xl);Ye(this,Si);Ye(this,Lo);Ge(this,Lo,t=>{if(!Cl&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ae(this,Si)||this.setEventListener(ae(this,Lo))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,Si))==null||t.call(this),Ge(this,Si,void 0))}setEventListener(t){var r;Ge(this,Lo,t),(r=ae(this,Si))==null||r.call(this),Ge(this,Si,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){ae(this,xl)!==t&&(Ge(this,xl,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ae(this,xl)=="boolean"?ae(this,xl):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},xl=new WeakMap,Si=new WeakMap,Lo=new WeakMap,$w),Gp=new sA,Bo,Ei,Po,Kw,iA=(Kw=class extends nc{constructor(){super();Ye(this,Bo,!0);Ye(this,Ei);Ye(this,Po);Ge(this,Po,t=>{if(!Cl&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){ae(this,Ei)||this.setEventListener(ae(this,Po))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,Ei))==null||t.call(this),Ge(this,Ei,void 0))}setEventListener(t){var r;Ge(this,Po,t),(r=ae(this,Ei))==null||r.call(this),Ge(this,Ei,t(this.setOnline.bind(this)))}setOnline(t){ae(this,Bo)!==t&&(Ge(this,Bo,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return ae(this,Bo)}},Bo=new WeakMap,Ei=new WeakMap,Po=new WeakMap,Kw),hd=new iA;function ep(){let e,t;const r=new Promise((n,l)=>{e=n,t=l});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),e(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function lA(e){return Math.min(1e3*2**e,3e4)}function QS(e){return(e??"online")==="online"?hd.isOnline():!0}var ZS=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ym(e){return e instanceof ZS}function JS(e){let t=!1,r=0,a=!1,n;const l=ep(),o=w=>{var E;a||(v(new ZS(w)),(E=e.abort)==null||E.call(e))},u=()=>{t=!0},h=()=>{t=!1},x=()=>Gp.isFocused()&&(e.networkMode==="always"||hd.isOnline())&&e.canRun(),m=()=>QS(e.networkMode)&&e.canRun(),g=w=>{var E;a||(a=!0,(E=e.onSuccess)==null||E.call(e,w),n==null||n(),l.resolve(w))},v=w=>{var E;a||(a=!0,(E=e.onError)==null||E.call(e,w),n==null||n(),l.reject(w))},b=()=>new Promise(w=>{var E;n=k=>{(a||x())&&w(k)},(E=e.onPause)==null||E.call(e)}).then(()=>{var w;n=void 0,a||(w=e.onContinue)==null||w.call(e)}),y=()=>{if(a)return;let w;const E=r===0?e.initialPromise:void 0;try{w=E??e.fn()}catch(k){w=Promise.reject(k)}Promise.resolve(w).then(g).catch(k=>{var D;if(a)return;const N=e.retry??(Cl?0:3),_=e.retryDelay??lA,R=typeof _=="function"?_(r,k):_,A=N===!0||typeof N=="number"&&r<N||typeof N=="function"&&N(r,k);if(t||!A){v(k);return}r++,(D=e.onFail)==null||D.call(e,r,k),rA(R).then(()=>x()?void 0:b()).then(()=>{t?v(k):y()})})};return{promise:l,cancel:o,continue:()=>(n==null||n(),l),cancelRetry:u,continueRetry:h,canStart:m,start:()=>(m()?y():b().then(y),l)}}var oA=e=>setTimeout(e,0);function cA(){let e=[],t=0,r=u=>{u()},a=u=>{u()},n=oA;const l=u=>{t?e.push(u):n(()=>{r(u)})},o=()=>{const u=e;e=[],u.length&&n(()=>{a(()=>{u.forEach(h=>{r(h)})})})};return{batch:u=>{let h;t++;try{h=u()}finally{t--,t||o()}return h},batchCalls:u=>(...h)=>{l(()=>{u(...h)})},schedule:l,setNotifyFunction:u=>{r=u},setBatchNotifyFunction:u=>{a=u},setScheduler:u=>{n=u}}}var Ir=cA(),ml,Qw,e4=(Qw=class{constructor(){Ye(this,ml)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Qm(this.gcTime)&&Ge(this,ml,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Cl?1/0:5*60*1e3))}clearGcTimeout(){ae(this,ml)&&(clearTimeout(ae(this,ml)),Ge(this,ml,void 0))}},ml=new WeakMap,Qw),Io,Uo,vn,pl,oa,X0,gl,Mn,Ns,Zw,uA=(Zw=class extends e4{constructor(t){super();Ye(this,Mn);Ye(this,Io);Ye(this,Uo);Ye(this,vn);Ye(this,pl);Ye(this,oa);Ye(this,X0);Ye(this,gl);Ge(this,gl,!1),Ge(this,X0,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ge(this,pl,t.client),Ge(this,vn,ae(this,pl).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ge(this,Io,fA(this.options)),this.state=t.state??ae(this,Io),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ae(this,oa))==null?void 0:t.promise}setOptions(t){this.options={...ae(this,X0),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ae(this,vn).remove(this)}setData(t,r){const a=Jm(this.state.data,t,this.options);return mt(this,Mn,Ns).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){mt(this,Mn,Ns).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=ae(this,oa))==null?void 0:a.promise;return(n=ae(this,oa))==null||n.cancel(t),r?r.then(wa).catch(wa):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ae(this,Io))}isActive(){return this.observers.some(t=>Bn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Hp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Mi(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!XS(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,oa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,oa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ae(this,vn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ae(this,oa)&&(ae(this,gl)?ae(this,oa).cancel({revert:!0}):ae(this,oa).cancelRetry()),this.scheduleGc()),ae(this,vn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||mt(this,Mn,Ns).call(this,{type:"invalidate"})}fetch(t,r){var x,m,g;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ae(this,oa))return ae(this,oa).continueRetry(),ae(this,oa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(b=>b.options.queryFn);v&&this.setOptions(v.options)}const a=new AbortController,n=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(Ge(this,gl,!0),a.signal)})},l=()=>{const v=$S(this.options,r),y=(()=>{const w={client:ae(this,pl),queryKey:this.queryKey,meta:this.meta};return n(w),w})();return Ge(this,gl,!1),this.options.persister?this.options.persister(v,y,this):v(y)},u=(()=>{const v={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ae(this,pl),state:this.state,fetchFn:l};return n(v),v})();(x=this.options.behavior)==null||x.onFetch(u,this),Ge(this,Uo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=u.fetchOptions)==null?void 0:m.meta))&&mt(this,Mn,Ns).call(this,{type:"fetch",meta:(g=u.fetchOptions)==null?void 0:g.meta});const h=v=>{var b,y,w,E;ym(v)&&v.silent||mt(this,Mn,Ns).call(this,{type:"error",error:v}),ym(v)||((y=(b=ae(this,vn).config).onError)==null||y.call(b,v,this),(E=(w=ae(this,vn).config).onSettled)==null||E.call(w,this.state.data,v,this)),this.scheduleGc()};return Ge(this,oa,JS({initialPromise:r==null?void 0:r.initialPromise,fn:u.fetchFn,abort:a.abort.bind(a),onSuccess:v=>{var b,y,w,E;if(v===void 0){h(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(k){h(k);return}(y=(b=ae(this,vn).config).onSuccess)==null||y.call(b,v,this),(E=(w=ae(this,vn).config).onSettled)==null||E.call(w,v,this.state.error,this),this.scheduleGc()},onError:h,onFail:(v,b)=>{mt(this,Mn,Ns).call(this,{type:"failed",failureCount:v,error:b})},onPause:()=>{mt(this,Mn,Ns).call(this,{type:"pause"})},onContinue:()=>{mt(this,Mn,Ns).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0})),ae(this,oa).start()}},Io=new WeakMap,Uo=new WeakMap,vn=new WeakMap,pl=new WeakMap,oa=new WeakMap,X0=new WeakMap,gl=new WeakMap,Mn=new WeakSet,Ns=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...t4(a.data,this.options),fetchMeta:t.meta??null};case"success":return{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return ym(n)&&n.revert&&ae(this,Uo)?{...ae(this,Uo),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),Ir.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),ae(this,vn).notify({query:this,type:"updated",action:t})})},Zw);function t4(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:QS(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function fA(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var as,Jw,dA=(Jw=class extends nc{constructor(t={}){super();Ye(this,as);this.config=t,Ge(this,as,new Map)}build(t,r,a){const n=r.queryKey,l=r.queryHash??zp(n,r);let o=this.get(l);return o||(o=new uA({client:t,queryKey:n,queryHash:l,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){ae(this,as).has(t.queryHash)||(ae(this,as).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ae(this,as).get(t.queryHash);r&&(t.destroy(),r===t&&ae(this,as).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ir.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ae(this,as).get(t)}getAll(){return[...ae(this,as).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>J2(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>J2(t,a)):r}notify(t){Ir.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ir.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ir.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},as=new WeakMap,Jw),ns,va,vl,ss,bi,eS,hA=(eS=class extends e4{constructor(t){super();Ye(this,ss);Ye(this,ns);Ye(this,va);Ye(this,vl);this.mutationId=t.mutationId,Ge(this,va,t.mutationCache),Ge(this,ns,[]),this.state=t.state||r4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ae(this,ns).includes(t)||(ae(this,ns).push(t),this.clearGcTimeout(),ae(this,va).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ge(this,ns,ae(this,ns).filter(r=>r!==t)),this.scheduleGc(),ae(this,va).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ae(this,ns).length||(this.state.status==="pending"?this.scheduleGc():ae(this,va).remove(this))}continue(){var t;return((t=ae(this,vl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,u,h,x,m,g,v,b,y,w,E,k,N,_,R,A,D,T,F;const r=()=>{mt(this,ss,bi).call(this,{type:"continue"})};Ge(this,vl,JS({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(O,U)=>{mt(this,ss,bi).call(this,{type:"failed",failureCount:O,error:U})},onPause:()=>{mt(this,ss,bi).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ae(this,va).canRun(this)}));const a=this.state.status==="pending",n=!ae(this,vl).canStart();try{if(a)r();else{mt(this,ss,bi).call(this,{type:"pending",variables:t,isPaused:n}),await((o=(l=ae(this,va).config).onMutate)==null?void 0:o.call(l,t,this));const U=await((h=(u=this.options).onMutate)==null?void 0:h.call(u,t));U!==this.state.context&&mt(this,ss,bi).call(this,{type:"pending",context:U,variables:t,isPaused:n})}const O=await ae(this,vl).start();return await((m=(x=ae(this,va).config).onSuccess)==null?void 0:m.call(x,O,t,this.state.context,this)),await((v=(g=this.options).onSuccess)==null?void 0:v.call(g,O,t,this.state.context)),await((y=(b=ae(this,va).config).onSettled)==null?void 0:y.call(b,O,null,this.state.variables,this.state.context,this)),await((E=(w=this.options).onSettled)==null?void 0:E.call(w,O,null,t,this.state.context)),mt(this,ss,bi).call(this,{type:"success",data:O}),O}catch(O){try{throw await((N=(k=ae(this,va).config).onError)==null?void 0:N.call(k,O,t,this.state.context,this)),await((R=(_=this.options).onError)==null?void 0:R.call(_,O,t,this.state.context)),await((D=(A=ae(this,va).config).onSettled)==null?void 0:D.call(A,void 0,O,this.state.variables,this.state.context,this)),await((F=(T=this.options).onSettled)==null?void 0:F.call(T,void 0,O,t,this.state.context)),O}finally{mt(this,ss,bi).call(this,{type:"error",error:O})}}finally{ae(this,va).runNext(this)}}},ns=new WeakMap,va=new WeakMap,vl=new WeakMap,ss=new WeakSet,bi=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ir.batch(()=>{ae(this,ns).forEach(a=>{a.onMutationUpdate(t)}),ae(this,va).notify({mutation:this,type:"updated",action:t})})},eS);function r4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Cs,Ln,Y0,tS,xA=(tS=class extends nc{constructor(t={}){super();Ye(this,Cs);Ye(this,Ln);Ye(this,Y0);this.config=t,Ge(this,Cs,new Set),Ge(this,Ln,new Map),Ge(this,Y0,0)}build(t,r,a){const n=new hA({mutationCache:this,mutationId:++Af(this,Y0)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){ae(this,Cs).add(t);const r=Df(t);if(typeof r=="string"){const a=ae(this,Ln).get(r);a?a.push(t):ae(this,Ln).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ae(this,Cs).delete(t)){const r=Df(t);if(typeof r=="string"){const a=ae(this,Ln).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&ae(this,Ln).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Df(t);if(typeof r=="string"){const a=ae(this,Ln).get(r),n=a==null?void 0:a.find(l=>l.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=Df(t);if(typeof r=="string"){const n=(a=ae(this,Ln).get(r))==null?void 0:a.find(l=>l!==t&&l.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ir.batch(()=>{ae(this,Cs).forEach(t=>{this.notify({type:"removed",mutation:t})}),ae(this,Cs).clear(),ae(this,Ln).clear()})}getAll(){return Array.from(ae(this,Cs))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>eb(r,a))}findAll(t={}){return this.getAll().filter(r=>eb(t,r))}notify(t){Ir.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ir.batch(()=>Promise.all(t.map(r=>r.continue().catch(wa))))}},Cs=new WeakMap,Ln=new WeakMap,Y0=new WeakMap,tS);function Df(e){var t;return(t=e.options.scope)==null?void 0:t.id}function ab(e){return{onFetch:(t,r)=>{var m,g,v,b,y;const a=t.options,n=(v=(g=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:g.fetchMore)==null?void 0:v.direction,l=((b=t.state.data)==null?void 0:b.pages)||[],o=((y=t.state.data)==null?void 0:y.pageParams)||[];let u={pages:[],pageParams:[]},h=0;const x=async()=>{let w=!1;const E=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},k=$S(t.options,t.fetchOptions),N=async(_,R,A)=>{if(w)return Promise.reject();if(R==null&&_.pages.length)return Promise.resolve(_);const T=(()=>{const q={client:t.client,queryKey:t.queryKey,pageParam:R,direction:A?"backward":"forward",meta:t.options.meta};return E(q),q})(),F=await k(T),{maxPages:O}=t.options,U=A?nA:aA;return{pages:U(_.pages,F,O),pageParams:U(_.pageParams,R,O)}};if(n&&l.length){const _=n==="backward",R=_?mA:nb,A={pages:l,pageParams:o},D=R(a,A);u=await N(A,D,_)}else{const _=e??l.length;do{const R=h===0?o[0]??a.initialPageParam:nb(a,u);if(h>0&&R==null)break;u=await N(u,R),h++}while(h<_)}return u};t.options.persister?t.fetchFn=()=>{var w,E;return(E=(w=t.options).persister)==null?void 0:E.call(w,x,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=x}}}function nb(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function mA(e,{pages:t,pageParams:r}){var a;return t.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,t[0],t,r[0],r):void 0}var mr,_i,ki,zo,Ho,Ti,Go,Vo,rS,pA=(rS=class{constructor(e={}){Ye(this,mr);Ye(this,_i);Ye(this,ki);Ye(this,zo);Ye(this,Ho);Ye(this,Ti);Ye(this,Go);Ye(this,Vo);Ge(this,mr,e.queryCache||new dA),Ge(this,_i,e.mutationCache||new xA),Ge(this,ki,e.defaultOptions||{}),Ge(this,zo,new Map),Ge(this,Ho,new Map),Ge(this,Ti,0)}mount(){Af(this,Ti)._++,ae(this,Ti)===1&&(Ge(this,Go,Gp.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,mr).onFocus())})),Ge(this,Vo,hd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,mr).onOnline())})))}unmount(){var e,t;Af(this,Ti)._--,ae(this,Ti)===0&&((e=ae(this,Go))==null||e.call(this),Ge(this,Go,void 0),(t=ae(this,Vo))==null||t.call(this),Ge(this,Vo,void 0))}isFetching(e){return ae(this,mr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ae(this,_i).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,mr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ae(this,mr).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Mi(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return ae(this,mr).findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=ae(this,mr).get(a.queryHash),l=n==null?void 0:n.state.data,o=tA(t,l);if(o!==void 0)return ae(this,mr).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Ir.batch(()=>ae(this,mr).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,mr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ae(this,mr);Ir.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ae(this,mr);return Ir.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=Ir.batch(()=>ae(this,mr).findAll(e).map(n=>n.cancel(r)));return Promise.all(a).then(wa).catch(wa)}invalidateQueries(e,t={}){return Ir.batch(()=>(ae(this,mr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=Ir.batch(()=>ae(this,mr).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let l=n.fetch(void 0,r);return r.throwOnError||(l=l.catch(wa)),n.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(a).then(wa)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ae(this,mr).build(this,t);return r.isStaleByTime(Mi(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(wa).catch(wa)}fetchInfiniteQuery(e){return e.behavior=ab(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(wa).catch(wa)}ensureInfiniteQueryData(e){return e.behavior=ab(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return hd.isOnline()?ae(this,_i).resumePausedMutations():Promise.resolve()}getQueryCache(){return ae(this,mr)}getMutationCache(){return ae(this,_i)}getDefaultOptions(){return ae(this,ki)}setDefaultOptions(e){Ge(this,ki,e)}setQueryDefaults(e,t){ae(this,zo).set(Al(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ae(this,zo).values()],r={};return t.forEach(a=>{A0(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){ae(this,Ho).set(Al(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ae(this,Ho).values()],r={};return t.forEach(a=>{A0(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ae(this,ki).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=zp(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Hp&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ae(this,ki).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ae(this,mr).clear(),ae(this,_i).clear()}},mr=new WeakMap,_i=new WeakMap,ki=new WeakMap,zo=new WeakMap,Ho=new WeakMap,Ti=new WeakMap,Go=new WeakMap,Vo=new WeakMap,rS),Oa,_t,$0,ya,yl,qo,Ni,Ci,K0,Wo,Xo,bl,wl,Ai,Yo,Ot,h0,tp,rp,ap,np,sp,ip,lp,a4,aS,gA=(aS=class extends nc{constructor(t,r){super();Ye(this,Ot);Ye(this,Oa);Ye(this,_t);Ye(this,$0);Ye(this,ya);Ye(this,yl);Ye(this,qo);Ye(this,Ni);Ye(this,Ci);Ye(this,K0);Ye(this,Wo);Ye(this,Xo);Ye(this,bl);Ye(this,wl);Ye(this,Ai);Ye(this,Yo,new Set);this.options=r,Ge(this,Oa,t),Ge(this,Ci,null),Ge(this,Ni,ep()),this.options.experimental_prefetchInRender||ae(this,Ni).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ae(this,_t).addObserver(this),sb(ae(this,_t),this.options)?mt(this,Ot,h0).call(this):this.updateResult(),mt(this,Ot,np).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return op(ae(this,_t),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return op(ae(this,_t),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,mt(this,Ot,sp).call(this),mt(this,Ot,ip).call(this),ae(this,_t).removeObserver(this)}setOptions(t){const r=this.options,a=ae(this,_t);if(this.options=ae(this,Oa).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Bn(this.options.enabled,ae(this,_t))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");mt(this,Ot,lp).call(this),ae(this,_t).setOptions(this.options),r._defaulted&&!dd(this.options,r)&&ae(this,Oa).getQueryCache().notify({type:"observerOptionsUpdated",query:ae(this,_t),observer:this});const n=this.hasListeners();n&&ib(ae(this,_t),a,this.options,r)&&mt(this,Ot,h0).call(this),this.updateResult(),n&&(ae(this,_t)!==a||Bn(this.options.enabled,ae(this,_t))!==Bn(r.enabled,ae(this,_t))||Mi(this.options.staleTime,ae(this,_t))!==Mi(r.staleTime,ae(this,_t)))&&mt(this,Ot,tp).call(this);const l=mt(this,Ot,rp).call(this);n&&(ae(this,_t)!==a||Bn(this.options.enabled,ae(this,_t))!==Bn(r.enabled,ae(this,_t))||l!==ae(this,Ai))&&mt(this,Ot,ap).call(this,l)}getOptimisticResult(t){const r=ae(this,Oa).getQueryCache().build(ae(this,Oa),t),a=this.createResult(r,t);return yA(this,a)&&(Ge(this,ya,a),Ge(this,qo,this.options),Ge(this,yl,ae(this,_t).state)),a}getCurrentResult(){return ae(this,ya)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),Reflect.get(a,n))})}trackProp(t){ae(this,Yo).add(t)}getCurrentQuery(){return ae(this,_t)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=ae(this,Oa).defaultQueryOptions(t),a=ae(this,Oa).getQueryCache().build(ae(this,Oa),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return mt(this,Ot,h0).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ae(this,ya)))}createResult(t,r){var O;const a=ae(this,_t),n=this.options,l=ae(this,ya),o=ae(this,yl),u=ae(this,qo),x=t!==a?t.state:ae(this,$0),{state:m}=t;let g={...m},v=!1,b;if(r._optimisticResults){const U=this.hasListeners(),q=!U&&sb(t,r),z=U&&ib(t,a,r,n);(q||z)&&(g={...g,...t4(m.data,t.options)}),r._optimisticResults==="isRestoring"&&(g.fetchStatus="idle")}let{error:y,errorUpdatedAt:w,status:E}=g;b=g.data;let k=!1;if(r.placeholderData!==void 0&&b===void 0&&E==="pending"){let U;l!=null&&l.isPlaceholderData&&r.placeholderData===(u==null?void 0:u.placeholderData)?(U=l.data,k=!0):U=typeof r.placeholderData=="function"?r.placeholderData((O=ae(this,Xo))==null?void 0:O.state.data,ae(this,Xo)):r.placeholderData,U!==void 0&&(E="success",b=Jm(l==null?void 0:l.data,U,r),v=!0)}if(r.select&&b!==void 0&&!k)if(l&&b===(o==null?void 0:o.data)&&r.select===ae(this,K0))b=ae(this,Wo);else try{Ge(this,K0,r.select),b=r.select(b),b=Jm(l==null?void 0:l.data,b,r),Ge(this,Wo,b),Ge(this,Ci,null)}catch(U){Ge(this,Ci,U)}ae(this,Ci)&&(y=ae(this,Ci),b=ae(this,Wo),w=Date.now(),E="error");const N=g.fetchStatus==="fetching",_=E==="pending",R=E==="error",A=_&&N,D=b!==void 0,F={status:E,fetchStatus:g.fetchStatus,isPending:_,isSuccess:E==="success",isError:R,isInitialLoading:A,isLoading:A,data:b,dataUpdatedAt:g.dataUpdatedAt,error:y,errorUpdatedAt:w,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>x.dataUpdateCount||g.errorUpdateCount>x.errorUpdateCount,isFetching:N,isRefetching:N&&!_,isLoadingError:R&&!D,isPaused:g.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:R&&D,isStale:Vp(t,r),refetch:this.refetch,promise:ae(this,Ni)};if(this.options.experimental_prefetchInRender){const U=te=>{F.status==="error"?te.reject(F.error):F.data!==void 0&&te.resolve(F.data)},q=()=>{const te=Ge(this,Ni,F.promise=ep());U(te)},z=ae(this,Ni);switch(z.status){case"pending":t.queryHash===a.queryHash&&U(z);break;case"fulfilled":(F.status==="error"||F.data!==z.value)&&q();break;case"rejected":(F.status!=="error"||F.error!==z.reason)&&q();break}}return F}updateResult(){const t=ae(this,ya),r=this.createResult(ae(this,_t),this.options);if(Ge(this,yl,ae(this,_t).state),Ge(this,qo,this.options),ae(this,yl).data!==void 0&&Ge(this,Xo,ae(this,_t)),dd(r,t))return;Ge(this,ya,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,l=typeof n=="function"?n():n;if(l==="all"||!l&&!ae(this,Yo).size)return!0;const o=new Set(l??ae(this,Yo));return this.options.throwOnError&&o.add("error"),Object.keys(ae(this,ya)).some(u=>{const h=u;return ae(this,ya)[h]!==t[h]&&o.has(h)})};mt(this,Ot,a4).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&mt(this,Ot,np).call(this)}},Oa=new WeakMap,_t=new WeakMap,$0=new WeakMap,ya=new WeakMap,yl=new WeakMap,qo=new WeakMap,Ni=new WeakMap,Ci=new WeakMap,K0=new WeakMap,Wo=new WeakMap,Xo=new WeakMap,bl=new WeakMap,wl=new WeakMap,Ai=new WeakMap,Yo=new WeakMap,Ot=new WeakSet,h0=function(t){mt(this,Ot,lp).call(this);let r=ae(this,_t).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(wa)),r},tp=function(){mt(this,Ot,sp).call(this);const t=Mi(this.options.staleTime,ae(this,_t));if(Cl||ae(this,ya).isStale||!Qm(t))return;const a=XS(ae(this,ya).dataUpdatedAt,t)+1;Ge(this,bl,setTimeout(()=>{ae(this,ya).isStale||this.updateResult()},a))},rp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ae(this,_t)):this.options.refetchInterval)??!1},ap=function(t){mt(this,Ot,ip).call(this),Ge(this,Ai,t),!(Cl||Bn(this.options.enabled,ae(this,_t))===!1||!Qm(ae(this,Ai))||ae(this,Ai)===0)&&Ge(this,wl,setInterval(()=>{(this.options.refetchIntervalInBackground||Gp.isFocused())&&mt(this,Ot,h0).call(this)},ae(this,Ai)))},np=function(){mt(this,Ot,tp).call(this),mt(this,Ot,ap).call(this,mt(this,Ot,rp).call(this))},sp=function(){ae(this,bl)&&(clearTimeout(ae(this,bl)),Ge(this,bl,void 0))},ip=function(){ae(this,wl)&&(clearInterval(ae(this,wl)),Ge(this,wl,void 0))},lp=function(){const t=ae(this,Oa).getQueryCache().build(ae(this,Oa),this.options);if(t===ae(this,_t))return;const r=ae(this,_t);Ge(this,_t,t),Ge(this,$0,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},a4=function(t){Ir.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(ae(this,ya))}),ae(this,Oa).getQueryCache().notify({query:ae(this,_t),type:"observerResultsUpdated"})})},aS);function vA(e,t){return Bn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function sb(e,t){return vA(e,t)||e.state.data!==void 0&&op(e,t,t.refetchOnMount)}function op(e,t,r){if(Bn(t.enabled,e)!==!1&&Mi(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&Vp(e,t)}return!1}function ib(e,t,r,a){return(e!==t||Bn(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&Vp(e,r)}function Vp(e,t){return Bn(t.enabled,e)!==!1&&e.isStaleByTime(Mi(t.staleTime,e))}function yA(e,t){return!dd(e.getCurrentResult(),t)}var ji,Ri,Ma,As,Ls,ad,cp,nS,bA=(nS=class extends nc{constructor(r,a){super();Ye(this,Ls);Ye(this,ji);Ye(this,Ri);Ye(this,Ma);Ye(this,As);Ge(this,ji,r),this.setOptions(a),this.bindMethods(),mt(this,Ls,ad).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=ae(this,ji).defaultMutationOptions(r),dd(this.options,a)||ae(this,ji).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ae(this,Ma),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Al(a.mutationKey)!==Al(this.options.mutationKey)?this.reset():((n=ae(this,Ma))==null?void 0:n.state.status)==="pending"&&ae(this,Ma).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=ae(this,Ma))==null||r.removeObserver(this)}onMutationUpdate(r){mt(this,Ls,ad).call(this),mt(this,Ls,cp).call(this,r)}getCurrentResult(){return ae(this,Ri)}reset(){var r;(r=ae(this,Ma))==null||r.removeObserver(this),Ge(this,Ma,void 0),mt(this,Ls,ad).call(this),mt(this,Ls,cp).call(this)}mutate(r,a){var n;return Ge(this,As,a),(n=ae(this,Ma))==null||n.removeObserver(this),Ge(this,Ma,ae(this,ji).getMutationCache().build(ae(this,ji),this.options)),ae(this,Ma).addObserver(this),ae(this,Ma).execute(r)}},ji=new WeakMap,Ri=new WeakMap,Ma=new WeakMap,As=new WeakMap,Ls=new WeakSet,ad=function(){var a;const r=((a=ae(this,Ma))==null?void 0:a.state)??r4();Ge(this,Ri,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},cp=function(r){Ir.batch(()=>{var a,n,l,o,u,h,x,m;if(ae(this,As)&&this.hasListeners()){const g=ae(this,Ri).variables,v=ae(this,Ri).context;(r==null?void 0:r.type)==="success"?((n=(a=ae(this,As)).onSuccess)==null||n.call(a,r.data,g,v),(o=(l=ae(this,As)).onSettled)==null||o.call(l,r.data,null,g,v)):(r==null?void 0:r.type)==="error"&&((h=(u=ae(this,As)).onError)==null||h.call(u,r.error,g,v),(m=(x=ae(this,As)).onSettled)==null||m.call(x,void 0,r.error,g,v))}this.listeners.forEach(g=>{g(ae(this,Ri))})})},nS),n4=C.createContext(void 0),Et=e=>{const t=C.useContext(n4);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},wA=({client:e,children:t})=>(C.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),f.jsx(n4.Provider,{value:e,children:t})),s4=C.createContext(!1),SA=()=>C.useContext(s4);s4.Provider;function EA(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var _A=C.createContext(EA()),kA=()=>C.useContext(_A),TA=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},NA=e=>{C.useEffect(()=>{e.clearReset()},[e])},CA=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(n&&e.data===void 0||KS(r,[e.error,a])),AA=e=>{if(e.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},jA=(e,t)=>e.isLoading&&e.isFetching&&!t,RA=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,lb=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function DA(e,t,r){var g,v,b,y,w;const a=SA(),n=kA(),l=Et(),o=l.defaultQueryOptions(e);(v=(g=l.getDefaultOptions().queries)==null?void 0:g._experimental_beforeQuery)==null||v.call(g,o),o._optimisticResults=a?"isRestoring":"optimistic",AA(o),TA(o,n),NA(n);const u=!l.getQueryCache().get(o.queryHash),[h]=C.useState(()=>new t(l,o)),x=h.getOptimisticResult(o),m=!a&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(E=>{const k=m?h.subscribe(Ir.batchCalls(E)):wa;return h.updateResult(),k},[h,m]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),C.useEffect(()=>{h.setOptions(o)},[o,h]),RA(o,x))throw lb(o,h,n);if(CA({result:x,errorResetBoundary:n,throwOnError:o.throwOnError,query:l.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw x.error;if((y=(b=l.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||y.call(b,o,x),o.experimental_prefetchInRender&&!Cl&&jA(x,a)){const E=u?lb(o,h,n):(w=l.getQueryCache().get(o.queryHash))==null?void 0:w.promise;E==null||E.catch(wa).finally(()=>{h.updateResult()})}return o.notifyOnChangeProps?x:h.trackResult(x)}function aa(e,t){return DA(e,gA)}function At(e,t){const r=Et(),[a]=C.useState(()=>new bA(r,e));C.useEffect(()=>{a.setOptions(e)},[a,e]);const n=C.useSyncExternalStore(C.useCallback(o=>a.subscribe(Ir.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=C.useCallback((o,u)=>{a.mutate(o,u).catch(wa)},[a]);if(n.error&&KS(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}const i4={login:"/User/Login",me:"/auth/me"},sc={all:"/event/GetEventsList",byId:e=>`/event/${e}`,create:"/event/Create",update:"/event/Update",updateTableQuantity:"/event/UpdateTableQuantity",activateEvent:e=>`/event/Activate/${e}`,deactivateEvent:e=>`/event/Deactivate/${e}`,previewEvent:"/event/Preview",delete:e=>`/events/${e}`,importRsvps:e=>`/events/${e}/rsvps/import`,exportRsvps:e=>`/events/${e}/rsvps/export`},au={all:e=>`/rsvp/GetRsvp/List/${e}`,forEvent:e=>`/rsvp/GetRsvp/List/${e}`,byId:(e,t)=>`/events/${e}/rsvps/${t}`,create:()=>"/rsvp/Create",update:()=>"/rsvp/Update",delete:()=>"/rsvp/Delete"},Ui={all:e=>`/TableArrangement/Summary/${e}`,byId:e=>`/TableArrangement/Summary/${e}`,create:"/TableArrangement/Create",bulkCreate:"/TableArrangement/BulkCreate",update:"/TableArrangement/Update",delete:e=>`/TableArrangement/Delete/${e}`,updateLayout:e=>`/tables/${e}/layout`,tableGuests:e=>`/tables/${e}/guests`,reassignGuest:(e,t)=>`/tables/${e}/guests/${t}/reassign`},nu={all:e=>`/Guest/ByEvent/${e}`,byTable:e=>`/Guest/ByTable/${e}`,assignTable:(e,t)=>`/Guest/${e}/AssignTable/${t}`,unassignTable:e=>`/Guest/${e}/UnassignTable`},su={all:"/seating",byId:e=>`/seating/${e}`,create:"/seating",update:e=>`/seating/${e}`,delete:e=>`/seating/${e}`},iu={all:"/users",byId:e=>`/users/${e}`,create:"/users",update:e=>`/users/${e}`,delete:e=>`/users/${e}`},qp={getByEvent:e=>`/Wallet/GetWalletByEvent/${e}`,getByGuid:(e,t)=>`/Wallet/${e}?eventId=${t}`,create:"/Wallet/Create",update:"/Wallet/Update",delete:"/Wallet/Delete",activate:e=>`/Wallet/Activate/${e}`,deactivate:e=>`/Wallet/Deactivate/${e}`},Pd={getByWallet:(e,t)=>`/Transaction/${e}/transactions?eventGuid=${t}`,getById:(e,t)=>`/Transaction/${e}?eventGuid=${t}`,create:"/Transaction/Create",update:"/Transaction/Update",delete:"/Transaction/Delete"},Id={all:e=>`/question/GetQuestions/${e}`,create:()=>"/question/Create",update:()=>"/question/Update",activate:()=>"/question/Activate",deactivate:()=>"/question/Deactivate",delete:(e,t)=>`/events/${e}/rsvp-form-fields/${t}`},l4={get:e=>`/RsvpDesign/${e}/design`,save:e=>`/RsvpDesign/${e}/design`,publish:(e,t)=>`/RsvpDesign/${e}/design/${t}/publish`},FA={summary:e=>`/Dashboard/Summary/${e}`};function OA(){const e=Et();return{login:At({mutationFn:r=>Qe.post(i4.login,r).then(a=>a.data),onSuccess:({token:r})=>{localStorage.setItem("token",r),e.invalidateQueries({queryKey:["me"]})}})}}const Wp=C.createContext({user:null,login:async()=>{},logout:()=>{},loading:!1}),bm="temp-admin-token",wm={id:"temp-admin",name:"Admin",email:"admin@bigdays.com"};function MA({children:e}){const{login:t}=OA(),[r,a]=C.useState(()=>localStorage.getItem("token")===bm?wm:null),[n,l]=C.useState(()=>!!localStorage.getItem("token")&&localStorage.getItem("token")!==bm),{data:o,isLoading:u}=aa({queryKey:["me"],queryFn:()=>Qe.get(i4.me).then(m=>m.data),enabled:n}),h=async m=>{if(m.email===wm.email&&m.password==="Abc123"){localStorage.setItem("token",bm),a(wm);return}await t.mutateAsync(m),l(!0)},x=()=>{localStorage.removeItem("token"),l(!1),a(null),window.location.replace("/login")};return f.jsx(Wp.Provider,{value:{user:r??o??null,login:h,logout:x,loading:u||t.isPending},children:e})}function LA(e){return e.toISOString().slice(0,10)}function ob(e){const t=new Date(e).getTime(),r=Date.now(),a=Math.max(t-r,0),n=Math.floor(a/(1e3*60*60*24)),l=Math.floor(a/(1e3*60*60)%24),o=Math.floor(a/(1e3*60)%60),u=Math.floor(a/1e3%60),h=x=>x.toString().padStart(2,"0");return{days:h(n),hours:h(l),minutes:h(o),seconds:h(u)}}function BA(){const e=Na(),t=C.useMemo(()=>{const u=new Date;return u.setDate(u.getDate()+90),LA(u)},[]),[r,a]=C.useState(t),[n,l]=C.useState(()=>ob(t));C.useEffect(()=>{const u=setInterval(()=>l(ob(r)),1e3);return()=>clearInterval(u)},[r]);const o=[{label:"days",value:n.days},{label:"hours",value:n.hours},{label:"minutes",value:n.minutes},{label:"seconds",value:n.seconds}];return f.jsxs("section",{className:"bg-background text-center text-text py-20 space-y-20",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsx("h2",{className:"text-4xl font-playfair italic text-primary",children:"Save The Date"}),f.jsx("p",{className:"text-lg font-semibold",children:"Customize your countdown"}),f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-center gap-4 max-w-xl mx-auto",children:[f.jsx("label",{className:"text-sm font-semibold text-gray-600",htmlFor:"wedding-date",children:"Wedding date"}),f.jsx("input",{id:"wedding-date",type:"date",value:r,onChange:u=>a(u.target.value),className:"border rounded-lg px-3 py-2 shadow-sm"})]}),f.jsx("div",{className:"flex justify-center gap-6 mt-8 flex-wrap",children:o.map(({label:u,value:h})=>f.jsxs("div",{className:"w-28 h-28 rounded-full border-2 border-secondary flex flex-col justify-center items-center bg-white/60",children:[f.jsx("span",{className:"text-3xl text-primary font-semibold",children:h}),f.jsx("span",{className:"text-sm text-gray-500 uppercase tracking-wide",children:u})]},u))})]}),f.jsx("div",{className:"bg-[#fffaf0] py-16 px-4",children:f.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Stress-free planning"}),f.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Share timelines, notes, and last-minute updates with everyone helping on your big day. Keep your vision aligned without endless chats."})]}),f.jsx("div",{className:"mx-auto",children:f.jsx("img",{src:"https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e",alt:"Bride and Groom",className:"w-64 h-64 object-cover rounded-md shadow-lg"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Designed for both of you"}),f.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Give guests a beautiful RSVP experience, track VIPs, and manage seating in minutes. No more juggling spreadsheets or scattered tools."})]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold",children:"Plan. Invite. Celebrate."}),f.jsx("p",{className:"max-w-xl mx-auto mt-2 text-gray-600",children:"Streamline your wedding with real-time RSVP analytics, seating charts, and guided setup."}),f.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[f.jsx("button",{className:"px-6 py-3 rounded-2xl bg-accent text-white shadow-lg",onClick:()=>e("/app/events?new=1"),children:"Start a new event"}),f.jsx("button",{className:"px-6 py-3 rounded-2xl border-2 border-accent text-accent shadow-lg",onClick:()=>e("/app/events?demo=1"),children:"Explore a demo setup"})]})]})]})}function lu(){return C.useContext(Wp)}function sr({label:e,type:t="text",options:r,value:a,onChange:n,required:l=!1,className:o="",name:u,id:h,placeholder:x,disabled:m,autoFocus:g,min:v,max:b,step:y,rows:w=3,hint:E,error:k,emptyOptionLabel:N=" select "}){const _="w-full border rounded p-2 disabled:opacity-60 disabled:cursor-not-allowed",R=k?"border-red-500":"border-gray-300",A=k?"text-red-600":"text-gray-500";return f.jsxs("div",{className:`space-y-1 ${o}`,children:[f.jsxs("label",{htmlFor:h,className:"block font-medium",children:[e,l&&f.jsx("span",{className:"ml-1 text-red-600",children:"*"})]}),t==="textarea"?f.jsx("textarea",{id:h,name:u,rows:w,className:`${_} ${R}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:g}):t==="select"?f.jsxs("select",{id:h,name:u,className:`${_} ${R}`,value:a,onChange:n,disabled:m,required:l,autoFocus:g,children:[f.jsx("option",{value:"",children:N}),r==null?void 0:r.map(D=>f.jsx("option",{value:D,children:D},D))]}):t==="radio"?f.jsx("div",{className:"flex flex-wrap gap-3",children:r==null?void 0:r.map(D=>f.jsxs("label",{className:"inline-flex items-center space-x-2",children:[f.jsx("input",{type:"radio",id:h?`${h}-${D}`:void 0,name:u,value:D,checked:a===D,onChange:n,disabled:m,required:l}),f.jsx("span",{children:D})]},D))}):t==="checkbox"?f.jsxs("label",{className:"inline-flex items-center space-x-2",children:[f.jsx("input",{id:h,name:u,type:"checkbox",checked:a==="true",onChange:D=>{const T={...D,target:{...D.target,value:D.target.checked?"true":"false"}};n(T)},disabled:m,required:l}),f.jsx("span",{children:e})]}):f.jsx("input",{id:h,name:u,type:t,className:`${_} ${R}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:g,min:v,max:b,step:y}),(E||k)&&f.jsx("p",{className:`text-xs ${A}`,children:k??E})]})}const PA=()=>f.jsxs("svg",{className:"animate-spin h-5 w-5 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),Fe=({type:e="button",variant:t="primary",loading:r=!1,children:a,className:n="",...l})=>{const o="px-4 py-2 rounded-xl font-semibold inline-flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-60 disabled:cursor-not-allowed",u=t==="primary"?"bg-gradient-to-r from-primary to-secondary text-white shadow-lg shadow-primary/25 hover:brightness-105 active:translate-y-[1px] focus:ring-primary/40":t==="secondary"?"bg-white text-text border border-primary/15 hover:border-primary/30 hover:bg-primary/5 dark:bg-accent dark:text-white dark:border-white/10 dark:hover:bg-white/10 focus:ring-primary/25":"bg-transparent text-primary hover:bg-primary/10 dark:hover:bg-white/10 focus:ring-primary/15";return f.jsx("button",{type:e,className:`${o} ${u} ${n}`,disabled:r||l.disabled,...l,children:r?f.jsx(PA,{}):a})};function IA(){var v,b;const{login:e,loading:t}=lu(),r=Na(),n=((b=(v=ls().state)==null?void 0:v.from)==null?void 0:b.pathname)||"/app",[l,o]=C.useState(""),[u,h]=C.useState(""),[x,m]=C.useState(null),g=async y=>{var w,E;y.preventDefault(),m(null);try{await e({email:l,password:u}),r(n,{replace:!0})}catch(k){m(((E=(w=k.response)==null?void 0:w.data)==null?void 0:E.message)||"Login failed")}};return f.jsxs("form",{onSubmit:g,className:"max-w-md mx-auto p-6 bg-background text-text space-y-6 ",children:[f.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Sign In"}),f.jsx(sr,{label:"Email",type:"email",value:l,onChange:y=>o(y.target.value)}),f.jsx(sr,{label:"Password",type:"password",value:u,onChange:y=>h(y.target.value)}),x&&f.jsx("p",{className:"text-red-500 text-sm",children:x}),f.jsx(Fe,{type:"submit",variant:"primary",disabled:t,children:t?"Signing in":"Sign In"})]})}function UA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}))}const j0=C.forwardRef(UA);function zA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"}))}const up=C.forwardRef(zA);function HA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"}))}const o4=C.forwardRef(HA);function GA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"}))}const VA=C.forwardRef(GA);function qA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}))}const WA=C.forwardRef(qA);function XA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"}))}const YA=C.forwardRef(XA);function $A(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const KA=C.forwardRef($A);function QA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"}))}const ZA=C.forwardRef(QA);function JA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const Ud=C.forwardRef(JA),cb=[{to:"/",label:"HOME"},{to:"/contact",label:"CONTACT"},{to:"/story",label:"STORY"},{to:"/events",label:"EVENTS"},{to:"/people",label:"PEOPLE"},{to:"/gallery",label:"GALLERY"},{to:"/rsvp",label:"RSVP"},{to:"/blog",label:"BLOG"},{to:"/login",label:"LOGIN"}];function e5(){const[e,t]=C.useState(!1);return f.jsxs("header",{className:"bg-background text-text shadow-sm",children:[f.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between py-4 px-6",children:[f.jsx("div",{className:"text-2xl font-playfair italic text-primary",children:"C & C"}),f.jsx("nav",{className:"hidden md:flex space-x-6 font-medium",children:cb.map(({to:r,label:a})=>f.jsx(N0,{to:r,className:({isActive:n})=>n?"text-secondary underline":"hover:text-secondary",children:a},r))}),f.jsx("button",{className:"md:hidden p-2 rounded hover:bg-secondary/10","aria-label":"Toggle menu",onClick:()=>t(r=>!r),children:e?f.jsx(Ud,{className:"h-6 w-6 text-text"}):f.jsx(o4,{className:"h-6 w-6 text-text"})})]}),e&&f.jsx("nav",{className:"md:hidden bg-background border-t border-gray-200",children:f.jsx("ul",{className:"space-y-1 py-4 px-6 font-medium",children:cb.map(({to:r,label:a})=>f.jsx("li",{children:f.jsx(N0,{to:r,className:({isActive:n})=>n?"block py-2 text-secondary underline":"block py-2 hover:text-secondary",onClick:()=>t(!1),children:a})},r))})})]})}function t5(){return f.jsx("footer",{className:"bg-background text-text py-8 px-6 mt-20",children:f.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-2 text-sm text-gray-600",children:[f.jsxs("p",{children:[" ",new Date().getFullYear()," My Big Day. All rights reserved."]}),f.jsx("p",{children:"Built with  using React, Vite & Tailwind CSS."})]})})}function r5({children:e}){return f.jsxs("div",{className:"min-h-screen bg-background text-text flex flex-col",children:[f.jsx(e5,{}),f.jsx("main",{className:"flex-1 container mx-auto px-4 pt-3",children:e??f.jsx(js,{})}),f.jsx(t5,{})]})}function fp(e){return{id:e.eventGuid.toString(),title:e.eventName,date:e.eventDate,noOfTable:e.noOfTable,description:e.eventDescription,location:e.eventLocation,raw:e}}function Xp(e=!1){return aa({queryKey:["events",e],queryFn:async()=>{var n;const t=await Qe.get(sc.all),r=Array.isArray((n=t.data)==null?void 0:n.data)?t.data.data:[];return e?r.map(fp):r.filter(l=>!l.isDeleted).map(fp)}})}function a5(e,t){return aa({queryKey:["event",e],enabled:!!e,queryFn:async()=>{var n;const a=(n=(await Qe.get(sc.byId(e))).data)==null?void 0:n.data;if(!a)throw new Error("Event not found");return fp(a)}})}function n5(){const e=Et();return At({mutationFn:async t=>(await Qe.post(sc.create,t)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function s5(){const e=Et();return At({mutationFn:async t=>(await Qe.post(sc.update,t)).data,onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["events"]}),e.invalidateQueries({queryKey:["event",r.eventGuid]})}})}function c4(){const e=Et();return At({mutationFn:async t=>(console.log("[mutate] activate",t),(await Qe.put(sc.activateEvent(t))).data),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function u4(){const e=Et();return At({mutationFn:async t=>(console.log("[mutate] deactivate",t),(await Qe.put(sc.deactivateEvent(t))).data),onMutate:t=>{console.log("[onMutate] deactivating",t)},onSuccess:(t,r)=>{console.log("[onSuccess] deactivated",r),e.invalidateQueries({queryKey:["events"]})},onError:(t,r)=>{console.error("[onError] deactivating",r,t)}})}const f4=C.createContext({eventId:void 0,event:void 0,events:[],isSelectorOpen:!1,mustChooseEvent:!1,setEventId:()=>{},openSelector:()=>{},closeSelector:()=>{}});function i5({children:e}){const{data:t}=Xp(),[r,a]=C.useState(()=>localStorage.getItem("eventId")||void 0),[n,l]=C.useState(!1),o=!r,u=g=>{localStorage.setItem("eventId",g),a(g),l(!1)},h=()=>l(!0),x=()=>{o||l(!1)},m=t==null?void 0:t.find(g=>g.id===r);return f.jsx(f4.Provider,{value:{eventId:r,event:m,events:t,isSelectorOpen:n,mustChooseEvent:o,setEventId:u,openSelector:h,closeSelector:x},children:e})}function $r(){return C.useContext(f4)}function l5({onMenuToggle:e}){const{theme:t,toggle:r}=EN(),{logout:a}=lu(),{event:n,mustChooseEvent:l}=$r(),o=n!=null&&n.date?new Date(n.date).toLocaleDateString():"Set a date",u=(n==null?void 0:n.location)||"Add a venue";return f.jsxs("header",{className:"sticky top-0 z-40 flex items-center gap-4 px-6 py-4 bg-white/90 dark:bg-slate-900/80 backdrop-blur border-b border-primary/10 dark:border-primary/20 shadow-sm",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[e&&f.jsx("button",{className:"md:hidden p-2 rounded-xl bg-accent text-primary hover:bg-primary/10 dark:bg-primary/30 dark:text-white",onClick:e,"aria-label":"Toggle sidebar",children:f.jsx(o4,{className:"h-6 w-6"})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"h-11 w-11 rounded-xl bg-gradient-to-br from-primary to-secondary text-white font-bold grid place-items-center shadow-lg shadow-primary/20",children:"MB"}),f.jsxs("div",{className:"space-y-0.5",children:[f.jsx("p",{className:"text-[11px] uppercase tracking-[0.25em] text-primary/70 dark:text-primary/60",children:"My Big Days"}),f.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:"Planning dashboard"})]})]})]}),f.jsx("div",{className:"flex-1 flex justify-center",children:f.jsx("div",{className:`w-full max-w-xl p-4 rounded-2xl border shadow-sm transition bg-white/70 dark:bg-slate-800/70 ${l?"border-amber-300":"border-primary/10"}`,children:f.jsxs("div",{className:"flex items-start justify-between gap-3",children:[f.jsxs("div",{children:[f.jsx("p",{className:`text-[11px] uppercase tracking-wide font-semibold ${l?"text-amber-700":"text-primary/70 dark:text-primary/60"}`,children:l?"Choose an event in the sidebar":"Active event"}),f.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-white line-clamp-1",children:(n==null?void 0:n.title)??"Awaiting selection"}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-200 mt-1",children:[f.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:o}),f.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:u}),f.jsxs("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:["Tables: ",(n==null?void 0:n.noOfTable)??"-"]})]})]}),f.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-primary/10 text-primary font-semibold",children:"Sidebar switch"})]})})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:r,"aria-label":"Toggle dark mode",className:"p-2 rounded-full border border-gray-200 bg-gray-50 hover:bg-gray-100",children:t==="light"?"":""}),f.jsx(Fe,{variant:"secondary",onClick:a,children:"Logout"})]})]})}function o5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"}))}const nd=C.forwardRef(o5);function c5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const u5=C.forwardRef(c5);function f5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const R0=C.forwardRef(f5);function d5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),C.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const ub=C.forwardRef(d5);function h5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),C.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"}))}const x5=C.forwardRef(h5);function m5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"}))}const p5=C.forwardRef(m5);function g5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"}))}const dp=C.forwardRef(g5);function v5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"}))}const y5=C.forwardRef(v5);function b5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const w5=C.forwardRef(b5);function S5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),C.createElement("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}))}const fb=C.forwardRef(S5);function E5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z",clipRule:"evenodd"}))}const db=C.forwardRef(E5);function _5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5 4a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H5zm-1 9v-1h5v2H5a1 1 0 01-1-1zm7 1h4a1 1 0 001-1v-1h-5v2zm0-4h5V8h-5v2zM9 8H4v2h5V8z",clipRule:"evenodd"}))}const hp=C.forwardRef(_5);function k5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"}))}const sd=C.forwardRef(k5);function T5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"}))}const id=C.forwardRef(T5);function N5(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const C5=C.forwardRef(N5),A5=[{to:"/app/dashboard",label:"Member Dashboard",Icon:y5,description:"Overview & insights"},{to:"/app/events",label:"Events",Icon:nd,description:"Manage dates & details"},{to:"/app/rsvps",label:"RSVPs",Icon:x5,description:"Guest responses"},{to:"/app/guests",label:"Guests",Icon:sd,description:"Guest list"},{to:"/app/tables",label:"Tables",Icon:hp,description:"Seating & arrangements"},{to:"/app/tables/floorplan",label:"Floor Plan",Icon:C5,description:"Visual layout"},{to:"/app/wallet",label:"Wallet",Icon:dp,description:"Budget & Expenses"},{to:"/app/users",label:"Users",Icon:id,description:"Team"}];function j5({isOpen:e,onClose:t}){const{event:r,openSelector:a,mustChooseEvent:n}=$r(),[l,o]=Oi.useState(!1),u=Oi.useMemo(()=>r!=null&&r.title?r.title.split(" ").map(h=>h[0]).join("").slice(0,2).toUpperCase():"EV",[r==null?void 0:r.title]);return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:`
          fixed inset-0 bg-black/30 z-20 transition-opacity md:hidden
          ${e?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
        `,onClick:t}),f.jsxs("aside",{className:`
          fixed inset-y-0 left-0 w-72 text-white
          bg-gradient-to-b from-primary/95 via-slate-900 to-secondary/90
          dark:from-primary/70 dark:via-slate-950 dark:to-secondary/70
          z-30 transform transition-all shadow-xl shadow-primary/25
          ${e?"translate-x-0":"-translate-x-full"}
          md:static md:translate-x-0 md:shadow-none
          ${l?"md:w-20":"md:w-72"}
        `,children:[f.jsxs("div",{className:`flex items-center justify-between px-4 py-5 border-b border-white/10 ${l?"md:px-3":"md:px-6"}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"h-11 w-11 rounded-xl bg-white/15 backdrop-blur grid place-items-center text-white/90 font-semibold",children:u}),!l&&f.jsxs("div",{children:[f.jsx("p",{className:"text-[11px] uppercase tracking-[0.2em] text-indigo-200/80",children:"Workspace"}),f.jsx("p",{className:"text-sm font-semibold",children:"Event Control"})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{className:"hidden md:inline-flex p-2 rounded-xl border border-white/10 bg-white/5 hover:bg-white/10 transition",onClick:()=>o(h=>!h),"aria-label":l?"Expand sidebar":"Collapse sidebar",children:f.jsx("span",{"aria-hidden":!0,className:"text-xs font-semibold tracking-wide text-indigo-100",children:l?"":""})}),f.jsx("button",{className:"md:hidden p-2 rounded-xl hover:bg-white/10 transition",onClick:t,"aria-label":"Close sidebar",children:f.jsx(Ud,{className:"h-5 w-5 text-white"})})]})]}),f.jsxs("div",{className:`p-4 space-y-3 ${l?"md:px-3":"md:px-5"}`,children:[f.jsxs("div",{className:`rounded-2xl border border-white/15 bg-white/5 backdrop-blur-sm transition-all ${l?"px-2 py-3":"p-4 space-y-2"}`,children:[f.jsxs("div",{className:`flex items-start gap-3 ${l?"justify-center":""}`,children:[f.jsx("div",{className:"p-2 rounded-xl bg-white/10",children:f.jsx(db,{className:"h-5 w-5 text-amber-200"})}),!l&&f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-[11px] uppercase tracking-wide text-indigo-200/90 font-semibold",children:"Current event"}),f.jsx("p",{className:"text-base font-semibold text-white line-clamp-1",children:(r==null?void 0:r.title)??"Choose an event"}),f.jsxs("p",{className:"text-xs text-indigo-100/80 line-clamp-1",children:[(r==null?void 0:r.location)||"Add a venue","  ",r!=null&&r.date?new Date(r.date).toLocaleDateString():"Set a date"]})]})]}),f.jsx(Fe,{variant:"secondary",className:`w-full justify-center ${l?"text-xs px-2":""}`,onClick:a,children:f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx(db,{className:"h-4 w-4"}),!l&&(n?"Select an event":"Switch event")]})}),n&&!l&&f.jsx("p",{className:"text-[11px] text-amber-100 bg-amber-500/20 border border-amber-200/30 rounded-lg px-3 py-2",children:"Choose an event to unlock the dashboard pages. Switching later stays here in the sidebar."})]}),f.jsx("nav",{className:"space-y-1",children:A5.map(({to:h,label:x,Icon:m,description:g})=>f.jsxs(N0,{to:h,title:x,onClick:t,className:({isActive:v})=>`group flex items-center gap-3 ${l?"justify-center px-2":"px-4"} py-3 rounded-xl border transition-colors text-sm
                   ${v?"border-white/30 bg-white/15 text-white shadow-lg shadow-black/20":"border-transparent text-indigo-100 hover:border-white/20 hover:bg-white/10"}`,children:[f.jsx(m,{className:"h-5 w-5 flex-shrink-0"}),!l&&f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-semibold",children:x}),g&&f.jsx("p",{className:"text-[12px] text-indigo-100/80 group-hover:text-white/90",children:g})]})]},h))})]})]})]})}const qn=({isOpen:e,title:t,onClose:r,children:a,className:n=""})=>e?f.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-100",children:f.jsxs("div",{className:"bg-background text-text rounded-lg shadow-lg max-w-lg w-full p-6 "+n,children:[f.jsx("div",{className:"flex justify-between items-center mb-4",children:t&&f.jsx("h3",{className:"text-lg font-semibold",children:t})}),f.jsx("div",{children:a})]})}):null,ou=({message:e})=>f.jsx("div",{className:"p-2 bg-red-100 text-red-800 rounded text-sm mb-4",children:e});function hb(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(isNaN(t.getTime()))return e.slice(0,10);const r=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-r).toISOString().slice(0,10)}const zd=({isOpen:e,onClose:t,onSuccess:r,initial:a,className:n=""})=>{const[l,o]=C.useState((a==null?void 0:a.title)||""),[u,h]=C.useState(hb(a==null?void 0:a.date)),[x,m]=C.useState(a!=null&&a.noOfTable?Number(a.noOfTable):0),[g,v]=C.useState((a==null?void 0:a.description)||""),[b,y]=C.useState((a==null?void 0:a.location)||""),w=n5(),E=s5(),[k,N]=C.useState(null);C.useEffect(()=>{e&&(o((a==null?void 0:a.title)||""),h(hb(a==null?void 0:a.date)),m(a!=null&&a.noOfTable?Number(a.noOfTable):0),v((a==null?void 0:a.description)||""),y((a==null?void 0:a.location)||""),N(null))},[e,a]);const _=!!a,R=async A=>{var D,T;A.preventDefault();try{if(_&&a){const F=await E.mutateAsync({eventGuid:a.id,name:l,date:u,time:"",description:g,location:b,userID:0,noOfTable:x});r==null||r(F)}else{const F=await w.mutateAsync({name:l,date:u,description:g,location:b,userID:"0",noOfTable:x.toString()});r==null||r(F)}t()}catch(F){console.error(F),N(((T=(D=F.response)==null?void 0:D.data)==null?void 0:T.message)||"Something went wrong.")}};return f.jsx(qn,{isOpen:e,onClose:t,title:_?"Edit Event":"New Event",className:n,children:f.jsxs("form",{onSubmit:R,className:"space-y-4",children:[k&&f.jsx(ou,{message:k}),f.jsx(sr,{label:"Title",value:l,onChange:A=>o(A.target.value)}),f.jsx(sr,{label:"Date",type:"date",value:u,onChange:A=>h(A.target.value)}),f.jsx(sr,{label:"Number of Tables",type:"number",value:x.toString(),onChange:A=>m(Number(A.target.value))}),f.jsx(sr,{label:"Description",value:g,onChange:A=>v(A.target.value)}),f.jsx(sr,{label:"Location",value:b,onChange:A=>y(A.target.value)}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),f.jsx(Fe,{type:"submit",variant:"primary",loading:w.isPending||E.isPending,children:_?E.isPending?"Saving":"Save":w.isPending?"Creating":"Create"})]})]})})};function R5(){const{isSelectorOpen:e,mustChooseEvent:t,events:r=[],eventId:a,setEventId:n,closeSelector:l}=$r(),o=u4(),u=c4(),[h,x]=C.useState(!1),[m,g]=C.useState(void 0);if(!(t||e))return null;const b=T=>{n(T)},y=()=>{g(void 0),x(!0)},w=T=>{g(T),x(!0)},E=T=>o.mutate(T),k=T=>u.mutate(T),N=()=>x(!1),_=T=>{n(T.id),x(!1)},R=t?"Choose an event to unlock your dashboard":"Switch the event you're working on",A=t?"Pick an existing celebration or create a new one to continue planning.":"Keep everything in sync by switching the active event for tables, RSVPs, and wallet.",D=()=>{t||l()};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-50 transition-opacity",onClick:D}),f.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4 overflow-auto",children:f.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl grid md:grid-cols-[1fr_1.15fr] overflow-hidden border border-primary/10",children:[f.jsxs("div",{className:"relative bg-gradient-to-br from-primary via-slate-900 to-secondary text-white p-8 flex flex-col gap-6",children:[f.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_18%_22%,rgba(255,255,255,0.08),transparent_35%),radial-gradient(circle_at_88%_12%,rgba(255,255,255,0.12),transparent_35%)]"}),f.jsxs("div",{className:"relative space-y-3",children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-indigo-200/80 font-semibold",children:"Event workspace"}),f.jsx("h2",{className:"text-2xl font-bold leading-tight",children:R}),f.jsx("p",{className:"text-indigo-100/90 text-sm max-w-md",children:A})]}),f.jsxs("div",{className:"relative grid grid-cols-1 gap-3 text-sm",children:[f.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[f.jsx(VA,{className:"w-5 h-5 text-amber-200"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold",children:"Unified status"}),f.jsx("p",{className:"text-indigo-100/80",children:"Tables, RSVPs, wallet and seating stay on the active event."})]})]}),f.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[f.jsx(YA,{className:"w-5 h-5 text-sky-200"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold",children:"Safe switching"}),f.jsx("p",{className:"text-indigo-100/80",children:"Change events without altering any of your existing data."})]})]}),f.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[f.jsx(WA,{className:"w-5 h-5 text-emerald-200"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold",children:"Quick create"}),f.jsx("p",{className:"text-indigo-100/80",children:"Start a fresh celebration directly from this selector."})]})]})]}),f.jsxs("div",{className:"relative mt-auto",children:[f.jsx(Fe,{onClick:y,className:"w-full justify-center bg-white text-primary hover:bg-primary/10",children:"Start a new event"}),f.jsx("p",{className:"text-xs text-indigo-100/80 text-center mt-3",children:"You'll return here whenever you need to focus on a different event."})]})]}),f.jsxs("div",{className:"flex flex-col bg-accent/30",children:[f.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-gray-200",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Event library"}),f.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Active & archived plans"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Select an event to continue. Everything else stays intact."})]}),f.jsx("button",{onClick:l,className:"p-2 rounded-full border text-gray-500 hover:bg-gray-100 transition disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Close selector",disabled:t,children:f.jsx(Ud,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-3 scrollbar-thin scrollbar-thumb-primary/20",children:r.length===0?f.jsx("div",{className:"h-full min-h-[280px] flex items-center justify-center text-center p-6 bg-white rounded-xl border border-dashed border-primary/20",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"No events yet"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Create your first celebration to unlock the dashboard experience."}),f.jsx(Fe,{onClick:y,children:"Create an event"})]})}):f.jsx("ul",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:r.map(T=>{var q;const F=a===T.id,O=!!((q=T==null?void 0:T.raw)!=null&&q.isDeleted),U=T.date?new Date(T.date).toLocaleDateString():"Date pending";return f.jsxs("li",{role:"option","aria-selected":F,tabIndex:0,onKeyDown:z=>{(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),b(T.id))},onClick:()=>b(T.id),className:`group relative rounded-xl border transition shadow-sm bg-white cursor-pointer outline-none ${F?"border-primary ring-2 ring-primary/25 shadow-primary/15":"border-primary/10 hover:border-primary/30 hover:shadow-md focus:ring-2 focus:ring-primary/25"}`,children:[f.jsx("div",{className:"absolute right-3 top-3",children:F?f.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-indigo-50 text-indigo-700",children:[f.jsx(R0,{className:"w-4 h-4"})," Active"]}):O?f.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-amber-50 text-amber-700",children:"Archived"}):f.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-slate-100 text-slate-700",children:"Ready"})}),f.jsxs("div",{className:"px-4 pt-5 pb-4 space-y-2",children:[f.jsxs("h4",{className:"text-base font-semibold text-slate-900 pr-20 flex items-center gap-2",children:[f.jsx("span",{className:`inline-flex h-2.5 w-2.5 rounded-full ${F?"bg-emerald-500":"bg-primary"}`}),T.title]}),f.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(j0,{className:"w-4 h-4"}),f.jsx("span",{children:U})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(up,{className:"w-4 h-4"}),f.jsx("span",{children:T.location||"Add a venue"})]})]}),T.description&&f.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-wrap",children:[f.jsxs("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:["Tables: ",T.noOfTable??"-"]}),f.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:O?"Archived plan":"Live plan"})]})]}),f.jsxs("div",{className:"px-4 pb-4 pt-2 flex flex-wrap gap-2",children:[f.jsx(Fe,{onClick:z=>{z.stopPropagation(),b(T.id)},className:`flex-1 justify-center ${F?"bg-emerald-600 hover:bg-emerald-500":""}`,children:F?"Using this event":"Use this event"}),f.jsx(Fe,{variant:"secondary",onClick:z=>{z.stopPropagation(),w(T)},children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:z=>{z.stopPropagation(),O?k(T.id):E(T.id)},children:O?"Activate":"Archive"})]})]},T.id)})})}),f.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex flex-wrap gap-3 items-center justify-between bg-white",children:[f.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[f.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"}),f.jsx("span",{children:t?"Choose an event to continue":"Switch anytime without losing changes"})]}),f.jsxs("div",{className:"flex gap-2",children:[!t&&f.jsx(Fe,{variant:"secondary",onClick:l,children:"Cancel"}),f.jsx(Fe,{onClick:y,children:"Create new event"})]})]})]})]})}),f.jsx(zd,{isOpen:h,initial:m,onClose:N,onSuccess:_,className:"z-70"})]})}function D5(){const[e,t]=Oi.useState(!1),{isSelectorOpen:r,mustChooseEvent:a}=$r();return f.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-background via-background to-accent/50 dark:from-slate-950 dark:via-slate-950 dark:to-primary/10 text-text",children:[f.jsx(j5,{isOpen:e,onClose:()=>t(!1)}),f.jsxs("div",{className:"flex flex-col flex-1",children:[f.jsx(l5,{onMenuToggle:()=>t(n=>!n)}),f.jsx("main",{className:"flex-1 p-6 overflow-auto",children:f.jsx(js,{})})]}),(a||r)&&f.jsx(R5,{})]})}function F5(){const[e,t]=C.useState(!1),{data:r=[],isLoading:a,isError:n}=Xp(e),l=u4(),o=c4(),[u,h]=C.useState({open:!1}),x=Na(),{setEventId:m,eventId:g}=$r(),[v,b]=C.useState(""),[y,w]=C.useState("upcoming"),[E,k]=gN();C.useEffect(()=>{const T=E.get("new")==="1",F=E.get("demo")==="1";if(T||F){const O=new Date;O.setMonth(O.getMonth()+2);const U=F?{title:"Sample Summer Wedding",date:O.toISOString().slice(0,10),description:"Pre-fill details to see how planning works.",location:"Pick your dream venue",noOfTable:12}:void 0;h({open:!0,event:U});const q=new URLSearchParams(E);q.delete("new"),q.delete("demo"),k(q,{replace:!0})}},[E,k]);const N=C.useMemo(()=>r.find(T=>T.id===g),[r,g]),_=C.useMemo(()=>{const T=v.toLowerCase();return r.filter(O=>{var U;return O.title.toLowerCase().includes(T)||((U=O.location)==null?void 0:U.toLowerCase().includes(T))}).sort((O,U)=>{if(y==="name")return O.title.localeCompare(U.title);const q=new Date(O.date).getTime(),z=new Date(U.date).getTime();return y==="upcoming"?q-z:z-q})},[r,v,y]),R=r.filter(T=>{var F;return!((F=T.raw)!=null&&F.isDeleted)}).length,A=r.filter(T=>{var F;return(F=T.raw)==null?void 0:F.isDeleted}).length,D=r.length?new Date(Math.min(...r.map(T=>new Date(T.date).getTime()).filter(T=>!Number.isNaN(T)))):void 0;return a?f.jsx("p",{children:"Loading events"}):n?f.jsx("p",{children:"Failed to load events."}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Your Events"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Prioritize the next celebration or revisit archived plans."})]}),f.jsx("div",{className:"flex flex-wrap gap-3",children:f.jsxs(Fe,{variant:e?"primary":"secondary",onClick:()=>t(T=>!T),children:[e?"Hide":"Show"," archived"]})})]}),N&&f.jsxs("div",{className:"p-4 rounded-xl border border-primary/25 bg-white shadow-sm shadow-primary/10 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsx(R0,{className:"w-6 h-6 text-primary mt-0.5"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-wide text-primary font-semibold",children:"Active event"}),f.jsx("p",{className:"text-lg font-semibold text-gray-800",children:N.title}),f.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[f.jsx(j0,{className:"w-4 h-4"}),new Date(N.date).toLocaleDateString()," ",f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(up,{className:"w-4 h-4"}),N.location||"Add a venue"]})]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(Fe,{onClick:()=>x("/app/rsvps"),children:"Continue planning"}),f.jsx(Fe,{variant:"secondary",onClick:()=>x(`${N.id}/form-fields`),children:"Customize fields"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[f.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Active events"}),f.jsx("p",{className:"text-2xl font-semibold text-primary",children:R})]}),f.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Archived events"}),f.jsx("p",{className:"text-2xl font-semibold text-secondary",children:A})]}),f.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Upcoming next"}),f.jsx("p",{className:"text-md text-gray-700",children:D?D.toLocaleDateString():"Add a date"})]})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[f.jsxs("div",{className:"flex flex-1 gap-3",children:[f.jsx("input",{type:"search",value:v,onChange:T=>b(T.target.value),placeholder:"Search by name or location",className:"w-full border border-primary/20 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary/20"}),f.jsxs("select",{value:y,onChange:T=>w(T.target.value),className:"border border-primary/20 rounded-lg px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-primary/20",children:[f.jsx("option",{value:"upcoming",children:"Soonest first"}),f.jsx("option",{value:"recent",children:"Most recent"}),f.jsx("option",{value:"name",children:"Alphabetical"})]})]}),f.jsxs("div",{className:"hidden lg:block text-right text-sm text-gray-500",children:["Welcome to ",f.jsx("span",{className:"text-secondary font-semibold",children:"My Big Day"})]})]}),_.length===0?f.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70",children:[f.jsx("p",{className:"text-lg font-semibold",children:"No events match your filters."}),f.jsx("p",{className:"text-sm text-gray-600",children:"Create one to start planning or clear the search."}),f.jsx(Fe,{onClick:()=>h({open:!0}),children:"Create your first event"})]}):f.jsx("ul",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:_.map(T=>{var U;const F=g===T.id,O=!!((U=T==null?void 0:T.raw)!=null&&U.isDeleted);return f.jsx("li",{className:`p-4 rounded-xl border shadow-sm transition hover:shadow-md bg-white/90 backdrop-blur dark:bg-gray-800 ${F?"border-primary":"border-gray-100"}`,children:f.jsxs("div",{className:"flex items-start justify-between gap-3",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:T.title}),F&&f.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-semibold px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:[f.jsx(R0,{className:"w-4 h-4"})," Active"]}),O&&f.jsx("span",{className:"inline-block text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800",children:"Archived"})]}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex flex-wrap items-center gap-2",children:[f.jsxs("span",{className:"inline-flex items-center gap-1",children:[f.jsx(j0,{className:"w-4 h-4"}),new Date(T.date).toLocaleDateString()]}),f.jsxs("span",{className:"inline-flex items-center gap-1",children:[f.jsx(up,{className:"w-4 h-4"}),T.location||"Add a venue"]})]}),T.description&&f.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),f.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-3",children:[f.jsxs("span",{children:["Tables: ",T.noOfTable??"Not set"]}),f.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),f.jsx("span",{children:O?"Archived plan":"Ready for guests"})]})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx(Fe,{onClick:()=>{m(T.id),x("/app/rsvps")},children:F?" Active":"Select event"}),f.jsx(Fe,{variant:"secondary",onClick:()=>x(`${T.id}/form-fields`),children:"Form fields"}),f.jsx(Fe,{variant:"secondary",onClick:()=>x(`${T.id}/edit`),children:"Edit details"}),O?f.jsx(Fe,{variant:"primary",style:{backgroundColor:"#16a34a",borderColor:"#16a34a"},onClick:()=>o.mutate(T.id),disabled:o.isPending,children:o.isPending?"Activating":"Activate"}):f.jsx(Fe,{variant:"secondary",style:{backgroundColor:"#dc2626",borderColor:"#dc2626"},onClick:()=>l.mutate(T.id),disabled:l.isPending,children:l.isPending?"Deactivating":"Archive"})]})]})},T.id)})}),f.jsx(zd,{isOpen:u.open,onClose:()=>h({open:!1}),onSuccess:()=>h({open:!1}),initial:u.event})]}),f.jsx(js,{})]})}function O5(){const{id:e}=Gn(),t=Na(),{data:r,isLoading:a,isError:n}=a5(e);return a?f.jsx("div",{className:"p-6 text-center",children:"Loading"}):n||!r?f.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load Event."}):f.jsx(zd,{isOpen:!0,initial:r,onClose:()=>t(-1)})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xd={};xd.version="0.18.5";var d4=1252,M5=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$p=function(e){M5.indexOf(e)!=-1&&(d4=Yp[0]=e)};function L5(){$p(1252)}var Pn=function(e){$p(e)};function Kp(){Pn(1200),L5()}function xb(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function B5(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function h4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var x0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?B5(e.slice(2)):t==254&&r==255?h4(e.slice(2)):t==65279?e.slice(1):e},Ff=function(t){return String.fromCharCode(t)},mb=function(t){return String.fromCharCode(t)},D0,Di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function F0(e){for(var t="",r=0,a=0,n=0,l=0,o=0,u=0,h=0,x=0;x<e.length;)r=e.charCodeAt(x++),l=r>>2,a=e.charCodeAt(x++),o=(r&3)<<4|a>>4,n=e.charCodeAt(x++),u=(a&15)<<2|n>>6,h=n&63,isNaN(a)?u=h=64:isNaN(n)&&(h=64),t+=Di.charAt(l)+Di.charAt(o)+Di.charAt(u)+Di.charAt(h);return t}function tn(e){var t="",r=0,a=0,n=0,l=0,o=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Di.indexOf(e.charAt(x++)),o=Di.indexOf(e.charAt(x++)),r=l<<2|o>>4,t+=String.fromCharCode(r),u=Di.indexOf(e.charAt(x++)),a=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),h=Di.indexOf(e.charAt(x++)),n=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(n));return t}var vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Us=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Li(e){return vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pb(e){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ja=function(t){return vt?Us(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hd(e){if(typeof ArrayBuffer>"u")return Ja(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function zi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function P5(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Qp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Qp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xr=vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Us(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function I5(e){for(var t=[],r=0,a=e.length+250,n=Li(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++l)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|u>>6&15|(o&3)<<4,n[r++]=128|u&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Li(65535),a=65530)}return t.push(n.slice(0,r)),Xr(t)}var Ta=/\u0000/g,m0=/[\u0001-\u0006]/g;function Do(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function In(e,t){var r=""+e;return r.length>=t?r:pr("0",t-r.length)+r}function Zp(e,t){var r=""+e;return r.length>=t?r:pr(" ",t-r.length)+r}function md(e,t){var r=""+e;return r.length>=t?r:r+pr(" ",t-r.length)}function U5(e,t){var r=""+Math.round(e);return r.length>=t?r:pr("0",t-r.length)+r}function z5(e,t){var r=""+e;return r.length>=t?r:pr("0",t-r.length)+r}var gb=Math.pow(2,32);function _o(e,t){if(e>gb||e<-gb)return U5(e,t);var r=Math.round(e);return z5(r,t)}function pd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function H5(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},G5={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gd(e,t,r){for(var a=e<0?-1:1,n=e*a,l=0,o=1,u=0,h=1,x=0,m=0,g=Math.floor(n);x<t&&(g=Math.floor(n),u=g*o+l,m=g*x+h,!(n-g<5e-8));)n=1/(n-g),l=o,o=u,h=x,x=m;if(m>t&&(x>t?(m=h,u=l):(m=x,u=o)),!r)return[0,a*u,m];var v=Math.floor(a*u/m);return[v,a*u-v*m,m]}function fl(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),l=0,o=[],u={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++n==86400&&(u.T=n=0,++a,++u.D)),a===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),a<60&&(l=(l+6)%7),r&&(l=$5(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=n%60,n=Math.floor(n/60),u.M=n%60,n=Math.floor(n/60),u.H=n,u.q=l,u}var x4=new Date(1899,11,31,0,0,0),V5=x4.getTime(),q5=new Date(1900,2,1,0,0,0);function m4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=q5&&(r+=24*60*60*1e3),(r-(V5+(e.getTimezoneOffset()-x4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Jp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function W5(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function X5(e){var t=e<0?12:11,r=Jp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Y5(e){var t=Jp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function O0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=X5(e):t===10?r=e.toFixed(10).substr(0,12):r=Y5(e),Jp(W5(r.toUpperCase()))}function jl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):O0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return _n(14,m4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $5(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function K5(e,t,r,a){var n="",l=0,o=0,u=r.y,h,x=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,x=2;break;default:h=u%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,x=t.length;break;case 3:return Sm[r.m-1][1];case 5:return Sm[r.m-1][0];default:return Sm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,x=t.length;break;case 3:return vb[r.q][0];default:return vb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?In(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(n=In(l,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:h=u,x=1;break}var m=x>0?In(h,x):"";return m}function Fi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var p4=/%/g;function Q5(e,t,r){var a=t.replace(p4,""),n=t.length-a.length;return Fs(e,a,r*Math.pow(10,2*n))+pr("%",n)}function Z5(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Fs(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function g4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+g4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,m){return h+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var v4=/# (\?+)( ?)\/( ?)(\d+)/;function J5(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),l=Math.floor(n/a),o=n-l*a,u=a;return r+(l===0?"":""+l)+" "+(o===0?pr(" ",e[1].length+1+e[4].length):Zp(o,e[1].length)+e[2]+"/"+e[3]+In(u,e[4].length))}function e6(e,t,r){return r+(t===0?"":""+t)+pr(" ",e[1].length+2+e[4].length)}var y4=/^#*0*\.([0#]+)/,b4=/\).*[0#]/,w4=/\(###\) ###\\?-####/;function Sa(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function bb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function wb(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function t6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function r6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function xn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(b4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xn("n",a,r):"("+xn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Z5(e,t,r);if(t.indexOf("%")!==-1)return Q5(e,t,r);if(t.indexOf("E")!==-1)return g4(t,r);if(t.charCodeAt(0)===36)return"$"+xn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,u,h=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+_o(h,t.length);if(t.match(/^[#?]+$/))return n=_o(r,0),n==="0"&&(n=""),n.length>t.length?n:Sa(t.substr(0,t.length-n.length))+n;if(l=t.match(v4))return J5(l,h,x);if(t.match(/^#+0+$/))return x+_o(h,t.length-t.indexOf("0"));if(l=t.match(y4))return n=bb(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Sa(l[1])).replace(/\.$/,"."+Sa(l[1])).replace(/\.(\d*)$/,function(y,w){return"."+w+pr("0",Sa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+bb(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Fi(_o(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xn(e,t,-r):Fi(""+(Math.floor(r)+t6(r,l[1].length)))+"."+In(wb(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return xn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Do(xn(e,t.replace(/[\\-]/g,""),r)),o=0,Do(Do(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<n.length?n.charAt(o++):y==="0"?"0":""}));if(t.match(w4))return n=xn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=gd(h,Math.pow(10,o)-1,!1),n=""+x,m=Fs("n",l[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=md(u[2],o),m.length<l[4].length&&(m=Sa(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=gd(h,Math.pow(10,o)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Zp(u[1],o)+l[2]+"/"+l[3]+md(u[2],o):pr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=_o(r,0),t.length<=n.length?n:Sa(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var g=t.indexOf(".")-o,v=t.length-n.length-g;return Sa(t.substr(0,g)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=wb(r,l[1].length),r<0?"-"+xn(e,t,-r):Fi(r6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?In(0,3-y.length):"")+y})+"."+In(o,l[1].length);switch(t){case"###,##0.00":return xn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=Fi(_o(h,0));return b!=="0"?x+b:"";case"###,###.00":return xn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function a6(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Fs(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function n6(e,t,r){var a=t.replace(p4,""),n=t.length-a.length;return Fs(e,a,r*Math.pow(10,2*n))+pr("%",n)}function S4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,m){return h+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function es(e,t,r){if(e.charCodeAt(0)===40&&!t.match(b4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?es("n",a,r):"("+es("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a6(e,t,r);if(t.indexOf("%")!==-1)return n6(e,t,r);if(t.indexOf("E")!==-1)return S4(t,r);if(t.charCodeAt(0)===36)return"$"+es(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,u,h=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+In(h,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Sa(t.substr(0,t.length-n.length))+n;if(l=t.match(v4))return e6(l,h,x);if(t.match(/^#+0+$/))return x+In(h,t.length-t.indexOf("0"));if(l=t.match(y4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Sa(l[1])).replace(/\.$/,"."+Sa(l[1])),n=n.replace(/\.(\d*)$/,function(y,w){return"."+w+pr("0",Sa(l[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Fi(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+es(e,t,-r):Fi(""+r)+"."+pr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return es(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Do(es(e,t.replace(/[\\-]/g,""),r)),o=0,Do(Do(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<n.length?n.charAt(o++):y==="0"?"0":""}));if(t.match(w4))return n=es(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=gd(h,Math.pow(10,o)-1,!1),n=""+x,m=Fs("n",l[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=md(u[2],o),m.length<l[4].length&&(m=Sa(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=gd(h,Math.pow(10,o)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Zp(u[1],o)+l[2]+"/"+l[3]+md(u[2],o):pr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Sa(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var g=t.indexOf(".")-o,v=t.length-n.length-g;return Sa(t.substr(0,g)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+es(e,t,-r):Fi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?In(0,3-y.length):"")+y})+"."+In(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var b=Fi(""+h);return b!=="0"?x+b:"";default:if(t.match(/\.[0#?]*$/))return es(e,t.slice(0,t.lastIndexOf(".")),r)+Sa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fs(e,t,r){return(r|0)===r?es(e,t,r):xn(e,t,r)}function s6(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var E4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ic(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":pd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(E4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function i6(e,t,r,a){for(var n=[],l="",o=0,u="",h="t",x,m,g,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!pd(e,o))throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(g=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(g);n[n.length]={t:"t",v:l},++o;break;case"\\":var b=e.charAt(++o),y=b==="("||b===")"?b:"t";n[n.length]={t:y,v:b},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=fl(t,r,e.charAt(o+1)==="2"),x==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=fl(t,r),x==null))return"";for(l=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),n[n.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var w={t:u,v:u};if(x==null&&(x=fl(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(w.v=x.H>=12?"P":"A"),w.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(w.v=x.H>=12?"PM":"AM"),w.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(w.v=x.H>=12?"":""),w.t="T",o+=5,v="h"):(w.t="t",++o),x==null&&w.t==="T")return"";n[n.length]=w,h=u;break;case"[":for(l=u;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(E4)){if(x==null&&(x=fl(t,r),x==null))return"";n[n.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ic(e)||(n[n.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=u;++o<e.length&&(u=e.charAt(o))==="0";)l+=u;n[n.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)l+=u;n[n.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++o)===u;)l+=u;n[n.length]={t:u,v:l},h=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);n[n.length]={t:"D",v:l};break;case" ":n[n.length]={t:u,v:u},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"t",v:u},++o;break}var E=0,k=0,N;for(o=n.length-1,h="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=v,h="h",E<1&&(E=1);break;case"s":(N=n[o].v.match(/\.0+$/))&&(k=Math.max(k,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=n[o].t;break;case"m":h==="s"&&(n[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&n[o].v.match(/[Hh]/)&&(E=1),E<2&&n[o].v.match(/[Mm]/)&&(E=2),E<3&&n[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var _="",R;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=K5(n[o].t.charCodeAt(0),n[o].v,x,k),n[o].t="t";break;case"n":case"?":for(R=o+1;n[R]!=null&&((u=n[R].t)==="?"||u==="D"||(u===" "||u==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[o].v+=n[R].v,n[R]={v:"",t:";"},++R;_+=n[o].v,o=R-1;break;case"G":n[o].t="t",n[o].v=jl(t,r);break}var A="",D,T;if(_.length>0){_.charCodeAt(0)==40?(D=t<0&&_.charCodeAt(0)===45?-t:t,T=Fs("n",_,D)):(D=t<0&&a>1?-t:t,T=Fs("n",_,D),D<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),R=T.length-1;var F=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){F=o;break}var O=n.length;if(F===n.length&&T.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(R>=n[o].v.length-1?(R-=n[o].v.length,n[o].v=T.substr(R+1,n[o].v.length)):R<0?n[o].v="":(n[o].v=T.substr(0,R+1),R=-1),n[o].t="t",O=o);R>=0&&O<n.length&&(n[O].v=T.substr(0,R+1)+n[O].v)}else if(F!==n.length&&T.indexOf("E")===-1){for(R=T.indexOf(".")-1,o=F;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(m=n[o].v.indexOf(".")>-1&&o===F?n[o].v.indexOf(".")-1:n[o].v.length-1,A=n[o].v.substr(m+1);m>=0;--m)R>=0&&(n[o].v.charAt(m)==="0"||n[o].v.charAt(m)==="#")&&(A=T.charAt(R--)+A);n[o].v=A,n[o].t="t",O=o}for(R>=0&&O<n.length&&(n[O].v=T.substr(0,R+1)+n[O].v),R=T.indexOf(".")+1,o=F;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==F)){for(m=n[o].v.indexOf(".")>-1&&o===F?n[o].v.indexOf(".")+1:0,A=n[o].v.substr(0,m);m<n[o].v.length;++m)R<T.length&&(A+=T.charAt(R++));n[o].v=A,n[o].t="t",O=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(D=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Fs(n[o].t,n[o].v,D),n[o].t="t");var U="";for(o=0;o!==n.length;++o)n[o]!=null&&(U+=n[o].v);return U}var Sb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Eb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function l6(e,t){var r=s6(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Sb),u=r[1].match(Sb);return Eb(t,o)?[a,r[0]]:Eb(t,u)?[a,r[1]]:[a,r[o!=null&&u!=null?2:1]]}return[a,l]}function _n(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:et)[e],a==null&&(a=r.table&&r.table[yb[e]]||et[yb[e]]),a==null&&(a=G5[e]||"General");break}if(pd(a,0))return jl(t,r);t instanceof Date&&(t=m4(t,r.date1904));var n=l6(a,t);if(pd(n[1]))return jl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return i6(n[1],t,r,n[0])}function Os(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(et[r]==null){t<0&&(t=r);continue}if(et[r]==e){t=r;break}}t<0&&(t=391)}return et[t]=e,t}function Gd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Os(e[t],t)}function lc(){et=H5()}var o6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function c6(e){var t=typeof e=="number"?et[e]:e;return t=t.replace(_4,"(\\d+)"),new RegExp("^"+t+"$")}function u6(e,t,r){var a=-1,n=-1,l=-1,o=-1,u=-1,h=-1;(t.match(_4)||[]).forEach(function(g,v){var b=parseInt(r[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":a=b;break;case"d":l=b;break;case"h":o=b;break;case"s":h=b;break;case"m":o>=0?u=b:n=b;break}}),h>=0&&u==-1&&n>=0&&(u=n,n=-1);var x=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?x:a==-1&&n==-1&&l==-1?m:x+"T"+m}var f6=function(){var e={};e.version="1.2.0";function t(){for(var T=0,F=new Array(256),O=0;O!=256;++O)T=O,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[O]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function a(T){var F=0,O=0,U=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)q[U]=T[U];for(U=0;U!=256;++U)for(O=T[U],F=256+U;F<4096;F+=256)O=q[F]=O>>>8^T[O&255];var z=[];for(U=1;U!=16;++U)z[U-1]=typeof Int32Array<"u"?q.subarray(U*256,U*256+256):q.slice(U*256,U*256+256);return z}var n=a(r),l=n[0],o=n[1],u=n[2],h=n[3],x=n[4],m=n[5],g=n[6],v=n[7],b=n[8],y=n[9],w=n[10],E=n[11],k=n[12],N=n[13],_=n[14];function R(T,F){for(var O=F^-1,U=0,q=T.length;U<q;)O=O>>>8^r[(O^T.charCodeAt(U++))&255];return~O}function A(T,F){for(var O=F^-1,U=T.length-15,q=0;q<U;)O=_[T[q++]^O&255]^N[T[q++]^O>>8&255]^k[T[q++]^O>>16&255]^E[T[q++]^O>>>24]^w[T[q++]]^y[T[q++]]^b[T[q++]]^v[T[q++]]^g[T[q++]]^m[T[q++]]^x[T[q++]]^h[T[q++]]^u[T[q++]]^o[T[q++]]^l[T[q++]]^r[T[q++]];for(U+=15;q<U;)O=O>>>8^r[(O^T[q++])&255];return~O}function D(T,F){for(var O=F^-1,U=0,q=T.length,z=0,te=0;U<q;)z=T.charCodeAt(U++),z<128?O=O>>>8^r[(O^z)&255]:z<2048?(O=O>>>8^r[(O^(192|z>>6&31))&255],O=O>>>8^r[(O^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,te=T.charCodeAt(U++)&1023,O=O>>>8^r[(O^(240|z>>8&7))&255],O=O>>>8^r[(O^(128|z>>2&63))&255],O=O>>>8^r[(O^(128|te>>6&15|(z&3)<<4))&255],O=O>>>8^r[(O^(128|te&63))&255]):(O=O>>>8^r[(O^(224|z>>12&15))&255],O=O>>>8^r[(O^(128|z>>6&63))&255],O=O>>>8^r[(O^(128|z&63))&255]);return~O}return e.table=r,e.bstr=R,e.buf=A,e.str=D,e}(),We=function(){var t={};t.version="1.2.1";function r(M,X){for(var I=M.split("/"),H=X.split("/"),W=0,Y=0,xe=Math.min(I.length,H.length);W<xe;++W){if(Y=I[W].length-H[W].length)return Y;if(I[W]!=H[W])return I[W]<H[W]?-1:1}return I.length-H.length}function a(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:a(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(0,X+1)}function n(M){if(M.charAt(M.length-1)=="/")return n(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(X+1)}function l(M,X){typeof X=="string"&&(X=new Date(X));var I=X.getHours();I=I<<6|X.getMinutes(),I=I<<5|X.getSeconds()>>>1,M.write_shift(2,I);var H=X.getFullYear()-1980;H=H<<4|X.getMonth()+1,H=H<<5|X.getDate(),M.write_shift(2,H)}function o(M){var X=M.read_shift(2)&65535,I=M.read_shift(2)&65535,H=new Date,W=I&31;I>>>=5;var Y=I&15;I>>>=4,H.setMilliseconds(0),H.setFullYear(I+1980),H.setMonth(Y-1),H.setDate(W);var xe=X&31;X>>>=5;var be=X&63;return X>>>=6,H.setHours(X),H.setMinutes(be),H.setSeconds(xe<<1),H}function u(M){ta(M,0);for(var X={},I=0;M.l<=M.length-4;){var H=M.read_shift(2),W=M.read_shift(2),Y=M.l+W,xe={};switch(H){case 21589:I=M.read_shift(1),I&1&&(xe.mtime=M.read_shift(4)),W>5&&(I&2&&(xe.atime=M.read_shift(4)),I&4&&(xe.ctime=M.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}M.l=Y,X[H]=xe}return X}var h;function x(){return h||(h={})}function m(M,X){if(M[0]==80&&M[1]==75)return qs(M,X);if((M[0]|32)==109&&(M[1]|32)==105)return Xs(M,X);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var I=3,H=512,W=0,Y=0,xe=0,be=0,ue=0,me=[],ge=M.slice(0,512);ta(ge,0);var De=g(ge);switch(I=De[0],I){case 3:H=512;break;case 4:H=4096;break;case 0:if(De[1]==0)return qs(M,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}H!==512&&(ge=M.slice(0,H),ta(ge,28));var Le=M.slice(0,H);v(ge,I);var He=ge.read_shift(4,"i");if(I===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);ge.l+=4,xe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),be=ge.read_shift(4,"i"),W=ge.read_shift(4,"i"),ue=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i");for(var Me=-1,ze=0;ze<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++ze)me[ze]=Me;var it=b(M,H);E(ue,Y,it,H,me);var Ut=N(it,xe,me,H);Ut[xe].name="!Directory",W>0&&be!==te&&(Ut[be].name="!MiniFAT"),Ut[me[0]].name="!FAT",Ut.fat_addrs=me,Ut.ssz=H;var zt={},Kt=[],fs=[],Ys=[];_(xe,Ut,it,Kt,W,zt,fs,be),y(fs,Ys,Kt),Kt.shift();var rn={FileIndex:fs,FullPaths:Ys};return X&&X.raw&&(rn.raw={header:Le,sectors:it}),rn}function g(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(ce,"Header Signature: "),M.l+=16;var X=M.read_shift(2,"u");return[M.read_shift(2,"u"),X]}function v(M,X){var I=9;switch(M.l+=2,I=M.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function b(M,X){for(var I=Math.ceil(M.length/X)-1,H=[],W=1;W<I;++W)H[W-1]=M.slice(W*X,(W+1)*X);return H[I-1]=M.slice(I*X),H}function y(M,X,I){for(var H=0,W=0,Y=0,xe=0,be=0,ue=I.length,me=[],ge=[];H<ue;++H)me[H]=ge[H]=H,X[H]=I[H];for(;be<ge.length;++be)H=ge[be],W=M[H].L,Y=M[H].R,xe=M[H].C,me[H]===H&&(W!==-1&&me[W]!==W&&(me[H]=me[W]),Y!==-1&&me[Y]!==Y&&(me[H]=me[Y])),xe!==-1&&(me[xe]=H),W!==-1&&H!=me[H]&&(me[W]=me[H],ge.lastIndexOf(W)<be&&ge.push(W)),Y!==-1&&H!=me[H]&&(me[Y]=me[H],ge.lastIndexOf(Y)<be&&ge.push(Y));for(H=1;H<ue;++H)me[H]===H&&(Y!==-1&&me[Y]!==Y?me[H]=me[Y]:W!==-1&&me[W]!==W&&(me[H]=me[W]));for(H=1;H<ue;++H)if(M[H].type!==0){if(be=H,be!=me[be])do be=me[be],X[H]=X[be]+"/"+X[H];while(be!==0&&me[be]!==-1&&be!=me[be]);me[H]=-1}for(X[0]+="/",H=1;H<ue;++H)M[H].type!==2&&(X[H]+="/")}function w(M,X,I){for(var H=M.start,W=M.size,Y=[],xe=H;I&&W>0&&xe>=0;)Y.push(X.slice(xe*z,xe*z+z)),W-=z,xe=cl(I,xe*4);return Y.length===0?we(0):Xr(Y).slice(0,M.size)}function E(M,X,I,H,W){var Y=te;if(M===te){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var xe=I[M],be=(H>>>2)-1;if(!xe)return;for(var ue=0;ue<be&&(Y=cl(xe,ue*4))!==te;++ue)W.push(Y);E(cl(xe,H-4),X-1,I,H,W)}}function k(M,X,I,H,W){var Y=[],xe=[];W||(W=[]);var be=H-1,ue=0,me=0;for(ue=X;ue>=0;){W[ue]=!0,Y[Y.length]=ue,xe.push(M[ue]);var ge=I[Math.floor(ue*4/H)];if(me=ue*4&be,H<4+me)throw new Error("FAT boundary crossed: "+ue+" 4 "+H);if(!M[ge])break;ue=cl(M[ge],me)}return{nodes:Y,data:Mb([xe])}}function N(M,X,I,H){var W=M.length,Y=[],xe=[],be=[],ue=[],me=H-1,ge=0,De=0,Le=0,He=0;for(ge=0;ge<W;++ge)if(be=[],Le=ge+X,Le>=W&&(Le-=W),!xe[Le]){ue=[];var Me=[];for(De=Le;De>=0;){Me[De]=!0,xe[De]=!0,be[be.length]=De,ue.push(M[De]);var ze=I[Math.floor(De*4/H)];if(He=De*4&me,H<4+He)throw new Error("FAT boundary crossed: "+De+" 4 "+H);if(!M[ze]||(De=cl(M[ze],He),Me[De]))break}Y[Le]={nodes:be,data:Mb([ue])}}return Y}function _(M,X,I,H,W,Y,xe,be){for(var ue=0,me=H.length?2:0,ge=X[M].data,De=0,Le=0,He;De<ge.length;De+=128){var Me=ge.slice(De,De+128);ta(Me,64),Le=Me.read_shift(2),He=ig(Me,0,Le-me),H.push(He);var ze={name:He,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},it=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);it!==0&&(ze.ct=R(Me,Me.l-8));var Ut=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Ut!==0&&(ze.mt=R(Me,Me.l-8)),ze.start=Me.read_shift(4,"i"),ze.size=Me.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=te,ze.name=""),ze.type===5?(ue=ze.start,W>0&&ue!==te&&(X[ue].name="!StreamData")):ze.size>=4096?(ze.storage="fat",X[ze.start]===void 0&&(X[ze.start]=k(I,ze.start,X.fat_addrs,X.ssz)),X[ze.start].name=ze.name,ze.content=X[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ue!==te&&ze.start!==te&&X[ue]&&(ze.content=w(ze,X[ue].data,(X[be]||{}).data))),ze.content&&ta(ze.content,0),Y[He]=ze,xe.push(ze)}}function R(M,X){return new Date((Za(M,X+4)/1e7*Math.pow(2,32)+Za(M,X)/1e7-11644473600)*1e3)}function A(M,X){return x(),m(h.readFileSync(M),X)}function D(M,X){var I=X&&X.type;switch(I||vt&&Buffer.isBuffer(M)&&(I="buffer"),I||"base64"){case"file":return A(M,X);case"base64":return m(Ja(tn(M)),X);case"binary":return m(Ja(M),X)}return m(M,X)}function T(M,X){var I=X||{},H=I.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=H+"/",M.FileIndex[0]={name:H,type:5}),I.CLSID&&(M.FileIndex[0].clsid=I.CLSID),F(M)}function F(M){var X="Sh33tJ5";if(!We.find(M,"/"+X)){var I=we(4);I[0]=55,I[1]=I[3]=50,I[2]=54,M.FileIndex.push({name:X,type:2,content:I,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+X),O(M)}}function O(M,X){T(M);for(var I=!1,H=!1,W=M.FullPaths.length-1;W>=0;--W){var Y=M.FileIndex[W];switch(Y.type){case 0:H?I=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(Y.R*Y.L*Y.C)&&(I=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!X)){var xe=new Date(1987,1,19),be=0,ue=Object.create?Object.create(null):{},me=[];for(W=0;W<M.FullPaths.length;++W)ue[M.FullPaths[W]]=!0,M.FileIndex[W].type!==0&&me.push([M.FullPaths[W],M.FileIndex[W]]);for(W=0;W<me.length;++W){var ge=a(me[W][0]);H=ue[ge],H||(me.push([ge,{name:n(ge).replace("/",""),type:1,clsid:ee,ct:xe,mt:xe,content:null}]),ue[ge]=!0)}for(me.sort(function(He,Me){return r(He[0],Me[0])}),M.FullPaths=[],M.FileIndex=[],W=0;W<me.length;++W)M.FullPaths[W]=me[W][0],M.FileIndex[W]=me[W][1];for(W=0;W<me.length;++W){var De=M.FileIndex[W],Le=M.FullPaths[W];if(De.name=n(Le).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||ee,W===0)De.C=me.length>1?1:-1,De.size=0,De.type=5;else if(Le.slice(-1)=="/"){for(be=W+1;be<me.length&&a(M.FullPaths[be])!=Le;++be);for(De.C=be>=me.length?-1:be,be=W+1;be<me.length&&a(M.FullPaths[be])!=a(Le);++be);De.R=be>=me.length?-1:be,De.type=1}else a(M.FullPaths[W+1]||"")==a(Le)&&(De.R=W+1),De.type=2}}}function U(M,X){var I=X||{};if(I.fileType=="mad")return Ha(M,I);switch(O(M),I.fileType){case"zip":return re(M,I)}var H=function(He){for(var Me=0,ze=0,it=0;it<He.FileIndex.length;++it){var Ut=He.FileIndex[it];if(Ut.content){var zt=Ut.content.length;zt>0&&(zt<4096?Me+=zt+63>>6:ze+=zt+511>>9)}}for(var Kt=He.FullPaths.length+3>>2,fs=Me+7>>3,Ys=Me+127>>7,rn=fs+ze+Kt+Ys,Cn=rn+127>>7,Wi=Cn<=109?0:Math.ceil((Cn-109)/127);rn+Cn+Wi+127>>7>Cn;)Wi=++Cn<=109?0:Math.ceil((Cn-109)/127);var An=[1,Wi,Cn,Ys,Kt,ze,Me,0];return He.FileIndex[0].size=Me<<6,An[7]=(He.FileIndex[0].start=An[0]+An[1]+An[2]+An[3]+An[4]+An[5])+(An[6]+7>>3),An}(M),W=we(H[7]<<9),Y=0,xe=0;{for(Y=0;Y<8;++Y)W.write_shift(1,de[Y]);for(Y=0;Y<8;++Y)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),Y=0;Y<3;++Y)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,H[2]),W.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:te),W.write_shift(4,H[3]),W.write_shift(-4,H[1]?H[0]-1:te),W.write_shift(4,H[1]),Y=0;Y<109;++Y)W.write_shift(-4,Y<H[2]?H[1]+Y:-1)}if(H[1])for(xe=0;xe<H[1];++xe){for(;Y<236+xe*127;++Y)W.write_shift(-4,Y<H[2]?H[1]+Y:-1);W.write_shift(-4,xe===H[1]-1?te:xe+1)}var be=function(He){for(xe+=He;Y<xe-1;++Y)W.write_shift(-4,Y+1);He&&(++Y,W.write_shift(-4,te))};for(xe=Y=0,xe+=H[1];Y<xe;++Y)W.write_shift(-4,ie.DIFSECT);for(xe+=H[2];Y<xe;++Y)W.write_shift(-4,ie.FATSECT);be(H[3]),be(H[4]);for(var ue=0,me=0,ge=M.FileIndex[0];ue<M.FileIndex.length;++ue)ge=M.FileIndex[ue],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=xe,be(me+511>>9)));for(be(H[6]+7>>3);W.l&511;)W.write_shift(-4,ie.ENDOFCHAIN);for(xe=Y=0,ue=0;ue<M.FileIndex.length;++ue)ge=M.FileIndex[ue],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=xe,be(me+63>>6)));for(;W.l&511;)W.write_shift(-4,ie.ENDOFCHAIN);for(Y=0;Y<H[4]<<2;++Y){var De=M.FullPaths[Y];if(!De||De.length===0){for(ue=0;ue<17;++ue)W.write_shift(4,0);for(ue=0;ue<3;++ue)W.write_shift(4,-1);for(ue=0;ue<12;++ue)W.write_shift(4,0);continue}ge=M.FileIndex[Y],Y===0&&(ge.start=ge.size?ge.start-1:te);var Le=Y===0&&I.root||ge.name;if(me=2*(Le.length+1),W.write_shift(64,Le,"utf16le"),W.write_shift(2,me),W.write_shift(1,ge.type),W.write_shift(1,ge.color),W.write_shift(-4,ge.L),W.write_shift(-4,ge.R),W.write_shift(-4,ge.C),ge.clsid)W.write_shift(16,ge.clsid,"hex");else for(ue=0;ue<4;++ue)W.write_shift(4,0);W.write_shift(4,ge.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ge.start),W.write_shift(4,ge.size),W.write_shift(4,0)}for(Y=1;Y<M.FileIndex.length;++Y)if(ge=M.FileIndex[Y],ge.size>=4096)if(W.l=ge.start+1<<9,vt&&Buffer.isBuffer(ge.content))ge.content.copy(W,W.l,0,ge.size),W.l+=ge.size+511&-512;else{for(ue=0;ue<ge.size;++ue)W.write_shift(1,ge.content[ue]);for(;ue&511;++ue)W.write_shift(1,0)}for(Y=1;Y<M.FileIndex.length;++Y)if(ge=M.FileIndex[Y],ge.size>0&&ge.size<4096)if(vt&&Buffer.isBuffer(ge.content))ge.content.copy(W,W.l,0,ge.size),W.l+=ge.size+63&-64;else{for(ue=0;ue<ge.size;++ue)W.write_shift(1,ge.content[ue]);for(;ue&63;++ue)W.write_shift(1,0)}if(vt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function q(M,X){var I=M.FullPaths.map(function(ue){return ue.toUpperCase()}),H=I.map(function(ue){var me=ue.split("/");return me[me.length-(ue.slice(-1)=="/"?2:1)]}),W=!1;X.charCodeAt(0)===47?(W=!0,X=I[0].slice(0,-1)+X):W=X.indexOf("/")!==-1;var Y=X.toUpperCase(),xe=W===!0?I.indexOf(Y):H.indexOf(Y);if(xe!==-1)return M.FileIndex[xe];var be=!Y.match(m0);for(Y=Y.replace(Ta,""),be&&(Y=Y.replace(m0,"!")),xe=0;xe<I.length;++xe)if((be?I[xe].replace(m0,"!"):I[xe]).replace(Ta,"")==Y||(be?H[xe].replace(m0,"!"):H[xe]).replace(Ta,"")==Y)return M.FileIndex[xe];return null}var z=64,te=-2,ce="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Te(M,X,I){x();var H=U(M,I);h.writeFileSync(X,H)}function ne(M){for(var X=new Array(M.length),I=0;I<M.length;++I)X[I]=String.fromCharCode(M[I]);return X.join("")}function B(M,X){var I=U(M,X);switch(X&&X.type||"buffer"){case"file":return x(),h.writeFileSync(X.filename,I),I;case"binary":return typeof I=="string"?I:ne(I);case"base64":return F0(typeof I=="string"?I:ne(I));case"buffer":if(vt)return Buffer.isBuffer(I)?I:Us(I);case"array":return typeof I=="string"?Ja(I):I}return I}var Z;function L(M){try{var X=M.InflateRaw,I=new X;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)Z=M;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function G(M,X){if(!Z)return Gl(M,X);var I=Z.InflateRaw,H=new I,W=H._processChunk(M.slice(M.l),H._finishFlushFlag);return M.l+=H.bytesRead,W}function V(M){return Z?Z.deflateRawSync(M):ct(M)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(M){var X=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(X>>16|X>>8|X)&255}for(var Ne=typeof Uint8Array<"u",Re=Ne?new Uint8Array(256):[],Ze=0;Ze<256;++Ze)Re[Ze]=Ee(Ze);function K(M,X){var I=Re[M&255];return X<=8?I>>>8-X:(I=I<<8|Re[M>>8&255],X<=16?I>>>16-X:(I=I<<8|Re[M>>16&255],I>>>24-X))}function Ae(M,X){var I=X&7,H=X>>>3;return(M[H]|(I<=6?0:M[H+1]<<8))>>>I&3}function lt(M,X){var I=X&7,H=X>>>3;return(M[H]|(I<=5?0:M[H+1]<<8))>>>I&7}function kt(M,X){var I=X&7,H=X>>>3;return(M[H]|(I<=4?0:M[H+1]<<8))>>>I&15}function ot(M,X){var I=X&7,H=X>>>3;return(M[H]|(I<=3?0:M[H+1]<<8))>>>I&31}function Oe(M,X){var I=X&7,H=X>>>3;return(M[H]|(I<=1?0:M[H+1]<<8))>>>I&127}function Wt(M,X,I){var H=X&7,W=X>>>3,Y=(1<<I)-1,xe=M[W]>>>H;return I<8-H||(xe|=M[W+1]<<8-H,I<16-H)||(xe|=M[W+2]<<16-H,I<24-H)||(xe|=M[W+3]<<24-H),xe&Y}function fr(M,X,I){var H=X&7,W=X>>>3;return H<=5?M[W]|=(I&7)<<H:(M[W]|=I<<H&255,M[W+1]=(I&7)>>8-H),X+3}function Kr(M,X,I){var H=X&7,W=X>>>3;return I=(I&1)<<H,M[W]|=I,X+1}function Hr(M,X,I){var H=X&7,W=X>>>3;return I<<=H,M[W]|=I&255,I>>>=8,M[W+1]=I,X+8}function Ca(M,X,I){var H=X&7,W=X>>>3;return I<<=H,M[W]|=I&255,I>>>=8,M[W+1]=I&255,M[W+2]=I>>>8,X+16}function Pe(M,X){var I=M.length,H=2*I>X?2*I:X+5,W=0;if(I>=X)return M;if(vt){var Y=pb(H);if(M.copy)M.copy(Y);else for(;W<M.length;++W)Y[W]=M[W];return Y}else if(Ne){var xe=new Uint8Array(H);if(xe.set)xe.set(M);else for(;W<I;++W)xe[W]=M[W];return xe}return M.length=H,M}function pt(M){for(var X=new Array(M),I=0;I<M;++I)X[I]=0;return X}function dr(M,X,I){var H=1,W=0,Y=0,xe=0,be=0,ue=M.length,me=Ne?new Uint16Array(32):pt(32);for(Y=0;Y<32;++Y)me[Y]=0;for(Y=ue;Y<I;++Y)M[Y]=0;ue=M.length;var ge=Ne?new Uint16Array(ue):pt(ue);for(Y=0;Y<ue;++Y)me[W=M[Y]]++,H<W&&(H=W),ge[Y]=0;for(me[0]=0,Y=1;Y<=H;++Y)me[Y+16]=be=be+me[Y-1]<<1;for(Y=0;Y<ue;++Y)be=M[Y],be!=0&&(ge[Y]=me[be+16]++);var De=0;for(Y=0;Y<ue;++Y)if(De=M[Y],De!=0)for(be=K(ge[Y],H)>>H-De,xe=(1<<H+4-De)-1;xe>=0;--xe)X[be|xe<<De]=De&15|Y<<4;return H}var yr=Ne?new Uint16Array(512):pt(512),lr=Ne?new Uint16Array(32):pt(32);if(!Ne){for(var Ft=0;Ft<512;++Ft)yr[Ft]=0;for(Ft=0;Ft<32;++Ft)lr[Ft]=0}(function(){for(var M=[],X=0;X<32;X++)M.push(5);dr(M,lr,32);var I=[];for(X=0;X<=143;X++)I.push(8);for(;X<=255;X++)I.push(9);for(;X<=279;X++)I.push(7);for(;X<=287;X++)I.push(8);dr(I,yr,288)})();var st=function(){for(var X=Ne?new Uint8Array(32768):[],I=0,H=0;I<_e.length-1;++I)for(;H<_e[I+1];++H)X[H]=I;for(;H<32768;++H)X[H]=29;var W=Ne?new Uint8Array(259):[];for(I=0,H=0;I<le.length-1;++I)for(;H<le[I+1];++H)W[H]=I;function Y(be,ue){for(var me=0;me<be.length;){var ge=Math.min(65535,be.length-me),De=me+ge==be.length;for(ue.write_shift(1,+De),ue.write_shift(2,ge),ue.write_shift(2,~ge&65535);ge-- >0;)ue[ue.l++]=be[me++]}return ue.l}function xe(be,ue){for(var me=0,ge=0,De=Ne?new Uint16Array(32768):[];ge<be.length;){var Le=Math.min(65535,be.length-ge);if(Le<10){for(me=fr(ue,me,+(ge+Le==be.length)),me&7&&(me+=8-(me&7)),ue.l=me/8|0,ue.write_shift(2,Le),ue.write_shift(2,~Le&65535);Le-- >0;)ue[ue.l++]=be[ge++];me=ue.l*8;continue}me=fr(ue,me,+(ge+Le==be.length)+2);for(var He=0;Le-- >0;){var Me=be[ge];He=(He<<5^Me)&32767;var ze=-1,it=0;if((ze=De[He])&&(ze|=ge&-32768,ze>ge&&(ze-=32768),ze<ge))for(;be[ze+it]==be[ge+it]&&it<250;)++it;if(it>2){Me=W[it],Me<=22?me=Hr(ue,me,Re[Me+1]>>1)-1:(Hr(ue,me,3),me+=5,Hr(ue,me,Re[Me-23]>>5),me+=3);var Ut=Me<8?0:Me-4>>2;Ut>0&&(Ca(ue,me,it-le[Me]),me+=Ut),Me=X[ge-ze],me=Hr(ue,me,Re[Me]>>3),me-=3;var zt=Me<4?0:Me-2>>1;zt>0&&(Ca(ue,me,ge-ze-_e[Me]),me+=zt);for(var Kt=0;Kt<it;++Kt)De[He]=ge&32767,He=(He<<5^be[ge])&32767,++ge;Le-=it-1}else Me<=143?Me=Me+48:me=Kr(ue,me,1),me=Hr(ue,me,Re[Me]),De[He]=ge&32767,++ge}me=Hr(ue,me,0)-1}return ue.l=(me+7)/8|0,ue.l}return function(ue,me){return ue.length<8?Y(ue,me):xe(ue,me)}}();function ct(M){var X=we(50+Math.floor(M.length*1.1)),I=st(M,X);return X.slice(0,I)}var Jt=Ne?new Uint16Array(32768):pt(32768),na=Ne?new Uint16Array(32768):pt(32768),Xt=Ne?new Uint16Array(128):pt(128),Aa=1,za=1;function Gs(M,X){var I=ot(M,X)+257;X+=5;var H=ot(M,X)+1;X+=5;var W=kt(M,X)+4;X+=4;for(var Y=0,xe=Ne?new Uint8Array(19):pt(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,me=Ne?new Uint8Array(8):pt(8),ge=Ne?new Uint8Array(8):pt(8),De=xe.length,Le=0;Le<W;++Le)xe[Q[Le]]=Y=lt(M,X),ue<Y&&(ue=Y),me[Y]++,X+=3;var He=0;for(me[0]=0,Le=1;Le<=ue;++Le)ge[Le]=He=He+me[Le-1]<<1;for(Le=0;Le<De;++Le)(He=xe[Le])!=0&&(be[Le]=ge[He]++);var Me=0;for(Le=0;Le<De;++Le)if(Me=xe[Le],Me!=0){He=Re[be[Le]]>>8-Me;for(var ze=(1<<7-Me)-1;ze>=0;--ze)Xt[He|ze<<Me]=Me&7|Le<<3}var it=[];for(ue=1;it.length<I+H;)switch(He=Xt[Oe(M,X)],X+=He&7,He>>>=3){case 16:for(Y=3+Ae(M,X),X+=2,He=it[it.length-1];Y-- >0;)it.push(He);break;case 17:for(Y=3+lt(M,X),X+=3;Y-- >0;)it.push(0);break;case 18:for(Y=11+Oe(M,X),X+=7;Y-- >0;)it.push(0);break;default:it.push(He),ue<He&&(ue=He);break}var Ut=it.slice(0,I),zt=it.slice(I);for(Le=I;Le<286;++Le)Ut[Le]=0;for(Le=H;Le<30;++Le)zt[Le]=0;return Aa=dr(Ut,Jt,286),za=dr(zt,na,30),X}function us(M,X){if(M[0]==3&&!(M[1]&3))return[Li(X),2];for(var I=0,H=0,W=pb(X||1<<18),Y=0,xe=W.length>>>0,be=0,ue=0;(H&1)==0;){if(H=lt(M,I),I+=3,H>>>1)H>>1==1?(be=9,ue=5):(I=Gs(M,I),be=Aa,ue=za);else{I&7&&(I+=8-(I&7));var me=M[I>>>3]|M[(I>>>3)+1]<<8;if(I+=32,me>0)for(!X&&xe<Y+me&&(W=Pe(W,Y+me),xe=W.length);me-- >0;)W[Y++]=M[I>>>3],I+=8;continue}for(;;){!X&&xe<Y+32767&&(W=Pe(W,Y+32767),xe=W.length);var ge=Wt(M,I,be),De=H>>>1==1?yr[ge]:Jt[ge];if(I+=De&15,De>>>=4,(De>>>8&255)===0)W[Y++]=De;else{if(De==256)break;De-=257;var Le=De<8?0:De-4>>2;Le>5&&(Le=0);var He=Y+le[De];Le>0&&(He+=Wt(M,I,Le),I+=Le),ge=Wt(M,I,ue),De=H>>>1==1?lr[ge]:na[ge],I+=De&15,De>>>=4;var Me=De<4?0:De-2>>1,ze=_e[De];for(Me>0&&(ze+=Wt(M,I,Me),I+=Me),!X&&xe<He&&(W=Pe(W,He+100),xe=W.length);Y<He;)W[Y]=W[Y-ze],++Y}}}return X?[W,I+7>>>3]:[W.slice(0,Y),I+7>>>3]}function Gl(M,X){var I=M.slice(M.l||0),H=us(I,X);return M.l+=H[1],H[0]}function Vs(M,X){if(M)typeof console<"u"&&console.error(X);else throw new Error(X)}function qs(M,X){var I=M;ta(I,0);var H=[],W=[],Y={FileIndex:H,FullPaths:W};T(Y,{root:X.root});for(var xe=I.length-4;(I[xe]!=80||I[xe+1]!=75||I[xe+2]!=5||I[xe+3]!=6)&&xe>=0;)--xe;I.l=xe+4,I.l+=4;var be=I.read_shift(2);I.l+=6;var ue=I.read_shift(4);for(I.l=ue,xe=0;xe<be;++xe){I.l+=20;var me=I.read_shift(4),ge=I.read_shift(4),De=I.read_shift(2),Le=I.read_shift(2),He=I.read_shift(2);I.l+=8;var Me=I.read_shift(4),ze=u(I.slice(I.l+De,I.l+De+Le));I.l+=De+Le+He;var it=I.l;I.l=Me+4,Ws(I,me,ge,Y,ze),I.l=it}return Y}function Ws(M,X,I,H,W){M.l+=2;var Y=M.read_shift(2),xe=M.read_shift(2),be=o(M);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ue=M.read_shift(4),me=M.read_shift(4),ge=M.read_shift(4),De=M.read_shift(2),Le=M.read_shift(2),He="",Me=0;Me<De;++Me)He+=String.fromCharCode(M[M.l++]);if(Le){var ze=u(M.slice(M.l,M.l+Le));(ze[21589]||{}).mt&&(be=ze[21589].mt),((W||{})[21589]||{}).mt&&(be=W[21589].mt)}M.l+=Le;var it=M.slice(M.l,M.l+me);switch(xe){case 8:it=G(M,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var Ut=!1;Y&8&&(ue=M.read_shift(4),ue==134695760&&(ue=M.read_shift(4),Ut=!0),me=M.read_shift(4),ge=M.read_shift(4)),me!=X&&Vs(Ut,"Bad compressed size: "+X+" != "+me),ge!=I&&Vs(Ut,"Bad uncompressed size: "+I+" != "+ge),Sr(H,He,it,{unsafe:!0,mt:be})}function re(M,X){var I=X||{},H=[],W=[],Y=we(1),xe=I.compression?8:0,be=0,ue=0,me=0,ge=0,De=0,Le=M.FullPaths[0],He=Le,Me=M.FileIndex[0],ze=[],it=0;for(ue=1;ue<M.FullPaths.length;++ue)if(He=M.FullPaths[ue].slice(Le.length),Me=M.FileIndex[ue],!(!Me.size||!Me.content||He=="Sh33tJ5")){var Ut=ge,zt=we(He.length);for(me=0;me<He.length;++me)zt.write_shift(1,He.charCodeAt(me)&127);zt=zt.slice(0,zt.l),ze[De]=f6.buf(Me.content,0);var Kt=Me.content;xe==8&&(Kt=V(Kt)),Y=we(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,be),Y.write_shift(2,xe),Me.mt?l(Y,Me.mt):Y.write_shift(4,0),Y.write_shift(-4,ze[De]),Y.write_shift(4,Kt.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,zt.length),Y.write_shift(2,0),ge+=Y.length,H.push(Y),ge+=zt.length,H.push(zt),ge+=Kt.length,H.push(Kt),Y=we(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,be),Y.write_shift(2,xe),Y.write_shift(4,0),Y.write_shift(-4,ze[De]),Y.write_shift(4,Kt.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,zt.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Ut),it+=Y.l,W.push(Y),it+=zt.length,W.push(zt),++De}return Y=we(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,De),Y.write_shift(2,De),Y.write_shift(4,it),Y.write_shift(4,ge),Y.write_shift(2,0),Xr([Xr(H),Xr(W),Y])}var Ue={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $e(M,X){if(M.ctype)return M.ctype;var I=M.name||"",H=I.match(/\.([^\.]+)$/);return H&&Ue[H[1]]||X&&(H=(I=X).match(/[\.\\]([^\.\\])+$/),H&&Ue[H[1]])?Ue[H[1]]:"application/octet-stream"}function Xe(M){for(var X=F0(M),I=[],H=0;H<X.length;H+=76)I.push(X.slice(H,H+76));return I.join(`\r
`)+`\r
`}function rt(M){var X=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],H=X.split(`\r
`),W=0;W<H.length;++W){var Y=H[W];if(Y.length==0){I.push("");continue}for(var xe=0;xe<Y.length;){var be=76,ue=Y.slice(xe,xe+be);ue.charAt(be-1)=="="?be--:ue.charAt(be-2)=="="?be-=2:ue.charAt(be-3)=="="&&(be-=3),ue=Y.slice(xe,xe+be),xe+=be,xe<Y.length&&(ue+="="),I.push(ue)}}return I.join(`\r
`)}function $t(M){for(var X=[],I=0;I<M.length;++I){for(var H=M[I];I<=M.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+M[++I];X.push(H)}for(var W=0;W<X.length;++W)X[W]=X[W].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ja(X.join(`\r
`))}function br(M,X,I){for(var H="",W="",Y="",xe,be=0;be<10;++be){var ue=X[be];if(!ue||ue.match(/^\s*$/))break;var me=ue.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":H=me[2].trim();break;case"content-type":Y=me[2].trim();break;case"content-transfer-encoding":W=me[2].trim();break}}switch(++be,W.toLowerCase()){case"base64":xe=Ja(tn(X.slice(be).join("")));break;case"quoted-printable":xe=$t(X.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ge=Sr(M,H.slice(I.length),xe,{unsafe:!0});Y&&(ge.ctype=Y)}function Xs(M,X){if(ne(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=X&&X.root||"",H=(vt&&Buffer.isBuffer(M)?M.toString("binary"):ne(M)).split(`\r
`),W=0,Y="";for(W=0;W<H.length;++W)if(Y=H[W],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),I||(I=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),Y.slice(0,I.length)!=I););var xe=(H[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var be="--"+(xe[1]||""),ue=[],me=[],ge={FileIndex:ue,FullPaths:me};T(ge);var De,Le=0;for(W=0;W<H.length;++W){var He=H[W];He!==be&&He!==be+"--"||(Le++&&br(ge,H.slice(De,W),I),De=W)}return ge}function Ha(M,X){var I=X||{},H=I.boundary||"SheetJS";H="------="+H;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],Y=M.FullPaths[0],xe=Y,be=M.FileIndex[0],ue=1;ue<M.FullPaths.length;++ue)if(xe=M.FullPaths[ue].slice(Y.length),be=M.FileIndex[ue],!(!be.size||!be.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var me=be.content,ge=vt&&Buffer.isBuffer(me)?me.toString("binary"):ne(me),De=0,Le=Math.min(1024,ge.length),He=0,Me=0;Me<=Le;++Me)(He=ge.charCodeAt(Me))>=32&&He<128&&++De;var ze=De>=Le*4/5;W.push(H),W.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+xe),W.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),W.push("Content-Type: "+$e(be,xe)),W.push(""),W.push(ze?rt(ge):Xe(ge))}return W.push(H+`--\r
`),W.join(`\r
`)}function wr(M){var X={};return T(X,M),X}function Sr(M,X,I,H){var W=H&&H.unsafe;W||T(M);var Y=!W&&We.find(M,X);if(!Y){var xe=M.FullPaths[0];X.slice(0,xe.length)==xe?xe=X:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+X).replace("//","/")),Y={name:n(X),type:2},M.FileIndex.push(Y),M.FullPaths.push(xe),W||We.utils.cfb_gc(M)}return Y.content=I,Y.size=I?I.length:0,H&&(H.CLSID&&(Y.clsid=H.CLSID),H.mt&&(Y.mt=H.mt),H.ct&&(Y.ct=H.ct)),Y}function Nn(M,X){T(M);var I=We.find(M,X);if(I){for(var H=0;H<M.FileIndex.length;++H)if(M.FileIndex[H]==I)return M.FileIndex.splice(H,1),M.FullPaths.splice(H,1),!0}return!1}function fc(M,X,I){T(M);var H=We.find(M,X);if(H){for(var W=0;W<M.FileIndex.length;++W)if(M.FileIndex[W]==H)return M.FileIndex[W].name=n(I),M.FullPaths[W]=I,!0}return!1}function rh(M){O(M,!0)}return t.find=q,t.read=D,t.parse=m,t.write=B,t.writeFile=Te,t.utils={cfb_new:wr,cfb_add:Sr,cfb_del:Nn,cfb_mov:fc,cfb_gc:rh,ReadShift:g0,CheckField:W4,prep_blob:ta,bconcat:Xr,use_zlib:L,_deflateRaw:ct,_inflateRaw:Gl,consts:ie},t}();function d6(e){return typeof e=="string"?Hd(e):Array.isArray(e)?P5(e):e}function cu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?is(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([d6(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=zi(t)),u.write(t),u.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+e)}function h6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function vr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function _b(e,t){for(var r=[],a=vr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Vd(e){for(var t=[],r=vr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function qd(e){for(var t=[],r=vr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function x6(e){for(var t=[],r=vr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var vd=new Date(1899,11,30,0,0,0);function zr(e,t){var r=e.getTime(),a=vd.getTime()+(e.getTimezoneOffset()-vd.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var k4=new Date,m6=vd.getTime()+(k4.getTimezoneOffset()-vd.getTimezoneOffset())*6e4,kb=k4.getTimezoneOffset();function Wd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+m6),t.getTimezoneOffset()!==kb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-kb)*6e4),t}function p6(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=n.length;++l)if(n[l]){switch(r=1,l>3&&(a=!0),n[l].slice(n[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[l].slice(n[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[l],10)}return t}var Tb=new Date("2017-02-19T19:06:09.000Z"),T4=isNaN(Tb.getFullYear())?new Date("2/19/17"):Tb,g6=T4.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(g6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(T4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Rl(e,t){if(vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return is(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return is(h4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return is(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return is(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function ar(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ar(e[r]));return t}function pr(e,t){for(var r="";r.length<t;)r+=e;return r}function Un(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var v6=["january","february","march","april","may","june","july","august","september","october","november","december"];function $o(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&v6.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var y6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),o=[l[0]],u=1;u<l.length;++u)o.push(n),o.push(l[u]);return o}}();function N4(e){return e?e.content&&e.type?Rl(e.content,!0):e.data?x0(e.data):e.asNodeBuffer&&vt?x0(e.asNodeBuffer().toString("binary")):e.asBinary?x0(e.asBinary()):e._data&&e._data.getContent?x0(Rl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function C4(e){if(!e)return null;if(e.data)return xb(e.data);if(e.asNodeBuffer&&vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?xb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function b6(e){return e&&e.name.slice(-4)===".bin"?C4(e):N4(e)}function gn(e,t){for(var r=e.FullPaths||vr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function eg(e,t){var r=gn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Or(e,t,r){if(!r)return b6(eg(e,t));if(!t)return null;try{return Or(e,t)}catch{return null}}function en(e,t,r){if(!r)return N4(eg(e,t));if(!t)return null;try{return en(e,t)}catch{return null}}function w6(e,t,r){return C4(eg(e,t))}function Nb(e){for(var t=e.FullPaths||vr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function xt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return vt?a=Us(r):a=I5(r),We.utils.cfb_add(e,t,a)}We.utils.cfb_add(e,t,r)}else e.file(t,r)}function tg(){return We.utils.cfb_new()}function A4(e,t){switch(t.type){case"base64":return We.read(e,{type:"base64"});case"binary":return We.read(e,{type:"binary"});case"buffer":case"array":return We.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function p0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ar=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,S6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Cb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,E6=/<[^>]*>/g,pa=Ar.match(Cb)?Cb:E6,_6=/<\w*:/,k6=/<(\/?)\w+:/;function nt(e,t,r){for(var a={},n=0,l=0;n!==e.length&&!((l=e.charCodeAt(n))===32||l===10||l===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(S6),u=0,h="",x=0,m="",g="",v=1;if(o)for(x=0;x!=o.length;++x){for(g=o[x],l=0;l!=g.length&&g.charCodeAt(l)!==61;++l);for(m=g.slice(0,l).trim();g.charCodeAt(l+1)==32;)++l;for(v=(n=g.charCodeAt(l+1))==34||n==39?1:0,h=g.slice(l+1+v,g.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=h,a[m.toLowerCase()]=h;else{var b=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(a[b]&&m.slice(u-3,u)=="ext")continue;a[b]=h,a[b.toLowerCase()]=h}}return a}function os(e){return e.replace(k6,"<$1")}var j4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rg=Vd(j4),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",l=n.indexOf("<![CDATA[");if(l==-1)return n.replace(e,function(u,h){return j4[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=n.indexOf("]]>");return r(n.slice(0,l))+n.slice(l+9,o)+r(n.slice(o+3))}}(),ag=/[&<>'"]/g,T6=/[\u0000-\u0008\u000b-\u001f]/g;function It(e){var t=e+"";return t.replace(ag,function(r){return rg[r]}).replace(T6,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ab(e){return It(e).replace(/ /g,"_x0020_")}var R4=/[\u0000-\u001f]/g;function ng(e){var t=e+"";return t.replace(ag,function(r){return rg[r]}).replace(/\n/g,"<br/>").replace(R4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function N6(e){var t=e+"";return t.replace(ag,function(r){return rg[r]}).replace(R4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jb=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function C6(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function tr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Em(e){for(var t="",r=0,a=0,n=0,l=0,o=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|l&63);continue}o=e.charCodeAt(r++),u=((a&7)<<18|(n&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Rb(e){var t=Li(2*e.length),r,a,n=1,l=0,o=0,u;for(a=0;a<e.length;a+=n)n=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),n=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function Db(e){return Us(e,"binary").toString("utf8")}var Of="foo bar baz",qt=vt&&(Db(Of)==Em(Of)&&Db||Rb(Of)==Em(Of)&&Rb)||Em,is=vt?function(e){return Us(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},M0=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),D4=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),A6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),j6=/<\/?(?:vt:)?variant>/g,R6=/<(?:vt:)([^>]*)>([\s\S]*)</;function Fb(e,t){var r=nt(e),a=e.match(A6(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(l){var o=l.replace(j6,"").match(R6);o&&n.push({v:qt(o[2]),t:o[1]})}),n}var F4=/(^\s|\s$|\n)/;function ra(e,t){return"<"+e+(t.match(F4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function L0(e){return vr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?L0(r):"")+(t!=null?(t.match(F4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function D6(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",It(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",It(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",xp(e));throw new Error("Unable to serialize "+e)}function sg(e){if(vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(zi(Qp(e)));throw new Error("Bad input format: expected Buffer or string")}var B0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ll=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function F6(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,l=5;l>=0;--l)n=n*256+e[t+l];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function O6(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,l=0,o=a?-t:t;isFinite(o)?o==0?n=l=0:(n=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?n=-1022:(l-=Math.pow(2,52),n+=1023)):(n=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(n&15)<<4|l&15,e[r+7]=n>>4|a}var Ob=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,l=e[0][a].length;n<l;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Mb=vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Us(t)})):Ob(e)}:Ob,Lb=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Rs(e,n)));return a.join("").replace(Ta,"")},ig=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ta,""):Lb(e,t,r)}:Lb,Bb=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},O4=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Bb(e,t,r)}:Bb,Pb=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Ao(e,n)));return a.join("")},uu=vt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Pb(t,r,a)}:Pb,M4=function(e,t){var r=Za(e,t);return r>0?uu(e,t+4,t+4+r-1):""},L4=M4,B4=function(e,t){var r=Za(e,t);return r>0?uu(e,t+4,t+4+r-1):""},P4=B4,I4=function(e,t){var r=2*Za(e,t);return r>0?uu(e,t+4,t+4+r-1):""},U4=I4,z4=function(t,r){var a=Za(t,r);return a>0?ig(t,r+4,r+4+a):""},H4=z4,G4=function(e,t){var r=Za(e,t);return r>0?uu(e,t+4,t+4+r):""},V4=G4,q4=function(e,t){return F6(e,t)},yd=q4,lg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};vt&&(L4=function(t,r){if(!Buffer.isBuffer(t))return M4(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},P4=function(t,r){if(!Buffer.isBuffer(t))return B4(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},U4=function(t,r){if(!Buffer.isBuffer(t))return I4(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},H4=function(t,r){if(!Buffer.isBuffer(t))return z4(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},V4=function(t,r){if(!Buffer.isBuffer(t))return G4(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},yd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):q4(t,r)},lg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ao=function(e,t){return e[t]},Rs=function(e,t){return e[t+1]*256+e[t]},M6=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Za=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},L6=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function g0(e,t){var r="",a,n,l=[],o,u,h,x;switch(t){case"dbcs":if(x=this.l,vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(Rs(this,x)),x+=2;e*=2;break;case"utf8":r=uu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ig(this,this.l,this.l+e);break;case"wstr":return g0.call(this,e,"dbcs");case"lpstr-ansi":r=L4(this,this.l),e=4+Za(this,this.l);break;case"lpstr-cp":r=P4(this,this.l),e=4+Za(this,this.l);break;case"lpwstr":r=U4(this,this.l),e=4+2*Za(this,this.l);break;case"lpp4":e=4+Za(this,this.l),r=H4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Za(this,this.l),r=V4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ao(this,this.l+e++))!==0;)l.push(Ff(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=Rs(this,this.l+e))!==0;)l.push(Ff(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",x=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Ao(this,x),this.l=x+1,u=g0.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Ff(Rs(this,x))),x+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",x=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Ao(this,x),this.l=x+1,u=g0.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Ff(Ao(this,x))),x+=1}r=l.join("");break;default:switch(e){case 1:return a=Ao(this,this.l),this.l++,a;case 2:return a=(t==="i"?M6:Rs)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?cl:L6)(this,this.l),this.l+=4,a):(n=Za(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=yd(this,this.l):n=yd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=O4(this,this.l,e);break}}return this.l+=e,r}var B6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},P6=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},I6=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function U6(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)I6(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,B6(this,t,this.l);break;case 8:if(a=8,r==="f"){O6(this,t,this.l);break}case 16:break;case-4:a=4,P6(this,t,this.l);break}return this.l+=a,this}function W4(e,t){var r=O4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ta(e,t){e.l=t,e.read_shift=g0,e.chk=W4,e.write_shift=U6}function ma(e,t){e.l+=t}function we(e){var t=Li(e);return ta(t,0),t}function zs(e,t,r){if(e){var a,n,l;ta(e,e.l||0);for(var o=e.length,u=0,h=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var x=G0[u]||G0[65535];for(a=e.read_shift(1),l=a&127,n=1;n<4&&a&128;++n)l+=((a=e.read_shift(1))&127)<<7*n;h=e.l+l;var m=x.f&&x.f(e,l,r);if(e.l=h,t(m,x,u))return}}}function Ia(){var e=[],t=vt?256:2048,r=function(x){var m=we(x);return ta(m,0),m},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(x){return a&&x<a.length-a.l?a:(n(),a=r(Math.max(x+1,t)))},o=function(){return n(),Xr(e)},u=function(x){n(),a=x,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:u,end:o,_bufs:e}}function je(e,t,r,a){var n=+t,l;if(!isNaN(n)){a||(a=G0[n].p||(r||[]).length||0),l=1+(n>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var u=0;u!=4;++u)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&lg(r)&&e.push(r)}}function v0(e,t,r){var a=ar(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Ib(e,t,r){var a=ar(e);return a.s=v0(a.s,t.s,r),a.e=v0(a.e,t.s,r),a}function y0(e,t){if(e.cRel&&e.c<0)for(e=ar(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ar(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=tt(e);return!e.cRel&&e.cRel!=null&&(r=G6(r)),!e.rRel&&e.rRel!=null&&(r=z6(r)),r}function _m(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+cr(e.s.c)+":"+(e.e.cRel?"":"$")+cr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nr(e.s.r)+":"+(e.e.rRel?"":"$")+Nr(e.e.r):y0(e.s,t.biff)+":"+y0(e.e,t.biff)}function og(e){return parseInt(H6(e),10)-1}function Nr(e){return""+(e+1)}function z6(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H6(e){return e.replace(/\$(\d+)$/,"$1")}function cg(e){for(var t=V6(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function cr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function G6(e){return e.replace(/^([A-Z])/,"$$$1")}function V6(e){return e.replace(/^\$([A-Z])/,"$1")}function q6(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ur(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function tt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ua(e){var t=e.indexOf(":");return t==-1?{s:ur(e),e:ur(e)}:{s:ur(e.slice(0,t)),e:ur(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=tt(e)),typeof t!="string"&&(t=tt(t)),e==t?e:e+":"+t)}function Ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,l=e.length;for(r=0;a<l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===l||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function Ub(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=_n(e.z,r?zr(t):t)}catch{}try{return e.w=_n((e.XF||{}).numFmtId||(r?14:0),r?zr(t):t)}catch{return""+t}}function Ps(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Hs[e.v]||e.v:t==null?Ub(e,e.v):Ub(e,t))}function Hi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function X4(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,l=e||(n?[]:{}),o=0,u=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?ur(a.origin):a.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Ct(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[g].length;++v)if(!(typeof t[g][v]>"u")){var b={v:t[g][v]},y=o+g,w=u+v;if(x.s.r>y&&(x.s.r=y),x.s.c>w&&(x.s.c=w),x.e.r<y&&(x.e.r=y),x.e.c<w&&(x.e.c=w),t[g][v]&&typeof t[g][v]=="object"&&!Array.isArray(t[g][v])&&!(t[g][v]instanceof Date))b=t[g][v];else if(Array.isArray(b.v)&&(b.f=t[g][v][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(a.nullError)b.t="e",b.v=0;else if(a.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=a.dateNF||et[14],a.cellDates?(b.t="d",b.w=_n(b.z,zr(b.v))):(b.t="n",b.v=zr(b.v),b.w=_n(b.z,b.v))):b.t="s";if(n)l[y]||(l[y]=[]),l[y][w]&&l[y][w].z&&(b.z=l[y][w].z),l[y][w]=b;else{var E=tt({c:w,r:y});l[E]&&l[E].z&&(b.z=l[E].z),l[E]=b}}}return x.s.c<1e7&&(l["!ref"]=dt(x)),l}function oc(e,t){return X4(null,e,t)}function W6(e){return e.read_shift(4,"i")}function zn(e,t){return t||(t=we(4)),t.write_shift(4,e),t}function xa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Yr(e,t){var r=!1;return t==null&&(r=!0,t=we(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function X6(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Y6(e,t){return t||(t=we(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ug(e,t){var r=e.l,a=e.read_shift(1),n=xa(e),l=[],o={t:n,h:n};if((a&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(X6(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function $6(e,t){var r=!1;return t==null&&(r=!0,t=we(15+4*e.t.length)),t.write_shift(1,0),Yr(e.t,t),r?t.slice(0,t.l):t}var K6=ug;function Q6(e,t){var r=!1;return t==null&&(r=!0,t=we(23+4*e.t.length)),t.write_shift(1,1),Yr(e.t,t),t.write_shift(4,1),Y6({},t),r?t.slice(0,t.l):t}function Tn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Bl(e,t){return t==null&&(t=we(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Pl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Il(e,t){return t==null&&(t=we(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Z6=xa,Y4=Yr;function fg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function bd(e,t){var r=!1;return t==null&&(r=!0,t=we(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var J6=xa,mp=fg,dg=bd;function hg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?yd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):cl(t,0)>>2;return r?n/100:n}function $4(e,t){t==null&&(t=we(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function K4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function ej(e,t){return t||(t=we(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ul=K4,cc=ej;function ha(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Dl(e,t){return(t||we(8)).write_shift(8,e,"f")}function tj(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var x=El[n];x&&(t.rgb=I0(x));break;case 2:t.rgb=I0([o,u,h]);break;case 3:t.theme=n;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function wd(e,t){if(t||(t=we(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function rj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function aj(e,t){t||(t=we(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Q4(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function nj(e){return Q4(e,1)}function sj(e){return Q4(e,2)}var xg=2,La=3,Mf=11,zb=12,Sd=19,Lf=64,ij=65,lj=71,oj=4108,cj=4126,Wr=80,Z4=81,uj=[Wr,Z4],pp={1:{n:"CodePage",t:xg},2:{n:"Category",t:Wr},3:{n:"PresentationFormat",t:Wr},4:{n:"ByteCount",t:La},5:{n:"LineCount",t:La},6:{n:"ParagraphCount",t:La},7:{n:"SlideCount",t:La},8:{n:"NoteCount",t:La},9:{n:"HiddenCount",t:La},10:{n:"MultimediaClipCount",t:La},11:{n:"ScaleCrop",t:Mf},12:{n:"HeadingPairs",t:oj},13:{n:"TitlesOfParts",t:cj},14:{n:"Manager",t:Wr},15:{n:"Company",t:Wr},16:{n:"LinksUpToDate",t:Mf},17:{n:"CharacterCount",t:La},19:{n:"SharedDoc",t:Mf},22:{n:"HyperlinksChanged",t:Mf},23:{n:"AppVersion",t:La,p:"version"},24:{n:"DigSig",t:ij},26:{n:"ContentType",t:Wr},27:{n:"ContentStatus",t:Wr},28:{n:"Language",t:Wr},29:{n:"Version",t:Wr},255:{},2147483648:{n:"Locale",t:Sd},2147483651:{n:"Behavior",t:Sd},1919054434:{}},gp={1:{n:"CodePage",t:xg},2:{n:"Title",t:Wr},3:{n:"Subject",t:Wr},4:{n:"Author",t:Wr},5:{n:"Keywords",t:Wr},6:{n:"Comments",t:Wr},7:{n:"Template",t:Wr},8:{n:"LastAuthor",t:Wr},9:{n:"RevNumber",t:Wr},10:{n:"EditTime",t:Lf},11:{n:"LastPrinted",t:Lf},12:{n:"CreatedDate",t:Lf},13:{n:"ModifiedDate",t:Lf},14:{n:"PageCount",t:La},15:{n:"WordCount",t:La},16:{n:"CharCount",t:La},17:{n:"Thumbnail",t:lj},18:{n:"Application",t:Wr},19:{n:"DocSecurity",t:La},255:{},2147483648:{n:"Locale",t:Sd},2147483651:{n:"Behavior",t:Sd},1919054434:{}},Hb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function dj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var hj=dj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),El=ar(hj),Hs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},J4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},vp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Bf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function mg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xj(e){var t=mg();if(!e||!e.match)return t;var r={};if((e.match(pa)||[]).forEach(function(a){var n=nt(a);switch(n[0].replace(_6,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[vp[n.ContentType]]!==void 0&&t[vp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Ur.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function eE(e,t){var r=x6(vp),a=[],n;a[a.length]=Ar,a[a.length]=Be("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Be("Default",null,{Extension:h[0],ContentType:h[1]})}));var l=function(h){e[h]&&e[h].length>0&&(n=e[h][0],a[a.length]=Be("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Bf[h][t.bookType]||Bf[h].xlsx}))},o=function(h){(e[h]||[]).forEach(function(x){a[a.length]=Be("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:Bf[h][t.bookType]||Bf[h].xlsx})})},u=function(h){(e[h]||[]).forEach(function(x){a[a.length]=Be("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:r[h][0]})})};return l("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function P0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function b0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(pa)||[]).forEach(function(n){var l=nt(n);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:p0(l.Target,t);r[u]=o,a[l.Id]=o}}),r["!id"]=a,r}function Fo(e){var t=[Ar,Be("Relationships",null,{xmlns:Ur.RELS})];return vr(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Pt(e,t,r,a,n,l){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var mj="application/vnd.oasis.opendocument.spreadsheet";function pj(e,t){for(var r=sg(e),a,n;a=B0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=nt(a[0],!1),n.path=="/"&&n.type!==mj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function gj(e){var t=[Ar];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Gb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function yj(e){var t=[Ar];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Gb(e[r][0],e[r][1])),t.push(vj("",e[r][0]));return t.push(Gb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function tE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xd.version+"</meta:generator></office:meta></office:document-meta>"}var Sn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bj=function(){for(var e=new Array(Sn.length),t=0;t<Sn.length;++t){var r=Sn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function rE(e){var t={};e=qt(e);for(var r=0;r<Sn.length;++r){var a=Sn[r],n=e.match(bj[r]);n!=null&&n.length>0&&(t[a[1]]=Nt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=rr(t[a[1]]))}return t}function km(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=It(t),a[a.length]=r?Be(e,t,r):ra(e,t))}function aE(e,t){var r=t||{},a=[Ar,Be("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&km("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:xp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&km("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:xp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var l=0;l!=Sn.length;++l){var o=Sn[l],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&km(o[0],u,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var _l=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],nE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sE(e,t,r,a){var n=[];if(typeof e=="string")n=Fb(e,a);else for(var l=0;l<e.length;++l)n=n.concat(e[l].map(function(m){return{v:m}}));var o=typeof t=="string"?Fb(t,a).map(function(m){return m.v}):t,u=0,h=0;if(o.length>0)for(var x=0;x!==n.length;x+=2){switch(h=+n[x+1].v,n[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function wj(e,t,r){var a={};return t||(t={}),e=qt(e),_l.forEach(function(n){var l=(e.match(M0(n[0]))||[])[1];switch(n[2]){case"string":l&&(t[n[1]]=Nt(l));break;case"bool":t[n[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&sE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function iE(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=Ar,t[t.length]=Be("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),_l.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=It(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+It(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sj=/<[^>]+>[^<]*/g;function Ej(e,t){var r={},a="",n=e.match(Sj);if(n)for(var l=0;l!=n.length;++l){var o=n[l],u=nt(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Nt(u.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),x=h[0].slice(4),m=h[1];switch(x){case"lpstr":case"bstr":case"lpwstr":r[a]=Nt(m);break;case"bool":r[a]=tr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=rr(m);break;case"cy":case"error":r[a]=Nt(m);break;default:if(x.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function lE(e){var t=[Ar,Be("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return t.join("");var r=1;return vr(e).forEach(function(n){++r,t[t.length]=Be("property",D6(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:It(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tm;function _j(e,t,r){Tm||(Tm=Vd(yp)),t=Tm[t]||t,e[t]=r}function kj(e,t){var r=[];return vr(yp).map(function(a){for(var n=0;n<Sn.length;++n)if(Sn[n][1]==a)return Sn[n];for(n=0;n<_l.length;++n)if(_l[n][1]==a)return _l[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ra(yp[a[1]]||a[1],n))}}),Be("DocumentProperties",r.join(""),{xmlns:Qa.o})}function Tj(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&vr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Sn.length;++o)if(l==Sn[o][1])return;for(o=0;o<_l.length;++o)if(l==_l[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var u=e[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),n.push(Be(Ab(l),u,{"dt:dt":h}))}}),t&&vr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Be(Ab(l),o,{"dt:dt":u}))}}),"<"+a+' xmlns="'+Qa.o+'">'+n.join("")+"</"+a+">"}function pg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Nj(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),n+=l);var o=we(8);return o.write_shift(4,a),o.write_shift(4,n),o}function oE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function cE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function uE(e,t,r){return t===31?cE(e):oE(e,t,r)}function bp(e,t,r){return uE(e,t,r===!1?0:4)}function Cj(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return uE(e,t,0)}function Aj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ta,""),e.l-n&2&&(e.l+=2)}return r}function jj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ta,"");return r}function Rj(e){var t=e.l,r=Ed(e,Z4);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Ed(e,La);return[r,a]}function Dj(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Rj(e));return r}function Vb(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var l=e.read_shift(4),o=e.read_shift(4);a[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Ta,"").replace(m0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function fE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Fj(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ed(e,t,r){var a=e.read_shift(2),n,l=r||{};if(e.l+=2,t!==zb&&a!==t&&uj.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===zb?a:t){case 2:return n=e.read_shift(2,"i"),l.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return oE(e,a,4).replace(Ta,"");case 31:return cE(e);case 64:return pg(e);case 65:return fE(e);case 71:return Fj(e);case 80:return bp(e,a,!l.raw).replace(Ta,"");case 81:return Cj(e,a).replace(Ta,"");case 4108:return Dj(e);case 4126:case 4127:return a==4127?Aj(e):jj(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function qb(e,t){var r=we(4),a=we(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=we(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Nj(t);break;case 31:case 80:for(a=we(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xr([r,a])}function Wb(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0,u=0,h=-1,x={};for(o=0;o!=n;++o){var m=e.read_shift(4),g=e.read_shift(4);l[o]=[m,g+r]}l.sort(function(N,_){return N[1]-_[1]});var v={};for(o=0;o!=n;++o){if(e.l!==l[o][1]){var b=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,b=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],b=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(b=!1,e.l=l[o][1]),b)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var y=t[l[o][0]];if(v[y.n]=Ed(e,y.t,{raw:!0}),y.p==="version"&&(v[y.n]=String(v[y.n]>>16)+"."+("0000"+String(v[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(v[y.n]){case 0:v[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Pn(u=v[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[y.n])}}else if(l[o][0]===1){if(u=v.CodePage=Ed(e,xg),Pn(u),h!==-1){var w=e.l;e.l=l[h][1],x=Vb(e,u),e.l=w}}else if(l[o][0]===0){if(u===0){h=o,e.l=l[o+1][1];continue}x=Vb(e,u)}else{var E=x[l[o][0]],k;switch(e[e.l]){case 65:e.l+=4,k=fE(e);break;case 30:e.l+=4,k=bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Tr(e,4);break;case 64:e.l+=4,k=rr(pg(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[E]=k}}return e.l=r+a,v}var dE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Oj(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Xb(e,t,r){var a=we(8),n=[],l=[],o=8,u=0,h=we(8),x=we(8);if(h.write_shift(4,2),h.write_shift(4,1200),x.write_shift(4,1),l.push(h),n.push(x),o+=8+h.length,!t){x=we(8),x.write_shift(4,0),n.unshift(x);var m=[we(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var g=e[u][0];for(h=we(8+2*(g.length+1)+(g.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,g.length+1),h.write_shift(0,g,"dbcs");h.l!=h.length;)h.write_shift(1,0);m.push(h)}h=Xr(m),l.unshift(h),o+=8+h.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(dE.indexOf(e[u][0])>-1||nE.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],b=0;if(t){b=+t[e[u][0]];var y=r[b];if(y.p=="version"&&typeof v=="string"){var w=v.split(".");v=(+w[0]<<16)+(+w[1]||0)}h=qb(y.t,v)}else{var E=Oj(v);E==-1&&(E=31,v=String(v)),h=qb(E,v)}l.push(h),x=we(8),x.write_shift(4,t?b:2+u),n.push(x),o+=8+h.length}var k=8*(l.length+1);for(u=0;u<l.length;++u)n[u].write_shift(4,k),k+=l[u].length;return a.write_shift(4,o),a.write_shift(4,l.length),Xr([a].concat(n).concat(l))}function Yb(e,t,r){var a=e.content;if(!a)return{};ta(a,0);var n,l,o,u,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var x=a.read_shift(4),m=a.read_shift(16);if(m!==We.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(l=a.read_shift(16),u=a.read_shift(4),n===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);n===2&&(o=a.read_shift(16),h=a.read_shift(4));var g=Wb(a,t),v={SystemIdentifier:x};for(var b in g)v[b]=g[b];if(v.FMTID=l,n===1)return v;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var y;try{y=Wb(a,null)}catch{}for(b in y)v[b]=y[b];return v.FMTID=[l,o],v}function $b(e,t,r,a,n,l){var o=we(n?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var h=Xb(e,r,a);if(u.push(h),n){var x=Xb(n,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+h.length),u.push(x)}return Xr(u)}function gi(e,t){return e.read_shift(t),null}function Mj(e,t){t||(t=we(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Lj(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Tr(e,t){return e.read_shift(t)===1}function Ea(e,t){return t||(t=we(2)),t.write_shift(2,+!!e),t}function Mr(e){return e.read_shift(2,"u")}function yn(e,t){return t||(t=we(2)),t.write_shift(2,e),t}function hE(e,t){return Lj(e,t,Mr)}function Bj(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function xE(e,t,r){return r||(r=we(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function fu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function Pj(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,l=1+(r&1),o=0,u,h={};n&&(o=e.read_shift(2)),a&&(u=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,x);return n&&(e.l+=4*o),a&&(e.l+=u),h.t=m,n||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Ij(e){var t=e.t||"",r=we(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=we(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Xr(n)}function Fl(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function du(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Fl(e,a,r)}function zl(e,t,r){if(r.biff>5)return du(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mE(e,t,r){return r||(r=we(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Uj(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function zj(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ta,"");return a&&(e.l+=24),n}function Hj(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ta,"");return r+o}function Gj(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zj(e);case"0303000000000000c000000000000046":return Hj(e);default:throw new Error("Unsupported Moniker "+r)}}function Pf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ta,""):"";return r}function Kb(e,t){t||(t=we(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Vj(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var l,o,u,h,x="",m,g;n&16&&(l=Pf(e,r-e.l)),n&128&&(o=Pf(e,r-e.l)),(n&257)===257&&(u=Pf(e,r-e.l)),(n&257)===1&&(h=Gj(e,r-e.l)),n&8&&(x=Pf(e,r-e.l)),n&32&&(m=e.read_shift(16)),n&64&&(g=pg(e)),e.l=r;var v=o||u||h||"";v&&x&&(v+="#"+x),v||(v="#"+x),n&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var b={Target:v};return m&&(b.guid=m),g&&(b.time=g),l&&(b.Tooltip=l),b}function qj(e){var t=we(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),l=n>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)a=a.slice(1),Kb(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var u=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),l&8&&Kb(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var h=0;a.slice(h*3,h*3+3)=="../"||a.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,a.length-3*h+1),r=0;r<a.length-3*h;++r)t.write_shift(1,a.charCodeAt(r+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function pE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function gE(e,t){var r=pE(e);return r[3]=0,r}function cs(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Ol(e,t,r,a){return a||(a=we(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function Wj(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Xj(e,t,r){return t===0?"":zl(e,t,r)}function Yj(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,l,o]}function vE(e){var t=e.read_shift(2),r=hg(e);return[t,r]}function $j(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=fu(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,n}function Xd(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function yE(e,t){return t||(t=we(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function bE(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var Kj=bE;function wE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Qj(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Zj(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function la(e){e.l+=2,e.l+=e.read_shift(2)}var Jj={0:la,4:la,5:la,6:la,7:Zj,8:la,9:la,10:la,11:la,12:la,13:Qj,14:la,15:la,16:la,17:la,18:la,19:la,20:la,21:wE};function e8(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(Jj[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function If(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function gg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=we(n);return l.write_shift(2,a),l.write_shift(2,t),n>4&&l.write_shift(2,29282),n>6&&l.write_shift(2,1997),n>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function t8(e,t){return t===0||e.read_shift(2),1200}function r8(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=zl(e,0,r);return e.read_shift(t+a-e.l),n}function a8(e,t){var r=!t||t.biff==8,a=we(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function n8(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function s8(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=fu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:l,name:o}}function i8(e,t){var r=!t||t.biff>=8?2:1,a=we(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function l8(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0;o!=n&&e.l<r;++o)l.push(Pj(e));return l.Count=a,l.Unique=n,l}function o8(e,t){var r=we(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=Ij(e[n]);var l=Xr([r].concat(a));return l.parts=[r.length].concat(a.map(function(o){return o.length})),l}function c8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function u8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function f8(e){var t=Wj(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function d8(e){return e.read_shift(2),e.read_shift(4)}function Qb(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,n]}function h8(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),x=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:x}}function x8(){var e=we(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function m8(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function p8(e){var t=we(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function g8(){}function v8(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=fu(e,0,r),a}function y8(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,l=we(n);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function b8(e){var t=cs(e);return t.isst=e.read_shift(4),t}function w8(e,t,r,a){var n=we(10);return Ol(e,t,a,n),n.write_shift(4,r),n}function S8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=cs(e);r.biff==2&&e.l++;var l=du(e,a-e.l,r);return n.val=l,n}function E8(e,t,r,a,n){var l=!n||n.biff==8,o=we(8+ +l+(1+l)*r.length);return Ol(e,t,a,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function _8(e,t,r){var a=e.read_shift(2),n=zl(e,0,r);return[a,n]}function k8(e,t,r,a){var n=r&&r.biff==5;a||(a=we(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var T8=zl;function Zb(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:l,c:u},e:{r:o,c:h}}}function N8(e,t){var r=t.biff==8||!t.biff?4:2,a=we(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function C8(e){var t=e.read_shift(2),r=e.read_shift(2),a=vE(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function A8(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push(vE(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:l}}function j8(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:l}}function R8(e,t,r,a){var n={},l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return n.patternType=fj[u>>26],a.cellStyles&&(n.alc=l&7,n.fWrap=l>>3&1,n.alcV=l>>4&7,n.fJustLast=l>>7&1,n.trot=l>>8&255,n.cIndent=l>>16&15,n.fShrinkToFit=l>>20&1,n.iReadOrder=l>>22&2,n.fAtrNum=l>>26&1,n.fAtrFnt=l>>27&1,n.fAtrAlc=l>>28&1,n.fAtrBdr=l>>29&1,n.fAtrPat=l>>30&1,n.fAtrProt=l>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=u&127,n.icvBottom=u>>7&127,n.icvDiag=u>>14&127,n.dgDiag=u>>21&15,n.icvFore=h&127,n.icvBack=h>>7&127,n.fsxButton=h>>14&1),n}function D8(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=R8(e,t,a.fStyle,r),a}function Jb(e,t,r,a){var n=r&&r.biff==5;a||(a=we(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&n&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function F8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function O8(e){var t=we(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ew(e,t,r){var a=cs(e);(r.biff==2||t==9)&&++e.l;var n=Bj(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function M8(e,t,r,a,n,l){var o=we(8);return Ol(e,t,a,o),xE(r,l,o),o}function L8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=cs(e),n=ha(e);return a.val=n,a}function B8(e,t,r,a){var n=we(14);return Ol(e,t,a,n),Dl(r,n),n}var tw=Xj;function P8(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,n];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Fl(e,l),u=[];a>e.l;)u.push(du(e));return[l,n,o,u]}function rw(e,t,r){var a=e.read_shift(2),n,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=$j(e,t-2,r)),l.body=n||e.read_shift(t-2),typeof n=="string"&&(l.Name=n),l}var I8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function aw(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var x=Fl(e,o,r);n&32&&(x=I8[x.charCodeAt(0)]);var m=a-e.l;r&&r.biff==2&&--m;var g=a==e.l||u===0||!(m>0)?[]:e7(e,m,r,u);return{chKey:l,Name:x,itab:h,rgce:g}}function SE(e,t,r){if(r.biff<8)return U8(e,t,r);for(var a=[],n=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(Yj(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function U8(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=fu(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function z8(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),l=Fl(e,a,r),o=Fl(e,n,r);return[l,o]}function H8(e,t,r){var a=bE(e);e.l++;var n=e.read_shift(1);return t-=8,[t7(e,t,r),n,a]}function nw(e,t,r){var a=Kj(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,ZO(e,t,r)]}function G8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function V8(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=zl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},u,o,l]}}function q8(e,t,r){return V8(e,t,r)}function W8(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Xd(e));return r}function X8(e){var t=we(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)yE(e[r],t);return t}function Y8(e,t,r){if(r&&r.biff<8)return K8(e,t,r);var a=wE(e),n=e8(e,t-22,a[1]);return{cmo:a,ft:n}}var $8={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function K8(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push(($8[a]||ma)(e,t,r)),{cmo:[n,a,l],ft:o}}function Q8(e,t,r){var a=e.l,n="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=Uj(e,6,r);var u=e.read_shift(2);e.read_shift(2),Mr(e,2);var h=e.read_shift(2);e.l+=h;for(var x=1;x<e.lens.length-1;++x){if(e.l-a!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],g=Fl(e,e.lens[x+1]-e.lens[x]-1);if(n+=g,n.length>=(m?u:2*u))break}if(n.length!==u&&n.length!==u*2)throw new Error("cchText: "+u+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function Z8(e,t){var r=Xd(e);e.l+=16;var a=Vj(e,t-24);return[r,a]}function J8(e){var t=we(24),r=ur(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Xr([t,qj(e[1])])}function eR(e,t){e.read_shift(2);var r=Xd(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ta,""),[r,a]}function tR(e){var t=e[1].Tooltip,r=we(10+2*(t.length+1));r.write_shift(2,2048);var a=ur(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function rR(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Hb[r]||r,r=e.read_shift(2),t[1]=Hb[r]||r,t}function aR(e){return e||(e=we(4)),e.write_shift(2,1),e.write_shift(2,1),e}function nR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gE(e));return r}function sR(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(gE(e));return r}function iR(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function EE(e,t,r){if(!r.cellStyles)return ma(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),u=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var x={s:n,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(x.level=h>>8&7),x}function lR(e,t){var r=we(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function oR(e,t){var r={};return t<32||(e.l+=16,r.header=ha(e),r.footer=ha(e),e.l+=2),r}function cR(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function uR(e){for(var t=we(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var fR=cs,dR=hE,hR=du;function xR(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function mR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=cs(e);++e.l;var n=zl(e,t-7,r);return a.t="str",a.val=n,a}function pR(e){var t=cs(e);++e.l;var r=ha(e);return t.t="n",t.val=r,t}function gR(e,t,r){var a=we(15);return pu(a,e,t),a.write_shift(8,r,"f"),a}function vR(e){var t=cs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function yR(e,t,r){var a=we(9);return pu(a,e,t),a.write_shift(2,r),a}function bR(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function wR(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function SR(e,t,r){var a=e.l+t,n=cs(e),l=e.read_shift(2),o=Fl(e,l,r);return e.l=a,n.t="str",n.val=o,n}var ER=[2,3,48,49,131,139,140,245],wp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Vd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var x=[],m=Li(1);switch(h.type){case"base64":m=Ja(tn(u));break;case"binary":m=Ja(u);break;case"buffer":case"array":m=u;break}ta(m,0);var g=m.read_shift(1),v=!!(g&136),b=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:b=!0,v=!0;break;case 49:b=!0,v=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var w=0,E=521;g==2&&(w=m.read_shift(2)),m.l+=3,g!=2&&(w=m.read_shift(4)),w>1048576&&(w=1e6),g!=2&&(E=m.read_shift(2));var k=m.read_shift(2),N=h.codepage||1252;g!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(N=e[m[m.l]]),m.l+=1,m.l+=2),y&&(m.l+=36);for(var _=[],R={},A=Math.min(m.length,g==2?521:E-10-(b?264:0)),D=y?32:11;m.l<A&&m[m.l]!=13;)switch(R={},R.name=D0.utils.decode(N,m.slice(m.l,m.l+D)).replace(/[\u0000\r\n].*$/g,""),m.l+=D,R.type=String.fromCharCode(m.read_shift(1)),g!=2&&!y&&(R.offset=m.read_shift(4)),R.len=m.read_shift(1),g==2&&(R.offset=m.read_shift(2)),R.dec=m.read_shift(1),R.name.length&&_.push(R),g!=2&&(m.l+=y?13:14),R.type){case"B":(!b||R.len!=8)&&h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var T=0,F=0;for(x[0]=[],F=0;F!=_.length;++F)x[0][F]=_[F].name;for(;w-- >0;){if(m[m.l]===42){m.l+=k;continue}for(++m.l,x[++T]=[],F=0,F=0;F!=_.length;++F){var O=m.slice(m.l,m.l+_[F].len);m.l+=_[F].len,ta(O,0);var U=D0.utils.decode(N,O);switch(_[F].type){case"C":U.trim().length&&(x[T][F]=U.replace(/\s+$/,""));break;case"D":U.length===8?x[T][F]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):x[T][F]=U;break;case"F":x[T][F]=parseFloat(U.trim());break;case"+":case"I":x[T][F]=y?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":x[T][F]=!0;break;case"N":case"F":x[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));x[T][F]="##MEMO##"+(y?parseInt(U.trim(),10):O.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(x[T][F]=+U||0);break;case"@":x[T][F]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":x[T][F]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":x[T][F]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[T][F]=-O.read_shift(-8,"f");break;case"B":if(b&&_[F].len==8){x[T][F]=O.read_shift(8,"f");break}case"G":case"P":O.l+=_[F].len;break;case"0":if(_[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[F].type)}}}if(g!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),h.DBF=_,x}function a(u,h){var x=h||{};x.dateNF||(x.dateNF="yyyymmdd");var m=oc(r(u,x),x);return m["!cols"]=x.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete x.DBF,m}function n(u,h){try{return Hi(a(u,h),h)}catch(x){if(h&&h.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var x=h||{};if(+x.codepage>=0&&Pn(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=Ia(),g=Td(u,{header:1,raw:!0,cellDates:!0}),v=g[0],b=g.slice(1),y=u["!cols"]||[],w=0,E=0,k=0,N=1;for(w=0;w<v.length;++w){if(((y[w]||{}).DBF||{}).name){v[w]=y[w].DBF.name,++k;continue}if(v[w]!=null){if(++k,typeof v[w]=="number"&&(v[w]=v[w].toString(10)),typeof v[w]!="string")throw new Error("DBF Invalid column name "+v[w]+" |"+typeof v[w]+"|");if(v.indexOf(v[w])!==w){for(E=0;E<1024;++E)if(v.indexOf(v[w]+"_"+E)==-1){v[w]+="_"+E;break}}}}var _=Ct(u["!ref"]),R=[],A=[],D=[];for(w=0;w<=_.e.c-_.s.c;++w){var T="",F="",O=0,U=[];for(E=0;E<b.length;++E)b[E][w]!=null&&U.push(b[E][w]);if(U.length==0||v[w]==null){R[w]="?";continue}for(E=0;E<U.length;++E){switch(typeof U[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=U[E]instanceof Date?"D":"C";break;default:F="C"}O=Math.max(O,String(U[E]).length),T=T&&T!=F?"C":F}O>250&&(O=250),F=((y[w]||{}).DBF||{}).type,F=="C"&&y[w].DBF.len>O&&(O=y[w].DBF.len),T=="B"&&F=="N"&&(T="N",D[w]=y[w].DBF.dec,O=y[w].DBF.len),A[w]=T=="C"||F=="N"?O:l[T]||0,N+=A[w],R[w]=T}var q=m.next(32);for(q.write_shift(4,318902576),q.write_shift(4,b.length),q.write_shift(2,296+32*k),q.write_shift(2,N),w=0;w<4;++w)q.write_shift(4,0);for(q.write_shift(4,0|(+t[d4]||3)<<8),w=0,E=0;w<v.length;++w)if(v[w]!=null){var z=m.next(32),te=(v[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,te,"sbcs"),z.write_shift(1,R[w]=="?"?"C":R[w],"sbcs"),z.write_shift(4,E),z.write_shift(1,A[w]||l[R[w]]||0),z.write_shift(1,D[w]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),E+=A[w]||l[R[w]]||0}var ce=m.next(264);for(ce.write_shift(4,13),w=0;w<65;++w)ce.write_shift(4,0);for(w=0;w<b.length;++w){var de=m.next(N);for(de.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(R[E]){case"L":de.write_shift(1,b[w][E]==null?63:b[w][E]?84:70);break;case"B":de.write_shift(8,b[w][E]||0,"f");break;case"N":var ee="0";for(typeof b[w][E]=="number"&&(ee=b[w][E].toFixed(D[E]||0)),k=0;k<A[E]-ee.length;++k)de.write_shift(1,32);de.write_shift(1,ee,"sbcs");break;case"D":b[w][E]?(de.write_shift(4,("0000"+b[w][E].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(b[w][E].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+b[w][E].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(b[w][E]!=null?b[w][E]:"").slice(0,A[E]);for(de.write_shift(1,ie,"sbcs"),k=0;k<A[E]-ie.length;++k)de.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),_E=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+vr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,b){var y=e[b];return typeof y=="number"?mb(y):y},a=function(v,b,y){var w=b.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return w==59?v:mb(w)};e["|"]=254;function n(v,b){switch(b.type){case"base64":return l(tn(v),b);case"binary":return l(v,b);case"buffer":return l(vt&&Buffer.isBuffer(v)?v.toString("binary"):zi(v),b);case"array":return l(Rl(v),b)}throw new Error("Unrecognized type "+b.type)}function l(v,b){var y=v.split(/[\n\r]+/),w=-1,E=-1,k=0,N=0,_=[],R=[],A=null,D={},T=[],F=[],O=[],U=0,q;for(+b.codepage>=0&&Pn(+b.codepage);k!==y.length;++k){U=0;var z=y[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),te=z.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),ce=te[0],de;if(z.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&R.push(z.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ie=!1,Te=!1,ne=!1,B=-1,Z=-1;for(N=1;N<te.length;++N)switch(te[N].charAt(0)){case"A":break;case"X":E=parseInt(te[N].slice(1))-1,ie=!0;break;case"Y":for(w=parseInt(te[N].slice(1))-1,ie||(E=0),q=_.length;q<=w;++q)_[q]=[];break;case"K":de=te[N].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Un(de))?isNaN($o(de).getDate())||(de=rr(de)):(de=Un(de),A!==null&&ic(A)&&(de=Wd(de))),ee=!0;break;case"E":ne=!0;var L=Oo(te[N].slice(1),{r:w,c:E});_[w][E]=[_[w][E],L];break;case"S":Te=!0,_[w][E]=[_[w][E],"S5S"];break;case"G":break;case"R":B=parseInt(te[N].slice(1))-1;break;case"C":Z=parseInt(te[N].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+z)}if(ee&&(_[w][E]&&_[w][E].length==2?_[w][E][0]=de:_[w][E]=de,A=null),Te){if(ne)throw new Error("SYLK shared formula cannot have own formula");var G=B>-1&&_[B][Z];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");_[w][E][1]=HE(G[1],{r:w-B,c:E-Z})}break;case"F":var V=0;for(N=1;N<te.length;++N)switch(te[N].charAt(0)){case"X":E=parseInt(te[N].slice(1))-1,++V;break;case"Y":for(w=parseInt(te[N].slice(1))-1,q=_.length;q<=w;++q)_[q]=[];break;case"M":U=parseInt(te[N].slice(1))/20;break;case"F":break;case"G":break;case"P":A=R[parseInt(te[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=te[N].slice(1).split(" "),q=parseInt(O[0],10);q<=parseInt(O[1],10);++q)U=parseInt(O[2],10),F[q-1]=U===0?{hidden:!0}:{wch:U},Bi(F[q-1]);break;case"C":E=parseInt(te[N].slice(1))-1,F[E]||(F[E]={});break;case"R":w=parseInt(te[N].slice(1))-1,T[w]||(T[w]={}),U>0?(T[w].hpt=U,T[w].hpx=Qo(U)):U===0&&(T[w].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+z)}V<1&&(A=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+z)}}return T.length>0&&(D["!rows"]=T),F.length>0&&(D["!cols"]=F),b&&b.sheetRows&&(_=_.slice(0,b.sheetRows)),[_,D]}function o(v,b){var y=n(v,b),w=y[0],E=y[1],k=oc(w,b);return vr(E).forEach(function(N){k[N]=E[N]}),k}function u(v,b){return Hi(o(v,b),b)}function h(v,b,y,w){var E="C;Y"+(y+1)+";X"+(w+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+Eg(v.f,{r:y,c:w}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function x(v,b){b.forEach(function(y,w){var E="F;W"+(w+1)+" "+(w+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=U0(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=z0(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,b){b.forEach(function(y,w){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*H0(y.hpx)+";"),E.length>2&&v.push(E+"R"+(w+1))})}function g(v,b){var y=["ID;PWXL;N;E"],w=[],E=Ct(v["!ref"]),k,N=Array.isArray(v),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),v["!cols"]&&x(y,v["!cols"]),v["!rows"]&&m(y,v["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var R=E.s.r;R<=E.e.r;++R)for(var A=E.s.c;A<=E.e.c;++A){var D=tt({r:R,c:A});k=N?(v[R]||[])[A]:v[D],!(!k||k.v==null&&(!k.f||k.F))&&w.push(h(k,v,R,A))}return y.join(_)+_+w.join(_)+_+"E"+_}return{to_workbook:u,to_sheet:o,from_sheet:g}}(),kE=function(){function e(l,o){switch(o.type){case"base64":return t(tn(l),o);case"binary":return t(l,o);case"buffer":return t(vt&&Buffer.isBuffer(l)?l.toString("binary"):zi(l),o);case"array":return t(Rl(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),h=-1,x=-1,m=0,g=[];m!==u.length;++m){if(u[m].trim()==="BOT"){g[++h]=[],x=0;continue}if(!(h<0)){var v=u[m].trim().split(","),b=v[0],y=v[1];++m;for(var w=u[m]||"";(w.match(/["]/g)||[]).length&1&&m<u.length-1;)w+=`
`+u[++m];switch(w=w.trim(),+b){case-1:if(w==="BOT"){g[++h]=[],x=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?g[h][x]=!0:w==="FALSE"?g[h][x]=!1:isNaN(Un(y))?isNaN($o(y).getDate())?g[h][x]=y:g[h][x]=rr(y):g[h][x]=Un(y),++x;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),g[h][x++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(l,o){return oc(e(l,o),o)}function a(l,o){return Hi(r(l,o),o)}var n=function(){var l=function(h,x,m,g,v){h.push(x),h.push(m+","+g),h.push('"'+v.replace(/"/g,'""')+'"')},o=function(h,x,m,g){h.push(x+","+m),h.push(x==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(h){var x=[],m=Ct(h["!ref"]),g,v=Array.isArray(h);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var b=m.s.r;b<=m.e.r;++b){o(x,-1,0,"BOT");for(var y=m.s.c;y<=m.e.c;++y){var w=tt({r:b,c:y});if(g=v?(h[b]||[])[y]:h[w],!g){o(x,1,0,"");continue}switch(g.t){case"n":var E=g.w;!E&&g.v!=null&&(E=g.v),E==null?g.f&&!g.F?o(x,1,0,"="+g.f):o(x,1,0,""):o(x,0,E,"V");break;case"b":o(x,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=_n(g.z||et[14],zr(rr(g.v)))),o(x,0,g.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var k=`\r
`,N=x.join(k);return N}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),TE=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,v){for(var b=g.split(`
`),y=-1,w=-1,E=0,k=[];E!==b.length;++E){var N=b[E].trim().split(":");if(N[0]==="cell"){var _=ur(N[1]);if(k.length<=_.r)for(y=k.length;y<=_.r;++y)k[y]||(k[y]=[]);switch(y=_.r,w=_.c,N[2]){case"t":k[y][w]=e(N[3]);break;case"v":k[y][w]=+N[3];break;case"vtf":var R=N[N.length-1];case"vtc":switch(N[3]){case"nl":k[y][w]=!!+N[4];break;default:k[y][w]=+N[4];break}N[2]=="vtf"&&(k[y][w]=[k[y][w],R])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function a(g,v){return oc(r(g,v),v)}function n(g,v){return Hi(a(g,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function x(g){if(!g||!g["!ref"])return"";for(var v=[],b=[],y,w="",E=Ua(g["!ref"]),k=Array.isArray(g),N=E.s.r;N<=E.e.r;++N)for(var _=E.s.c;_<=E.e.c;++_)if(w=tt({r:N,c:_}),y=k?(g[N]||[])[_]:g[w],!(!y||y.v==null||y.t==="z")){switch(b=["cell",w,"t"],y.t){case"s":case"str":b.push(t(y.v));break;case"n":y.f?(b[2]="vtf",b[3]="n",b[4]=y.v,b[5]=t(y.f)):(b[2]="v",b[3]=y.v);break;case"b":b[2]="vt"+(y.f?"f":"c"),b[3]="nl",b[4]=y.v?"1":"0",b[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var R=zr(rr(y.v));b[2]="vtc",b[3]="nd",b[4]=""+R,b[5]=y.w||_n(y.z||et[14],R);break;case"e":continue}v.push(b.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(g){return[l,o,u,o,x(g),h].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}}(),Ko=function(){function e(m,g,v,b,y){y.raw?g[v][b]=m:m===""||(m==="TRUE"?g[v][b]=!0:m==="FALSE"?g[v][b]=!1:isNaN(Un(m))?isNaN($o(m).getDate())?g[v][b]=m:g[v][b]=rr(m):g[v][b]=Un(m))}function t(m,g){var v=g||{},b=[];if(!m||m.length===0)return b;for(var y=m.split(/[\r\n]/),w=y.length-1;w>=0&&y[w].length===0;)--w;for(var E=10,k=0,N=0;N<=w;++N)k=y[N].indexOf(" "),k==-1?k=y[N].length:k++,E=Math.max(E,k);for(N=0;N<=w;++N){b[N]=[];var _=0;for(e(y[N].slice(0,E).trim(),b,N,_,v),_=1;_<=(y[N].length-E)/10+1;++_)e(y[N].slice(E+(_-1)*10,E+_*10).trim(),b,N,_,v)}return v.sheetRows&&(b=b.slice(0,v.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var g={},v=!1,b=0,y=0;b<m.length;++b)(y=m.charCodeAt(b))==34?v=!v:!v&&y in r&&(g[y]=(g[y]||0)+1);y=[];for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&y.push([g[b],b]);if(!y.length){g=a;for(b in g)Object.prototype.hasOwnProperty.call(g,b)&&y.push([g[b],b])}return y.sort(function(w,E){return w[0]-E[0]||a[w[1]]-a[E[1]]}),r[y.pop()[1]]||44}function l(m,g){var v=g||{},b="",y=v.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(b=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(b=m.charAt(4),m=m.slice(6)):b=n(m.slice(0,1024)):v&&v.FS?b=v.FS:b=n(m.slice(0,1024));var E=0,k=0,N=0,_=0,R=0,A=b.charCodeAt(0),D=!1,T=0,F=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var O=v.dateNF!=null?c6(v.dateNF):null;function U(){var q=m.slice(_,R),z={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)z.t="z";else if(v.raw)z.t="s",z.v=q;else if(q.trim().length===0)z.t="s",z.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(z.t="s",z.v=q.slice(2,-1).replace(/""/g,'"')):PF(q)?(z.t="n",z.f=q.slice(1)):(z.t="s",z.v=q);else if(q=="TRUE")z.t="b",z.v=!0;else if(q=="FALSE")z.t="b",z.v=!1;else if(!isNaN(N=Un(q)))z.t="n",v.cellText!==!1&&(z.w=q),z.v=N;else if(!isNaN($o(q).getDate())||O&&q.match(O)){z.z=v.dateNF||et[14];var te=0;O&&q.match(O)&&(q=u6(q,v.dateNF,q.match(O)||[]),te=1),v.cellDates?(z.t="d",z.v=rr(q,te)):(z.t="n",z.v=zr(rr(q,te))),v.cellText!==!1&&(z.w=_n(z.z,z.v instanceof Date?zr(z.v):z.v)),v.cellNF||delete z.z}else z.t="s",z.v=q;if(z.t=="z"||(v.dense?(y[E]||(y[E]=[]),y[E][k]=z):y[tt({c:k,r:E})]=z),_=R+1,F=m.charCodeAt(_),w.e.c<k&&(w.e.c=k),w.e.r<E&&(w.e.r=E),T==A)++k;else if(k=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;R<m.length;++R)switch(T=m.charCodeAt(R)){case 34:F===34&&(D=!D);break;case A:case 10:case 13:if(!D&&U())break e;break}return R-_>0&&U(),y["!ref"]=dt(w),y}function o(m,g){return!(g&&g.PRN)||g.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,g):oc(t(m,g),g)}function u(m,g){var v="",b=g.type=="string"?[0,0,0,0]:Rg(m,g);switch(g.type){case"base64":v=tn(m);break;case"binary":v=m;break;case"buffer":g.codepage==65001?v=m.toString("utf8"):g.codepage&&typeof D0<"u"||(v=vt&&Buffer.isBuffer(m)?m.toString("binary"):zi(m));break;case"array":v=Rl(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+g.type)}return b[0]==239&&b[1]==187&&b[2]==191?v=qt(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=qt(v):g.type=="binary"&&typeof D0<"u",v.slice(0,19)=="socialcalc:version:"?TE.to_sheet(g.type=="string"?v:qt(v),g):o(v,g)}function h(m,g){return Hi(u(m,g),g)}function x(m){for(var g=[],v=Ct(m["!ref"]),b,y=Array.isArray(m),w=v.s.r;w<=v.e.r;++w){for(var E=[],k=v.s.c;k<=v.e.c;++k){var N=tt({r:w,c:k});if(b=y?(m[w]||[])[k]:m[N],!b||b.v==null){E.push("          ");continue}for(var _=(b.w||(Ps(b),b.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(k===0?" ":""))}g.push(E.join(""))}return g.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:x}}();function _R(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=_E.to_workbook(e,r);return r.WTF=a,n}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return Ko.to_workbook(e,t)}}var kl=function(){function e(L,G,V){if(L){ta(L,L.l||0);for(var Q=V.Enum||B;L.l<L.length;){var le=L.read_shift(2),_e=Q[le]||Q[65535],Ee=L.read_shift(2),Ne=L.l+Ee,Re=_e.f&&_e.f(L,Ee,V);if(L.l=Ne,G(Re,_e,le))return}}}function t(L,G){switch(G.type){case"base64":return r(Ja(tn(L)),G);case"binary":return r(Ja(L),G);case"buffer":case"array":return r(L,G)}throw"Unsupported type "+G.type}function r(L,G){if(!L)return L;var V=G||{},Q=V.dense?[]:{},le="Sheet1",_e="",Ee=0,Ne={},Re=[],Ze=[],K={s:{r:0,c:0},e:{r:0,c:0}},Ae=V.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)V.Enum=B,e(L,function(Oe,Wt,fr){switch(fr){case 0:V.vers=Oe,Oe>=4096&&(V.qpro=!0);break;case 6:K=Oe;break;case 204:Oe&&(_e=Oe);break;case 222:_e=Oe;break;case 15:case 51:V.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:fr==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=V.dateNF||et[14],V.cellDates&&(Oe[1].t="d",Oe[1].v=Wd(Oe[1].v))),V.qpro&&Oe[3]>Ee&&(Q["!ref"]=dt(K),Ne[le]=Q,Re.push(le),Q=V.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ee=Oe[3],le=_e||"Sheet"+(Ee+1),_e="");var Kr=V.dense?(Q[Oe[0].r]||[])[Oe[0].c]:Q[tt(Oe[0])];if(Kr){Kr.t=Oe[1].t,Kr.v=Oe[1].v,Oe[1].z!=null&&(Kr.z=Oe[1].z),Oe[1].f!=null&&(Kr.f=Oe[1].f);break}V.dense?(Q[Oe[0].r]||(Q[Oe[0].r]=[]),Q[Oe[0].r][Oe[0].c]=Oe[1]):Q[tt(Oe[0])]=Oe[1];break}},V);else if(L[2]==26||L[2]==14)V.Enum=Z,L[2]==14&&(V.qpro=!0,L.l=0),e(L,function(Oe,Wt,fr){switch(fr){case 204:le=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>Ee&&(Q["!ref"]=dt(K),Ne[le]=Q,Re.push(le),Q=V.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ee=Oe[3],le="Sheet"+(Ee+1)),Ae>0&&Oe[0].r>=Ae)break;V.dense?(Q[Oe[0].r]||(Q[Oe[0].r]=[]),Q[Oe[0].r][Oe[0].c]=Oe[1]):Q[tt(Oe[0])]=Oe[1],K.e.c<Oe[0].c&&(K.e.c=Oe[0].c),K.e.r<Oe[0].r&&(K.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Ze[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Ze[Oe[0]]=Oe[1],Oe[0]==Ee&&(le=Oe[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(Q["!ref"]=dt(K),Ne[_e||le]=Q,Re.push(_e||le),!Ze.length)return{SheetNames:Re,Sheets:Ne};for(var lt={},kt=[],ot=0;ot<Ze.length;++ot)Ne[Re[ot]]?(kt.push(Ze[ot]||Re[ot]),lt[Ze[ot]]=Ne[Ze[ot]]||Ne[Re[ot]]):(kt.push(Ze[ot]),lt[Ze[ot]]={"!ref":"A1"});return{SheetNames:kt,Sheets:lt}}function a(L,G){var V=G||{};if(+V.codepage>=0&&Pn(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Ia(),le=Ct(L["!ref"]),_e=Array.isArray(L),Ee=[];Ie(Q,0,l(1030)),Ie(Q,6,h(le));for(var Ne=Math.min(le.e.r,8191),Re=le.s.r;Re<=Ne;++Re)for(var Ze=Nr(Re),K=le.s.c;K<=le.e.c;++K){Re===le.s.r&&(Ee[K]=cr(K));var Ae=Ee[K]+Ze,lt=_e?(L[Re]||[])[K]:L[Ae];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Ie(Q,13,b(Re,K,lt.v)):Ie(Q,14,w(Re,K,lt.v));else{var kt=Ps(lt);Ie(Q,15,g(Re,K,kt.slice(0,239)))}}return Ie(Q,1),Q.end()}function n(L,G){var V=G||{};if(+V.codepage>=0&&Pn(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Ia();Ie(Q,0,o(L));for(var le=0,_e=0;le<L.SheetNames.length;++le)(L.Sheets[L.SheetNames[le]]||{})["!ref"]&&Ie(Q,27,ne(L.SheetNames[le],_e++));var Ee=0;for(le=0;le<L.SheetNames.length;++le){var Ne=L.Sheets[L.SheetNames[le]];if(!(!Ne||!Ne["!ref"])){for(var Re=Ct(Ne["!ref"]),Ze=Array.isArray(Ne),K=[],Ae=Math.min(Re.e.r,8191),lt=Re.s.r;lt<=Ae;++lt)for(var kt=Nr(lt),ot=Re.s.c;ot<=Re.e.c;++ot){lt===Re.s.r&&(K[ot]=cr(ot));var Oe=K[ot]+kt,Wt=Ze?(Ne[lt]||[])[ot]:Ne[Oe];if(!(!Wt||Wt.t=="z"))if(Wt.t=="n")Ie(Q,23,U(lt,ot,Ee,Wt.v));else{var fr=Ps(Wt);Ie(Q,22,T(lt,ot,Ee,fr.slice(0,239)))}}++Ee}}return Ie(Q,1),Q.end()}function l(L){var G=we(2);return G.write_shift(2,L),G}function o(L){var G=we(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var V=0,Q=0,le=0,_e=0;_e<L.SheetNames.length;++_e){var Ee=L.SheetNames[_e],Ne=L.Sheets[Ee];if(!(!Ne||!Ne["!ref"])){++le;var Re=Ua(Ne["!ref"]);V<Re.e.r&&(V=Re.e.r),Q<Re.e.c&&(Q=Re.e.c)}}return V>8191&&(V=8191),G.write_shift(2,V),G.write_shift(1,le),G.write_shift(1,Q),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function u(L,G,V){var Q={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&V.qpro?(Q.s.c=L.read_shift(1),L.l++,Q.s.r=L.read_shift(2),Q.e.c=L.read_shift(1),L.l++,Q.e.r=L.read_shift(2),Q):(Q.s.c=L.read_shift(2),Q.s.r=L.read_shift(2),G==12&&V.qpro&&(L.l+=2),Q.e.c=L.read_shift(2),Q.e.r=L.read_shift(2),G==12&&V.qpro&&(L.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function h(L){var G=we(8);return G.write_shift(2,L.s.c),G.write_shift(2,L.s.r),G.write_shift(2,L.e.c),G.write_shift(2,L.e.r),G}function x(L,G,V){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(Q[0].c=L.read_shift(1),Q[3]=L.read_shift(1),Q[0].r=L.read_shift(2),L.l+=2):(Q[2]=L.read_shift(1),Q[0].c=L.read_shift(2),Q[0].r=L.read_shift(2)),Q}function m(L,G,V){var Q=L.l+G,le=x(L,G,V);if(le[1].t="s",V.vers==20768){L.l++;var _e=L.read_shift(1);return le[1].v=L.read_shift(_e,"utf8"),le}return V.qpro&&L.l++,le[1].v=L.read_shift(Q-L.l,"cstr"),le}function g(L,G,V){var Q=we(7+V.length);Q.write_shift(1,255),Q.write_shift(2,G),Q.write_shift(2,L),Q.write_shift(1,39);for(var le=0;le<Q.length;++le){var _e=V.charCodeAt(le);Q.write_shift(1,_e>=128?95:_e)}return Q.write_shift(1,0),Q}function v(L,G,V){var Q=x(L,G,V);return Q[1].v=L.read_shift(2,"i"),Q}function b(L,G,V){var Q=we(7);return Q.write_shift(1,255),Q.write_shift(2,G),Q.write_shift(2,L),Q.write_shift(2,V,"i"),Q}function y(L,G,V){var Q=x(L,G,V);return Q[1].v=L.read_shift(8,"f"),Q}function w(L,G,V){var Q=we(13);return Q.write_shift(1,255),Q.write_shift(2,G),Q.write_shift(2,L),Q.write_shift(8,V,"f"),Q}function E(L,G,V){var Q=L.l+G,le=x(L,G,V);if(le[1].v=L.read_shift(8,"f"),V.qpro)L.l=Q;else{var _e=L.read_shift(2);R(L.slice(L.l,L.l+_e),le),L.l+=_e}return le}function k(L,G,V){var Q=G&32768;return G&=-32769,G=(Q?L:0)+(G>=8192?G-16384:G),(Q?"":"$")+(V?cr(G):Nr(G))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(L,G){ta(L,0);for(var V=[],Q=0,le="",_e="",Ee="",Ne="";L.l<L.length;){var Re=L[L.l++];switch(Re){case 0:V.push(L.read_shift(8,"f"));break;case 1:_e=k(G[0].c,L.read_shift(2),!0),le=k(G[0].r,L.read_shift(2),!1),V.push(_e+le);break;case 2:{var Ze=k(G[0].c,L.read_shift(2),!0),K=k(G[0].r,L.read_shift(2),!1);_e=k(G[0].c,L.read_shift(2),!0),le=k(G[0].r,L.read_shift(2),!1),V.push(Ze+K+":"+_e+le)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(L.read_shift(2));break;case 6:{for(var Ae="";Re=L[L.l++];)Ae+=String.fromCharCode(Re);V.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Ne=V.pop(),Ee=V.pop(),V.push(["AND","OR"][Re-20]+"("+Ee+","+Ne+")");break;default:if(Re<32&&_[Re])Ne=V.pop(),Ee=V.pop(),V.push(Ee+_[Re]+Ne);else if(N[Re]){if(Q=N[Re][1],Q==69&&(Q=L[L.l++]),Q>V.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+V.join("|")+"|");return}var lt=V.slice(-Q);V.length-=Q,V.push(N[Re][0]+"("+lt.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}V.length==1?G[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function A(L){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=L.read_shift(2),G[3]=L[L.l++],G[0].c=L[L.l++],G}function D(L,G){var V=A(L);return V[1].t="s",V[1].v=L.read_shift(G-4,"cstr"),V}function T(L,G,V,Q){var le=we(6+Q.length);le.write_shift(2,L),le.write_shift(1,V),le.write_shift(1,G),le.write_shift(1,39);for(var _e=0;_e<Q.length;++_e){var Ee=Q.charCodeAt(_e);le.write_shift(1,Ee>=128?95:Ee)}return le.write_shift(1,0),le}function F(L,G){var V=A(L);V[1].v=L.read_shift(2);var Q=V[1].v>>1;if(V[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return V[1].v=Q,V}function O(L,G){var V=A(L),Q=L.read_shift(4),le=L.read_shift(4),_e=L.read_shift(2);if(_e==65535)return Q===0&&le===3221225472?(V[1].t="e",V[1].v=15):Q===0&&le===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var Ee=_e&32768;return _e=(_e&32767)-16446,V[1].v=(1-Ee*2)*(le*Math.pow(2,_e+32)+Q*Math.pow(2,_e)),V}function U(L,G,V,Q){var le=we(14);if(le.write_shift(2,L),le.write_shift(1,V),le.write_shift(1,G),Q==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var _e=0,Ee=0,Ne=0,Re=0;return Q<0&&(_e=1,Q=-Q),Ee=Math.log2(Q)|0,Q/=Math.pow(2,Ee-31),Re=Q>>>0,(Re&2147483648)==0&&(Q/=2,++Ee,Re=Q>>>0),Q-=Re,Re|=2147483648,Re>>>=0,Q*=Math.pow(2,32),Ne=Q>>>0,le.write_shift(4,Ne),le.write_shift(4,Re),Ee+=16383+(_e?32768:0),le.write_shift(2,Ee),le}function q(L,G){var V=O(L);return L.l+=G-14,V}function z(L,G){var V=A(L),Q=L.read_shift(4);return V[1].v=Q>>6,V}function te(L,G){var V=A(L),Q=L.read_shift(8,"f");return V[1].v=Q,V}function ce(L,G){var V=te(L);return L.l+=G-10,V}function de(L,G){return L[L.l+G-1]==0?L.read_shift(G,"cstr"):""}function ee(L,G){var V=L[L.l++];V>G-1&&(V=G-1);for(var Q="";Q.length<V;)Q+=String.fromCharCode(L[L.l++]);return Q}function ie(L,G,V){if(!(!V.qpro||G<21)){var Q=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var le=L.read_shift(G-21,"cstr");return[Q,le]}}function Te(L,G){for(var V={},Q=L.l+G;L.l<Q;){var le=L.read_shift(2);if(le==14e3){for(V[le]=[0,""],V[le][0]=L.read_shift(2);L[L.l];)V[le][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return V}function ne(L,G){var V=we(5+L.length);V.write_shift(2,14e3),V.write_shift(2,G);for(var Q=0;Q<L.length;++Q){var le=L.charCodeAt(Q);V[V.l++]=le>127?95:le}return V[V.l++]=0,V}var B={0:{n:"BOF",f:Mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function kR(e){var t={},r=e.match(pa),a=0,n=!1;if(r)for(;a!=r.length;++a){var l=nt(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=Yp[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(l[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+l[0])}}return t}var TR=function(){var e=M0("t"),t=M0("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:Nt(o[1])},h=l.match(t);return h&&(u.s=kR(h[1])),u}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(u){return u.v})}}(),NR=function(){var t=/(\r\n|\n)/g;function r(n,l,o){var u=[];n.u&&u.push("text-decoration: underline;"),n.uval&&u.push("text-underline-style:"+n.uval+";"),n.sz&&u.push("font-size:"+n.sz+"pt;"),n.outline&&u.push("text-effect: outline;"),n.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),n.b&&(l.push("<b>"),o.push("</b>")),n.i&&(l.push("<i>"),o.push("</i>")),n.strike&&(l.push("<s>"),o.push("</s>"));var h=n.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),n}function a(n){var l=[[],n.v,[]];return n.v?(n.s&&r(n.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}}(),CR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AR=/<(?:\w+:)?r>/,jR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Nt(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=qt(e),r&&(a.h=ng(a.t))):e.match(AR)&&(a.r=qt(e),a.t=Nt(qt((e.replace(jR,"").match(CR)||[]).join("").replace(pa,""))),r&&(a.h=NR(TR(a.r)))),a):{t:""}}var RR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,DR=/<(?:\w+:)?(?:si|sstItem)>/g,FR=/<\/(?:\w+:)?(?:si|sstItem)>/;function OR(e,t){var r=[],a="";if(!e)return r;var n=e.match(RR);if(n){a=n[2].replace(DR,"").split(FR);for(var l=0;l!=a.length;++l){var o=vg(a[l].trim(),t);o!=null&&(r[r.length]=o)}n=nt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var MR=/^\s|\s$|[\t\n\r]/;function NE(e,t){if(!t.bookSST)return"";var r=[Ar];r[r.length]=Be("sst",null,{xmlns:Ll[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],l="<si>";n.r?l+=n.r:(l+="<t",n.t||(n.t=""),n.t.match(MR)&&(l+=' xml:space="preserve"'),l+=">"+It(n.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function LR(e){return[e.read_shift(4),e.read_shift(4)]}function BR(e,t){var r=[],a=!1;return zs(e,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function PR(e,t){return t||(t=we(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var IR=$6;function UR(e){var t=Ia();je(t,159,PR(e));for(var r=0;r<e.length;++r)je(t,19,IR(e[r]));return je(t,160),t.end()}function CE(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Ms(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function zR(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ms(e,4),t.U=Ms(e,4),t.W=Ms(e,4),t}function HR(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),l=[];n-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function GR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(HR(e));return t}function VR(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function qR(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ms(e,4),t.U=Ms(e,4),t.W=Ms(e,4),t}function WR(e){var t=qR(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function AE(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function jE(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function XR(e){var t=Ms(e);switch(t.Minor){case 2:return[t.Minor,YR(e)];case 3:return[t.Minor,$R()];case 4:return[t.Minor,KR(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function YR(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=AE(e,r),n=jE(e,e.length-e.l);return{t:"Std",h:a,v:n}}function $R(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KR(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(pa,function(l){var o=nt(l);switch(os(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=o[u]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function QR(e,t){var r={},a=r.EncryptionVersionInfo=Ms(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=AE(e,n),t-=n,r.EncryptionVerifier=jE(e,t),r}function ZR(e){var t={},r=t.EncryptionVersionInfo=Ms(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function yg(e){var t=0,r,a=CE(e),n=a.length+1,l,o,u,h,x;for(r=Li(n),r[0]=a.length,l=1;l!=n;++l)r[l]=a[l-1];for(l=n-1;l>=0;--l)o=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,x=u|h,t=x^o;return t^52811}var RE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,u){return a(o^u)},l=function(o){for(var u=t[o.length-1],h=104,x=o.length-1;x>=0;--x)for(var m=o[x],g=0;g!=7;++g)m&64&&(u^=r[h]),m*=2,--h;return u};return function(o){for(var u=CE(o),h=l(u),x=u.length,m=Li(16),g=0;g!=16;++g)m[g]=0;var v,b,y;for((x&1)===1&&(v=h>>8,m[x]=n(e[0],v),--x,v=h&255,b=u[u.length-1],m[x]=n(b,v));x>0;)--x,v=h>>8,m[x]=n(u[x],v),--x,v=h&255,m[x]=n(u[x],v);for(x=15,y=15-u.length;y>0;)v=h>>8,m[x]=n(e[y],v),--x,--y,v=h&255,m[x]=n(u[x],v),--x,--y;return m}}(),JR=function(e,t,r,a,n){n||(n=t),a||(a=RE(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=a[r],o=(o>>5|o<<3)&255,n[l]=o,++r;return[n,r,a]},eD=function(e){var t=0,r=RE(e);return function(a){var n=JR("",a,t,r);return t=n[1],n[0]}};function tD(e,t,r,a){var n={key:Mr(e),verificationBytes:Mr(e)};return r.password&&(n.verifier=yg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=eD(r.password)),n}function rD(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=ZR(e):a.Data=QR(e,t),a}function aD(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?rD(e,t-2,a):tD(e,r.biff>=8?t:t-2,r,a),a}var DE=function(){function e(n,l){switch(l.type){case"base64":return t(tn(n),l);case"binary":return t(n,l);case"buffer":return t(vt&&Buffer.isBuffer(n)?n.toString("binary"):zi(n),l);case"array":return t(Rl(n),l)}throw new Error("Unrecognized type "+l.type)}function t(n,l){var o=l||{},u=o.dense?[]:{},h=n.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(m,g){Array.isArray(u)&&(u[g]=[]);for(var v=/\\\w+\b/g,b=0,y,w=-1;y=v.exec(m);){switch(y[0]){case"\\cell":var E=m.slice(b,v.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var k={v:E,t:"s"};Array.isArray(u)?u[g][w]=k:u[tt({r:g,c:w})]=k}break}b=v.lastIndex}w>x.e.c&&(x.e.c=w)}),u["!ref"]=dt(x),u}function r(n,l){return Hi(e(n,l),l)}function a(n){for(var l=["{\\rtf1\\ansi"],o=Ct(n["!ref"]),u,h=Array.isArray(n),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var g=tt({r:x,c:m});u=h?(n[x]||[])[m]:n[g],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Ps(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function nD(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function I0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function sD(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),l=Math.min(t,r,a),o=n-l;if(o===0)return[0,0,t];var u=0,h=0,x=n+l;switch(h=o/(x>1?2-x:x),n){case t:u=((r-a)/o+6)%6;break;case r:u=(a-t)/o+2;break;case a:u=(t-r)/o+4;break}return[u/6,h,x/2]}function iD(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),l=a-n/2,o=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=n*u,o[0]+=n,o[1]+=h;break;case 1:h=n*(2-u),o[0]+=h,o[1]+=n;break;case 2:h=n*(u-2),o[1]+=n,o[2]+=h;break;case 3:h=n*(4-u),o[1]+=h,o[2]+=n;break;case 4:h=n*(u-4),o[2]+=n,o[0]+=h;break;case 5:h=n*(6-u),o[2]+=h,o[0]+=n;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function _d(e,t){if(t===0)return e;var r=sD(nD(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),I0(iD(r))}var FE=6,lD=15,oD=1,fa=FE;function U0(e){return Math.floor((e+Math.round(128/fa)/256)*fa)}function z0(e){return Math.floor((e-5)/fa*100+.5)/100}function kd(e){return Math.round((e*fa+5)/fa*256)/256}function Nm(e){return kd(z0(U0(e)))}function bg(e){var t=Math.abs(e-Nm(e)),r=fa;if(t>.005)for(fa=oD;fa<lD;++fa)Math.abs(e-Nm(e))<=t&&(t=Math.abs(e-Nm(e)),r=fa);fa=r}function Bi(e){e.width?(e.wpx=U0(e.width),e.wch=z0(e.wpx),e.MDW=fa):e.wpx?(e.wch=z0(e.wpx),e.width=kd(e.wch),e.MDW=fa):typeof e.wch=="number"&&(e.width=kd(e.wch),e.wpx=U0(e.width),e.MDW=fa),e.customWidth&&delete e.customWidth}var cD=96,OE=cD;function H0(e){return e*96/OE}function Qo(e){return e*OE/96}var uD={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fD(e,t,r,a){t.Borders=[];var n={},l=!1;(e[0].match(pa)||[]).forEach(function(o){var u=nt(o);switch(os(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},u.diagonalUp&&(n.diagonalUp=tr(u.diagonalUp)),u.diagonalDown&&(n.diagonalDown=tr(u.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function dD(e,t,r,a){t.Fills=[];var n={},l=!1;(e[0].match(pa)||[]).forEach(function(o){var u=nt(o);switch(os(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":u.patternType&&(n.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),u.indexed&&(n.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(n.bgColor.theme=parseInt(u.theme,10)),u.tint&&(n.bgColor.tint=parseFloat(u.tint)),u.rgb&&(n.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),u.theme&&(n.fgColor.theme=parseInt(u.theme,10)),u.tint&&(n.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(n.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function hD(e,t,r,a){t.Fonts=[];var n={},l=!1;(e[0].match(pa)||[]).forEach(function(o){var u=nt(o);switch(os(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":u.val&&(n.name=qt(u.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=u.val?tr(u.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=u.val?tr(u.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(u.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=u.val?tr(u.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=u.val?tr(u.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=u.val?tr(u.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=u.val?tr(u.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=u.val?tr(u.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":u.val&&(n.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(n.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(n.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(n.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Yp[parseInt(u.val,10)];break;case"<color":if(n.color||(n.color={}),u.auto&&(n.color.auto=tr(u.auto)),u.rgb)n.color.rgb=u.rgb.slice(-6);else if(u.indexed){n.color.index=parseInt(u.indexed,10);var h=El[n.color.index];n.color.index==81&&(h=El[1]),h||(h=El[1]),n.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(n.color.theme=parseInt(u.theme,10),u.tint&&(n.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=_d(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function xD(e,t,r){t.NumberFmt=[];for(var a=vr(et),n=0;n<a.length;++n)t.NumberFmt[a[n]]=et[a[n]];var l=e[0].match(pa);if(l)for(n=0;n<l.length;++n){var o=nt(l[n]);switch(os(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(qt(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}Os(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function mD(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:a,formatCode:It(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Uf=["numFmtId","fillId","fontId","borderId","xfId"],zf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pD(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(pa)||[]).forEach(function(l){var o=nt(l),u=0;switch(os(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],u=0;u<Uf.length;++u)a[Uf[u]]&&(a[Uf[u]]=parseInt(a[Uf[u]],10));for(u=0;u<zf.length;++u)a[zf[u]]&&(a[zf[u]]=tr(a[zf[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=tr(o.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function gD(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var vD=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,x){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=u.match(t))&&xD(g,m,x),(g=u.match(n))&&hD(g,m,h,x),(g=u.match(a))&&dD(g,m,h,x),(g=u.match(l))&&fD(g,m,h,x),(g=u.match(r))&&pD(g,m,x),m}}();function ME(e,t){var r=[Ar,Be("styleSheet",null,{xmlns:Ll[0],"xmlns:vt":Ur.vt})],a;return e.SSF&&(a=mD(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=gD(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function yD(e,t){var r=e.read_shift(2),a=xa(e);return[r,a]}function bD(e,t,r){r||(r=we(6+4*t.length)),r.write_shift(2,e),Yr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function wD(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=rj(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var u=e.read_shift(1);u>0&&(a.family=u);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=tj(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=xa(e),a}function SD(e,t){t||(t=we(25+4*32)),t.write_shift(2,e.sz*20),aj(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wd(e.color,t);var a=0;return a=2,t.write_shift(1,a),Yr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ED=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Cm,_D=ma;function sw(e,t){t||(t=we(4*3+8*7+16*1)),Cm||(Cm=Vd(ED));var r=Cm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(wd({auto:1},t),wd({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function kD(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function LE(e,t,r){r||(r=we(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function c0(e,t){return t||(t=we(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var TD=ma;function ND(e,t){return t||(t=we(51)),t.write_shift(1,0),c0(null,t),c0(null,t),c0(null,t),c0(null,t),c0(null,t),t.length>t.l?t.slice(0,t.l):t}function CD(e,t){return t||(t=we(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),bd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function AD(e,t,r){var a=we(2052);return a.write_shift(4,e),bd(t,a),bd(r,a),a.length>a.l?a.slice(0,a.l):a}function jD(e,t,r){var a={};a.NumberFmt=[];for(var n in et)a.NumberFmt[n]=et[n];a.CellXf=[],a.Fonts=[];var l=[],o=!1;return zs(e,function(h,x,m){switch(m){case 44:a.NumberFmt[h[0]]=h[1],Os(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=_d(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function RD(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(je(e,615,zn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&je(e,44,bD(n,t[n]))}),je(e,616))}}function DD(e){var t=1;je(e,611,zn(t)),je(e,43,SD({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function FD(e){var t=2;je(e,603,zn(t)),je(e,45,sw({patternType:"none"})),je(e,45,sw({patternType:"gray125"})),je(e,604)}function OD(e){var t=1;je(e,613,zn(t)),je(e,46,ND()),je(e,614)}function MD(e){var t=1;je(e,626,zn(t)),je(e,47,LE({numFmtId:0},65535)),je(e,627)}function LD(e,t){je(e,617,zn(t.length)),t.forEach(function(r){je(e,47,LE(r,0))}),je(e,618)}function BD(e){var t=1;je(e,619,zn(t)),je(e,48,CD({xfId:0,name:"Normal"})),je(e,620)}function PD(e){var t=0;je(e,505,zn(t)),je(e,506)}function ID(e){var t=0;je(e,508,AD(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function UD(e,t){var r=Ia();return je(r,278),RD(r,e.SSF),DD(r),FD(r),OD(r),MD(r),LD(r,t.cellXfs),BD(r),PD(r),ID(r),je(r,279),r.end()}var zD=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HD(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(pa)||[]).forEach(function(n){var l=nt(n);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[zD.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function GD(){}function VD(){}var qD=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,WD=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,XD=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function YD(e,t,r){t.themeElements={};var a;[["clrScheme",qD,HD],["fontScheme",WD,GD],["fmtScheme",XD,VD]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var $D=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function BE(e,t){(!e||e.length===0)&&(e=wg());var r,a={};if(!(r=e.match($D)))throw new Error("themeElements not found in theme");return YD(r[0],a,t),a.raw=e,a}function wg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ar];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KD(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var o;try{o=A4(l,{type:"array"})}catch{return}var u=en(o,"theme/theme/theme1.xml",!0);if(u)return BE(u,r)}}function QD(e){return e.read_shift(4)}function ZD(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=JD(e,4);break;case 2:t.xclrValue=pE(e);break;case 3:t.xclrValue=QD(e);break;case 4:e.l+=4;break}return e.l+=8,t}function JD(e,t){return ma(e,t)}function eF(e,t){return ma(e,t)}function tF(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=ZD(e);break;case 6:a[1]=eF(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function rF(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),l=[];n-- >0;)l.push(tF(e,r-e.l));return{ixfe:a,ext:l}}function aF(e,t){t.forEach(function(r){r[0]})}function nF(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:xa(e)}}function sF(e){var t=we(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Yr(e.name,t),t.slice(0,t.l)}function iF(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function lF(e){var t=we(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function oF(e,t){var r=we(8+2*t.length);return r.write_shift(4,e),Yr(t,r),r.slice(0,r.l)}function cF(e){return e.l+=4,e.read_shift(4)!=0}function uF(e,t){var r=we(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fF(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},l=[],o=!1,u=2;return zs(e,function(h,x,m){switch(m){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(g){u==1?a.Cell.push({type:a.Types[g[0]-1].name,index:g[1]}):u==0&&a.Value.push({type:a.Types[g[0]-1].name,index:g[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||n.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function dF(){var e=Ia();return je(e,332),je(e,334,zn(1)),je(e,335,sF({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,oF(1,"XLDAPR")),je(e,52),je(e,35,zn(514)),je(e,4096,zn(0)),je(e,4097,yn(1)),je(e,36),je(e,53),je(e,340),je(e,337,uF(1)),je(e,51,lF([[1,0]])),je(e,338),je(e,333),e.end()}function hF(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,l=2,o;return e.replace(pa,function(u){var h=nt(u);switch(os(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<a.Types.length;++x)a.Types[x].name==h.name&&(o=a.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):l==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),a}function PE(){var e=[Ar];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function xF(e){var t=[];if(!e)return t;var r=1;return(e.match(pa)||[]).forEach(function(a){var n=nt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function mF(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=tt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function pF(e,t,r){var a=[];return zs(e,function(l,o,u){switch(u){case 63:a.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function gF(e,t,r,a){if(!e)return e;var n=a||{},l=!1;zs(e,function(u,h,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},n)}function vF(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var jo=1024;function IE(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Be("xml",null,{"xmlns:v":Qa.v,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:mv":Qa.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];jo<e*1e3;)jo+=1e3;return t.forEach(function(l){var o=ur(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Be("v:fill",h,u),m={on:"t",obscured:"t"};++jo,n=n.concat(["<v:shape"+L0({id:"_x0000_s"+jo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Be("v:shadow",null,m),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ra("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ra("x:AutoFill","False"),ra("x:Row",String(o.r)),ra("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function iw(e,t,r,a){var n=Array.isArray(e),l;t.forEach(function(o){var u=ur(o.ref);if(n?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[o.ref],!l){l={t:"z"},n?e[u.r][u.c]=l:e[o.ref]=l;var h=Ct(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var x=dt(h);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var g=l.c.length-1;g>=0;--g){if(!r&&l.c[g].T)return;r&&!l.c[g].T&&l.c.splice(g,1)}if(r&&a){for(g=0;g<a.length;++g)if(m.a==a[g].id){m.a=a[g].name||m.a;break}}l.c.push(m)})}function yF(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=nt(u[0]),x={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},m=ur(h.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!g&&!!g[1]&&vg(g[1])||{r:"",t:"",h:""};x.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),x.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(x.h=v.h),a.push(x)}}}}),a}function UE(e){var t=[Ar,Be("comments",null,{xmlns:Ll[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var l=It(n.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(h){h.a&&(n=r.indexOf(It(h.a))),l.push(h.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),l.length<=1)t.push(ra("t",It(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)o+=`Reply:
    `+l[u]+`
`;t.push(ra("t",It(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function bF(e,t){var r=[],a=!1,n={},l=0;return e.replace(pa,function(u,h){var x=nt(u);switch(os(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":n.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return u}),r}function wF(e,t,r){var a=[Ar,Be("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var l="";(n[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var h={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=h.id:h.parentId=l,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Be("threadedComment",ra("text",o.t||""),h))})}),a.push("</ThreadedComments>"),a.join("")}function SF(e,t){var r=[],a=!1;return e.replace(pa,function(l){var o=nt(l);switch(os(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function EF(e){var t=[Ar,Be("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Ll[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function _F(e){var t={};t.iauthor=e.read_shift(4);var r=Ul(e);return t.rfx=r.s,t.ref=tt(r.s),e.l+=16,t}function kF(e,t){return t==null&&(t=we(36)),t.write_shift(4,e[1].iauthor),cc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var TF=xa;function NF(e){return Yr(e.slice(0,54))}function CF(e,t){var r=[],a=[],n={},l=!1;return zs(e,function(u,h,x){switch(x){case 632:a.push(u);break;case 635:n=u;break;case 637:n.t=u.t,n.h=u.h,n.r=u.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}function AF(e){var t=Ia(),r=[];return je(t,628),je(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),je(t,632,NF(n.a)))})}),je(t,631),je(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var l={s:ur(a[0]),e:ur(a[0])};je(t,635,kF([l,n])),n.t&&n.t.length>0&&je(t,637,Q6(n)),je(t,636),delete n.iauthor})}),je(t,634),je(t,629),t.end()}var jF="application/vnd.ms-office.vbaProject";function RF(e){var t=We.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(t,n,e.FileIndex[a].content)}}),We.write(t)}function DF(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&We.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var zE=["xlsb","xlsm","xlam","biff8","xla"];function FF(){return{"!type":"dialog"}}function OF(){return{"!type":"dialog"}}function MF(){return{"!type":"macro"}}function LF(){return{"!type":"macro"}}var Oo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=t.c:--m,h?x+=t.r:--x,n+(u?"":"$")+cr(m)+(h?"":"$")+Nr(x)}return function(n,l){return t=l,n.replace(e,r)}}(),Sg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Eg=function(){return function(t,r){return t.replace(Sg,function(a,n,l,o,u,h){var x=cg(o)-(l?0:r.c),m=og(h)-(u?0:r.r),g=m==0?"":u?m+1:"["+m+"]",v=x==0?"":l?x+1:"["+x+"]";return n+"R"+g+"C"+v})}}();function HE(e,t){return e.replace(Sg,function(r,a,n,l,o,u){return a+(n=="$"?n+l:cr(cg(l)+t.c))+(o=="$"?o+u:Nr(og(u)+t.r))})}function BF(e,t,r){var a=Ua(t),n=a.s,l=ur(r),o={r:l.r-n.r,c:l.c-n.c};return HE(e,o)}function PF(e){return e.length!=1}function lw(e){return e.replace(/_xlfn\./g,"")}function Dr(e){e.l+=1}function Pi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function GE(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return VE(e);r.biff==12&&(a=4)}var n=e.read_shift(a),l=e.read_shift(a),o=Pi(e),u=Pi(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function VE(e){var t=Pi(e),r=Pi(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function IF(e,t,r){if(r.biff<8)return VE(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),l=Pi(e),o=Pi(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function qE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return UF(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Pi(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function UF(e){var t=Pi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function zF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function HF(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return GF(e);var n=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;n>524287;)n-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:n,c:l,cRel:o,rRel:u}}function GF(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function VF(e,t,r){var a=(e[e.l++]&96)>>5,n=GE(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function qF(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=GE(e,l,r);return[a,n,o]}function WF(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function XF(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,n]}function YF(e,t,r){var a=(e[e.l++]&96)>>5,n=IF(e,t-1,r);return[a,n]}function $F(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function ow(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function KF(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],l=0;l<=a;++l)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function QF(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function ZF(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function JF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function eO(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function WE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function tO(e){return e.read_shift(2),WE(e)}function rO(e){return e.read_shift(2),WE(e)}function aO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=qE(e,0,r);return[a,n]}function nO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=HF(e,0,r);return[a,n]}function sO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=qE(e,0,r);return[a,n,l]}function iO(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[c7[n],$E[n],a]}function lO(e,t,r){var a=e[e.l++],n=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:oO(e);return[n,(l[0]===0?$E:o7)[l[1]]]}function oO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function cO(e,t,r){e.l+=r&&r.biff==2?3:4}function uO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function fO(e){return e.l++,Hs[e.read_shift(1)]}function dO(e){return e.l++,e.read_shift(2)}function hO(e){return e.l++,e.read_shift(1)!==0}function xO(e){return e.l++,ha(e)}function mO(e,t,r){return e.l++,fu(e,t-1,r)}function pO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Hs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ha(e);break;case 2:r[1]=zl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function gO(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],l=0;l!=a;++l)n.push((r.biff==12?Ul:Xd)(e));return n}function vO(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var u=0;u!=n;++u)o[l][u]=pO(e,r.biff);return o}function yO(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,l=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function bO(e,t,r){if(r.biff==5)return wO(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),l=e.read_shift(4);return[a,n,l]}function wO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function SO(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function EO(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function _O(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function kO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,n]}var TO=ma,NO=ma,CO=ma;function hu(e,t,r){return e.l+=2,[zF(e)]}function _g(e){return e.l+=6,[]}var AO=hu,jO=_g,RO=_g,DO=hu;function XE(e){return e.l+=2,[Mr(e),e.read_shift(2)&1]}var FO=hu,OO=XE,MO=_g,LO=hu,BO=hu,PO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IO(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),l=e.read_shift(2),o=PO[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:l}}function UO(e){return e.l+=2,[e.read_shift(4)]}function zO(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function HO(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qO(e){return e.l+=4,[0,0]}var cw={1:{n:"PtgExp",f:uO},2:{n:"PtgTbl",f:CO},3:{n:"PtgAdd",f:Dr},4:{n:"PtgSub",f:Dr},5:{n:"PtgMul",f:Dr},6:{n:"PtgDiv",f:Dr},7:{n:"PtgPower",f:Dr},8:{n:"PtgConcat",f:Dr},9:{n:"PtgLt",f:Dr},10:{n:"PtgLe",f:Dr},11:{n:"PtgEq",f:Dr},12:{n:"PtgGe",f:Dr},13:{n:"PtgGt",f:Dr},14:{n:"PtgNe",f:Dr},15:{n:"PtgIsect",f:Dr},16:{n:"PtgUnion",f:Dr},17:{n:"PtgRange",f:Dr},18:{n:"PtgUplus",f:Dr},19:{n:"PtgUminus",f:Dr},20:{n:"PtgPercent",f:Dr},21:{n:"PtgParen",f:Dr},22:{n:"PtgMissArg",f:Dr},23:{n:"PtgStr",f:mO},26:{n:"PtgSheet",f:zO},27:{n:"PtgEndSheet",f:HO},28:{n:"PtgErr",f:fO},29:{n:"PtgBool",f:hO},30:{n:"PtgInt",f:dO},31:{n:"PtgNum",f:xO},32:{n:"PtgArray",f:$F},33:{n:"PtgFunc",f:iO},34:{n:"PtgFuncVar",f:lO},35:{n:"PtgName",f:yO},36:{n:"PtgRef",f:aO},37:{n:"PtgArea",f:VF},38:{n:"PtgMemArea",f:SO},39:{n:"PtgMemErr",f:TO},40:{n:"PtgMemNoMem",f:NO},41:{n:"PtgMemFunc",f:EO},42:{n:"PtgRefErr",f:_O},43:{n:"PtgAreaErr",f:WF},44:{n:"PtgRefN",f:nO},45:{n:"PtgAreaN",f:YF},46:{n:"PtgMemAreaN",f:GO},47:{n:"PtgMemNoMemN",f:VO},57:{n:"PtgNameX",f:bO},58:{n:"PtgRef3d",f:sO},59:{n:"PtgArea3d",f:qF},60:{n:"PtgRefErr3d",f:kO},61:{n:"PtgAreaErr3d",f:XF},255:{}},WO={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XO={1:{n:"PtgElfLel",f:XE},2:{n:"PtgElfRw",f:LO},3:{n:"PtgElfCol",f:AO},6:{n:"PtgElfRwV",f:BO},7:{n:"PtgElfColV",f:DO},10:{n:"PtgElfRadical",f:FO},11:{n:"PtgElfRadicalS",f:MO},13:{n:"PtgElfColS",f:jO},15:{n:"PtgElfColSV",f:RO},16:{n:"PtgElfRadicalLel",f:OO},25:{n:"PtgList",f:IO},29:{n:"PtgSxName",f:UO},255:{}},YO={0:{n:"PtgAttrNoop",f:qO},1:{n:"PtgAttrSemi",f:eO},2:{n:"PtgAttrIf",f:ZF},4:{n:"PtgAttrChoose",f:KF},8:{n:"PtgAttrGoto",f:QF},16:{n:"PtgAttrSum",f:cO},32:{n:"PtgAttrBaxcel",f:ow},33:{n:"PtgAttrBaxcel",f:ow},64:{n:"PtgAttrSpace",f:tO},65:{n:"PtgAttrSpaceSemi",f:rO},128:{n:"PtgAttrIfError",f:JF},255:{}};function xu(e,t,r,a){if(a.biff<8)return ma(e,t);for(var n=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=vO(e,0,a),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=gO(e,r[o][1],a),l.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&l.push(ma(e,t)),l}function mu(e,t,r){for(var a=e.l+t,n,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],n=cw[l]||cw[WO[l]],(l===24||l===25)&&(n=(l===24?XO:YO)[e[e.l+1]]),!n||!n.f?ma(e,t):o.push([n.n,n.f(e,t,r)]);return o}function $O(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var KO={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function QO(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function YE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function uw(e,t,r){var a=YE(e,t,r);return a=="#REF"?a:QO(a,r)}function ua(e,t,r,a,n){var l=n&&n.biff||8,o={s:{c:0,r:0}},u=[],h,x,m,g=0,v=0,b,y="";if(!e[0]||!e[0][0])return"";for(var w=-1,E="",k=0,N=e[0].length;k<N;++k){var _=e[0][k];switch(_[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),x=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:E=pr(" ",e[0][w][1][1]);break;case 1:E=pr("\r",e[0][w][1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}x=x+E,w=-1}u.push(x+KO[_[0]]+h);break;case"PtgIsect":h=u.pop(),x=u.pop(),u.push(x+" "+h);break;case"PtgUnion":h=u.pop(),x=u.pop(),u.push(x+","+h);break;case"PtgRange":h=u.pop(),x=u.pop(),u.push(x+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=v0(_[1][1],o,n),u.push(y0(m,l));break;case"PtgRefN":m=r?v0(_[1][1],r,n):_[1][1],u.push(y0(m,l));break;case"PtgRef3d":g=_[1][1],m=v0(_[1][2],o,n),y=uw(a,g,n),u.push(y+"!"+y0(m,l));break;case"PtgFunc":case"PtgFuncVar":var R=_[1][0],A=_[1][1];R||(R=0),R&=127;var D=R==0?[]:u.slice(-R);u.length-=R,A==="User"&&(A=D.shift()),u.push(A+"("+D.join(",")+")");break;case"PtgBool":u.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(_[1]);break;case"PtgNum":u.push(String(_[1]));break;case"PtgStr":u.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(_[1]);break;case"PtgAreaN":b=Ib(_[1][1],r?{s:r}:o,n),u.push(_m(b,n));break;case"PtgArea":b=Ib(_[1][1],o,n),u.push(_m(b,n));break;case"PtgArea3d":g=_[1][1],b=_[1][2],y=uw(a,g,n),u.push(y+"!"+_m(b,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=_[1][2];var T=(a.names||[])[v-1]||(a[0]||[])[v],F=T?T.Name:"SH33TJSNAME"+String(v);F&&F.slice(0,6)=="_xlfn."&&!n.xlfn&&(F=F.slice(6)),u.push(F);break;case"PtgNameX":var O=_[1][1];v=_[1][2];var U;if(n.biff<=5)O<0&&(O=-O),a[O]&&(U=a[O][v]);else{var q="";if(((a[O]||[])[0]||[])[0]==14849||(((a[O]||[])[0]||[])[0]==1025?a[O][v]&&a[O][v].itab>0&&(q=a.SheetNames[a[O][v].itab-1]+"!"):q=a.SheetNames[v-1]+"!"),a[O]&&a[O][v])q+=a[O][v].Name;else if(a[0]&&a[0][v])q+=a[0][v].Name;else{var z=(YE(a,O,n)||"").split(";;");z[v-1]?q=z[v-1]:q+="SH33TJSERRX"}u.push(q);break}U||(U={Name:"SH33TJSERRY"}),u.push(U.Name);break;case"PtgParen":var te="(",ce=")";if(w>=0){switch(E="",e[0][w][1][0]){case 2:te=pr(" ",e[0][w][1][1])+te;break;case 3:te=pr("\r",e[0][w][1][1])+te;break;case 4:ce=pr(" ",e[0][w][1][1])+ce;break;case 5:ce=pr("\r",e[0][w][1][1])+ce;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(te+u.pop()+ce);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:_[1][1],r:_[1][0]};var de={c:r.c,r:r.r};if(a.sharedf[tt(m)]){var ee=a.sharedf[tt(m)];u.push(ua(ee,o,de,a,n))}else{var ie=!1;for(h=0;h!=a.arrayf.length;++h)if(x=a.arrayf[h],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){u.push(ua(x[1],o,de,a,n)),ie=!0;break}ie||u.push(_[1])}break;case"PtgArray":u.push("{"+$O(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&w>=0&&Te.indexOf(e[0][k][0])==-1){_=e[0][w];var ne=!0;switch(_[1][0]){case 4:ne=!1;case 0:E=pr(" ",_[1][1]);break;case 5:ne=!1;case 1:E=pr("\r",_[1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}u.push((ne?E:"")+u.pop()+(ne?"":E)),w=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function ZO(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],ma(e,t-2)];var u=mu(e,o,r);return t!==o+n&&(l=xu(e,t-o-n,u,r)),e.l=a,[u,l]}function JO(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],ma(e,t-2)];var u=mu(e,o,r);return t!==o+n&&(l=xu(e,t-o-n,u,r)),e.l=a,[u,l]}function e7(e,t,r,a){var n=e.l+t,l=mu(e,a,r),o;return n!==e.l&&(o=xu(e,n-e.l,l,r)),[l,o]}function t7(e,t,r){var a=e.l+t,n,l=e.read_shift(2),o=mu(e,l,r);return l==65535?[[],ma(e,t-2)]:(t!==l+2&&(n=xu(e,a-l-2,o,r)),[o,n])}function r7(e){var t;if(Rs(e,e.l+6)!==65535)return[ha(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function a7(e){if(e==null){var t=we(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Dl(e);return Dl(0)}function Am(e,t,r){var a=e.l+t,n=cs(e);r.biff==2&&++e.l;var l=r7(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=JO(e,a-e.l,r);return{cell:n,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function n7(e,t,r,a,n){var l=Ol(t,r,n),o=a7(e.v),u=we(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var x=we(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var g=Xr([l,o,u,x]);return g}function Yd(e,t,r){var a=e.read_shift(4),n=mu(e,a,r),l=e.read_shift(4),o=l>0?xu(e,l,n,r):null;return[n,o]}var s7=Yd,$d=Yd,i7=Yd,l7=Yd,o7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$E={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},c7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function u7(e){var t="of:="+e.replace(Sg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function jm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function f7(e){return e.replace(/\./,"!")}var w0={},Mo={},S0=typeof Map<"u";function kg(e,t,r){var a=0,n=e.length;if(r){if(S0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=S0?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(S0?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Kd(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(fa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=z0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=kd(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Tl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Gi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,l=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Os(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=l;++n)if(e[n].numFmtId===a)return n;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function KE(e,t,r,a,n,l){try{a.cellNF&&(e.z=et[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(et[t]==null&&Os(o6[t]||"General",t),e.t==="e")e.w=e.w||Hs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=O0(e.v);else if(e.t==="d"){var o=zr(e.v);(o|0)===o?e.w=o.toString(10):e.w=O0(o)}else{if(e.v===void 0)return"";e.w=jl(e.v,Mo)}else e.t==="d"?e.w=_n(t,zr(e.v),Mo):e.w=_n(t,e.v,Mo)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_d(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_d(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&l.Fills)throw u}}}function d7(e,t,r){if(e&&e["!ref"]){var a=Ct(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function h7(e,t){var r=Ct(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=dt(r))}var x7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,m7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,p7=/<(?:\w:)?hyperlink [^>]*>/mg,g7=/"(\w*:\w*)"/,v7=/<(?:\w:)?col\b[^>]*[\/]?>/g,y7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,b7=/<(?:\w:)?pageMargins[^>]*\/>/g,QE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,w7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,S7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function E7(e,t,r,a,n,l,o){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",g=e.match(m7);g?(x=e.slice(0,g.index),m=e.slice(g.index+g[0].length)):x=m=e;var v=x.match(QE);v?Tg(v[0],u,n,r):(v=x.match(w7))&&k7(v[0],v[1]||"",u,n,r);var b=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var y=x.slice(b,b+50).match(g7);y&&h7(u,y[1])}var w=x.match(S7);w&&w[1]&&P7(w[1],n);var E=[];if(t.cellStyles){var k=x.match(v7);k&&F7(E,k)}g&&z7(g[1],u,t,h,l,o);var N=m.match(y7);N&&(u["!autofilter"]=M7(N[0]));var _=[],R=m.match(x7);if(R)for(b=0;b!=R.length;++b)_[b]=Ct(R[b].slice(R[b].indexOf('"')+1));var A=m.match(p7);A&&j7(u,A,a);var D=m.match(b7);if(D&&(u["!margins"]=R7(nt(D[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=dt(h)),t.sheetRows>0&&u["!ref"]){var T=Ct(u["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>h.e.r&&(T.e.r=h.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>h.e.c&&(T.e.c=h.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),u["!fullref"]=u["!ref"],u["!ref"]=dt(T))}return E.length>0&&(u["!cols"]=E),_.length>0&&(u["!merges"]=_),u}function _7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function Tg(e,t,r,a){var n=nt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Nt(qt(n.codeName)))}function k7(e,t,r,a,n){Tg(e.slice(0,e.indexOf(">")),r,a,n)}function T7(e,t,r,a,n){var l=!1,o={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[r];try{t.Workbook&&(h=t.Workbook.Sheets[r].CodeName||h)}catch{}l=!0,o.codeName=is(It(h))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),u=(u||"")+Be("outlinePr",null,x)}!l&&!u||(n[n.length]=Be("sheetPr",u,o))}var N7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],C7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function A7(e){var t={sheet:1};return N7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),C7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=yg(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function j7(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var l=nt(qt(t[n]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Nt(l.location))):(l.Target="#"+Nt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Ct(l.ref),h=u.s.r;h<=u.e.r;++h)for(var x=u.s.c;x<=u.e.c;++x){var m=tt({c:x,r:h});a?(e[h]||(e[h]=[]),e[h][x]||(e[h][x]={t:"z",v:void 0}),e[h][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function R7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function D7(e){return Tl(e),Be("pageMargins",null,e)}function F7(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=nt(t[a],!0);n.hidden&&(n.hidden=tr(n.hidden));var l=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,bg(n.width)),Bi(n);l<=o;)e[l++]=ar(n)}}function O7(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Be("col",null,Kd(n,a)));return r[r.length]="</cols>",r.join("")}function M7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function L7(e,t,r,a){var n=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Ua(n);o.s.r==o.e.r&&(o.e.r=Ua(t["!ref"]).e.r,n=dt(o));for(var u=0;u<l.length;++u){var h=l[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Be("autoFilter",null,{ref:n})}var B7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P7(e,t){t.Views||(t.Views=[{}]),(e.match(B7)||[]).forEach(function(r,a){var n=nt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),tr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function I7(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,n),{})}function U7(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Hs[e.v];break;case"d":a&&a.cellDates?n=rr(e.v,-1).toISOString():(e=ar(e),e.t="n",n=""+(e.v=zr(rr(e.v)))),typeof e.z>"u"&&(e.z=et[14]);break;default:n=e.v;break}var u=ra("v",It(n)),h={r:t},x=Gi(a.cellXfs,e,a);switch(x!==0&&(h.s=x),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=ra("v",""+kg(a.Strings,e.v,a.revStrings)),h.t="s";break}h.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Be("f",It(e.f),m)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(h.cm=1),Be("c",u,h)}var z7=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,l=M0("v"),o=M0("f");return function(h,x,m,g,v,b){for(var y=0,w="",E=[],k=[],N=0,_=0,R=0,A="",D,T,F=0,O=0,U,q,z=0,te=0,ce=Array.isArray(b.CellXf),de,ee=[],ie=[],Te=Array.isArray(x),ne=[],B={},Z=!1,L=!!m.sheetStubs,G=h.split(t),V=0,Q=G.length;V!=Q;++V){w=G[V].trim();var le=w.length;if(le!==0){var _e=0;e:for(y=0;y<le;++y)switch(w[y]){case">":if(w[y-1]!="/"){++y;break e}if(m&&m.cellStyles){if(T=nt(w.slice(_e,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,O=-1,m.sheetRows&&m.sheetRows<F)continue;B={},Z=!1,T.ht&&(Z=!0,B.hpt=parseFloat(T.ht),B.hpx=Qo(B.hpt)),T.hidden=="1"&&(Z=!0,B.hidden=!0),T.outlineLevel!=null&&(Z=!0,B.level=+T.outlineLevel),Z&&(ne[F-1]=B)}break;case"<":_e=y;break}if(_e>=y)break;if(T=nt(w.slice(_e,y),!0),F=T.r!=null?parseInt(T.r,10):F+1,O=-1,!(m.sheetRows&&m.sheetRows<F)){g.s.r>F-1&&(g.s.r=F-1),g.e.r<F-1&&(g.e.r=F-1),m&&m.cellStyles&&(B={},Z=!1,T.ht&&(Z=!0,B.hpt=parseFloat(T.ht),B.hpx=Qo(B.hpt)),T.hidden=="1"&&(Z=!0,B.hidden=!0),T.outlineLevel!=null&&(Z=!0,B.level=+T.outlineLevel),Z&&(ne[F-1]=B)),E=w.slice(y).split(e);for(var Ee=0;Ee!=E.length&&E[Ee].trim().charAt(0)=="<";++Ee);for(E=E.slice(Ee),y=0;y!=E.length;++y)if(w=E[y].trim(),w.length!==0){if(k=w.match(r),N=y,_=0,R=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,k!=null&&k.length===2){for(N=0,A=k[1],_=0;_!=A.length&&!((R=A.charCodeAt(_)-64)<1||R>26);++_)N=26*N+R;--N,O=N}else++O;for(_=0;_!=w.length&&w.charCodeAt(_)!==62;++_);if(++_,T=nt(w.slice(0,_),!0),T.r||(T.r=tt({r:F-1,c:O})),A=w.slice(_),D={t:""},(k=A.match(l))!=null&&k[1]!==""&&(D.v=Nt(k[1])),m.cellFormula){if((k=A.match(o))!=null&&k[1]!==""){if(D.f=Nt(qt(k[1])).replace(/\r\n/g,`
`),m.xlfn||(D.f=lw(D.f)),k[0].indexOf('t="array"')>-1)D.F=(A.match(n)||[])[1],D.F.indexOf(":")>-1&&ee.push([Ct(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){q=nt(k[0]);var Ne=Nt(qt(k[1]));m.xlfn||(Ne=lw(Ne)),ie[parseInt(q.si,10)]=[q,Ne,T.r]}}else(k=A.match(/<f[^>]*\/>/))&&(q=nt(k[0]),ie[q.si]&&(D.f=BF(ie[q.si][1],ie[q.si][2],T.r)));var Re=ur(T.r);for(_=0;_<ee.length;++_)Re.r>=ee[_][0].s.r&&Re.r<=ee[_][0].e.r&&Re.c>=ee[_][0].s.c&&Re.c<=ee[_][0].e.c&&(D.F=ee[_][1])}if(T.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(L)D.t="z";else continue;else D.t=T.t||"n";switch(g.s.c>O&&(g.s.c=O),g.e.c<O&&(g.e.c=O),D.t){case"n":if(D.v==""||D.v==null){if(!L)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!L)continue;D.t="z"}else U=w0[parseInt(D.v,10)],D.v=U.t,D.r=U.r,m.cellHTML&&(D.h=U.h);break;case"str":D.t="s",D.v=D.v!=null?qt(D.v):"",m.cellHTML&&(D.h=ng(D.v));break;case"inlineStr":k=A.match(a),D.t="s",k!=null&&(U=vg(k[1]))?(D.v=U.t,m.cellHTML&&(D.h=U.h)):D.v="";break;case"b":D.v=tr(D.v);break;case"d":m.cellDates?D.v=rr(D.v,1):(D.v=zr(rr(D.v,1)),D.t="n");break;case"e":(!m||m.cellText!==!1)&&(D.w=D.v),D.v=J4[D.v];break}if(z=te=0,de=null,ce&&T.s!==void 0&&(de=b.CellXf[T.s],de!=null&&(de.numFmtId!=null&&(z=de.numFmtId),m.cellStyles&&de.fillId!=null&&(te=de.fillId))),KE(D,z,te,m,v,b),m.cellDates&&ce&&D.t=="n"&&ic(et[z])&&(D.t="d",D.v=Wd(D.v)),T.cm&&m.xlmeta){var Ze=(m.xlmeta.Cell||[])[+T.cm-1];Ze&&Ze.type=="XLDAPR"&&(D.D=!0)}if(Te){var K=ur(T.r);x[K.r]||(x[K.r]=[]),x[K.r][K.c]=D}else x[T.r]=D}}}}ne.length>0&&(x["!rows"]=ne)}}();function H7(e,t,r,a){var n=[],l=[],o=Ct(e["!ref"]),u="",h,x="",m=[],g=0,v=0,b=e["!rows"],y=Array.isArray(e),w={r:x},E,k=-1;for(v=o.s.c;v<=o.e.c;++v)m[v]=cr(v);for(g=o.s.r;g<=o.e.r;++g){for(l=[],x=Nr(g),v=o.s.c;v<=o.e.c;++v){h=m[v]+x;var N=y?(e[g]||[])[v]:e[h];N!==void 0&&(u=U7(N,h,e,t))!=null&&l.push(u)}(l.length>0||b&&b[g])&&(w={r:x},b&&b[g]&&(E=b[g],E.hidden&&(w.hidden=1),k=-1,E.hpx?k=H0(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(w.ht=k,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),n[n.length]=Be("row",l.join(""),w))}if(b)for(;g<b.length;++g)b&&b[g]&&(w={r:g+1},E=b[g],E.hidden&&(w.hidden=1),k=-1,E.hpx?k=H0(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(w.ht=k,w.customHeight=1),E.level&&(w.outlineLevel=E.level),n[n.length]=Be("row","",w));return n.join("")}function ZE(e,t,r,a){var n=[Ar,Be("worksheet",null,{xmlns:Ll[0],"xmlns:r":Ur.r})],l=r.SheetNames[e],o=0,u="",h=r.Sheets[l];h==null&&(h={});var x=h["!ref"]||"A1",m=Ct(x);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=dt(m)}a||(a={}),h["!comments"]=[];var g=[];T7(h,r,e,t,n),n[n.length]=Be("dimension",null,{ref:x}),n[n.length]=I7(h,t,e,r),t.sheetFormat&&(n[n.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(n[n.length]=O7(h,h["!cols"])),n[o=n.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=H7(h,t),u.length>0&&(n[n.length]=u)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),h["!protect"]&&(n[n.length]=A7(h["!protect"])),h["!autofilter"]!=null&&(n[n.length]=L7(h["!autofilter"],h,r,e)),h["!merges"]!=null&&h["!merges"].length>0&&(n[n.length]=_7(h["!merges"]));var v=-1,b,y=-1;return h["!links"].length>0&&(n[n.length]="<hyperlinks>",h["!links"].forEach(function(w){w[1].Target&&(b={ref:w[0]},w[1].Target.charAt(0)!="#"&&(y=Pt(a,-1,It(w[1].Target).replace(/#.*$/,""),bt.HLINK),b["r:id"]="rId"+y),(v=w[1].Target.indexOf("#"))>-1&&(b.location=It(w[1].Target.slice(v+1))),w[1].Tooltip&&(b.tooltip=It(w[1].Tooltip)),n[n.length]=Be("hyperlink",null,b))}),n[n.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(n[n.length]=D7(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ra("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:x}))),g.length>0&&(y=Pt(a,-1,"../drawings/drawing"+(e+1)+".xml",bt.DRAW),n[n.length]=Be("drawing",null,{"r:id":"rId"+y}),h["!drawing"]=g),h["!comments"].length>0&&(y=Pt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML),n[n.length]=Be("legacyDrawing",null,{"r:id":"rId"+y}),h["!legacy"]=y),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function G7(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=n/20),r}function V7(e,t,r){var a=we(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;n.hpx?l=H0(n.hpx)*20:n.hpt&&(l=n.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var u=0,h=a.l;a.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var g=-1,v=-1,b=m<<10;b<m+1<<10;++b){x.c=b;var y=Array.isArray(r)?(r[x.r]||[])[x.c]:r[tt(x)];y&&(g<0&&(g=b),v=b)}g<0||(++u,a.write_shift(4,g),a.write_shift(4,v))}var w=a.l;return a.l=h,a.write_shift(4,u),a.l=w,a.length>a.l?a.slice(0,a.l):a}function q7(e,t,r,a){var n=V7(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&je(e,0,n)}var W7=Ul,X7=cc;function Y7(){}function $7(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Z6(e),r}function K7(e,t,r){r==null&&(r=we(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return wd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Y4(e,r),r.slice(0,r.l)}function Q7(e){var t=Tn(e);return[t]}function Z7(e,t,r){return r==null&&(r=we(8)),Bl(t,r)}function J7(e){var t=Pl(e);return[t]}function eM(e,t,r){return r==null&&(r=we(4)),Il(t,r)}function tM(e){var t=Tn(e),r=e.read_shift(1);return[t,r,"b"]}function rM(e,t,r){return r==null&&(r=we(9)),Bl(t,r),r.write_shift(1,e.v?1:0),r}function aM(e){var t=Pl(e),r=e.read_shift(1);return[t,r,"b"]}function nM(e,t,r){return r==null&&(r=we(5)),Il(t,r),r.write_shift(1,e.v?1:0),r}function sM(e){var t=Tn(e),r=e.read_shift(1);return[t,r,"e"]}function iM(e,t,r){return r==null&&(r=we(9)),Bl(t,r),r.write_shift(1,e.v),r}function lM(e){var t=Pl(e),r=e.read_shift(1);return[t,r,"e"]}function oM(e,t,r){return r==null&&(r=we(8)),Il(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function cM(e){var t=Tn(e),r=e.read_shift(4);return[t,r,"s"]}function uM(e,t,r){return r==null&&(r=we(12)),Bl(t,r),r.write_shift(4,t.v),r}function fM(e){var t=Pl(e),r=e.read_shift(4);return[t,r,"s"]}function dM(e,t,r){return r==null&&(r=we(8)),Il(t,r),r.write_shift(4,t.v),r}function hM(e){var t=Tn(e),r=ha(e);return[t,r,"n"]}function xM(e,t,r){return r==null&&(r=we(16)),Bl(t,r),Dl(e.v,r),r}function JE(e){var t=Pl(e),r=ha(e);return[t,r,"n"]}function mM(e,t,r){return r==null&&(r=we(12)),Il(t,r),Dl(e.v,r),r}function pM(e){var t=Tn(e),r=hg(e);return[t,r,"n"]}function gM(e,t,r){return r==null&&(r=we(12)),Bl(t,r),$4(e.v,r),r}function vM(e){var t=Pl(e),r=hg(e);return[t,r,"n"]}function yM(e,t,r){return r==null&&(r=we(8)),Il(t,r),$4(e.v,r),r}function bM(e){var t=Tn(e),r=ug(e);return[t,r,"is"]}function wM(e){var t=Tn(e),r=xa(e);return[t,r,"str"]}function SM(e,t,r){return r==null&&(r=we(12+4*e.v.length)),Bl(t,r),Yr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function EM(e){var t=Pl(e),r=xa(e);return[t,r,"str"]}function _M(e,t,r){return r==null&&(r=we(8+4*e.v.length)),Il(t,r),Yr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function kM(e,t,r){var a=e.l+t,n=Tn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"b"];if(r.cellFormula){e.l+=2;var u=$d(e,a-e.l,r);o[3]=ua(u,null,n,r.supbooks,r)}else e.l=a;return o}function TM(e,t,r){var a=e.l+t,n=Tn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"e"];if(r.cellFormula){e.l+=2;var u=$d(e,a-e.l,r);o[3]=ua(u,null,n,r.supbooks,r)}else e.l=a;return o}function NM(e,t,r){var a=e.l+t,n=Tn(e);n.r=r["!row"];var l=ha(e),o=[n,l,"n"];if(r.cellFormula){e.l+=2;var u=$d(e,a-e.l,r);o[3]=ua(u,null,n,r.supbooks,r)}else e.l=a;return o}function CM(e,t,r){var a=e.l+t,n=Tn(e);n.r=r["!row"];var l=xa(e),o=[n,l,"str"];if(r.cellFormula){e.l+=2;var u=$d(e,a-e.l,r);o[3]=ua(u,null,n,r.supbooks,r)}else e.l=a;return o}var AM=Ul,jM=cc;function RM(e,t){return t==null&&(t=we(4)),t.write_shift(4,e),t}function DM(e,t){var r=e.l+t,a=Ul(e),n=fg(e),l=xa(e),o=xa(e),u=xa(e);e.l=r;var h={rfx:a,relId:n,loc:l,display:u};return o&&(h.Tooltip=o),h}function FM(e,t){var r=we(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));cc({s:ur(e[0]),e:ur(e[0])},r),dg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Yr(n||"",r),Yr(e[1].Tooltip||"",r),Yr("",r),r.slice(0,r.l)}function OM(){}function MM(e,t,r){var a=e.l+t,n=K4(e),l=e.read_shift(1),o=[n];if(o[2]=l,r.cellFormula){var u=s7(e,a-e.l,r);o[1]=u}else e.l=a;return o}function LM(e,t,r){var a=e.l+t,n=Ul(e),l=[n];if(r.cellFormula){var o=l7(e,a-e.l,r);l[1]=o,e.l=a}else e.l=a;return l}function BM(e,t,r){r==null&&(r=we(18));var a=Kd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var e_=["left","right","top","bottom","header","footer"];function PM(e){var t={};return e_.forEach(function(r){t[r]=ha(e)}),t}function IM(e,t){return t==null&&(t=we(6*8)),Tl(e),e_.forEach(function(r){Dl(e[r],t)}),t}function UM(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function zM(e,t,r){r==null&&(r=we(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function HM(e){var t=we(24);return t.write_shift(4,4),t.write_shift(4,1),cc(e,t),t}function GM(e,t){return t==null&&(t=we(16*4+2)),t.write_shift(2,e.password?yg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function VM(){}function qM(){}function WM(e,t,r,a,n,l,o){if(!e)return e;var u=t||{};a||(a={"!id":{}});var h=u.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,v=!1,b,y,w,E,k,N,_,R,A,D=[];u.biff=12,u["!row"]=0;var T=0,F=!1,O=[],U={},q=u.supbooks||n.supbooks||[[]];if(q.sharedf=U,q.arrayf=O,q.SheetNames=n.SheetNames||n.Sheets.map(function(Te){return Te.name}),!u.supbooks&&(u.supbooks=q,n.Names))for(var z=0;z<n.Names.length;++z)q[0][z+1]=n.Names[z];var te=[],ce=[],de=!1;G0[16]={n:"BrtShortReal",f:JE};var ee;if(zs(e,function(ne,B,Z){if(!v)switch(Z){case 148:x=ne;break;case 0:b=ne,u.sheetRows&&u.sheetRows<=b.r&&(v=!0),R=Nr(E=b.r),u["!row"]=b.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Qo(ne.hpt)),ce[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ne[2]},ne[2]){case"n":y.v=ne[1];break;case"s":_=w0[ne[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!ne[1];break;case"e":y.v=ne[1],u.cellText!==!1&&(y.w=Hs[y.v]);break;case"str":y.t="s",y.v=ne[1];break;case"is":y.t="s",y.v=ne[1].t;break}if((w=o.CellXf[ne[0].iStyleRef])&&KE(y,w.numFmtId,null,u,l,o),k=ne[0].c==-1?k+1:ne[0].c,u.dense?(h[E]||(h[E]=[]),h[E][k]=y):h[cr(k)+R]=y,u.cellFormula){for(F=!1,T=0;T<O.length;++T){var L=O[T];b.r>=L[0].s.r&&b.r<=L[0].e.r&&k>=L[0].s.c&&k<=L[0].e.c&&(y.F=dt(L[0]),F=!0)}!F&&ne.length>3&&(y.f=ne[3])}if(m.s.r>b.r&&(m.s.r=b.r),m.s.c>k&&(m.s.c=k),m.e.r<b.r&&(m.e.r=b.r),m.e.c<k&&(m.e.c=k),u.cellDates&&w&&y.t=="n"&&ic(et[w.numFmtId])){var G=fl(y.v);G&&(y.t="d",y.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}ee&&(ee.type=="XLDAPR"&&(y.D=!0),ee=void 0);break;case 1:case 12:if(!u.sheetStubs||g)break;y={t:"z",v:void 0},k=ne[0].c==-1?k+1:ne[0].c,u.dense?(h[E]||(h[E]=[]),h[E][k]=y):h[cr(k)+R]=y,m.s.r>b.r&&(m.s.r=b.r),m.s.c>k&&(m.s.c=k),m.e.r<b.r&&(m.e.r=b.r),m.e.c<k&&(m.e.c=k),ee&&(ee.type=="XLDAPR"&&(y.D=!0),ee=void 0);break;case 176:D.push(ne);break;case 49:ee=((u.xlmeta||{}).Cell||[])[ne-1];break;case 494:var V=a["!id"][ne.relId];for(V?(ne.Target=V.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=V):ne.relId==""&&(ne.Target="#"+ne.loc),E=ne.rfx.s.r;E<=ne.rfx.e.r;++E)for(k=ne.rfx.s.c;k<=ne.rfx.e.c;++k)u.dense?(h[E]||(h[E]=[]),h[E][k]||(h[E][k]={t:"z",v:void 0}),h[E][k].l=ne):(N=tt({c:k,r:E}),h[N]||(h[N]={t:"z",v:void 0}),h[N].l=ne);break;case 426:if(!u.cellFormula)break;O.push(ne),A=u.dense?h[E][k]:h[cr(k)+R],A.f=ua(ne[1],m,{r:b.r,c:k},q,u),A.F=dt(ne[0]);break;case 427:if(!u.cellFormula)break;U[tt(ne[0].s)]=ne[1],A=u.dense?h[E][k]:h[cr(k)+R],A.f=ua(ne[1],m,{r:b.r,c:k},q,u);break;case 60:if(!u.cellStyles)break;for(;ne.e>=ne.s;)te[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},de||(de=!0,bg(ne.w/256)),Bi(te[ne.e+1]);break;case 161:h["!autofilter"]={ref:dt(ne)};break;case 476:h["!margins"]=ne;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),ne.name&&(n.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(h["!outline"]={above:ne.above,left:ne.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),ne.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!B.T){if(!g||u.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(h["!ref"]=dt(x||m)),u.sheetRows&&h["!ref"]){var ie=Ct(h["!ref"]);u.sheetRows<=+ie.e.r&&(ie.e.r=u.sheetRows-1,ie.e.r>m.e.r&&(ie.e.r=m.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>m.e.c&&(ie.e.c=m.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),h["!fullref"]=h["!ref"],h["!ref"]=dt(ie))}return D.length>0&&(h["!merges"]=D),te.length>0&&(h["!cols"]=te),ce.length>0&&(h["!rows"]=ce),h}function XM(e,t,r,a,n,l,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=ar(t),t.z=t.z||et[14],t.v=zr(rr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var h={r,c:a};switch(h.s=Gi(n.cellXfs,t,n),t.l&&l["!links"].push([tt(h),t.l]),t.c&&l["!comments"].push([tt(h),t.c]),t.t){case"s":case"str":return n.bookSST?(u=kg(n.Strings,t.v,n.revStrings),h.t="s",h.v=u,o?je(e,18,dM(t,h)):je(e,7,uM(t,h))):(h.t="str",o?je(e,17,_M(t,h)):je(e,6,SM(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?je(e,13,yM(t,h)):je(e,2,gM(t,h)):o?je(e,16,mM(t,h)):je(e,5,xM(t,h)),!0;case"b":return h.t="b",o?je(e,15,nM(t,h)):je(e,4,rM(t,h)),!0;case"e":return h.t="e",o?je(e,14,oM(t,h)):je(e,3,iM(t,h)),!0}return o?je(e,12,eM(t,h)):je(e,1,Z7(t,h)),!0}function YM(e,t,r,a){var n=Ct(t["!ref"]||"A1"),l,o="",u=[];je(e,145);var h=Array.isArray(t),x=n.e.r;t["!rows"]&&(x=Math.max(n.e.r,t["!rows"].length-1));for(var m=n.s.r;m<=x;++m){o=Nr(m),q7(e,t,n,m);var g=!1;if(m<=n.e.r)for(var v=n.s.c;v<=n.e.c;++v){m===n.s.r&&(u[v]=cr(v)),l=u[v]+o;var b=h?(t[m]||[])[v]:t[l];if(!b){g=!1;continue}g=XM(e,b,m,v,a,t,g)}}je(e,146)}function $M(e,t){!t||!t["!merges"]||(je(e,177,RM(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,jM(r))}),je(e,178))}function KM(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,a){r&&je(e,60,BM(a,r))}),je(e,391))}function QM(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,HM(Ct(t["!ref"]))),je(e,650))}function ZM(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Pt(r,-1,a[1].Target.replace(/#.*$/,""),bt.HLINK);je(e,494,FM(a,n))}}),delete t["!links"]}function JM(e,t,r,a){if(t["!comments"].length>0){var n=Pt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);je(e,551,dg("rId"+n)),t["!legacy"]=n}}function e9(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],l=typeof n.ref=="string"?n.ref:dt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=Ua(l);u.s.r==u.e.r&&(u.e.r=Ua(t["!ref"]).e.r,l=dt(u));for(var h=0;h<o.length;++h){var x=o[h];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==a){x.Ref="'"+r.SheetNames[a]+"'!"+l;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),je(e,161,cc(Ct(l))),je(e,162)}}function t9(e,t,r){je(e,133),je(e,137,zM(t,r)),je(e,138),je(e,134)}function r9(e,t){t["!protect"]&&je(e,535,GM(t["!protect"]))}function a9(e,t,r,a){var n=Ia(),l=r.SheetNames[e],o=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var h=Ct(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],je(n,129),(r.vbaraw||o["!outline"])&&je(n,147,K7(u,o["!outline"])),je(n,148,X7(h)),t9(n,o,r.Workbook),KM(n,o),YM(n,o,e,t),r9(n,o),e9(n,o,r,e),$M(n,o),ZM(n,o,a),o["!margins"]&&je(n,476,IM(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&QM(n,o),JM(n,o,e,a),je(n,130),n.end()}function n9(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,n,a]}function s9(e,t,r,a,n,l){var o=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var v=n9(g);m.s.r=m.s.c=0,m.e.c=u,x=cr(u),v[0].forEach(function(b,y){o[x+Nr(y)]={t:"n",v:b,z:v[1]},h=y}),m.e.r<h&&(m.e.r=h),++u}),u>0&&(o["!ref"]=dt(m)),o}function i9(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(QE);return u&&Tg(u[0],l,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function l9(e,t){e.l+=10;var r=xa(e);return{name:r}}function o9(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return zs(e,function(h,x,m){switch(m){case 550:l["!rel"]=h;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),h.name&&(n.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Ng=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],c9=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],u9=[],f9=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function dw(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var l=t[n];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=tr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function hw(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=tr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function t_(e){hw(e.WBProps,Ng),hw(e.CalcPr,f9),dw(e.WBView,c9),dw(e.Sheets,u9),Mo.date1904=tr(e.WBProps.date1904)}function d9(e){return!e.Workbook||!e.Workbook.WBProps?"false":tr(e.Workbook.WBProps.date1904)?"true":"false"}var h9="][*?/\\".split("");function r_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return h9.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function x9(e,t,r){e.forEach(function(a,n){r_(a);for(var l=0;l<n;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function m9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];x9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)d7(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var p9=/<\w+:workbook/;function g9(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",l={},o=0;if(e.replace(pa,function(h,x){var m=nt(h);switch(os(m[0])){case"<?xml":break;case"<workbook":h.match(p9)&&(n="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ng.forEach(function(g){if(m[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=tr(m[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(m[g[0]],10);break;default:r.WBProps[g[0]]=m[g[0]]}}),m.codeName&&(r.WBProps.CodeName=qt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Nt(qt(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=qt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),tr(m.hidden||"0")&&(l.Hidden=!0),o=x+h.length;break;case"</definedName>":l.Ref=Nt(qt(e.slice(o,x))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return h}),Ll.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return t_(r),r}function a_(e){var t=[Ar];t[t.length]=Be("workbook",null,{xmlns:Ll[0],"xmlns:r":Ur.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ng.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Be("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],l=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!n[l]||!n[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:It(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),n[l])switch(n[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(t[t.length]=Be("definedName",It(u.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function v9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=mp(e),r.name=xa(e),r}function y9(e,t){return t||(t=we(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),dg(e.strRelID,t),Yr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function b9(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?xa(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function w9(e,t){t||(t=we(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Y4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function S9(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function E9(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),l=J6(e),o=i7(e,0,r),u=fg(e);e.l=a;var h={Name:l,Ptg:o};return n<268435455&&(h.Sheet=n),u&&(h.Comment=u),h}function _9(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],G0[16]={n:"BrtFRTArchID$",f:S9},zs(e,function(h,x,m){switch(m){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=ua(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,h]):o[0]=[m,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!x.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),t_(r),r.Names=l,r.supbooks=o,r}function k9(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,y9(n))}je(e,144)}function T9(e,t){t||(t=we(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Yr("SheetJS",t),Yr(xd.version,t),Yr(xd.version,t),Yr("7262",t),t.length>t.l?t.slice(0,t.l):t}function N9(e,t){t||(t=we(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function C9(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&l==-1&&(l=a);l>n||(je(e,135),je(e,158,N9(n)),je(e,136))}}function A9(e,t){var r=Ia();return je(r,131),je(r,128,T9()),je(r,153,w9(e.Workbook&&e.Workbook.WBProps||null)),C9(r,e),k9(r,e),je(r,132),r.end()}function j9(e,t,r){return t.slice(-4)===".bin"?_9(e,r):g9(e,r)}function R9(e,t,r,a,n,l,o,u){return t.slice(-4)===".bin"?WM(e,a,r,n,l,o,u):E7(e,a,r,n,l,o,u)}function D9(e,t,r,a,n,l,o,u){return t.slice(-4)===".bin"?o9(e,a,r,n,l):i9(e,a,r,n,l)}function F9(e,t,r,a,n,l,o,u){return t.slice(-4)===".bin"?MF():LF()}function O9(e,t,r,a,n,l,o,u){return t.slice(-4)===".bin"?FF():OF()}function M9(e,t,r,a){return t.slice(-4)===".bin"?jD(e,r,a):vD(e,r,a)}function L9(e,t,r){return BE(e,r)}function B9(e,t,r){return t.slice(-4)===".bin"?BR(e,r):OR(e,r)}function P9(e,t,r){return t.slice(-4)===".bin"?CF(e,r):yF(e,r)}function I9(e,t,r){return t.slice(-4)===".bin"?pF(e):xF(e)}function U9(e,t,r,a){return r.slice(-4)===".bin"?gF(e,t,r,a):void 0}function z9(e,t,r){return t.slice(-4)===".bin"?fF(e,t,r):hF(e,t,r)}function H9(e,t,r){return(t.slice(-4)===".bin"?A9:a_)(e)}function G9(e,t,r,a,n){return(t.slice(-4)===".bin"?a9:ZE)(e,r,a,n)}function V9(e,t,r){return(t.slice(-4)===".bin"?UD:ME)(e,r)}function q9(e,t,r){return(t.slice(-4)===".bin"?UR:NE)(e,r)}function W9(e,t,r){return(t.slice(-4)===".bin"?AF:UE)(e)}function X9(e){return(e.slice(-4)===".bin"?dF:PE)()}var n_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,s_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(n_),l,o,u,h;if(n)for(h=0;h!=n.length;++h)l=n[h].match(s_),(o=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),a[u]=l[2].slice(1,l[2].length-1));return a}function Y9(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(n_),n,l,o,u;if(a)for(u=0;u!=a.length;++u)n=a[u].match(s_),(l=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(l+1),r[o]=n[2].slice(1,n[2].length-1));return r}var E0;function $9(e,t){var r=E0[e]||Nt(e);return r==="General"?jl(t):_n(r,t)}function K9(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=tr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=rr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=n}function Q9(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Hs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=O0(e.v):e.w=jl(e.v):e.w=$9(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=E0[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ic(a)){var n=fl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(l){if(r.WTF)throw l}}}function Z9(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=uD[a.Pattern]||a.Pattern)}e[t.ID]=t}function J9(e,t,r,a,n,l,o,u,h,x){var m="General",g=a.StyleID,v={};x=x||{};var b=[],y=0;for(g===void 0&&u&&(g=u.StyleID),g===void 0&&o&&(g=o.StyleID);l[g]!==void 0&&(l[g].nf&&(m=l[g].nf),l[g].Interior&&b.push(l[g].Interior),!!l[g].Parent);)g=l[g].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=tr(e);break;case"String":a.t="s",a.r=jb(Nt(e)),a.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Nt(e):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=J4[e],x.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=jb(t||e));break}if(Q9(a,m,x),x.cellFormula!==!1)if(a.Formula){var w=Nt(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=Oo(w,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Oo("RC:RC",n):a.ArrayRange&&(a.F=Oo(a.ArrayRange,n),h.push([Ct(a.F),a.F]))}else for(y=0;y<h.length;++y)n.r>=h[y][0].s.r&&n.r<=h[y][0].e.r&&n.c>=h[y][0].s.c&&n.c<=h[y][0].e.c&&(a.F=h[y][1]);x.cellStyles&&(b.forEach(function(E){!v.patternType&&E.patternType&&(v.patternType=E.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function eL(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rm(e,t){var r=t||{};lc();var a=x0(sg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=qt(a));var n=a.slice(0,1024).toLowerCase(),l=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=ar(r);return o.type="string",Ko.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Wt){n.indexOf("<"+Wt)>=0&&(l=!0)}),l)return IL(a,r);E0={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],x,m={},g=[],v=r.dense?[]:{},b="",y={},w={},E=Fn('<Data ss:Type="String">'),k=0,N=0,_=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},D={},T="",F=0,O=[],U={},q={},z=0,te=[],ce=[],de={},ee=[],ie,Te=!1,ne=[],B=[],Z={},L=0,G=0,V={Sheets:[],WBProps:{date1904:!1}},Q={};B0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=B0.exec(a);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?J9(a.slice(k,u.index),T,E,h[h.length-1][0]=="comment"?de:y,{c:N,r:_},A,ee[N],w,ne,r):(T="",E=Fn(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ce.length>0&&(y.c=ce),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(v[_]||(v[_]=[]),v[_][N]=y):v[cr(N)+Nr(_)]=y),y.HRef&&(y.l={Target:Nt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(L=N+(parseInt(y.MergeAcross,10)|0),G=_+(parseInt(y.MergeDown,10)|0),O.push({s:{c:N,r:_},e:{c:L,r:G}})),!r.sheetStubs)y.MergeAcross?N=L+1:++N;else if(y.MergeAcross||y.MergeDown){for(var _e=N;_e<=L;++_e)for(var Ee=_;Ee<=G;++Ee)(_e>N||Ee>_)&&(r.dense?(v[Ee]||(v[Ee]=[]),v[Ee][_e]={t:"z"}):v[cr(_e)+Nr(Ee)]={t:"z"});N=L+1}else++N;else y=Y9(u[0]),y.Index&&(N=+y.Index-1),N<R.s.c&&(R.s.c=N),N>R.e.c&&(R.e.c=N),u[0].slice(-2)==="/>"&&++N,ce=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(_<R.s.r&&(R.s.r=_),_>R.e.r&&(R.e.r=_),u[0].slice(-2)==="/>"&&(w=Fn(u[0]),w.Index&&(_=+w.Index-1)),N=0,++_):(w=Fn(u[0]),w.Index&&(_=+w.Index-1),Z={},(w.AutoFitHeight=="0"||w.Height)&&(Z.hpx=parseInt(w.Height,10),Z.hpt=H0(Z.hpx),B[_]=Z),w.Hidden=="1"&&(Z.hidden=!0,B[_]=Z));break;case"worksheet":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));g.push(b),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(v["!ref"]=dt(R),r.sheetRows&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=dt(R))),O.length&&(v["!merges"]=O),ee.length>0&&(v["!cols"]=ee),B.length>0&&(v["!rows"]=B),m[b]=v}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=N=0,h.push([u[3],!1]),x=Fn(u[0]),b=Nt(x.Name),v=r.dense?[]:{},O=[],ne=[],B=[],Q={name:b,Hidden:0},V.Sheets.push(Q);break;case"table":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ee=[],Te=!1}break;case"style":u[1]==="/"?Z9(A,D,r):D=Fn(u[0]);break;case"numberformat":D.nf=Nt(Fn(u[0]).Format||"General"),E0[D.nf]&&(D.nf=E0[D.nf]);for(var Ne=0;Ne!=392&&et[Ne]!=D.nf;++Ne);if(Ne==392){for(Ne=57;Ne!=392;++Ne)if(et[Ne]==null){Os(D.nf,Ne);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ie=Fn(u[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Te&&ie.wpx>10){Te=!0,fa=FE;for(var Re=0;Re<ee.length;++Re)ee[Re]&&Bi(ee[Re])}Te&&Bi(ie),ee[ie.Index-1||ee.length]=ie;for(var Ze=0;Ze<+ie.Span;++Ze)ee[ee.length]=ar(ie);break;case"namedrange":if(u[1]==="/")break;V.Names||(V.Names=[]);var K=nt(u[0]),Ae={Name:K.Name,Ref:Oo(K.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Ae.Sheet=V.Sheets.length-1),V.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?T+=a.slice(F,u.index):F=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Fn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?_j(U,le,a.slice(z,u.index)):z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));eL(de),ce.push(de)}else h.push([u[3],!1]),x=Fn(u[0]),de={a:x.Author};break;case"autofilter":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var lt=Fn(u[0]);v["!autofilter"]={ref:Oo(lt.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return vw(a,r);var kt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:kt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:kt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:kt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:kt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(z,u.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else z=u.index+u[0].length;break;case"header":v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+nt(u[0]).Margin)||(v["!margins"].header=+nt(u[0]).Margin);break;case"footer":v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+nt(u[0]).Margin)||(v["!margins"].footer=+nt(u[0]).Margin);break;case"pagemargins":var ot=nt(u[0]);v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+ot.Top)||(v["!margins"].top=+ot.Top),isNaN(+ot.Left)||(v["!margins"].left=+ot.Left),isNaN(+ot.Right)||(v["!margins"].right=+ot.Right),isNaN(+ot.Bottom)||(v["!margins"].bottom=+ot.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:kt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:kt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:kt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:kt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:kt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:kt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:kt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:kt=!1}break;case"smarttags":break;default:kt=!1;break}if(kt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?K9(q,le,te,a.slice(z,u.index)):(te=u,z=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=m),Oe.SheetNames=g,Oe.Workbook=V,Oe.SSF=ar(et),Oe.Props=U,Oe.Custprops=q,Oe}function Sp(e,t){switch(Ag(t=t||{}),t.type||"base64"){case"base64":return Rm(tn(e),t);case"binary":case"buffer":case"file":return Rm(e,t);case"array":return Rm(zi(e),t)}}function tL(e,t){var r=[];return e.Props&&r.push(kj(e.Props,t)),e.Custprops&&r.push(Tj(e.Props,e.Custprops)),r.join("")}function rL(){return""}function aL(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var l=[];l.push(Be("NumberFormat",null,{"ss:Format":It(et[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Be("Style",l.join(""),o))}),Be("Styles",r.join(""))}function i_(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Eg(e.Ref,{r:0,c:0})})}function nL(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(i_(n)))}return Be("Names",r.join(""))}function sL(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,l=[],o=0;o<n.length;++o){var u=n[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(i_(u)))}return l.join("")}function iL(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Be("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ra("ProtectContents","True")),e["!protect"].objects&&n.push(ra("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ra("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ra("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ra("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Be("WorksheetOptions",n.join(""),{xmlns:Qa.x})}function lL(e){return e.map(function(t){var r=C6(t.t||""),a=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",a,{"ss:Author":t.a})}).join("")}function oL(e,t,r,a,n,l,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+It(Eg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var h=ur(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=It(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=It(e.l.Tooltip))),r["!merges"])for(var x=r["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(u["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(u["ss:MergeDown"]=x[m].e.r-x[m].s.r));var g="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":g="Number",v=String(e.v);break;case"b":g="Boolean",v=e.v?"1":"0";break;case"e":g="Error",v=Hs[e.v];break;case"d":g="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||et[14]);break;case"s":g="String",v=N6(e.v||"");break}var b=Gi(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+b),u["ss:Index"]=o.c+1;var y=e.v!=null?v:"",w=e.t=="z"?"":'<Data ss:Type="'+g+'">'+y+"</Data>";return(e.c||[]).length>0&&(w+=lL(e.c)),Be("Cell",w,u)}function cL(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Qo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uL(e,t,r,a){if(!e["!ref"])return"";var n=Ct(e["!ref"]),l=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(E,k){Bi(E);var N=!!E.width,_=Kd(k,E),R={"ss:Index":k+1};N&&(R["ss:Width"]=U0(_.width)),E.hidden&&(R["ss:Hidden"]="1"),u.push(Be("Column",null,R))});for(var h=Array.isArray(e),x=n.s.r;x<=n.e.r;++x){for(var m=[cL(x,(e["!rows"]||[])[x])],g=n.s.c;g<=n.e.c;++g){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>g)&&!(l[o].s.r>x)&&!(l[o].e.c<g)&&!(l[o].e.r<x)){(l[o].s.c!=g||l[o].s.r!=x)&&(v=!0);break}if(!v){var b={r:x,c:g},y=tt(b),w=h?(e[x]||[])[g]:e[y];m.push(oL(w,y,e,t,r,a,b))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function fL(e,t,r){var a=[],n=r.SheetNames[e],l=r.Sheets[n],o=l?sL(l,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?uL(l,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(iL(l,t,e,r)),a.join("")}function dL(e,t){t||(t={}),e.SSF||(e.SSF=ar(et)),e.SSF&&(lc(),Gd(e.SSF),t.revssf=qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Gi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(tL(e,t)),r.push(rL()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Be("Worksheet",fL(a,t,e),{"ss:Name":It(e.SheetNames[a])}));return r[2]=aL(e,t),r[3]=nL(e),Ar+Be("Workbook",r.join(""),{xmlns:Qa.ss,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:ss":Qa.ss,"xmlns:dt":Qa.dt,"xmlns:html":Qa.html})}function hL(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=nj(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=sj(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var xL=[60,1084,2066,2165,2175];function mL(e,t,r,a,n){var l=a,o=[],u=r.slice(r.l,r.l+l);if(n&&n.enc&&n.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(u)}o.push(u),r.l+=l;for(var h=Rs(r,r.l),x=Ep[h],m=0;x!=null&&xL.indexOf(h)>-1;)l=Rs(r,r.l+2),m=r.l+4,h==2066?m+=4:(h==2165||h==2175)&&(m+=12),u=r.slice(m,r.l+4+l),o.push(u),r.l+=4+l,x=Ep[h=Rs(r,r.l)];var g=Xr(o);ta(g,0);var v=0;g.lens=[];for(var b=0;b<o.length;++b)g.lens.push(v),v+=o[b].length;if(g.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+g.length+" < "+a;return t.f(g,g.length,n)}function Zn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=et[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Hs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=O0(e.v):e.w=jl(e.v):e.w=_n(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&ic(et[a]||String(a))){var n=fl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Hf(e,t,r){return{v:e,ixfe:t,t:r}}function pL(e,t){var r={opts:{}},a={},n=t.dense?[]:{},l={},o={},u=null,h=[],x="",m={},g,v="",b,y,w,E,k={},N=[],_,R,A=[],D=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},O=function(ct){return ct<8?El[ct]:ct<64&&D[ct-8]||El[ct]},U=function(ct,Jt,na){var Xt=Jt.XF.data;if(!(!Xt||!Xt.patternType||!na||!na.cellStyles)){Jt.s={},Jt.s.patternType=Xt.patternType;var Aa;(Aa=I0(O(Xt.icvFore)))&&(Jt.s.fgColor={rgb:Aa}),(Aa=I0(O(Xt.icvBack)))&&(Jt.s.bgColor={rgb:Aa})}},q=function(ct,Jt,na){if(!(Z>1)&&!(na.sheetRows&&ct.r>=na.sheetRows)){if(na.cellStyles&&Jt.XF&&Jt.XF.data&&U(ct,Jt,na),delete Jt.ixfe,delete Jt.XF,g=ct,v=tt(ct),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<o.s.r&&(o.s.r=ct.r),ct.c<o.s.c&&(o.s.c=ct.c),ct.r+1>o.e.r&&(o.e.r=ct.r+1),ct.c+1>o.e.c&&(o.e.c=ct.c+1),na.cellFormula&&Jt.f){for(var Xt=0;Xt<N.length;++Xt)if(!(N[Xt][0].s.c>ct.c||N[Xt][0].s.r>ct.r)&&!(N[Xt][0].e.c<ct.c||N[Xt][0].e.r<ct.r)){Jt.F=dt(N[Xt][0]),(N[Xt][0].s.c!=ct.c||N[Xt][0].s.r!=ct.r)&&delete Jt.f,Jt.f&&(Jt.f=""+ua(N[Xt][1],o,ct,ne,z));break}}na.dense?(n[ct.r]||(n[ct.r]=[]),n[ct.r][ct.c]=Jt):n[v]=Jt}},z={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var te,ce=[],de=[],ee=[],ie=[],Te=!1,ne=[];ne.SheetNames=z.snames,ne.sharedf=z.sharedf,ne.arrayf=z.arrayf,ne.names=[],ne.XTI=[];var B=0,Z=0,L=0,G=[],V=[],Q;z.codepage=1200,Pn(1200);for(var le=!1;e.l<e.length-1;){var _e=e.l,Ee=e.read_shift(2);if(Ee===0&&B===10)break;var Ne=e.l===e.length?0:e.read_shift(2),Re=Ep[Ee];if(Re&&Re.f){if(t.bookSheets&&B===133&&Ee!==133)break;if(B=Ee,Re.r===2||Re.r==12){var Ze=e.read_shift(2);if(Ne-=2,!z.enc&&Ze!==Ee&&((Ze&255)<<8|Ze>>8)!==Ee)throw new Error("rt mismatch: "+Ze+"!="+Ee);Re.r==12&&(e.l+=10,Ne-=10)}var K={};if(Ee===10?K=Re.f(e,Ne,z):K=mL(Ee,Re,e,Ne,z),Z==0&&[9,521,1033,2057].indexOf(B)===-1)continue;switch(Ee){case 34:r.opts.Date1904=T.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=K,!t.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=K;break;case 66:var Ae=Number(K);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}Pn(z.codepage=Ae),le=!0;break;case 317:z.rrtabid=K;break;case 25:z.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:z.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(n["!type"]="dialog"),K.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),K.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:A.push(K);break;case 430:ne.push([K]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(K);break;case 24:case 536:Q={Name:K.Name,Ref:ua(K.rgce,o,null,ne,z)},K.itab>0&&(Q.Sheet=K.itab-1),ne.names.push(Q),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(V[K.itab-1]={ref:dt(K.rgce[0][0][1][2])});break;case 22:z.ExternCount=K;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(K),ne.XTI=ne.XTI.concat(K);break;case 2196:if(z.biff<8)break;Q!=null&&(Q.Comment=K[1]);break;case 18:n["!protect"]=K;break;case 19:K!==0&&z.WTF&&console.error("Password verifier: "+K);break;case 133:l[K.pos]=K,z.snames.push(K.name);break;case 10:{if(--Z)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=dt(o),t.sheetRows&&t.sheetRows<=o.e.r){var lt=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=dt(o),o.e.r=lt}o.e.r++,o.e.c++}ce.length>0&&(n["!merges"]=ce),de.length>0&&(n["!objects"]=de),ee.length>0&&(n["!cols"]=ee),ie.length>0&&(n["!rows"]=ie),T.Sheets.push(F)}x===""?m=n:a[x]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),z.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(z.biff=5,le=!0,Pn(z.codepage=28591)),z.biff==8&&K.BIFFVer==0&&K.dt==16&&(z.biff=2),Z++)break;if(n=t.dense?[]:{},z.biff<8&&!le&&(le=!0,Pn(z.codepage=t.codepage||1252)),z.biff<5||K.BIFFVer==0&&K.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var kt={pos:e.l-Ne,name:x};l[kt.pos]=kt,z.snames.push(x)}else x=(l[_e]||{name:""}).name;K.dt==32&&(n["!type"]="chart"),K.dt==64&&(n["!type"]="macro"),ce=[],de=[],z.arrayf=N=[],ee=[],ie=[],Te=!1,F={Hidden:(l[_e]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[K.r]||[])[K.c]:n[tt({c:K.c,r:K.r})])&&++K.c,_={ixfe:K.ixfe,XF:A[K.ixfe]||{},v:K.val,t:"n"},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t);break;case 5:case 517:_={ixfe:K.ixfe,XF:A[K.ixfe],v:K.val,t:K.t},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t);break;case 638:_={ixfe:K.ixfe,XF:A[K.ixfe],v:K.rknum,t:"n"},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t);break;case 189:for(var ot=K.c;ot<=K.C;++ot){var Oe=K.rkrec[ot-K.c][0];_={ixfe:Oe,XF:A[Oe],v:K.rkrec[ot-K.c][1],t:"n"},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:ot,r:K.r},_,t)}break;case 6:case 518:case 1030:{if(K.val=="String"){u=K;break}if(_=Hf(K.val,K.cell.ixfe,K.tt),_.XF=A[_.ixfe],t.cellFormula){var Wt=K.formula;if(Wt&&Wt[0]&&Wt[0][0]&&Wt[0][0][0]=="PtgExp"){var fr=Wt[0][0][1][0],Kr=Wt[0][0][1][1],Hr=tt({r:fr,c:Kr});k[Hr]?_.f=""+ua(K.formula,o,K.cell,ne,z):_.F=((t.dense?(n[fr]||[])[Kr]:n[Hr])||{}).F}else _.f=""+ua(K.formula,o,K.cell,ne,z)}L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q(K.cell,_,t),u=K}break;case 7:case 519:if(u)u.val=K,_=Hf(K,u.cell.ixfe,"s"),_.XF=A[_.ixfe],t.cellFormula&&(_.f=""+ua(u.formula,o,u.cell,ne,z)),L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q(u.cell,_,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(K);var Ca=tt(K[0].s);if(b=t.dense?(n[K[0].s.r]||[])[K[0].s.c]:n[Ca],t.cellFormula&&b){if(!u||!Ca||!b)break;b.f=""+ua(K[1],o,K[0],ne,z),b.F=dt(K[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;k[tt(u.cell)]=K[0],b=t.dense?(n[u.cell.r]||[])[u.cell.c]:n[tt(u.cell)],(b||{}).f=""+ua(K[0],o,g,ne,z)}}break;case 253:_=Hf(h[K.isst].t,K.ixfe,"s"),h[K.isst].h&&(_.h=h[K.isst].h),_.XF=A[_.ixfe],L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:K.ixfe,XF:A[K.ixfe],t:"z"},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t));break;case 190:if(t.sheetStubs)for(var Pe=K.c;Pe<=K.C;++Pe){var pt=K.ixfe[Pe-K.c];_={ixfe:pt,XF:A[pt],t:"z"},L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:Pe,r:K.r},_,t)}break;case 214:case 516:case 4:_=Hf(K.val,K.ixfe,"s"),_.XF=A[_.ixfe],L>0&&(_.z=G[_.ixfe>>8&63]),Zn(_,t,r.opts.Date1904),q({c:K.c,r:K.r},_,t);break;case 0:case 512:Z===1&&(o=K);break;case 252:h=K;break;case 1054:if(z.biff==4){G[L++]=K[1];for(var dr=0;dr<L+163&&et[dr]!=K[1];++dr);dr>=163&&Os(K[1],L+163)}else Os(K[1],K[0]);break;case 30:{G[L++]=K;for(var yr=0;yr<L+163&&et[yr]!=K;++yr);yr>=163&&Os(K,L+163)}break;case 229:ce=ce.concat(K);break;case 93:de[K.cmo[0]]=z.lastobj=K;break;case 438:z.lastobj.TxO=K;break;case 127:z.lastobj.ImData=K;break;case 440:for(E=K[0].s.r;E<=K[0].e.r;++E)for(w=K[0].s.c;w<=K[0].e.c;++w)b=t.dense?(n[E]||[])[w]:n[tt({c:w,r:E})],b&&(b.l=K[1]);break;case 2048:for(E=K[0].s.r;E<=K[0].e.r;++E)for(w=K[0].s.c;w<=K[0].e.c;++w)b=t.dense?(n[E]||[])[w]:n[tt({c:w,r:E})],b&&b.l&&(b.l.Tooltip=K[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;b=t.dense?(n[K[0].r]||[])[K[0].c]:n[tt(K[0])];var lr=de[K[2]];b||(t.dense?(n[K[0].r]||(n[K[0].r]=[]),b=n[K[0].r][K[0].c]={t:"z"}):b=n[tt(K[0])]={t:"z"},o.e.r=Math.max(o.e.r,K[0].r),o.s.r=Math.min(o.s.r,K[0].r),o.e.c=Math.max(o.e.c,K[0].c),o.s.c=Math.min(o.s.c,K[0].c)),b.c||(b.c=[]),y={a:K[1],t:lr.TxO.t},b.c.push(y)}break;case 2173:aF(A[K.ixfe],K.ext);break;case 125:{if(!z.cellStyles)break;for(;K.e>=K.s;)ee[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},Te||(Te=!0,bg(K.w/256)),Bi(ee[K.e+1])}break;case 520:{var Ft={};K.level!=null&&(ie[K.r]=Ft,Ft.level=K.level),K.hidden&&(ie[K.r]=Ft,Ft.hidden=!0),K.hpt&&(ie[K.r]=Ft,Ft.hpt=K.hpt,Ft.hpx=Qo(K.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Tl(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=K;break;case 161:n["!margins"]||Tl(n["!margins"]={}),n["!margins"].header=K.header,n["!margins"].footer=K.footer;break;case 574:K.RTL&&(T.Views[0].RTL=!0);break;case 146:D=K;break;case 2198:te=K;break;case 140:R=K;break;case 442:x?F.CodeName=K||F.name:T.WBProps.CodeName=K||"ThisWorkbook";break}}else Re||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=Ne}return r.SheetNames=vr(l).sort(function(st,ct){return Number(st)-Number(ct)}).map(function(st){return l[st].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&V.forEach(function(st,ct){r.Sheets[r.SheetNames[ct]]["!autofilter"]=st}),r.Strings=h,r.SSF=ar(et),z.enc&&(r.Encryption=z.enc),te&&(r.Themes=te),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),ne.names.length>0&&(T.Names=ne.names),r.Workbook=T,r}var _0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gL(e,t,r){var a=We.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Yb(a,pp,_0.DSI);for(var l in n)t[l]=n[l]}catch(x){if(r.WTF)throw x}var o=We.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=Yb(o,gp,_0.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(x){if(r.WTF)throw x}t.HeadingPairs&&t.TitlesOfParts&&(sE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vL(e,t){var r=[],a=[],n=[],l=0,o,u=_b(pp,"n"),h=_b(gp,"n");if(e.Props)for(o=vr(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?a:n).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=vr(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(u,o[l])?r:Object.prototype.hasOwnProperty.call(h,o[l])?a:n).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<n.length;++l)dE.indexOf(n[l][0])>-1||nE.indexOf(n[l][0])>-1||n[l][1]!=null&&x.push(n[l]);a.length&&We.utils.cfb_add(t,"/SummaryInformation",$b(a,_0.SI,h,gp)),(r.length||x.length)&&We.utils.cfb_add(t,"/DocumentSummaryInformation",$b(r,_0.DSI,u,pp,x.length?x:null,_0.UDI))}function l_(e,t){t||(t={}),Ag(t),Kp(),t.codepage&&$p(t.codepage);var r,a;if(e.FullPaths){if(We.find(e,"/encryption"))throw new Error("File is password-protected");r=We.find(e,"!CompObj"),a=We.find(e,"/Workbook")||We.find(e,"/Book")}else{switch(t.type){case"base64":e=Ja(tn(e));break;case"binary":e=Ja(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ta(e,0),a={content:e}}var n,l;if(r&&hL(r),t.bookProps&&!t.bookSheets)n={};else{var o=vt?"buffer":"array";if(a&&a.content)n=pL(a.content,t);else if((l=We.find(e,"PerfectOffice_MAIN"))&&l.content)n=kl.to_workbook(l.content,(t.type=o,t));else if((l=We.find(e,"NativeContent_MAIN"))&&l.content)n=kl.to_workbook(l.content,(t.type=o,t));else throw(l=We.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&We.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=RF(e))}var u={};return e.FullPaths&&gL(e,u,t),n.Props=n.Custprops=u,t.bookFiles&&(n.cfb=e),n}function yL(e,t){var r=t||{},a=We.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return We.utils.cfb_add(a,n,o_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&vL(e,a),r.biff==8&&e.vbaraw&&DF(a,We.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var G0={0:{f:G7},1:{f:Q7},2:{f:pM},3:{f:sM},4:{f:tM},5:{f:hM},6:{f:wM},7:{f:cM},8:{f:CM},9:{f:NM},10:{f:kM},11:{f:TM},12:{f:J7},13:{f:vM},14:{f:lM},15:{f:aM},16:{f:JE},17:{f:EM},18:{f:fM},19:{f:ug},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:E9},40:{},42:{},43:{f:wD},44:{f:yD},45:{f:_D},46:{f:TD},47:{f:kD},48:{},49:{f:W6},50:{},51:{f:iF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:EE},62:{f:bM},63:{f:mF},64:{f:VM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ma,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:UM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$7},148:{f:W7,p:16},151:{f:OM},152:{},153:{f:b9},154:{},155:{},156:{f:v9},157:{},158:{},159:{T:1,f:LR},160:{T:-1},161:{T:1,f:Ul},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:AM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nF},336:{T:-1},337:{f:cF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:SE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:MM},427:{f:LM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Y7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:DM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:TF},633:{T:1},634:{T:-1},635:{T:1,f:_F},636:{T:-1},637:{f:K6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:l9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:qM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ep={6:{f:Am},10:{f:gi},12:{f:Mr},13:{f:Mr},14:{f:Tr},15:{f:Tr},16:{f:ha},17:{f:Tr},18:{f:Tr},19:{f:Mr},20:{f:tw},21:{f:tw},23:{f:SE},24:{f:aw},25:{f:Tr},26:{},27:{},28:{f:q8},29:{},34:{f:Tr},35:{f:rw},38:{f:ha},39:{f:ha},40:{f:ha},41:{f:ha},42:{f:Tr},43:{f:Tr},47:{f:aD},49:{f:v8},51:{f:Mr},60:{},61:{f:h8},64:{f:Tr},65:{f:g8},66:{f:Mr},77:{},80:{},81:{},82:{},85:{f:Mr},89:{},90:{},91:{},92:{f:r8},93:{f:Y8},94:{},95:{f:Tr},96:{},97:{},99:{f:Tr},125:{f:EE},128:{f:F8},129:{f:n8},130:{f:Mr},131:{f:Tr},132:{f:Tr},133:{f:s8},134:{},140:{f:rR},141:{f:Mr},144:{},146:{f:sR},151:{},152:{},153:{},154:{},155:{},156:{f:Mr},157:{},158:{},160:{f:dR},161:{f:oR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:A8},190:{f:j8},193:{f:gi},197:{},198:{},199:{},200:{},201:{},202:{f:Tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mr},220:{},221:{f:Tr},222:{},224:{f:D8},225:{f:t8},226:{f:gi},227:{},229:{f:W8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:l8},253:{f:b8},255:{f:c8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tr},353:{f:gi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:P8},431:{f:Tr},432:{},433:{},434:{},437:{},438:{f:Q8},439:{f:Tr},440:{f:Z8},441:{},442:{f:du},443:{},444:{f:Mr},445:{},446:{},448:{f:gi},449:{f:d8,r:2},450:{f:gi},512:{f:Zb},513:{f:fR},515:{f:L8},516:{f:S8},517:{f:ew},519:{f:hR},520:{f:u8},523:{},545:{f:nw},549:{f:Qb},566:{},574:{f:m8},638:{f:C8},659:{},1048:{},1054:{f:_8},1084:{},1212:{f:H8},2048:{f:eR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:If},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:iR,r:12},2173:{f:rF,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:z8,r:12},2197:{},2198:{f:KD,r:12},2199:{},2200:{},2201:{},2202:{f:G8,r:12},2203:{f:gi},2204:{},2205:{},2206:{},2207:{},2211:{f:f8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:cR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zb},1:{},2:{f:vR},3:{f:pR},4:{f:mR},5:{f:ew},7:{f:bR},8:{},9:{f:If},11:{},22:{f:Mr},30:{f:T8},31:{},32:{},33:{f:nw},36:{},37:{f:Qb},50:{f:wR},62:{},52:{},67:{},68:{f:Mr},69:{},86:{},126:{},127:{f:xR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:SR},223:{},234:{},354:{},421:{},518:{f:Am},521:{f:If},536:{f:aw},547:{f:rw},561:{},579:{},1030:{f:Am},1033:{f:If},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(e,t,r,a){var n=t;if(!isNaN(n)){var l=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,l),l>0&&lg(r)&&e.push(r)}}function bL(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Ie(e,t,r,n);var l=t;if(!isNaN(l)){for(var o=r.parts||[],u=0,h=0,x=0;x+(o[u]||8224)<=8224;)x+=o[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(r.slice(h,h+x)),h+=x;h<n;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[u]||8224)<=8224;)x+=o[u]||8224,u++;m.write_shift(2,x),e.push(r.slice(h,h+x)),h+=x}}}function pu(e,t,r){return e||(e=we(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function wL(e,t,r,a){var n=we(9);return pu(n,e,t),xE(r,a||"b",n),n}function SL(e,t,r){var a=we(8+2*r.length);return pu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function EL(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?zr(rr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ie(e,2,yR(r,a,n)):Ie(e,3,gR(r,a,n));return;case"b":case"e":Ie(e,5,wL(r,a,t.v,t.t));return;case"s":case"str":Ie(e,4,SL(r,a,(t.v||"").slice(0,255)));return}Ie(e,1,pu(null,r,a))}function _L(e,t,r,a){var n=Array.isArray(t),l=Ct(t["!ref"]||"A1"),o,u="",h=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=dt(l)}for(var x=l.s.r;x<=l.e.r;++x){u=Nr(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(h[m]=cr(m)),o=h[m]+u;var g=n?(t[x]||[])[m]:t[o];g&&EL(e,g,x,m)}}}function kL(e,t){for(var r=t||{},a=Ia(),n=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(n=l);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ie(a,r.biff==4?1033:r.biff==3?521:9,gg(e,16,r)),_L(a,e.Sheets[e.SheetNames[n]],n,r),Ie(a,10),a.end()}function TL(e,t,r){Ie(e,49,y8({sz:12,name:"Arial"},r))}function NL(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Ie(e,1054,k8(n,t[n],r))})}function CL(e,t){var r=we(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ie(e,2151,r),r=we(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),yE(Ct(t["!ref"]||"A1"),r),r.write_shift(4,4),Ie(e,2152,r)}function AL(e,t){for(var r=0;r<16;++r)Ie(e,224,Jb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Ie(e,224,Jb(a,0,t))})}function jL(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Ie(e,440,J8(a)),a[1].Tooltip&&Ie(e,2048,tR(a))}delete t["!links"]}function RL(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Ie(e,125,lR(Kd(n,a),n))})}}function DL(e,t,r,a,n){var l=16+Gi(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ie(e,513,Ol(r,a,l));return}if(t.bf)Ie(e,6,n7(t,r,a,n,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?zr(rr(t.v)):t.v;Ie(e,515,B8(r,a,o,l));break;case"b":case"e":Ie(e,517,M8(r,a,t.v,l,n,t.t));break;case"s":case"str":if(n.bookSST){var u=kg(n.Strings,t.v,n.revStrings);Ie(e,253,w8(r,a,u,l))}else Ie(e,516,E8(r,a,(t.v||"").slice(0,255),l,n));break;default:Ie(e,513,Ol(r,a,l))}}function FL(e,t,r){var a=Ia(),n=r.SheetNames[e],l=r.Sheets[n]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[e]||{},h=Array.isArray(l),x=t.biff==8,m,g="",v=[],b=Ct(l["!ref"]||"A1"),y=x?65536:16384;if(b.e.c>255||b.e.r>=y){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,y-1)}Ie(a,2057,gg(r,16,t)),Ie(a,13,yn(1)),Ie(a,12,yn(100)),Ie(a,15,Ea(!0)),Ie(a,17,Ea(!1)),Ie(a,16,Dl(.001)),Ie(a,95,Ea(!0)),Ie(a,42,Ea(!1)),Ie(a,43,Ea(!1)),Ie(a,130,yn(1)),Ie(a,128,O8()),Ie(a,131,Ea(!1)),Ie(a,132,Ea(!1)),x&&RL(a,l["!cols"]),Ie(a,512,N8(b,t)),x&&(l["!links"]=[]);for(var w=b.s.r;w<=b.e.r;++w){g=Nr(w);for(var E=b.s.c;E<=b.e.c;++E){w===b.s.r&&(v[E]=cr(E)),m=v[E]+g;var k=h?(l[w]||[])[E]:l[m];k&&(DL(a,k,w,E,t),x&&k.l&&l["!links"].push([m,k.l]))}}var N=u.CodeName||u.name||n;return x&&Ie(a,574,p8((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Ie(a,229,X8(l["!merges"])),x&&jL(a,l),Ie(a,442,mE(N)),x&&CL(a,l),Ie(a,10),a.end()}function OL(e,t,r){var a=Ia(),n=(e||{}).Workbook||{},l=n.Sheets||[],o=n.WBProps||{},u=r.biff==8,h=r.biff==5;if(Ie(a,2057,gg(e,5,r)),r.bookType=="xla"&&Ie(a,135),Ie(a,225,u?yn(1200):null),Ie(a,193,Mj(2)),h&&Ie(a,191),h&&Ie(a,192),Ie(a,226),Ie(a,92,a8("SheetJS",r)),Ie(a,66,yn(u?1200:1252)),u&&Ie(a,353,yn(0)),u&&Ie(a,448),Ie(a,317,uR(e.SheetNames.length)),u&&e.vbaraw&&Ie(a,211),u&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Ie(a,442,mE(x))}Ie(a,156,yn(17)),Ie(a,25,Ea(!1)),Ie(a,18,Ea(!1)),Ie(a,19,yn(0)),u&&Ie(a,431,Ea(!1)),u&&Ie(a,444,yn(0)),Ie(a,61,x8()),Ie(a,64,Ea(!1)),Ie(a,141,yn(0)),Ie(a,34,Ea(d9(e)=="true")),Ie(a,14,Ea(!0)),u&&Ie(a,439,Ea(!1)),Ie(a,218,yn(0)),TL(a,e,r),NL(a,e.SSF,r),AL(a,r),u&&Ie(a,352,Ea(!1));var m=a.end(),g=Ia();u&&Ie(g,140,aR()),u&&r.Strings&&bL(g,252,o8(r.Strings)),Ie(g,10);var v=g.end(),b=Ia(),y=0,w=0;for(w=0;w<e.SheetNames.length;++w)y+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var E=m.length+y+v.length;for(w=0;w<e.SheetNames.length;++w){var k=l[w]||{};Ie(b,133,i8({pos:E,hs:k.Hidden||0,dt:0,name:e.SheetNames[w]},r)),E+=t[w].length}var N=b.end();if(y!=N.length)throw new Error("BS8 "+y+" != "+N.length);var _=[];return m.length&&_.push(m),N.length&&_.push(N),v.length&&_.push(v),Xr(_)}function ML(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=ar(et)),e&&e.SSF&&(lc(),Gd(e.SSF),r.revssf=qd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,jg(r),r.cellXfs=[],Gi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=FL(n,r,e);return a.unshift(OL(e,a,r)),Xr(a)}function o_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ua(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return ML(e,t);case 4:case 3:case 2:return kL(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function xw(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=n.index,u=l&&l.index||e.length,h=y6(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,g=0,v=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(o=0;o<h.length;++o){var w=h[o].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++x,r.sheetRows&&r.sheetRows<=x){--x;break}m=0;continue}if(!(E!="<td"&&E!="<th")){var k=w.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var N=k[u].trim();if(N.match(/<t[dh]/i)){for(var _=N,R=0;_.charAt(0)=="<"&&(R=_.indexOf(">"))>-1;)_=_.slice(R+1);for(var A=0;A<y.length;++A){var D=y[A];D.s.c==m&&D.s.r<x&&x<=D.e.r&&(m=D.e.c+1,A=-1)}var T=nt(N.slice(0,N.indexOf(">")));v=T.colspan?+T.colspan:1,((g=+T.rowspan)>1||v>1)&&y.push({s:{r:x,c:m},e:{r:x+(g||1)-1,c:m+v-1}});var F=T.t||T["data-t"]||"";if(!_.length){m+=v;continue}if(_=D4(_),b.s.r>x&&(b.s.r=x),b.e.r<x&&(b.e.r=x),b.s.c>m&&(b.s.c=m),b.e.c<m&&(b.e.c=m),!_.length){m+=v;continue}var O={t:"s",v:_};r.raw||!_.trim().length||F=="s"||(_==="TRUE"?O={t:"b",v:!0}:_==="FALSE"?O={t:"b",v:!1}:isNaN(Un(_))?isNaN($o(_).getDate())||(O={t:"d",v:rr(_)},r.cellDates||(O={t:"n",v:zr(O.v)}),O.z=r.dateNF||et[14]):O={t:"n",v:Un(_)}),r.dense?(a[x]||(a[x]=[]),a[x][m]=O):a[tt({r:x,c:m})]=O,m+=v}}}}return a["!ref"]=dt(b),y.length&&(a["!merges"]=y),a}function LL(e,t,r,a){for(var n=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,h=0,x=0;x<n.length;++x)if(!(n[x].s.r>r||n[x].s.c>o)&&!(n[x].e.r<r||n[x].e.c<o)){if(n[x].s.r<r||n[x].s.c<o){u=-1;break}u=n[x].e.r-n[x].s.r+1,h=n[x].e.c-n[x].s.c+1;break}if(!(u<0)){var m=tt({r,c:o}),g=a.dense?(e[r]||[])[o]:e[m],v=g&&g.v!=null&&(g.h||ng(g.w||(Ps(g),g.w)||""))||"",b={};u>1&&(b.rowspan=u),h>1&&(b.colspan=h),a.editable?v='<span contenteditable="true">'+v+"</span>":g&&(b["data-t"]=g&&g.t||"z",g.v!=null&&(b["data-v"]=g.v),g.z!=null&&(b["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),b.id=(a.id||"sjs")+"-"+m,l.push(Be("td",v,b))}}var y="<tr>";return y+l.join("")+"</tr>"}var BL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PL="</body></html>";function IL(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Hi(xw(r[0],t),t);var a=Fg();return r.forEach(function(n,l){Og(a,xw(n,t),"Sheet"+(l+1))}),a}function UL(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function c_(e,t){var r=t||{},a=r.header!=null?r.header:BL,n=r.footer!=null?r.footer:PL,l=[a],o=Ua(e["!ref"]);r.dense=Array.isArray(e),l.push(UL(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(LL(e,o,u,r));return l.push("</table>"+n),l.join("")}function u_(e,t,r){var a=r||{},n=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?ur(a.origin):a.origin;n=o.r,l=o.c}var u=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,u.length),x={s:{r:0,c:0},e:{r:n,c:l}};if(e["!ref"]){var m=Ua(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),n==-1&&(x.e.r=n=m.e.r+1)}var g=[],v=0,b=e["!rows"]||(e["!rows"]=[]),y=0,w=0,E=0,k=0,N=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<u.length&&w<h;++y){var R=u[y];if(mw(R)){if(a.display)continue;b[w]={hidden:!0}}var A=R.children;for(E=k=0;E<A.length;++E){var D=A[E];if(!(a.display&&mw(D))){var T=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):D4(D.innerHTML),F=D.getAttribute("data-z")||D.getAttribute("z");for(v=0;v<g.length;++v){var O=g[v];O.s.c==k+l&&O.s.r<w+n&&w+n<=O.e.r&&(k=O.e.c+1-l,v=-1)}_=+D.getAttribute("colspan")||1,((N=+D.getAttribute("rowspan")||1)>1||_>1)&&g.push({s:{r:w+n,c:k+l},e:{r:w+n+(N||1)-1,c:k+l+(_||1)-1}});var U={t:"s",v:T},q=D.getAttribute("data-t")||D.getAttribute("t")||"";T!=null&&(T.length==0?U.t=q||"z":a.raw||T.trim().length==0||q=="s"||(T==="TRUE"?U={t:"b",v:!0}:T==="FALSE"?U={t:"b",v:!1}:isNaN(Un(T))?isNaN($o(T).getDate())||(U={t:"d",v:rr(T)},a.cellDates||(U={t:"n",v:zr(U.v)}),U.z=a.dateNF||et[14]):U={t:"n",v:Un(T)})),U.z===void 0&&F!=null&&(U.z=F);var z="",te=D.getElementsByTagName("A");if(te&&te.length)for(var ce=0;ce<te.length&&!(te[ce].hasAttribute("href")&&(z=te[ce].getAttribute("href"),z.charAt(0)!="#"));++ce);z&&z.charAt(0)!="#"&&(U.l={Target:z}),a.dense?(e[w+n]||(e[w+n]=[]),e[w+n][k+l]=U):e[tt({c:k+l,r:w+n})]=U,x.e.c<k+l&&(x.e.c=k+l),k+=_}}++w}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),x.e.r=Math.max(x.e.r,w-1+n),e["!ref"]=dt(x),w>=h&&(e["!fullref"]=dt((x.e.r=u.length-y+w-1+n,x))),e}function f_(e,t){var r=t||{},a=r.dense?[]:{};return u_(a,e,t)}function zL(e,t){return Hi(f_(e,t),t)}function mw(e){var t="",r=HL(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function HL(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function GL(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var pw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function d_(e,t){var r=t||{},a=sg(e),n=[],l,o,u={name:""},h="",x=0,m,g,v={},b=[],y=r.dense?[]:{},w,E,k={value:""},N="",_=0,R=[],A=-1,D=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,O={},U=[],q={},z=0,te=0,ce=[],de=1,ee=1,ie=[],Te={Names:[]},ne={},B=["",""],Z=[],L={},G="",V=0,Q=!1,le=!1,_e=0;for(B0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=B0.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?y["!ref"]=dt(T):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(y["!fullref"]=y["!ref"],T.e.r=r.sheetRows-1,y["!ref"]=dt(T)),U.length&&(y["!merges"]=U),ce.length&&(y["!rows"]=ce),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),b.push(m.name),v[m.name]=y,le=!1):w[0].charAt(w[0].length-2)!=="/"&&(m=nt(w[0],!1),A=D=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,y=r.dense?[]:{},U=[],ce=[],le=!0);break;case"table-row-group":w[1]==="/"?--F:++F;break;case"table-row":case"":if(w[1]==="/"){A+=de,de=1;break}if(g=nt(w[0],!1),g.?A=g.-1:A==-1&&(A=0),de=+g["number-rows-repeated"]||1,de<10)for(_e=0;_e<de;++_e)F>0&&(ce[A+_e]={level:F});D=-1;break;case"covered-table-cell":w[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(y[A]||(y[A]=[]),y[A][D]={t:"z"}):y[tt({r:A,c:D})]={t:"z"}),N="",R=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++D,k=nt(w[0],!1),ee=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=fw(Nt(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=Nt(k["string-value"]||""),r.dense?(y[A]||(y[A]=[]),y[A][D]=E):y[tt({r:A,c:D})]=E),D+=ee-1;else if(w[1]!=="/"){++D,N="",_=0,R=[],ee=1;var Ee=de?A+de-1:A;if(D>T.e.c&&(T.e.c=D),D<T.s.c&&(T.s.c=D),A<T.s.r&&(T.s.r=A),Ee>T.e.r&&(T.e.r=Ee),k=nt(w[0],!1),Z=[],L={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Nt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(z=parseInt(k["number-matrix-rows-spanned"],10)||0,te=parseInt(k["number-matrix-columns-spanned"],10)||0,q={s:{r:A,c:D},e:{r:A+z-1,c:D+te-1}},E.F=dt(q),ie.push([q,E.F])),k.formula)E.f=fw(k.formula);else for(_e=0;_e<ie.length;++_e)A>=ie[_e][0].s.r&&A<=ie[_e][0].e.r&&D>=ie[_e][0].s.c&&D<=ie[_e][0].e.c&&(E.F=ie[_e][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(z=parseInt(k["number-rows-spanned"],10)||0,te=parseInt(k["number-columns-spanned"],10)||0,q={s:{r:A,c:D},e:{r:A+z-1,c:D+te-1}},U.push(q)),k["number-columns-repeated"]&&(ee=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=tr(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=rr(k["date-value"]),r.cellDates||(E.t="n",E.v=zr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=p6(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Wd(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(N=Nt(k["string-value"]),R=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Q=!1,E.t==="s"&&(E.v=N||"",R.length&&(E.R=R),Q=_==0),ne.Target&&(E.l=ne),Z.length>0&&(E.c=Z,Z=[]),N&&r.cellText!==!1&&(E.w=N),Q&&(E.t="z",delete E.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var Ne=0;Ne<de;++Ne){if(ee=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(y[A+Ne]||(y[A+Ne]=[]),y[A+Ne][D]=Ne==0?E:ar(E);--ee>0;)y[A+Ne][D+ee]=ar(E);else for(y[tt({r:A+Ne,c:D})]=E;--ee>0;)y[tt({r:A+Ne,c:D+ee})]=ar(E);T.e.c<=D&&(T.e.c=D)}ee=parseInt(k["number-columns-repeated"]||"1",10),D+=ee-1,ee=0,E={},N="",R=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l;L.t=N,R.length&&(L.R=R),L.a=G,Z.push(L)}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);G="",V=0,N="",_=0,R=[];break;case"creator":w[1]==="/"?G=a.slice(V,w.index):V=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);N="",_=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(O[u.name]=h,(l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=nt(w[0],!1),n.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=nt(w[0],!1),h+=pw[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=nt(w[0],!1),h+=pw[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(x,w.index);break}else x=w.index+w[0].length;break;case"named-range":o=nt(w[0],!1),B=jm(o["cell-range-address"]);var Re={Name:o.name,Ref:B[0]+"!"+B[1]};le&&(Re.Sheet=b.length),Te.Names.push(Re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(w[1]==="/"&&(!k||!k["string-value"])){var Ze=GL(a.slice(_,w.index));N=(N.length>0?N+`
`:"")+Ze[0]}else nt(w[0],!1),_=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{B=jm(nt(w[0])["target-range-address"]),v[B[0]]["!autofilter"]={ref:B[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ne=nt(w[0],!1),!ne.href)break;ne.Target=Nt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(B=jm(ne.Target.slice(1)),ne.Target="#"+B[0]+"!"+B[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var K={Sheets:v,SheetNames:b,Workbook:Te};return r.bookSheets&&delete K.Sheets,K}function gw(e,t){t=t||{},gn(e,"META-INF/manifest.xml")&&pj(Or(e,"META-INF/manifest.xml"),t);var r=en(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=d_(qt(r),t);return gn(e,"meta.xml")&&(a.Props=rE(Or(e,"meta.xml"))),a}function vw(e,t){return d_(e,t)}var VL=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+L0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ar+t}}(),yw=function(){var e=function(l){return It(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,o,u){var h=[];h.push('      <table:table table:name="'+It(o.SheetNames[u])+`" table:style-name="ta1">
`);var x=0,m=0,g=Ua(l["!ref"]||"A1"),v=l["!merges"]||[],b=0,y=Array.isArray(l);if(l["!cols"])for(m=0;m<=g.e.c;++m)h.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",E=l["!rows"]||[];for(x=0;x<g.s.r;++x)w=E[x]?' table:style-name="ro'+E[x].ods+'"':"",h.push("        <table:table-row"+w+`></table:table-row>
`);for(;x<=g.e.r;++x){for(w=E[x]?' table:style-name="ro'+E[x].ods+'"':"",h.push("        <table:table-row"+w+`>
`),m=0;m<g.s.c;++m)h.push(t);for(;m<=g.e.c;++m){var k=!1,N={},_="";for(b=0;b!=v.length;++b)if(!(v[b].s.c>m)&&!(v[b].s.r>x)&&!(v[b].e.c<m)&&!(v[b].e.r<x)){(v[b].s.c!=m||v[b].s.r!=x)&&(k=!0),N["table:number-columns-spanned"]=v[b].e.c-v[b].s.c+1,N["table:number-rows-spanned"]=v[b].e.r-v[b].s.r+1;break}if(k){h.push(r);continue}var R=tt({r:x,c:m}),A=y?(l[x]||[])[m]:l[R];if(A&&A.f&&(N["table:formula"]=It(u7(A.f)),A.F&&A.F.slice(0,R.length)==R)){var D=Ua(A.F);N["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,N["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!A){h.push(t);continue}switch(A.t){case"b":_=A.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=A.v?"true":"false";break;case"n":_=A.w||String(A.v||0),N["office:value-type"]="float",N["office:value"]=A.v||0;break;case"s":case"str":_=A.v==null?"":A.v,N["office:value-type"]="string";break;case"d":_=A.w||rr(A.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=rr(A.v).toISOString(),N["table:style-name"]="ce1";break;default:h.push(t);continue}var T=e(_);if(A.l&&A.l.Target){var F=A.l.Target;F=F.charAt(0)=="#"?"#"+f7(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),T=Be("text:a",T,{"xlink:href":F.replace(/&/g,"&amp;")})}h.push("          "+Be("table:table-cell",Be("text:p",T,{}),N)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},n=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var g=x["!cols"][m];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Bi(g),g.ods=u;var v=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++u}}});var h=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=h;var g=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++h}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,u){var h=[Ar],x=L0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=L0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+x+m+`>
`),h.push(tE().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+x+`>
`),n(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)h.push(a(o.Sheets[o.SheetNames[g]],o,g));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}}();function h_(e,t){if(t.bookType=="fods")return yw(e,t);var r=tg(),a="",n=[],l=[];return a="mimetype",xt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",xt(r,a,yw(e,t)),n.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",xt(r,a,VL(e,t)),n.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",xt(r,a,Ar+tE()),n.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",xt(r,a,yj(l)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",xt(r,a,gj(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ml(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _p(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(zi(e))}function qL(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ja(is(e))}function WL(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Ii(e){var t=e.reduce(function(n,l){return n+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function bw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function XL(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function YL(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;n>=1;++l,n/=256)e[t+l]=n&255;e[t+15]|=r>=0?0:128}function V0(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Bt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function gr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Rt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=V0(e,r),l=n&7;n=Math.floor(n/8);var o=0,u;if(n==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=V0(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(n," at offset ").concat(a))}var x={data:u,type:l};t[n]==null?t[n]=[x]:t[n].push(x)}return t}function ea(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Bt(a*8+n.type)),n.type==2&&t.push(Bt(n.data.length)),t.push(n.data))})}),Ii(t)}function Cg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function mn(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=V0(e,a),l=Rt(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:gr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Rt(u.data),x=gr(h[3][0].data);o.messages.push({meta:h,data:e.slice(a[0],a[0]+x)}),a[0]+=x}),(t=l[3])!=null&&t[0]&&(o.merge=gr(l[3][0].data)>>>0>0),r.push(o)}return r}function ko(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Bt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Bt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Bt(o.data.length)}],a[2].push({data:ea(o.meta),type:2})});var l=ea(a);t.push(Bt(l.length)),t.push(l),n.forEach(function(o){return t.push(o)})}),Ii(t)}function $L(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=V0(t,r),n=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,x=0;if(l==1?(x=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(x=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Ii(n)],h==0)throw new Error("Invalid offset 0");if(h>n[0].length)throw new Error("Invalid offset beyond length");if(x>=h)for(n.push(n[0].slice(-h)),x-=h;x>=n[n.length-1].length;)n.push(n[n.length-1]),x-=n[n.length-1].length;n.push(n[0].slice(-h,-h+x))}}var m=Ii(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function pn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push($L(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ii(t)}function To(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var l=Bt(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Ii(t)}function KL(e,t,r,a){var n=Ml(e),l=n.getUint32(4,!0),o=(a>1?12:8)+bw(l&(a>1?3470:398))*4,u=-1,h=-1,x=NaN,m=new Date(2001,0,1);l&512&&(u=n.getUint32(o,!0),o+=4),o+=bw(l&(a>1?12288:4096))*4,l&16&&(h=n.getUint32(o,!0),o+=4),l&32&&(x=n.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var g;switch(e[2]){case 0:break;case 2:g={t:"n",v:x};break;case 3:g={t:"s",v:t[h]};break;case 5:g={t:"d",v:m};break;case 6:g={t:"b",v:x>0};break;case 7:g={t:"n",v:x/86400};break;case 8:g={t:"e",v:0};break;case 9:if(u>-1)g={t:"s",v:r[u]};else if(h>-1)g={t:"s",v:t[h]};else if(!isNaN(x))g={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return g}function QL(e,t,r){var a=Ml(e),n=a.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,x=NaN,m=new Date(2001,0,1);n&1&&(h=XL(e,l),l+=16),n&2&&(x=a.getFloat64(l,!0),l+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8),n&8&&(u=a.getUint32(l,!0),l+=4),n&16&&(o=a.getUint32(l,!0),l+=4);var g;switch(e[1]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:t[u]};break;case 5:g={t:"d",v:m};break;case 6:g={t:"b",v:x>0};break;case 7:g={t:"n",v:x/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:g={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return g}function Dm(e,t){var r=new Uint8Array(32),a=Ml(r),n=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,YL(r,n,e.v),l|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),l|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,n)}function Fm(e,t){var r=new Uint8Array(32),a=Ml(r),n=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),l|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),l|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,n)}function ZL(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return KL(e,t,r,e[0]);case 5:return QL(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ca(e){var t=Rt(e);return V0(t[1][0].data)}function ww(e,t){var r=Rt(t.data),a=gr(r[1][0].data),n=r[3],l=[];return(n||[]).forEach(function(o){var u=Rt(o.data),h=gr(u[1][0].data)>>>0;switch(a){case 1:l[h]=_p(u[3][0].data);break;case 8:{var x=e[ca(u[9][0].data)][0],m=Rt(x.data),g=e[ca(m[1][0].data)][0],v=gr(g.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var b=Rt(g.data);l[h]=b[3].map(function(y){return _p(y.data)}).join("")}break}}),l}function JL(e,t){var r,a,n,l,o,u,h,x,m,g,v,b,y,w,E=Rt(e),k=gr(E[1][0].data)>>>0,N=gr(E[2][0].data)>>>0,_=((a=(r=E[8])==null?void 0:r[0])==null?void 0:a.data)&&gr(E[8][0].data)>0||!1,R,A;if((l=(n=E[7])==null?void 0:n[0])!=null&&l.data&&t!=0)R=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,A=(x=(h=E[6])==null?void 0:h[0])==null?void 0:x.data;else if((g=(m=E[4])==null?void 0:m[0])!=null&&g.data&&t!=1)R=(b=(v=E[4])==null?void 0:v[0])==null?void 0:b.data,A=(w=(y=E[3])==null?void 0:y[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=_?4:1,T=Ml(R),F=[],O=0;O<R.length/2;++O){var U=T.getUint16(O*2,!0);U<65535&&F.push([O,U])}if(F.length!=N)throw"Expected ".concat(N," cells, found ").concat(F.length);var q=[];for(O=0;O<F.length-1;++O)q[F[O][0]]=A.subarray(F[O][1]*D,F[O+1][1]*D);return F.length>=1&&(q[F[F.length-1][0]]=A.subarray(F[F.length-1][1]*D)),{R:k,cells:q}}function eB(e,t){var r,a=Rt(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?gr(a[7][0].data)>>>0>0?1:0:-1,l=Cg(a[5],function(o){return JL(o,n)});return{nrows:gr(a[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,x){if(o[u.R][x])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(x));o[u.R][x]=h}),o},[])}}function tB(e,t,r){var a,n=Rt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(gr(n[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(l.e.c=(gr(n[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=dt(l);var o=Rt(n[4][0].data),u=ww(e,e[ca(o[4][0].data)][0]),h=(a=o[17])!=null&&a[0]?ww(e,e[ca(o[17][0].data)][0]):[],x=Rt(o[3][0].data),m=0;x[1].forEach(function(g){var v=Rt(g.data),b=e[ca(v[2][0].data)][0],y=gr(b.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var w=eB(e,b);w.data.forEach(function(E,k){E.forEach(function(N,_){var R=tt({r:m+k,c:_}),A=ZL(N,u,h);A&&(r[R]=A)})}),m+=w.nrows})}function rB(e,t){var r=Rt(t.data),a={"!ref":"A1"},n=e[ca(r[2][0].data)],l=gr(n[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return tB(e,n[0],a),a}function aB(e,t){var r,a=Rt(t.data),n={name:(r=a[1])!=null&&r[0]?_p(a[1][0].data):"",sheets:[]},l=Cg(a[2],ca);return l.forEach(function(o){e[o].forEach(function(u){var h=gr(u.meta[1][0].data);h==6e3&&n.sheets.push(rB(e,u))})}),n}function nB(e,t){var r=Fg(),a=Rt(t.data),n=Cg(a[1],ca);if(n.forEach(function(l){e[l].forEach(function(o){var u=gr(o.meta[1][0].data);if(u==2){var h=aB(e,o);h.sheets.forEach(function(x,m){Og(r,x,m==0?h.name:h.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Om(e){var t,r,a,n,l={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var x;try{x=pn(h.content)}catch(g){return console.log("?? "+h.content.length+" "+(g.message||g))}var m;try{m=mn(x)}catch(g){return console.log("## "+(g.message||g))}m.forEach(function(g){l[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var u=((n=(a=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&gr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(x){var m=gr(x.meta[1][0].data)>>>0;if(m==1)if(!u)u=x;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return nB(l,u)}function sB(e,t,r){var a,n,l,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&gr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,x=Ml(e[7][0].data),m=0,g=[],v=Ml(e[4][0].data),b=0,y=[],w=0;w<t.length;++w){if(t[w]==null){x.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}x.setUint16(w*2,m,!0),v.setUint16(w*2,b,!0);var E,k;switch(typeof t[w]){case"string":E=Dm({t:"s",v:t[w]},r),k=Fm({t:"s",v:t[w]},r);break;case"number":E=Dm({t:"n",v:t[w]},r),k=Fm({t:"n",v:t[w]},r);break;case"boolean":E=Dm({t:"b",v:t[w]},r),k=Fm({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}g.push(E),m+=E.length,y.push(k),b+=k.length,++h}for(e[2][0].data=Bt(h);w<e[7][0].data.length/2;++w)x.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return e[6][0].data=Ii(g),e[3][0].data=Ii(y),h}function iB(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ua(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(dt(a)));var l=Td(r,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(G){return G.forEach(function(V){typeof V=="string"&&o.push(V)})});var u={},h=[],x=We.read(t.numbers,{type:"base64"});x.FileIndex.map(function(G,V){return[G,x.FullPaths[V]]}).forEach(function(G){var V=G[0],Q=G[1];if(V.type==2&&V.name.match(/\.iwa/)){var le=V.content,_e=pn(le),Ee=mn(_e);Ee.forEach(function(Ne){h.push(Ne.id),u[Ne.id]={deps:[],location:Q,type:gr(Ne.messages[0].meta[1][0].data)}})}}),h.sort(function(G,V){return G-V});var m=h.filter(function(G){return G>1}).map(function(G){return[G,Bt(G)]});x.FileIndex.map(function(G,V){return[G,x.FullPaths[V]]}).forEach(function(G){var V=G[0];if(G[1],!!V.name.match(/\.iwa/)){var Q=mn(pn(V.content));Q.forEach(function(le){le.messages.forEach(function(_e){m.forEach(function(Ee){le.messages.some(function(Ne){return gr(Ne.meta[1][0].data)!=11006&&WL(Ne.data,Ee[1])})&&u[Ee[0]].deps.push(le.id)})})})}});for(var g=We.find(x,u[1].location),v=mn(pn(g.content)),b,y=0;y<v.length;++y){var w=v[y];w.id==1&&(b=w)}var E=ca(Rt(b.messages[0].data)[1][0].data);for(g=We.find(x,u[E].location),v=mn(pn(g.content)),y=0;y<v.length;++y)w=v[y],w.id==E&&(b=w);for(E=ca(Rt(b.messages[0].data)[2][0].data),g=We.find(x,u[E].location),v=mn(pn(g.content)),y=0;y<v.length;++y)w=v[y],w.id==E&&(b=w);for(E=ca(Rt(b.messages[0].data)[2][0].data),g=We.find(x,u[E].location),v=mn(pn(g.content)),y=0;y<v.length;++y)w=v[y],w.id==E&&(b=w);var k=Rt(b.messages[0].data);{k[6][0].data=Bt(a.e.r+1),k[7][0].data=Bt(a.e.c+1);var N=ca(k[46][0].data),_=We.find(x,u[N].location),R=mn(pn(_.content));{for(var A=0;A<R.length&&R[A].id!=N;++A);if(R[A].id!=N)throw"Bad ColumnRowUIDMapArchive";var D=Rt(R[A].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var T=0;T<=a.e.c;++T){var F=[];F[1]=F[2]=[{type:0,data:Bt(T+420690)}],D[1].push({type:2,data:ea(F)}),D[2].push({type:0,data:Bt(T)}),D[3].push({type:0,data:Bt(T)})}D[4]=[],D[5]=[],D[6]=[];for(var O=0;O<=a.e.r;++O)F=[],F[1]=F[2]=[{type:0,data:Bt(O+726270)}],D[4].push({type:2,data:ea(F)}),D[5].push({type:0,data:Bt(O)}),D[6].push({type:0,data:Bt(O)});R[A].messages[0].data=ea(D)}_.content=To(ko(R)),_.size=_.content.length,delete k[46];var U=Rt(k[4][0].data);{U[7][0].data=Bt(a.e.r+1);var q=Rt(U[1][0].data),z=ca(q[2][0].data);_=We.find(x,u[z].location),R=mn(pn(_.content));{if(R[0].id!=z)throw"Bad HeaderStorageBucket";var te=Rt(R[0].messages[0].data);for(O=0;O<l.length;++O){var ce=Rt(te[2][0].data);ce[1][0].data=Bt(O),ce[4][0].data=Bt(l[O].length),te[2][O]={type:te[2][0].type,data:ea(ce)}}R[0].messages[0].data=ea(te)}_.content=To(ko(R)),_.size=_.content.length;var de=ca(U[2][0].data);_=We.find(x,u[de].location),R=mn(pn(_.content));{if(R[0].id!=de)throw"Bad HeaderStorageBucket";for(te=Rt(R[0].messages[0].data),T=0;T<=a.e.c;++T)ce=Rt(te[2][0].data),ce[1][0].data=Bt(T),ce[4][0].data=Bt(a.e.r+1),te[2][T]={type:te[2][0].type,data:ea(ce)};R[0].messages[0].data=ea(te)}_.content=To(ko(R)),_.size=_.content.length;var ee=ca(U[4][0].data);(function(){for(var G=We.find(x,u[ee].location),V=mn(pn(G.content)),Q,le=0;le<V.length;++le){var _e=V[le];_e.id==ee&&(Q=_e)}var Ee=Rt(Q.messages[0].data);{Ee[3]=[];var Ne=[];o.forEach(function(K,Ae){Ne[1]=[{type:0,data:Bt(Ae)}],Ne[2]=[{type:0,data:Bt(1)}],Ne[3]=[{type:2,data:qL(K)}],Ee[3].push({type:2,data:ea(Ne)})})}Q.messages[0].data=ea(Ee);var Re=ko(V),Ze=To(Re);G.content=Ze,G.size=G.content.length})();var ie=Rt(U[3][0].data);{var Te=ie[1][0];delete ie[2];var ne=Rt(Te.data);{var B=ca(ne[2][0].data);(function(){for(var G=We.find(x,u[B].location),V=mn(pn(G.content)),Q,le=0;le<V.length;++le){var _e=V[le];_e.id==B&&(Q=_e)}var Ee=Rt(Q.messages[0].data);{delete Ee[6],delete ie[7];var Ne=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var Re=0,Ze=0;Ze<=a.e.r;++Ze){var K=Rt(Ne);Re+=sB(K,l[Ze],o),K[1][0].data=Bt(Ze),Ee[5].push({data:ea(K),type:2})}Ee[1]=[{type:0,data:Bt(a.e.c+1)}],Ee[2]=[{type:0,data:Bt(a.e.r+1)}],Ee[3]=[{type:0,data:Bt(Re)}],Ee[4]=[{type:0,data:Bt(a.e.r+1)}]}Q.messages[0].data=ea(Ee);var Ae=ko(V),lt=To(Ae);G.content=lt,G.size=G.content.length})()}Te.data=ea(ne)}U[3][0].data=ea(ie)}k[4][0].data=ea(U)}b.messages[0].data=ea(k);var Z=ko(v),L=To(Z);return g.content=L,g.size=g.content.length,x}function x_(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Ag(e){x_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function jg(e){x_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function lB(e){return bt.WS.indexOf(e)>-1?"sheet":e==bt.CS?"chart":e==bt.DS?"dialog":e==bt.MS?"macro":e&&e.length?e:"sheet"}function oB(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,lB(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function cB(e,t,r,a,n,l,o,u,h,x,m,g){try{l[a]=b0(en(e,r,!0),t);var v=Or(e,t),b;switch(u){case"sheet":b=R9(v,t,n,h,l[a],x,m,g);break;case"chart":if(b=D9(v,t,n,h,l[a],x,m,g),!b||!b["!drawel"])break;var y=p0(b["!drawel"].Target,t),w=P0(y),E=vF(en(e,y,!0),b0(en(e,w,!0),y)),k=p0(E,y),N=P0(k);b=s9(en(e,k,!0),k,h,b0(en(e,N,!0),k),x,b);break;case"macro":b=F9(v,t,n,h,l[a],x,m,g);break;case"dialog":b=O9(v,t,n,h,l[a],x,m,g);break;default:throw new Error("Unrecognized sheet type "+u)}o[a]=b;var _=[];l&&l[a]&&vr(l[a]).forEach(function(R){var A="";if(l[a][R].Type==bt.CMNT){A=p0(l[a][R].Target,t);var D=P9(Or(e,A,!0),A,h);if(!D||!D.length)return;iw(b,D,!1)}l[a][R].Type==bt.TCMNT&&(A=p0(l[a][R].Target,t),_=_.concat(bF(Or(e,A,!0),h)))}),_&&_.length&&iw(b,_,!0,h.people||[])}catch(R){if(h.WTF)throw R}}function hn(e){return e.charAt(0)=="/"?e.slice(1):e}function uB(e,t){if(lc(),t=t||{},Ag(t),gn(e,"META-INF/manifest.xml")||gn(e,"objectdata.xml"))return gw(e,t);if(gn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Om<"u"){if(e.FileIndex)return Om(e);var r=We.utils.cfb_new();return Nb(e).forEach(function(ce){xt(r,ce,w6(e,ce))}),Om(r)}throw new Error("Unsupported NUMBERS file")}if(!gn(e,"[Content_Types].xml"))throw gn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Nb(e),n=xj(en(e,"[Content_Types].xml")),l=!1,o,u;if(n.workbooks.length===0&&(u="xl/workbook.xml",Or(e,u,!0)&&n.workbooks.push(u)),n.workbooks.length===0){if(u="xl/workbook.bin",!Or(e,u,!0))throw new Error("Could not find workbook");n.workbooks.push(u),l=!0}n.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},x={};if(!t.bookSheets&&!t.bookProps){if(w0=[],n.sst)try{w0=B9(Or(e,hn(n.sst)),n.sst,t)}catch(ce){if(t.WTF)throw ce}t.cellStyles&&n.themes.length&&(h=L9(en(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(x=M9(Or(e,hn(n.style)),n.style,h,t))}n.links.map(function(ce){try{var de=b0(en(e,P0(hn(ce))),ce);return U9(Or(e,hn(ce)),de,ce,t)}catch{}});var m=j9(Or(e,hn(n.workbooks[0])),n.workbooks[0],t),g={},v="";n.coreprops.length&&(v=Or(e,hn(n.coreprops[0]),!0),v&&(g=rE(v)),n.extprops.length!==0&&(v=Or(e,hn(n.extprops[0]),!0),v&&wj(v,g,t)));var b={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(v=en(e,hn(n.custprops[0]),!0),v&&(b=Ej(v,t)));var y={};if((t.bookSheets||t.bookProps)&&(m.Sheets?o=m.Sheets.map(function(de){return de.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),t.bookProps&&(y.Props=g,y.Custprops=b),t.bookSheets&&typeof o<"u"&&(y.SheetNames=o),t.bookSheets?y.SheetNames:t.bookProps))return y;o={};var w={};t.bookDeps&&n.calcchain&&(w=I9(Or(e,hn(n.calcchain)),n.calcchain));var E=0,k={},N,_;{var R=m.Sheets;g.Worksheets=R.length,g.SheetNames=[];for(var A=0;A!=R.length;++A)g.SheetNames[A]=R[A].name}var D=l?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),F=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");gn(e,F)||(F="xl/_rels/workbook."+D+".rels");var O=b0(en(e,F,!0),F.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=z9(Or(e,hn(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=SF(Or(e,hn(n.people[0])),t)),O&&(O=oB(O,m.Sheets));var U=Or(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=g.Worksheets;++E){var q="sheet";if(O&&O[E]?(N="xl/"+O[E][1].replace(/[\/]?xl\//,""),gn(e,N)||(N=O[E][1]),gn(e,N)||(N=F.replace(/_rels\/.*$/,"")+O[E][1]),q=O[E][2]):(N="xl/worksheets/sheet"+(E+1-U)+"."+D,N=N.replace(/sheet0\./,"sheet.")),_=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(g.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,te=0;te!=t.sheets.length;++te)typeof t.sheets[te]=="number"&&t.sheets[te]==E&&(z=1),typeof t.sheets[te]=="string"&&t.sheets[te].toLowerCase()==g.SheetNames[E].toLowerCase()&&(z=1);if(!z)continue e}}cB(e,N,_,g.SheetNames[E],E,k,o,q,t,m,h,x)}return y={Directory:n,Workbook:m,Props:g,Custprops:b,Deps:w,Sheets:o,SheetNames:g.SheetNames,Strings:w0,Styles:x,Themes:h,SSF:ar(et)},t&&t.bookFiles&&(e.files?(y.keys=a,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(ce,de){ce=ce.replace(/^Root Entry[\/]/,""),y.keys.push(ce),y.files[ce]=e.FileIndex[de]}))),t&&t.bookVBA&&(n.vba.length>0?y.vbaraw=Or(e,hn(n.vba[0]),!0):n.defaults&&n.defaults.bin===jF&&(y.vbaraw=Or(e,"xl/vbaProject.bin",!0))),y}function fB(e,t){var r=t||{},a="Workbook",n=We.find(e,a);try{if(a="/!DataSpaces/Version",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(zR(n.content),a="/!DataSpaces/DataSpaceMap",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=GR(n.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=VR(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);WR(n.content)}catch{}if(a="/EncryptionInfo",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=XR(n.content);if(a="/EncryptedPackage",n=We.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],n.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function dB(e,t){return t.bookType=="ods"?h_(e,t):t.bookType=="numbers"?iB(e,t):t.bookType=="xlsb"?hB(e,t):xB(e,t)}function hB(e,t){jo=1024,e&&!e.SSF&&(e.SSF=ar(et)),e&&e.SSF&&(lc(),Gd(e.SSF),t.revssf=qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,S0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=zE.indexOf(t.bookType)>-1,n=mg();jg(t=t||{});var l=tg(),o="",u=0;if(t.cellXfs=[],Gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(l,o,aE(e.Props,t)),n.coreprops.push(o),Pt(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&h.push(e.SheetNames[x]);e.Props.SheetNames=h}for(e.Props.Worksheets=e.Props.SheetNames.length,xt(l,o,iE(e.Props)),n.extprops.push(o),Pt(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(l,o,lE(e.Custprops)),n.custprops.push(o),Pt(t.rels,4,o,bt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},g=e.Sheets[e.SheetNames[u-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,xt(l,o,G9(u-1,o,t,e,m)),n.sheets.push(o),Pt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0])}if(g){var b=g["!comments"],y=!1,w="";b&&b.length>0&&(w="xl/comments"+u+"."+r,xt(l,w,W9(b,w)),n.comments.push(w),Pt(m,-1,"../comments"+u+"."+r,bt.CMNT),y=!0),g["!legacy"]&&y&&xt(l,"xl/drawings/vmlDrawing"+u+".vml",IE(u,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&xt(l,P0(o),Fo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(l,o,q9(t.Strings,o,t)),n.strs.push(o),Pt(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,xt(l,o,H9(e,o)),n.workbooks.push(o),Pt(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",xt(l,o,wg(e.Themes,t)),n.themes.push(o),Pt(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,xt(l,o,V9(e,o,t)),n.styles.push(o),Pt(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",xt(l,o,e.vbaraw),n.vba.push(o),Pt(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,xt(l,o,X9(o)),n.metadata.push(o),Pt(t.wbrels,-1,"metadata."+r,bt.XLMETA),xt(l,"[Content_Types].xml",eE(n,t)),xt(l,"_rels/.rels",Fo(t.rels)),xt(l,"xl/_rels/workbook."+r+".rels",Fo(t.wbrels)),delete t.revssf,delete t.ssf,l}function xB(e,t){jo=1024,e&&!e.SSF&&(e.SSF=ar(et)),e&&e.SSF&&(lc(),Gd(e.SSF),t.revssf=qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,S0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=zE.indexOf(t.bookType)>-1,n=mg();jg(t=t||{});var l=tg(),o="",u=0;if(t.cellXfs=[],Gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",xt(l,o,aE(e.Props,t)),n.coreprops.push(o),Pt(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var h=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&h.push(e.SheetNames[x]);e.Props.SheetNames=h}e.Props.Worksheets=e.Props.SheetNames.length,xt(l,o,iE(e.Props)),n.extprops.push(o),Pt(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&vr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",xt(l,o,lE(e.Custprops)),n.custprops.push(o),Pt(t.rels,4,o,bt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],b=(v||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,xt(l,o,ZE(u-1,t,e,g)),n.sheets.push(o),Pt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,bt.WS[0])}if(v){var y=v["!comments"],w=!1,E="";if(y&&y.length>0){var k=!1;y.forEach(function(N){N[1].forEach(function(_){_.T==!0&&(k=!0)})}),k&&(E="xl/threadedComments/threadedComment"+u+"."+r,xt(l,E,wF(y,m,t)),n.threadedcomments.push(E),Pt(g,-1,"../threadedComments/threadedComment"+u+"."+r,bt.TCMNT)),E="xl/comments"+u+"."+r,xt(l,E,UE(y)),n.comments.push(E),Pt(g,-1,"../comments"+u+"."+r,bt.CMNT),w=!0}v["!legacy"]&&w&&xt(l,"xl/drawings/vmlDrawing"+u+".vml",IE(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}g["!id"].rId1&&xt(l,P0(o),Fo(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,xt(l,o,NE(t.Strings,t)),n.strs.push(o),Pt(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,xt(l,o,a_(e)),n.workbooks.push(o),Pt(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",xt(l,o,wg(e.Themes,t)),n.themes.push(o),Pt(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,xt(l,o,ME(e,t)),n.styles.push(o),Pt(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",xt(l,o,e.vbaraw),n.vba.push(o),Pt(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,xt(l,o,PE()),n.metadata.push(o),Pt(t.wbrels,-1,"metadata."+r,bt.XLMETA),m.length>1&&(o="xl/persons/person.xml",xt(l,o,EF(m)),n.people.push(o),Pt(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),xt(l,"[Content_Types].xml",eE(n,t)),xt(l,"_rels/.rels",Fo(t.rels)),xt(l,"xl/_rels/workbook."+r+".rels",Fo(t.wbrels)),delete t.revssf,delete t.ssf,l}function Rg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=tn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mB(e,t){return We.find(e,"EncryptedPackage")?fB(e,t):l_(e,t)}function pB(e,t){var r,a=e,n=t||{};return n.type||(n.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=A4(a,n),uB(r,n)}function m_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sp(e.slice(r),t);default:break e}return Ko.to_workbook(e,t)}function gB(e,t){var r="",a=Rg(e,t);switch(t.type){case"base64":r=tn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Rl(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=qt(r)),t.type="binary",m_(r,t)}function vB(e,t){var r=e;return t.type=="base64"&&(r=tn(r)),r=D0.utils.decode(1200,r.slice(2),"str"),t.type="binary",m_(r,t)}function yB(e){return e.match(/[^\x00-\x7F]/)?is(e):e}function Mm(e,t,r,a){return a?(r.type="string",Ko.to_workbook(e,r)):Ko.to_workbook(t,r)}function kp(e,t){Kp();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return kp(new Uint8Array(e),(r=ar(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Mo={},r.dateNF&&(Mo.dateNF=r.dateNF),r.type||(r.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=vt?"buffer":"binary",a=h6(e),typeof Uint8Array<"u"&&!vt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=yB(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=ar(r),r.type="array",kp(Qp(a),r)}switch((n=Rg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return mB(We.read(a,r),r);break;case 9:if(n[1]<=8)return l_(a,r);break;case 60:return Sp(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return _R(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return kE.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?pB(a,r):Mm(e,a,r,l);case 239:return n[3]===60?Sp(a,r):Mm(e,a,r,l);case 255:if(n[1]===254)return vB(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return kl.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return kl.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return wp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return DE.to_workbook(a,r);break;case 10:case 13:case 32:return gB(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ER.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?wp.to_workbook(a,r):Mm(e,a,r,l)}function p_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return cu(t.file,We.write(e,{type:vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return We.write(e,t)}function bB(e,t){var r=ar(t||{}),a=dB(e,r);return wB(a,r)}function wB(e,t){var r={},a=vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?We.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Hd(n))}return t.password&&typeof encrypt_agile<"u"?p_(encrypt_agile(n,t.password),t):t.type==="file"?cu(t.file,n):t.type=="string"?qt(n):n}function SB(e,t){var r=t||{},a=yL(e,r);return p_(a,r)}function ts(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return F0(is(a));case"binary":return is(a);case"string":return e;case"file":return cu(t.file,a,"utf8");case"buffer":return vt?Us(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ts(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function EB(e,t){switch(t.type){case"base64":return F0(e);case"binary":return e;case"string":return e;case"file":return cu(t.file,e,"binary");case"buffer":return vt?Us(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Gf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?F0(r):t.type=="string"?qt(r):r;case"file":return cu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function g_(e,t){Kp(),m9(e);var r=ar(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=g_(e,r);return r.type="array",Hd(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ts(dL(e,r),r);case"slk":case"sylk":return ts(_E.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return ts(c_(e.Sheets[e.SheetNames[n]],r),r);case"txt":return EB(v_(e.Sheets[e.SheetNames[n]],r),r);case"csv":return ts(Dg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return ts(kE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Gf(wp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return ts(Ko.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return ts(DE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return ts(TE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return ts(h_(e,r),r);case"wk1":return Gf(kl.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Gf(kl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Gf(o_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),SB(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bB(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function _B(e,t,r,a,n,l,o,u){var h=Nr(r),x=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),g=!0,v=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var b=t.s.c;b<=t.e.c;++b){var y=o?e[r][b]:e[a[b]+h];if(y===void 0||y.t===void 0){if(x===void 0)continue;l[b]!=null&&(v[l[b]]=x);continue}var w=y.v;switch(y.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(l[b]!=null){if(w==null)if(y.t=="e"&&w===null)v[l[b]]=null;else if(x!==void 0)v[l[b]]=x;else if(m&&w===null)v[l[b]]=null;else continue;else v[l[b]]=m&&(y.t!=="n"||y.t==="n"&&u.rawNumbers!==!1)?w:Ps(y,w,u);w!=null&&(g=!1)}}return{row:v,isempty:g}}function Td(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?a=1:x.header==="A"?a=2:Array.isArray(x.header)?a=3:x.header==null&&(a=0),typeof m){case"string":h=Ct(m);break;case"number":h=Ct(e["!ref"]),h.s.r=m;break;default:h=m}a>0&&(n=0);var g=Nr(h.s.r),v=[],b=[],y=0,w=0,E=Array.isArray(e),k=h.s.r,N=0,_={};E&&!e[k]&&(e[k]=[]);var R=x.skipHidden&&e["!cols"]||[],A=x.skipHidden&&e["!rows"]||[];for(N=h.s.c;N<=h.e.c;++N)if(!(R[N]||{}).hidden)switch(v[N]=cr(N),r=E?e[k][N]:e[v[N]+g],a){case 1:l[N]=N-h.s.c;break;case 2:l[N]=v[N];break;case 3:l[N]=x.header[N-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=Ps(r,null,x),w=_[o]||0,!w)_[o]=1;else{do u=o+"_"+w++;while(_[u]);_[o]=w,_[u]=1}l[N]=u}for(k=h.s.r+n;k<=h.e.r;++k)if(!(A[k]||{}).hidden){var D=_B(e,h,k,v,a,l,E,x);(D.isempty===!1||(a===1?x.blankrows!==!1:x.blankrows))&&(b[y++]=D.row)}return b.length=y,b}var Sw=/"/g;function kB(e,t,r,a,n,l,o,u){for(var h=!0,x=[],m="",g=Nr(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var b=u.dense?(e[r]||[])[v]:e[a[v]+g];if(b==null)m="";else if(b.v!=null){h=!1,m=""+(u.rawNumbers&&b.t=="n"?b.v:Ps(b,null,u));for(var y=0,w=0;y!==m.length;++y)if((w=m.charCodeAt(y))===n||w===l||w===34||u.forceQuotes){m='"'+m.replace(Sw,'""')+'"';break}m=="ID"&&(m='"ID"')}else b.f!=null&&!b.F?(h=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(Sw,'""')+'"')):m="";x.push(m)}return u.blankrows===!1&&h?null:x.join(o)}function Dg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Ct(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,h=u.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",g=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],b=a.skipHidden&&e["!rows"]||[],y=n.s.c;y<=n.e.c;++y)(v[y]||{}).hidden||(g[y]=cr(y));for(var w=0,E=n.s.r;E<=n.e.r;++E)(b[E]||{}).hidden||(m=kB(e,n,E,g,o,h,l,a),m!=null&&(a.strip&&(m=m.replace(x,"")),(m||a.blankrows!==!1)&&r.push((w++?u:"")+m)));return delete a.dense,r.join("")}function v_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dg(e,t);return r}function TB(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Ct(e["!ref"]),l="",o=[],u,h=[],x=Array.isArray(e);for(u=n.s.c;u<=n.e.c;++u)o[u]=cr(u);for(var m=n.s.r;m<=n.e.r;++m)for(l=Nr(m),u=n.s.c;u<=n.e.c;++u)if(t=o[u]+l,r=x?(e[m]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}h[h.length]=t+"="+a}return h}function y_(e,t,r){var a=r||{},n=+!a.skipHeader,l=e||{},o=0,u=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?ur(a.origin):a.origin;o=h.r,u=h.c}var x,m={s:{c:0,r:0},e:{c:u,r:o+t.length-1+n}};if(l["!ref"]){var g=Ct(l["!ref"]);m.e.c=Math.max(m.e.c,g.e.c),m.e.r=Math.max(m.e.r,g.e.r),o==-1&&(o=g.e.r+1,m.e.r=o+t.length-1+n)}else o==-1&&(o=0,m.e.r=t.length-1+n);var v=a.header||[],b=0;t.forEach(function(w,E){vr(w).forEach(function(k){(b=v.indexOf(k))==-1&&(v[b=v.length]=k);var N=w[k],_="z",R="",A=tt({c:u+b,r:o+E+n});x=q0(l,A),N&&typeof N=="object"&&!(N instanceof Date)?l[A]=N:(typeof N=="number"?_="n":typeof N=="boolean"?_="b":typeof N=="string"?_="s":N instanceof Date?(_="d",a.cellDates||(_="n",N=zr(N)),R=a.dateNF||et[14]):N===null&&a.nullError&&(_="e",N=0),x?(x.t=_,x.v=N,delete x.w,delete x.R,R&&(x.z=R)):l[A]=x={t:_,v:N},R&&(x.z=R))})}),m.e.c=Math.max(m.e.c,u+v.length-1);var y=Nr(o);if(n)for(b=0;b<v.length;++b)l[cr(b+u)+y]={t:"s",v:v[b]};return l["!ref"]=dt(m),l}function NB(e,t){return y_(null,e,t)}function q0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=ur(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?q0(e,tt(t)):q0(e,tt({r:t,c:r||0}))}function CB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Fg(){return{SheetNames:[],Sheets:{}}}function Og(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);n=l&&+l[2]||0;var o=l&&l[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(r_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function AB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=CB(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function jB(e,t){return e.z=t,e}function b_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function RB(e,t,r){return b_(e,"#"+t,r)}function DB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function FB(e,t,r,a){for(var n=typeof t!="string"?t:Ct(t),l=typeof t=="string"?t:dt(t),o=n.s.r;o<=n.e.r;++o)for(var u=n.s.c;u<=n.e.c;++u){var h=q0(e,o,u);h.t="n",h.F=l,delete h.v,o==n.s.r&&u==n.s.c&&(h.f=r,a&&(h.D=!0))}return e}var Vf={encode_col:cr,encode_row:Nr,encode_cell:tt,encode_range:dt,decode_col:cg,decode_row:og,split_cell:q6,decode_cell:ur,decode_range:Ua,format_cell:Ps,sheet_add_aoa:X4,sheet_add_json:y_,sheet_add_dom:u_,aoa_to_sheet:oc,json_to_sheet:NB,table_to_sheet:f_,table_to_book:zL,sheet_to_csv:Dg,sheet_to_txt:v_,sheet_to_json:Td,sheet_to_html:c_,sheet_to_formulae:TB,sheet_to_row_object_array:Td,sheet_get_cell:q0,book_new:Fg,book_append_sheet:Og,book_set_sheet_visibility:AB,cell_set_number_format:jB,cell_set_hyperlink:b_,cell_set_internal_link:RB,cell_add_comment:DB,sheet_set_array_formula:FB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},ld={exports:{}},OB=ld.exports,Ew;function MB(){return Ew||(Ew=1,function(e,t){(function(r,a){a()})(OB,function(){function r(x,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function a(x,m,g){var v=new XMLHttpRequest;v.open("GET",x),v.responseType="blob",v.onload=function(){h(v.response,m,g)},v.onerror=function(){console.error("could not download file")},v.send()}function n(x){var m=new XMLHttpRequest;m.open("HEAD",x,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function l(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(m)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof jf=="object"&&jf.global===jf?jf:void 0,u=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(x,m,g){var v=o.URL||o.webkitURL,b=document.createElement("a");m=m||x.name||"download",b.download=m,b.rel="noopener",typeof x=="string"?(b.href=x,b.origin===location.origin?l(b):n(b.href)?a(x,m,g):l(b,b.target="_blank")):(b.href=v.createObjectURL(x),setTimeout(function(){v.revokeObjectURL(b.href)},4e4),setTimeout(function(){l(b)},0))}:"msSaveOrOpenBlob"in navigator?function(x,m,g){if(m=m||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(r(x,g),m);else if(n(x))a(x,m,g);else{var v=document.createElement("a");v.href=x,v.target="_blank",setTimeout(function(){l(v)})}}:function(x,m,g,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof x=="string")return a(x,m,g);var b=x.type==="application/octet-stream",y=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||b&&y||u)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var _=E.result;_=w?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=_:location=_,v=null},E.readAsDataURL(x)}else{var k=o.URL||o.webkitURL,N=k.createObjectURL(x);v?v.location=N:location.href=N,v=null,setTimeout(function(){k.revokeObjectURL(N)},4e4)}});o.saveAs=h.saveAs=h,e.exports=h})}(ld)),ld.exports}var LB=MB();let BB={data:""},PB=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||BB,IB=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,UB=/\/\*[^]*?\*\/|  +/g,_w=/\n+/g,wi=(e,t)=>{let r="",a="",n="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+o+";":a+=l[1]=="f"?wi(o,l):l+"{"+wi(o,l[1]=="k"?"":t)+"}":typeof o=="object"?a+=wi(o,t?t.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,h=>/&/.test(h)?h.replace(/&/g,u):u?u+" "+h:h)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=wi.p?wi.p(l,o):l+":"+o+";")}return r+(t&&n?t+"{"+n+"}":n)+a},Ts={},w_=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+w_(e[r]);return t}return e},zB=(e,t,r,a,n)=>{let l=w_(e),o=Ts[l]||(Ts[l]=(h=>{let x=0,m=11;for(;x<h.length;)m=101*m+h.charCodeAt(x++)>>>0;return"go"+m})(l));if(!Ts[o]){let h=l!==e?e:(x=>{let m,g,v=[{}];for(;m=IB.exec(x.replace(UB,""));)m[4]?v.shift():m[3]?(g=m[3].replace(_w," ").trim(),v.unshift(v[0][g]=v[0][g]||{})):v[0][m[1]]=m[2].replace(_w," ").trim();return v[0]})(e);Ts[o]=wi(n?{["@keyframes "+o]:h}:h,r?"":"."+o)}let u=r&&Ts.g?Ts.g:null;return r&&(Ts.g=Ts[o]),((h,x,m,g)=>{g?x.data=x.data.replace(g,h):x.data.indexOf(h)===-1&&(x.data=m?h+x.data:x.data+h)})(Ts[o],t,a,u),o},HB=(e,t,r)=>e.reduce((a,n,l)=>{let o=t[l];if(o&&o.call){let u=o(r),h=u&&u.props&&u.props.className||/^go/.test(u)&&u;o=h?"."+h:u&&typeof u=="object"?u.props?"":wi(u,""):u===!1?"":u}return a+n+(o??"")},"");function Qd(e){let t=this||{},r=e.call?e(t.p):e;return zB(r.unshift?r.raw?HB(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,PB(t.target),t.g,t.o,t.k)}let S_,Tp,Np;Qd.bind({g:1});let Is=Qd.bind({k:1});function GB(e,t,r,a){wi.p=t,S_=e,Tp=r,Np=a}function Vi(e,t){let r=this||{};return function(){let a=arguments;function n(l,o){let u=Object.assign({},l),h=u.className||n.className;r.p=Object.assign({theme:Tp&&Tp()},u),r.o=/ *go\d+/.test(h),u.className=Qd.apply(r,a)+(h?" "+h:"");let x=e;return e[0]&&(x=u.as||e,delete u.as),Np&&x[0]&&Np(u),S_(x,u)}return n}}var VB=e=>typeof e=="function",Nd=(e,t)=>VB(e)?e(t):e,qB=(()=>{let e=0;return()=>(++e).toString()})(),E_=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),WB=20,__=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,WB)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:r}=t;return __(e,{type:e.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(l=>l.id===a||a===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let n=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+n}))}}},od=[],dl={toasts:[],pausedAt:void 0},Hl=e=>{dl=__(dl,e),od.forEach(t=>{t(dl)})},XB={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},YB=(e={})=>{let[t,r]=C.useState(dl),a=C.useRef(dl);C.useEffect(()=>(a.current!==dl&&r(dl),od.push(r),()=>{let l=od.indexOf(r);l>-1&&od.splice(l,1)}),[]);let n=t.toasts.map(l=>{var o,u,h;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((o=e[l.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:l.duration||((u=e[l.type])==null?void 0:u.duration)||(e==null?void 0:e.duration)||XB[l.type],style:{...e.style,...(h=e[l.type])==null?void 0:h.style,...l.style}}});return{...t,toasts:n}},$B=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||qB()}),gu=e=>(t,r)=>{let a=$B(t,e,r);return Hl({type:2,toast:a}),a.id},_a=(e,t)=>gu("blank")(e,t);_a.error=gu("error");_a.success=gu("success");_a.loading=gu("loading");_a.custom=gu("custom");_a.dismiss=e=>{Hl({type:3,toastId:e})};_a.remove=e=>Hl({type:4,toastId:e});_a.promise=(e,t,r)=>{let a=_a.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(n=>{let l=t.success?Nd(t.success,n):void 0;return l?_a.success(l,{id:a,...r,...r==null?void 0:r.success}):_a.dismiss(a),n}).catch(n=>{let l=t.error?Nd(t.error,n):void 0;l?_a.error(l,{id:a,...r,...r==null?void 0:r.error}):_a.dismiss(a)}),e};var KB=(e,t)=>{Hl({type:1,toast:{id:e,height:t}})},QB=()=>{Hl({type:5,time:Date.now()})},k0=new Map,ZB=1e3,JB=(e,t=ZB)=>{if(k0.has(e))return;let r=setTimeout(()=>{k0.delete(e),Hl({type:4,toastId:e})},t);k0.set(e,r)},eP=e=>{let{toasts:t,pausedAt:r}=YB(e);C.useEffect(()=>{if(r)return;let l=Date.now(),o=t.map(u=>{if(u.duration===1/0)return;let h=(u.duration||0)+u.pauseDuration-(l-u.createdAt);if(h<0){u.visible&&_a.dismiss(u.id);return}return setTimeout(()=>_a.dismiss(u.id),h)});return()=>{o.forEach(u=>u&&clearTimeout(u))}},[t,r]);let a=C.useCallback(()=>{r&&Hl({type:6,time:Date.now()})},[r]),n=C.useCallback((l,o)=>{let{reverseOrder:u=!1,gutter:h=8,defaultPosition:x}=o||{},m=t.filter(b=>(b.position||x)===(l.position||x)&&b.height),g=m.findIndex(b=>b.id===l.id),v=m.filter((b,y)=>y<g&&b.visible).length;return m.filter(b=>b.visible).slice(...u?[v+1]:[0,v]).reduce((b,y)=>b+(y.height||0)+h,0)},[t]);return C.useEffect(()=>{t.forEach(l=>{if(l.dismissed)JB(l.id,l.removeDelay);else{let o=k0.get(l.id);o&&(clearTimeout(o),k0.delete(l.id))}})},[t]),{toasts:t,handlers:{updateHeight:KB,startPause:QB,endPause:a,calculateOffset:n}}},tP=Is`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,rP=Is`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,aP=Is`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,nP=Vi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${tP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${rP} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${aP} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,sP=Is`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,iP=Vi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${sP} 1s linear infinite;
`,lP=Is`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,oP=Is`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,cP=Vi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${lP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${oP} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,uP=Vi("div")`
  position: absolute;
`,fP=Vi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,dP=Is`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,hP=Vi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${dP} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,xP=({toast:e})=>{let{icon:t,type:r,iconTheme:a}=e;return t!==void 0?typeof t=="string"?C.createElement(hP,null,t):t:r==="blank"?null:C.createElement(fP,null,C.createElement(iP,{...a}),r!=="loading"&&C.createElement(uP,null,r==="error"?C.createElement(nP,{...a}):C.createElement(cP,{...a})))},mP=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,pP=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,gP="0%{opacity:0;} 100%{opacity:1;}",vP="0%{opacity:1;} 100%{opacity:0;}",yP=Vi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,bP=Vi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,wP=(e,t)=>{let r=e.includes("top")?1:-1,[a,n]=E_()?[gP,vP]:[mP(r),pP(r)];return{animation:t?`${Is(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Is(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},SP=C.memo(({toast:e,position:t,style:r,children:a})=>{let n=e.height?wP(e.position||t||"top-center",e.visible):{opacity:0},l=C.createElement(xP,{toast:e}),o=C.createElement(bP,{...e.ariaProps},Nd(e.message,e));return C.createElement(yP,{className:e.className,style:{...n,...r,...e.style}},typeof a=="function"?a({icon:l,message:o}):C.createElement(C.Fragment,null,l,o))});GB(C.createElement);var EP=({id:e,className:t,style:r,onHeightUpdate:a,children:n})=>{let l=C.useCallback(o=>{if(o){let u=()=>{let h=o.getBoundingClientRect().height;a(e,h)};u(),new MutationObserver(u).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,a]);return C.createElement("div",{ref:l,className:t,style:r},n)},_P=(e,t)=>{let r=e.includes("top"),a=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:E_()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},kP=Qd`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,qf=16,TP=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:a,children:n,containerStyle:l,containerClassName:o})=>{let{toasts:u,handlers:h}=eP(r);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:qf,left:qf,right:qf,bottom:qf,pointerEvents:"none",...l},className:o,onMouseEnter:h.startPause,onMouseLeave:h.endPause},u.map(x=>{let m=x.position||t,g=h.calculateOffset(x,{reverseOrder:e,gutter:a,defaultPosition:t}),v=_P(m,g);return C.createElement(EP,{id:x.id,key:x.id,onHeightUpdate:h.updateHeight,className:x.visible?kP:"",style:v},x.type==="custom"?Nd(x.message,x):n?n(x):C.createElement(SP,{toast:x,position:m}))}))},bn=_a;function NP(e){return aa({queryKey:["rsvps",e],queryFn:async()=>{var n;const t=await Qe.get(au.forEvent(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:Array.isArray(r==null?void 0:r.data)?r.data:[]).map(l=>({id:l.id??l.rsvpId??l.rsvpGuid??l._id,rsvpId:l.rsvpId??l.id,rsvpGuid:l.rsvpGuid??l.rsvpGuid??void 0,eventId:l.eventId,guestName:l.guestName??l.name??"",noOfPax:l.noOfPax!==void 0&&l.noOfPax!==null?l.noOfPax:1,name:l.name,status:l.status??"",guestType:l.guestType??"",createdBy:l.createdBy??"",remarks:l.remarks??"",phoneNo:l.phoneNo??"",tableId:l.tableId??l.table_id??void 0}))},enabled:!!e,staleTime:6e4})}function CP(e,t){return aa({queryKey:["rsvp",t],queryFn:async()=>(await Qe.get(au.byId(e,t))).data})}function Mg(e){const t=Et();return At({mutationFn:r=>Qe.post(au.create(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function Lg(e){const t=Et();return At({mutationFn:async r=>(await Qe.post(au.update(),r)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function AP(e){const t=Et();return At({mutationFn:r=>Qe.post(au.delete(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function Bg(e,t){return aa({queryKey:["formFields",e],enabled:!!e&&((t==null?void 0:t.enabled)??!0),queryFn:async()=>{var l;if(!e)return[];const a=((l=(await Qe.get(Id.all(e))).data)==null?void 0:l.data)??[],n={0:"text",1:"textarea",2:"select",3:"radio",4:"checkbox",5:"email",6:"number",7:"date"};return(Array.isArray(a)?a:[]).map(o=>({questionId:o.id??o.questionId,id:o.id??o.questionId,eventId:o.eventId,label:o.label??o.text??o.name??"",name:o.name??(o.label??o.text??"").toLowerCase().replace(/\s+/g,"_"),text:o.text??o.label??"",isRequired:o.isRequired??o.required??!1,type:typeof o.type=="number"?o.type:void 0,typeKey:typeof o.type=="number"?n[o.type]:o.typeKey??o.type,options:Array.isArray(o.options)||typeof o.options=="string"?o.options:void 0,order:o.order??0}))}})}function jP(e){const t=Et();return At({mutationFn:r=>Qe.post(Id.create(),r).then(a=>a.data),onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function RP(e){const t=Et();return At({mutationFn:r=>{const a={...r,questionId:r.questionId??r.id};return delete a.id,Qe.post(Id.update(),a).then(n=>n.data)},onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function DP(e){const t=Et();return At({mutationFn:()=>Qe.post(Id.deactivate()).then(r=>r.data),onSuccess:()=>t.invalidateQueries({queryKey:["formFields",e]})})}const Pg=({isOpen:e,onClose:t,eventId:r,initial:a,onSave:n})=>{const{user:l}=lu(),[o,u]=C.useState((a==null?void 0:a.guestName)||(a==null?void 0:a.name)||""),[h,x]=C.useState((a==null?void 0:a.noOfPax)||1),[m,g]=C.useState((a==null?void 0:a.phoneNo)||""),[v,b]=C.useState((a==null?void 0:a.remarks)||""),[y,w]=C.useState((a==null?void 0:a.status)||"Yes"),[E,k]=C.useState((a==null?void 0:a.guestType)||"Family"),[N,_]=C.useState({}),{data:R=[]}=Bg(r),[A,D]=C.useState(!1),[T,F]=C.useState(""),[O,U]=C.useState(""),[q,z]=C.useState("");C.useEffect(()=>{e&&!A&&(u((a==null?void 0:a.name)??""),x((a==null?void 0:a.noOfPax)??1),g((a==null?void 0:a.phoneNo)??""),b((a==null?void 0:a.remarks)??""),w((a==null?void 0:a.status)??"Yes"),_(R.reduce((ce,de)=>{const ee=de.name??de.id??de.questionId;return ee&&(ce[ee]=(a==null?void 0:a[ee])??""),ce},{})),F(""),U(""),z(""),D(!0)),e||D(!1)},[e,a==null?void 0:a.rsvpId,R,A]);const te=ce=>{ce.preventDefault();let de=!1;if(!o||o.trim()===""?(F("Guest name is required"),de=!0):F(""),!m||m.trim()===""?(U("Phone number is required"),de=!0):U(""),!h&&h!==0&&h!=="0"?(z("Number of pax is required"),de=!0):Number(h)<0?(z("Number of pax cannot be negative"),de=!0):Number.isInteger(Number(h))?z(""):(z("Number of pax must be a whole number"),de=!0),de)return;const ee=(l==null?void 0:l.id)??(l==null?void 0:l.name)??"System",ie={eventId:r,guestName:o.trim(),noOfPax:Number(h),status:y,guestType:E,remarks:v.trim(),phoneNo:m.trim(),...N};a?(ie.updatedBy=ee,ie.rsvpGuid=a.rsvpGuid):ie.createdBy=ee,n(ie,(a==null?void 0:a.id)??(a==null?void 0:a.rsvpId)),t()};return f.jsx(qn,{isOpen:e,onClose:t,title:a?"Edit RSVP":"New RSVP",children:f.jsxs("form",{onSubmit:te,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(sr,{label:"Guest Name",value:o,onChange:ce=>{u(ce.target.value),F("")},required:!0}),T&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:T})]}),f.jsxs("div",{children:[f.jsx(sr,{label:"No Of Pax",type:"number",value:String(h),onChange:ce=>{x(ce.target.value),z("")},min:0,step:1,required:!0}),q&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:q})]}),f.jsxs("div",{children:[f.jsx(sr,{label:"Phone",value:m,onChange:ce=>{g(ce.target.value),U("")},required:!0}),O&&f.jsx("p",{className:"text-red-500 text-sm mt-1",children:O})]}),f.jsxs("div",{style:{display:"none"},children:[f.jsx("label",{className:"block mb-1",children:"Guest Type"}),f.jsx("select",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:E,onChange:ce=>k(ce.target.value),children:["Family","VIP","Friend","Other"].map(ce=>f.jsx("option",{value:ce,children:ce},ce))})]}),f.jsxs("div",{style:{display:"none"},children:[f.jsx("label",{className:"block mb-1",children:"Reservation Status"}),f.jsx("select",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:y,onChange:ce=>w(ce.target.value),children:["Yes","No","Maybe"].map(ce=>f.jsx("option",{value:ce,children:ce},ce))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1",children:"Remarks"}),f.jsx("textarea",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:v,onChange:ce=>b(ce.target.value),rows:3,placeholder:"Add any additional notes or remarks..."})]}),R.map(ce=>f.jsx(sr,{label:ce.label,type:ce.type,required:ce.required,options:ce.options,value:N[ce.name]||"",onChange:de=>_(ee=>({...ee,[ce.name]:de.target.value}))},ce.id)),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",children:a?"Save":"Create"})]})]})})},vu=({isOpen:e,isDeleting:t,onConfirm:r,onCancel:a,title:n,description:l="This action cannot be undone.",children:o})=>e?f.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[f.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"w-6 h-6 text-red-600 dark:text-red-400",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:n}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l})]})]})}),f.jsx("div",{className:"p-6",children:o}),f.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-100 dark:border-gray-700 flex gap-3",children:[f.jsx(Fe,{onClick:a,variant:"secondary",disabled:t,className:"flex-1",children:"Cancel"}),f.jsx(Fe,{onClick:r,disabled:t,className:"flex-1 bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:t?f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Deleting..."]}):"Delete"})]})]})}):null;function uc({title:e="No Events Yet",message:t="Create your first event to get started with planning your big day!",showButton:r=!0}){const a=Na(),{data:n=[]}=Xp();return n.filter(o=>{var u;return!((u=o.raw)!=null&&u.isDeleted)}).length>0?null:f.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:f.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[f.jsx("div",{className:"h-20 w-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 grid place-items-center",children:f.jsx(j0,{className:"h-10 w-10 text-indigo-600 dark:text-indigo-400"})}),f.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:e}),f.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:t}),r&&f.jsxs(Fe,{onClick:()=>a("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[f.jsx(j0,{className:"h-5 w-5"}),"Create Your First Event"]})]})})}function FP(){const{eventId:e}=$r(),{data:t=[],isLoading:r,isError:a}=NP(e),n=Mg(e),l=Lg(e),o=AP(e),{user:u}=lu(),h=(u==null?void 0:u.id)??(u==null?void 0:u.name)??"System",x=Et(),[m,g]=C.useState({open:!1}),[v,b]=C.useState({open:!1,rsvp:null}),y=C.useRef(null),[w,E]=C.useState("All"),[k,N]=C.useState(""),[_,R]=C.useState("list");if(!e)return f.jsx(uc,{title:"No Events to Manage RSVPs",message:"Create your first event to start managing guest responses and invitations."});if(r)return f.jsx("p",{children:"Loading RSVPs"});if(a)return f.jsx("p",{children:"Failed to load RSVPs."});const A=te=>{b({open:!0,rsvp:te})},D=()=>{b({open:!1,rsvp:null})},T=async()=>{if(v.rsvp)try{await o.mutateAsync({rsvpGuid:v.rsvp.rsvpGuid??v.rsvp.rsvpId??v.rsvp.id,eventId:e}),b({open:!1,rsvp:null})}catch(te){console.error("Failed to delete RSVP:",te)}},F=t.filter(te=>{const ce=w==="All"||te.guestType===w,de=(te.guestName??"").toLowerCase().includes(k.toLowerCase());return ce&&de}),O=t.reduce((te,ce)=>(te.total+=1,ce.status==="Yes"&&(te.yes+=1),ce.status==="No"&&(te.no+=1),ce.status==="Maybe"&&(te.maybe+=1),ce.guestType==="VIP"&&(te.vip+=1),te),{total:0,yes:0,no:0,maybe:0,vip:0}),U=()=>{const te=t.map(({eventId:ie,...Te})=>Te),ce=Vf.json_to_sheet(te),de=Vf.book_new();Vf.book_append_sheet(de,ce,"RSVPs");const ee=g_(de,{bookType:"xlsx",type:"array"});LB.saveAs(new Blob([ee]),"rsvps.xlsx")},q=()=>{var te;return(te=y.current)==null?void 0:te.click()},z=async te=>{var ee;const ce=(ee=te.target.files)==null?void 0:ee[0];if(!ce)return;const de=new FileReader;de.onload=async ie=>{var Te;try{const ne=(Te=ie.target)==null?void 0:Te.result;if(!ne)throw new Error("Empty file");const B=kp(ne,{type:"array"}),Z=B.Sheets[B.SheetNames[0]],L=Vf.sheet_to_json(Z,{header:1,defval:""}),G=L[0].map(Q=>Q.trim().toLowerCase().replace(/\s+/g,""));let V=0;for(const Q of L.slice(1)){const le=Object.fromEntries(Q.map((Ne,Re)=>[G[Re],String(Ne)])),_e={guestName:le.guestname||"",status:le.status||"Yes",guestType:le.guesttype||"Other"},Ee=t.find(Ne=>Ne.name===_e.guestName);if(Ee){const Ne=Ee.rsvpGuid??Ee.rsvpId??Ee.id;await l.mutateAsync({rsvpGuid:Ne,..._e,updatedBy:h})}else await n.mutateAsync(_e);V++}bn.success(`Imported ${V} rows`)}catch(ne){console.error(ne);const B=ne instanceof Error?ne.message:"Import failed";bn.error(B)}finally{y.current&&(y.current.value="")}},de.onerror=()=>bn.error("File read error"),de.readAsArrayBuffer(ce)};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[f.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Total guests"}),f.jsx("p",{className:"text-xl font-semibold text-primary",children:O.total})]}),f.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Yes"}),f.jsx("p",{className:"text-xl font-semibold text-green-600",children:O.yes})]}),f.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Maybe"}),f.jsx("p",{className:"text-xl font-semibold text-yellow-600",children:O.maybe})]}),f.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"VIPs"}),f.jsx("p",{className:"text-xl font-semibold text-purple-600",children:O.vip})]})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"RSVPs"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(eu,{to:"/app/rsvps/designer",children:f.jsx(Fe,{variant:"secondary",children:"Design RSVP Card"})}),f.jsx(Fe,{onClick:()=>g({open:!0}),children:"+ New RSVP"}),f.jsxs(Fe,{disabled:!0,variant:"secondary",onClick:q,children:["Import CSV/XLSX",f.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),f.jsxs(Fe,{disabled:!0,variant:"secondary",onClick:U,children:["Export Excel",f.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]})]})]}),f.jsx("input",{ref:y,type:"file",accept:".csv,.xlsx",className:"hidden",onChange:z}),f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[f.jsx("select",{value:w,onChange:te=>E(te.target.value),className:"w-full md:w-1/4 border rounded p-2",children:["All","Family","VIP","Friend","Other"].map(te=>f.jsx("option",{value:te,children:te},te))}),f.jsx("input",{type:"text",placeholder:"Search Guests",value:k,onChange:te=>N(te.target.value),className:"w-full md:flex-1 border rounded p-2"}),f.jsxs("div",{className:"flex space-x-2 md:ml-auto",children:[f.jsx(Fe,{variant:_==="list"?"primary":"secondary",onClick:()=>R("list"),"aria-label":"List view",children:f.jsx(ZA,{className:"h-5 w-5"})}),f.jsx(Fe,{variant:_==="grid"?"primary":"secondary",onClick:()=>R("grid"),"aria-label":"Grid view",children:f.jsx(KA,{className:"h-5 w-5"})})]})]}),_==="grid"&&f.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:F.map(te=>{const ce=te.noOfPax??0,de=ce>0?"Yes":"No",ee=ce>0?"bg-green-600 text-white":"bg-red-600 text-white",ie=ce>0?"bg-green-50":"bg-red-50";return f.jsxs("li",{className:`
                  relative p-4 rounded-lg shadow flex flex-col justify-between
                  ${ie}
                `,children:[f.jsx("span",{role:"status","aria-label":`RSVP status: ${de}`,className:`absolute top-2 right-2 inline-block px-2 py-0.5 rounded-full text-xs font-semibold ${ee}`,children:de}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-xl font-semibold",children:te.guestName}),te.phoneNo&&f.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",te.phoneNo]}),te.noOfPax!==void 0&&te.noOfPax!==null&&f.jsxs("p",{className:"text-sm text-gray-600",children:["Pax: ",te.noOfPax]})]}),f.jsxs("div",{className:"mt-4 flex space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>g({open:!0,rsvp:te}),children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:()=>A(te),children:"Delete"})]})]},te.id)})}),_==="list"&&f.jsx("ul",{className:"space-y-2",children:F.map(te=>{const de=(te.noOfPax??0)>0?"bg-green-50":"bg-red-50";return f.jsxs("li",{className:`flex items-center justify-between p-4 rounded shadow ${de}`,children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-medium",children:te.guestName}),f.jsxs("p",{className:"text-sm text-gray-600",style:{display:"none"},children:[f.jsxs("span",{className:"mr-2",children:["Status: ",te.status]}),f.jsxs("span",{children:["Type: ",te.guestType]})]}),te.phoneNo&&f.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",te.phoneNo]}),te.noOfPax!==void 0&&te.noOfPax!==null&&f.jsxs("p",{className:"text-sm text-gray-600",children:["Pax: ",te.noOfPax]})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>g({open:!0,rsvp:te}),children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:()=>A(te),children:"Delete"})]})]},te.id)})}),f.jsx(Pg,{isOpen:m.open,onClose:()=>g({open:!1}),initial:m.rsvp,eventId:e,onSave:async(te,ce)=>{try{if(ce){const de=ce;await l.mutateAsync({rsvpGuid:de,...te})}else await n.mutateAsync(te);x.invalidateQueries({queryKey:["rsvps",e]})}catch(de){console.error("RSVP save error",de)}finally{g({open:!1})}}}),f.jsx(vu,{isOpen:v.open,isDeleting:o.isPending,onConfirm:T,onCancel:D,title:"Delete RSVP?",description:"Are you sure you want to delete this RSVP? This will permanently remove it from your guest list.",children:v.rsvp&&f.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:v.rsvp.guestName}),v.rsvp.phoneNo&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Phone: ",v.rsvp.phoneNo]}),v.rsvp.noOfPax!==void 0&&v.rsvp.noOfPax!==null&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Pax: ",v.rsvp.noOfPax]}),v.rsvp.guestType&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Type: ",v.rsvp.guestType]})]}),f.jsx("div",{className:"text-right",children:f.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${(v.rsvp.noOfPax??0)>0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:(v.rsvp.noOfPax??0)>0?"Yes":"No"})})]})})})]})}function OP(e,t){const r={id:e.id,type:e.type};if(e.background){const a={opacity:e.background.overlay??.4,color:"#0f172a"},n={images:e.background.images.map(l=>({id:l.id,src:l.src,alt:l.alt})),activeImageId:e.background.activeImageId,overlay:a};r.background=n}switch(e.sectionImage&&(r.sectionImage={id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}),e.type){case"headline":r.title=e.title,r.subtitle=e.subtitle,r.align=e.align,r.accentClass=e.accent,r.accentColor=t;break;case"text":r.body=e.body,r.width=e.width==="full"?100:50,r.align=e.align,r.muted=e.muted;break;case"info":r.label=e.label,r.content=e.content,r.accentClass=e.accent,r.accentColor=t;break;case"formField":if(r.label=e.label,r.placeholder=e.placeholder,r.required=e.required,r.width=e.width==="full"?100:50,r.hint=e.hint,e.questionId){const a=parseInt(e.questionId,10);r.formFieldId=isNaN(a)?void 0:a}break;case"cta":r.ctaLabel=e.label,r.href=e.href,r.align=e.align;break;case"image":r.images=e.images.map(a=>({id:a.id,src:a.src,alt:a.alt})),r.activeImageId=e.activeImageId,r.caption=e.caption,r.height=e.height;break}return r}function MP(e){var n,l;const t=e.background?{images:e.background.images.map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.background.activeImageId,overlay:((n=e.background.overlay)==null?void 0:n.opacity)??.4}:{images:[],overlay:.4},r=e.sectionImage?{id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}:null,a={id:e.id,background:t,sectionImage:r};switch(e.type){case"headline":return{...a,type:"headline",title:e.title??"",subtitle:e.subtitle,align:e.align??"center",accent:e.accentClass??"text-white"};case"text":return{...a,type:"text",body:e.body??"",width:e.width===50?"half":"full",align:e.align??"left",muted:e.muted};case"info":return{...a,type:"info",label:e.label??"",content:e.content??"",accent:e.accentClass??"bg-white/20 text-white"};case"formField":return{...a,type:"formField",label:e.label??"",placeholder:e.placeholder,required:e.required??!1,width:e.width===50?"half":"full",hint:e.hint,questionId:(l=e.formFieldId)==null?void 0:l.toString()};case"cta":return{...a,type:"cta",label:e.ctaLabel??e.label??"",href:e.href,align:e.align??"center"};case"image":return{...a,type:"image",images:(e.images??[]).map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.activeImageId,caption:e.caption,height:e.height??"medium"};default:return{...a,type:"text",body:"Unknown block type",width:"full",align:"left"}}}function LP(e,t,r,a,n=!1,l=!0){return{eventId:t,design:{theme:{accentColor:e.accentColor,background:{type:e.globalBackgroundType,color:e.globalBackgroundColor,assetUrl:e.globalBackgroundAsset},overlayOpacity:e.globalOverlay},layout:{width:1200,maxHeight:0},previewModes:["mobile","desktop"],blocks:e.blocks.map(o=>OP(o,e.accentColor)),flowPreset:e.flowPreset},isPublished:n,isDraft:l}}function BP(e){const{design:t}=e,r="version"in e?e.version:void 0,a="shareToken"in e?e.shareToken:void 0;return{blocks:t.blocks.map(MP),flowPreset:t.flowPreset??"serene",globalBackgroundType:t.theme.background.type??"color",globalBackgroundAsset:t.theme.background.assetUrl??"",globalBackgroundColor:t.theme.background.color??"#f6f1e4",globalOverlay:t.theme.overlayOpacity??.25,accentColor:t.theme.accentColor??"#f97316",version:r,shareToken:a??null,publicLink:null}}function PP(e){return aa({queryKey:["rsvpDesign",e],queryFn:async()=>{var t,r;try{const a=await Qe.get(l4.get(e)),n=((t=a.data)==null?void 0:t.data)??a.data;return!n||!n.design?null:BP(n)}catch(a){if(((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:5*6e4})}function IP(e){const t=Et();return At({mutationFn:async({design:r,isPublished:a=!1,isDraft:n=!0,shareToken:l,publicLink:o})=>{const u=LP(r,e,l,o,a,n);return(await Qe.post(l4.save(e),u)).data},onSuccess:()=>{t.invalidateQueries({queryKey:["rsvpDesign",e]}),t.refetchQueries({queryKey:["rsvpDesign",e]})}})}const Ka=()=>Math.random().toString(36).slice(2,9);function Wf({label:e,color:t}){return f.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full px-3 py-1 text-[11px] font-semibold uppercase tracking-wide",style:{background:`${t}15`,color:t},children:[f.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:t}}),e]})}const k_=(e,t)=>{switch(e.type){case"headline":return f.jsxs("div",{className:`text-${e.align}`.trim(),children:[f.jsx("p",{className:"text-sm uppercase tracking-[0.2em] text-white/80",children:"Welcome"}),f.jsx("h2",{className:`text-3xl font-extrabold text-white drop-shadow ${e.accent}`,children:e.title}),e.subtitle&&f.jsx("p",{className:"mt-1 text-sm text-white/80",children:e.subtitle})]});case"text":return f.jsx("p",{className:`leading-relaxed text-sm ${e.muted?"text-white/80":"text-white"}`,children:e.body});case"info":return f.jsxs("div",{className:`inline-flex items-center gap-2 rounded-full px-4 py-2 text-xs ${e.accent}`,children:[f.jsx("span",{className:"font-semibold uppercase tracking-wide",children:e.label}),f.jsx("span",{className:"text-white/80",children:e.content})]});case"formField":return f.jsxs("div",{className:`space-y-2 ${e.width==="half"?"md:w-1/2":"w-full"}`,children:[f.jsxs("label",{className:"block text-sm font-semibold text-white",children:[e.label,e.required&&f.jsx("span",{className:"ml-1 text-rose-200",children:"*"})]}),f.jsx("div",{className:"rounded-xl border border-white/30 bg-white/20 px-3 py-2 text-white/90",children:e.placeholder||"Your response"}),e.hint&&f.jsx("p",{className:"text-xs text-white/70",children:e.hint})]});case"cta":return f.jsx("div",{className:`flex ${e.align==="center"?"justify-center":e.align==="right"?"justify-end":"justify-start"}`,children:f.jsx("button",{className:"rounded-full px-6 py-2 text-sm font-semibold shadow-lg",style:{background:t,color:"#0f172a"},children:e.label})});case"image":{const r=e.images.find(n=>n.id===e.activeImageId)??e.images[0],a=e.height==="tall"?"h-72":e.height==="short"?"h-40":"h-56";return f.jsxs("div",{className:`overflow-hidden rounded-2xl border border-white/15 bg-white/5 ${a}`,children:[r?f.jsx("img",{src:r.src,alt:r.alt??"",className:"h-full w-full object-cover",loading:"lazy"}):f.jsx("div",{className:"flex h-full items-center justify-center text-white/60",children:"Upload images to show here"}),(e.caption||(r==null?void 0:r.alt))&&f.jsx("div",{className:"bg-black/35 px-3 py-2 text-xs text-white/80",children:e.caption||(r==null?void 0:r.alt)})]})}default:return null}};function UP({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,mode:o,flowPreset:u="serene"}){return f.jsxs("div",{className:`relative overflow-hidden rounded-[28px] border border-white/30 shadow-2xl ${o==="mobile"?"w-[360px] max-w-full":"w-full"} bg-gradient-to-b from-slate-900 to-black`,children:[f.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&f.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&f.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&f.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),f.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${n})`}})]}),f.jsxs("div",{className:"relative z-10 flex items-center justify-between px-4 py-3 text-[11px] uppercase tracking-[0.2em] text-white/80 bg-black/30 backdrop-blur-sm",children:[f.jsxs("span",{children:[o==="mobile"?"Mobile":"Desktop"," preview"]}),f.jsx("span",{children:"RSVP card"})]}),f.jsx("div",{className:`relative z-10 space-y-4 overflow-auto px-4 pb-6 pt-4 ${u==="stacked"?"scroll-snap-y scroll-smooth":""}`,style:{maxHeight:o==="mobile"?640:720},children:e.map((h,x)=>{var E,k;const m=((E=h.background)==null?void 0:E.images)??[],g=((k=h.background)==null?void 0:k.overlay)??.35,v=h.sectionImage,b=m.find(N=>{var _;return N.id===((_=h.background)==null?void 0:_.activeImageId)})??m[0]??v,y=u==="parallax"?"fixed":"scroll",w=u==="serene"?"shadow-xl shadow-black/20":"shadow-2xl shadow-black/30";return f.jsxs("div",{className:`group relative overflow-hidden rounded-2xl border border-white/15 bg-white/5 p-4 transition duration-500 ${u==="stacked"?"scroll-snap-start":""} ${u==="serene"?"backdrop-blur":""}`,style:{backgroundImage:b?`linear-gradient(rgba(15,23,42,${g}), rgba(15,23,42,${g})), url(${b.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:y},children:[f.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] uppercase text-white/70",children:[f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:l}}),h.type==="headline"?"Headline":h.type==="text"?"Text":h.type==="info"?"Info":h.type==="image"?"Image":h.type==="cta"?"CTA":"Form"]}),m.length>1&&f.jsxs("span",{className:"rounded-full bg-black/30 px-2 py-1",children:[m.length," bg"]})]}),f.jsx("div",{className:`space-y-3 text-white transition duration-500 ${w} ${u==="parallax"?"group-hover:translate-y-[-2px]":"group-hover:translate-y-[-1px]"}`,style:{transitionDelay:`${x*30}ms`},children:k_(h,l)}),m.length>1&&f.jsx("div",{className:"mt-3 flex gap-2 overflow-x-auto pb-1 text-[10px] text-white/80",children:m.map(N=>{var _;return f.jsx("div",{className:`h-14 w-16 flex-shrink-0 overflow-hidden rounded-lg border ${((_=h.background)==null?void 0:_.activeImageId)===N.id?"border-white":"border-white/30"}`,children:f.jsx("img",{src:N.src,alt:N.alt??"",className:"h-full w-full object-cover"})},N.id)})})]},h.id)})})]})}function zP({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,flowPreset:o="serene"}){return f.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-white",children:[f.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&f.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&f.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&f.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900/80 via-slate-950/85 to-slate-950",style:{background:`rgba(15,23,42,${n})`}})]}),f.jsx("div",{className:`relative mx-auto flex max-w-5xl flex-col gap-6 px-4 py-12 ${o==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:e.map((u,h)=>{var w,E;const x=((w=u.background)==null?void 0:w.images)??[],m=u.sectionImage,g=x.find(k=>{var N;return k.id===((N=u.background)==null?void 0:N.activeImageId)})??x[0]??m,v=((E=u.background)==null?void 0:E.overlay)??.35,b=o==="parallax"?"fixed":"scroll",y=o==="serene"?"hover:-translate-y-1":"hover:-translate-y-2";return f.jsxs("section",{className:`group relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6 shadow-2xl ring-1 ring-white/5 transition duration-500 ${o==="stacked"?"scroll-snap-start":""} ${y}`,style:{backgroundImage:g?`linear-gradient(rgba(15,23,42,${v}), rgba(15,23,42,${v})), url(${g.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:b},children:[f.jsxs("div",{className:"mb-3 flex items-center justify-between text-[11px] uppercase tracking-[0.18em] text-white/70",children:[f.jsxs("span",{className:"inline-flex items-center gap-2",children:[f.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:l}}),u.type==="headline"?"Headline":u.type==="text"?"Text":u.type==="info"?"Info":u.type==="image"?"Image":u.type==="cta"?"CTA":"Form"]}),f.jsxs("span",{className:"rounded-full bg-black/30 px-2 py-1 text-[10px]",children:["Scene ",h+1]})]}),f.jsx("div",{className:"space-y-4 text-white",children:k_(u,l)}),x.length>1&&f.jsx("div",{className:"mt-4 flex gap-2 overflow-x-auto pb-1 text-[10px] text-white/80",children:x.map(k=>{var N;return f.jsx("div",{className:`h-14 w-16 flex-shrink-0 overflow-hidden rounded-lg border ${((N=u.background)==null?void 0:N.activeImageId)===k.id?"border-white":"border-white/30"}`,children:f.jsx("img",{src:k.src,alt:k.alt??"",className:"h-full w-full object-cover"})},k.id)})})]},u.id)})})]})}function HP(){var Vs,qs,Ws;const{event:e,eventId:t}=$r()??{},{data:r=[],isFetching:a}=Bg(t,{enabled:!!t}),{data:n,isLoading:l}=PP(t??""),{mutate:o,isPending:u,isSuccess:h,data:x}=IP(t??""),[m,g]=C.useState([]),[v,b]=C.useState(!1),[y,w]=C.useState([{id:Ka(),type:"headline",title:"Welcome to our wedding",subtitle:(e==null?void 0:e.title)??"Save the date and RSVP below",align:"center",accent:"text-white",background:{images:[],overlay:.4}},{id:Ka(),type:"text",body:"Share your love story, travel tips, or invite message. Guests will scroll through each image-backed section just like an interactive invitation card.",width:"full",align:"left",muted:!0,background:{images:[],overlay:.4}},{id:Ka(),type:"formField",label:"Guest name",placeholder:"Your full name",required:!0,width:"full",hint:"Pulled from your RSVP questions",background:{images:[],overlay:.4}}]),[E,k]=C.useState(null),[N,_]=C.useState(null),[R,A]=C.useState("color"),[D,T]=C.useState(""),[F,O]=C.useState("#f6f1e4"),[U,q]=C.useState(.25),[z,te]=C.useState("#f97316"),[ce,de]=C.useState("serene"),[ee,ie]=C.useState(""),[Te,ne]=C.useState(!1),[B,Z]=C.useState("mobile"),[L,G]=C.useState(!1),[V,Q]=C.useState(null),[le,_e]=C.useState(null),[Ee,Ne]=C.useState(void 0),[Re,Ze]=C.useState(!1),K=C.useRef([]),Ae=C.useMemo(()=>y.find(re=>re.id===E)??null,[y,E]);C.useEffect(()=>{const re=r.slice().sort((Ue,$e)=>(Ue.order??0)-($e.order??0));g(re)},[r]),C.useEffect(()=>{const re=()=>G(window.innerWidth<1024);return re(),window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),C.useEffect(()=>()=>K.current.forEach(re=>URL.revokeObjectURL(re)),[]),C.useEffect(()=>{var re;((re=x==null?void 0:x.data)==null?void 0:re.version)!==void 0&&Ne(x.data.version)},[x]),C.useEffect(()=>{if(n&&!v){if(n.blocks&&n.blocks.length>0&&w(n.blocks),n.globalBackgroundType&&A(n.globalBackgroundType),n.globalBackgroundAsset&&T(n.globalBackgroundAsset),n.globalBackgroundColor&&O(n.globalBackgroundColor),n.globalOverlay!==void 0&&q(n.globalOverlay),n.accentColor&&te(n.accentColor),n.flowPreset&&de(n.flowPreset),n.version!==void 0&&Ne(n.version),n.shareToken&&(_e(n.shareToken),typeof window<"u")){const re=`${window.location.origin}/rsvp/share/${n.shareToken}`;Q(re)}b(!0)}},[n,v]);const lt=re=>re==="center"||re==="right"?re:"left",kt=re=>re==="half"?"half":"full",ot=re=>({id:re.id??re.questionId??Ka(),type:"formField",label:re.label||re.text||"Custom field",placeholder:Array.isArray(re.options)?String(re.options[0]??""):typeof re.options=="string"?re.options:"",required:re.isRequired??!1,width:"full",hint:re.typeKey?`${re.typeKey}${re.isRequired?"  required":""}`:void 0,questionId:re.id??re.questionId,background:{images:[],overlay:.4}}),Oe=re=>{const Ue=URL.createObjectURL(re);return K.current.push(Ue),{id:Ka(),src:Ue,alt:re.name}},Wt=(re,Ue)=>{const $e=y.findIndex(br=>br.id===re),Xe=y.findIndex(br=>br.id===Ue);if($e===-1||Xe===-1||$e===Xe)return;const rt=[...y],[$t]=rt.splice($e,1);rt.splice(Xe,0,$t),w(rt)},fr=re=>{if(!re)return;const Ue=URL.createObjectURL(re);K.current.push(Ue),T(Ue)},Kr=(re,Ue)=>{if(!Ue)return;const $e=Oe(Ue);w(Xe=>Xe.map(rt=>rt.id===re?{...rt,sectionImage:$e}:rt))},Hr=re=>{w(Ue=>Ue.map($e=>$e.id===re?{...$e,sectionImage:null}:$e))},Ca=(re,Ue)=>{if(!Ue||Ue.length===0)return;const $e=Array.from(Ue).map(Oe);w(Xe=>Xe.map(rt=>{var Ha,wr,Sr,Nn;if(rt.id!==re)return rt;const br=[...((Ha=rt.background)==null?void 0:Ha.images)??[],...$e],Xs=((wr=rt.background)==null?void 0:wr.activeImageId)??((Sr=br[0])==null?void 0:Sr.id);return{...rt,background:{images:br,activeImageId:Xs,overlay:((Nn=rt.background)==null?void 0:Nn.overlay)??.4}}}))},Pe=(re,Ue)=>{w($e=>$e.map(Xe=>{var rt,$t;return Xe.id===re?{...Xe,background:{...Xe.background??{images:[]},images:((rt=Xe.background)==null?void 0:rt.images)??[],activeImageId:Ue,overlay:(($t=Xe.background)==null?void 0:$t.overlay)??.4}}:Xe}))},pt=(re,Ue)=>{w($e=>$e.map(Xe=>{var rt,$t;return Xe.id===re?{...Xe,background:{...Xe.background??{images:[]},images:((rt=Xe.background)==null?void 0:rt.images)??[],activeImageId:($t=Xe.background)==null?void 0:$t.activeImageId,overlay:Ue}}:Xe}))},dr=re=>{var Xe;if(!re||re.length===0)return;const Ue=Array.from(re).map(Oe),$e={id:Ka(),type:"image",images:Ue,activeImageId:(Xe=Ue[0])==null?void 0:Xe.id,caption:"Add a caption or blessing",height:"medium",background:{images:[],overlay:.4}};w(rt=>[...rt,$e]),k($e.id)},yr=(re,Ue)=>{!Ue||Ue.length===0||w($e=>$e.map(Xe=>{var br;if(Xe.id!==re||Xe.type!=="image")return Xe;const rt=[...Xe.images,...Array.from(Ue).map(Oe)],$t=Xe.activeImageId??((br=rt[0])==null?void 0:br.id);return{...Xe,images:rt,activeImageId:$t}}))},lr=(re,Ue)=>{if(!Ue)return;const $e=Oe(Ue);w(Xe=>Xe.map(rt=>{if(rt.id!==re||rt.type!=="image")return rt;const $t=[$e,...rt.images];return{...rt,images:$t,activeImageId:$e.id}}))},Ft=re=>{const Ue={headline:{id:Ka(),type:"headline",title:"Custom headline",subtitle:"Add an optional subheader",align:"center",accent:"text-white",background:{images:[],overlay:.4}},text:{id:Ka(),type:"text",body:"Tell your guests what to expect and how to respond.",width:"full",align:"left",muted:!1,background:{images:[],overlay:.4}},info:{id:Ka(),type:"info",label:"Highlight",content:"Dress code, parking, or live stream",accent:"bg-white/20 text-white border border-white/30",background:{images:[],overlay:.4}},formField:{id:Ka(),type:"formField",label:"Custom field",placeholder:"Placeholder text",required:!1,width:"full",hint:"Use this to collect RSVP details",background:{images:[],overlay:.4}},cta:{id:Ka(),type:"cta",label:"Open RSVP",href:"#",align:"center",background:{images:[],overlay:.4}},image:{id:Ka(),type:"image",images:[],activeImageId:void 0,caption:"Add captions or blessings",height:"medium",background:{images:[],overlay:.4}}};w($e=>[...$e,Ue[re]]),k(Ue[re].id)},st=(re,Ue)=>{w($e=>$e.map(Xe=>Xe.id===re?{...Xe,...Ue}:Xe))},ct=re=>{w(Ue=>Ue.filter($e=>$e.id!==re)),E===re&&k(null)},Jt=re=>{if(!re)return;const Ue=m.find($e=>($e.id??$e.questionId)===re);Ue&&w($e=>{if($e.some(rt=>rt.type==="formField"&&rt.questionId===re))return $e;const Xe=ot(Ue);return k(Xe.id),[...$e,Xe]})},na=(re,Ue)=>{if(!Ue)return;const $e=m.find(rt=>(rt.id??rt.questionId)===Ue);if(!$e)return;const Xe=ot($e);w(rt=>rt.map($t=>$t.id!==re||$t.type!=="formField"?$t:{...$t,label:Xe.label,placeholder:Xe.placeholder,required:Xe.required,hint:Xe.hint,questionId:Ue}))},Xt=re=>({headline:"Headline",text:"Paragraph",info:"Info",formField:"Form",cta:"CTA",image:"Image"})[re],Aa=C.useMemo(()=>a?"Loading questions...":m.length===0?"No RSVP questions found for this event.":`Loaded ${m.length} questions from FormFieldsEndpoints.`,[m.length,a]),za=re=>{if(typeof window>"u")return;const Ue={eventTitle:(e==null?void 0:e.title)??"RSVP invite",blocks:y,flowPreset:ce,global:{backgroundColor:F,backgroundType:R,backgroundAsset:D,overlay:U,accentColor:z}};window.localStorage.setItem(`rsvp-share-${re}`,JSON.stringify(Ue))},Gs=()=>{if(typeof window>"u")return;const re=Ka(),Ue=`${window.location.origin}/rsvp/share/${re}`;_e(re),Q(Ue),Ze(!1),za(re)};C.useEffect(()=>{le&&za(le)},[le,y,D,F,R,U,z,ce]);const us=async()=>{!V||typeof navigator>"u"||!navigator.clipboard||(await navigator.clipboard.writeText(V),Ze(!0))},Gl=()=>{if(!t)return;o({design:{blocks:y,flowPreset:ce,globalBackgroundType:R,globalBackgroundAsset:D,globalBackgroundColor:F,globalOverlay:U,accentColor:z,shareToken:le,publicLink:V},isPublished:!1,isDraft:!0,shareToken:le,publicLink:V})};return t?f.jsxs("div",{className:"space-y-6 lg:space-y-8",children:[f.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"RSVP experience designer"}),f.jsx("h1",{className:"text-3xl font-bold text-primary",children:"Design a scrollable RSVP invite"}),f.jsx("p",{className:"max-w-3xl text-gray-600",children:"Arrange media-backed blocks, tie existing questions, and preview a wedding invite card that guests can scroll through. Editing stays on this pageopen the modal preview to see it exactly like your guests."}),l&&f.jsx("p",{className:"text-sm text-blue-600",children:"Loading saved design..."}),h&&f.jsx("p",{className:"text-sm text-green-600",children:"Design saved successfully!"})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(eu,{to:"/app/rsvps",children:f.jsx(Fe,{variant:"secondary",children:"Back to RSVP list"})}),f.jsx(Fe,{onClick:()=>ne(!0),children:"Open preview"}),f.jsx(Fe,{onClick:Gl,disabled:u||l||!t,children:u?"Saving...":h?"Saved!":"Save Design"})]})]}),f.jsxs("div",{className:"space-y-3 rounded-2xl bg-white p-4 shadow-sm",children:[f.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Shareable preview"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Generate a random public link so guests or stakeholders can see the live form experience without entering the editor."})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(Fe,{onClick:Gs,children:"Generate random link"}),V&&f.jsx("a",{className:"rounded-full bg-gray-100 px-4 py-2 text-sm font-semibold text-gray-800",href:V,target:"_blank",rel:"noreferrer",children:"Open as guest"})]})]}),V&&f.jsxs("div",{className:"flex flex-col gap-2 rounded-xl border border-dashed border-gray-200 bg-gray-50 p-3 sm:flex-row sm:items-center",children:[f.jsx("input",{value:V,readOnly:!0,className:"flex-1 rounded-lg border px-3 py-2 text-sm"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Fe,{variant:"secondary",onClick:us,children:Re?"Copied":"Copy link"}),Re&&f.jsx("span",{className:"text-xs font-semibold text-emerald-600",children:"Ready to share"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-5 xl:grid-cols-3",children:[f.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-4 shadow-sm xl:col-span-1",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Blocks & order"}),f.jsx("span",{className:"text-xs text-gray-500",children:"Drag to reorder"})]}),f.jsx("div",{className:"space-y-2",children:y.map(re=>{var $e,Xe,rt,$t;const Ue=(($e=re.background)==null?void 0:$e.images.find(br=>{var Xs;return br.id===((Xs=re.background)==null?void 0:Xs.activeImageId)}))??((rt=(Xe=re.background)==null?void 0:Xe.images)==null?void 0:rt[0]);return f.jsxs("div",{draggable:!0,onDragStart:br=>{_(re.id),br.dataTransfer.setData("text/plain",re.id)},onDragOver:br=>{br.preventDefault(),N&&N!==re.id&&Wt(N,re.id)},onDragEnd:()=>_(null),className:`flex items-center gap-3 rounded-xl border px-3 py-2 transition ${E===re.id?"border-primary bg-primary/5":"border-gray-200 bg-gray-50"}`,children:[f.jsxs("button",{type:"button",onClick:()=>k(re.id),className:"flex-1 text-left",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-gray-800",children:[f.jsx("span",{children:Xt(re.type)}),f.jsxs("span",{className:"text-xs text-gray-500",children:[(($t=re.background)==null?void 0:$t.images.length)??0," bg"]})]}),re.type==="headline"&&f.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:re.title}),re.type==="formField"&&f.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:re.label})]}),Ue?f.jsx("img",{src:Ue.src,alt:Ue.alt??"",className:"h-12 w-12 rounded-lg object-cover"}):f.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg border border-dashed text-xs text-gray-400",children:"BG"})]},re.id)})}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>Ft("headline"),children:"Add headline"}),f.jsx(Fe,{variant:"secondary",onClick:()=>Ft("text"),children:"Add text"}),f.jsx(Fe,{variant:"secondary",onClick:()=>Ft("info"),children:"Add info"}),f.jsx(Fe,{variant:"secondary",onClick:()=>Ft("formField"),children:"Add form field"}),f.jsx(Fe,{variant:"secondary",onClick:()=>Ft("cta"),children:"Add CTA"}),f.jsxs("label",{className:"flex cursor-pointer items-center justify-center rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm font-semibold text-primary hover:border-primary",children:["Upload images",f.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:re=>dr(re.target.files)})]})]}),f.jsxs("div",{className:"space-y-2 rounded-xl border border-dashed border-gray-200 bg-gray-50 p-3",children:[f.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Insert RSVP question"}),f.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[f.jsxs("select",{value:ee,onChange:re=>ie(re.target.value),className:"flex-1 rounded-lg border px-3 py-2 text-sm",children:[f.jsx("option",{value:"",children:"Select from FormFieldsEndpoints"}),m.map(re=>f.jsx("option",{value:re.id??re.questionId,children:re.label||re.text||re.name},re.id??re.questionId))]}),f.jsx(Fe,{className:"sm:w-auto",disabled:!ee,onClick:()=>{Jt(ee),ie("")},children:"Add"})]}),f.jsx("p",{className:"text-xs text-gray-500",children:Aa})]})]}),f.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-4 shadow-sm xl:col-span-2",children:[f.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("h2",{className:"text-lg font-semibold",children:"Editor"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Pick a block to edit its content, gallery, and overlays."})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>ne(!0),children:"Preview"}),f.jsx(Wf,{label:"Mobile friendly",color:"#f97316"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[f.jsxs("div",{className:"space-y-4 rounded-xl border border-gray-200 p-4 lg:col-span-1",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Global background"}),f.jsx("div",{className:"grid grid-cols-3 gap-2 text-sm font-semibold",children:["color","image","video"].map(re=>f.jsx("button",{onClick:()=>A(re),className:`rounded-lg border px-2 py-2 ${R===re?"border-primary text-primary":"border-gray-200 text-gray-700"}`,children:re.toUpperCase()},re))}),R==="color"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Background color"}),f.jsx("input",{type:"color",value:F,onChange:re=>O(re.target.value),className:"h-10 w-full rounded"})]}),R!=="color"&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"text-sm text-gray-600",children:["Upload ",R]}),f.jsx("input",{type:"file",accept:R==="video"?"video/*":"image/*",onChange:re=>{var Ue;return fr((Ue=re.target.files)==null?void 0:Ue[0])},className:"w-full"}),D&&f.jsxs("p",{className:"text-xs text-gray-500",children:["Asset attached  ",R]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Global overlay"}),f.jsx("input",{type:"range",min:0,max:.8,step:.05,value:U,onChange:re=>q(parseFloat(re.target.value)),className:"w-full"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Keeps text readable over photos or videos."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Accent color"}),f.jsx("input",{type:"color",value:z,onChange:re=>te(re.target.value),className:"h-10 w-full rounded"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Invite flow"}),f.jsx("div",{className:"grid grid-cols-3 gap-2 text-sm font-semibold",children:["serene","parallax","stacked"].map(re=>f.jsx("button",{onClick:()=>de(re),className:`rounded-lg border px-2 py-2 ${ce===re?"border-primary text-primary":"border-gray-200 text-gray-700"}`,children:re==="serene"?"Serene":re==="parallax"?"Parallax":"Stacked"},re))}),f.jsx("p",{className:"text-xs text-gray-500",children:"Pick how blocks animate and snap while guests scroll."})]})]}),f.jsxs("div",{className:"lg:col-span-2",children:[!Ae&&f.jsxs("div",{className:"flex h-full flex-col items-center justify-center rounded-xl border border-dashed border-gray-200 bg-gray-50 p-6 text-center text-gray-500",children:[f.jsx("p",{className:"text-lg font-semibold text-gray-700",children:"Select a block to edit"}),f.jsx("p",{className:"text-sm",children:"Choose from the order list to the left to edit text, backgrounds, or linked questions."})]}),Ae&&f.jsxs("div",{className:"space-y-4 rounded-xl border border-gray-200 bg-white p-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Editing ",Xt(Ae.type)]}),f.jsx("button",{onClick:()=>ct(Ae.id),className:"text-sm font-semibold text-rose-600",children:"Remove"})]}),f.jsxs("div",{className:"space-y-3 rounded-lg border bg-gray-50 p-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Block background gallery"}),f.jsxs("span",{className:"text-xs text-gray-500",children:[((Vs=Ae.background)==null?void 0:Vs.images.length)??0," images"]})]}),f.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Upload images for this block",f.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:re=>Ca(Ae.id,re.target.files),className:"mt-1 w-full text-sm"})]}),(qs=Ae.background)!=null&&qs.images.length?f.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:Ae.background.images.map(re=>{var Ue;return f.jsx("button",{onClick:()=>Pe(Ae.id,re.id),className:`h-16 w-20 flex-shrink-0 overflow-hidden rounded-lg border ${((Ue=Ae.background)==null?void 0:Ue.activeImageId)===re.id?"border-primary ring-2 ring-primary/30":"border-gray-200"}`,type:"button",children:f.jsx("img",{src:re.src,alt:re.alt??"Background option",className:"h-full w-full object-cover"})},re.id)})}):f.jsx("p",{className:"text-xs text-gray-500",children:"No block-specific background yet. Add one to mirror the sample experience."}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-700",children:"Overlay strength"}),f.jsx("input",{type:"range",min:0,max:.9,step:.05,value:((Ws=Ae.background)==null?void 0:Ws.overlay)??.4,onChange:re=>pt(Ae.id,parseFloat(re.target.value)),className:"w-full"})]})]}),f.jsxs("div",{className:"space-y-2 rounded-lg border bg-white p-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Section spotlight background"}),Ae.sectionImage&&f.jsx("button",{type:"button",onClick:()=>Hr(Ae.id),className:"text-xs font-semibold text-rose-600",children:"Remove"})]}),f.jsx("p",{className:"text-xs text-gray-500",children:"Attach a dedicated backdrop for this block. It sits behind the content so every section carries its own hero moment."}),f.jsx("input",{type:"file",accept:"image/*",onChange:re=>{var Ue;return Kr(Ae.id,(Ue=re.target.files)==null?void 0:Ue[0])},className:"w-full text-sm"}),Ae.sectionImage&&f.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:f.jsx("img",{src:Ae.sectionImage.src,alt:Ae.sectionImage.alt??"Section image",className:"h-36 w-full object-cover"})})]}),Ae.type==="headline"&&f.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Title"}),f.jsx("input",{value:Ae.title,onChange:re=>st(Ae.id,{title:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Subtitle"}),f.jsx("input",{value:Ae.subtitle??"",onChange:re=>st(Ae.id,{subtitle:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Alignment"}),f.jsxs("select",{value:Ae.align,onChange:re=>st(Ae.id,{align:lt(re.target.value)}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"left",children:"Left"}),f.jsx("option",{value:"center",children:"Center"}),f.jsx("option",{value:"right",children:"Right"})]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Accent classes"}),f.jsx("input",{value:Ae.accent,onChange:re=>st(Ae.id,{accent:re.target.value}),className:"w-full rounded-lg border px-3 py-2",placeholder:"e.g. text-white"})]})]}),Ae.type==="text"&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Body"}),f.jsx("textarea",{value:Ae.body,onChange:re=>st(Ae.id,{body:re.target.value}),className:"w-full rounded-lg border px-3 py-2",rows:4})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Width"}),f.jsxs("select",{value:Ae.width,onChange:re=>st(Ae.id,{width:kt(re.target.value)}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"full",children:"Full"}),f.jsx("option",{value:"half",children:"Half"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Alignment"}),f.jsxs("select",{value:Ae.align,onChange:re=>st(Ae.id,{align:lt(re.target.value)}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"left",children:"Left"}),f.jsx("option",{value:"center",children:"Center"}),f.jsx("option",{value:"right",children:"Right"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"checkbox",checked:!!Ae.muted,onChange:re=>st(Ae.id,{muted:re.target.checked})}),f.jsx("span",{className:"text-sm text-gray-600",children:"Use softer text tone"})]})]}),Ae.type==="info"&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Label"}),f.jsx("input",{value:Ae.label,onChange:re=>st(Ae.id,{label:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Content"}),f.jsx("input",{value:Ae.content,onChange:re=>st(Ae.id,{content:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Accent classes"}),f.jsx("input",{value:Ae.accent,onChange:re=>st(Ae.id,{accent:re.target.value}),className:"w-full rounded-lg border px-3 py-2",placeholder:"e.g. bg-white/20 text-white"})]})]}),Ae.type==="formField"&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Link to existing question"}),f.jsxs("select",{value:Ae.questionId??"",onChange:re=>na(Ae.id,re.target.value||void 0),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"",children:"Choose a question"}),m.map(re=>f.jsx("option",{value:re.id??re.questionId,children:re.label||re.text||re.name},re.id??re.questionId))]}),f.jsx("p",{className:"text-xs text-gray-500",children:"Pulled from FormFieldsEndpoints."})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Label"}),f.jsx("input",{value:Ae.label,onChange:re=>st(Ae.id,{label:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Placeholder"}),f.jsx("input",{value:Ae.placeholder??"",onChange:re=>st(Ae.id,{placeholder:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Width"}),f.jsxs("select",{value:Ae.width,onChange:re=>st(Ae.id,{width:kt(re.target.value)}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"full",children:"Full"}),f.jsx("option",{value:"half",children:"Half"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Required"}),f.jsxs("select",{value:Ae.required?"yes":"no",onChange:re=>st(Ae.id,{required:re.target.value==="yes"}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"yes",children:"Yes"}),f.jsx("option",{value:"no",children:"No"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Hint"}),f.jsx("input",{value:Ae.hint??"",onChange:re=>st(Ae.id,{hint:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]})]}),Ae.type==="cta"&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Label"}),f.jsx("input",{value:Ae.label,onChange:re=>st(Ae.id,{label:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Link"}),f.jsx("input",{value:Ae.href??"",onChange:re=>st(Ae.id,{href:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Alignment"}),f.jsxs("select",{value:Ae.align,onChange:re=>st(Ae.id,{align:lt(re.target.value)}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"left",children:"Left"}),f.jsx("option",{value:"center",children:"Center"}),f.jsx("option",{value:"right",children:"Right"})]})]})]}),Ae.type==="image"&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Caption"}),f.jsx("input",{value:Ae.caption??"",onChange:re=>st(Ae.id,{caption:re.target.value}),className:"w-full rounded-lg border px-3 py-2"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Replace first image",f.jsx("input",{type:"file",accept:"image/*",className:"mt-1 w-full",onChange:re=>{var Ue;return lr(Ae.id,(Ue=re.target.files)==null?void 0:Ue[0])}})]}),f.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Add more images",f.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"mt-1 w-full",onChange:re=>yr(Ae.id,re.target.files)})]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-sm text-gray-600",children:"Height"}),f.jsxs("select",{value:Ae.height??"medium",onChange:re=>st(Ae.id,{height:re.target.value==="tall"?"tall":re.target.value==="short"?"short":"medium"}),className:"w-full rounded-lg border px-3 py-2",children:[f.jsx("option",{value:"short",children:"Compact"}),f.jsx("option",{value:"medium",children:"Standard"}),f.jsx("option",{value:"tall",children:"Tall"})]})]}),Ae.images.length>0&&f.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:Ae.images.map(re=>f.jsx("button",{type:"button",onClick:()=>st(Ae.id,{activeImageId:re.id}),className:`h-16 w-20 overflow-hidden rounded-lg border ${Ae.activeImageId===re.id?"border-primary ring-2 ring-primary/30":"border-gray-200"}`,children:f.jsx("img",{src:re.src,alt:re.alt??"",className:"h-full w-full object-cover"})},re.id))}),f.jsx("p",{className:"text-xs text-gray-500",children:"Upload multiple images to let guests scroll through each scene."})]})]})]})]})]})]}),Te&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 px-4 py-6",children:f.jsxs("div",{className:"relative w-full max-w-6xl rounded-2xl bg-white shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Preview"}),f.jsx("p",{className:"text-lg font-semibold text-gray-800",children:(e==null?void 0:e.title)??"Your RSVP invite"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"hidden gap-2 rounded-full bg-gray-100 p-1 text-sm font-semibold text-gray-700 md:flex",children:[f.jsx("button",{className:`rounded-full px-3 py-1 ${B==="mobile"?"bg-white shadow":""}`,onClick:()=>Z("mobile"),children:"Mobile"}),f.jsx("button",{className:`rounded-full px-3 py-1 ${B==="desktop"?"bg-white shadow":""}`,onClick:()=>Z("desktop"),children:"Desktop"})]}),L&&f.jsx("span",{className:"rounded-full bg-amber-100 px-3 py-1 text-xs font-semibold text-amber-700",children:"Tap blocks to scroll"}),f.jsx("button",{className:"rounded-full bg-gray-100 px-3 py-1 text-sm font-semibold text-gray-700",onClick:()=>ne(!1),children:"Close"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-4 p-5 md:grid-cols-2 md:items-start",children:[f.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[f.jsx("p",{children:"Your invite mirrors the reference layout: a scrollable gallery with per-block backgrounds, overlaid text, and RSVP questions tied directly to your event. Guests can swipe through images, read the story, and respond without leaving the card."}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx(Wf,{label:`${y.length} blocks`,color:"#0ea5e9"}),f.jsx(Wf,{label:`${y.reduce((re,Ue)=>{var $e;return re+((($e=Ue.background)==null?void 0:$e.images.length)??0)},0)} background images`,color:"#f97316"}),f.jsx(Wf,{label:`${y.filter(re=>re.type==="formField").length} questions`,color:"#22c55e"})]}),f.jsxs("ul",{className:"list-disc space-y-1 pl-5 text-sm text-gray-600",children:[f.jsx("li",{children:"Each block carries its own gallery so photos and copy stay paired."}),f.jsx("li",{children:"RSVP fields come directly from FormFieldsEndpoints for the selected event."}),f.jsx("li",{children:"Preview stays separate from editing for a clean CMS experience."})]})]}),f.jsx("div",{className:"flex w-full justify-center md:justify-end",children:f.jsx(UP,{blocks:y,backgroundAsset:D,backgroundColor:F,backgroundType:R,overlay:U,accentColor:z,mode:B,flowPreset:ce})})]})]})})]}):f.jsx(uc,{title:"No Event for RSVP Design",message:"Create your first event to start customizing your RSVP page design."})}function GP(){var l;const{token:e}=Gn(),[t,r]=C.useState(null);C.useEffect(()=>{if(!e||typeof window>"u")return;const o=window.localStorage.getItem(`rsvp-share-${e}`);if(o)try{r(JSON.parse(o))}catch{r(null)}},[e]);const a=(t==null?void 0:t.global)??{},n=(t==null?void 0:t.flowPreset)??"serene";return f.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-950 to-black px-4 py-10 text-white",children:f.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-6",children:[f.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Guest preview"}),f.jsx("h1",{className:"text-3xl font-bold",children:(t==null?void 0:t.eventTitle)??"Shared RSVP preview"}),f.jsx("p",{className:"text-sm text-white/70",children:"This view mirrors the public invite experience generated from the designer."})]}),f.jsx(eu,{to:"/login",children:f.jsx(Fe,{variant:"secondary",children:"Back to dashboard"})})]}),(l=t==null?void 0:t.blocks)!=null&&l.length?f.jsx("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-white/5 shadow-2xl",children:f.jsx(zP,{blocks:t.blocks,backgroundAsset:a.backgroundAsset??"",backgroundColor:a.backgroundColor??"#0f172a",backgroundType:a.backgroundType??"color",overlay:a.overlay??.3,accentColor:a.accentColor??"#f97316",flowPreset:n})}):f.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6 text-white/80",children:[f.jsx("p",{className:"text-lg font-semibold text-white",children:"This preview link is empty."}),f.jsx("p",{className:"text-sm",children:"Ask the host to regenerate a link from the designer so you can view the invite card."})]})]})})}function Zd(e){return aa({queryKey:["guests",e],queryFn:async()=>{var n;const t=await Qe.get(nu.all(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:[]).map(l=>({id:l.guestId??l.id,guestId:l.guestId,eventId:l.eventId,eventGuid:l.eventGuid,rsvpId:l.rsvpId,tableId:l.tableId??void 0,name:l.name??"",phoneNo:l.phoneNo??"",pax:l.pax??1,groupId:l.groupId,seatIndex:l.seatIndex,flag:l.flag,notes:l.notes??"",createdDate:l.createdDate,lastUpdated:l.lastUpdated,isDeleted:l.isDeleted??!1,createdBy:l.createdBy??"",updatedBy:l.updatedBy??"",guestName:l.name??"",noOfPax:l.pax??1,guestType:l.flag||l.groupId||"Other",remarks:l.notes??"",status:"Confirmed"}))},staleTime:6e4,enabled:!!e})}function Ig(e){const t=Et();return At({mutationFn:({guestId:r,tableId:a})=>Qe.post(nu.assignTable(r,a)).then(n=>n.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function Ug(e){const t=Et();return At({mutationFn:r=>Qe.post(nu.unassignTable(r)).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function Jd(e){return aa({queryKey:["tables",e],queryFn:async()=>{var n;const r=(await Qe.get(Ui.all(e))).data;let a=((n=r==null?void 0:r.data)==null?void 0:n.tables)||(r==null?void 0:r.tables)||(r==null?void 0:r.data)||r||[];return Array.isArray(a)?a.map(l=>{var o;return{id:l.tableId,name:l.tableName,capacity:l.maxSeats,guests:l.guests||[],assignedCount:l.assignedCount??((o=l.guests)==null?void 0:o.length)??0,extraGuests:l.extraGuests,layout:l.layout}}):(console.warn("Unexpected tables API response format:",r),[])},enabled:!!e,staleTime:5*6e4})}function yu(e){return aa({queryKey:["tables",e],queryFn:()=>Qe.get(Ui.byId(e)).then(t=>t.data),enabled:!!e})}function qi(e,t,r){t&&(e.invalidateQueries({queryKey:["tables",t]}),e.refetchQueries({queryKey:["tables",t]})),r&&(e.invalidateQueries({queryKey:["tables",r]}),e.invalidateQueries({queryKey:["rsvps",r]}),e.invalidateQueries({queryKey:["guests",r]}),e.refetchQueries({queryKey:["tables",r]}),e.refetchQueries({queryKey:["rsvps",r]}),e.refetchQueries({queryKey:["guests",r]})),!t&&!r&&(e.invalidateQueries({queryKey:["tables"]}),e.refetchQueries({queryKey:["tables"]}))}function VP(e){const t=Et();return At({mutationFn:({name:r,capacity:a,eventId:n})=>Qe.post(Ui.create,{eventGuid:n,tableName:r,maxSeats:a}).then(l=>l.data),onSuccess:()=>qi(t,void 0,e)})}function qP(e){const t=Et();return At({mutationFn:({eventGuid:r,tableName:a,quantity:n,maxSeats:l})=>Qe.post(Ui.bulkCreate,{eventGuid:r,tableName:a,quantity:n,maxSeats:l}).then(o=>o.data),onSuccess:()=>qi(t,void 0,e)})}function WP(e,t){const r=Et();return At({mutationFn:({name:a,capacity:n})=>Qe.post(Ui.update,{tableId:e,tableName:a,maxSeats:n}).then(l=>l.data),onSuccess:()=>qi(r,e,t)})}function XP(e){const t=Et();return At({mutationFn:r=>Qe.delete(Ui.delete(r)).then(a=>a.data),onSuccess:()=>qi(t,void 0,e)})}function YP(e,t){const r=Et();return At({mutationFn:({extraGuests:a,tableName:n,maxSeats:l})=>Qe.post(Ui.update,{tableId:e,tableName:n,maxSeats:l,extraGuests:a}).then(o=>o.data),onSuccess:()=>qi(r,e,t)})}function $P(e,t){const r=Et();return At({mutationFn:({layout:a})=>Qe.put(Ui.updateLayout(e),{layout:a}).then(n=>n.data),onSuccess:()=>qi(r,e,t)})}function KP(e){const t=Et();return At({mutationFn:({guestId:r,tableId:a})=>Qe.post(nu.assignTable(r,a),{}).then(n=>n.data),onSuccess:()=>qi(t,void 0,e)})}function QP(e){const t=Et();return At({mutationFn:r=>Qe.post(nu.unassignTable(r),{}).then(a=>a.data),onSuccess:()=>qi(t,void 0,e)})}const wn=({label:e,value:t,variant:r="primary",icon:a})=>{const n={primary:"text-primary bg-primary/5 border-primary/20",secondary:"text-secondary bg-secondary/5 border-secondary/20",accent:"text-button bg-button/5 border-button/20",success:"text-green-600 bg-green-50 border-green-200 dark:text-green-400 dark:bg-green-900/20 dark:border-green-700/30",warning:"text-amber-600 bg-amber-50 border-amber-200 dark:text-amber-400 dark:bg-amber-900/20 dark:border-amber-700/30"},l={primary:"text-primary",secondary:"text-secondary",accent:"text-button",success:"text-green-600 dark:text-green-400",warning:"text-amber-600 dark:text-amber-400"};return f.jsx("div",{className:`p-4 rounded-xl border ${n[r]} transition-all hover:shadow-md`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1",children:e}),f.jsx("p",{className:`text-2xl font-bold ${l[r]}`,children:t})]}),a&&f.jsx("div",{className:`ml-3 ${l[r]} opacity-80`,children:a})]})})},ZP=({isOpen:e,onClose:t,guest:r,eventId:a})=>{const{user:n}=lu(),l=Mg(a),o=Lg(a),{data:u=[]}=Jd(a),[h,x]=C.useState(""),[m,g]=C.useState(""),[v,b]=C.useState("Family"),[y,w]=C.useState(""),[E,k]=C.useState("");C.useEffect(()=>{e&&r?(x(r.guestName||r.name||""),g(r.phoneNo||""),b(r.guestType||"Family"),w(r.notes||""),k(r.tableId||"")):e&&!r&&(x(""),g(""),b("Family"),w(""),k(""))},[e,r]);const N=async _=>{if(_.preventDefault(),!h.trim()){bn.error("Guest name is required");return}const R=(n==null?void 0:n.id)??(n==null?void 0:n.name)??"System";try{const A={eventId:a,guestName:h.trim(),phoneNo:m.trim(),guestType:v,remarks:y.trim(),tableId:E||void 0,status:"Yes"};r?(await o.mutateAsync({id:r.rsvpId??r.guestId??r.id,...A,updatedBy:R}),bn.success(`${h} updated successfully`)):(await l.mutateAsync({...A,createdBy:R}),bn.success(`${h} created successfully`)),t()}catch(A){console.error("Guest save error:",A),bn.error(`Failed to ${r?"update":"create"} guest`)}};return f.jsx(qn,{isOpen:e,onClose:t,title:r?"Edit Guest":"New Guest",children:f.jsxs("form",{onSubmit:N,className:"space-y-4",children:[f.jsx(sr,{label:"Guest Name",value:h,onChange:_=>x(_.target.value),required:!0}),f.jsx(sr,{label:"Phone Number",value:m,onChange:_=>g(_.target.value),type:"text"}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Guest Type"}),f.jsx("select",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:v,onChange:_=>b(_.target.value),children:["Family","VIP","Friend","Other"].map(_=>f.jsx("option",{value:_,children:_},_))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Table Assignment (Optional)"}),f.jsxs("select",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:E,onChange:_=>k(_.target.value),children:[f.jsx("option",{value:"",children:"Unassigned"}),u.map(_=>f.jsxs("option",{value:_.id,children:[_.name," (Capacity: ",_.capacity,")"]},_.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Remarks / Notes"}),f.jsx("textarea",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:y,onChange:_=>w(_.target.value),rows:3,placeholder:"Any special notes about this guest..."})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",loading:l.isPending||o.isPending,children:r?"Save Changes":"Create Guest"})]})]})})};function JP(){const{eventId:e}=$r(),{data:t=[],isLoading:r,isError:a}=Zd(e),{data:n=[],isLoading:l}=Jd(e),o=Ig(e),u=Ug(e),[h,x]=C.useState("All"),[m,g]=C.useState(""),[v,b]=C.useState({open:!1}),[y,w]=C.useState({open:!1}),E=C.useMemo(()=>{const A=t.length,D=t.filter(O=>O.tableId).length,T=t.filter(O=>!O.tableId).length,F=t.filter(O=>O.guestType==="VIP").length;return{total:A,assigned:D,unassigned:T,vips:F}},[t]),k=C.useMemo(()=>{const A=new Map;return n.forEach(D=>{A.set(D.id,D.name)}),A},[n]),N=C.useMemo(()=>t.filter(A=>{const D=h==="All"||A.guestType===h,T=(A.guestName??A.name??"").toLowerCase().includes(m.toLowerCase());return D&&T}),[t,h,m]);if(!e)return f.jsx(uc,{title:"No Events for Guest Management",message:"Create your first event to start adding and managing your guest list."});if(r||l)return f.jsx("p",{children:"Loading guests"});if(a)return f.jsx("p",{children:"Failed to load guests."});const _=async(A,D)=>{try{await o.mutateAsync({guestId:A.guestId??A.id,tableId:D}),bn.success(`${A.guestName||A.name} assigned to table successfully`),w({open:!1})}catch(T){console.error("Assign table error:",T),bn.error("Failed to assign guest to table")}},R=async A=>{if(window.confirm(`Remove ${A.guestName||A.name} from ${k.get(A.tableId||"")}?`))try{await u.mutateAsync(A.guestId??A.id),bn.success(`${A.guestName||A.name} unassigned from table successfully`)}catch(D){console.error("Unassign table error:",D),bn.error("Failed to unassign guest from table")}};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[f.jsx(wn,{label:"Total Guests",value:E.total,variant:"primary",icon:f.jsx(sd,{className:"h-6 w-6"})}),f.jsx(wn,{label:"Assigned",value:E.assigned,variant:"success",icon:f.jsx(id,{className:"h-6 w-6"})}),f.jsx(wn,{label:"Unassigned",value:E.unassigned,variant:"warning",icon:f.jsx(id,{className:"h-6 w-6"})}),f.jsx(wn,{label:"VIPs",value:E.vips,variant:"accent",icon:f.jsx(id,{className:"h-6 w-6"})})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Guests"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:f.jsxs("div",{className:"px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl text-sm text-blue-700 dark:text-blue-300",children:[f.jsx("span",{className:"font-medium",children:"Note:"})," Guests are automatically created when RSVP submissions include attendees (pax > 0). ",f.jsx("br",{}),"Guest deletion is only available through the RSVP module."]})})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[f.jsx("select",{value:h,onChange:A=>x(A.target.value),className:"w-full md:w-1/4 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10",children:["All","Family","VIP","Friend","Other"].map(A=>f.jsx("option",{value:A,children:A},A))}),f.jsx("input",{type:"text",placeholder:"Search guests by name...",value:m,onChange:A=>g(A.target.value),className:"w-full md:flex-1 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10"})]}),N.length===0&&f.jsxs("div",{className:"text-center py-12",children:[f.jsx(sd,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m||h!=="All"?"No guests match your filters":"No guests yet. Create your first guest!"})]}),N.length>0&&f.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:N.map(A=>{const D=!!A.tableId;return f.jsxs("li",{className:`relative p-4 rounded-lg shadow flex flex-col justify-between transition-all ${D?"bg-green-50 dark:bg-green-900/10 border-2 border-green-200 dark:border-green-800":"bg-orange-50 dark:bg-orange-900/10 border-2 border-orange-200 dark:border-orange-800"}`,children:[f.jsx("span",{className:`absolute top-2 right-2 px-3 py-1 text-xs font-bold rounded-full ${D?"bg-green-600 text-white":"bg-orange-600 text-white"}`,children:D?"ASSIGNED":"UNASSIGNED"}),f.jsxs("div",{className:"space-y-2 mt-6",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.guestName}),A.phoneNo&&f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Phone: ",A.phoneNo]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(sd,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),f.jsxs("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[A.pax||A.noOfPax||1," ",(A.pax||A.noOfPax||1)===1?"person":"people",(A.pax||A.noOfPax||1)>1&&f.jsxs("span",{className:"ml-2 text-xs font-bold text-primary",children:["(+",(A.pax||A.noOfPax||1)-1,")"]})]})]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:f.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-sm font-medium border-2 ${A.guestType==="Family"?"border-blue-600 text-blue-600 dark:border-blue-400 dark:text-blue-400":A.guestType==="VIP"?"border-purple-600 text-purple-600 dark:border-purple-400 dark:text-purple-400":A.guestType==="Friend"?"border-indigo-600 text-indigo-600 dark:border-indigo-400 dark:text-indigo-400":"border-gray-400 text-gray-600 dark:border-gray-500 dark:text-gray-400"}`,children:A.guestType||"Other"})}),f.jsxs("div",{className:`mt-3 p-3 rounded-lg ${D?"bg-green-100 dark:bg-green-900/30":"bg-orange-100 dark:bg-orange-900/30"}`,children:[f.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Table Seating:"}),A.tableId?f.jsx("p",{className:"text-sm font-bold text-green-800 dark:text-green-300",children:k.get(A.tableId)||"Unknown Table"}):f.jsx("p",{className:"text-sm font-bold text-orange-800 dark:text-orange-300",children:"No table assigned"})]})]}),f.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>b({open:!0,guest:A}),children:"Edit"}),A.tableId?f.jsx(Fe,{variant:"secondary",onClick:()=>R(A),className:"!bg-orange-600 !text-white hover:!bg-orange-700",children:"Unassign"}):f.jsx(Fe,{variant:"primary",onClick:()=>w({open:!0,guest:A}),className:"!bg-green-600 !text-white hover:!bg-green-700",children:"Assign Table"})]})]},A.id)})}),f.jsx(ZP,{isOpen:v.open,onClose:()=>b({open:!1}),guest:v.guest,eventId:e}),y.open&&y.guest&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white dark:bg-accent rounded-xl shadow-xl max-w-md w-full p-6",children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:["Assign ",y.guest.guestName," to Table"]}),f.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.length===0?f.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No tables available. Please create tables first."}):n.map(A=>f.jsxs("button",{onClick:()=>_(y.guest,A.id),className:"w-full text-left p-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 hover:border-primary dark:hover:border-primary hover:bg-primary/5 transition-colors",children:[f.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:A.name}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",A.capacity]})]},A.id))}),f.jsx("div",{className:"mt-4 flex justify-end",children:f.jsx(Fe,{variant:"secondary",onClick:()=>w({open:!1}),children:"Cancel"})})]})})]})}const eI=({trigger:e,children:t,className:r=""})=>{const[a,n]=C.useState(!1),l=C.useRef(null);C.useEffect(()=>{const h=x=>{l.current&&!l.current.contains(x.target)&&n(!1)};return a&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[a]);const o=h=>{h(),n(!1)},u=Oi.Children.map(t,h=>Oi.isValidElement(h)&&h.type===Cp?Oi.cloneElement(h,{onClick:()=>o(h.props.onClick)}):h);return f.jsxs("div",{className:`relative inline-block ${r}`,ref:l,children:[f.jsx("div",{onClick:()=>n(!a),className:"cursor-pointer",children:e}),a&&f.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-xl shadow-lg bg-white dark:bg-accent border border-gray-200 dark:border-gray-700 z-50 overflow-hidden",children:f.jsx("div",{className:"py-1",children:u})})]})},Cp=({onClick:e,children:t,className:r=""})=>f.jsx("button",{onClick:e,className:`w-full text-left px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-white/10 transition-colors ${r}`,children:t}),tI=({guest:e,onDragStart:t,onDragEnd:r,isDragging:a=!1})=>{var h;const[n,l]=C.useState(!1),o=x=>{x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("guestId",e.id),t==null||t(e.id)},u=()=>{r==null||r()};return f.jsxs("div",{draggable:"true",onDragStart:o,onDragEnd:u,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:`
        p-3 rounded-lg border-2 border-dashed border-gray-200 
        bg-white dark:bg-accent/50 dark:border-gray-600
        transition-all cursor-grab active:cursor-grabbing
        touch-none select-none
        ${n?"border-primary bg-indigo-50 dark:bg-primary/10 shadow-md":""}
        ${a?"opacity-50":"opacity-100"}
      `,role:"button",tabIndex:0,"aria-label":`Drag ${e.guestName} to assign to a table`,children:[f.jsxs("div",{className:"flex items-start justify-between mb-2",children:[f.jsx("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white",children:e.guestName}),e.paxCount&&e.paxCount>1&&f.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-xs font-medium text-gray-700 dark:text-gray-300 rounded",children:["+",e.paxCount-1]})]}),e.phoneNo&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:e.phoneNo}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.isVip&&f.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-300 text-xs font-medium rounded-full",children:"VIP"}),(h=e.dietaryRestrictions)==null?void 0:h.map((x,m)=>f.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium rounded-full",children:x},m))]})]})},rI=({table:e,onDrop:t,onEdit:r,onDelete:a,onUnassignGuest:n,draggedGuest:l})=>{const[o,u]=C.useState(!1),h=e.capacity-e.assignedCount,x=l?l.paxCount<=h:h>0,g={vip:{header:"from-purple-50 to-white dark:from-purple-900/20 dark:to-accent",icon:"from-purple-500 to-purple-700",badge:"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300"},"family-bride":{header:"from-pink-50 to-white dark:from-pink-900/20 dark:to-accent",icon:"from-pink-500 to-rose-600",badge:"bg-pink-100 text-pink-800 dark:bg-pink-900/40 dark:text-pink-300"},"family-groom":{header:"from-blue-50 to-white dark:from-blue-900/20 dark:to-accent",icon:"from-blue-500 to-blue-700",badge:"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300"},friends:{header:"from-green-50 to-white dark:from-green-900/20 dark:to-accent",icon:"from-green-500 to-emerald-600",badge:"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"},colleagues:{header:"from-orange-50 to-white dark:from-orange-900/20 dark:to-accent",icon:"from-orange-500 to-amber-600",badge:"bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"}}[e.category||"friends"],v=e.assignedCount/e.capacity*100,b=e.assignedCount>=e.capacity,y=k=>{x&&(k.preventDefault(),k.dataTransfer.dropEffect="move",u(!0))},w=()=>{u(!1)},E=k=>{if(k.preventDefault(),u(!1),!x)return;const N=k.dataTransfer.getData("guestId");N&&t&&t(N,e.id)};return f.jsxs("div",{onDragOver:y,onDragLeave:w,onDrop:E,className:`
        relative rounded-xl shadow-lg overflow-hidden transition-all
        ${o&&x?"ring-4 ring-primary ring-offset-2 shadow-2xl scale-[1.02]":""}
        ${!x&&l?"opacity-50 cursor-not-allowed":""}
        ${b?"opacity-75":""}
        hover:shadow-xl
      `,role:"region","aria-label":`${e.name} - ${e.assignedCount} of ${e.capacity} seats filled`,children:[f.jsxs("div",{className:`bg-gradient-to-r ${g.header} p-4 border-b`,children:[f.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white mb-1",children:e.name}),e.category&&f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g.badge}`,children:e.category})})]}),f.jsxs("div",{className:"bg-white dark:bg-accent p-4",children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[f.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Seats"}),f.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[e.assignedCount," / ",e.capacity]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:f.jsx("div",{className:`h-full transition-all duration-300 ${b?"bg-green-500":v>80?"bg-amber-500":"bg-primary"}`,style:{width:`${Math.min(v,100)}%`}})})]}),f.jsx("div",{className:"space-y-2 mb-4 max-h-48 overflow-y-auto",children:e.guests.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-4",children:"No guests assigned yet"}):e.guests.map(k=>f.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-gray-50 dark:bg-gray-800 group hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[f.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-sm font-bold flex-shrink-0",children:k.guestName.charAt(0).toUpperCase()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:k.guestName}),k.paxCount&&k.paxCount>1&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",k.paxCount-1," guests"]})]}),n&&f.jsx("button",{onClick:()=>n(k.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:"Unassign guest",children:f.jsx(Ud,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]},k.id))}),f.jsxs("div",{className:"flex gap-2 pt-3 border-t dark:border-gray-700",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>r==null?void 0:r(e.id),className:"flex-1 text-sm py-2",children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:()=>a==null?void 0:a(e.id),className:"text-sm py-2",children:"Delete"})]})]}),o&&x&&f.jsx("div",{className:"absolute inset-0 bg-primary/10 border-4 border-dashed border-primary rounded-xl flex items-center justify-center pointer-events-none",children:f.jsx("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg",children:f.jsx("p",{className:"text-primary font-semibold",children:"Drop guest here"})})}),l&&!x&&f.jsx("div",{className:"absolute inset-0 bg-red-500/10 border-2 border-red-500 rounded-xl flex items-center justify-center pointer-events-none",children:f.jsxs("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg border-2 border-red-500",children:[f.jsx("p",{className:"text-red-600 font-semibold text-sm",children:"Not enough seats"}),f.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Need ",l.paxCount,", only ",h," available"]})]})})]})},er={NONE:0,BRIDE_FAMILY:1,GROOM_FAMILY:2,BRIDE_RELATIVES:3,GROOM_RELATIVES:4,FRIENDS:5,COLLEAGUES:6,FAMILY_FRIENDS:7,NEIGHBORS:8,VIP:9},aI={[er.NONE]:"None",[er.BRIDE_FAMILY]:"Bride Family",[er.GROOM_FAMILY]:"Groom Family",[er.BRIDE_RELATIVES]:"Bride Relatives",[er.GROOM_RELATIVES]:"Groom Relatives",[er.FRIENDS]:"Friends",[er.COLLEAGUES]:"Colleagues",[er.FAMILY_FRIENDS]:"Family Friends",[er.NEIGHBORS]:"Neighbors",[er.VIP]:"VIP"},Lm={[er.NONE]:"table",[er.BRIDE_FAMILY]:"bridefamily",[er.GROOM_FAMILY]:"groomfamily",[er.BRIDE_RELATIVES]:"briderelatives",[er.GROOM_RELATIVES]:"groomrelatives",[er.FRIENDS]:"friends",[er.COLLEAGUES]:"colleagues",[er.FAMILY_FRIENDS]:"familyfriends",[er.NEIGHBORS]:"neighbors",[er.VIP]:"vip"};function nI(){return[er.VIP,er.BRIDE_FAMILY,er.GROOM_FAMILY,er.FRIENDS,er.COLLEAGUES]}const sI=({isOpen:e,onClose:t})=>{const{eventId:r}=$r(),[a,n]=C.useState(null),[l,o]=C.useState(!1),[u,h]=C.useState([]),[x,m]=C.useState(""),[g,v]=C.useState(""),[b,y]=C.useState("10"),w=qP(r);C.useEffect(()=>{if(e){const R=nI();h(R.map(A=>({category:A,quantity:0,capacity:10}))),m(""),v(""),y("10"),n(null),o(!1)}},[e]);const E=(R,A)=>{const D=[...u];D[R].quantity=Number(A)||0,h(D)},k=(R,A)=>{const D=[...u];D[R].capacity=Number(A)||1,h(D)},N=async R=>{R.preventDefault(),n(null);const A=u.filter(U=>U.quantity>0),D=Number(g)||0,T=Number(b)||0,F=x.trim()&&D>0;if(A.length===0&&!F){n("Please enter at least one table quantity");return}if(F){if(!x.trim()){n("Please enter a table prefix for custom tables");return}if(D<1){n("Custom table quantity must be at least 1");return}if(T<1){n("Custom table capacity must be at least 1");return}}if(A.find(U=>U.capacity<1)){n("All capacities must be at least 1");return}o(!0);try{for(const U of A){const q=Lm[U.category];await w.mutateAsync({eventGuid:r,tableName:q,quantity:U.quantity,maxSeats:U.capacity})}F&&await w.mutateAsync({eventGuid:r,tableName:x.trim(),quantity:D,maxSeats:T}),t()}catch(U){console.error("Failed to create tables:",U),n(U.message??"Failed to create tables. Please try again.")}finally{o(!1)}},_=u.reduce((R,A)=>R+A.quantity,0)+(Number(g)||0);return f.jsx(qn,{isOpen:e,onClose:t,title:"Bulk Create Tables",className:"!max-w-4xl",children:f.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a&&f.jsx(ou,{message:a}),f.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-3 mb-4",children:f.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[f.jsx("strong",{children:"Quick Setup:"})," Enter quantities for each category. Tables will be auto-named (e.g., vip1, vip2, bridefamily1, friends1, etc.)"]})}),f.jsx("div",{className:"space-y-3",children:u.map((R,A)=>f.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-3 bg-white dark:bg-accent/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"col-span-4",children:[f.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:aI[R.category]}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",Lm[R.category],"1, ",Lm[R.category],"2...)"]})]}),f.jsxs("div",{className:"col-span-4",children:[f.jsx("input",{type:"number",min:"0",placeholder:"0",value:R.quantity||"",onChange:D=>E(A,D.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),f.jsxs("div",{className:"col-span-4",children:[f.jsx("input",{type:"number",min:"1",value:R.capacity,onChange:D=>k(A,D.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:R.quantity===0}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]},R.category))}),f.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[f.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Custom Tables (Optional)"}),f.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-3",children:f.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[f.jsx("strong",{children:"Example:"}),' Prefix "family" with 5 tables creates: family1, family2, family3, family4, family5']})}),f.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[f.jsxs("div",{className:"col-span-4",children:[f.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Table Prefix"}),f.jsx("input",{type:"text",placeholder:"e.g., family, special",value:x,onChange:R=>m(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"(prefix1, prefix2...)"})]}),f.jsxs("div",{className:"col-span-4",children:[f.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Quantity"}),f.jsx("input",{type:"number",min:"0",placeholder:"0",value:g,onChange:R=>v(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),f.jsxs("div",{className:"col-span-4",children:[f.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Capacity"}),f.jsx("input",{type:"number",min:"1",value:b,onChange:R=>y(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:!g||Number(g)===0}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]})]}),_>0&&f.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:f.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:[f.jsx("strong",{children:"Total:"})," ",_," tables will be created"]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",disabled:l,children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",loading:l,disabled:_===0,children:l?"Creating...":`Create ${_} Table${_!==1?"s":""}`})]})]})})},eh=({isOpen:e,onClose:t,initial:r})=>{const{eventId:a}=$r(),[n,l]=C.useState((r==null?void 0:r.name)||""),[o,u]=C.useState((r==null?void 0:r.capacity.toString())||"1"),[h,x]=C.useState(null),m=VP(a),g=WP((r==null?void 0:r.id)||"",a);C.useEffect(()=>{e&&(l((r==null?void 0:r.name)||""),u(((r==null?void 0:r.capacity)??10).toString()),x(null))},[e,r]);const v=!!r,b=async y=>{y.preventDefault();const w={name:n.trim(),capacity:Number(o),eventId:a};try{v&&r?await g.mutateAsync(w):await m.mutateAsync(w),t()}catch(E){console.error(E),x(E.message??"Something went wrong.")}};return f.jsx(qn,{isOpen:e,onClose:t,title:v?"Edit Table":"New Table",children:f.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h&&f.jsx(ou,{message:h}),f.jsx(sr,{label:"Table Name",value:n,onChange:y=>l(y.target.value)}),f.jsx(sr,{label:"Capacity",type:"number",value:o,onChange:y=>u(y.target.value)}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",children:v?"Save":"Create"})]})]})})};function iI(){const{eventId:e}=$r(),{data:t=[],isLoading:r,isError:a}=Jd(e),{data:n=[],isLoading:l,isError:o}=Zd(e),u=XP(e),h=Ig(e||""),x=Ug(e||""),[m,g]=C.useState(""),[v,b]=C.useState("all"),[y,w]=C.useState(null),[E,k]=C.useState(null),[N,_]=C.useState(!1),[R,A]=C.useState(!1),[D,T]=C.useState(null),[F,O]=C.useState(null),U=C.useMemo(()=>{const Z=n.filter(V=>V.tableId).reduce((V,Q)=>V+(Q.pax||Q.noOfPax||1),0),L=n.filter(V=>!V.tableId).reduce((V,Q)=>V+(Q.pax||Q.noOfPax||1),0),G=t.reduce((V,Q)=>V+Q.capacity,0);return{totalTables:t.length,seatedGuests:Z,unassigned:L,totalCapacity:G}},[t,n]),q=C.useMemo(()=>n.filter(Z=>!Z.tableId),[n]),z=C.useMemo(()=>t.map(Z=>{const L=n.filter(G=>G.tableId===Z.id);return{...Z,guests:L.map(G=>({id:G.id,guestName:G.guestName||G.name,paxCount:G.pax||G.noOfPax||1})),assignedCount:L.reduce((G,V)=>G+(V.pax||V.noOfPax||1),0)}}),[t,n]),te=C.useMemo(()=>z.filter(Z=>!(m&&!Z.name.toLowerCase().includes(m.toLowerCase())&&!Z.guests.some(G=>G.guestName.toLowerCase().includes(m.toLowerCase()))||v==="hasEmpty"&&Z.assignedCount>=Z.capacity||v==="full"&&Z.assignedCount<Z.capacity)),[z,m,v]);if(!e)return f.jsx(uc,{title:"No Events for Table Management",message:"Create your first event to start organizing seating arrangements and table assignments."});if(r||l)return f.jsx("p",{children:"Loading tables and guests"});if(a||o)return f.jsx("p",{children:"Failed to load data."});const ce=Z=>{const L=n.find(G=>G.id===Z);L&&(w(Z),k({id:Z,paxCount:L.pax||L.noOfPax||1}))},de=()=>{w(null),k(null)},ee=(Z,L)=>{const G=n.find(_e=>_e.id===Z),V=z.find(_e=>_e.id===L);if(!G||!V)return;const Q=G.pax||G.noOfPax||1,le=V.capacity-V.assignedCount;if(Q>le){bn.error(`Cannot assign guest. This guest requires ${Q} seat(s), but only ${le} seat(s) available in ${V.name}.`,{duration:4e3});return}h.mutate({guestId:Z,tableId:L})},ie=Z=>{x.mutate(Z)},Te=Z=>{const L=z.find(G=>G.id===Z);L&&T({id:L.id,name:L.name,capacity:L.capacity})},ne=Z=>{const L=z.find(G=>G.id===Z);L&&O({id:L.id,name:L.name})},B=()=>{F&&(u.mutate(F.id),O(null))};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[f.jsx(wn,{label:"Total Tables",value:U.totalTables,variant:"primary"}),f.jsx(wn,{label:"Seated Guests",value:U.seatedGuests,variant:"success"}),f.jsx(wn,{label:"Unassigned",value:U.unassigned,variant:"warning"}),f.jsx(wn,{label:"Total Capacity",value:U.totalCapacity,variant:"secondary"})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Table Arrangement"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs(Fe,{variant:"secondary",disabled:!0,className:"opacity-50 cursor-not-allowed flex items-center gap-2",title:"Coming Soon",children:["Auto-Assign",f.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),f.jsxs(eI,{trigger:f.jsxs(Fe,{children:["+ New Table ",f.jsx("span",{className:"ml-1",children:""})]}),children:[f.jsx(Cp,{onClick:()=>A(!0),children:f.jsxs("div",{children:[f.jsx("div",{className:"font-medium",children:"Create Single Table"}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create one table at a time"})]})}),f.jsx(Cp,{onClick:()=>_(!0),children:f.jsxs("div",{children:[f.jsxs("div",{className:"font-medium",children:["Bulk Create"," ",f.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full",children:"Recommended"})]}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create by category or custom prefix"})]})})]})]})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[f.jsxs("select",{className:"w-full md:w-1/4 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:v,onChange:Z=>b(Z.target.value),children:[f.jsx("option",{value:"all",children:"All Tables"}),f.jsx("option",{value:"hasEmpty",children:"Has Empty Seats"}),f.jsx("option",{value:"full",children:"Full Tables"})]}),f.jsx("input",{placeholder:"Search guests or tables...",className:"w-full md:flex-1 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:m,onChange:Z=>g(Z.target.value)})]}),f.jsx("div",{className:"mb-6 p-4 rounded-xl bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-100 dark:border-indigo-800",children:f.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[f.jsx("strong",{children:"Tip:"})," Drag guests from the unassigned panel and drop them onto tables"]})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 flex-1 min-h-0",children:[f.jsx("div",{className:"lg:col-span-1 lg:max-h-full",children:f.jsxs("div",{className:"lg:sticky lg:top-0 bg-white dark:bg-accent rounded-xl shadow-lg p-4 border border-gray-200 dark:border-gray-700",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Unassigned Guests (",q.length,")"]}),f.jsx("div",{className:"space-y-2 max-h-96 lg:max-h-[calc(100vh-350px)] overflow-y-auto",children:q.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-8",children:"All guests have been assigned!"}):q.map(Z=>{var L,G;return f.jsx(tI,{guest:{id:Z.id,guestName:Z.guestName||Z.name,phoneNo:Z.phoneNo,paxCount:Z.pax||Z.noOfPax||1,isVip:(L=Z.remarks||Z.notes)==null?void 0:L.toLowerCase().includes("vip"),dietaryRestrictions:(G=Z.remarks||Z.notes)!=null&&G.toLowerCase().includes("vegetarian")?["Vegetarian"]:void 0},onDragStart:ce,onDragEnd:de,isDragging:y===Z.id},Z.id)})})]})}),f.jsx("div",{className:"lg:col-span-3 overflow-y-auto",children:te.length===0?f.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70 dark:bg-accent/70",children:[f.jsx("p",{className:"text-lg font-semibold",children:"No tables found."}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:m?"No tables match your search. Try a different search term.":"Create your first table to start organizing your seating arrangements."}),f.jsx(Fe,{onClick:()=>A(!0),children:"+ Create First Table"})]}):f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 pb-6",children:te.map(Z=>f.jsx(rI,{table:Z,onDrop:ee,onEdit:Te,onDelete:ne,onUnassignGuest:ie,isDropTarget:!!y,draggedGuest:E},Z.id))})})]}),f.jsx(sI,{isOpen:N,onClose:()=>_(!1)}),f.jsx(eh,{isOpen:R||!!D,onClose:()=>{A(!1),T(null)},initial:D||void 0}),f.jsx(vu,{isOpen:!!F,isDeleting:u.isPending,onConfirm:B,onCancel:()=>O(null),title:"Delete Table",description:"Are you sure you want to delete this table? This action cannot be undone.",children:F&&f.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:f.jsx("div",{className:"flex items-start gap-3",children:f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:F.name}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Table ID: ",F.id]})]})})})})]})}function lI(){const{tableId:e}=Gn(),t=Na(),{data:r,isLoading:a,isError:n}=yu(e);return a?f.jsx("div",{className:"p-6 text-center",children:"Loading"}):n||!r?f.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load table."}):f.jsx(eh,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function oI(){return aa({queryKey:["seating"],queryFn:async()=>(await Qe.get(su.all)).data,staleTime:5*6e4})}function cI(e){return aa({queryKey:["seating",e],queryFn:async()=>(await Qe.get(su.byId(e))).data})}function uI(){const e=Et();return At({mutationFn:async t=>(await Qe.post(su.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}function fI(e){const t=Et();return At({mutationFn:async r=>(await Qe.put(su.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["seating"]})})}function dI(){const e=Et();return At({mutationFn:async t=>(await Qe.delete(su.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}const zg=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=C.useState((r==null?void 0:r.tableId)||""),[l,o]=C.useState((r==null?void 0:r.guestId)||""),u=uI(),h=fI((r==null?void 0:r.id)||""),[x,m]=C.useState(null);C.useEffect(()=>{e&&(n((r==null?void 0:r.tableId)||""),o((r==null?void 0:r.guestId)||""))},[e,r]);const g=!!r,v=async b=>{var w,E;b.preventDefault();const y={tableId:a,guestId:l};try{g&&r?await h.mutateAsync(y):await u.mutateAsync(y),t()}catch(k){console.error(k),m(((E=(w=k.response)==null?void 0:w.data)==null?void 0:E.message)||"Something went wrong.")}};return f.jsx(qn,{isOpen:e,onClose:t,title:g?"Edit Seating":"New Seating",children:f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&f.jsx(ou,{message:x}),f.jsx(sr,{label:"Table ID",value:a,onChange:b=>n(b.target.value)}),f.jsx(sr,{label:"Guest ID",value:l,onChange:b=>o(b.target.value)}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",children:g?"Save":"Create"})]})]})})};function hI(){const{data:e,isLoading:t,isError:r}=oI(),a=dI(),[n,l]=C.useState({open:!1}),[o,u]=C.useState({open:!1,seat:null});if(t)return f.jsx("p",{children:"Loading seating"});if(r)return f.jsx("p",{children:"Failed to load seating."});const h=g=>{u({open:!0,seat:g})},x=()=>{u({open:!1,seat:null})},m=async()=>{if(o.seat)try{await a.mutateAsync(o.seat.id),u({open:!1,seat:null})}catch(g){console.error("Failed to delete seat:",g)}};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Seating"}),f.jsx(Fe,{onClick:()=>l({open:!0}),children:"New Seating"})]}),f.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(g=>f.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsxs("p",{className:"text-lg font-medium",children:["Table: ",g.tableId]}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Guest: ",g.guestId]})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>l({open:!0,seat:{id:g.id,tableId:g.tableId,guestId:g.guestId}}),children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:()=>h({id:g.id,tableId:g.tableId,guestId:g.guestId}),children:"Delete"})]})]},g.id))}),f.jsx(zg,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.seat}),f.jsx(vu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete Seating Assignment?",description:"Are you sure you want to delete this seating assignment? This action cannot be undone.",children:o.seat&&f.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:f.jsx("div",{className:"flex items-start gap-3",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:["Table ID: ",o.seat.tableId]}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Guest ID: ",o.seat.guestId]})]})})})})]})}function xI(){const{id:e}=Gn(),t=Na(),{data:r,isLoading:a,isError:n}=cI(e);return a?f.jsx("div",{className:"p-6 text-center",children:"Loading"}):n||!r?f.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load seating."}):f.jsx(zg,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function mI(){return aa({queryKey:["users"],queryFn:async()=>(await Qe.get(iu.all)).data,staleTime:5*6e4})}function pI(e){return aa({queryKey:["user",e],queryFn:async()=>(await Qe.get(iu.byId(e))).data})}function gI(){const e=Et();return At({mutationFn:async t=>(await Qe.post(iu.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}function vI(e){const t=Et();return At({mutationFn:async r=>(await Qe.put(iu.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["users"]})})}function yI(){const e=Et();return At({mutationFn:async t=>(await Qe.delete(iu.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}const Hg=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=C.useState((r==null?void 0:r.name)||""),[l,o]=C.useState((r==null?void 0:r.email)||""),u=gI(),h=vI((r==null?void 0:r.id)||""),[x,m]=C.useState(null);C.useEffect(()=>{e&&(n((r==null?void 0:r.name)||""),o((r==null?void 0:r.email)||""))},[e,r]);const g=!!r,v=async b=>{var w,E;b.preventDefault();const y={name:a,email:l};try{g&&r?await h.mutateAsync(y):await u.mutateAsync(y),t()}catch(k){console.error(k),m(((E=(w=k.response)==null?void 0:w.data)==null?void 0:E.message)||"Something went wrong.")}};return f.jsx(qn,{isOpen:e,onClose:t,title:g?"Edit User":"New User",children:f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&f.jsx(ou,{message:x}),f.jsx(sr,{label:"Name",value:a,onChange:b=>n(b.target.value)}),f.jsx(sr,{label:"Email",type:"email",value:l,onChange:b=>o(b.target.value)}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),f.jsx(Fe,{variant:"primary",type:"submit",children:g?"Save":"Create"})]})]})})};function bI(){const{data:e,isLoading:t,isError:r}=mI(),a=yI(),[n,l]=C.useState({open:!1}),[o,u]=C.useState({open:!1,user:null});if(t)return f.jsx("p",{children:"Loading users"});if(r)return f.jsx("p",{children:"Failed to load users."});const h=g=>{u({open:!0,user:g})},x=()=>{u({open:!1,user:null})},m=async()=>{if(o.user)try{await a.mutateAsync(o.user.id),u({open:!1,user:null})}catch(g){console.error("Failed to delete user:",g)}};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Users"}),f.jsx(Fe,{onClick:()=>l({open:!0}),children:" New User"})]}),f.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(g=>f.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-lg font-medium",children:g.name}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g.email})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>l({open:!0,user:{id:g.id,name:g.name,email:g.email}}),children:"Edit"}),f.jsx(Fe,{variant:"secondary",onClick:()=>h({id:g.id,name:g.name,email:g.email}),children:"Delete"})]})]},g.id))}),f.jsx(Hg,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.user}),f.jsx(vu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete User?",description:"Are you sure you want to delete this user? This action cannot be undone.",children:o.user&&f.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:f.jsx("div",{className:"flex items-start gap-3",children:f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:o.user.name}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Email: ",o.user.email]})]})})})})]})}function wI(){const{id:e}=Gn(),t=Na(),{data:r,isLoading:a,isError:n}=pI(e);return a?f.jsx("div",{className:"p-6 text-center",children:"Loading"}):n||!r?f.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load user."}):f.jsx(Hg,{isOpen:!0,initial:r,onClose:()=>t(-1)})}const T_="wallet-budget-",N_=(e,t)=>{try{localStorage.setItem(`${T_}${e}`,t.toString())}catch(r){console.error("Failed to save budget to localStorage:",r)}},SI=e=>{try{const t=localStorage.getItem(`${T_}${e}`);if(t===null)return null;const r=parseFloat(t);return isNaN(r)?null:r}catch(t){return console.error("Failed to read budget from localStorage:",t),null}};function Gg(e){return{...e,totalBudget:e.budget,currency:e.currency}}function EI(e){return aa({queryKey:["wallet",e],queryFn:async()=>{var t,r;try{const a=await Qe.get(qp.getByEvent(e));console.log("Wallet API Response:",a.data);const n=((t=a.data)==null?void 0:t.data)??a.data;if(!n||!Array.isArray(n)||n.length===0)return console.log("No wallet found in response"),null;const l=n[0];console.log("Found wallet (raw):",l);const o=Gg(l);if(o.totalBudget===void 0||o.totalBudget===null){const u=SI(o.walletGuid);u!==null&&(o.totalBudget=u,console.log("Using localStorage budget (fallback):",u))}else console.log("Using backend budget:",o.totalBudget);return o}catch(a){if(console.error("Wallet API Error:",a),((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:1*6e4,refetchOnMount:!0})}function _I(){const e=Et();return At({mutationFn:async({totalBudget:t,...r})=>{var u;const a={...r,budget:t};console.log("Creating wallet, payload:",a);const n=await Qe.post(qp.create,a),l=((u=n.data)==null?void 0:u.data)??n.data;console.log("Wallet created, backend response:",l);const o=Gg(l);return t!==void 0&&o.walletGuid&&(N_(o.walletGuid,t),console.log("Saved budget to localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet"]}),e.refetchQueries({queryKey:["wallet",t.eventGuid]})}})}function kI(){const e=Et();return At({mutationFn:async({totalBudget:t,...r})=>{var u;const a={...r,budget:t};console.log("Updating wallet, payload:",a);const n=await Qe.post(qp.update,a),l=((u=n.data)==null?void 0:u.data)??n.data;console.log("Wallet updated, backend response:",l);const o=Gg(l);return t!==void 0&&o.walletGuid&&(N_(o.walletGuid,t),console.log("Updated budget in localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet",t.eventGuid]}),e.invalidateQueries({queryKey:["wallet",t.walletGuid]})}})}const ka={Credit:0,Debit:1},ba={Venue:"Venue",Catering:"Catering",Photography:"Photography",Decoration:"Decoration",Attire:"Attire",Entertainment:"Entertainment",Transport:"Transport",Invitation:"Invitation",Gifts:"Gifts",Others:"Others"},Zt={Paid:"Paid",Pending:"Pending",Overdue:"Overdue"},TI=e=>{let t={_extended:{},notes:""};if(e.remarks)try{const r=JSON.parse(e.remarks);r&&typeof r=="object"&&"_extended"in r?t=r:t.notes=e.remarks}catch{t.notes=e.remarks}return{...e,category:e.category,remarks:t.notes||"",vendorName:t._extended.vendorName,vendorContact:t._extended.vendorContact,paymentStatus:t._extended.paymentStatus,dueDate:t._extended.dueDate}},NI=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},CI=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{transactionGuid:e.transactionGuid,walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},Ro=(e,t="RM")=>{const a=Math.abs(e).toLocaleString("en-MY",{minimumFractionDigits:2,maximumFractionDigits:2});return`${t} ${a}`},C_=e=>e===0?"Credit":"Debit";function AI(e,t){return aa({queryKey:["transactions",e],queryFn:async()=>{var r,a;try{const n=await Qe.get(Pd.getByWallet(e,t)),l=((r=n.data)==null?void 0:r.data)??n.data;return!l||!Array.isArray(l)?[]:l.map(o=>TI(o))}catch(n){if(((a=n.response)==null?void 0:a.status)===404)return[];throw n}},enabled:!!e&&!!t,staleTime:2*6e4})}function jI(){const e=Et();return At({mutationFn:async t=>{var n;const r=NI(t),a=await Qe.post(Pd.create,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function RI(){const e=Et();return At({mutationFn:async t=>{var n;const r=CI(t),a=await Qe.post(Pd.update,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function DI(){const e=Et();return At({mutationFn:async t=>{var a;const r=await Qe.post(Pd.delete,t);return((a=r.data)==null?void 0:a.data)??r.data},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]})}})}const hl={MYR:"MYR",USD:"USD",SGD:"SGD",IDR:"IDR"},Zo={[hl.MYR]:{flag:"",label:"Malaysian Ringgit",symbol:"RM"},[hl.USD]:{flag:"",label:"US Dollar",symbol:"$"},[hl.SGD]:{flag:"",label:"Singapore Dollar",symbol:"S$"},[hl.IDR]:{flag:"",label:"Indonesian Rupiah",symbol:"Rp"}},kw=({isOpen:e,onClose:t,eventGuid:r,userId:a,wallet:n})=>{const[l,o]=C.useState(hl.MYR),[u,h]=C.useState(""),[x,m]=C.useState({}),g=_I(),v=kI(),b=!!n;C.useEffect(()=>{var N;n?(o(n.currency),h(((N=n.totalBudget)==null?void 0:N.toString())||"")):(o(hl.MYR),h("")),m({})},[n,e]);const y=()=>{const N={};if(l||(N.currency="Please select a currency"),u){const _=parseFloat(u);(isNaN(_)||_<=0)&&(N.budget="Budget must be a positive number")}return m(N),Object.keys(N).length===0},w=async N=>{if(N.preventDefault(),!y())return;const _=u?parseFloat(u):void 0;try{if(b&&n)console.log("Updating wallet:",{eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:_}),await v.mutateAsync({eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:_});else{console.log("Creating wallet:",{eventGuid:r,userId:a,currency:l,totalBudget:_});const R=await g.mutateAsync({eventGuid:r,userId:a,currency:l,totalBudget:_});console.log("Wallet created successfully:",R)}t()}catch(R){console.error("Failed to save wallet:",R),alert("Failed to save wallet: "+R.message)}},E=()=>{!g.isPending&&!v.isPending&&t()},k=[{label:"Venue",percentage:"30%"},{label:"Catering",percentage:"25%"},{label:"Photography",percentage:"15%"},{label:"Decoration",percentage:"10%"},{label:"Attire",percentage:"10%"},{label:"Others",percentage:"10%"}];return f.jsx(qn,{isOpen:e,onClose:E,title:b?"Update Wallet":"Setup Wallet",className:"max-w-md",children:f.jsxs("form",{onSubmit:w,className:"space-y-4",children:[f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:b?"Update your wallet configuration":"Configure your event budget and currency"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Currency *"}),f.jsx("select",{value:l,onChange:N=>o(N.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:Object.values(hl).map(N=>{const _=Zo[N];return f.jsxs("option",{value:N,children:[_.flag," ",N," - ",_.label]},N)})}),x.currency&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.currency})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Total Budget (Optional)"}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:Zo[l].symbol}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:u,onChange:N=>h(N.target.value),placeholder:"50000",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 pl-12 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Set your maximum budget for this event"}),x.budget&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.budget})]}),f.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-primary/5 to-secondary/5 border border-primary/10",children:[f.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:" Suggested Budget Allocation"}),f.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400",children:k.map(N=>f.jsxs("div",{className:"flex justify-between",children:[f.jsxs("span",{children:[N.label,":"]}),f.jsx("span",{className:"font-medium",children:N.percentage})]},N.label))})]}),f.jsxs("div",{className:"flex gap-3 mt-6",children:[f.jsx(Fe,{type:"button",variant:"secondary",onClick:E,disabled:g.isPending||v.isPending,className:"flex-1",children:"Cancel"}),f.jsx(Fe,{type:"submit",variant:"primary",loading:g.isPending||v.isPending,className:"flex-1 bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:b?"Update Wallet":"Create Wallet"})]}),(g.isError||v.isError)&&f.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save wallet. Please try again."})]})})},W0={[ba.Venue]:{emoji:"",label:"Venue",color:"purple",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"},[ba.Catering]:{emoji:"",label:"Catering",color:"orange",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"},[ba.Photography]:{emoji:"",label:"Photography",color:"pink",bgColor:"bg-pink-100",textColor:"text-pink-700",borderColor:"border-pink-200"},[ba.Decoration]:{emoji:"",label:"Decoration",color:"teal",bgColor:"bg-teal-100",textColor:"text-teal-700",borderColor:"border-teal-200"},[ba.Attire]:{emoji:"",label:"Attire",color:"indigo",bgColor:"bg-indigo-100",textColor:"text-indigo-700",borderColor:"border-indigo-200"},[ba.Entertainment]:{emoji:"",label:"Entertainment",color:"violet",bgColor:"bg-violet-100",textColor:"text-violet-700",borderColor:"border-violet-200"},[ba.Transport]:{emoji:"",label:"Transport",color:"blue",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"},[ba.Invitation]:{emoji:"",label:"Invitation",color:"rose",bgColor:"bg-rose-100",textColor:"text-rose-700",borderColor:"border-rose-200"},[ba.Gifts]:{emoji:"",label:"Gifts",color:"amber",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"},[ba.Others]:{emoji:"",label:"Others",color:"gray",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}},Tw=e=>W0[e]||W0[ba.Others],A_=()=>Object.values(ba),FI=({isOpen:e,onClose:t,walletGuid:r,eventGuid:a,transaction:n})=>{const[l,o]=C.useState(ka.Debit),[u,h]=C.useState(""),[x,m]=C.useState(""),[g,v]=C.useState(""),[b,y]=C.useState(ba.Others),[w,E]=C.useState(""),[k,N]=C.useState(""),[_,R]=C.useState(Zt.Paid),[A,D]=C.useState(""),[T,F]=C.useState(""),[O,U]=C.useState(""),[q,z]=C.useState({}),te=jI(),ce=RI(),de=!!n;C.useEffect(()=>{n?(o(n.type),h(n.transactionName),m(n.amount.toString()),v(n.transactionDate?new Date(n.transactionDate).toISOString().split("T")[0]:""),y(n.category),E(n.vendorName||""),N(n.vendorContact||""),R(n.paymentStatus||Zt.Paid),D(n.dueDate?new Date(n.dueDate).toISOString().split("T")[0]:""),F(n.referenceId||""),U(n.remarks||"")):ee(),z({})},[n,e]);const ee=()=>{o(ka.Debit),h(""),m(""),v(new Date().toISOString().split("T")[0]),y(ba.Others),E(""),N(""),R(Zt.Paid),D(""),F(""),U("")},ie=()=>{const B={};if(u.trim()||(B.transactionName="Transaction name is required"),!x)B.amount="Amount is required";else{const Z=parseFloat(x);(isNaN(Z)||Z<=0)&&(B.amount="Amount must be a positive number")}return g||(B.transactionDate="Transaction date is required"),b||(B.category="Category is required"),z(B),Object.keys(B).length===0},Te=async B=>{if(B.preventDefault(),!ie())return;const Z={walletGuid:r,eventGuid:a,type:l,transactionName:u.trim(),amount:parseFloat(x),transactionDate:g,category:b,vendorName:w.trim()||void 0,vendorContact:k.trim()||void 0,paymentStatus:_,dueDate:A||void 0,referenceId:T.trim()||void 0,remarks:O.trim()||void 0};try{de&&n?await ce.mutateAsync({...Z,transactionGuid:n.transactionGuid}):await te.mutateAsync(Z),t()}catch(L){console.error("Failed to save transaction:",L)}},ne=()=>{!te.isPending&&!ce.isPending&&t()};return f.jsx(qn,{isOpen:e,onClose:ne,title:de?"Edit Transaction":"Add Transaction",className:"max-w-lg max-h-[90vh] overflow-y-auto",children:f.jsxs("form",{onSubmit:Te,className:"space-y-4",children:[f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:de?"Update transaction details":"Record a new expense or income"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Transaction Type *"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("button",{type:"button",onClick:()=>o(ka.Debit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===ka.Debit?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-red-500 hover:bg-red-50 dark:hover:bg-red-900/10"}`,children:[f.jsx("span",{children:""})," Debit (Expense)"]}),f.jsxs("button",{type:"button",onClick:()=>o(ka.Credit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===ka.Credit?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/10"}`,children:[f.jsx("span",{children:""})," Credit (Income)"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Transaction Name *"}),f.jsx("input",{type:"text",value:u,onChange:B=>h(B.target.value),placeholder:"e.g. Venue Deposit Payment",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),q.transactionName&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:q.transactionName})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount *"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:x,onChange:B=>m(B.target.value),placeholder:"0.00",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),q.amount&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:q.amount})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date *"}),f.jsx("input",{type:"date",value:g,onChange:B=>v(B.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),q.transactionDate&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:q.transactionDate})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category *"}),f.jsx("select",{value:b,onChange:B=>y(B.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:A_().map(B=>{const Z=W0[B];return f.jsxs("option",{value:B,children:[Z.emoji," ",Z.label]},B)})}),q.category&&f.jsx("p",{className:"text-red-500 text-xs mt-1",children:q.category})]}),f.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Vendor Information (Optional)"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Vendor Name"}),f.jsx("input",{type:"text",value:w,onChange:B=>E(B.target.value),placeholder:"e.g. Shangri-La Hotel",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Contact Number / Email"}),f.jsx("input",{type:"text",value:k,onChange:B=>N(B.target.value),placeholder:"e.g. +60 3-2074 3900",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Status"}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsx("button",{type:"button",onClick:()=>R(Zt.Paid),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${_===Zt.Paid?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Paid"}),f.jsx("button",{type:"button",onClick:()=>R(Zt.Pending),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${_===Zt.Pending?"border-amber-500 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Pending"}),f.jsx("button",{type:"button",onClick:()=>R(Zt.Overdue),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${_===Zt.Overdue?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Overdue"})]})]}),(_===Zt.Pending||_===Zt.Overdue)&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due Date (Optional)"}),f.jsx("input",{type:"date",value:A,onChange:B=>D(B.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reference ID (Optional)"}),f.jsx("input",{type:"text",value:T,onChange:B=>F(B.target.value),placeholder:"e.g. Invoice number, Receipt ID",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remarks (Optional)"}),f.jsx("textarea",{rows:2,value:O,onChange:B=>U(B.target.value),placeholder:"Additional notes...",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none"})]}),f.jsxs("div",{className:"flex gap-3 mt-6",children:[f.jsx(Fe,{type:"button",variant:"secondary",onClick:ne,disabled:te.isPending||ce.isPending,className:"flex-1",children:"Cancel"}),f.jsx(Fe,{type:"submit",variant:"primary",loading:te.isPending||ce.isPending,className:"flex-1",children:de?"Update Transaction":"Save Transaction"})]}),(te.isError||ce.isError)&&f.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save transaction. Please try again."})]})})},OI=({isOpen:e,onClose:t,transactions:r,wallet:a})=>{const[n,l]=C.useState(""),[o,u]=C.useState(""),[h,x]=C.useState("csv"),[m,g]=C.useState(!0),[v,b]=C.useState(!0),[y,w]=C.useState(!1),E=_=>!n&&!o?_:_.filter(R=>{if(!R.transactionDate)return!1;const A=new Date(R.transactionDate),D=n?new Date(n):null,T=o?new Date(o):null;return!(D&&A<D||T&&A>T)}),k=()=>{const _=E(r);if(_.length===0){alert("No transactions to export with the selected date range.");return}const R=Zo[a.currency].symbol;let A="";if(A+=`Event Wallet Report
`,A+=`Currency: ${a.currency}
`,A+=`Generated: ${new Date().toLocaleDateString()}
`,A+=`Date Range: ${n||"All"} to ${o||"All"}
`,A+=`
`,m){A+=`Transaction Details
`;const O=["Date","Transaction Name","Type","Category",y?"Vendor":null,y?"Vendor Contact":null,"Amount","Status","Reference ID","Remarks"].filter(Boolean);A+=O.join(",")+`
`,_.forEach(U=>{const q=[U.transactionDate||"",`"${U.transactionName.replace(/"/g,'""')}"`,C_(U.type),U.category,y?`"${(U.vendorName||"").replace(/"/g,'""')}"`:null,y?`"${(U.vendorContact||"").replace(/"/g,'""')}"`:null,U.amount,U.paymentStatus||"",U.referenceId||"",`"${(U.remarks||"").replace(/"/g,'""')}"`].filter(z=>z!==null);A+=q.join(",")+`
`}),A+=`
`}if(v){A+=`Category Summary
`,A+=`Category,Total Spent,Percentage,Transaction Count
`;const O=new Map,U=_.filter(q=>q.type===1).reduce((q,z)=>q+z.amount,0);_.filter(q=>q.type===1).forEach(q=>{const z=O.get(q.category)||{amount:0,count:0};O.set(q.category,{amount:z.amount+q.amount,count:z.count+1})}),O.forEach((q,z)=>{const te=U>0?q.amount/U*100:0;A+=`${z},${R} ${q.amount.toFixed(2)},${te.toFixed(1)}%,${q.count}
`}),A+=`
`,A+=`Total Spending,${R} ${U.toFixed(2)}
`}const D=new Blob([A],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),F=URL.createObjectURL(D);T.setAttribute("href",F),T.setAttribute("download",`wallet-report-${Date.now()}.csv`),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T),t()},N=()=>{h==="csv"?k():alert(`${h.toUpperCase()} export coming soon!`)};return f.jsx(qn,{isOpen:e,onClose:t,title:"Export Report",className:"max-w-md",children:f.jsxs("div",{className:"space-y-4",children:[f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Download your transaction report"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"From"}),f.jsx("input",{type:"date",value:n,onChange:_=>l(_.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"To"}),f.jsx("input",{type:"date",value:o,onChange:_=>u(_.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Export Format"}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsxs("button",{type:"button",onClick:()=>x("csv"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${h==="csv"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[f.jsx("span",{className:"text-2xl",children:""}),f.jsx("span",{className:`text-sm font-medium ${h==="csv"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"CSV"})]}),f.jsxs("button",{type:"button",onClick:()=>x("excel"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${h==="excel"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[f.jsx("span",{className:"text-2xl",children:""}),f.jsx("span",{className:`text-sm font-medium ${h==="excel"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"Excel"})]}),f.jsxs("button",{type:"button",onClick:()=>x("pdf"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${h==="pdf"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[f.jsx("span",{className:"text-2xl",children:""}),f.jsx("span",{className:`text-sm font-medium ${h==="pdf"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"PDF"})]})]}),h!=="csv"&&f.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:["Note: ",h.toUpperCase()," export is coming soon. CSV is currently available."]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Include in Report"}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[f.jsx("input",{type:"checkbox",checked:m,onChange:_=>g(_.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Transaction details"})]}),f.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[f.jsx("input",{type:"checkbox",checked:v,onChange:_=>b(_.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Category summary"})]}),f.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[f.jsx("input",{type:"checkbox",checked:y,onChange:_=>w(_.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Vendor information"})]})]})]}),f.jsxs("div",{className:"flex gap-3 mt-6",children:[f.jsx(Fe,{type:"button",variant:"secondary",onClick:t,className:"flex-1",children:"Cancel"}),f.jsxs(Fe,{type:"button",variant:"primary",onClick:N,className:"flex-1",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Download"]})]})]})})},MI=({wallet:e,transactions:t,onEditBudget:r})=>{const a=Zo[e.currency].symbol,n=t.filter(m=>m.type===ka.Debit).reduce((m,g)=>m+g.amount,0),l=t.filter(m=>m.type===ka.Debit&&(m.paymentStatus===Zt.Pending||m.paymentStatus===Zt.Overdue)).reduce((m,g)=>m+g.amount,0),o=t.filter(m=>m.type===ka.Debit&&(m.paymentStatus===Zt.Pending||m.paymentStatus===Zt.Overdue)).length,u=e.totalBudget||0,h=u-n,x=u>0?n/u*100:0;return f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[f.jsxs("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-primary to-secondary text-white shadow-xl shadow-primary/20 cursor-pointer hover:shadow-2xl transition-shadow",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"h-12 w-12 rounded-xl bg-white/20 backdrop-blur grid place-items-center",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})})}),f.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/20 font-medium",children:e.currency})]}),f.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Total Budget"}),f.jsx("p",{className:"text-3xl font-bold mt-1",children:u>0?Ro(u,a):"Not Set"}),f.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-white/70",children:f.jsxs("button",{onClick:r,className:"hover:text-white transition-colors",children:[" Click to ",u>0?"edit":"set"," budget"]})})]}),f.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"h-12 w-12 rounded-xl bg-red-100 dark:bg-red-900/30 grid place-items-center",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-red-600 dark:text-red-400",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"})})}),u>0&&f.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 font-semibold",children:[x.toFixed(0),"%"]})]}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Current Spending"}),f.jsx("p",{className:"text-3xl font-bold text-slate-800 dark:text-white mt-1",children:Ro(n,a)}),u>0&&f.jsx("div",{className:"mt-3",children:f.jsx("div",{className:"w-full h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:f.jsx("div",{className:"h-full bg-gradient-to-r from-red-400 to-red-600 rounded-full transition-all duration-500",style:{width:`${Math.min(x,100)}%`}})})})]}),f.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"h-12 w-12 rounded-xl bg-emerald-100 dark:bg-emerald-900/30 grid place-items-center",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-emerald-600 dark:text-emerald-400",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u>0&&f.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 font-semibold",children:[(100-x).toFixed(0),"%"]})]}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Remaining Budget"}),f.jsx("p",{className:`text-3xl font-bold mt-1 ${u>0?h>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:u>0?Ro(h,a):"N/A"}),f.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs",children:u>0?h>=0?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:""}),f.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"On track"})]}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),f.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Over budget"})]}):f.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"Set budget to track"})})]}),f.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"h-12 w-12 rounded-xl bg-amber-100 dark:bg-amber-900/30 grid place-items-center",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-amber-600 dark:text-amber-400",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o>0&&f.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 font-semibold",children:[o," item",o!==1?"s":""]})]}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Pending Payments"}),f.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400 mt-1",children:Ro(l,a)}),f.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-amber-600 dark:text-amber-400",children:[t.filter(m=>m.paymentStatus===Zt.Overdue).length>0&&f.jsxs("span",{children:[""," ",t.filter(m=>m.paymentStatus===Zt.Overdue).length," ","overdue payment",t.filter(m=>m.paymentStatus===Zt.Overdue).length!==1?"s":""]}),o===0&&f.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:" All paid"})]})]})]})},LI=({wallet:e,transactions:t})=>{const r=Zo[e.currency].symbol,a=t.filter(o=>o.type===ka.Debit).reduce((o,u)=>o+u.amount,0),n=new Map;t.filter(o=>o.type===ka.Debit).forEach(o=>{const u=n.get(o.category)||{amount:0,count:0};n.set(o.category,{amount:u.amount+o.amount,count:u.count+1})});const l=Array.from(n.entries()).map(([o,u])=>({category:o,amount:u.amount,percentage:a>0?u.amount/a*100:0,transactionCount:u.count})).sort((o,u)=>u.amount-o.amount);return l.length===0?f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),f.jsx("div",{className:"p-8 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm text-center",children:f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No spending data yet. Start adding transactions to see your spending breakdown."})})]}):f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[l.map(({category:o,amount:u,percentage:h,transactionCount:x})=>{const m=Tw(o),g=m.color;return f.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-xl",children:m.emoji}),f.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:m.label})]}),f.jsx("p",{className:"text-lg font-bold text-slate-800 dark:text-white",children:Ro(u,r)}),f.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[f.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:f.jsx("div",{className:`h-full rounded-full transition-all duration-500 bg-${g}-500`,style:{width:`${Math.min(h,100)}%`}})}),f.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:[h.toFixed(0),"%"]})]}),f.jsxs("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[x," transaction",x!==1?"s":""]})]},o)}),Object.values(ba).filter(o=>!n.has(o)).slice(0,Math.max(0,6-l.length)).map(o=>{const u=Tw(o);return f.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700 opacity-50",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-xl",children:u.emoji}),f.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:u.label})]}),f.jsxs("p",{className:"text-lg font-bold text-gray-400 dark:text-gray-500",children:[r," 0.00"]}),f.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[f.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:f.jsx("div",{className:"h-full rounded-full",style:{width:"0%"}})}),f.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"0%"})]})]},o)})]})]})},BI=({wallet:e,transactions:t,onEditTransaction:r})=>{const[a,n]=C.useState("All"),[l,o]=C.useState("All"),[u,h]=C.useState("All"),[x,m]=C.useState(""),[g,v]=C.useState({open:!1,transaction:null}),b=DI(),y=Zo[e.currency].symbol,w=C.useMemo(()=>t.filter(D=>{var T,F;if(a!=="All"&&D.category!==a)return!1;if(l!=="All"){const O=l==="Debit";if(O&&D.type!==ka.Debit||!O&&D.type!==ka.Credit)return!1}if(u!=="All"&&D.paymentStatus!==u)return!1;if(x){const O=x.toLowerCase();return D.transactionName.toLowerCase().includes(O)||((T=D.vendorName)==null?void 0:T.toLowerCase().includes(O))||((F=D.referenceId)==null?void 0:F.toLowerCase().includes(O))}return!0}),[t,a,l,u,x]),E=C.useMemo(()=>[...w].sort((D,T)=>{const F=D.transactionDate?new Date(D.transactionDate).getTime():0;return(T.transactionDate?new Date(T.transactionDate).getTime():0)-F}),[w]),k=D=>{v({open:!0,transaction:D})},N=()=>{v({open:!1,transaction:null})},_=async()=>{if(g.transaction)try{await b.mutateAsync({transactionGuid:g.transaction.transactionGuid,walletGuid:g.transaction.walletGuid,eventGuid:g.transaction.eventGuid}),v({open:!1,transaction:null})}catch(D){console.error("Failed to delete transaction:",D),alert("Failed to delete transaction. Please try again.")}},R=D=>{if(!D)return null;const F={[Zt.Paid]:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400",dot:"bg-emerald-500",label:"Paid",icon:""},[Zt.Pending]:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",dot:"bg-amber-500",label:"Pending",icon:""},[Zt.Overdue]:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",dot:"bg-red-500 animate-pulse",label:"Overdue",icon:""}}[D];return f.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${F.bg} ${F.text} flex items-center gap-1 w-fit`,children:[f.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${F.dot}`}),F.label]})},A=D=>{let T="transaction-row transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/50";return D.paymentStatus===Zt.Pending?T+=" bg-amber-50/30 dark:bg-amber-900/10":D.paymentStatus===Zt.Overdue&&(T+=" bg-red-50/30 dark:bg-red-900/10"),T};return f.jsxs("div",{children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-4",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("select",{value:a,onChange:D=>n(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[f.jsx("option",{value:"All",children:"All Categories"}),A_().map(D=>{const T=W0[D];return f.jsxs("option",{value:D,children:[T.emoji," ",T.label]},D)})]}),f.jsxs("select",{value:l,onChange:D=>o(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[f.jsx("option",{value:"All",children:"All Types"}),f.jsx("option",{value:"Debit",children:" Debit (Expense)"}),f.jsx("option",{value:"Credit",children:" Credit (Income)"})]}),f.jsxs("select",{value:u,onChange:D=>h(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[f.jsx("option",{value:"All",children:"All Status"}),f.jsx("option",{value:Zt.Paid,children:" Paid"}),f.jsx("option",{value:Zt.Pending,children:" Pending"}),f.jsx("option",{value:Zt.Overdue,children:" Overdue"})]})]}),f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"relative",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),f.jsx("input",{type:"text",placeholder:"Search transactions, vendors, reference ID...",value:x,onChange:D=>m(D.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl pl-10 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})})]}),f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-lg overflow-hidden",children:[f.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-800 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-lg",children:""}),f.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white",children:"Transaction History"}),f.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-primary/10 text-primary",children:[E.length," transaction",E.length!==1?"s":""]})]}),f.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Sorted by: ",f.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:"Date (Newest)"})]})]}),E.length===0?f.jsx("div",{className:"p-8 text-center",children:f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:x||a!=="All"||l!=="All"||u!=="All"?"No transactions match your filters. Try adjusting your search criteria.":"No transactions yet. Click 'Add Transaction' to get started."})}):f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50 text-left",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Transaction"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Category"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Vendor"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Amount"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),f.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:E.map(D=>{const T=W0[D.category],F=D.vendorName?D.vendorName.split(" ").map(O=>O[0]).join("").substring(0,2).toUpperCase():null;return f.jsxs("tr",{className:A(D),children:[f.jsxs("td",{className:"px-4 py-4",children:[f.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.transactionDate?new Date(D.transactionDate).toLocaleDateString("en-MY",{day:"2-digit",month:"short",year:"numeric"}):"N/A"}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.transactionDate?new Date(D.transactionDate).toLocaleTimeString("en-MY",{hour:"2-digit",minute:"2-digit"}):""})]}),f.jsx("td",{className:"px-4 py-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`h-10 w-10 rounded-xl ${T.bgColor} grid place-items-center text-lg`,children:T.emoji}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.transactionName}),D.referenceId&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",D.referenceId]})]})]})}),f.jsx("td",{className:"px-4 py-4",children:f.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${T.bgColor} ${T.textColor}`,children:T.label})}),f.jsx("td",{className:"px-4 py-4",children:D.vendorName?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`h-7 w-7 rounded-lg bg-gradient-to-br from-${T.color}-500 to-${T.color}-700 text-white text-xs font-bold grid place-items-center`,children:F}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.vendorName}),D.vendorContact&&f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.vendorContact})]})]}):f.jsx("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:""})}),f.jsxs("td",{className:"px-4 py-4",children:[f.jsxs("div",{className:`text-sm font-bold ${D.type===ka.Debit?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[D.type===ka.Debit?"- ":"+ ",Ro(D.amount,y)]}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:C_(D.type)})]}),f.jsx("td",{className:"px-4 py-4",children:R(D.paymentStatus)}),f.jsx("td",{className:"px-4 py-4",children:f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>r(D),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 transition",title:"Edit",children:""}),f.jsx("button",{onClick:()=>k(D),disabled:b.isPending,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-500 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition disabled:opacity-50",title:"Delete",children:""})]})})]},D.transactionGuid)})})]})})]}),f.jsx(vu,{isOpen:g.open,isDeleting:b.isPending,onConfirm:_,onCancel:N,title:"Delete Transaction?",description:"Are you sure you want to delete this transaction? This will permanently remove it from your records.",children:g.transaction&&f.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-start gap-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:g.transaction.transactionName}),g.transaction.vendorName&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Vendor: ",g.transaction.vendorName]}),g.transaction.referenceId&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",g.transaction.referenceId]})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:`text-sm font-bold ${g.transaction.type===1?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[g.transaction.type===1?"-":"+"," ",g.transaction.amount.toFixed(2)]}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:g.transaction.category})]})]})})})]})};function PI(){const{eventId:e}=$r();if(!e)return f.jsx(uc,{title:"No Events for Budget Tracking",message:"Create your first event to start managing your budget and tracking expenses."});const{user:t}=C.useContext(Wp),{data:r,isLoading:a,isError:n}=EI(e),{data:l=[]}=AI((r==null?void 0:r.walletGuid)||"",e),[o,u]=C.useState({open:!1,editMode:!1}),[h,x]=C.useState({open:!1}),[m,g]=C.useState(!1),v=(k=!1)=>{u({open:!0,editMode:k})},b=()=>{u({open:!1,editMode:!1})},y=()=>{x({open:!0,transaction:void 0})},w=k=>{x({open:!0,transaction:k})},E=()=>{x({open:!1,transaction:void 0})};return a?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading wallet..."})]})}):n?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load wallet data"}),f.jsx(Fe,{onClick:()=>window.location.reload(),variant:"secondary",children:"Try Again"})]})}):r?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary flex items-center gap-2",children:" Wallet & Budget"}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Track your event expenses and manage your budget"})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs(Fe,{disabled:!0,variant:"secondary",className:"flex items-center gap-2 opacity-50 cursor-not-allowed relative",title:"Coming Soon",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),"Export Report",f.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),f.jsxs(Fe,{onClick:()=>v(!0),className:"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg shadow-emerald-500/25 flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]}),f.jsxs(Fe,{onClick:y,variant:"primary",className:"flex items-center gap-2",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add Transaction"]})]})]}),f.jsx(MI,{wallet:r,transactions:l,onEditBudget:()=>v(!0)}),f.jsx(LI,{wallet:r,transactions:l}),f.jsx(BI,{wallet:r,transactions:l,onEditTransaction:w}),f.jsx(kw,{isOpen:o.open,onClose:b,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:o.editMode?r:null}),f.jsx(FI,{isOpen:h.open,onClose:E,walletGuid:r.walletGuid,eventGuid:e,transaction:h.transaction}),f.jsx(OI,{isOpen:m,onClose:()=>g(!1),transactions:l,wallet:r})]}):f.jsxs("div",{className:"flex items-center justify-center h-screen",children:[f.jsxs("div",{className:"text-center max-w-md",children:[f.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-primary to-secondary text-white text-4xl font-bold grid place-items-center mx-auto mb-6 shadow-xl shadow-primary/25",children:""}),f.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Setup Your Wallet"}),f.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Get started by setting up your event wallet to track expenses and manage your budget."}),f.jsxs(Fe,{onClick:()=>v(!1),variant:"primary",className:"bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]})]}),f.jsx(kw,{isOpen:o.open,onClose:b,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:null})]})}function II(e){const t={0:"under_budget",1:"on_budget",2:"over_budget"};return{eventStats:{eventName:e.eventStats.eventName,eventDate:e.eventStats.eventDate,eventTime:e.eventStats.eventTime,eventLocation:e.eventStats.eventLocation,noOfTable:e.eventStats.noOfTable},rsvpStats:{totalRsvpsReceived:e.rsvpStats.totalRsvpsReceived,comingCount:e.rsvpStats.comingCount,notComingCount:e.rsvpStats.notComingCount,pendingCount:e.rsvpStats.pendingCount,totalGuestsConfirmed:e.rsvpStats.totalGuestsConfirmed,responseRate:e.rsvpStats.responseRate,newConfirmationsToday:e.rsvpStats.newConfirmationsToday},tableStats:{totalTables:e.tableStats.totalTables,arrangedTables:e.tableStats.arrangedTables,assignedGuests:e.tableStats.assignedGuests,unassignedGuests:e.tableStats.unassignedGuests,totalSeats:e.tableStats.totalSeats,occupiedSeats:e.tableStats.occupiedSeats},budgetStats:{totalBudget:e.budgetStats.totalBudget,spentAmount:e.budgetStats.spentAmount,remainingAmount:e.budgetStats.remainingAmount,spentPercentage:e.budgetStats.spentPercentage,status:t[e.budgetStats.status]||"under_budget"},recentActivity:e.recentActivity.map(r=>({activityType:r.activityType,description:r.description,details:r.details,timestamp:r.timestamp,icon:r.icon}))}}function UI(e){return aa({queryKey:["dashboard",e],queryFn:async()=>{const t=await Qe.get(FA.summary(e));return II(t.data.data)},enabled:!!e})}function zI(e){const t=new Date,r=new Date(e),a=t.getTime()-r.getTime(),n=Math.floor(a/(1e3*60)),l=Math.floor(a/(1e3*60*60)),o=Math.floor(a/(1e3*60*60*24));return n<1?"Just now":n<60?`${n} min ago`:l<24?`${l} hour${l>1?"s":""} ago`:o===1?"Yesterday":o<7?`${o} days ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function HI(){var l,o,u,h,x,m,g,v,b,y,w,E,k,N,_,R,A;const e=Na(),{eventId:t}=$r(),{data:r}=UI(t||""),[a,n]=C.useState({days:0,hours:0,minutes:0});return C.useEffect(()=>{const D=()=>{var z;const F=(z=r==null?void 0:r.eventStats)==null?void 0:z.eventDate;if(!F)return;const O=new Date().getTime(),q=new Date(F).getTime()-O;if(q>0){const te=Math.floor(q/864e5),ce=Math.floor(q%(1e3*60*60*24)/(1e3*60*60)),de=Math.floor(q%(1e3*60*60)/(1e3*60));n({days:te,hours:ce,minutes:de})}else n({days:0,hours:0,minutes:0})};D();const T=setInterval(D,6e4);return()=>clearInterval(T)},[(l=r==null?void 0:r.eventStats)==null?void 0:l.eventDate]),!t||!r?f.jsx("div",{className:"space-y-6",children:f.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 rounded-2xl p-8 text-center",children:f.jsxs("div",{className:"max-w-md mx-auto",children:[f.jsx("div",{className:"h-20 w-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 grid place-items-center",children:f.jsx(nd,{className:"h-10 w-10 text-white"})}),f.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Welcome to MyBigDays! "}),f.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Select an event from the sidebar to get started with your planning dashboard"}),f.jsxs(Fe,{onClick:()=>e("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[f.jsx(nd,{className:"h-5 w-5"}),"Create Your First Event"]})]})})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:f.jsxs("div",{children:[f.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-white mb-1",children:["Good ",new Date().getHours()<12?"Morning":"Afternoon","! "]}),f.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Here's what's happening with your events today."})]})}),f.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 p-8 text-white shadow-2xl shadow-indigo-500/30",children:[f.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32"}),f.jsx("div",{className:"absolute bottom-0 left-1/2 w-48 h-48 bg-white/5 rounded-full translate-y-24"}),f.jsxs("div",{className:"relative flex flex-col lg:flex-row lg:items-center gap-6",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm font-medium mb-4",children:[f.jsx("span",{className:"h-2 w-2 rounded-full bg-green-400 animate-pulse"}),"Active Event"]}),f.jsx("h2",{className:"text-3xl font-bold mb-2",children:r.eventStats.eventName}),f.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-white/80",children:[r.eventStats.eventDate&&f.jsxs("span",{className:"flex items-center gap-1.5",children:[f.jsx(nd,{className:"h-4 w-4"}),new Date(r.eventStats.eventDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),r.eventStats.eventLocation&&f.jsxs("span",{className:"flex items-center gap-1.5",children:[f.jsx(w5,{className:"h-4 w-4"}),r.eventStats.eventLocation]})]})]}),f.jsx("div",{className:"flex flex-col items-center gap-2",children:a.days===0&&a.hours===0&&a.minutes===0?f.jsx("div",{className:"text-center py-4",children:f.jsx("p",{className:"text-2xl font-bold text-white",children:"Today is your big day! "})}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[f.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[f.jsx("p",{className:"text-3xl font-bold",children:a.days}),f.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Days"})]}),f.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[f.jsx("p",{className:"text-3xl font-bold",children:a.hours}),f.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Hours"})]}),f.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[f.jsx("p",{className:"text-3xl font-bold",children:a.minutes}),f.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Minutes"})]})]}),f.jsx("p",{className:"text-white/90 text-sm font-medium",children:a.days<15?"Almost there! ":"until your big day"})]})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[f.jsx("div",{className:"flex items-start justify-between mb-4",children:f.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-green-400 to-emerald-500 grid place-items-center shadow-lg shadow-green-500/20 group-hover:scale-110 transition",children:f.jsx(R0,{className:"h-6 w-6 text-white"})})}),f.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"RSVP Status"}),f.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-1",children:[((o=r==null?void 0:r.rsvpStats)==null?void 0:o.totalRsvpsReceived)??0," ",f.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ ",((u=r==null?void 0:r.rsvpStats)==null?void 0:u.totalGuestsConfirmed)??0," responded"]})]}),f.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-0.5",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Coming:"}),f.jsxs("span",{className:"font-semibold",children:[((h=r==null?void 0:r.rsvpStats)==null?void 0:h.comingCount)??0," guests"]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{children:"Not Coming:"}),f.jsxs("span",{className:"font-semibold",children:[((x=r==null?void 0:r.rsvpStats)==null?void 0:x.notComingCount)??0," guests"]})]})]}),f.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex items-center gap-2 text-xs text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 transition",children:[f.jsx(fb,{className:"h-4 w-4"}),"View RSVPs"]})]}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-indigo-400 to-purple-500 grid place-items-center shadow-lg shadow-indigo-500/20 group-hover:scale-110 transition",children:f.jsx(dp,{className:"h-6 w-6 text-white"})}),f.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${((m=r==null?void 0:r.budgetStats)==null?void 0:m.status)==="over_budget"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":((g=r==null?void 0:r.budgetStats)==null?void 0:g.status)==="on_budget"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}`,children:[((v=r==null?void 0:r.budgetStats)==null?void 0:v.spentPercentage)??0,"%"]})]}),f.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Budget"}),f.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:["$",(((b=r==null?void 0:r.budgetStats)==null?void 0:b.spentAmount)??0).toLocaleString()," ",f.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ $",(((y=r==null?void 0:r.budgetStats)==null?void 0:y.totalBudget)??0).toLocaleString()]})]}),f.jsx("div",{className:"w-full h-2 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden mb-2",children:f.jsx("div",{className:`h-full rounded-full transition-all ${(((w=r==null?void 0:r.budgetStats)==null?void 0:w.spentPercentage)??0)>100?"bg-gradient-to-r from-red-400 to-red-500":(((E=r==null?void 0:r.budgetStats)==null?void 0:E.spentPercentage)??0)>=90?"bg-gradient-to-r from-amber-400 to-orange-500":"bg-gradient-to-r from-indigo-400 to-purple-500"}`,style:{width:`${Math.min(((k=r==null?void 0:r.budgetStats)==null?void 0:k.spentPercentage)??0,100)}%`}})}),f.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex items-center gap-2 text-xs text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition",children:[f.jsx(u5,{className:"h-4 w-4"}),"Manage Budget"]})]}),f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-pink-100 dark:hover:border-pink-800 transition-all group",children:[f.jsx("div",{className:"flex items-start justify-between mb-4",children:f.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-pink-400 to-rose-500 grid place-items-center shadow-lg shadow-pink-500/20 group-hover:scale-110 transition",children:f.jsx(ub,{className:"h-6 w-6 text-white"})})}),f.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Seating Progress"}),f.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-1",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"Guests seated:"}),f.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((N=r==null?void 0:r.tableStats)==null?void 0:N.assignedGuests)??0," / ",((_=r==null?void 0:r.tableStats)==null?void 0:_.totalSeats)??0]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{children:"Tables arranged:"}),f.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((R=r==null?void 0:r.tableStats)==null?void 0:R.arrangedTables)??0," / ",((A=r==null?void 0:r.tableStats)==null?void 0:A.totalTables)??0]})]})]}),f.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex items-center gap-2 text-xs text-pink-600 dark:text-pink-400 hover:text-pink-700 dark:hover:text-pink-300 transition",children:[f.jsx(hp,{className:"h-4 w-4"}),"Manage Tables"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 p-5",children:[f.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white mb-4",children:"Quick Actions"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border border-green-100 dark:border-green-800 hover:border-green-200 dark:hover:border-green-700 hover:shadow-md transition group",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-green-100 dark:bg-green-900/50 group-hover:bg-green-200 dark:group-hover:bg-green-800 grid place-items-center transition",children:f.jsx(R0,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),f.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add RSVP"})]}),f.jsxs("button",{onClick:()=>e("/app/rsvps/designer"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 border border-indigo-100 dark:border-indigo-800 hover:border-indigo-200 dark:hover:border-indigo-700 hover:shadow-md transition group",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-indigo-100 dark:bg-indigo-900/50 group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800 grid place-items-center transition",children:f.jsx(ub,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),f.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Design RSVP"})]}),f.jsxs("button",{disabled:!0,className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-950/20 dark:to-violet-950/20 border border-purple-100 dark:border-purple-800 opacity-60 cursor-not-allowed",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-purple-100 dark:bg-purple-900/50 grid place-items-center",children:f.jsx(fb,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),f.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Send Invites"})]}),f.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 border border-amber-100 dark:border-amber-800 hover:border-amber-200 dark:hover:border-amber-700 hover:shadow-md transition group",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-amber-100 dark:bg-amber-900/50 group-hover:bg-amber-200 dark:group-hover:bg-amber-800 grid place-items-center transition",children:f.jsx(hp,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),f.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Arrange Seats"})]}),f.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-950/20 dark:to-rose-950/20 border border-pink-100 dark:border-pink-800 hover:border-pink-200 dark:hover:border-pink-700 hover:shadow-md transition group",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-pink-100 dark:bg-pink-900/50 group-hover:bg-pink-200 dark:group-hover:bg-pink-800 grid place-items-center transition",children:f.jsx(dp,{className:"h-5 w-5 text-pink-600 dark:text-pink-400"})}),f.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add Expense"})]})]})]}),f.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden",children:[f.jsx("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between",children:f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Recent Activity"}),f.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Latest updates from your event"})]})}),f.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700 max-h-[400px] overflow-y-auto",children:r!=null&&r.recentActivity&&r.recentActivity.length>0?r.recentActivity.map((D,T)=>f.jsxs("div",{className:"px-6 py-4 hover:bg-slate-50/50 dark:hover:bg-slate-700/50 transition flex items-start gap-4",children:[f.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 grid place-items-center flex-shrink-0",children:f.jsx("span",{className:"text-lg",children:D.icon})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm text-slate-800 dark:text-white",children:D.description}),D.details&&f.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:D.details})]}),f.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 flex-shrink-0",children:zI(D.timestamp)})]},T)):f.jsxs("div",{className:"px-6 py-12 text-center",children:[f.jsx("div",{className:"h-16 w-16 rounded-2xl bg-slate-100 dark:bg-slate-700 grid place-items-center mx-auto mb-4",children:f.jsx(p5,{className:"h-8 w-8 text-slate-400 dark:text-slate-500"})}),f.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-2 font-medium",children:"No activity yet"}),f.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:"Activity will appear here as guests respond and you manage your event"})]})})]})]})]})}function GI(){const[e,t]=C.useState(""),[r,a]=C.useState(""),[n,l]=C.useState("Yes"),o=u=>{u.preventDefault(),alert(`RSVP submitted for ${e}: ${n}`)};return f.jsx("section",{className:"py-20 bg-background text-text",children:f.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[f.jsx("h2",{className:"text-3xl font-semibold text-primary text-center",children:"RSVP"}),f.jsxs("form",{onSubmit:o,className:"space-y-4",children:[f.jsx(sr,{label:"Name",value:e,onChange:u=>t(u.target.value)}),f.jsx(sr,{label:"Email",type:"email",value:r,onChange:u=>a(u.target.value)}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1",children:"Will you attend?"}),f.jsx("select",{value:n,onChange:u=>l(u.target.value),className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",children:["Yes","No","Maybe"].map(u=>f.jsx("option",{children:u},u))})]}),f.jsx(Fe,{type:"submit",variant:"primary",className:"w-full",children:"Submit RSVP"})]})]})})}function VI(){return f.jsx("section",{className:"py-20 bg-background text-text",children:f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsx("h2",{className:"text-4xl font-playfair italic text-primary text-center",children:"Wedding Events"}),f.jsx("ul",{className:"space-y-4",children:[{label:"Ceremony",date:"Feb 14, 2025",time:"10:00 AM"},{label:"Reception",date:"Feb 14, 2025",time:"6:00 PM"}].map(e=>f.jsxs("li",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between",children:[f.jsx("span",{className:"font-semibold",children:e.label}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.date," @ ",e.time]})]},e.label))})]})})}function qI(){const e=Na(),{eventId:t}=$r();console.log("NewRsvpModal eventId:",t);const r=Mg(t),a=n=>{r.mutate(n,{onSuccess:()=>{e(-1)}})};return f.jsx(Pg,{isOpen:!0,onClose:()=>e(-1),eventId:t,onSave:a})}function WI(){const e=Na(),{eventId:t}=$r(),{id:r}=Gn(),{data:a,isLoading:n}=CP(t,r),l=Lg(t);if(n)return null;const o=(u,h)=>{const x=h;l.mutate({rsvpGuid:x,...u},{onSuccess:()=>e(-1)})};return f.jsx(Pg,{isOpen:!0,onClose:()=>e(-1),eventId:t,initial:a,onSave:o})}const No={text:0,textarea:1,select:2,radio:3,checkbox:4,email:5,number:6,date:7},Nw=["select","radio","checkbox"];function XI({isOpen:e,onClose:t,initial:r,onSave:a}){const n=C.useMemo(()=>{const k=Object.entries(No).find(([,N])=>N===((r==null?void 0:r.type)??No.text));return(k==null?void 0:k[0])??"text"},[r==null?void 0:r.type]),[l,o]=C.useState((r==null?void 0:r.text)??""),[u,h]=C.useState((r==null?void 0:r.isRequired)??!1),[x,m]=C.useState(n),[g,v]=C.useState((r==null?void 0:r.options)??""),[b,y]=C.useState(Number.isFinite(r==null?void 0:r.order)?r.order:0);C.useEffect(()=>{if(!e)return;o((r==null?void 0:r.text)??""),h((r==null?void 0:r.isRequired)??!1),y(Number.isFinite(r==null?void 0:r.order)?r.order:0);const k=Object.entries(No).find(([,N])=>N===((r==null?void 0:r.type)??No.text));m((k==null?void 0:k[0])??"text"),v((r==null?void 0:r.options)??"")},[e,r]);const w=k=>{k.preventDefault();const N={id:r==null?void 0:r.id,text:l,isRequired:u,type:No[x],options:Nw.includes(x)?(g||"").trim():void 0,order:Number.isFinite(b)?b:0,isDeleted:(r==null?void 0:r.isDeleted)??!1};a(N)},E=Nw.includes(x);return f.jsx(qn,{isOpen:e,onClose:t,title:r?"Edit Field":"New Field",children:f.jsxs("form",{onSubmit:w,className:"space-y-4",children:[f.jsx(sr,{label:"Question Text",value:l,onChange:k=>o(k.target.value),placeholder:"e.g. Do you have any dietary requirements?"}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1",children:"Type"}),f.jsx("select",{value:x,onChange:k=>m(k.target.value),className:"w-full border rounded p-2",children:Object.keys(No).map(k=>f.jsx("option",{value:k,children:k},k))}),f.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This maps to API numeric codes (e.g. text=0, textarea=1, select=2, )."})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("input",{id:"required",type:"checkbox",checked:u,onChange:k=>h(k.target.checked)}),f.jsx("label",{htmlFor:"required",children:"Required"})]}),E&&f.jsx(sr,{label:"Options (comma-separated)",value:g,onChange:k=>v(k.target.value),placeholder:"e.g. Beef, Chicken, Fish, Vegetarian"}),f.jsx(sr,{label:"Order",type:"number",value:String(b),onChange:k=>y(Number(k.target.value)),placeholder:"0"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(Fe,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),f.jsx(Fe,{type:"submit",variant:"primary",children:r?"Save":"Create"})]})]})})}function YI(){const{id:e}=Gn(),t=e??"",{data:r,isLoading:a,isError:n}=Bg(t),l=jP(),o=RP(),u=DP(),[h,x]=C.useState({open:!1}),m=C.useMemo(()=>Array.isArray(r)?r:[],[r]);return t?a?f.jsx("p",{children:"Loading form fields"}):n?f.jsx("p",{children:"Failed to load form fields."}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h2",{className:"text-2xl font-semibold",children:"Custom RSVP Fields"}),f.jsx(Fe,{onClick:()=>x({open:!0}),children:"+ New Field"})]}),m.length===0?f.jsxs("div",{className:"text-center text-gray-500 py-10 bg-white dark:bg-gray-800 rounded-lg shadow",children:[f.jsx("p",{children:"No custom fields yet."}),f.jsxs("p",{className:"mt-2",children:["Click ",f.jsx("span",{className:"font-semibold",children:"+ New Field"})," to add one."]})]}):f.jsx("ul",{className:"space-y-2",children:m.map(g=>f.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:g.label??g.text}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[typeof g.type=="number"?g.type:g.typeKey??String(g.type)," ",g.isRequired&&" required"]})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Fe,{variant:"secondary",onClick:()=>x({open:!0,initial:g}),children:"Edit"}),f.jsx(Fe,{variant:"primary",onClick:()=>{g.questionId&&u.mutate()},children:"Delete"})]})]},g.questionId??g.id))}),h.open&&f.jsx(XI,{isOpen:h.open,onClose:()=>x({open:!1}),initial:h.initial?{id:h.initial.questionId??h.initial.id,text:h.initial.text??h.initial.label??"",isRequired:h.initial.isRequired??!1,order:h.initial.order??0,type:h.initial.type??0,options:Array.isArray(h.initial.options)?h.initial.options.join(","):typeof h.initial.options=="string"?h.initial.options:void 0}:void 0,onSave:g=>{var b;if(!t)return;const v={text:g.text??"",type:g.type,isRequired:g.isRequired,options:g.options??"",eventGuid:t};(b=h.initial)!=null&&b.questionId?o.mutate({...v,questionId:h.initial.questionId.toString()}):l.mutate(v),x({open:!1})}})]}):f.jsx(uc,{title:"No Event Selected",message:"Create your first event to start customizing your RSVP form fields."})}function $I(){const{tableId:e}=Gn(),{eventId:t}=$r(),{data:r,isLoading:a}=yu(e),{data:n=[],isLoading:l}=Zd(t),o=KP(t),u=QP(t),h=YP(e,t),[x,m]=C.useState((r==null?void 0:r.extraGuests)||0);if(a||l)return f.jsx("p",{children:"Loading"});const g=n.filter(b=>b.tableId===e),v=n.filter(b=>!b.tableId);return f.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold",children:"Unassigned Guests"}),v.length===0?f.jsx("p",{children:"All guests are assigned."}):f.jsx("ul",{className:"mt-2 space-y-2",children:v.map(b=>f.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[f.jsx("span",{children:b.guestName||b.name}),f.jsx(Fe,{onClick:()=>o.mutate({guestId:b.id,tableId:e}),children:"Assign "})]},b.id))})]}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold",children:"Assigned Guests"}),g.length===0?f.jsx("p",{children:"No one assigned yet."}):f.jsx("ul",{className:"mt-2 space-y-2",children:g.map(b=>f.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[f.jsx("span",{children:b.guestName||b.name}),f.jsx(Fe,{variant:"secondary",onClick:()=>u.mutate(b.id),children:" Unassign"})]},b.id))}),f.jsxs("div",{className:"mt-6",children:[f.jsx("h3",{className:"font-medium",children:"Additional Guests"}),f.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[f.jsx(Fe,{onClick:()=>m(b=>Math.max(0,b-1)),children:""}),f.jsx("span",{className:"px-4",children:x}),f.jsx(Fe,{onClick:()=>m(b=>b+1),children:""}),f.jsx(Fe,{variant:"primary",onClick:()=>h.mutate({extraGuests:x,tableName:(r==null?void 0:r.name)||"",maxSeats:(r==null?void 0:r.capacity)||0}),children:"Save"})]})]})]})]})}function KI(){return f.jsxs("div",{className:"space-y-4",children:[f.jsx("nav",{className:"border-b pb-2 flex space-x-4",children:[["","Summary"],["assignments","Assign Guests"],["layout","Layout"],["print","Print"],["edit","Edit"]].map(([e,t])=>f.jsx(N0,{to:e,end:e==="",className:({isActive:r})=>r?"border-b-2 border-button":void 0,children:t},e))}),f.jsx(js,{})]})}var u0={exports:{}},Bm={},Pm={exports:{}},Im,Cw;function QI(){if(Cw)return Im;Cw=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Im=e,Im}var Um,Aw;function ZI(){if(Aw)return Um;Aw=1;var e=QI();function t(){}function r(){}return r.resetWarningCache=t,Um=function(){function a(o,u,h,x,m,g){if(g!==e){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}a.isRequired=a;function n(){return a}var l={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:n,element:a,elementType:a,instanceOf:n,node:a,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},Um}var jw;function j_(){return jw||(jw=1,Pm.exports=ZI()()),Pm.exports}function R_(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=R_(e[t]))&&(a&&(a+=" "),a+=r);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function Rw(){for(var e,t,r=0,a="";r<arguments.length;)(e=arguments[r++])&&(t=R_(e))&&(a&&(a+=" "),a+=t);return a}const JI=Object.freeze(Object.defineProperty({__proto__:null,clsx:Rw,default:Rw},Symbol.toStringTag,{value:"Module"})),eU=UT(JI);var kr={},vi={},Dw;function th(){if(Dw)return vi;Dw=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.dontSetMe=n,vi.findInArray=e,vi.int=a,vi.isFunction=t,vi.isNum=r;function e(l,o){for(let u=0,h=l.length;u<h;u++)if(o.apply(o,[l[u],u,l]))return l[u]}function t(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Function]"}function r(l){return typeof l=="number"&&!isNaN(l)}function a(l){return parseInt(l,10)}function n(l,o,u){if(l[o])return new Error("Invalid prop ".concat(o," passed to ").concat(u," - do not set this, set it on the child."))}return vi}var yi={},Fw;function tU(){if(Fw)return yi;Fw=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.browserPrefixToKey=r,yi.browserPrefixToStyle=a,yi.default=void 0,yi.getPrefix=t;const e=["Moz","Webkit","O","ms"];function t(){var l;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const u=(l=window.document)===null||l===void 0||(l=l.documentElement)===null||l===void 0?void 0:l.style;if(!u||o in u)return"";for(let h=0;h<e.length;h++)if(r(o,e[h])in u)return e[h];return""}function r(l,o){return o?"".concat(o).concat(n(l)):l}function a(l,o){return o?"-".concat(o.toLowerCase(),"-").concat(l):l}function n(l){let o="",u=!0;for(let h=0;h<l.length;h++)u?(o+=l[h].toUpperCase(),u=!1):l[h]==="-"?u=!0:o+=l[h];return o}return yi.default=t(),yi}var Ow;function Vg(){if(Ow)return kr;Ow=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.addClassName=A,kr.addEvent=u,kr.addUserSelectStyles=_,kr.createCSSTransform=y,kr.createSVGTransform=w,kr.getTouch=k,kr.getTouchIdentifier=N,kr.getTranslation=E,kr.innerHeight=g,kr.innerWidth=v,kr.matchesSelector=l,kr.matchesSelectorAndParentsTo=o,kr.offsetXYFromParent=b,kr.outerHeight=x,kr.outerWidth=m,kr.removeClassName=D,kr.removeEvent=h,kr.removeUserSelectStyles=R;var e=th(),t=a(tU());function r(T){if(typeof WeakMap!="function")return null;var F=new WeakMap,O=new WeakMap;return(r=function(U){return U?O:F})(T)}function a(T,F){if(T&&T.__esModule)return T;if(T===null||typeof T!="object"&&typeof T!="function")return{default:T};var O=r(F);if(O&&O.has(T))return O.get(T);var U={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var z in T)if(z!=="default"&&Object.prototype.hasOwnProperty.call(T,z)){var te=q?Object.getOwnPropertyDescriptor(T,z):null;te&&(te.get||te.set)?Object.defineProperty(U,z,te):U[z]=T[z]}return U.default=T,O&&O.set(T,U),U}let n="";function l(T,F){return n||(n=(0,e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(O){return(0,e.isFunction)(T[O])})),(0,e.isFunction)(T[n])?T[n](F):!1}function o(T,F,O){let U=T;do{if(l(U,F))return!0;if(U===O)return!1;U=U.parentNode}while(U);return!1}function u(T,F,O,U){if(!T)return;const q={capture:!0,...U};T.addEventListener?T.addEventListener(F,O,q):T.attachEvent?T.attachEvent("on"+F,O):T["on"+F]=O}function h(T,F,O,U){if(!T)return;const q={capture:!0,...U};T.removeEventListener?T.removeEventListener(F,O,q):T.detachEvent?T.detachEvent("on"+F,O):T["on"+F]=null}function x(T){let F=T.clientHeight;const O=T.ownerDocument.defaultView.getComputedStyle(T);return F+=(0,e.int)(O.borderTopWidth),F+=(0,e.int)(O.borderBottomWidth),F}function m(T){let F=T.clientWidth;const O=T.ownerDocument.defaultView.getComputedStyle(T);return F+=(0,e.int)(O.borderLeftWidth),F+=(0,e.int)(O.borderRightWidth),F}function g(T){let F=T.clientHeight;const O=T.ownerDocument.defaultView.getComputedStyle(T);return F-=(0,e.int)(O.paddingTop),F-=(0,e.int)(O.paddingBottom),F}function v(T){let F=T.clientWidth;const O=T.ownerDocument.defaultView.getComputedStyle(T);return F-=(0,e.int)(O.paddingLeft),F-=(0,e.int)(O.paddingRight),F}function b(T,F,O){const q=F===F.ownerDocument.body?{left:0,top:0}:F.getBoundingClientRect(),z=(T.clientX+F.scrollLeft-q.left)/O,te=(T.clientY+F.scrollTop-q.top)/O;return{x:z,y:te}}function y(T,F){const O=E(T,F,"px");return{[(0,t.browserPrefixToKey)("transform",t.default)]:O}}function w(T,F){return E(T,F,"")}function E(T,F,O){let{x:U,y:q}=T,z="translate(".concat(U).concat(O,",").concat(q).concat(O,")");if(F){const te="".concat(typeof F.x=="string"?F.x:F.x+O),ce="".concat(typeof F.y=="string"?F.y:F.y+O);z="translate(".concat(te,", ").concat(ce,")")+z}return z}function k(T,F){return T.targetTouches&&(0,e.findInArray)(T.targetTouches,O=>F===O.identifier)||T.changedTouches&&(0,e.findInArray)(T.changedTouches,O=>F===O.identifier)}function N(T){if(T.targetTouches&&T.targetTouches[0])return T.targetTouches[0].identifier;if(T.changedTouches&&T.changedTouches[0])return T.changedTouches[0].identifier}function _(T){if(!T)return;let F=T.getElementById("react-draggable-style-el");F||(F=T.createElement("style"),F.type="text/css",F.id="react-draggable-style-el",F.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,F.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,T.getElementsByTagName("head")[0].appendChild(F)),T.body&&A(T.body,"react-draggable-transparent-selection")}function R(T){if(T)try{if(T.body&&D(T.body,"react-draggable-transparent-selection"),T.selection)T.selection.empty();else{const F=(T.defaultView||window).getSelection();F&&F.type!=="Caret"&&F.removeAllRanges()}}catch{}}function A(T,F){T.classList?T.classList.add(F):T.className.match(new RegExp("(?:^|\\s)".concat(F,"(?!\\S)")))||(T.className+=" ".concat(F))}function D(T,F){T.classList?T.classList.remove(F):T.className=T.className.replace(new RegExp("(?:^|\\s)".concat(F,"(?!\\S)"),"g"),"")}return kr}var Jn={},Mw;function D_(){if(Mw)return Jn;Mw=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.canDragX=n,Jn.canDragY=l,Jn.createCoreData=u,Jn.createDraggableData=h,Jn.getBoundPosition=r,Jn.getControlPosition=o,Jn.snapToGrid=a;var e=th(),t=Vg();function r(g,v,b){if(!g.props.bounds)return[v,b];let{bounds:y}=g.props;y=typeof y=="string"?y:x(y);const w=m(g);if(typeof y=="string"){const{ownerDocument:E}=w,k=E.defaultView;let N;if(y==="parent"?N=w.parentNode:N=E.querySelector(y),!(N instanceof k.HTMLElement))throw new Error('Bounds selector "'+y+'" could not find an element.');const _=N,R=k.getComputedStyle(w),A=k.getComputedStyle(_);y={left:-w.offsetLeft+(0,e.int)(A.paddingLeft)+(0,e.int)(R.marginLeft),top:-w.offsetTop+(0,e.int)(A.paddingTop)+(0,e.int)(R.marginTop),right:(0,t.innerWidth)(_)-(0,t.outerWidth)(w)-w.offsetLeft+(0,e.int)(A.paddingRight)-(0,e.int)(R.marginRight),bottom:(0,t.innerHeight)(_)-(0,t.outerHeight)(w)-w.offsetTop+(0,e.int)(A.paddingBottom)-(0,e.int)(R.marginBottom)}}return(0,e.isNum)(y.right)&&(v=Math.min(v,y.right)),(0,e.isNum)(y.bottom)&&(b=Math.min(b,y.bottom)),(0,e.isNum)(y.left)&&(v=Math.max(v,y.left)),(0,e.isNum)(y.top)&&(b=Math.max(b,y.top)),[v,b]}function a(g,v,b){const y=Math.round(v/g[0])*g[0],w=Math.round(b/g[1])*g[1];return[y,w]}function n(g){return g.props.axis==="both"||g.props.axis==="x"}function l(g){return g.props.axis==="both"||g.props.axis==="y"}function o(g,v,b){const y=typeof v=="number"?(0,t.getTouch)(g,v):null;if(typeof v=="number"&&!y)return null;const w=m(b),E=b.props.offsetParent||w.offsetParent||w.ownerDocument.body;return(0,t.offsetXYFromParent)(y||g,E,b.props.scale)}function u(g,v,b){const y=!(0,e.isNum)(g.lastX),w=m(g);return y?{node:w,deltaX:0,deltaY:0,lastX:v,lastY:b,x:v,y:b}:{node:w,deltaX:v-g.lastX,deltaY:b-g.lastY,lastX:g.lastX,lastY:g.lastY,x:v,y:b}}function h(g,v){const b=g.props.scale;return{node:v.node,x:g.state.x+v.deltaX/b,y:g.state.y+v.deltaY/b,deltaX:v.deltaX/b,deltaY:v.deltaY/b,lastX:g.state.x,lastY:g.state.y}}function x(g){return{left:g.left,top:g.top,right:g.right,bottom:g.bottom}}function m(g){const v=g.findDOMNode();if(!v)throw new Error("<DraggableCore>: Unmounted during event!");return v}return Jn}var f0={},Xf={},Lw;function F_(){if(Lw)return Xf;Lw=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.default=e;function e(){}return Xf}var Bw;function rU(){if(Bw)return f0;Bw=1,Object.defineProperty(f0,"__esModule",{value:!0}),f0.default=void 0;var e=x(Q0()),t=u(j_()),r=u(Cd()),a=Vg(),n=D_(),l=th(),o=u(F_());function u(E){return E&&E.__esModule?E:{default:E}}function h(E){if(typeof WeakMap!="function")return null;var k=new WeakMap,N=new WeakMap;return(h=function(_){return _?N:k})(E)}function x(E,k){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var N=h(k);if(N&&N.has(E))return N.get(E);var _={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in E)if(A!=="default"&&Object.prototype.hasOwnProperty.call(E,A)){var D=R?Object.getOwnPropertyDescriptor(E,A):null;D&&(D.get||D.set)?Object.defineProperty(_,A,D):_[A]=E[A]}return _.default=E,N&&N.set(E,_),_}function m(E,k,N){return k=g(k),k in E?Object.defineProperty(E,k,{value:N,enumerable:!0,configurable:!0,writable:!0}):E[k]=N,E}function g(E){var k=v(E,"string");return typeof k=="symbol"?k:String(k)}function v(E,k){if(typeof E!="object"||E===null)return E;var N=E[Symbol.toPrimitive];if(N!==void 0){var _=N.call(E,k);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(E)}const b={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let y=b.mouse,w=class extends e.Component{constructor(){super(...arguments),m(this,"dragging",!1),m(this,"lastX",NaN),m(this,"lastY",NaN),m(this,"touchIdentifier",null),m(this,"mounted",!1),m(this,"handleDragStart",k=>{if(this.props.onMouseDown(k),!this.props.allowAnyClick&&typeof k.button=="number"&&k.button!==0)return!1;const N=this.findDOMNode();if(!N||!N.ownerDocument||!N.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:_}=N;if(this.props.disabled||!(k.target instanceof _.defaultView.Node)||this.props.handle&&!(0,a.matchesSelectorAndParentsTo)(k.target,this.props.handle,N)||this.props.cancel&&(0,a.matchesSelectorAndParentsTo)(k.target,this.props.cancel,N))return;k.type==="touchstart"&&k.preventDefault();const R=(0,a.getTouchIdentifier)(k);this.touchIdentifier=R;const A=(0,n.getControlPosition)(k,R,this);if(A==null)return;const{x:D,y:T}=A,F=(0,n.createCoreData)(this,D,T);(0,o.default)("DraggableCore: handleDragStart: %j",F),(0,o.default)("calling",this.props.onStart),!(this.props.onStart(k,F)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,a.addUserSelectStyles)(_),this.dragging=!0,this.lastX=D,this.lastY=T,(0,a.addEvent)(_,y.move,this.handleDrag),(0,a.addEvent)(_,y.stop,this.handleDragStop))}),m(this,"handleDrag",k=>{const N=(0,n.getControlPosition)(k,this.touchIdentifier,this);if(N==null)return;let{x:_,y:R}=N;if(Array.isArray(this.props.grid)){let T=_-this.lastX,F=R-this.lastY;if([T,F]=(0,n.snapToGrid)(this.props.grid,T,F),!T&&!F)return;_=this.lastX+T,R=this.lastY+F}const A=(0,n.createCoreData)(this,_,R);if((0,o.default)("DraggableCore: handleDrag: %j",A),this.props.onDrag(k,A)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const F=document.createEvent("MouseEvents");F.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(F)}return}this.lastX=_,this.lastY=R}),m(this,"handleDragStop",k=>{if(!this.dragging)return;const N=(0,n.getControlPosition)(k,this.touchIdentifier,this);if(N==null)return;let{x:_,y:R}=N;if(Array.isArray(this.props.grid)){let F=_-this.lastX||0,O=R-this.lastY||0;[F,O]=(0,n.snapToGrid)(this.props.grid,F,O),_=this.lastX+F,R=this.lastY+O}const A=(0,n.createCoreData)(this,_,R);if(this.props.onStop(k,A)===!1||this.mounted===!1)return!1;const T=this.findDOMNode();T&&this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(T.ownerDocument),(0,o.default)("DraggableCore: handleDragStop: %j",A),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,T&&((0,o.default)("DraggableCore: Removing handlers"),(0,a.removeEvent)(T.ownerDocument,y.move,this.handleDrag),(0,a.removeEvent)(T.ownerDocument,y.stop,this.handleDragStop))}),m(this,"onMouseDown",k=>(y=b.mouse,this.handleDragStart(k))),m(this,"onMouseUp",k=>(y=b.mouse,this.handleDragStop(k))),m(this,"onTouchStart",k=>(y=b.touch,this.handleDragStart(k))),m(this,"onTouchEnd",k=>(y=b.touch,this.handleDragStop(k)))}componentDidMount(){this.mounted=!0;const k=this.findDOMNode();k&&(0,a.addEvent)(k,b.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const k=this.findDOMNode();if(k){const{ownerDocument:N}=k;(0,a.removeEvent)(N,b.mouse.move,this.handleDrag),(0,a.removeEvent)(N,b.touch.move,this.handleDrag),(0,a.removeEvent)(N,b.mouse.stop,this.handleDragStop),(0,a.removeEvent)(N,b.touch.stop,this.handleDragStop),(0,a.removeEvent)(k,b.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(N)}}findDOMNode(){var k,N;return(k=this.props)!==null&&k!==void 0&&k.nodeRef?(N=this.props)===null||N===void 0||(N=N.nodeRef)===null||N===void 0?void 0:N.current:r.default.findDOMNode(this)}render(){return e.cloneElement(e.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return f0.default=w,m(w,"displayName","DraggableCore"),m(w,"propTypes",{allowAnyClick:t.default.bool,children:t.default.node.isRequired,disabled:t.default.bool,enableUserSelectHack:t.default.bool,offsetParent:function(E,k){if(E[k]&&E[k].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:t.default.arrayOf(t.default.number),handle:t.default.string,cancel:t.default.string,nodeRef:t.default.object,onStart:t.default.func,onDrag:t.default.func,onStop:t.default.func,onMouseDown:t.default.func,scale:t.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),m(w,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),f0}var Pw;function aU(){return Pw||(Pw=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return h.default}}),e.default=void 0;var t=v(Q0()),r=m(j_()),a=m(Cd()),n=m(eU),l=Vg(),o=D_(),u=th(),h=m(rU()),x=m(F_());function m(N){return N&&N.__esModule?N:{default:N}}function g(N){if(typeof WeakMap!="function")return null;var _=new WeakMap,R=new WeakMap;return(g=function(A){return A?R:_})(N)}function v(N,_){if(N&&N.__esModule)return N;if(N===null||typeof N!="object"&&typeof N!="function")return{default:N};var R=g(_);if(R&&R.has(N))return R.get(N);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in N)if(T!=="default"&&Object.prototype.hasOwnProperty.call(N,T)){var F=D?Object.getOwnPropertyDescriptor(N,T):null;F&&(F.get||F.set)?Object.defineProperty(A,T,F):A[T]=N[T]}return A.default=N,R&&R.set(N,A),A}function b(){return b=Object.assign?Object.assign.bind():function(N){for(var _=1;_<arguments.length;_++){var R=arguments[_];for(var A in R)Object.prototype.hasOwnProperty.call(R,A)&&(N[A]=R[A])}return N},b.apply(this,arguments)}function y(N,_,R){return _=w(_),_ in N?Object.defineProperty(N,_,{value:R,enumerable:!0,configurable:!0,writable:!0}):N[_]=R,N}function w(N){var _=E(N,"string");return typeof _=="symbol"?_:String(_)}function E(N,_){if(typeof N!="object"||N===null)return N;var R=N[Symbol.toPrimitive];if(R!==void 0){var A=R.call(N,_);if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(N)}class k extends t.Component{static getDerivedStateFromProps(_,R){let{position:A}=_,{prevPropsPosition:D}=R;return A&&(!D||A.x!==D.x||A.y!==D.y)?((0,x.default)("Draggable: getDerivedStateFromProps %j",{position:A,prevPropsPosition:D}),{x:A.x,y:A.y,prevPropsPosition:{...A}}):null}constructor(_){super(_),y(this,"onDragStart",(R,A)=>{if((0,x.default)("Draggable: onDragStart: %j",A),this.props.onStart(R,(0,o.createDraggableData)(this,A))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),y(this,"onDrag",(R,A)=>{if(!this.state.dragging)return!1;(0,x.default)("Draggable: onDrag: %j",A);const D=(0,o.createDraggableData)(this,A),T={x:D.x,y:D.y,slackX:0,slackY:0};if(this.props.bounds){const{x:O,y:U}=T;T.x+=this.state.slackX,T.y+=this.state.slackY;const[q,z]=(0,o.getBoundPosition)(this,T.x,T.y);T.x=q,T.y=z,T.slackX=this.state.slackX+(O-T.x),T.slackY=this.state.slackY+(U-T.y),D.x=T.x,D.y=T.y,D.deltaX=T.x-this.state.x,D.deltaY=T.y-this.state.y}if(this.props.onDrag(R,D)===!1)return!1;this.setState(T)}),y(this,"onDragStop",(R,A)=>{if(!this.state.dragging||this.props.onStop(R,(0,o.createDraggableData)(this,A))===!1)return!1;(0,x.default)("Draggable: onDragStop: %j",A);const T={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:O,y:U}=this.props.position;T.x=O,T.y=U}this.setState(T)}),this.state={dragging:!1,dragged:!1,x:_.position?_.position.x:_.defaultPosition.x,y:_.position?_.position.y:_.defaultPosition.y,prevPropsPosition:{..._.position},slackX:0,slackY:0,isElementSVG:!1},_.position&&!(_.onDrag||_.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var _,R;return(_=(R=this.props)===null||R===void 0||(R=R.nodeRef)===null||R===void 0?void 0:R.current)!==null&&_!==void 0?_:a.default.findDOMNode(this)}render(){const{axis:_,bounds:R,children:A,defaultPosition:D,defaultClassName:T,defaultClassNameDragging:F,defaultClassNameDragged:O,position:U,positionOffset:q,scale:z,...te}=this.props;let ce={},de=null;const ie=!!!U||this.state.dragging,Te=U||D,ne={x:(0,o.canDragX)(this)&&ie?this.state.x:Te.x,y:(0,o.canDragY)(this)&&ie?this.state.y:Te.y};this.state.isElementSVG?de=(0,l.createSVGTransform)(ne,q):ce=(0,l.createCSSTransform)(ne,q);const B=(0,n.default)(A.props.className||"",T,{[F]:this.state.dragging,[O]:this.state.dragged});return t.createElement(h.default,b({},te,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(A),{className:B,style:{...A.props.style,...ce},transform:de}))}}e.default=k,y(k,"displayName","Draggable"),y(k,"propTypes",{...h.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:u.dontSetMe,style:u.dontSetMe,transform:u.dontSetMe}),y(k,"defaultProps",{...h.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(Bm)),Bm}var Iw;function nU(){if(Iw)return u0.exports;Iw=1;const{default:e,DraggableCore:t}=aU();return u0.exports=e,u0.exports.default=e,u0.exports.DraggableCore=t,u0.exports}var sU=nU();const iU=sS(sU);var Fr=function(){return Fr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Fr.apply(this,arguments)},Uw={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},zw={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},Yf={width:"20px",height:"20px",position:"absolute",zIndex:1},lU={top:Fr(Fr({},Uw),{top:"-5px"}),right:Fr(Fr({},zw),{left:void 0,right:"-5px"}),bottom:Fr(Fr({},Uw),{top:void 0,bottom:"-5px"}),left:Fr(Fr({},zw),{left:"-5px"}),topRight:Fr(Fr({},Yf),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Fr(Fr({},Yf),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Fr(Fr({},Yf),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Fr(Fr({},Yf),{left:"-10px",top:"-10px",cursor:"nw-resize"})},oU=C.memo(function(e){var t=e.onResizeStart,r=e.direction,a=e.children,n=e.replaceStyles,l=e.className,o=C.useCallback(function(x){t(x,r)},[t,r]),u=C.useCallback(function(x){t(x,r)},[t,r]),h=C.useMemo(function(){return Fr(Fr({position:"absolute",userSelect:"none"},lU[r]),n??{})},[n,r]);return f.jsx("div",{className:l||void 0,style:h,onMouseDown:o,onTouchStart:u,children:a})}),cU=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),rs=function(){return rs=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},rs.apply(this,arguments)},uU={width:"auto",height:"auto"},$f=function(e,t,r){return Math.max(Math.min(e,r),t)},Hw=function(e,t,r){var a=Math.round(e/t);return a*t+r*(a-1)},Co=function(e,t){return new RegExp(e,"i").test(t)},Kf=function(e){return!!(e.touches&&e.touches.length)},fU=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},Gw=function(e,t,r){r===void 0&&(r=0);var a=t.reduce(function(l,o,u){return Math.abs(o-e)<Math.abs(t[l]-e)?u:l},0),n=Math.abs(t[a]-e);return r===0||n<r?t[a]:e},zm=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:"".concat(e,"px")},Qf=function(e,t,r,a){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var n=Number(e.replace("%",""))/100;return t*n}if(e.endsWith("vw")){var n=Number(e.replace("vw",""))/100;return r*n}if(e.endsWith("vh")){var n=Number(e.replace("vh",""))/100;return a*n}}return e},dU=function(e,t,r,a,n,l,o){return a=Qf(a,e.width,t,r),n=Qf(n,e.height,t,r),l=Qf(l,e.width,t,r),o=Qf(o,e.height,t,r),{maxWidth:typeof a>"u"?void 0:Number(a),maxHeight:typeof n>"u"?void 0:Number(n),minWidth:typeof l>"u"?void 0:Number(l),minHeight:typeof o>"u"?void 0:Number(o)}},hU=function(e){return Array.isArray(e)?e:[e,e]},xU=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Vw="__resizable_base__",mU=function(e){cU(t,e);function t(r){var a,n,l,o,u=e.call(this,r)||this;return u.ratio=1,u.resizable=null,u.parentLeft=0,u.parentTop=0,u.resizableLeft=0,u.resizableRight=0,u.resizableTop=0,u.resizableBottom=0,u.targetLeft=0,u.targetTop=0,u.delta={width:0,height:0},u.appendBase=function(){if(!u.resizable||!u.window)return null;var h=u.parentNode;if(!h)return null;var x=u.window.document.createElement("div");return x.style.width="100%",x.style.height="100%",x.style.position="absolute",x.style.transform="scale(0, 0)",x.style.left="0",x.style.flex="0 0 100%",x.classList?x.classList.add(Vw):x.className+=Vw,h.appendChild(x),x},u.removeBase=function(h){var x=u.parentNode;x&&x.removeChild(h)},u.state={isResizing:!1,width:(n=(a=u.propsSize)===null||a===void 0?void 0:a.width)!==null&&n!==void 0?n:"auto",height:(o=(l=u.propsSize)===null||l===void 0?void 0:l.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},u.onResizeStart=u.onResizeStart.bind(u),u.onMouseMove=u.onMouseMove.bind(u),u.onMouseUp=u.onMouseUp.bind(u),u}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||uU},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var r=0,a=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,l=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),r=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:n,a=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:l,this.resizable.style.position=o}return{width:r,height:a}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var r=this,a=this.props.size,n=function(u){var h;if(typeof r.state[u]>"u"||r.state[u]==="auto")return"auto";if(r.propsSize&&r.propsSize[u]&&(!((h=r.propsSize[u])===null||h===void 0)&&h.toString().endsWith("%"))){if(r.state[u].toString().endsWith("%"))return r.state[u].toString();var x=r.getParentSize(),m=Number(r.state[u].toString().replace("px","")),g=m/x[u]*100;return"".concat(g,"%")}return zm(r.state[u])},l=a&&typeof a.width<"u"&&!this.state.isResizing?zm(a.width):n("width"),o=a&&typeof a.height<"u"&&!this.state.isResizing?zm(a.height):n("height");return{width:l,height:o}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var r=this.appendBase();if(!r)return{width:0,height:0};var a=!1,n=this.parentNode.style.flexWrap;n!=="wrap"&&(a=!0,this.parentNode.style.flexWrap="wrap"),r.style.position="relative",r.style.minWidth="100%",r.style.minHeight="100%";var l={width:r.offsetWidth,height:r.offsetHeight};return a&&(this.parentNode.style.flexWrap=n),this.removeBase(r),l},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var r=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:r.flexBasis!=="auto"?r.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(r,a){var n=this.propsSize&&this.propsSize[a];return this.state[a]==="auto"&&this.state.original[a]===r&&(typeof n>"u"||n==="auto")?"auto":r},t.prototype.calculateNewMaxFromBoundary=function(r,a){var n=this.props.boundsByDirection,l=this.state.direction,o=n&&Co("left",l),u=n&&Co("top",l),h,x;if(this.props.bounds==="parent"){var m=this.parentNode;m&&(h=o?this.resizableRight-this.parentLeft:m.offsetWidth+(this.parentLeft-this.resizableLeft),x=u?this.resizableBottom-this.parentTop:m.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(h=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,x=u?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(h=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),x=u?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return h&&Number.isFinite(h)&&(r=r&&r<h?r:h),x&&Number.isFinite(x)&&(a=a&&a<x?a:x),{maxWidth:r,maxHeight:a}},t.prototype.calculateNewSizeFromDirection=function(r,a){var n=this.props.scale||1,l=hU(this.props.resizeRatio||1),o=l[0],u=l[1],h=this.state,x=h.direction,m=h.original,g=this.props,v=g.lockAspectRatio,b=g.lockAspectRatioExtraHeight,y=g.lockAspectRatioExtraWidth,w=m.width,E=m.height,k=b||0,N=y||0;return Co("right",x)&&(w=m.width+(r-m.x)*o/n,v&&(E=(w-N)/this.ratio+k)),Co("left",x)&&(w=m.width-(r-m.x)*o/n,v&&(E=(w-N)/this.ratio+k)),Co("bottom",x)&&(E=m.height+(a-m.y)*u/n,v&&(w=(E-k)*this.ratio+N)),Co("top",x)&&(E=m.height-(a-m.y)*u/n,v&&(w=(E-k)*this.ratio+N)),{newWidth:w,newHeight:E}},t.prototype.calculateNewSizeFromAspectRatio=function(r,a,n,l){var o=this.props,u=o.lockAspectRatio,h=o.lockAspectRatioExtraHeight,x=o.lockAspectRatioExtraWidth,m=typeof l.width>"u"?10:l.width,g=typeof n.width>"u"||n.width<0?r:n.width,v=typeof l.height>"u"?10:l.height,b=typeof n.height>"u"||n.height<0?a:n.height,y=h||0,w=x||0;if(u){var E=(v-y)*this.ratio+w,k=(b-y)*this.ratio+w,N=(m-w)/this.ratio+y,_=(g-w)/this.ratio+y,R=Math.max(m,E),A=Math.min(g,k),D=Math.max(v,N),T=Math.min(b,_);r=$f(r,R,A),a=$f(a,D,T)}else r=$f(r,m,g),a=$f(a,v,b);return{newWidth:r,newHeight:a}},t.prototype.setBoundingClientRect=function(){var r=1/(this.props.scale||1);if(this.props.bounds==="parent"){var a=this.parentNode;if(a){var n=a.getBoundingClientRect();this.parentLeft=n.left*r,this.parentTop=n.top*r}}if(this.props.bounds&&typeof this.props.bounds!="string"){var l=this.props.bounds.getBoundingClientRect();this.targetLeft=l.left*r,this.targetTop=l.top*r}if(this.resizable){var o=this.resizable.getBoundingClientRect(),u=o.left,h=o.top,x=o.right,m=o.bottom;this.resizableLeft=u*r,this.resizableRight=x*r,this.resizableTop=h*r,this.resizableBottom=m*r}},t.prototype.onResizeStart=function(r,a){if(!(!this.resizable||!this.window)){var n=0,l=0;if(r.nativeEvent&&fU(r.nativeEvent)?(n=r.nativeEvent.clientX,l=r.nativeEvent.clientY):r.nativeEvent&&Kf(r.nativeEvent)&&(n=r.nativeEvent.touches[0].clientX,l=r.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(r,a,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var u,h=this.window.getComputedStyle(this.resizable);if(h.flexBasis!=="auto"){var x=this.parentNode;if(x){var m=this.window.getComputedStyle(x).flexDirection;this.flexDir=m.startsWith("row")?"row":"column",u=h.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var g={original:{x:n,y:l,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:rs(rs({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(r.target).cursor||"auto"}),direction:a,flexBasis:u};this.setState(g)}},t.prototype.onMouseMove=function(r){var a=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&Kf(r))try{r.preventDefault(),r.stopPropagation()}catch{}var n=this.props,l=n.maxWidth,o=n.maxHeight,u=n.minWidth,h=n.minHeight,x=Kf(r)?r.touches[0].clientX:r.clientX,m=Kf(r)?r.touches[0].clientY:r.clientY,g=this.state,v=g.direction,b=g.original,y=g.width,w=g.height,E=this.getParentSize(),k=dU(E,this.window.innerWidth,this.window.innerHeight,l,o,u,h);l=k.maxWidth,o=k.maxHeight,u=k.minWidth,h=k.minHeight;var N=this.calculateNewSizeFromDirection(x,m),_=N.newHeight,R=N.newWidth,A=this.calculateNewMaxFromBoundary(l,o);this.props.snap&&this.props.snap.x&&(R=Gw(R,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(_=Gw(_,this.props.snap.y,this.props.snapGap));var D=this.calculateNewSizeFromAspectRatio(R,_,{width:A.maxWidth,height:A.maxHeight},{width:u,height:h});if(R=D.newWidth,_=D.newHeight,this.props.grid){var T=Hw(R,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),F=Hw(_,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),O=this.props.snapGap||0,U=O===0||Math.abs(T-R)<=O?T:R,q=O===0||Math.abs(F-_)<=O?F:_;R=U,_=q}var z={width:R-b.width,height:_-b.height};if(this.delta=z,y&&typeof y=="string"){if(y.endsWith("%")){var te=R/E.width*100;R="".concat(te,"%")}else if(y.endsWith("vw")){var ce=R/this.window.innerWidth*100;R="".concat(ce,"vw")}else if(y.endsWith("vh")){var de=R/this.window.innerHeight*100;R="".concat(de,"vh")}}if(w&&typeof w=="string"){if(w.endsWith("%")){var te=_/E.height*100;_="".concat(te,"%")}else if(w.endsWith("vw")){var ce=_/this.window.innerWidth*100;_="".concat(ce,"vw")}else if(w.endsWith("vh")){var de=_/this.window.innerHeight*100;_="".concat(de,"vh")}}var ee={width:this.createSizeForCssProperty(R,"width"),height:this.createSizeForCssProperty(_,"height")};this.flexDir==="row"?ee.flexBasis=ee.width:this.flexDir==="column"&&(ee.flexBasis=ee.height);var ie=this.state.width!==ee.width,Te=this.state.height!==ee.height,ne=this.state.flexBasis!==ee.flexBasis,B=ie||Te||ne;B&&bS.flushSync(function(){a.setState(ee)}),this.props.onResize&&B&&this.props.onResize(r,v,this.resizable,z)}},t.prototype.onMouseUp=function(r){var a,n,l=this.state,o=l.isResizing,u=l.direction;l.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(r,u,this.resizable,this.delta),this.props.size&&this.setState({width:(a=this.props.size.width)!==null&&a!==void 0?a:"auto",height:(n=this.props.size.height)!==null&&n!==void 0?n:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:rs(rs({},this.state.backgroundStyle),{cursor:"auto"})}))},t.prototype.updateSize=function(r){var a,n;this.setState({width:(a=r.width)!==null&&a!==void 0?a:"auto",height:(n=r.height)!==null&&n!==void 0?n:"auto"})},t.prototype.renderResizer=function(){var r=this,a=this.props,n=a.enable,l=a.handleStyles,o=a.handleClasses,u=a.handleWrapperStyle,h=a.handleWrapperClass,x=a.handleComponent;if(!n)return null;var m=Object.keys(n).map(function(g){return n[g]!==!1?f.jsx(oU,{direction:g,onResizeStart:r.onResizeStart,replaceStyles:l&&l[g],className:o&&o[g],children:x&&x[g]?x[g]:null},g):null});return f.jsx("div",{className:h,style:u,children:m})},t.prototype.render=function(){var r=this,a=Object.keys(this.props).reduce(function(o,u){return xU.indexOf(u)!==-1||(o[u]=r.props[u]),o},{}),n=rs(rs(rs({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var l=this.props.as||"div";return f.jsxs(l,rs({style:n,className:this.props.className},a,{ref:function(o){o&&(r.resizable=o)},children:[this.state.isResizing&&f.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(C.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ap=function(e,t){return Ap=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)a.hasOwnProperty(n)&&(r[n]=a[n])},Ap(e,t)};function pU(e,t){Ap(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Pr=function(){return Pr=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Pr.apply(this,arguments)};function gU(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}var vU={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},yU=function(e){return{bottom:e,bottomLeft:e,bottomRight:e,left:e,right:e,top:e,topLeft:e,topRight:e}},bU=function(e){pU(t,e);function t(r){var a=e.call(this,r)||this;return a.resizingPosition={x:0,y:0},a.offsetFromParent={left:0,top:0},a.resizableElement={current:null},a.originalPosition={x:0,y:0},a.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:r.maxWidth,maxHeight:r.maxHeight},a.onResizeStart=a.onResizeStart.bind(a),a.onResize=a.onResize.bind(a),a.onResizeStop=a.onResizeStop.bind(a),a.onDragStart=a.onDragStart.bind(a),a.onDrag=a.onDrag.bind(a),a.onDragStop=a.onDragStop.bind(a),a.getMaxSizesFromProps=a.getMaxSizesFromProps.bind(a),a}return t.prototype.componentDidMount=function(){this.updateOffsetFromParent();var r=this.offsetFromParent,a=r.left,n=r.top,l=this.getDraggablePosition(),o=l.x,u=l.y;this.draggable.setState({x:o-a,y:u-n}),this.forceUpdate()},t.prototype.getDraggablePosition=function(){var r=this.draggable.state,a=r.x,n=r.y;return{x:a,y:n}},t.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},t.prototype.getParentSize=function(){return this.resizable.getParentSize()},t.prototype.getMaxSizesFromProps=function(){var r=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,a=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:r,maxHeight:a}},t.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},t.prototype.getOffsetHeight=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/a;case"body":return document.body.offsetHeight/a;default:return r.offsetHeight}},t.prototype.getOffsetWidth=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/a;case"body":return document.body.offsetWidth/a;default:return r.offsetWidth}},t.prototype.onDragStart=function(r,a){this.props.onDragStart&&this.props.onDragStart(r,a);var n=this.getDraggablePosition();if(this.originalPosition=n,!!this.props.bounds){var l=this.getParent(),o=this.props.scale,u;if(this.props.bounds==="parent")u=l;else if(this.props.bounds==="body"){var h=l.getBoundingClientRect(),x=h.left,m=h.top,g=document.body.getBoundingClientRect(),v=-(x-l.offsetLeft*o-g.left)/o,b=-(m-l.offsetTop*o-g.top)/o,y=(document.body.offsetWidth-this.resizable.size.width*o)/o+v,w=(document.body.offsetHeight-this.resizable.size.height*o)/o+b;return this.setState({bounds:{top:b,right:y,bottom:w,left:v}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var E=l.getBoundingClientRect(),k=E.left,N=E.top,_=-(k-l.offsetLeft*o)/o,R=-(N-l.offsetTop*o)/o,y=(window.innerWidth-this.resizable.size.width*o)/o+_,w=(window.innerHeight-this.resizable.size.height*o)/o+R;return this.setState({bounds:{top:R,right:y,bottom:w,left:_}})}else typeof this.props.bounds=="string"?u=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(u=this.props.bounds);if(!(!(u instanceof HTMLElement)||!(l instanceof HTMLElement))){var A=u.getBoundingClientRect(),D=A.left,T=A.top,F=l.getBoundingClientRect(),O=F.left,U=F.top,q=(D-O)/o,z=T-U;if(this.resizable){this.updateOffsetFromParent();var te=this.offsetFromParent;this.setState({bounds:{top:z-te.top,right:q+(u.offsetWidth-this.resizable.size.width)-te.left/o,bottom:z+(u.offsetHeight-this.resizable.size.height)-te.top,left:q-te.left/o}})}}}},t.prototype.onDrag=function(r,a){if(this.props.onDrag){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(r,Pr(Pr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(r,Pr(Pr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(r,Pr(Pr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onDragStop=function(r,a){if(this.props.onDragStop){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(r,Pr(Pr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(r,Pr(Pr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(r,Pr(Pr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onResizeStart=function(r,a,n){r.stopPropagation(),this.setState({resizing:!0});var l=this.props.scale,o=this.offsetFromParent,u=this.getDraggablePosition();if(this.resizingPosition={x:u.x+o.left,y:u.y+o.top},this.originalPosition=u,this.props.bounds){var h=this.getParent(),x=void 0;this.props.bounds==="parent"?x=h:this.props.bounds==="body"?x=document.body:this.props.bounds==="window"?x=window:typeof this.props.bounds=="string"?x=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(x=this.props.bounds);var m=this.getSelfElement();if(m instanceof Element&&(x instanceof HTMLElement||x===window)&&h instanceof HTMLElement){var g=this.getMaxSizesFromProps(),v=g.maxWidth,b=g.maxHeight,y=this.getParentSize();if(v&&typeof v=="string")if(v.endsWith("%")){var w=Number(v.replace("%",""))/100;v=y.width*w}else v.endsWith("px")&&(v=Number(v.replace("px","")));if(b&&typeof b=="string")if(b.endsWith("%")){var w=Number(b.replace("%",""))/100;b=y.height*w}else b.endsWith("px")&&(b=Number(b.replace("px","")));var E=m.getBoundingClientRect(),k=E.left,N=E.top,_=this.props.bounds==="window"?{left:0,top:0}:x.getBoundingClientRect(),R=_.left,A=_.top,D=this.getOffsetWidth(x),T=this.getOffsetHeight(x),F=a.toLowerCase().endsWith("left"),O=a.toLowerCase().endsWith("right"),U=a.startsWith("top"),q=a.startsWith("bottom");if((F||U)&&this.resizable){var z=(k-R)/l+this.resizable.size.width;this.setState({maxWidth:z>Number(v)?v:z})}if(O||this.props.lockAspectRatio&&!F&&!U){var z=D+(R-k)/l;this.setState({maxWidth:z>Number(v)?v:z})}if((U||F)&&this.resizable){var z=(N-A)/l+this.resizable.size.height;this.setState({maxHeight:z>Number(b)?b:z})}if(q||this.props.lockAspectRatio&&!U&&!F){var z=T+(A-N)/l;this.setState({maxHeight:z>Number(b)?b:z})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(r,a,n)},t.prototype.onResize=function(r,a,n,l){var o=this,u={x:this.originalPosition.x,y:this.originalPosition.y},h=-l.width,x=-l.height,m=["top","left","topLeft","bottomLeft","topRight"];m.includes(a)&&(a==="bottomLeft"?u.x+=h:(a==="topRight"||(u.x+=h),u.y+=x));var g=this.draggable.state;(u.x!==g.x||u.y!==g.y)&&bS.flushSync(function(){o.draggable.setState(u)}),this.updateOffsetFromParent();var v=this.offsetFromParent,b=this.getDraggablePosition().x+v.left,y=this.getDraggablePosition().y+v.top;this.resizingPosition={x:b,y},this.props.onResize&&this.props.onResize(r,a,n,l,{x:b,y})},t.prototype.onResizeStop=function(r,a,n,l){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),u=o.maxWidth,h=o.maxHeight;this.setState({maxWidth:u,maxHeight:h}),this.props.onResizeStop&&this.props.onResizeStop(r,a,n,l,this.resizingPosition)},t.prototype.updateSize=function(r){this.resizable&&this.resizable.updateSize({width:r.width,height:r.height})},t.prototype.updatePosition=function(r){this.draggable.setState(r)},t.prototype.updateOffsetFromParent=function(){var r=this.props.scale,a=this.getParent(),n=this.getSelfElement();if(!a||n===null)return{top:0,left:0};var l=a.getBoundingClientRect(),o=l.left,u=l.top,h=n.getBoundingClientRect(),x=this.getDraggablePosition(),m=a.scrollLeft,g=a.scrollTop;this.offsetFromParent={left:h.left-o+m-x.x*r,top:h.top-u+g-x.y*r}},t.prototype.render=function(){var r=this,a=this.props,n=a.disableDragging,l=a.style,o=a.dragHandleClassName,u=a.position,h=a.onMouseDown,x=a.onMouseUp,m=a.dragAxis,g=a.dragGrid,v=a.bounds,b=a.enableUserSelectHack,y=a.cancel,w=a.children;a.onResizeStart,a.onResize,a.onResizeStop,a.onDragStart,a.onDrag,a.onDragStop;var E=a.resizeHandleStyles,k=a.resizeHandleClasses,N=a.resizeHandleComponent,_=a.enableResizing,R=a.resizeGrid,A=a.resizeHandleWrapperClass,D=a.resizeHandleWrapperStyle,T=a.scale,F=a.allowAnyClick,O=a.dragPositionOffset,U=gU(a,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),q=this.props.default?Pr({},this.props.default):void 0;delete U.default;var z=n||o?{cursor:"auto"}:{cursor:"move"},te=Pr(Pr(Pr({},vU),z),l),ce=this.offsetFromParent,de=ce.left,ee=ce.top,ie;u&&(ie={x:u.x-de,y:u.y-ee});var Te=this.state.resizing?void 0:ie,ne=this.state.resizing?"both":m;return C.createElement(iU,{ref:function(B){B&&(r.draggable=B)},handle:o?".".concat(o):void 0,defaultPosition:q,onMouseDown:h,onMouseUp:x,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:ne,disabled:n,grid:g,bounds:v?this.state.bounds:void 0,position:Te,enableUserSelectHack:b,cancel:y,scale:T,allowAnyClick:F,nodeRef:this.resizableElement,positionOffset:O},C.createElement(mU,Pr({},U,{ref:function(B){B&&(r.resizable=B,r.resizableElement.current=B.resizable)},defaultSize:q,size:this.props.size,enable:typeof _=="boolean"?yU(_):_,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:te,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:R,handleWrapperClass:A,handleWrapperStyle:D,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:E,handleClasses:k,handleComponent:N,scale:this.props.scale}),w))},t.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},t}(C.PureComponent);function wU(){const{tableId:e}=Gn(),{eventId:t}=$r(),{data:r,isLoading:a,error:n}=yu(e),l=$P(e,t),[o,u]=C.useState(()=>{var m;return((m=r==null?void 0:r.layout)==null?void 0:m.reduce((g,v)=>({...g,[v.guestId]:{x:v.x,y:v.y}}),{}))??{}});if(a)return f.jsx("p",{children:"Loading layout"});if(n||!r)return f.jsx("p",{children:"Error loading layout."});const h=(m,g)=>{u(v=>({...v,[m]:{x:g.x,y:g.y}}))},x=()=>{const m=Object.entries(o).map(([g,v])=>({guestId:g,x:v.x,y:v.y}));l.mutate({layout:m})};return f.jsxs("div",{className:"relative h-[500px] border bg-gray-50",children:[r.guests.map(m=>{const g=o[m.id]??{x:20,y:20};return f.jsx(bU,{size:{width:80,height:30},position:g,bounds:"parent",onDragStop:(v,b)=>h(m.id,b),children:f.jsx("div",{className:"p-1 bg-white dark:bg-gray-800 border rounded text-sm",children:m.guestName})},m.id)}),f.jsx("button",{onClick:x,className:"absolute bottom-4 right-4 bg-button text-white px-4 py-2 rounded",children:"Save Layout"})]})}function SU(){const{tableId:e}=Gn(),{data:t,isLoading:r,error:a}=yu(e);return r?f.jsx("p",{children:"Loading print"}):a||!t?f.jsx("p",{children:"Error loading print view."}):f.jsxs("div",{className:"p-4 print:p-0",children:[f.jsxs("h1",{className:"text-2xl font-semibold mb-4",children:["Seating Plan: ",t.name]}),f.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.guests.map(n=>f.jsx("div",{className:"border p-2 flex flex-col items-center print:border-gray-800",children:n.guestName},n.id))})]})}function EU(){const{tableId:e}=Gn(),{data:t,isLoading:r,error:a}=yu(e);return r?f.jsx("p",{children:"Loading"}):a||!t?f.jsx("p",{children:"Failed to load table."}):f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Guests at ",t.name," (",t.assignedCount,"/",t.capacity,")"]}),f.jsx("ul",{className:"space-y-2",children:t.guests.map(n=>f.jsxs("li",{className:"p-3 bg-white dark:bg-gray-800 rounded shadow",children:[f.jsx("p",{className:"font-medium",children:n.guestName}),f.jsxs("p",{className:"text-sm",children:["Status: ",n.status]}),f.jsxs("p",{className:"text-sm",children:["Type: ",n.guestType]})]},n.id))})]})}const O_="floorplan-";function qw(e){try{const t=localStorage.getItem(O_+e);return t?JSON.parse(t):[]}catch{return[]}}function _U(e,t){localStorage.setItem(O_+e,JSON.stringify(t))}function kU(e){const[t,r]=C.useState(()=>qw(e)),a=C.useRef(!1);C.useEffect(()=>{r(qw(e)),a.current=!1},[e]),C.useEffect(()=>{if(!a.current){a.current=!0;return}_U(e,t)},[e,t]);const n=C.useCallback(g=>{r(v=>[...v,g])},[]),l=C.useCallback((g,v)=>{r(b=>b.map(y=>y.id===g?{...y,...v}:y))},[]),o=C.useCallback(g=>{r(v=>v.filter(b=>b.id!==g))},[]),u=C.useCallback((g,v=3)=>{r(b=>{const y=b.filter(O=>O.type!=="table"),w=b.filter(O=>O.type==="table"),E=w.filter(O=>g.includes(O.id)),k=Math.max(...E.map(O=>O.width),100),N=Math.max(...E.map(O=>O.height),100),_=k+80,R=N+80,A=60,D=60,T=E.map((O,U)=>({...O,x:A+U%v*_,y:D+Math.floor(U/v)*R})),F=w.filter(O=>!g.includes(O.id));return[...y,...T,...F]})},[]),h=C.useCallback((g,v)=>{if(v==="rect")return{width:Math.max(160,60+g*14),height:70};if(v==="square"){const y=Math.max(90,50+Math.ceil(g/4)*20);return{width:y,height:y}}const b=Math.max(100,60+g*6);return{width:b,height:b}},[]),x=C.useCallback(g=>{r(v=>{let b=!1;const y=new Map(g.map(U=>[U.id,U.capacity])),w=v.map(U=>{if(U.type==="table"&&(!U.meta||!U.meta.shape)){b=!0;const q=y.get(U.id)??8,z=h(q,"round");return{...U,...z,meta:{...U.meta,shape:"round",capacity:q}}}return U}),E=new Set(w.filter(U=>U.type==="table").map(U=>U.id)),k=g.filter(U=>!E.has(U.id));if(k.length===0)return b?w:v;const N=3,_=260,R=240,A=60,D=60,F=w.filter(U=>U.type==="table").length,O=k.map((U,q)=>{const z=h(U.capacity,"round");return{id:U.id,type:"table",x:A+(F+q)%N*_,y:D+Math.floor((F+q)/N)*R,...z,meta:{shape:"round",capacity:U.capacity}}});return[...w,...O]})},[h]),m=C.useCallback((g,v)=>{r(b=>b.map(y=>{var k;if(y.id!==g||y.type!=="table")return y;const w=((k=y.meta)==null?void 0:k.capacity)??8,E=h(w,v);return{...y,...E,meta:{...y.meta,shape:v}}}))},[h]);return{floorItems:t,setFloorItems:r,addItem:n,updateItem:l,removeItem:o,autoArrange:u,syncTables:x,changeTableShape:m}}function Ww(e,t,r){return r?Math.round(e/t)*t:e}const jp=26,On=jp/2,d0=6;function TU(e,t,r,a){const n=[];if(e==="round"){const l=r/2,o=a/2,u=Math.max(r,a)/2+d0+On;for(let h=0;h<t;h++){const x=2*Math.PI*h/t-Math.PI/2;n.push({x:l+Math.cos(x)*u-On,y:o+Math.sin(x)*u-On})}}else if(e==="rect"){const l=t>=6?1:0,o=t-l*2,u=Math.ceil(o/2),h=o-u;let x=0;for(let m=0;m<u&&x<t;m++,x++)n.push({x:r/(u+1)*(m+1)-On,y:-32});for(let m=0;m<l&&x<t;m++,x++)n.push({x:r+d0,y:a/2-On});for(let m=0;m<h&&x<t;m++,x++)n.push({x:r/(h+1)*(m+1)-On,y:a+d0});for(let m=0;m<l&&x<t;m++,x++)n.push({x:-32,y:a/2-On})}else{const l=Math.ceil(t/4);let o=0;for(let u=0;u<l&&o<t;u++,o++){const h=(u+1)/(l+1);n.push({x:h*r-On,y:-32})}for(let u=0;u<l&&o<t;u++,o++){const h=(u+1)/(l+1);n.push({x:r+d0,y:h*a-On})}for(let u=0;u<l&&o<t;u++,o++){const h=(l-u)/(l+1);n.push({x:h*r-On,y:a+d0})}for(let u=0;u<l&&o<t;u++,o++){const h=(l-u)/(l+1);n.push({x:-32,y:h*a-On})}}return n}const Xw=["linear-gradient(135deg, #7c3aed, #a855f7)","linear-gradient(135deg, #ec4899, #f43f5e)","linear-gradient(135deg, #3b82f6, #2563eb)","linear-gradient(135deg, #22c55e, #16a34a)","linear-gradient(135deg, #f97316, #ea580c)","linear-gradient(135deg, #8b5cf6, #6366f1)","linear-gradient(135deg, #06b6d4, #0891b2)","linear-gradient(135deg, #eab308, #ca8a04)"];function NU(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return Xw[Math.abs(t)%Xw.length]}const CU=({item:e,table:t,assignedGuests:r,zoom:a,selected:n,snapEnabled:l,snapSize:o,onSelect:u,onMove:h,onDoubleClick:x,onDropGuest:m,onSeatClick:g})=>{var U;const v=C.useRef(!1),b=C.useRef({x:0,y:0}),y=C.useRef(!1),w=C.useCallback(q=>{if(q.button!==0)return;q.stopPropagation(),u(e.id),v.current=!0,y.current=!1,b.current={x:(q.clientX-q.currentTarget.getBoundingClientRect().left)/a,y:(q.clientY-q.currentTarget.getBoundingClientRect().top)/a};const z=ce=>{if(!v.current)return;y.current=!0;const de=document.getElementById("floor-canvas-content");if(!de)return;const ee=de.getBoundingClientRect(),ie=(ce.clientX-ee.left)/a-b.current.x,Te=(ce.clientY-ee.top)/a-b.current.y;h(e.id,Ww(ie,o,l),Ww(Te,o,l))},te=()=>{v.current=!1,window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",te)};window.addEventListener("mousemove",z),window.addEventListener("mouseup",te)},[e.id,a,l,o,u,h]),E=C.useCallback(q=>{q.stopPropagation(),y.current||x(e.id)},[e.id,x]),k=C.useCallback(q=>{q.preventDefault(),q.dataTransfer.dropEffect="move"},[]),N=C.useCallback(q=>{q.preventDefault();const z=q.dataTransfer.getData("guestId");z&&t&&m(t.id,z)},[t,m]);if(!t)return null;const _=t.capacity||8,R=r.length,A=((U=e.meta)==null?void 0:U.shape)||"round",D=NU(e.id),F=A==="round"?"50%":A==="rect"?12:8,O=TU(A,_,e.width,e.height);return f.jsxs("div",{style:{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",zIndex:n?100:10,transition:"box-shadow 0.2s, transform 0.1s"},onMouseDown:w,onDoubleClick:E,onDragOver:k,onDrop:N,children:[O.map((q,z)=>{var ee;const te=r[z],ce=!!te,de=(te==null?void 0:te.flag)==="VIP";return f.jsx("div",{title:ce?`${te.name}  click to unassign`:`Seat ${z+1}  click to assign`,onClick:ie=>{ie.stopPropagation();const Te=ie.currentTarget.getBoundingClientRect();g(e.id,z,ce?te.id:null,Te.left+Te.width/2,Te.top)},style:{position:"absolute",left:q.x,top:q.y,width:jp,height:jp,borderRadius:"50%",border:ce?de?"2px solid #a855f7":"2px solid #22c55e":"2px dashed #cbd5e1",background:ce?de?"linear-gradient(135deg, #a855f7, #7c3aed)":"linear-gradient(135deg, #22c55e, #16a34a)":"white",color:ce?"white":"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,cursor:"pointer",transition:"all 0.2s",zIndex:2},children:ce?((ee=te.name)==null?void 0:ee[0])??"G":z+1},z)}),f.jsxs("div",{style:{width:"100%",height:"100%",background:D,borderRadius:F,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",outline:n?"3px solid #4f46e5":"none",outlineOffset:n?4:void 0,boxShadow:n?"0 20px 40px rgba(79, 70, 229, 0.25)":void 0},children:[f.jsx("span",{style:{color:"white",fontSize:18},children:R>=_?"":""}),f.jsx("span",{style:{color:"white",fontSize:10,fontWeight:600},children:t.name}),f.jsxs("span",{style:{color:"rgba(255,255,255,0.7)",fontSize:9},children:[R,"/",_]})]}),n&&f.jsx("div",{style:{position:"absolute",bottom:-6,right:-6,width:12,height:12,background:"white",border:"2px solid #4f46e5",borderRadius:"50%",cursor:"nwse-resize"}})]})},AU=({item:e,zoom:t,selected:r,onSelect:a,onMove:n})=>{const l=C.useRef(!1),o=C.useRef({x:0,y:0}),u=C.useCallback(y=>{if(y.button!==0)return;y.stopPropagation(),a(e.id),l.current=!0,o.current={x:(y.clientX-y.currentTarget.getBoundingClientRect().left)/t,y:(y.clientY-y.currentTarget.getBoundingClientRect().top)/t};const w=k=>{if(!l.current)return;const N=document.getElementById("floor-canvas-content");if(!N)return;const _=N.getBoundingClientRect(),R=(k.clientX-_.left)/t-o.current.x,A=(k.clientY-_.top)/t-o.current.y;n(e.id,R,A)},E=()=>{l.current=!1,window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",E)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",E)},[e.id,t,a,n]),h=e.type==="stage",x=e.type==="danceFloor",m=e.type==="pillar";let g="",v={position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:500,fontSize:10,zIndex:5,transition:"box-shadow 0.2s"};h?v={...v,background:"linear-gradient(135deg, #4f46e5, #7c3aed)",color:"white",fontWeight:600,letterSpacing:2,textTransform:"uppercase",fontSize:12,borderRadius:"4px 4px 40px 40px"}:x?v={...v,background:"repeating-conic-gradient(from 0deg, #f8fafc 0deg 90deg, #e0e7ff 90deg 180deg)",backgroundSize:"40px 40px",border:"3px solid #e2e8f0",borderRadius:8,color:"#64748b",fontSize:11}:m?v={...v,background:"radial-gradient(circle at 30% 30%, #78716c, #57534e)",border:"3px solid #44403c",borderRadius:"50%",boxShadow:"inset 0 -3px 8px rgba(0,0,0,0.3)",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"}:v={...v,background:"repeating-linear-gradient(45deg, #64748b, #64748b 10px, #475569 10px, #475569 20px)",border:"2px solid #334155",borderRadius:4,color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},r&&(v.outline="3px solid #ef4444",v.outlineOffset=3);const b=h?" Stage":x?" Dance Floor":m?"":" Wall";return f.jsx("div",{className:g,style:v,onMouseDown:u,onClick:y=>{y.stopPropagation(),a(e.id)},children:e.type==="wall"&&e.height>e.width?f.jsx("span",{style:{transform:"rotate(90deg)",whiteSpace:"nowrap"},children:b}):b})},jU=({floorItems:e,tables:t,guests:r,zoom:a,panX:n,panY:l,selectedId:o,snapEnabled:u,snapSize:h,toolMode:x,onZoomChange:m,onPanChange:g,onSelect:v,onMoveItem:b,onDoubleClickTable:y,onDropGuest:w,onDeleteSelected:E,onCanvasClick:k,onSeatClick:N})=>{var Te,ne;const _=C.useRef(null),R=C.useRef(!1),A=C.useRef({x:0,y:0,px:0,py:0}),[D,T]=C.useState(!0);C.useEffect(()=>{const B=_.current;if(!B)return;const Z=L=>{L.preventDefault();const G=L.deltaY>0?-.1:.1;m(Math.min(2,Math.max(.3,a+G)))};return B.addEventListener("wheel",Z,{passive:!1}),()=>B.removeEventListener("wheel",Z)},[a,m]);const F=C.useCallback(B=>{var L;if(!B.target.closest("[data-floor-item]")){if(x!=="select"){const G=(L=_.current)==null?void 0:L.getBoundingClientRect();if(G){const V=(B.clientX-G.left-n)/a,Q=(B.clientY-G.top-l)/a,le=u?Math.round(V/h)*h:V,_e=u?Math.round(Q/h)*h:Q;k(le,_e)}return}v(null),R.current=!0,A.current={x:B.clientX,y:B.clientY,px:n,py:l}}},[n,l,a,u,h,x,v,k]),O=C.useCallback(B=>{if(!R.current)return;const Z=B.clientX-A.current.x,L=B.clientY-A.current.y;g(A.current.px+Z,A.current.py+L)},[g]),U=C.useCallback(()=>{R.current=!1},[]),q=C.useCallback(B=>{(B.key==="Delete"||B.key==="Backspace")&&E(),B.key==="Escape"&&v(null)},[E,v]),z=new Map(t.map(B=>[B.id,B])),te=180,ce=120,de=2e3,ee=1400,ie=te/de;return f.jsxs("div",{ref:_,className:"floor-canvas flex-1 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 shadow-lg bg-white dark:bg-slate-900 relative",style:{background:`
          linear-gradient(90deg, rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(to bottom right, #f8fafc, #f1f5f9)`,backgroundSize:"40px 40px, 40px 40px, 100% 100%",cursor:x!=="select"?"crosshair":R.current?"grabbing":"grab",minHeight:400},tabIndex:0,onMouseDown:F,onMouseMove:O,onMouseUp:U,onMouseLeave:U,onKeyDown:q,children:[f.jsx("div",{id:"floor-canvas-content",style:{transform:`translate(${n}px, ${l}px) scale(${a})`,transformOrigin:"0 0",width:de,height:ee,position:"absolute",top:0,left:0},children:e.map(B=>{if(B.type==="table"){const Z=z.get(B.id),L=r.filter(G=>G.tableId===B.id);return f.jsx("div",{"data-floor-item":!0,children:f.jsx(CU,{item:B,table:Z,assignedGuests:L,zoom:a,selected:o===B.id,snapEnabled:u,snapSize:h,onSelect:v,onMove:b,onDoubleClick:y,onDropGuest:w,onSeatClick:N})},B.id)}return f.jsx("div",{"data-floor-item":!0,children:f.jsx(AU,{item:B,zoom:a,selected:o===B.id,onSelect:v,onMove:b})},B.id)})}),D&&f.jsxs("div",{className:"absolute top-4 left-4 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-slate-800 dark:to-slate-800 border border-indigo-100 dark:border-indigo-900 rounded-xl p-4 shadow-lg max-w-xs z-20",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-lg",children:""}),f.jsx("button",{className:"text-gray-400 hover:text-gray-600 text-sm",onClick:()=>T(!1),children:""})]}),f.jsx("p",{className:"text-sm text-indigo-700 dark:text-indigo-300 font-medium mb-1",children:"Drag & Drop Layout"}),f.jsxs("ul",{className:"text-xs text-indigo-600/80 dark:text-indigo-400/80 space-y-0.5",children:[f.jsx("li",{children:" Drag tables to reposition"}),f.jsx("li",{children:" Double-click table to edit"}),f.jsx("li",{children:" Drag guests to empty seats"}),f.jsx("li",{children:" Add obstacles (pillars/walls)"}),f.jsxs("li",{children:[" Press ",f.jsx("kbd",{className:"px-1 py-0.5 bg-white dark:bg-slate-700 rounded text-[10px]",children:"Delete"})," to remove selected"]}),f.jsx("li",{children:" Scroll to zoom in/out"})]})]}),f.jsxs("div",{className:"absolute bottom-5 right-5 bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden shadow-lg z-20",style:{width:te,height:ce+22},children:[f.jsx("div",{className:"p-1 text-[8px] text-gray-400 uppercase tracking-wider border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-slate-900",children:"Overview"}),f.jsxs("div",{className:"relative",style:{height:ce},children:[e.map(B=>{const Z=B.type==="table",L=Z?"#7c3aed":B.type==="stage"?"#4f46e5":B.type==="danceFloor"?"#c7d2fe":"#64748b";return f.jsx("div",{style:{position:"absolute",left:B.x*ie,top:B.y*ie,width:Math.max(4,B.width*ie),height:Math.max(4,B.height*ie),background:L,borderRadius:Z||B.type==="pillar"?"50%":2}},B.id)}),f.jsx("div",{style:{position:"absolute",border:"2px solid #4f46e5",background:"rgba(79, 70, 229, 0.1)",pointerEvents:"none",left:Math.max(0,-n/a)*ie,top:Math.max(0,-l/a)*ie,width:(((Te=_.current)==null?void 0:Te.clientWidth)??800)/a*ie,height:(((ne=_.current)==null?void 0:ne.clientHeight)??500)/a*ie}})]})]})]})},Yw=({guests:e,tables:t})=>{const[r,a]=C.useState(""),[n,l]=C.useState(null),o=C.useMemo(()=>e.filter(m=>!m.tableId),[e]),u=C.useMemo(()=>e.filter(m=>!!m.tableId),[e]),h=C.useMemo(()=>{if(!r)return o;const m=r.toLowerCase();return o.filter(g=>{var v;return g.name.toLowerCase().includes(m)||((v=g.phoneNo)==null?void 0:v.toLowerCase().includes(m))})},[o,r]),x=C.useMemo(()=>new Map(t.map(m=>[m.id,m.name])),[t]);return f.jsxs("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-slate-900 rounded-xl shadow border border-gray-100 dark:border-gray-700 flex flex-col overflow-hidden",children:[f.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between bg-gradient-to-r from-gray-50 to-white dark:from-slate-800 dark:to-slate-900",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-lg",children:""}),f.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white",children:"Guests"})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400",children:[u.length," seated"]}),f.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400",children:[o.length," pending"]})]})]}),f.jsx("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700",children:f.jsx("input",{type:"text",placeholder:"Search guests...",value:r,onChange:m=>a(m.target.value),className:"w-full border border-gray-200 dark:border-gray-600 rounded-lg p-2 text-sm bg-white dark:bg-slate-800 text-slate-800 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",style:{scrollbarWidth:"thin"},children:[f.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-yellow-600 dark:text-yellow-400 font-semibold flex items-center gap-1 mb-2",children:[" Unassigned (",o.length,")"]}),h.length===0?f.jsx("div",{className:"text-center py-6",children:f.jsx("p",{className:"text-sm text-slate-400",children:r?"No matches found":"All guests are assigned!"})}):h.map(m=>f.jsxs("div",{draggable:!0,onDragStart:g=>{g.dataTransfer.effectAllowed="move",g.dataTransfer.setData("guestId",m.id),l(m.id)},onDragEnd:()=>l(null),className:`p-3 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-slate-800 cursor-grab hover:border-primary hover:bg-indigo-50 dark:hover:bg-primary/10 transition-all ${n===m.id?"opacity-50":""}`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),(m.pax??1)>0&&f.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400",children:[m.pax??1," pax"]})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[m.phoneNo&&f.jsxs("span",{children:[" ",m.phoneNo]}),m.flag==="VIP"&&f.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]})]},m.id)),u.length>0&&f.jsxs(f.Fragment,{children:[f.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-green-600 dark:text-green-400 font-semibold flex items-center gap-1 mt-4 mb-2",children:[" Assigned (",u.length,")"]}),u.slice(0,5).map(m=>f.jsx("div",{className:"p-3 rounded-lg border border-green-200 dark:border-green-800 bg-green-50/50 dark:bg-green-900/20",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),f.jsxs("p",{className:"text-[10px] text-green-600 dark:text-green-400",children:[x.get(m.tableId??"")??"Table","  Seat ",m.seatIndex??"?"]})]}),f.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:[m.pax??1," pax"]})]})},m.id)),u.length>5&&f.jsxs("p",{className:"text-center text-xs text-gray-400 py-2",children:["+ ",u.length-5," more assigned..."]})]})]})]})};let RU=0;function DU(){return`fp-${Date.now()}-${++RU}`}function FU(){const{eventId:e}=$r(),{data:t=[],isLoading:r}=Jd(e??""),{data:a=[],isLoading:n}=Zd(e??""),l=Ig(e??""),o=Ug(e??""),{floorItems:u,addItem:h,updateItem:x,removeItem:m,autoArrange:g,syncTables:v,changeTableShape:b}=kU(e??""),[y,w]=C.useState(1),[E,k]=C.useState(0),[N,_]=C.useState(0),[R,A]=C.useState(null),[D,T]=C.useState(!0),[F,O]=C.useState("select"),[U,q]=C.useState(!1),[z,te]=C.useState(null),[ce,de]=C.useState(null),[ee,ie]=C.useState(!1),[Te,ne]=C.useState(null),B=40;C.useEffect(()=>{t.length>0&&v(t.map(Pe=>({id:Pe.id,capacity:Pe.capacity||8})))},[t,v]),C.useEffect(()=>{if(!ce)return;const Pe=setTimeout(()=>de(null),2500);return()=>clearTimeout(Pe)},[ce]);const Z=C.useCallback((Pe,pt="")=>{de({message:Pe,icon:pt})},[]),L=C.useCallback((Pe,pt)=>{k(Pe),_(pt)},[]),G=C.useCallback((Pe,pt,dr)=>{x(Pe,{x:pt,y:dr})},[x]),V=C.useCallback(Pe=>{A(Pe)},[]),Q=C.useCallback(()=>{if(!R)return;const Pe=u.find(pt=>pt.id===R);if(Pe){if(Pe.type==="table"){Z("Cannot delete table from floor plan","");return}m(R),A(null),Z("Element removed","")}},[R,u,m,Z]),le=C.useCallback(Pe=>{te(Pe),q(!0)},[]),_e=C.useCallback(Pe=>{if(Pe==="select"){O("select");return}if(R){const pt=u.find(dr=>dr.id===R);if((pt==null?void 0:pt.type)==="table"){b(R,Pe),Z(`Table shape changed to ${Pe}`,"");return}}O(Pe),Z(`Click on canvas to place ${Pe} table`,"")},[R,u,b,Z]),Ee=C.useCallback((Pe,pt,dr,yr,lr)=>{dr?o.mutate(dr,{onSuccess:()=>Z("Guest unassigned",""),onError:()=>Z("Failed to unassign guest","")}):ne({tableId:Pe,seatIndex:pt,guestId:null,anchorX:yr,anchorY:lr})},[o,Z]),Ne=C.useCallback(Pe=>{Te&&(l.mutate({guestId:Pe,tableId:Te.tableId},{onSuccess:()=>Z("Guest assigned!",""),onError:()=>Z("Failed to assign guest","")}),ne(null))},[Te,l,Z]),Re=C.useCallback((Pe,pt)=>{l.mutate({guestId:pt,tableId:Pe},{onSuccess:()=>Z("Guest assigned!",""),onError:()=>Z("Failed to assign guest","")})},[l,Z]),Ze=C.useCallback(()=>{g(t.map(Pe=>Pe.id)),Z("Tables auto-arranged","")},[g,t,Z]),K=C.useCallback(Pe=>{const pt={stage:{w:280,h:50},danceFloor:{w:180,h:160},pillar:{w:45,h:45},wall:{w:80,h:40}},dr={stage:"",danceFloor:"",pillar:"",wall:""},yr=pt[Pe]??{w:100,h:100};h({id:DU(),type:Pe,x:200+Math.random()*200,y:100+Math.random()*200,width:yr.w,height:yr.h}),Z(`${Pe==="danceFloor"?"Dance floor":Pe.charAt(0).toUpperCase()+Pe.slice(1)} added!`,dr[Pe]??"")},[h,Z]),Ae=Oi.useRef(null),lt=C.useCallback((Pe,pt)=>{F!=="select"&&(Ae.current={x:Pe,y:pt,shape:F},te(null),q(!0))},[F]),kt=Oi.useRef(null),ot=C.useCallback(()=>{q(!1),te(null),Ae.current&&(kt.current=Ae.current.shape,Ae.current=null,O("select"))},[]),Oe=C.useCallback(()=>{Z("Layout saved!","")},[Z]),Wt=C.useCallback(()=>{w(1),k(0),_(0),Z("View reset","")},[Z]),fr=C.useMemo(()=>a.filter(Pe=>!Pe.tableId).length,[a]),Kr=a.length-fr,Hr=t.reduce((Pe,pt)=>Pe+(pt.capacity||0),0),Ca=z?t.find(Pe=>Pe.id===z):void 0;return e?f.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 px-6 pt-4 pb-2",children:[f.jsx(wn,{label:"Total Tables",value:t.length,variant:"primary"}),f.jsx(wn,{label:"Seated Guests",value:Kr,variant:"success"}),f.jsx(wn,{label:"Unassigned",value:fr,variant:"warning"}),f.jsx(wn,{label:"Total Capacity",value:Hr,variant:"secondary"})]}),f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center px-6 py-2 gap-2",children:[f.jsx("h2",{className:"text-2xl font-semibold text-primary dark:text-white",children:"Floor Plan Layout"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs(Fe,{variant:"secondary",onClick:()=>window.print(),children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4 sm:mr-2",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})}),f.jsx("span",{className:"hidden sm:inline",children:"Print Layout"})]}),f.jsxs("button",{onClick:Ze,className:"px-4 py-2 rounded-xl font-semibold inline-flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-offset-2 bg-green-500 text-white shadow-lg shadow-green-500/25 hover:brightness-105 active:translate-y-[1px] focus:ring-green-500/40",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4 sm:mr-2",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})}),f.jsx("span",{className:"hidden sm:inline",children:"Auto-Arrange"})]}),f.jsx(Fe,{variant:"primary",onClick:()=>{te(null),q(!0)},children:"+ New Table"}),f.jsx(Fe,{variant:"secondary",onClick:Oe,children:" Save Layout"})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center px-6 py-2 gap-2",children:[f.jsxs("div",{className:"flex items-center gap-2 bg-white dark:bg-slate-800 rounded-xl p-1.5 border border-gray-200 dark:border-gray-700 shadow-sm overflow-x-auto",children:[f.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 px-2",children:"Tables:"}),f.jsxs("button",{onClick:()=>_e("round"),className:`tool-btn p-2 rounded-lg border flex items-center gap-2 transition-all ${F==="round"?"bg-gradient-to-r from-primary to-secondary text-white border-transparent":"border-gray-200 dark:border-gray-600 hover:bg-indigo-50 dark:hover:bg-slate-700"}`,title:"Round Table (or change selected table)",children:[f.jsx("div",{className:`w-5 h-5 rounded-full ${F==="round"?"bg-white/40":"bg-primary/80"}`}),f.jsx("span",{className:`text-xs hidden sm:inline ${F==="round"?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"Round"})]}),f.jsxs("button",{onClick:()=>_e("rect"),className:`tool-btn p-2 rounded-lg border flex items-center gap-2 transition-all ${F==="rect"?"bg-gradient-to-r from-primary to-secondary text-white border-transparent":"border-gray-200 dark:border-gray-600 hover:bg-indigo-50 dark:hover:bg-slate-700"}`,title:"Long Table (or change selected table)",children:[f.jsx("div",{className:`w-7 h-4 rounded ${F==="rect"?"bg-white/40":"bg-secondary/80"}`}),f.jsx("span",{className:`text-xs hidden sm:inline ${F==="rect"?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"Long"})]}),f.jsxs("button",{onClick:()=>_e("square"),className:`tool-btn p-2 rounded-lg border flex items-center gap-2 transition-all ${F==="square"?"bg-gradient-to-r from-primary to-secondary text-white border-transparent":"border-gray-200 dark:border-gray-600 hover:bg-indigo-50 dark:hover:bg-slate-700"}`,title:"Square Table (or change selected table)",children:[f.jsx("div",{className:`w-5 h-5 rounded ${F==="square"?"bg-white/40":"bg-green-500/80"}`}),f.jsx("span",{className:`text-xs hidden sm:inline ${F==="square"?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"Square"})]}),f.jsx("div",{className:"w-px h-6 bg-gray-200 dark:bg-gray-600 mx-1"}),f.jsxs("button",{onClick:()=>K("stage"),className:"tool-btn p-2 rounded-lg border border-gray-200 dark:border-gray-600 flex items-center gap-2 hover:bg-indigo-50 dark:hover:bg-slate-700 transition-all",title:"Stage",children:[f.jsx("span",{children:""}),f.jsx("span",{className:"text-xs hidden sm:inline text-gray-600 dark:text-gray-300",children:"Stage"})]}),f.jsxs("button",{onClick:()=>K("danceFloor"),className:"tool-btn p-2 rounded-lg border border-gray-200 dark:border-gray-600 flex items-center gap-2 hover:bg-indigo-50 dark:hover:bg-slate-700 transition-all",title:"Dance Floor",children:[f.jsx("span",{children:""}),f.jsx("span",{className:"text-xs hidden sm:inline text-gray-600 dark:text-gray-300",children:"Dance"})]}),f.jsx("div",{className:"w-px h-6 bg-gray-200 dark:bg-gray-600 mx-1"}),f.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Obstacles:"}),f.jsxs("button",{onClick:()=>K("wall"),className:"tool-btn p-2 rounded-lg border border-gray-200 dark:border-gray-600 flex items-center gap-2 hover:bg-indigo-50 dark:hover:bg-slate-700 transition-all",title:"Rectangle Obstacle (Wall)",children:[f.jsx("div",{className:"w-6 h-4 rounded-sm bg-gradient-to-br from-slate-500 to-slate-700"}),f.jsx("span",{className:"text-xs hidden sm:inline text-gray-600 dark:text-gray-300",children:"Rect"})]}),f.jsxs("button",{onClick:()=>K("pillar"),className:"tool-btn p-2 rounded-lg border border-gray-200 dark:border-gray-600 flex items-center gap-2 hover:bg-indigo-50 dark:hover:bg-slate-700 transition-all",title:"Circle Obstacle (Pillar)",children:[f.jsx("div",{className:"w-5 h-5 rounded-full bg-gradient-to-br from-stone-400 to-stone-600"}),f.jsx("span",{className:"text-xs hidden sm:inline text-gray-600 dark:text-gray-300",children:"Circle"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[f.jsxs("div",{className:"flex items-center gap-1 bg-white dark:bg-slate-800 rounded-xl p-1 border border-gray-200 dark:border-gray-700 shadow-sm",children:[f.jsx("button",{onClick:()=>w(Pe=>Math.max(.3,+(Pe-.1).toFixed(1))),className:"px-3 py-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-600 dark:text-gray-300 font-semibold transition",children:""}),f.jsxs("span",{className:"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 min-w-[50px] text-center",children:[Math.round(y*100),"%"]}),f.jsx("button",{onClick:()=>w(Pe=>Math.min(2,+(Pe+.1).toFixed(1))),className:"px-3 py-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-600 dark:text-gray-300 font-semibold transition",children:"+"})]}),f.jsx("button",{onClick:Wt,className:"px-3 py-2 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-800 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700 transition flex items-center gap-1 shadow-sm",children:" Reset"}),f.jsxs("button",{onClick:()=>T(Pe=>!Pe),className:`px-3 py-2 rounded-xl border text-sm font-medium transition flex items-center gap-1 shadow-sm ${D?"border-primary bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-slate-800 text-gray-600 dark:text-gray-300"}`,children:[" Snap: ",D?"ON":"OFF"]})]})]}),f.jsx("div",{className:"flex-1 flex gap-4 overflow-hidden px-6 pb-4 min-h-0",children:r||n?f.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-400",children:"Loading..."}):f.jsxs(f.Fragment,{children:[f.jsx(jU,{floorItems:u,tables:t,guests:a,zoom:y,panX:E,panY:N,selectedId:R,snapEnabled:D,snapSize:B,toolMode:F,onZoomChange:w,onPanChange:L,onSelect:V,onMoveItem:G,onDoubleClickTable:le,onDropGuest:Re,onDeleteSelected:Q,onCanvasClick:lt,onSeatClick:Ee}),f.jsx("div",{className:"hidden lg:flex h-full",children:f.jsx(Yw,{guests:a,tables:t.map(Pe=>({id:Pe.id,name:Pe.name}))})}),f.jsxs("button",{onClick:()=>ie(!0),className:"lg:hidden fixed bottom-6 left-6 z-40 bg-primary text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 hover:brightness-110 transition",children:[f.jsx("span",{children:""}),f.jsx("span",{className:"text-sm font-semibold",children:"Guests"}),fr>0&&f.jsx("span",{className:"bg-yellow-400 text-yellow-900 text-xs font-bold px-2 py-0.5 rounded-full",children:fr})]})]})}),f.jsx(eh,{isOpen:U,onClose:ot,initial:Ca?{id:Ca.id,name:Ca.name,capacity:Ca.capacity}:void 0}),ee&&f.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 flex",children:[f.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>ie(!1)}),f.jsxs("div",{className:"relative ml-auto h-full w-80 max-w-[85vw] animate-slide-left",children:[f.jsx("button",{onClick:()=>ie(!1),className:"absolute top-3 right-3 z-10 bg-gray-100 dark:bg-slate-700 rounded-full w-8 h-8 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600",children:""}),f.jsx(Yw,{guests:a,tables:t.map(Pe=>({id:Pe.id,name:Pe.name}))})]})]}),Te&&f.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>ne(null),children:f.jsxs("div",{className:"absolute bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 w-64 max-h-72 overflow-hidden flex flex-col",style:{left:Math.min(Te.anchorX-128,window.innerWidth-272),top:Math.max(8,Te.anchorY-280)},onClick:Pe=>Pe.stopPropagation(),children:[f.jsxs("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-slate-900",children:[f.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:"Assign Guest to Seat"}),f.jsxs("p",{className:"text-xs text-gray-500",children:["Seat #",Te.seatIndex+1]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",style:{scrollbarWidth:"thin"},children:a.filter(Pe=>!Pe.tableId).length===0?f.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No unassigned guests"}):a.filter(Pe=>!Pe.tableId).map(Pe=>f.jsxs("button",{onClick:()=>Ne(Pe.id),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-slate-700 transition flex items-center justify-between group",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:Pe.name}),Pe.flag==="VIP"&&f.jsx("span",{className:"ml-2 px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]}),f.jsxs("span",{className:"text-xs text-gray-400 group-hover:text-primary",children:[Pe.pax??1," pax"]})]},Pe.id))})]})}),ce&&f.jsxs("div",{className:"fixed bottom-6 right-6 z-50 bg-slate-800 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-3 animate-slide-up",children:[f.jsx("span",{className:"text-xl",children:ce.icon}),f.jsx("span",{children:ce.message})]})]}):f.jsx("div",{className:"flex items-center justify-center h-96 text-slate-400",children:"Please select an event first."})}function OU(){const e=Na();return f.jsxs(H3,{children:[f.jsxs(ut,{element:f.jsx(r5,{}),children:[f.jsx(ut,{path:"/",element:f.jsx(BA,{})}),f.jsx(ut,{path:"/login",element:f.jsx(IA,{})}),f.jsx(ut,{path:"/events",element:f.jsx(VI,{})}),f.jsx(ut,{path:"/rsvp",element:f.jsx(GI,{})}),f.jsx(ut,{path:"/rsvp/share/:token",element:f.jsx(GP,{})})]}),f.jsxs(ut,{path:"/app",element:f.jsx(D5,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(xm,{to:"dashboard",replace:!0})}),f.jsx(ut,{path:"dashboard",element:f.jsx(HI,{})}),f.jsxs(ut,{path:"events",element:f.jsx(js,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(F5,{})}),f.jsx(ut,{path:"new",element:f.jsx(zd,{isOpen:!0,onClose:()=>e(-1)})}),f.jsx(ut,{path:":id/edit",element:f.jsx(O5,{})}),f.jsx(ut,{path:":id/form-fields",element:f.jsx(YI,{})})]}),f.jsxs(ut,{path:"rsvps",element:f.jsx(js,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(FP,{})}),f.jsx(ut,{path:"designer",element:f.jsx(HP,{})}),f.jsx(ut,{path:"new",element:f.jsx(qI,{})}),f.jsx(ut,{path:":id/edit",element:f.jsx(WI,{})})]}),f.jsx(ut,{path:"guests",element:f.jsx(JP,{})}),f.jsxs(ut,{path:"tables",element:f.jsx(js,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(iI,{})}),f.jsx(ut,{path:"floorplan",element:f.jsx(FU,{})}),f.jsx(ut,{path:"new",element:f.jsx(eh,{isOpen:!0,onClose:()=>e(-1)})}),f.jsxs(ut,{path:":tableId",element:f.jsx(KI,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(EU,{})}),f.jsx(ut,{path:"assignments",element:f.jsx($I,{})}),f.jsx(ut,{path:"layout",element:f.jsx(wU,{})}),f.jsx(ut,{path:"print",element:f.jsx(SU,{})}),f.jsx(ut,{path:"edit",element:f.jsx(lI,{})})]})]}),f.jsxs(ut,{path:"seating",element:f.jsx(js,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(hI,{})}),f.jsx(ut,{path:"new",element:f.jsx(zg,{isOpen:!0,onClose:()=>e(-1)})}),f.jsx(ut,{path:":id/edit",element:f.jsx(xI,{})})]}),f.jsxs(ut,{path:"users",element:f.jsx(js,{}),children:[f.jsx(ut,{index:!0,element:f.jsx(bI,{})}),f.jsx(ut,{path:"new",element:f.jsx(Hg,{isOpen:!0,onClose:()=>e(-1)})}),f.jsx(ut,{path:":id/edit",element:f.jsx(wI,{})})]}),f.jsx(ut,{path:"wallet",element:f.jsx(PI,{})}),f.jsx(ut,{path:"*",element:f.jsx(xm,{to:"/app/dashboard",replace:!0})})]}),f.jsx(ut,{path:"*",element:f.jsx(xm,{to:"/",replace:!0})})]})}function MU(){return f.jsx(_N,{children:f.jsx(MA,{children:f.jsx(hN,{children:f.jsx(OU,{})})})})}const LU=new pA;$T.createRoot(document.getElementById("root")).render(f.jsx(C.StrictMode,{children:f.jsxs(wA,{client:LU,children:[f.jsx(i5,{children:f.jsx(MU,{})}),f.jsx(TP,{position:"top-right"})]})}));
