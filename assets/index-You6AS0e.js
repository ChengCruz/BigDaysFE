var z2=e=>{throw TypeError(e)};var hm=(e,t,r)=>t.has(e)||z2("Cannot "+r);var ae=(e,t,r)=>(hm(e,t,"read from private field"),r?r.call(e):t.get(e)),Ke=(e,t,r)=>t.has(e)?z2("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),He=(e,t,r,a)=>(hm(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),pt=(e,t,r)=>(hm(e,t,"access private method"),r);var Mf=(e,t,r,a)=>({set _(n){He(e,t,n,r)},get _(){return ae(e,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Lf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yT(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),r}var xm={exports:{}},d0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H2;function bT(){if(H2)return d0;H2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,l){var o=null;if(l!==void 0&&(o=""+l),n.key!==void 0&&(o=""+n.key),"key"in n){l={};for(var f in n)f!=="key"&&(l[f]=n[f])}else l=n;return n=l.ref,{$$typeof:e,type:a,key:o,ref:n!==void 0?n:null,props:l}}return d0.Fragment=t,d0.jsx=r,d0.jsxs=r,d0}var G2;function wT(){return G2||(G2=1,xm.exports=bT()),xm.exports}var c=wT(),mm={exports:{}},xt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V2;function ST(){if(V2)return xt;V2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function v(I){return I===null||typeof I!="object"?null:(I=p&&I[p]||I["@@iterator"],typeof I=="function"?I:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function E(I,Z,L){this.props=I,this.context=Z,this.refs=w,this.updater=L||y}E.prototype.isReactComponent={},E.prototype.setState=function(I,Z){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,Z,"setState")},E.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function _(){}_.prototype=E.prototype;function N(I,Z,L){this.props=I,this.context=Z,this.refs=w,this.updater=L||y}var k=N.prototype=new _;k.constructor=N,b(k,E.prototype),k.isPureReactComponent=!0;var F=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function T(I,Z,L,P,U,Y){return L=Y.ref,{$$typeof:e,type:I,key:Z,ref:L!==void 0?L:null,props:Y}}function C(I,Z){return T(I.type,Z,void 0,void 0,void 0,I.props)}function O(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function V(I){var Z={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(L){return Z[L]})}var z=/\/+/g;function H(I,Z){return typeof I=="object"&&I!==null&&I.key!=null?V(""+I.key):Z.toString(36)}function ie(){}function we(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(ie,ie):(I.status="pending",I.then(function(Z){I.status==="pending"&&(I.status="fulfilled",I.value=Z)},function(Z){I.status==="pending"&&(I.status="rejected",I.reason=Z)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function ge(I,Z,L,P,U){var Y=typeof I;(Y==="undefined"||Y==="boolean")&&(I=null);var re=!1;if(I===null)re=!0;else switch(Y){case"bigint":case"string":case"number":re=!0;break;case"object":switch(I.$$typeof){case e:case t:re=!0;break;case m:return re=I._init,ge(re(I._payload),Z,L,P,U)}}if(re)return U=U(I),re=P===""?"."+H(I,0):P,F(U)?(L="",re!=null&&(L=re.replace(z,"$&/")+"/"),ge(U,Z,L,"",function(Te){return Te})):U!=null&&(O(U)&&(U=C(U,L+(U.key==null||I&&I.key===U.key?"":(""+U.key).replace(z,"$&/")+"/")+re)),Z.push(U)),1;re=0;var ve=P===""?".":P+":";if(F(I))for(var be=0;be<I.length;be++)P=I[be],Y=ve+H(P,be),re+=ge(P,Z,L,Y,U);else if(be=v(I),typeof be=="function")for(I=be.call(I),be=0;!(P=I.next()).done;)P=P.value,Y=ve+H(P,be++),re+=ge(P,Z,L,Y,U);else if(Y==="object"){if(typeof I.then=="function")return ge(we(I),Z,L,P,U);throw Z=String(I),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return re}function ee(I,Z,L){if(I==null)return I;var P=[],U=0;return ge(I,P,"","",function(Y){return Z.call(L,Y,U++)}),P}function le(I){if(I._status===-1){var Z=I._result;Z=Z(),Z.then(function(L){(I._status===0||I._status===-1)&&(I._status=1,I._result=L)},function(L){(I._status===0||I._status===-1)&&(I._status=2,I._result=L)}),I._status===-1&&(I._status=0,I._result=Z)}if(I._status===1)return I._result.default;throw I._result}var ne=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)};function te(){}return xt.Children={map:ee,forEach:function(I,Z,L){ee(I,function(){Z.apply(this,arguments)},L)},count:function(I){var Z=0;return ee(I,function(){Z++}),Z},toArray:function(I){return ee(I,function(Z){return Z})||[]},only:function(I){if(!O(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},xt.Component=E,xt.Fragment=r,xt.Profiler=n,xt.PureComponent=N,xt.StrictMode=a,xt.Suspense=d,xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,xt.__COMPILER_RUNTIME={__proto__:null,c:function(I){return j.H.useMemoCache(I)}},xt.cache=function(I){return function(){return I.apply(null,arguments)}},xt.cloneElement=function(I,Z,L){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var P=b({},I.props),U=I.key,Y=void 0;if(Z!=null)for(re in Z.ref!==void 0&&(Y=void 0),Z.key!==void 0&&(U=""+Z.key),Z)!R.call(Z,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&Z.ref===void 0||(P[re]=Z[re]);var re=arguments.length-2;if(re===1)P.children=L;else if(1<re){for(var ve=Array(re),be=0;be<re;be++)ve[be]=arguments[be+2];P.children=ve}return T(I.type,U,void 0,void 0,Y,P)},xt.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},xt.createElement=function(I,Z,L){var P,U={},Y=null;if(Z!=null)for(P in Z.key!==void 0&&(Y=""+Z.key),Z)R.call(Z,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(U[P]=Z[P]);var re=arguments.length-2;if(re===1)U.children=L;else if(1<re){for(var ve=Array(re),be=0;be<re;be++)ve[be]=arguments[be+2];U.children=ve}if(I&&I.defaultProps)for(P in re=I.defaultProps,re)U[P]===void 0&&(U[P]=re[P]);return T(I,Y,void 0,void 0,null,U)},xt.createRef=function(){return{current:null}},xt.forwardRef=function(I){return{$$typeof:f,render:I}},xt.isValidElement=O,xt.lazy=function(I){return{$$typeof:m,_payload:{_status:-1,_result:I},_init:le}},xt.memo=function(I,Z){return{$$typeof:x,type:I,compare:Z===void 0?null:Z}},xt.startTransition=function(I){var Z=j.T,L={};j.T=L;try{var P=I(),U=j.S;U!==null&&U(L,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(te,ne)}catch(Y){ne(Y)}finally{j.T=Z}},xt.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},xt.use=function(I){return j.H.use(I)},xt.useActionState=function(I,Z,L){return j.H.useActionState(I,Z,L)},xt.useCallback=function(I,Z){return j.H.useCallback(I,Z)},xt.useContext=function(I){return j.H.useContext(I)},xt.useDebugValue=function(){},xt.useDeferredValue=function(I,Z){return j.H.useDeferredValue(I,Z)},xt.useEffect=function(I,Z,L){var P=j.H;if(typeof L=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return P.useEffect(I,Z)},xt.useId=function(){return j.H.useId()},xt.useImperativeHandle=function(I,Z,L){return j.H.useImperativeHandle(I,Z,L)},xt.useInsertionEffect=function(I,Z){return j.H.useInsertionEffect(I,Z)},xt.useLayoutEffect=function(I,Z){return j.H.useLayoutEffect(I,Z)},xt.useMemo=function(I,Z){return j.H.useMemo(I,Z)},xt.useOptimistic=function(I,Z){return j.H.useOptimistic(I,Z)},xt.useReducer=function(I,Z,L){return j.H.useReducer(I,Z,L)},xt.useRef=function(I){return j.H.useRef(I)},xt.useState=function(I){return j.H.useState(I)},xt.useSyncExternalStore=function(I,Z,L){return j.H.useSyncExternalStore(I,Z,L)},xt.useTransition=function(){return j.H.useTransition()},xt.version="19.1.0",xt}var q2;function Ga(){return q2||(q2=1,mm.exports=ST()),mm.exports}var A=Ga();const kl=Vn(A);var pm={exports:{}},h0={},gm={exports:{}},vm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W2;function ET(){return W2||(W2=1,function(e){function t(ee,le){var ne=ee.length;ee.push(le);e:for(;0<ne;){var te=ne-1>>>1,I=ee[te];if(0<n(I,le))ee[te]=le,ee[ne]=I,ne=te;else break e}}function r(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var le=ee[0],ne=ee.pop();if(ne!==le){ee[0]=ne;e:for(var te=0,I=ee.length,Z=I>>>1;te<Z;){var L=2*(te+1)-1,P=ee[L],U=L+1,Y=ee[U];if(0>n(P,ne))U<I&&0>n(Y,P)?(ee[te]=Y,ee[U]=ne,te=U):(ee[te]=P,ee[L]=ne,te=L);else if(U<I&&0>n(Y,ne))ee[te]=Y,ee[U]=ne,te=U;else break e}}return le}function n(ee,le){var ne=ee.sortIndex-le.sortIndex;return ne!==0?ne:ee.id-le.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var d=[],x=[],m=1,p=null,v=3,y=!1,b=!1,w=!1,E=!1,_=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function F(ee){for(var le=r(x);le!==null;){if(le.callback===null)a(x);else if(le.startTime<=ee)a(x),le.sortIndex=le.expirationTime,t(d,le);else break;le=r(x)}}function j(ee){if(w=!1,F(ee),!b)if(r(d)!==null)b=!0,R||(R=!0,H());else{var le=r(x);le!==null&&ge(j,le.startTime-ee)}}var R=!1,T=-1,C=5,O=-1;function V(){return E?!0:!(e.unstable_now()-O<C)}function z(){if(E=!1,R){var ee=e.unstable_now();O=ee;var le=!0;try{e:{b=!1,w&&(w=!1,N(T),T=-1),y=!0;var ne=v;try{t:{for(F(ee),p=r(d);p!==null&&!(p.expirationTime>ee&&V());){var te=p.callback;if(typeof te=="function"){p.callback=null,v=p.priorityLevel;var I=te(p.expirationTime<=ee);if(ee=e.unstable_now(),typeof I=="function"){p.callback=I,F(ee),le=!0;break t}p===r(d)&&a(d),F(ee)}else a(d);p=r(d)}if(p!==null)le=!0;else{var Z=r(x);Z!==null&&ge(j,Z.startTime-ee),le=!1}}break e}finally{p=null,v=ne,y=!1}le=void 0}}finally{le?H():R=!1}}}var H;if(typeof k=="function")H=function(){k(z)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,we=ie.port2;ie.port1.onmessage=z,H=function(){we.postMessage(null)}}else H=function(){_(z,0)};function ge(ee,le){T=_(function(){ee(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(ee){switch(v){case 1:case 2:case 3:var le=3;break;default:le=v}var ne=v;v=le;try{return ee()}finally{v=ne}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(ee,le){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ne=v;v=ee;try{return le()}finally{v=ne}},e.unstable_scheduleCallback=function(ee,le,ne){var te=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?te+ne:te):ne=te,ee){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=ne+I,ee={id:m++,callback:le,priorityLevel:ee,startTime:ne,expirationTime:I,sortIndex:-1},ne>te?(ee.sortIndex=ne,t(x,ee),r(d)===null&&ee===r(x)&&(w?(N(T),T=-1):w=!0,ge(j,ne-te))):(ee.sortIndex=I,t(d,ee),b||y||(b=!0,R||(R=!0,H()))),ee},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(ee){var le=v;return function(){var ne=v;v=le;try{return ee.apply(this,arguments)}finally{v=ne}}}}(vm)),vm}var X2;function _T(){return X2||(X2=1,gm.exports=ET()),gm.exports}var ym={exports:{}},oa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $2;function kT(){if($2)return oa;$2=1;var e=Ga();function t(d){var x="https://react.dev/errors/"+d;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)x+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function l(d,x,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:p==null?null:""+p,children:d,containerInfo:x,implementation:m}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,x){if(d==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return oa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,oa.createPortal=function(d,x){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return l(d,x,null,m)},oa.flushSync=function(d){var x=o.T,m=a.p;try{if(o.T=null,a.p=2,d)return d()}finally{o.T=x,a.p=m,a.d.f()}},oa.preconnect=function(d,x){typeof d=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,a.d.C(d,x))},oa.prefetchDNS=function(d){typeof d=="string"&&a.d.D(d)},oa.preinit=function(d,x){if(typeof d=="string"&&x&&typeof x.as=="string"){var m=x.as,p=f(m,x.crossOrigin),v=typeof x.integrity=="string"?x.integrity:void 0,y=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;m==="style"?a.d.S(d,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:y}):m==="script"&&a.d.X(d,{crossOrigin:p,integrity:v,fetchPriority:y,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},oa.preinitModule=function(d,x){if(typeof d=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var m=f(x.as,x.crossOrigin);a.d.M(d,{crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&a.d.M(d)},oa.preload=function(d,x){if(typeof d=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var m=x.as,p=f(m,x.crossOrigin);a.d.L(d,m,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},oa.preloadModule=function(d,x){if(typeof d=="string")if(x){var m=f(x.as,x.crossOrigin);a.d.m(d,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else a.d.m(d)},oa.requestFormReset=function(d){a.d.r(d)},oa.unstable_batchedUpdates=function(d,x){return d(x)},oa.useFormState=function(d,x,m){return o.H.useFormState(d,x,m)},oa.useFormStatus=function(){return o.H.useHostTransitionStatus()},oa.version="19.1.0",oa}var Y2;function Md(){if(Y2)return ym.exports;Y2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ym.exports=kT(),ym.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K2;function TT(){if(K2)return h0;K2=1;var e=_T(),t=Ga(),r=Md();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(l(s)!==s)throw Error(a(188))}function d(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(a(188));return i!==s?null:s}for(var u=s,h=i;;){var g=u.return;if(g===null)break;var S=g.alternate;if(S===null){if(h=g.return,h!==null){u=h;continue}break}if(g.child===S.child){for(S=g.child;S;){if(S===u)return f(g),s;if(S===h)return f(g),i;S=S.sibling}throw Error(a(188))}if(u.return!==h.return)u=g,h=S;else{for(var D=!1,B=g.child;B;){if(B===u){D=!0,u=g,h=S;break}if(B===h){D=!0,h=g,u=S;break}B=B.sibling}if(!D){for(B=S.child;B;){if(B===u){D=!0,u=S,h=g;break}if(B===h){D=!0,h=S,u=g;break}B=B.sibling}if(!D)throw Error(a(189))}}if(u.alternate!==h)throw Error(a(190))}if(u.tag!==3)throw Error(a(188));return u.stateNode.current===u?s:i}function x(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=x(s),i!==null)return i;s=s.sibling}return null}var m=Object.assign,p=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=z&&s[z]||s["@@iterator"],typeof s=="function"?s:null)}var ie=Symbol.for("react.client.reference");function we(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ie?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case j:return"Suspense";case R:return"SuspenseList";case O:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case k:return(s.displayName||"Context")+".Provider";case N:return(s._context.displayName||"Context")+".Consumer";case F:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return i=s.displayName||null,i!==null?i:we(s.type)||"Memo";case C:i=s._payload,s=s._init;try{return we(s(i))}catch{}}return null}var ge=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},te=[],I=-1;function Z(s){return{current:s}}function L(s){0>I||(s.current=te[I],te[I]=null,I--)}function P(s,i){I++,te[I]=s.current,s.current=i}var U=Z(null),Y=Z(null),re=Z(null),ve=Z(null);function be(s,i){switch(P(re,i),P(Y,s),P(U,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?m2(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=m2(i),s=p2(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}L(U),P(U,s)}function Te(){L(U),L(Y),L(re)}function Ae(s){s.memoizedState!==null&&P(ve,s);var i=U.current,u=p2(i,s.type);i!==u&&(P(Y,s),P(U,u))}function Ve(s){Y.current===s&&(L(U),L(Y)),ve.current===s&&(L(ve),l0._currentValue=ne)}var Q=Object.prototype.hasOwnProperty,st=e.unstable_scheduleCallback,it=e.unstable_cancelCallback,Qe=e.unstable_shouldYield,tt=e.unstable_requestPaint,De=e.unstable_now,Ot=e.unstable_getCurrentPriorityLevel,dr=e.unstable_ImmediatePriority,Zr=e.unstable_UserBlockingPriority,hr=e.unstable_NormalPriority,An=e.unstable_LowPriority,ya=e.unstable_IdlePriority,xr=e.log,Yt=e.unstable_setDisableYieldValue,Cr=null,or=null;function Nt(s){if(typeof xr=="function"&&Yt(s),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(Cr,s)}catch{}}var Mt=Math.clz32?Math.clz32:ut,lt=Math.log,Ce=Math.LN2;function ut(s){return s>>>=0,s===0?32:31-(lt(s)/Ce|0)|0}var St=256,Mr=4194304;function Ra(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Oe(s,i,u){var h=s.pendingLanes;if(h===0)return 0;var g=0,S=s.suspendedLanes,D=s.pingedLanes;s=s.warmLanes;var B=h&134217727;return B!==0?(h=B&~S,h!==0?g=Ra(h):(D&=B,D!==0?g=Ra(D):u||(u=B&~s,u!==0&&(g=Ra(u))))):(B=h&~S,B!==0?g=Ra(B):D!==0?g=Ra(D):u||(u=h&~s,u!==0&&(g=Ra(u)))),g===0?0:i!==0&&i!==g&&(i&S)===0&&(S=g&-g,u=i&-i,S>=u||S===32&&(u&4194048)!==0)?i:g}function Ue(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Ye(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qe(){var s=St;return St<<=1,(St&4194048)===0&&(St=256),s}function ot(){var s=Mr;return Mr<<=1,(Mr&62914560)===0&&(Mr=4194304),s}function Jr(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function ea(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function nn(s,i,u,h,g,S){var D=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var B=s.entanglements,J=s.expirationTimes,fe=s.hiddenUpdates;for(u=D&~u;0<u;){var _e=31-Mt(u),Ne=1<<_e;B[_e]=0,J[_e]=-1;var xe=fe[_e];if(xe!==null)for(fe[_e]=null,_e=0;_e<xe.length;_e++){var pe=xe[_e];pe!==null&&(pe.lane&=-536870913)}u&=~Ne}h!==0&&Yn(s,h,0),S!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=S&~(D&~i))}function Yn(s,i,u){s.pendingLanes|=i,s.suspendedLanes&=~i;var h=31-Mt(i);s.entangledLanes|=i,s.entanglements[h]=s.entanglements[h]|1073741824|u&4194090}function Kn(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var h=31-Mt(u),g=1<<h;g&i|s[h]&i&&(s[h]|=i),u&=~g}}function Qn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function vc(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ku(){var s=le.p;return s!==0?s:(s=window.event,s===void 0?32:M2(s.type))}function oh(s,i){var u=le.p;try{return le.p=s,i()}finally{le.p=u}}var Zn=Math.random().toString(36).slice(2),Gr="__reactFiber$"+Zn,Vr="__reactProps$"+Zn,Ks="__reactContainer$"+Zn,yc="__reactEvents$"+Zn,ch="__reactListeners$"+Zn,M="__reactHandles$"+Zn,X="__reactResources$"+Zn,G="__reactMarker$"+Zn;function q(s){delete s[Gr],delete s[Vr],delete s[yc],delete s[ch],delete s[M]}function W(s){var i=s[Gr];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Ks]||u[Gr]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=b2(s);s!==null;){if(u=s[Gr])return u;s=b2(s)}return i}s=u,u=s.parentNode}return null}function K(s){if(s=s[Gr]||s[Ks]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function de(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function Se(s){var i=s[X];return i||(i=s[X]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ce(s){s[G]=!0}var he=new Set,me={};function Re(s,i){Le(s,i),Le(s+"Capture",i)}function Le(s,i){for(me[s]=i,s=0;s<i.length;s++)he.add(i[s])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fe={},Ie={};function ct(s){return Q.call(Ie,s)?!0:Q.call(Fe,s)?!1:ze.test(s)?Ie[s]=!0:(Fe[s]=!0,!1)}function Ht(s,i,u){if(ct(i))if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+u)}}function Gt(s,i,u){if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+u)}}function Jt(s,i,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(i,u,""+h)}}var gs,Qs;function sn(s){if(gs===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);gs=i&&i[1]||"",Qs=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+gs+s+Qs}var jn=!1;function Yi(s,i){if(!s||jn)return"";jn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Ne=function(){throw Error()};if(Object.defineProperty(Ne.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ne,[])}catch(pe){var xe=pe}Reflect.construct(s,[],Ne)}else{try{Ne.call()}catch(pe){xe=pe}s.call(Ne.prototype)}}else{try{throw Error()}catch(pe){xe=pe}(Ne=s())&&typeof Ne.catch=="function"&&Ne.catch(function(){})}}catch(pe){if(pe&&xe&&typeof pe.stack=="string")return[pe.stack,xe.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=h.DetermineComponentFrameRoot(),D=S[0],B=S[1];if(D&&B){var J=D.split(`
`),fe=B.split(`
`);for(g=h=0;h<J.length&&!J[h].includes("DetermineComponentFrameRoot");)h++;for(;g<fe.length&&!fe[g].includes("DetermineComponentFrameRoot");)g++;if(h===J.length||g===fe.length)for(h=J.length-1,g=fe.length-1;1<=h&&0<=g&&J[h]!==fe[g];)g--;for(;1<=h&&0<=g;h--,g--)if(J[h]!==fe[g]){if(h!==1||g!==1)do if(h--,g--,0>g||J[h]!==fe[g]){var _e=`
`+J[h].replace(" at new "," at ");return s.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",s.displayName)),_e}while(1<=h&&0<=g);break}}}finally{jn=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?sn(u):""}function Rn(s){switch(s.tag){case 26:case 27:case 5:return sn(s.type);case 16:return sn("Lazy");case 13:return sn("Suspense");case 19:return sn("SuspenseList");case 0:case 15:return Yi(s.type,!1);case 11:return Yi(s.type.render,!1);case 1:return Yi(s.type,!0);case 31:return sn("Activity");default:return""}}function c1(s){try{var i="";do i+=Rn(s),s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function ln(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function u1(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xk(s){var i=u1(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),h=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,S=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return g.call(this)},set:function(D){h=""+D,S.call(this,D)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(D){h=""+D},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Tu(s){s._valueTracker||(s._valueTracker=xk(s))}function f1(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),h="";return s&&(h=u1(s)?s.checked?"true":"false":s.value),s=h,s!==u?(i.setValue(s),!0):!1}function Nu(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var mk=/[\n"\\]/g;function on(s){return s.replace(mk,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function uh(s,i,u,h,g,S,D,B){s.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.type=D:s.removeAttribute("type"),i!=null?D==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+ln(i)):s.value!==""+ln(i)&&(s.value=""+ln(i)):D!=="submit"&&D!=="reset"||s.removeAttribute("value"),i!=null?fh(s,D,ln(i)):u!=null?fh(s,D,ln(u)):h!=null&&s.removeAttribute("value"),g==null&&S!=null&&(s.defaultChecked=!!S),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?s.name=""+ln(B):s.removeAttribute("name")}function d1(s,i,u,h,g,S,D,B){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.type=S),i!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||i!=null))return;u=u!=null?""+ln(u):"",i=i!=null?""+ln(i):u,B||i===s.value||(s.value=i),s.defaultValue=i}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=B?s.checked:!!h,s.defaultChecked=!!h,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.name=D)}function fh(s,i,u){i==="number"&&Nu(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Kl(s,i,u,h){if(s=s.options,i){i={};for(var g=0;g<u.length;g++)i["$"+u[g]]=!0;for(u=0;u<s.length;u++)g=i.hasOwnProperty("$"+s[u].value),s[u].selected!==g&&(s[u].selected=g),g&&h&&(s[u].defaultSelected=!0)}else{for(u=""+ln(u),i=null,g=0;g<s.length;g++){if(s[g].value===u){s[g].selected=!0,h&&(s[g].defaultSelected=!0);return}i!==null||s[g].disabled||(i=s[g])}i!==null&&(i.selected=!0)}}function h1(s,i,u){if(i!=null&&(i=""+ln(i),i!==s.value&&(s.value=i),u==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=u!=null?""+ln(u):""}function x1(s,i,u,h){if(i==null){if(h!=null){if(u!=null)throw Error(a(92));if(ge(h)){if(1<h.length)throw Error(a(93));h=h[0]}u=h}u==null&&(u=""),i=u}u=ln(i),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h)}function Ql(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var pk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function m1(s,i,u){var h=i.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":h?s.setProperty(i,u):typeof u!="number"||u===0||pk.has(i)?i==="float"?s.cssFloat=u:s[i]=(""+u).trim():s[i]=u+"px"}function p1(s,i,u){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var g in i)h=i[g],i.hasOwnProperty(g)&&u[g]!==h&&m1(s,g,h)}else for(var S in i)i.hasOwnProperty(S)&&m1(s,S,i[S])}function dh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cu(s){return vk.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var hh=null;function xh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Zl=null,Jl=null;function g1(s){var i=K(s);if(i&&(s=i.stateNode)){var u=s[Vr]||null;e:switch(s=i.stateNode,i.type){case"input":if(uh(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+on(""+i)+'"][type="radio"]'),i=0;i<u.length;i++){var h=u[i];if(h!==s&&h.form===s.form){var g=h[Vr]||null;if(!g)throw Error(a(90));uh(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<u.length;i++)h=u[i],h.form===s.form&&f1(h)}break e;case"textarea":h1(s,u.value,u.defaultValue);break e;case"select":i=u.value,i!=null&&Kl(s,!!u.multiple,i,!1)}}}var mh=!1;function v1(s,i,u){if(mh)return s(i,u);mh=!0;try{var h=s(i);return h}finally{if(mh=!1,(Zl!==null||Jl!==null)&&(xf(),Zl&&(i=Zl,s=Jl,Jl=Zl=null,g1(i),s)))for(i=0;i<s.length;i++)g1(s[i])}}function bc(s,i){var u=s.stateNode;if(u===null)return null;var h=u[Vr]||null;if(h===null)return null;u=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(a(231,i,typeof u));return u}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ph=!1;if(vs)try{var wc={};Object.defineProperty(wc,"passive",{get:function(){ph=!0}}),window.addEventListener("test",wc,wc),window.removeEventListener("test",wc,wc)}catch{ph=!1}var Zs=null,gh=null,Au=null;function y1(){if(Au)return Au;var s,i=gh,u=i.length,h,g="value"in Zs?Zs.value:Zs.textContent,S=g.length;for(s=0;s<u&&i[s]===g[s];s++);var D=u-s;for(h=1;h<=D&&i[u-h]===g[S-h];h++);return Au=g.slice(s,1<h?1-h:void 0)}function ju(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ru(){return!0}function b1(){return!1}function Da(s){function i(u,h,g,S,D){this._reactName=u,this._targetInst=g,this.type=h,this.nativeEvent=S,this.target=D,this.currentTarget=null;for(var B in s)s.hasOwnProperty(B)&&(u=s[B],this[B]=u?u(S):S[B]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Ru:b1,this.isPropagationStopped=b1,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ru)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ru)},persist:function(){},isPersistent:Ru}),i}var Ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Du=Da(Ki),Sc=m({},Ki,{view:0,detail:0}),yk=Da(Sc),vh,yh,Ec,Fu=m({},Sc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ec&&(Ec&&s.type==="mousemove"?(vh=s.screenX-Ec.screenX,yh=s.screenY-Ec.screenY):yh=vh=0,Ec=s),vh)},movementY:function(s){return"movementY"in s?s.movementY:yh}}),w1=Da(Fu),bk=m({},Fu,{dataTransfer:0}),wk=Da(bk),Sk=m({},Sc,{relatedTarget:0}),bh=Da(Sk),Ek=m({},Ki,{animationName:0,elapsedTime:0,pseudoElement:0}),_k=Da(Ek),kk=m({},Ki,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Tk=Da(kk),Nk=m({},Ki,{data:0}),S1=Da(Nk),Ck={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ak={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rk(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=jk[s])?!!i[s]:!1}function wh(){return Rk}var Dk=m({},Sc,{key:function(s){if(s.key){var i=Ck[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=ju(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ak[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wh,charCode:function(s){return s.type==="keypress"?ju(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ju(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Fk=Da(Dk),Ok=m({},Fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E1=Da(Ok),Mk=m({},Sc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wh}),Lk=Da(Mk),Bk=m({},Ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pk=Da(Bk),Ik=m({},Fu,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Uk=Da(Ik),zk=m({},Ki,{newState:0,oldState:0}),Hk=Da(zk),Gk=[9,13,27,32],Sh=vs&&"CompositionEvent"in window,_c=null;vs&&"documentMode"in document&&(_c=document.documentMode);var Vk=vs&&"TextEvent"in window&&!_c,_1=vs&&(!Sh||_c&&8<_c&&11>=_c),k1=" ",T1=!1;function N1(s,i){switch(s){case"keyup":return Gk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C1(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var eo=!1;function qk(s,i){switch(s){case"compositionend":return C1(i);case"keypress":return i.which!==32?null:(T1=!0,k1);case"textInput":return s=i.data,s===k1&&T1?null:s;default:return null}}function Wk(s,i){if(eo)return s==="compositionend"||!Sh&&N1(s,i)?(s=y1(),Au=gh=Zs=null,eo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return _1&&i.locale!=="ko"?null:i.data;default:return null}}var Xk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A1(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Xk[s.type]:i==="textarea"}function j1(s,i,u,h){Zl?Jl?Jl.push(h):Jl=[h]:Zl=h,i=bf(i,"onChange"),0<i.length&&(u=new Du("onChange","change",null,u,h),s.push({event:u,listeners:i}))}var kc=null,Tc=null;function $k(s){u2(s,0)}function Ou(s){var i=de(s);if(f1(i))return s}function R1(s,i){if(s==="change")return i}var D1=!1;if(vs){var Eh;if(vs){var _h="oninput"in document;if(!_h){var F1=document.createElement("div");F1.setAttribute("oninput","return;"),_h=typeof F1.oninput=="function"}Eh=_h}else Eh=!1;D1=Eh&&(!document.documentMode||9<document.documentMode)}function O1(){kc&&(kc.detachEvent("onpropertychange",M1),Tc=kc=null)}function M1(s){if(s.propertyName==="value"&&Ou(Tc)){var i=[];j1(i,Tc,s,xh(s)),v1($k,i)}}function Yk(s,i,u){s==="focusin"?(O1(),kc=i,Tc=u,kc.attachEvent("onpropertychange",M1)):s==="focusout"&&O1()}function Kk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ou(Tc)}function Qk(s,i){if(s==="click")return Ou(i)}function Zk(s,i){if(s==="input"||s==="change")return Ou(i)}function Jk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Va=typeof Object.is=="function"?Object.is:Jk;function Nc(s,i){if(Va(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),h=Object.keys(i);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var g=u[h];if(!Q.call(i,g)||!Va(s[g],i[g]))return!1}return!0}function L1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function B1(s,i){var u=L1(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=i&&h>=i)return{node:u,offset:i-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=L1(u)}}function P1(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?P1(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function I1(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Nu(s.document);i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Nu(s.document)}return i}function kh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var e3=vs&&"documentMode"in document&&11>=document.documentMode,to=null,Th=null,Cc=null,Nh=!1;function U1(s,i,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Nh||to==null||to!==Nu(h)||(h=to,"selectionStart"in h&&kh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Cc&&Nc(Cc,h)||(Cc=h,h=bf(Th,"onSelect"),0<h.length&&(i=new Du("onSelect","select",null,i,u),s.push({event:i,listeners:h}),i.target=to)))}function Qi(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var ro={animationend:Qi("Animation","AnimationEnd"),animationiteration:Qi("Animation","AnimationIteration"),animationstart:Qi("Animation","AnimationStart"),transitionrun:Qi("Transition","TransitionRun"),transitionstart:Qi("Transition","TransitionStart"),transitioncancel:Qi("Transition","TransitionCancel"),transitionend:Qi("Transition","TransitionEnd")},Ch={},z1={};vs&&(z1=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function Zi(s){if(Ch[s])return Ch[s];if(!ro[s])return s;var i=ro[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in z1)return Ch[s]=i[u];return s}var H1=Zi("animationend"),G1=Zi("animationiteration"),V1=Zi("animationstart"),t3=Zi("transitionrun"),r3=Zi("transitionstart"),a3=Zi("transitioncancel"),q1=Zi("transitionend"),W1=new Map,Ah="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ah.push("scrollEnd");function Dn(s,i){W1.set(s,i),Re(i,[s])}var X1=new WeakMap;function cn(s,i){if(typeof s=="object"&&s!==null){var u=X1.get(s);return u!==void 0?u:(i={value:s,source:i,stack:c1(i)},X1.set(s,i),i)}return{value:s,source:i,stack:c1(i)}}var un=[],ao=0,jh=0;function Mu(){for(var s=ao,i=jh=ao=0;i<s;){var u=un[i];un[i++]=null;var h=un[i];un[i++]=null;var g=un[i];un[i++]=null;var S=un[i];if(un[i++]=null,h!==null&&g!==null){var D=h.pending;D===null?g.next=g:(g.next=D.next,D.next=g),h.pending=g}S!==0&&$1(u,g,S)}}function Lu(s,i,u,h){un[ao++]=s,un[ao++]=i,un[ao++]=u,un[ao++]=h,jh|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Rh(s,i,u,h){return Lu(s,i,u,h),Bu(s)}function no(s,i){return Lu(s,null,null,i),Bu(s)}function $1(s,i,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var g=!1,S=s.return;S!==null;)S.childLanes|=u,h=S.alternate,h!==null&&(h.childLanes|=u),S.tag===22&&(s=S.stateNode,s===null||s._visibility&1||(g=!0)),s=S,S=S.return;return s.tag===3?(S=s.stateNode,g&&i!==null&&(g=31-Mt(u),s=S.hiddenUpdates,h=s[g],h===null?s[g]=[i]:h.push(i),i.lane=u|536870912),S):null}function Bu(s){if(50<Jc)throw Jc=0,Bx=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var so={};function n3(s,i,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qa(s,i,u,h){return new n3(s,i,u,h)}function Dh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ys(s,i){var u=s.alternate;return u===null?(u=qa(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Y1(s,i){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,i=u.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Pu(s,i,u,h,g,S){var D=0;if(h=s,typeof s=="function")Dh(s)&&(D=1);else if(typeof s=="string")D=iT(s,u,U.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case O:return s=qa(31,u,i,g),s.elementType=O,s.lanes=S,s;case b:return Ji(u.children,g,S,i);case w:D=8,g|=24;break;case E:return s=qa(12,u,i,g|2),s.elementType=E,s.lanes=S,s;case j:return s=qa(13,u,i,g),s.elementType=j,s.lanes=S,s;case R:return s=qa(19,u,i,g),s.elementType=R,s.lanes=S,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:case k:D=10;break e;case N:D=9;break e;case F:D=11;break e;case T:D=14;break e;case C:D=16,h=null;break e}D=29,u=Error(a(130,s===null?"null":typeof s,"")),h=null}return i=qa(D,u,i,g),i.elementType=s,i.type=h,i.lanes=S,i}function Ji(s,i,u,h){return s=qa(7,s,h,i),s.lanes=u,s}function Fh(s,i,u){return s=qa(6,s,null,i),s.lanes=u,s}function Oh(s,i,u){return i=qa(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var io=[],lo=0,Iu=null,Uu=0,fn=[],dn=0,el=null,bs=1,ws="";function tl(s,i){io[lo++]=Uu,io[lo++]=Iu,Iu=s,Uu=i}function K1(s,i,u){fn[dn++]=bs,fn[dn++]=ws,fn[dn++]=el,el=s;var h=bs;s=ws;var g=32-Mt(h)-1;h&=~(1<<g),u+=1;var S=32-Mt(i)+g;if(30<S){var D=g-g%5;S=(h&(1<<D)-1).toString(32),h>>=D,g-=D,bs=1<<32-Mt(i)+g|u<<g|h,ws=S+s}else bs=1<<S|u<<g|h,ws=s}function Mh(s){s.return!==null&&(tl(s,1),K1(s,1,0))}function Lh(s){for(;s===Iu;)Iu=io[--lo],io[lo]=null,Uu=io[--lo],io[lo]=null;for(;s===el;)el=fn[--dn],fn[dn]=null,ws=fn[--dn],fn[dn]=null,bs=fn[--dn],fn[dn]=null}var ba=null,mr=null,Ft=!1,rl=null,Jn=!1,Bh=Error(a(519));function al(s){var i=Error(a(418,""));throw Rc(cn(i,s)),Bh}function Q1(s){var i=s.stateNode,u=s.type,h=s.memoizedProps;switch(i[Gr]=s,i[Vr]=h,u){case"dialog":_t("cancel",i),_t("close",i);break;case"iframe":case"object":case"embed":_t("load",i);break;case"video":case"audio":for(u=0;u<t0.length;u++)_t(t0[u],i);break;case"source":_t("error",i);break;case"img":case"image":case"link":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"input":_t("invalid",i),d1(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),Tu(i);break;case"select":_t("invalid",i);break;case"textarea":_t("invalid",i),x1(i,h.value,h.defaultValue,h.children),Tu(i)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||i.textContent===""+u||h.suppressHydrationWarning===!0||x2(i.textContent,u)?(h.popover!=null&&(_t("beforetoggle",i),_t("toggle",i)),h.onScroll!=null&&_t("scroll",i),h.onScrollEnd!=null&&_t("scrollend",i),h.onClick!=null&&(i.onclick=wf),i=!0):i=!1,i||al(s)}function Z1(s){for(ba=s.return;ba;)switch(ba.tag){case 5:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:ba=ba.return}}function Ac(s){if(s!==ba)return!1;if(!Ft)return Z1(s),Ft=!0,!1;var i=s.tag,u;if((u=i!==3&&i!==27)&&((u=i===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Jx(s.type,s.memoizedProps)),u=!u),u&&mr&&al(s),Z1(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(i===0){mr=On(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++;s=s.nextSibling}mr=null}}else i===27?(i=mr,xi(s.type)?(s=am,am=null,mr=s):mr=i):mr=ba?On(s.stateNode.nextSibling):null;return!0}function jc(){mr=ba=null,Ft=!1}function J1(){var s=rl;return s!==null&&(Ma===null?Ma=s:Ma.push.apply(Ma,s),rl=null),s}function Rc(s){rl===null?rl=[s]:rl.push(s)}var Ph=Z(null),nl=null,Ss=null;function Js(s,i,u){P(Ph,i._currentValue),i._currentValue=u}function Es(s){s._currentValue=Ph.current,L(Ph)}function Ih(s,i,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),s===u)break;s=s.return}}function Uh(s,i,u,h){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var S=g.dependencies;if(S!==null){var D=g.child;S=S.firstContext;e:for(;S!==null;){var B=S;S=g;for(var J=0;J<i.length;J++)if(B.context===i[J]){S.lanes|=u,B=S.alternate,B!==null&&(B.lanes|=u),Ih(S.return,u,s),h||(D=null);break e}S=B.next}}else if(g.tag===18){if(D=g.return,D===null)throw Error(a(341));D.lanes|=u,S=D.alternate,S!==null&&(S.lanes|=u),Ih(D,u,s),D=null}else D=g.child;if(D!==null)D.return=g;else for(D=g;D!==null;){if(D===s){D=null;break}if(g=D.sibling,g!==null){g.return=D.return,D=g;break}D=D.return}g=D}}function Dc(s,i,u,h){s=null;for(var g=i,S=!1;g!==null;){if(!S){if((g.flags&524288)!==0)S=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var D=g.alternate;if(D===null)throw Error(a(387));if(D=D.memoizedProps,D!==null){var B=g.type;Va(g.pendingProps.value,D.value)||(s!==null?s.push(B):s=[B])}}else if(g===ve.current){if(D=g.alternate,D===null)throw Error(a(387));D.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(l0):s=[l0])}g=g.return}s!==null&&Uh(i,s,u,h),i.flags|=262144}function zu(s){for(s=s.firstContext;s!==null;){if(!Va(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function sl(s){nl=s,Ss=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function la(s){return ev(nl,s)}function Hu(s,i){return nl===null&&sl(s),ev(s,i)}function ev(s,i){var u=i._currentValue;if(i={context:i,memoizedValue:u,next:null},Ss===null){if(s===null)throw Error(a(308));Ss=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Ss=Ss.next=i;return u}var s3=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){i.aborted=!0,s.forEach(function(u){return u()})}},i3=e.unstable_scheduleCallback,l3=e.unstable_NormalPriority,Lr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zh(){return{controller:new s3,data:new Map,refCount:0}}function Fc(s){s.refCount--,s.refCount===0&&i3(l3,function(){s.controller.abort()})}var Oc=null,Hh=0,oo=0,co=null;function o3(s,i){if(Oc===null){var u=Oc=[];Hh=0,oo=Vx(),co={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Hh++,i.then(tv,tv),i}function tv(){if(--Hh===0&&Oc!==null){co!==null&&(co.status="fulfilled");var s=Oc;Oc=null,oo=0,co=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function c3(s,i){var u=[],h={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return s.then(function(){h.status="fulfilled",h.value=i;for(var g=0;g<u.length;g++)(0,u[g])(i)},function(g){for(h.status="rejected",h.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),h}var rv=ee.S;ee.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&o3(s,i),rv!==null&&rv(s,i)};var il=Z(null);function Gh(){var s=il.current;return s!==null?s:er.pooledCache}function Gu(s,i){i===null?P(il,il.current):P(il,i.pool)}function av(){var s=Gh();return s===null?null:{parent:Lr._currentValue,pool:s}}var Mc=Error(a(460)),nv=Error(a(474)),Vu=Error(a(542)),Vh={then:function(){}};function sv(s){return s=s.status,s==="fulfilled"||s==="rejected"}function qu(){}function iv(s,i,u){switch(u=s[u],u===void 0?s.push(i):u!==i&&(i.then(qu,qu),i=u),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,ov(s),s;default:if(typeof i.status=="string")i.then(qu,qu);else{if(s=er,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(h){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=h}},function(h){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,ov(s),s}throw Lc=i,Mc}}var Lc=null;function lv(){if(Lc===null)throw Error(a(459));var s=Lc;return Lc=null,s}function ov(s){if(s===Mc||s===Vu)throw Error(a(483))}var ei=!1;function qh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ti(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ri(s,i,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Bt&2)!==0){var g=h.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),h.pending=i,i=Bu(s),$1(s,null,u),i}return Lu(s,h,i,u),Bu(s)}function Bc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194048)!==0)){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,Kn(s,u)}}function Xh(s,i){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var g=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var D={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?g=S=D:S=S.next=D,u=u.next}while(u!==null);S===null?g=S=i:S=S.next=i}else g=S=i;u={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:S,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}var $h=!1;function Pc(){if($h){var s=co;if(s!==null)throw s}}function Ic(s,i,u,h){$h=!1;var g=s.updateQueue;ei=!1;var S=g.firstBaseUpdate,D=g.lastBaseUpdate,B=g.shared.pending;if(B!==null){g.shared.pending=null;var J=B,fe=J.next;J.next=null,D===null?S=fe:D.next=fe,D=J;var _e=s.alternate;_e!==null&&(_e=_e.updateQueue,B=_e.lastBaseUpdate,B!==D&&(B===null?_e.firstBaseUpdate=fe:B.next=fe,_e.lastBaseUpdate=J))}if(S!==null){var Ne=g.baseState;D=0,_e=fe=J=null,B=S;do{var xe=B.lane&-536870913,pe=xe!==B.lane;if(pe?(Ct&xe)===xe:(h&xe)===xe){xe!==0&&xe===oo&&($h=!0),_e!==null&&(_e=_e.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var at=s,Ze=B;xe=i;var Wt=u;switch(Ze.tag){case 1:if(at=Ze.payload,typeof at=="function"){Ne=at.call(Wt,Ne,xe);break e}Ne=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=Ze.payload,xe=typeof at=="function"?at.call(Wt,Ne,xe):at,xe==null)break e;Ne=m({},Ne,xe);break e;case 2:ei=!0}}xe=B.callback,xe!==null&&(s.flags|=64,pe&&(s.flags|=8192),pe=g.callbacks,pe===null?g.callbacks=[xe]:pe.push(xe))}else pe={lane:xe,tag:B.tag,payload:B.payload,callback:B.callback,next:null},_e===null?(fe=_e=pe,J=Ne):_e=_e.next=pe,D|=xe;if(B=B.next,B===null){if(B=g.shared.pending,B===null)break;pe=B,B=pe.next,pe.next=null,g.lastBaseUpdate=pe,g.shared.pending=null}}while(!0);_e===null&&(J=Ne),g.baseState=J,g.firstBaseUpdate=fe,g.lastBaseUpdate=_e,S===null&&(g.shared.lanes=0),ui|=D,s.lanes=D,s.memoizedState=Ne}}function cv(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function uv(s,i){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)cv(u[s],i)}var uo=Z(null),Wu=Z(0);function fv(s,i){s=js,P(Wu,s),P(uo,i),js=s|i.baseLanes}function Yh(){P(Wu,js),P(uo,uo.current)}function Kh(){js=Wu.current,L(uo),L(Wu)}var ai=0,gt=null,Vt=null,Ar=null,Xu=!1,fo=!1,ll=!1,$u=0,Uc=0,ho=null,u3=0;function wr(){throw Error(a(321))}function Qh(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Va(s[u],i[u]))return!1;return!0}function Zh(s,i,u,h,g,S){return ai=S,gt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ee.H=s===null||s.memoizedState===null?$v:Yv,ll=!1,S=u(h,g),ll=!1,fo&&(S=hv(i,u,h,g)),dv(s),S}function dv(s){ee.H=ef;var i=Vt!==null&&Vt.next!==null;if(ai=0,Ar=Vt=gt=null,Xu=!1,Uc=0,ho=null,i)throw Error(a(300));s===null||qr||(s=s.dependencies,s!==null&&zu(s)&&(qr=!0))}function hv(s,i,u,h){gt=s;var g=0;do{if(fo&&(ho=null),Uc=0,fo=!1,25<=g)throw Error(a(301));if(g+=1,Ar=Vt=null,s.updateQueue!=null){var S=s.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}ee.H=g3,S=i(u,h)}while(fo);return S}function f3(){var s=ee.H,i=s.useState()[0];return i=typeof i.then=="function"?zc(i):i,s=s.useState()[0],(Vt!==null?Vt.memoizedState:null)!==s&&(gt.flags|=1024),i}function Jh(){var s=$u!==0;return $u=0,s}function ex(s,i,u){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~u}function tx(s){if(Xu){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Xu=!1}ai=0,Ar=Vt=gt=null,fo=!1,Uc=$u=0,ho=null}function Fa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ar===null?gt.memoizedState=Ar=s:Ar=Ar.next=s,Ar}function jr(){if(Vt===null){var s=gt.alternate;s=s!==null?s.memoizedState:null}else s=Vt.next;var i=Ar===null?gt.memoizedState:Ar.next;if(i!==null)Ar=i,Vt=s;else{if(s===null)throw gt.alternate===null?Error(a(467)):Error(a(310));Vt=s,s={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},Ar===null?gt.memoizedState=Ar=s:Ar=Ar.next=s}return Ar}function rx(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zc(s){var i=Uc;return Uc+=1,ho===null&&(ho=[]),s=iv(ho,s,i),i=gt,(Ar===null?i.memoizedState:Ar.next)===null&&(i=i.alternate,ee.H=i===null||i.memoizedState===null?$v:Yv),s}function Yu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return zc(s);if(s.$$typeof===k)return la(s)}throw Error(a(438,String(s)))}function ax(s){var i=null,u=gt.updateQueue;if(u!==null&&(i=u.memoCache),i==null){var h=gt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),u===null&&(u=rx(),gt.updateQueue=u),u.memoCache=i,u=i.data[i.index],u===void 0)for(u=i.data[i.index]=Array(s),h=0;h<s;h++)u[h]=V;return i.index++,u}function _s(s,i){return typeof i=="function"?i(s):i}function Ku(s){var i=jr();return nx(i,Vt,s)}function nx(s,i,u){var h=s.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=u;var g=s.baseQueue,S=h.pending;if(S!==null){if(g!==null){var D=g.next;g.next=S.next,S.next=D}i.baseQueue=g=S,h.pending=null}if(S=s.baseState,g===null)s.memoizedState=S;else{i=g.next;var B=D=null,J=null,fe=i,_e=!1;do{var Ne=fe.lane&-536870913;if(Ne!==fe.lane?(Ct&Ne)===Ne:(ai&Ne)===Ne){var xe=fe.revertLane;if(xe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Ne===oo&&(_e=!0);else if((ai&xe)===xe){fe=fe.next,xe===oo&&(_e=!0);continue}else Ne={lane:0,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?(B=J=Ne,D=S):J=J.next=Ne,gt.lanes|=xe,ui|=xe;Ne=fe.action,ll&&u(S,Ne),S=fe.hasEagerState?fe.eagerState:u(S,Ne)}else xe={lane:Ne,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?(B=J=xe,D=S):J=J.next=xe,gt.lanes|=Ne,ui|=Ne;fe=fe.next}while(fe!==null&&fe!==i);if(J===null?D=S:J.next=B,!Va(S,s.memoizedState)&&(qr=!0,_e&&(u=co,u!==null)))throw u;s.memoizedState=S,s.baseState=D,s.baseQueue=J,h.lastRenderedState=S}return g===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function sx(s){var i=jr(),u=i.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=s;var h=u.dispatch,g=u.pending,S=i.memoizedState;if(g!==null){u.pending=null;var D=g=g.next;do S=s(S,D.action),D=D.next;while(D!==g);Va(S,i.memoizedState)||(qr=!0),i.memoizedState=S,i.baseQueue===null&&(i.baseState=S),u.lastRenderedState=S}return[S,h]}function xv(s,i,u){var h=gt,g=jr(),S=Ft;if(S){if(u===void 0)throw Error(a(407));u=u()}else u=i();var D=!Va((Vt||g).memoizedState,u);D&&(g.memoizedState=u,qr=!0),g=g.queue;var B=gv.bind(null,h,g,s);if(Hc(2048,8,B,[s]),g.getSnapshot!==i||D||Ar!==null&&Ar.memoizedState.tag&1){if(h.flags|=2048,xo(9,Qu(),pv.bind(null,h,g,u,i),null),er===null)throw Error(a(349));S||(ai&124)!==0||mv(h,i,u)}return u}function mv(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=gt.updateQueue,i===null?(i=rx(),gt.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function pv(s,i,u,h){i.value=u,i.getSnapshot=h,vv(i)&&yv(s)}function gv(s,i,u){return u(function(){vv(i)&&yv(s)})}function vv(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Va(s,u)}catch{return!0}}function yv(s){var i=no(s,2);i!==null&&Ka(i,s,2)}function ix(s){var i=Fa();if(typeof s=="function"){var u=s;if(s=u(),ll){Nt(!0);try{u()}finally{Nt(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:s},i}function bv(s,i,u,h){return s.baseState=u,nx(s,Vt,typeof h=="function"?h:_s)}function d3(s,i,u,h,g){if(Ju(s))throw Error(a(485));if(s=i.action,s!==null){var S={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){S.listeners.push(D)}};ee.T!==null?u(!0):S.isTransition=!1,h(S),u=i.pending,u===null?(S.next=i.pending=S,wv(i,S)):(S.next=u.next,i.pending=u.next=S)}}function wv(s,i){var u=i.action,h=i.payload,g=s.state;if(i.isTransition){var S=ee.T,D={};ee.T=D;try{var B=u(g,h),J=ee.S;J!==null&&J(D,B),Sv(s,i,B)}catch(fe){lx(s,i,fe)}finally{ee.T=S}}else try{S=u(g,h),Sv(s,i,S)}catch(fe){lx(s,i,fe)}}function Sv(s,i,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){Ev(s,i,h)},function(h){return lx(s,i,h)}):Ev(s,i,u)}function Ev(s,i,u){i.status="fulfilled",i.value=u,_v(i),s.state=u,i=s.pending,i!==null&&(u=i.next,u===i?s.pending=null:(u=u.next,i.next=u,wv(s,u)))}function lx(s,i,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=u,_v(i),i=i.next;while(i!==h)}s.action=null}function _v(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function kv(s,i){return i}function Tv(s,i){if(Ft){var u=er.formState;if(u!==null){e:{var h=gt;if(Ft){if(mr){t:{for(var g=mr,S=Jn;g.nodeType!==8;){if(!S){g=null;break t}if(g=On(g.nextSibling),g===null){g=null;break t}}S=g.data,g=S==="F!"||S==="F"?g:null}if(g){mr=On(g.nextSibling),h=g.data==="F!";break e}}al(h)}h=!1}h&&(i=u[0])}}return u=Fa(),u.memoizedState=u.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kv,lastRenderedState:i},u.queue=h,u=qv.bind(null,gt,h),h.dispatch=u,h=ix(!1),S=dx.bind(null,gt,!1,h.queue),h=Fa(),g={state:i,dispatch:null,action:s,pending:null},h.queue=g,u=d3.bind(null,gt,g,S,u),g.dispatch=u,h.memoizedState=s,[i,u,!1]}function Nv(s){var i=jr();return Cv(i,Vt,s)}function Cv(s,i,u){if(i=nx(s,i,kv)[0],s=Ku(_s)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=zc(i)}catch(D){throw D===Mc?Vu:D}else h=i;i=jr();var g=i.queue,S=g.dispatch;return u!==i.memoizedState&&(gt.flags|=2048,xo(9,Qu(),h3.bind(null,g,u),null)),[h,S,s]}function h3(s,i){s.action=i}function Av(s){var i=jr(),u=Vt;if(u!==null)return Cv(i,u,s);jr(),i=i.memoizedState,u=jr();var h=u.queue.dispatch;return u.memoizedState=s,[i,h,!1]}function xo(s,i,u,h){return s={tag:s,create:u,deps:h,inst:i,next:null},i=gt.updateQueue,i===null&&(i=rx(),gt.updateQueue=i),u=i.lastEffect,u===null?i.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,i.lastEffect=s),s}function Qu(){return{destroy:void 0,resource:void 0}}function jv(){return jr().memoizedState}function Zu(s,i,u,h){var g=Fa();h=h===void 0?null:h,gt.flags|=s,g.memoizedState=xo(1|i,Qu(),u,h)}function Hc(s,i,u,h){var g=jr();h=h===void 0?null:h;var S=g.memoizedState.inst;Vt!==null&&h!==null&&Qh(h,Vt.memoizedState.deps)?g.memoizedState=xo(i,S,u,h):(gt.flags|=s,g.memoizedState=xo(1|i,S,u,h))}function Rv(s,i){Zu(8390656,8,s,i)}function Dv(s,i){Hc(2048,8,s,i)}function Fv(s,i){return Hc(4,2,s,i)}function Ov(s,i){return Hc(4,4,s,i)}function Mv(s,i){if(typeof i=="function"){s=s();var u=i(s);return function(){typeof u=="function"?u():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Lv(s,i,u){u=u!=null?u.concat([s]):null,Hc(4,4,Mv.bind(null,i,s),u)}function ox(){}function Bv(s,i){var u=jr();i=i===void 0?null:i;var h=u.memoizedState;return i!==null&&Qh(i,h[1])?h[0]:(u.memoizedState=[s,i],s)}function Pv(s,i){var u=jr();i=i===void 0?null:i;var h=u.memoizedState;if(i!==null&&Qh(i,h[1]))return h[0];if(h=s(),ll){Nt(!0);try{s()}finally{Nt(!1)}}return u.memoizedState=[h,i],h}function cx(s,i,u){return u===void 0||(ai&1073741824)!==0?s.memoizedState=i:(s.memoizedState=u,s=zy(),gt.lanes|=s,ui|=s,u)}function Iv(s,i,u,h){return Va(u,i)?u:uo.current!==null?(s=cx(s,u,h),Va(s,i)||(qr=!0),s):(ai&42)===0?(qr=!0,s.memoizedState=u):(s=zy(),gt.lanes|=s,ui|=s,i)}function Uv(s,i,u,h,g){var S=le.p;le.p=S!==0&&8>S?S:8;var D=ee.T,B={};ee.T=B,dx(s,!1,i,u);try{var J=g(),fe=ee.S;if(fe!==null&&fe(B,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var _e=c3(J,h);Gc(s,i,_e,Ya(s))}else Gc(s,i,h,Ya(s))}catch(Ne){Gc(s,i,{then:function(){},status:"rejected",reason:Ne},Ya())}finally{le.p=S,ee.T=D}}function x3(){}function ux(s,i,u,h){if(s.tag!==5)throw Error(a(476));var g=zv(s).queue;Uv(s,g,i,ne,u===null?x3:function(){return Hv(s),u(h)})}function zv(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:ne},next:null};var u={};return i.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:u},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Hv(s){var i=zv(s).next.queue;Gc(s,i,{},Ya())}function fx(){return la(l0)}function Gv(){return jr().memoizedState}function Vv(){return jr().memoizedState}function m3(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var u=Ya();s=ti(u);var h=ri(i,s,u);h!==null&&(Ka(h,i,u),Bc(h,i,u)),i={cache:zh()},s.payload=i;return}i=i.return}}function p3(s,i,u){var h=Ya();u={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Ju(s)?Wv(i,u):(u=Rh(s,i,u,h),u!==null&&(Ka(u,s,h),Xv(u,i,h)))}function qv(s,i,u){var h=Ya();Gc(s,i,u,h)}function Gc(s,i,u,h){var g={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ju(s))Wv(i,g);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=i.lastRenderedReducer,S!==null))try{var D=i.lastRenderedState,B=S(D,u);if(g.hasEagerState=!0,g.eagerState=B,Va(B,D))return Lu(s,i,g,0),er===null&&Mu(),!1}catch{}finally{}if(u=Rh(s,i,g,h),u!==null)return Ka(u,s,h),Xv(u,i,h),!0}return!1}function dx(s,i,u,h){if(h={lane:2,revertLane:Vx(),action:h,hasEagerState:!1,eagerState:null,next:null},Ju(s)){if(i)throw Error(a(479))}else i=Rh(s,u,h,2),i!==null&&Ka(i,s,2)}function Ju(s){var i=s.alternate;return s===gt||i!==null&&i===gt}function Wv(s,i){fo=Xu=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function Xv(s,i,u){if((u&4194048)!==0){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,Kn(s,u)}}var ef={readContext:la,use:Yu,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useLayoutEffect:wr,useInsertionEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useSyncExternalStore:wr,useId:wr,useHostTransitionStatus:wr,useFormState:wr,useActionState:wr,useOptimistic:wr,useMemoCache:wr,useCacheRefresh:wr},$v={readContext:la,use:Yu,useCallback:function(s,i){return Fa().memoizedState=[s,i===void 0?null:i],s},useContext:la,useEffect:Rv,useImperativeHandle:function(s,i,u){u=u!=null?u.concat([s]):null,Zu(4194308,4,Mv.bind(null,i,s),u)},useLayoutEffect:function(s,i){return Zu(4194308,4,s,i)},useInsertionEffect:function(s,i){Zu(4,2,s,i)},useMemo:function(s,i){var u=Fa();i=i===void 0?null:i;var h=s();if(ll){Nt(!0);try{s()}finally{Nt(!1)}}return u.memoizedState=[h,i],h},useReducer:function(s,i,u){var h=Fa();if(u!==void 0){var g=u(i);if(ll){Nt(!0);try{u(i)}finally{Nt(!1)}}}else g=i;return h.memoizedState=h.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},h.queue=s,s=s.dispatch=p3.bind(null,gt,s),[h.memoizedState,s]},useRef:function(s){var i=Fa();return s={current:s},i.memoizedState=s},useState:function(s){s=ix(s);var i=s.queue,u=qv.bind(null,gt,i);return i.dispatch=u,[s.memoizedState,u]},useDebugValue:ox,useDeferredValue:function(s,i){var u=Fa();return cx(u,s,i)},useTransition:function(){var s=ix(!1);return s=Uv.bind(null,gt,s.queue,!0,!1),Fa().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,u){var h=gt,g=Fa();if(Ft){if(u===void 0)throw Error(a(407));u=u()}else{if(u=i(),er===null)throw Error(a(349));(Ct&124)!==0||mv(h,i,u)}g.memoizedState=u;var S={value:u,getSnapshot:i};return g.queue=S,Rv(gv.bind(null,h,S,s),[s]),h.flags|=2048,xo(9,Qu(),pv.bind(null,h,S,u,i),null),u},useId:function(){var s=Fa(),i=er.identifierPrefix;if(Ft){var u=ws,h=bs;u=(h&~(1<<32-Mt(h)-1)).toString(32)+u,i=""+i+"R"+u,u=$u++,0<u&&(i+="H"+u.toString(32)),i+=""}else u=u3++,i=""+i+"r"+u.toString(32)+"";return s.memoizedState=i},useHostTransitionStatus:fx,useFormState:Tv,useActionState:Tv,useOptimistic:function(s){var i=Fa();i.memoizedState=i.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=u,i=dx.bind(null,gt,!0,u),u.dispatch=i,[s,i]},useMemoCache:ax,useCacheRefresh:function(){return Fa().memoizedState=m3.bind(null,gt)}},Yv={readContext:la,use:Yu,useCallback:Bv,useContext:la,useEffect:Dv,useImperativeHandle:Lv,useInsertionEffect:Fv,useLayoutEffect:Ov,useMemo:Pv,useReducer:Ku,useRef:jv,useState:function(){return Ku(_s)},useDebugValue:ox,useDeferredValue:function(s,i){var u=jr();return Iv(u,Vt.memoizedState,s,i)},useTransition:function(){var s=Ku(_s)[0],i=jr().memoizedState;return[typeof s=="boolean"?s:zc(s),i]},useSyncExternalStore:xv,useId:Gv,useHostTransitionStatus:fx,useFormState:Nv,useActionState:Nv,useOptimistic:function(s,i){var u=jr();return bv(u,Vt,s,i)},useMemoCache:ax,useCacheRefresh:Vv},g3={readContext:la,use:Yu,useCallback:Bv,useContext:la,useEffect:Dv,useImperativeHandle:Lv,useInsertionEffect:Fv,useLayoutEffect:Ov,useMemo:Pv,useReducer:sx,useRef:jv,useState:function(){return sx(_s)},useDebugValue:ox,useDeferredValue:function(s,i){var u=jr();return Vt===null?cx(u,s,i):Iv(u,Vt.memoizedState,s,i)},useTransition:function(){var s=sx(_s)[0],i=jr().memoizedState;return[typeof s=="boolean"?s:zc(s),i]},useSyncExternalStore:xv,useId:Gv,useHostTransitionStatus:fx,useFormState:Av,useActionState:Av,useOptimistic:function(s,i){var u=jr();return Vt!==null?bv(u,Vt,s,i):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:ax,useCacheRefresh:Vv},mo=null,Vc=0;function tf(s){var i=Vc;return Vc+=1,mo===null&&(mo=[]),iv(mo,s,i)}function qc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function rf(s,i){throw i.$$typeof===p?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Kv(s){var i=s._init;return i(s._payload)}function Qv(s){function i(oe,se){if(s){var ue=oe.deletions;ue===null?(oe.deletions=[se],oe.flags|=16):ue.push(se)}}function u(oe,se){if(!s)return null;for(;se!==null;)i(oe,se),se=se.sibling;return null}function h(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function g(oe,se){return oe=ys(oe,se),oe.index=0,oe.sibling=null,oe}function S(oe,se,ue){return oe.index=ue,s?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<se?(oe.flags|=67108866,se):ue):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function D(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function B(oe,se,ue,ke){return se===null||se.tag!==6?(se=Fh(ue,oe.mode,ke),se.return=oe,se):(se=g(se,ue),se.return=oe,se)}function J(oe,se,ue,ke){var Ge=ue.type;return Ge===b?_e(oe,se,ue.props.children,ke,ue.key):se!==null&&(se.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===C&&Kv(Ge)===se.type)?(se=g(se,ue.props),qc(se,ue),se.return=oe,se):(se=Pu(ue.type,ue.key,ue.props,null,oe.mode,ke),qc(se,ue),se.return=oe,se)}function fe(oe,se,ue,ke){return se===null||se.tag!==4||se.stateNode.containerInfo!==ue.containerInfo||se.stateNode.implementation!==ue.implementation?(se=Oh(ue,oe.mode,ke),se.return=oe,se):(se=g(se,ue.children||[]),se.return=oe,se)}function _e(oe,se,ue,ke,Ge){return se===null||se.tag!==7?(se=Ji(ue,oe.mode,ke,Ge),se.return=oe,se):(se=g(se,ue),se.return=oe,se)}function Ne(oe,se,ue){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Fh(""+se,oe.mode,ue),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case v:return ue=Pu(se.type,se.key,se.props,null,oe.mode,ue),qc(ue,se),ue.return=oe,ue;case y:return se=Oh(se,oe.mode,ue),se.return=oe,se;case C:var ke=se._init;return se=ke(se._payload),Ne(oe,se,ue)}if(ge(se)||H(se))return se=Ji(se,oe.mode,ue,null),se.return=oe,se;if(typeof se.then=="function")return Ne(oe,tf(se),ue);if(se.$$typeof===k)return Ne(oe,Hu(oe,se),ue);rf(oe,se)}return null}function xe(oe,se,ue,ke){var Ge=se!==null?se.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Ge!==null?null:B(oe,se,""+ue,ke);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case v:return ue.key===Ge?J(oe,se,ue,ke):null;case y:return ue.key===Ge?fe(oe,se,ue,ke):null;case C:return Ge=ue._init,ue=Ge(ue._payload),xe(oe,se,ue,ke)}if(ge(ue)||H(ue))return Ge!==null?null:_e(oe,se,ue,ke,null);if(typeof ue.then=="function")return xe(oe,se,tf(ue),ke);if(ue.$$typeof===k)return xe(oe,se,Hu(oe,ue),ke);rf(oe,ue)}return null}function pe(oe,se,ue,ke,Ge){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return oe=oe.get(ue)||null,B(se,oe,""+ke,Ge);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case v:return oe=oe.get(ke.key===null?ue:ke.key)||null,J(se,oe,ke,Ge);case y:return oe=oe.get(ke.key===null?ue:ke.key)||null,fe(se,oe,ke,Ge);case C:var yt=ke._init;return ke=yt(ke._payload),pe(oe,se,ue,ke,Ge)}if(ge(ke)||H(ke))return oe=oe.get(ue)||null,_e(se,oe,ke,Ge,null);if(typeof ke.then=="function")return pe(oe,se,ue,tf(ke),Ge);if(ke.$$typeof===k)return pe(oe,se,ue,Hu(se,ke),Ge);rf(se,ke)}return null}function at(oe,se,ue,ke){for(var Ge=null,yt=null,We=se,Je=se=0,Xr=null;We!==null&&Je<ue.length;Je++){We.index>Je?(Xr=We,We=null):Xr=We.sibling;var Rt=xe(oe,We,ue[Je],ke);if(Rt===null){We===null&&(We=Xr);break}s&&We&&Rt.alternate===null&&i(oe,We),se=S(Rt,se,Je),yt===null?Ge=Rt:yt.sibling=Rt,yt=Rt,We=Xr}if(Je===ue.length)return u(oe,We),Ft&&tl(oe,Je),Ge;if(We===null){for(;Je<ue.length;Je++)We=Ne(oe,ue[Je],ke),We!==null&&(se=S(We,se,Je),yt===null?Ge=We:yt.sibling=We,yt=We);return Ft&&tl(oe,Je),Ge}for(We=h(We);Je<ue.length;Je++)Xr=pe(We,oe,Je,ue[Je],ke),Xr!==null&&(s&&Xr.alternate!==null&&We.delete(Xr.key===null?Je:Xr.key),se=S(Xr,se,Je),yt===null?Ge=Xr:yt.sibling=Xr,yt=Xr);return s&&We.forEach(function(yi){return i(oe,yi)}),Ft&&tl(oe,Je),Ge}function Ze(oe,se,ue,ke){if(ue==null)throw Error(a(151));for(var Ge=null,yt=null,We=se,Je=se=0,Xr=null,Rt=ue.next();We!==null&&!Rt.done;Je++,Rt=ue.next()){We.index>Je?(Xr=We,We=null):Xr=We.sibling;var yi=xe(oe,We,Rt.value,ke);if(yi===null){We===null&&(We=Xr);break}s&&We&&yi.alternate===null&&i(oe,We),se=S(yi,se,Je),yt===null?Ge=yi:yt.sibling=yi,yt=yi,We=Xr}if(Rt.done)return u(oe,We),Ft&&tl(oe,Je),Ge;if(We===null){for(;!Rt.done;Je++,Rt=ue.next())Rt=Ne(oe,Rt.value,ke),Rt!==null&&(se=S(Rt,se,Je),yt===null?Ge=Rt:yt.sibling=Rt,yt=Rt);return Ft&&tl(oe,Je),Ge}for(We=h(We);!Rt.done;Je++,Rt=ue.next())Rt=pe(We,oe,Je,Rt.value,ke),Rt!==null&&(s&&Rt.alternate!==null&&We.delete(Rt.key===null?Je:Rt.key),se=S(Rt,se,Je),yt===null?Ge=Rt:yt.sibling=Rt,yt=Rt);return s&&We.forEach(function(vT){return i(oe,vT)}),Ft&&tl(oe,Je),Ge}function Wt(oe,se,ue,ke){if(typeof ue=="object"&&ue!==null&&ue.type===b&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case v:e:{for(var Ge=ue.key;se!==null;){if(se.key===Ge){if(Ge=ue.type,Ge===b){if(se.tag===7){u(oe,se.sibling),ke=g(se,ue.props.children),ke.return=oe,oe=ke;break e}}else if(se.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===C&&Kv(Ge)===se.type){u(oe,se.sibling),ke=g(se,ue.props),qc(ke,ue),ke.return=oe,oe=ke;break e}u(oe,se);break}else i(oe,se);se=se.sibling}ue.type===b?(ke=Ji(ue.props.children,oe.mode,ke,ue.key),ke.return=oe,oe=ke):(ke=Pu(ue.type,ue.key,ue.props,null,oe.mode,ke),qc(ke,ue),ke.return=oe,oe=ke)}return D(oe);case y:e:{for(Ge=ue.key;se!==null;){if(se.key===Ge)if(se.tag===4&&se.stateNode.containerInfo===ue.containerInfo&&se.stateNode.implementation===ue.implementation){u(oe,se.sibling),ke=g(se,ue.children||[]),ke.return=oe,oe=ke;break e}else{u(oe,se);break}else i(oe,se);se=se.sibling}ke=Oh(ue,oe.mode,ke),ke.return=oe,oe=ke}return D(oe);case C:return Ge=ue._init,ue=Ge(ue._payload),Wt(oe,se,ue,ke)}if(ge(ue))return at(oe,se,ue,ke);if(H(ue)){if(Ge=H(ue),typeof Ge!="function")throw Error(a(150));return ue=Ge.call(ue),Ze(oe,se,ue,ke)}if(typeof ue.then=="function")return Wt(oe,se,tf(ue),ke);if(ue.$$typeof===k)return Wt(oe,se,Hu(oe,ue),ke);rf(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,se!==null&&se.tag===6?(u(oe,se.sibling),ke=g(se,ue),ke.return=oe,oe=ke):(u(oe,se),ke=Fh(ue,oe.mode,ke),ke.return=oe,oe=ke),D(oe)):u(oe,se)}return function(oe,se,ue,ke){try{Vc=0;var Ge=Wt(oe,se,ue,ke);return mo=null,Ge}catch(We){if(We===Mc||We===Vu)throw We;var yt=qa(29,We,null,oe.mode);return yt.lanes=ke,yt.return=oe,yt}finally{}}}var po=Qv(!0),Zv=Qv(!1),hn=Z(null),es=null;function ni(s){var i=s.alternate;P(Br,Br.current&1),P(hn,s),es===null&&(i===null||uo.current!==null||i.memoizedState!==null)&&(es=s)}function Jv(s){if(s.tag===22){if(P(Br,Br.current),P(hn,s),es===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(es=s)}}else si()}function si(){P(Br,Br.current),P(hn,hn.current)}function ks(s){L(hn),es===s&&(es=null),L(Br)}var Br=Z(0);function af(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||rm(u)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function hx(s,i,u,h){i=s.memoizedState,u=u(h,i),u=u==null?i:m({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var xx={enqueueSetState:function(s,i,u){s=s._reactInternals;var h=Ya(),g=ti(h);g.payload=i,u!=null&&(g.callback=u),i=ri(s,g,h),i!==null&&(Ka(i,s,h),Bc(i,s,h))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var h=Ya(),g=ti(h);g.tag=1,g.payload=i,u!=null&&(g.callback=u),i=ri(s,g,h),i!==null&&(Ka(i,s,h),Bc(i,s,h))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=Ya(),h=ti(u);h.tag=2,i!=null&&(h.callback=i),i=ri(s,h,u),i!==null&&(Ka(i,s,u),Bc(i,s,u))}};function ey(s,i,u,h,g,S,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,S,D):i.prototype&&i.prototype.isPureReactComponent?!Nc(u,h)||!Nc(g,S):!0}function ty(s,i,u,h){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,h),i.state!==s&&xx.enqueueReplaceState(i,i.state,null)}function ol(s,i){var u=i;if("ref"in i){u={};for(var h in i)h!=="ref"&&(u[h]=i[h])}if(s=s.defaultProps){u===i&&(u=m({},u));for(var g in s)u[g]===void 0&&(u[g]=s[g])}return u}var nf=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function ry(s){nf(s)}function ay(s){console.error(s)}function ny(s){nf(s)}function sf(s,i){try{var u=s.onUncaughtError;u(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function sy(s,i,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function mx(s,i,u){return u=ti(u),u.tag=3,u.payload={element:null},u.callback=function(){sf(s,i)},u}function iy(s){return s=ti(s),s.tag=3,s}function ly(s,i,u,h){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var S=h.value;s.payload=function(){return g(S)},s.callback=function(){sy(i,u,h)}}var D=u.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(s.callback=function(){sy(i,u,h),typeof g!="function"&&(fi===null?fi=new Set([this]):fi.add(this));var B=h.stack;this.componentDidCatch(h.value,{componentStack:B!==null?B:""})})}function v3(s,i,u,h,g){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=u.alternate,i!==null&&Dc(i,u,g,!0),u=hn.current,u!==null){switch(u.tag){case 13:return es===null?Ix():u.alternate===null&&pr===0&&(pr=3),u.flags&=-257,u.flags|=65536,u.lanes=g,h===Vh?u.flags|=16384:(i=u.updateQueue,i===null?u.updateQueue=new Set([h]):i.add(h),zx(s,h,g)),!1;case 22:return u.flags|=65536,h===Vh?u.flags|=16384:(i=u.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=i):(u=i.retryQueue,u===null?i.retryQueue=new Set([h]):u.add(h)),zx(s,h,g)),!1}throw Error(a(435,u.tag))}return zx(s,h,g),Ix(),!1}if(Ft)return i=hn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,h!==Bh&&(s=Error(a(422),{cause:h}),Rc(cn(s,u)))):(h!==Bh&&(i=Error(a(423),{cause:h}),Rc(cn(i,u))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,h=cn(h,u),g=mx(s.stateNode,h,g),Xh(s,g),pr!==4&&(pr=2)),!1;var S=Error(a(520),{cause:h});if(S=cn(S,u),Zc===null?Zc=[S]:Zc.push(S),pr!==4&&(pr=2),i===null)return!0;h=cn(h,u),u=i;do{switch(u.tag){case 3:return u.flags|=65536,s=g&-g,u.lanes|=s,s=mx(u.stateNode,h,s),Xh(u,s),!1;case 1:if(i=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(fi===null||!fi.has(S))))return u.flags|=65536,g&=-g,u.lanes|=g,g=iy(g),ly(g,s,u,h),Xh(u,g),!1}u=u.return}while(u!==null);return!1}var oy=Error(a(461)),qr=!1;function ta(s,i,u,h){i.child=s===null?Zv(i,null,u,h):po(i,s.child,u,h)}function cy(s,i,u,h,g){u=u.render;var S=i.ref;if("ref"in h){var D={};for(var B in h)B!=="ref"&&(D[B]=h[B])}else D=h;return sl(i),h=Zh(s,i,u,D,S,g),B=Jh(),s!==null&&!qr?(ex(s,i,g),Ts(s,i,g)):(Ft&&B&&Mh(i),i.flags|=1,ta(s,i,h,g),i.child)}function uy(s,i,u,h,g){if(s===null){var S=u.type;return typeof S=="function"&&!Dh(S)&&S.defaultProps===void 0&&u.compare===null?(i.tag=15,i.type=S,fy(s,i,S,h,g)):(s=Pu(u.type,null,h,i,i.mode,g),s.ref=i.ref,s.return=i,i.child=s)}if(S=s.child,!Ex(s,g)){var D=S.memoizedProps;if(u=u.compare,u=u!==null?u:Nc,u(D,h)&&s.ref===i.ref)return Ts(s,i,g)}return i.flags|=1,s=ys(S,h),s.ref=i.ref,s.return=i,i.child=s}function fy(s,i,u,h,g){if(s!==null){var S=s.memoizedProps;if(Nc(S,h)&&s.ref===i.ref)if(qr=!1,i.pendingProps=h=S,Ex(s,g))(s.flags&131072)!==0&&(qr=!0);else return i.lanes=s.lanes,Ts(s,i,g)}return px(s,i,u,h,g)}function dy(s,i,u){var h=i.pendingProps,g=h.children,S=s!==null?s.memoizedState:null;if(h.mode==="hidden"){if((i.flags&128)!==0){if(h=S!==null?S.baseLanes|u:u,s!==null){for(g=i.child=s.child,S=0;g!==null;)S=S|g.lanes|g.childLanes,g=g.sibling;i.childLanes=S&~h}else i.childLanes=0,i.child=null;return hy(s,i,h,u)}if((u&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Gu(i,S!==null?S.cachePool:null),S!==null?fv(i,S):Yh(),Jv(i);else return i.lanes=i.childLanes=536870912,hy(s,i,S!==null?S.baseLanes|u:u,u)}else S!==null?(Gu(i,S.cachePool),fv(i,S),si(),i.memoizedState=null):(s!==null&&Gu(i,null),Yh(),si());return ta(s,i,g,u),i.child}function hy(s,i,u,h){var g=Gh();return g=g===null?null:{parent:Lr._currentValue,pool:g},i.memoizedState={baseLanes:u,cachePool:g},s!==null&&Gu(i,null),Yh(),Jv(i),s!==null&&Dc(s,i,h,!0),null}function lf(s,i){var u=i.ref;if(u===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(a(284));(s===null||s.ref!==u)&&(i.flags|=4194816)}}function px(s,i,u,h,g){return sl(i),u=Zh(s,i,u,h,void 0,g),h=Jh(),s!==null&&!qr?(ex(s,i,g),Ts(s,i,g)):(Ft&&h&&Mh(i),i.flags|=1,ta(s,i,u,g),i.child)}function xy(s,i,u,h,g,S){return sl(i),i.updateQueue=null,u=hv(i,h,u,g),dv(s),h=Jh(),s!==null&&!qr?(ex(s,i,S),Ts(s,i,S)):(Ft&&h&&Mh(i),i.flags|=1,ta(s,i,u,S),i.child)}function my(s,i,u,h,g){if(sl(i),i.stateNode===null){var S=so,D=u.contextType;typeof D=="object"&&D!==null&&(S=la(D)),S=new u(h,S),i.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=xx,i.stateNode=S,S._reactInternals=i,S=i.stateNode,S.props=h,S.state=i.memoizedState,S.refs={},qh(i),D=u.contextType,S.context=typeof D=="object"&&D!==null?la(D):so,S.state=i.memoizedState,D=u.getDerivedStateFromProps,typeof D=="function"&&(hx(i,u,D,h),S.state=i.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(D=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),D!==S.state&&xx.enqueueReplaceState(S,S.state,null),Ic(i,h,S,g),Pc(),S.state=i.memoizedState),typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(s===null){S=i.stateNode;var B=i.memoizedProps,J=ol(u,B);S.props=J;var fe=S.context,_e=u.contextType;D=so,typeof _e=="object"&&_e!==null&&(D=la(_e));var Ne=u.getDerivedStateFromProps;_e=typeof Ne=="function"||typeof S.getSnapshotBeforeUpdate=="function",B=i.pendingProps!==B,_e||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(B||fe!==D)&&ty(i,S,h,D),ei=!1;var xe=i.memoizedState;S.state=xe,Ic(i,h,S,g),Pc(),fe=i.memoizedState,B||xe!==fe||ei?(typeof Ne=="function"&&(hx(i,u,Ne,h),fe=i.memoizedState),(J=ei||ey(i,u,J,h,xe,fe,D))?(_e||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=fe),S.props=h,S.state=fe,S.context=D,h=J):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{S=i.stateNode,Wh(s,i),D=i.memoizedProps,_e=ol(u,D),S.props=_e,Ne=i.pendingProps,xe=S.context,fe=u.contextType,J=so,typeof fe=="object"&&fe!==null&&(J=la(fe)),B=u.getDerivedStateFromProps,(fe=typeof B=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==Ne||xe!==J)&&ty(i,S,h,J),ei=!1,xe=i.memoizedState,S.state=xe,Ic(i,h,S,g),Pc();var pe=i.memoizedState;D!==Ne||xe!==pe||ei||s!==null&&s.dependencies!==null&&zu(s.dependencies)?(typeof B=="function"&&(hx(i,u,B,h),pe=i.memoizedState),(_e=ei||ey(i,u,_e,h,xe,pe,J)||s!==null&&s.dependencies!==null&&zu(s.dependencies))?(fe||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,pe,J),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,pe,J)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||D===s.memoizedProps&&xe===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&xe===s.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=pe),S.props=h,S.state=pe,S.context=J,h=_e):(typeof S.componentDidUpdate!="function"||D===s.memoizedProps&&xe===s.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&xe===s.memoizedState||(i.flags|=1024),h=!1)}return S=h,lf(s,i),h=(i.flags&128)!==0,S||h?(S=i.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:S.render(),i.flags|=1,s!==null&&h?(i.child=po(i,s.child,null,g),i.child=po(i,null,u,g)):ta(s,i,u,g),i.memoizedState=S.state,s=i.child):s=Ts(s,i,g),s}function py(s,i,u,h){return jc(),i.flags|=256,ta(s,i,u,h),i.child}var gx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vx(s){return{baseLanes:s,cachePool:av()}}function yx(s,i,u){return s=s!==null?s.childLanes&~u:0,i&&(s|=xn),s}function gy(s,i,u){var h=i.pendingProps,g=!1,S=(i.flags&128)!==0,D;if((D=S)||(D=s!==null&&s.memoizedState===null?!1:(Br.current&2)!==0),D&&(g=!0,i.flags&=-129),D=(i.flags&32)!==0,i.flags&=-33,s===null){if(Ft){if(g?ni(i):si(),Ft){var B=mr,J;if(J=B){e:{for(J=B,B=Jn;J.nodeType!==8;){if(!B){B=null;break e}if(J=On(J.nextSibling),J===null){B=null;break e}}B=J}B!==null?(i.memoizedState={dehydrated:B,treeContext:el!==null?{id:bs,overflow:ws}:null,retryLane:536870912,hydrationErrors:null},J=qa(18,null,null,0),J.stateNode=B,J.return=i,i.child=J,ba=i,mr=null,J=!0):J=!1}J||al(i)}if(B=i.memoizedState,B!==null&&(B=B.dehydrated,B!==null))return rm(B)?i.lanes=32:i.lanes=536870912,null;ks(i)}return B=h.children,h=h.fallback,g?(si(),g=i.mode,B=of({mode:"hidden",children:B},g),h=Ji(h,g,u,null),B.return=i,h.return=i,B.sibling=h,i.child=B,g=i.child,g.memoizedState=vx(u),g.childLanes=yx(s,D,u),i.memoizedState=gx,h):(ni(i),bx(i,B))}if(J=s.memoizedState,J!==null&&(B=J.dehydrated,B!==null)){if(S)i.flags&256?(ni(i),i.flags&=-257,i=wx(s,i,u)):i.memoizedState!==null?(si(),i.child=s.child,i.flags|=128,i=null):(si(),g=h.fallback,B=i.mode,h=of({mode:"visible",children:h.children},B),g=Ji(g,B,u,null),g.flags|=2,h.return=i,g.return=i,h.sibling=g,i.child=h,po(i,s.child,null,u),h=i.child,h.memoizedState=vx(u),h.childLanes=yx(s,D,u),i.memoizedState=gx,i=g);else if(ni(i),rm(B)){if(D=B.nextSibling&&B.nextSibling.dataset,D)var fe=D.dgst;D=fe,h=Error(a(419)),h.stack="",h.digest=D,Rc({value:h,source:null,stack:null}),i=wx(s,i,u)}else if(qr||Dc(s,i,u,!1),D=(u&s.childLanes)!==0,qr||D){if(D=er,D!==null&&(h=u&-u,h=(h&42)!==0?1:Qn(h),h=(h&(D.suspendedLanes|u))!==0?0:h,h!==0&&h!==J.retryLane))throw J.retryLane=h,no(s,h),Ka(D,s,h),oy;B.data==="$?"||Ix(),i=wx(s,i,u)}else B.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=J.treeContext,mr=On(B.nextSibling),ba=i,Ft=!0,rl=null,Jn=!1,s!==null&&(fn[dn++]=bs,fn[dn++]=ws,fn[dn++]=el,bs=s.id,ws=s.overflow,el=i),i=bx(i,h.children),i.flags|=4096);return i}return g?(si(),g=h.fallback,B=i.mode,J=s.child,fe=J.sibling,h=ys(J,{mode:"hidden",children:h.children}),h.subtreeFlags=J.subtreeFlags&65011712,fe!==null?g=ys(fe,g):(g=Ji(g,B,u,null),g.flags|=2),g.return=i,h.return=i,h.sibling=g,i.child=h,h=g,g=i.child,B=s.child.memoizedState,B===null?B=vx(u):(J=B.cachePool,J!==null?(fe=Lr._currentValue,J=J.parent!==fe?{parent:fe,pool:fe}:J):J=av(),B={baseLanes:B.baseLanes|u,cachePool:J}),g.memoizedState=B,g.childLanes=yx(s,D,u),i.memoizedState=gx,h):(ni(i),u=s.child,s=u.sibling,u=ys(u,{mode:"visible",children:h.children}),u.return=i,u.sibling=null,s!==null&&(D=i.deletions,D===null?(i.deletions=[s],i.flags|=16):D.push(s)),i.child=u,i.memoizedState=null,u)}function bx(s,i){return i=of({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function of(s,i){return s=qa(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function wx(s,i,u){return po(i,s.child,null,u),s=bx(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function vy(s,i,u){s.lanes|=i;var h=s.alternate;h!==null&&(h.lanes|=i),Ih(s.return,i,u)}function Sx(s,i,u,h,g){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:g}:(S.isBackwards=i,S.rendering=null,S.renderingStartTime=0,S.last=h,S.tail=u,S.tailMode=g)}function yy(s,i,u){var h=i.pendingProps,g=h.revealOrder,S=h.tail;if(ta(s,i,h.children,u),h=Br.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&vy(s,u,i);else if(s.tag===19)vy(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}switch(P(Br,h),g){case"forwards":for(u=i.child,g=null;u!==null;)s=u.alternate,s!==null&&af(s)===null&&(g=u),u=u.sibling;u=g,u===null?(g=i.child,i.child=null):(g=u.sibling,u.sibling=null),Sx(i,!1,g,u,S);break;case"backwards":for(u=null,g=i.child,i.child=null;g!==null;){if(s=g.alternate,s!==null&&af(s)===null){i.child=g;break}s=g.sibling,g.sibling=u,u=g,g=s}Sx(i,!0,u,null,S);break;case"together":Sx(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Ts(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),ui|=i.lanes,(u&i.childLanes)===0)if(s!==null){if(Dc(s,i,u,!1),(u&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,u=ys(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=ys(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function Ex(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&zu(s)))}function y3(s,i,u){switch(i.tag){case 3:be(i,i.stateNode.containerInfo),Js(i,Lr,s.memoizedState.cache),jc();break;case 27:case 5:Ae(i);break;case 4:be(i,i.stateNode.containerInfo);break;case 10:Js(i,i.type,i.memoizedProps.value);break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(ni(i),i.flags|=128,null):(u&i.child.childLanes)!==0?gy(s,i,u):(ni(i),s=Ts(s,i,u),s!==null?s.sibling:null);ni(i);break;case 19:var g=(s.flags&128)!==0;if(h=(u&i.childLanes)!==0,h||(Dc(s,i,u,!1),h=(u&i.childLanes)!==0),g){if(h)return yy(s,i,u);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),P(Br,Br.current),h)break;return null;case 22:case 23:return i.lanes=0,dy(s,i,u);case 24:Js(i,Lr,s.memoizedState.cache)}return Ts(s,i,u)}function by(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps)qr=!0;else{if(!Ex(s,u)&&(i.flags&128)===0)return qr=!1,y3(s,i,u);qr=(s.flags&131072)!==0}else qr=!1,Ft&&(i.flags&1048576)!==0&&K1(i,Uu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var h=i.elementType,g=h._init;if(h=g(h._payload),i.type=h,typeof h=="function")Dh(h)?(s=ol(h,s),i.tag=1,i=my(null,i,h,s,u)):(i.tag=0,i=px(null,i,h,s,u));else{if(h!=null){if(g=h.$$typeof,g===F){i.tag=11,i=cy(null,i,h,s,u);break e}else if(g===T){i.tag=14,i=uy(null,i,h,s,u);break e}}throw i=we(h)||h,Error(a(306,i,""))}}return i;case 0:return px(s,i,i.type,i.pendingProps,u);case 1:return h=i.type,g=ol(h,i.pendingProps),my(s,i,h,g,u);case 3:e:{if(be(i,i.stateNode.containerInfo),s===null)throw Error(a(387));h=i.pendingProps;var S=i.memoizedState;g=S.element,Wh(s,i),Ic(i,h,null,u);var D=i.memoizedState;if(h=D.cache,Js(i,Lr,h),h!==S.cache&&Uh(i,[Lr],u,!0),Pc(),h=D.element,S.isDehydrated)if(S={element:h,isDehydrated:!1,cache:D.cache},i.updateQueue.baseState=S,i.memoizedState=S,i.flags&256){i=py(s,i,h,u);break e}else if(h!==g){g=cn(Error(a(424)),i),Rc(g),i=py(s,i,h,u);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mr=On(s.firstChild),ba=i,Ft=!0,rl=null,Jn=!0,u=Zv(i,null,h,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(jc(),h===g){i=Ts(s,i,u);break e}ta(s,i,h,u)}i=i.child}return i;case 26:return lf(s,i),s===null?(u=_2(i.type,null,i.pendingProps,null))?i.memoizedState=u:Ft||(u=i.type,s=i.pendingProps,h=Sf(re.current).createElement(u),h[Gr]=i,h[Vr]=s,aa(h,u,s),ce(h),i.stateNode=h):i.memoizedState=_2(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Ae(i),s===null&&Ft&&(h=i.stateNode=w2(i.type,i.pendingProps,re.current),ba=i,Jn=!0,g=mr,xi(i.type)?(am=g,mr=On(h.firstChild)):mr=g),ta(s,i,i.pendingProps.children,u),lf(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Ft&&((g=h=mr)&&(h=X3(h,i.type,i.pendingProps,Jn),h!==null?(i.stateNode=h,ba=i,mr=On(h.firstChild),Jn=!1,g=!0):g=!1),g||al(i)),Ae(i),g=i.type,S=i.pendingProps,D=s!==null?s.memoizedProps:null,h=S.children,Jx(g,S)?h=null:D!==null&&Jx(g,D)&&(i.flags|=32),i.memoizedState!==null&&(g=Zh(s,i,f3,null,null,u),l0._currentValue=g),lf(s,i),ta(s,i,h,u),i.child;case 6:return s===null&&Ft&&((s=u=mr)&&(u=$3(u,i.pendingProps,Jn),u!==null?(i.stateNode=u,ba=i,mr=null,s=!0):s=!1),s||al(i)),null;case 13:return gy(s,i,u);case 4:return be(i,i.stateNode.containerInfo),h=i.pendingProps,s===null?i.child=po(i,null,h,u):ta(s,i,h,u),i.child;case 11:return cy(s,i,i.type,i.pendingProps,u);case 7:return ta(s,i,i.pendingProps,u),i.child;case 8:return ta(s,i,i.pendingProps.children,u),i.child;case 12:return ta(s,i,i.pendingProps.children,u),i.child;case 10:return h=i.pendingProps,Js(i,i.type,h.value),ta(s,i,h.children,u),i.child;case 9:return g=i.type._context,h=i.pendingProps.children,sl(i),g=la(g),h=h(g),i.flags|=1,ta(s,i,h,u),i.child;case 14:return uy(s,i,i.type,i.pendingProps,u);case 15:return fy(s,i,i.type,i.pendingProps,u);case 19:return yy(s,i,u);case 31:return h=i.pendingProps,u=i.mode,h={mode:h.mode,children:h.children},s===null?(u=of(h,u),u.ref=i.ref,i.child=u,u.return=i,i=u):(u=ys(s.child,h),u.ref=i.ref,i.child=u,u.return=i,i=u),i;case 22:return dy(s,i,u);case 24:return sl(i),h=la(Lr),s===null?(g=Gh(),g===null&&(g=er,S=zh(),g.pooledCache=S,S.refCount++,S!==null&&(g.pooledCacheLanes|=u),g=S),i.memoizedState={parent:h,cache:g},qh(i),Js(i,Lr,g)):((s.lanes&u)!==0&&(Wh(s,i),Ic(i,null,null,u),Pc()),g=s.memoizedState,S=i.memoizedState,g.parent!==h?(g={parent:h,cache:h},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),Js(i,Lr,h)):(h=S.cache,Js(i,Lr,h),h!==g.cache&&Uh(i,[Lr],u,!0))),ta(s,i,i.pendingProps.children,u),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ns(s){s.flags|=4}function wy(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!A2(i)){if(i=hn.current,i!==null&&((Ct&4194048)===Ct?es!==null:(Ct&62914560)!==Ct&&(Ct&536870912)===0||i!==es))throw Lc=Vh,nv;s.flags|=8192}}function cf(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?ot():536870912,s.lanes|=i,bo|=i)}function Wc(s,i){if(!Ft)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function cr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(i)for(var g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=h,s.childLanes=u,i}function b3(s,i,u){var h=i.pendingProps;switch(Lh(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(i),null;case 1:return cr(i),null;case 3:return u=i.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),Es(Lr),Te(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Ac(i)?Ns(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,J1())),cr(i),null;case 26:return u=i.memoizedState,s===null?(Ns(i),u!==null?(cr(i),wy(i,u)):(cr(i),i.flags&=-16777217)):u?u!==s.memoizedState?(Ns(i),cr(i),wy(i,u)):(cr(i),i.flags&=-16777217):(s.memoizedProps!==h&&Ns(i),cr(i),i.flags&=-16777217),null;case 27:Ve(i),u=re.current;var g=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==h&&Ns(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return cr(i),null}s=U.current,Ac(i)?Q1(i):(s=w2(g,h,u),i.stateNode=s,Ns(i))}return cr(i),null;case 5:if(Ve(i),u=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==h&&Ns(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return cr(i),null}if(s=U.current,Ac(i))Q1(i);else{switch(g=Sf(re.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?s.multiple=!0:h.size&&(s.size=h.size);break;default:s=typeof h.is=="string"?g.createElement(u,{is:h.is}):g.createElement(u)}}s[Gr]=i,s[Vr]=h;e:for(g=i.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===i)break e;for(;g.sibling===null;){if(g.return===null||g.return===i)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}i.stateNode=s;e:switch(aa(s,u,h),u){case"button":case"input":case"select":case"textarea":s=!!h.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ns(i)}}return cr(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==h&&Ns(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(a(166));if(s=re.current,Ac(i)){if(s=i.stateNode,u=i.memoizedProps,h=null,g=ba,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}s[Gr]=i,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||x2(s.nodeValue,u)),s||al(i)}else s=Sf(s).createTextNode(h),s[Gr]=i,i.stateNode=s}return cr(i),null;case 13:if(h=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Ac(i),h!==null&&h.dehydrated!==null){if(s===null){if(!g)throw Error(a(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(a(317));g[Gr]=i}else jc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;cr(i),g=!1}else g=J1(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(ks(i),i):(ks(i),null)}if(ks(i),(i.flags&128)!==0)return i.lanes=u,i;if(u=h!==null,s=s!==null&&s.memoizedState!==null,u){h=i.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var S=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),S!==g&&(h.flags|=2048)}return u!==s&&u&&(i.child.flags|=8192),cf(i,i.updateQueue),cr(i),null;case 4:return Te(),s===null&&$x(i.stateNode.containerInfo),cr(i),null;case 10:return Es(i.type),cr(i),null;case 19:if(L(Br),g=i.memoizedState,g===null)return cr(i),null;if(h=(i.flags&128)!==0,S=g.rendering,S===null)if(h)Wc(g,!1);else{if(pr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(S=af(s),S!==null){for(i.flags|=128,Wc(g,!1),s=S.updateQueue,i.updateQueue=s,cf(i,s),i.subtreeFlags=0,s=u,u=i.child;u!==null;)Y1(u,s),u=u.sibling;return P(Br,Br.current&1|2),i.child}s=s.sibling}g.tail!==null&&De()>df&&(i.flags|=128,h=!0,Wc(g,!1),i.lanes=4194304)}else{if(!h)if(s=af(S),s!==null){if(i.flags|=128,h=!0,s=s.updateQueue,i.updateQueue=s,cf(i,s),Wc(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!Ft)return cr(i),null}else 2*De()-g.renderingStartTime>df&&u!==536870912&&(i.flags|=128,h=!0,Wc(g,!1),i.lanes=4194304);g.isBackwards?(S.sibling=i.child,i.child=S):(s=g.last,s!==null?s.sibling=S:i.child=S,g.last=S)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=De(),i.sibling=null,s=Br.current,P(Br,h?s&1|2:s&1),i):(cr(i),null);case 22:case 23:return ks(i),Kh(),h=i.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(u&536870912)!==0&&(i.flags&128)===0&&(cr(i),i.subtreeFlags&6&&(i.flags|=8192)):cr(i),u=i.updateQueue,u!==null&&cf(i,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==u&&(i.flags|=2048),s!==null&&L(il),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Es(Lr),cr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function w3(s,i){switch(Lh(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Es(Lr),Te(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Ve(i),null;case 13:if(ks(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));jc()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return L(Br),null;case 4:return Te(),null;case 10:return Es(i.type),null;case 22:case 23:return ks(i),Kh(),s!==null&&L(il),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Es(Lr),null;case 25:return null;default:return null}}function Sy(s,i){switch(Lh(i),i.tag){case 3:Es(Lr),Te();break;case 26:case 27:case 5:Ve(i);break;case 4:Te();break;case 13:ks(i);break;case 19:L(Br);break;case 10:Es(i.type);break;case 22:case 23:ks(i),Kh(),s!==null&&L(il);break;case 24:Es(Lr)}}function Xc(s,i){try{var u=i.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&s)===s){h=void 0;var S=u.create,D=u.inst;h=S(),D.destroy=h}u=u.next}while(u!==g)}}catch(B){Kt(i,i.return,B)}}function ii(s,i,u){try{var h=i.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var S=g.next;h=S;do{if((h.tag&s)===s){var D=h.inst,B=D.destroy;if(B!==void 0){D.destroy=void 0,g=i;var J=u,fe=B;try{fe()}catch(_e){Kt(g,J,_e)}}}h=h.next}while(h!==S)}}catch(_e){Kt(i,i.return,_e)}}function Ey(s){var i=s.updateQueue;if(i!==null){var u=s.stateNode;try{uv(i,u)}catch(h){Kt(s,s.return,h)}}}function _y(s,i,u){u.props=ol(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Kt(s,i,h)}}function $c(s,i){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(g){Kt(s,i,g)}}function ts(s,i){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(g){Kt(s,i,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){Kt(s,i,g)}else u.current=null}function ky(s){var i=s.type,u=s.memoizedProps,h=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(g){Kt(s,s.return,g)}}function _x(s,i,u){try{var h=s.stateNode;H3(h,s.type,u,i),h[Vr]=i}catch(g){Kt(s,s.return,g)}}function Ty(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&xi(s.type)||s.tag===4}function kx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ty(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&xi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Tx(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,i):(i=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,i.appendChild(s),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=wf));else if(h!==4&&(h===27&&xi(s.type)&&(u=s.stateNode,i=null),s=s.child,s!==null))for(Tx(s,i,u),s=s.sibling;s!==null;)Tx(s,i,u),s=s.sibling}function uf(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(h!==4&&(h===27&&xi(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(uf(s,i,u),s=s.sibling;s!==null;)uf(s,i,u),s=s.sibling}function Ny(s){var i=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);aa(i,h,u),i[Gr]=s,i[Vr]=u}catch(S){Kt(s,s.return,S)}}var Cs=!1,Sr=!1,Nx=!1,Cy=typeof WeakSet=="function"?WeakSet:Set,Wr=null;function S3(s,i){if(s=s.containerInfo,Qx=Cf,s=I1(s),kh(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var g=h.anchorOffset,S=h.focusNode;h=h.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var D=0,B=-1,J=-1,fe=0,_e=0,Ne=s,xe=null;t:for(;;){for(var pe;Ne!==u||g!==0&&Ne.nodeType!==3||(B=D+g),Ne!==S||h!==0&&Ne.nodeType!==3||(J=D+h),Ne.nodeType===3&&(D+=Ne.nodeValue.length),(pe=Ne.firstChild)!==null;)xe=Ne,Ne=pe;for(;;){if(Ne===s)break t;if(xe===u&&++fe===g&&(B=D),xe===S&&++_e===h&&(J=D),(pe=Ne.nextSibling)!==null)break;Ne=xe,xe=Ne.parentNode}Ne=pe}u=B===-1||J===-1?null:{start:B,end:J}}else u=null}u=u||{start:0,end:0}}else u=null;for(Zx={focusedElem:s,selectionRange:u},Cf=!1,Wr=i;Wr!==null;)if(i=Wr,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Wr=s;else for(;Wr!==null;){switch(i=Wr,S=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&S!==null){s=void 0,u=i,g=S.memoizedProps,S=S.memoizedState,h=u.stateNode;try{var at=ol(u.type,g,u.elementType===u.type);s=h.getSnapshotBeforeUpdate(at,S),h.__reactInternalSnapshotBeforeUpdate=s}catch(Ze){Kt(u,u.return,Ze)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,u=s.nodeType,u===9)tm(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":tm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Wr=s;break}Wr=i.return}}function Ay(s,i,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:li(s,u),h&4&&Xc(5,u);break;case 1:if(li(s,u),h&4)if(s=u.stateNode,i===null)try{s.componentDidMount()}catch(D){Kt(u,u.return,D)}else{var g=ol(u.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(g,i,s.__reactInternalSnapshotBeforeUpdate)}catch(D){Kt(u,u.return,D)}}h&64&&Ey(u),h&512&&$c(u,u.return);break;case 3:if(li(s,u),h&64&&(s=u.updateQueue,s!==null)){if(i=null,u.child!==null)switch(u.child.tag){case 27:case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}try{uv(s,i)}catch(D){Kt(u,u.return,D)}}break;case 27:i===null&&h&4&&Ny(u);case 26:case 5:li(s,u),i===null&&h&4&&ky(u),h&512&&$c(u,u.return);break;case 12:li(s,u);break;case 13:li(s,u),h&4&&Dy(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=R3.bind(null,u),Y3(s,u))));break;case 22:if(h=u.memoizedState!==null||Cs,!h){i=i!==null&&i.memoizedState!==null||Sr,g=Cs;var S=Sr;Cs=h,(Sr=i)&&!S?oi(s,u,(u.subtreeFlags&8772)!==0):li(s,u),Cs=g,Sr=S}break;case 30:break;default:li(s,u)}}function jy(s){var i=s.alternate;i!==null&&(s.alternate=null,jy(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&q(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ir=null,Oa=!1;function As(s,i,u){for(u=u.child;u!==null;)Ry(s,i,u),u=u.sibling}function Ry(s,i,u){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Cr,u)}catch{}switch(u.tag){case 26:Sr||ts(u,i),As(s,i,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Sr||ts(u,i);var h=ir,g=Oa;xi(u.type)&&(ir=u.stateNode,Oa=!1),As(s,i,u),a0(u.stateNode),ir=h,Oa=g;break;case 5:Sr||ts(u,i);case 6:if(h=ir,g=Oa,ir=null,As(s,i,u),ir=h,Oa=g,ir!==null)if(Oa)try{(ir.nodeType===9?ir.body:ir.nodeName==="HTML"?ir.ownerDocument.body:ir).removeChild(u.stateNode)}catch(S){Kt(u,i,S)}else try{ir.removeChild(u.stateNode)}catch(S){Kt(u,i,S)}break;case 18:ir!==null&&(Oa?(s=ir,y2(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),f0(s)):y2(ir,u.stateNode));break;case 4:h=ir,g=Oa,ir=u.stateNode.containerInfo,Oa=!0,As(s,i,u),ir=h,Oa=g;break;case 0:case 11:case 14:case 15:Sr||ii(2,u,i),Sr||ii(4,u,i),As(s,i,u);break;case 1:Sr||(ts(u,i),h=u.stateNode,typeof h.componentWillUnmount=="function"&&_y(u,i,h)),As(s,i,u);break;case 21:As(s,i,u);break;case 22:Sr=(h=Sr)||u.memoizedState!==null,As(s,i,u),Sr=h;break;default:As(s,i,u)}}function Dy(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{f0(s)}catch(u){Kt(i,i.return,u)}}function E3(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new Cy),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new Cy),i;default:throw Error(a(435,s.tag))}}function Cx(s,i){var u=E3(s);i.forEach(function(h){var g=D3.bind(null,s,h);u.has(h)||(u.add(h),h.then(g,g))})}function Wa(s,i){var u=i.deletions;if(u!==null)for(var h=0;h<u.length;h++){var g=u[h],S=s,D=i,B=D;e:for(;B!==null;){switch(B.tag){case 27:if(xi(B.type)){ir=B.stateNode,Oa=!1;break e}break;case 5:ir=B.stateNode,Oa=!1;break e;case 3:case 4:ir=B.stateNode.containerInfo,Oa=!0;break e}B=B.return}if(ir===null)throw Error(a(160));Ry(S,D,g),ir=null,Oa=!1,S=g.alternate,S!==null&&(S.return=null),g.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)Fy(i,s),i=i.sibling}var Fn=null;function Fy(s,i){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wa(i,s),Xa(s),h&4&&(ii(3,s,s.return),Xc(3,s),ii(5,s,s.return));break;case 1:Wa(i,s),Xa(s),h&512&&(Sr||u===null||ts(u,u.return)),h&64&&Cs&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var g=Fn;if(Wa(i,s),Xa(s),h&512&&(Sr||u===null||ts(u,u.return)),h&4){var S=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){e:{h=s.type,u=s.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":S=g.getElementsByTagName("title")[0],(!S||S[G]||S[Gr]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=g.createElement(h),g.head.insertBefore(S,g.querySelector("head > title"))),aa(S,h,u),S[Gr]=s,ce(S),h=S;break e;case"link":var D=N2("link","href",g).get(h+(u.href||""));if(D){for(var B=0;B<D.length;B++)if(S=D[B],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){D.splice(B,1);break t}}S=g.createElement(h),aa(S,h,u),g.head.appendChild(S);break;case"meta":if(D=N2("meta","content",g).get(h+(u.content||""))){for(B=0;B<D.length;B++)if(S=D[B],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){D.splice(B,1);break t}}S=g.createElement(h),aa(S,h,u),g.head.appendChild(S);break;default:throw Error(a(468,h))}S[Gr]=s,ce(S),h=S}s.stateNode=h}else C2(g,s.type,s.stateNode);else s.stateNode=T2(g,h,s.memoizedProps);else S!==h?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,h===null?C2(g,s.type,s.stateNode):T2(g,h,s.memoizedProps)):h===null&&s.stateNode!==null&&_x(s,s.memoizedProps,u.memoizedProps)}break;case 27:Wa(i,s),Xa(s),h&512&&(Sr||u===null||ts(u,u.return)),u!==null&&h&4&&_x(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Wa(i,s),Xa(s),h&512&&(Sr||u===null||ts(u,u.return)),s.flags&32){g=s.stateNode;try{Ql(g,"")}catch(pe){Kt(s,s.return,pe)}}h&4&&s.stateNode!=null&&(g=s.memoizedProps,_x(s,g,u!==null?u.memoizedProps:g)),h&1024&&(Nx=!0);break;case 6:if(Wa(i,s),Xa(s),h&4){if(s.stateNode===null)throw Error(a(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(pe){Kt(s,s.return,pe)}}break;case 3:if(kf=null,g=Fn,Fn=Ef(i.containerInfo),Wa(i,s),Fn=g,Xa(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{f0(i.containerInfo)}catch(pe){Kt(s,s.return,pe)}Nx&&(Nx=!1,Oy(s));break;case 4:h=Fn,Fn=Ef(s.stateNode.containerInfo),Wa(i,s),Xa(s),Fn=h;break;case 12:Wa(i,s),Xa(s);break;case 13:Wa(i,s),Xa(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ox=De()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Cx(s,h)));break;case 22:g=s.memoizedState!==null;var J=u!==null&&u.memoizedState!==null,fe=Cs,_e=Sr;if(Cs=fe||g,Sr=_e||J,Wa(i,s),Sr=_e,Cs=fe,Xa(s),h&8192)e:for(i=s.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(u===null||J||Cs||Sr||cl(s)),u=null,i=s;;){if(i.tag===5||i.tag===26){if(u===null){J=u=i;try{if(S=J.stateNode,g)D=S.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{B=J.stateNode;var Ne=J.memoizedProps.style,xe=Ne!=null&&Ne.hasOwnProperty("display")?Ne.display:null;B.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(pe){Kt(J,J.return,pe)}}}else if(i.tag===6){if(u===null){J=i;try{J.stateNode.nodeValue=g?"":J.memoizedProps}catch(pe){Kt(J,J.return,pe)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;u===i&&(u=null),i=i.return}u===i&&(u=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Cx(s,u))));break;case 19:Wa(i,s),Xa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Cx(s,h)));break;case 30:break;case 21:break;default:Wa(i,s),Xa(s)}}function Xa(s){var i=s.flags;if(i&2){try{for(var u,h=s.return;h!==null;){if(Ty(h)){u=h;break}h=h.return}if(u==null)throw Error(a(160));switch(u.tag){case 27:var g=u.stateNode,S=kx(s);uf(s,S,g);break;case 5:var D=u.stateNode;u.flags&32&&(Ql(D,""),u.flags&=-33);var B=kx(s);uf(s,B,D);break;case 3:case 4:var J=u.stateNode.containerInfo,fe=kx(s);Tx(s,fe,J);break;default:throw Error(a(161))}}catch(_e){Kt(s,s.return,_e)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Oy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Oy(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function li(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Ay(s,i.alternate,i),i=i.sibling}function cl(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:ii(4,i,i.return),cl(i);break;case 1:ts(i,i.return);var u=i.stateNode;typeof u.componentWillUnmount=="function"&&_y(i,i.return,u),cl(i);break;case 27:a0(i.stateNode);case 26:case 5:ts(i,i.return),cl(i);break;case 22:i.memoizedState===null&&cl(i);break;case 30:cl(i);break;default:cl(i)}s=s.sibling}}function oi(s,i,u){for(u=u&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,g=s,S=i,D=S.flags;switch(S.tag){case 0:case 11:case 15:oi(g,S,u),Xc(4,S);break;case 1:if(oi(g,S,u),h=S,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(fe){Kt(h,h.return,fe)}if(h=S,g=h.updateQueue,g!==null){var B=h.stateNode;try{var J=g.shared.hiddenCallbacks;if(J!==null)for(g.shared.hiddenCallbacks=null,g=0;g<J.length;g++)cv(J[g],B)}catch(fe){Kt(h,h.return,fe)}}u&&D&64&&Ey(S),$c(S,S.return);break;case 27:Ny(S);case 26:case 5:oi(g,S,u),u&&h===null&&D&4&&ky(S),$c(S,S.return);break;case 12:oi(g,S,u);break;case 13:oi(g,S,u),u&&D&4&&Dy(g,S);break;case 22:S.memoizedState===null&&oi(g,S,u),$c(S,S.return);break;case 30:break;default:oi(g,S,u)}i=i.sibling}}function Ax(s,i){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Fc(u))}function jx(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Fc(s))}function rs(s,i,u,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)My(s,i,u,h),i=i.sibling}function My(s,i,u,h){var g=i.flags;switch(i.tag){case 0:case 11:case 15:rs(s,i,u,h),g&2048&&Xc(9,i);break;case 1:rs(s,i,u,h);break;case 3:rs(s,i,u,h),g&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Fc(s)));break;case 12:if(g&2048){rs(s,i,u,h),s=i.stateNode;try{var S=i.memoizedProps,D=S.id,B=S.onPostCommit;typeof B=="function"&&B(D,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Kt(i,i.return,J)}}else rs(s,i,u,h);break;case 13:rs(s,i,u,h);break;case 23:break;case 22:S=i.stateNode,D=i.alternate,i.memoizedState!==null?S._visibility&2?rs(s,i,u,h):Yc(s,i):S._visibility&2?rs(s,i,u,h):(S._visibility|=2,go(s,i,u,h,(i.subtreeFlags&10256)!==0)),g&2048&&Ax(D,i);break;case 24:rs(s,i,u,h),g&2048&&jx(i.alternate,i);break;default:rs(s,i,u,h)}}function go(s,i,u,h,g){for(g=g&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var S=s,D=i,B=u,J=h,fe=D.flags;switch(D.tag){case 0:case 11:case 15:go(S,D,B,J,g),Xc(8,D);break;case 23:break;case 22:var _e=D.stateNode;D.memoizedState!==null?_e._visibility&2?go(S,D,B,J,g):Yc(S,D):(_e._visibility|=2,go(S,D,B,J,g)),g&&fe&2048&&Ax(D.alternate,D);break;case 24:go(S,D,B,J,g),g&&fe&2048&&jx(D.alternate,D);break;default:go(S,D,B,J,g)}i=i.sibling}}function Yc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var u=s,h=i,g=h.flags;switch(h.tag){case 22:Yc(u,h),g&2048&&Ax(h.alternate,h);break;case 24:Yc(u,h),g&2048&&jx(h.alternate,h);break;default:Yc(u,h)}i=i.sibling}}var Kc=8192;function vo(s){if(s.subtreeFlags&Kc)for(s=s.child;s!==null;)Ly(s),s=s.sibling}function Ly(s){switch(s.tag){case 26:vo(s),s.flags&Kc&&s.memoizedState!==null&&oT(Fn,s.memoizedState,s.memoizedProps);break;case 5:vo(s);break;case 3:case 4:var i=Fn;Fn=Ef(s.stateNode.containerInfo),vo(s),Fn=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Kc,Kc=16777216,vo(s),Kc=i):vo(s));break;default:vo(s)}}function By(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Qc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var h=i[u];Wr=h,Iy(h,s)}By(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Py(s),s=s.sibling}function Py(s){switch(s.tag){case 0:case 11:case 15:Qc(s),s.flags&2048&&ii(9,s,s.return);break;case 3:Qc(s);break;case 12:Qc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,ff(s)):Qc(s);break;default:Qc(s)}}function ff(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var h=i[u];Wr=h,Iy(h,s)}By(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:ii(8,i,i.return),ff(i);break;case 22:u=i.stateNode,u._visibility&2&&(u._visibility&=-3,ff(i));break;default:ff(i)}s=s.sibling}}function Iy(s,i){for(;Wr!==null;){var u=Wr;switch(u.tag){case 0:case 11:case 15:ii(8,u,i);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Fc(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Wr=h;else e:for(u=s;Wr!==null;){h=Wr;var g=h.sibling,S=h.return;if(jy(h),h===u){Wr=null;break e}if(g!==null){g.return=S,Wr=g;break e}Wr=S}}}var _3={getCacheForType:function(s){var i=la(Lr),u=i.data.get(s);return u===void 0&&(u=s(),i.data.set(s,u)),u}},k3=typeof WeakMap=="function"?WeakMap:Map,Bt=0,er=null,Et=null,Ct=0,Pt=0,$a=null,ci=!1,yo=!1,Rx=!1,js=0,pr=0,ui=0,ul=0,Dx=0,xn=0,bo=0,Zc=null,Ma=null,Fx=!1,Ox=0,df=1/0,hf=null,fi=null,ra=0,di=null,wo=null,So=0,Mx=0,Lx=null,Uy=null,Jc=0,Bx=null;function Ya(){if((Bt&2)!==0&&Ct!==0)return Ct&-Ct;if(ee.T!==null){var s=oo;return s!==0?s:Vx()}return ku()}function zy(){xn===0&&(xn=(Ct&536870912)===0||Ft?qe():536870912);var s=hn.current;return s!==null&&(s.flags|=32),xn}function Ka(s,i,u){(s===er&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)&&(Eo(s,0),hi(s,Ct,xn,!1)),ea(s,u),((Bt&2)===0||s!==er)&&(s===er&&((Bt&2)===0&&(ul|=u),pr===4&&hi(s,Ct,xn,!1)),as(s))}function Hy(s,i,u){if((Bt&6)!==0)throw Error(a(327));var h=!u&&(i&124)===0&&(i&s.expiredLanes)===0||Ue(s,i),g=h?C3(s,i):Ux(s,i,!0),S=h;do{if(g===0){yo&&!h&&hi(s,i,0,!1);break}else{if(u=s.current.alternate,S&&!T3(u)){g=Ux(s,i,!1),S=!1;continue}if(g===2){if(S=i,s.errorRecoveryDisabledLanes&S)var D=0;else D=s.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){i=D;e:{var B=s;g=Zc;var J=B.current.memoizedState.isDehydrated;if(J&&(Eo(B,D).flags|=256),D=Ux(B,D,!1),D!==2){if(Rx&&!J){B.errorRecoveryDisabledLanes|=S,ul|=S,g=4;break e}S=Ma,Ma=g,S!==null&&(Ma===null?Ma=S:Ma.push.apply(Ma,S))}g=D}if(S=!1,g!==2)continue}}if(g===1){Eo(s,0),hi(s,i,0,!0);break}e:{switch(h=s,S=g,S){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:hi(h,i,xn,!ci);break e;case 2:Ma=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(g=Ox+300-De(),10<g)){if(hi(h,i,xn,!ci),Oe(h,0,!0)!==0)break e;h.timeoutHandle=g2(Gy.bind(null,h,u,Ma,hf,Fx,i,xn,ul,bo,ci,S,2,-0,0),g);break e}Gy(h,u,Ma,hf,Fx,i,xn,ul,bo,ci,S,0,-0,0)}}break}while(!0);as(s)}function Gy(s,i,u,h,g,S,D,B,J,fe,_e,Ne,xe,pe){if(s.timeoutHandle=-1,Ne=i.subtreeFlags,(Ne&8192||(Ne&16785408)===16785408)&&(i0={stylesheets:null,count:0,unsuspend:lT},Ly(i),Ne=cT(),Ne!==null)){s.cancelPendingCommit=Ne(Ky.bind(null,s,i,S,u,h,g,D,B,J,_e,1,xe,pe)),hi(s,S,D,!fe);return}Ky(s,i,S,u,h,g,D,B,J)}function T3(s){for(var i=s;;){var u=i.tag;if((u===0||u===11||u===15)&&i.flags&16384&&(u=i.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var g=u[h],S=g.getSnapshot;g=g.value;try{if(!Va(S(),g))return!1}catch{return!1}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function hi(s,i,u,h){i&=~Dx,i&=~ul,s.suspendedLanes|=i,s.pingedLanes&=~i,h&&(s.warmLanes|=i),h=s.expirationTimes;for(var g=i;0<g;){var S=31-Mt(g),D=1<<S;h[S]=-1,g&=~D}u!==0&&Yn(s,u,i)}function xf(){return(Bt&6)===0?(e0(0),!1):!0}function Px(){if(Et!==null){if(Pt===0)var s=Et.return;else s=Et,Ss=nl=null,tx(s),mo=null,Vc=0,s=Et;for(;s!==null;)Sy(s.alternate,s),s=s.return;Et=null}}function Eo(s,i){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,V3(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Px(),er=s,Et=u=ys(s.current,null),Ct=i,Pt=0,$a=null,ci=!1,yo=Ue(s,i),Rx=!1,bo=xn=Dx=ul=ui=pr=0,Ma=Zc=null,Fx=!1,(i&8)!==0&&(i|=i&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=i;0<h;){var g=31-Mt(h),S=1<<g;i|=s[g],h&=~S}return js=i,Mu(),u}function Vy(s,i){gt=null,ee.H=ef,i===Mc||i===Vu?(i=lv(),Pt=3):i===nv?(i=lv(),Pt=4):Pt=i===oy?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,$a=i,Et===null&&(pr=1,sf(s,cn(i,s.current)))}function qy(){var s=ee.H;return ee.H=ef,s===null?ef:s}function Wy(){var s=ee.A;return ee.A=_3,s}function Ix(){pr=4,ci||(Ct&4194048)!==Ct&&hn.current!==null||(yo=!0),(ui&134217727)===0&&(ul&134217727)===0||er===null||hi(er,Ct,xn,!1)}function Ux(s,i,u){var h=Bt;Bt|=2;var g=qy(),S=Wy();(er!==s||Ct!==i)&&(hf=null,Eo(s,i)),i=!1;var D=pr;e:do try{if(Pt!==0&&Et!==null){var B=Et,J=$a;switch(Pt){case 8:Px(),D=6;break e;case 3:case 2:case 9:case 6:hn.current===null&&(i=!0);var fe=Pt;if(Pt=0,$a=null,_o(s,B,J,fe),u&&yo){D=0;break e}break;default:fe=Pt,Pt=0,$a=null,_o(s,B,J,fe)}}N3(),D=pr;break}catch(_e){Vy(s,_e)}while(!0);return i&&s.shellSuspendCounter++,Ss=nl=null,Bt=h,ee.H=g,ee.A=S,Et===null&&(er=null,Ct=0,Mu()),D}function N3(){for(;Et!==null;)Xy(Et)}function C3(s,i){var u=Bt;Bt|=2;var h=qy(),g=Wy();er!==s||Ct!==i?(hf=null,df=De()+500,Eo(s,i)):yo=Ue(s,i);e:do try{if(Pt!==0&&Et!==null){i=Et;var S=$a;t:switch(Pt){case 1:Pt=0,$a=null,_o(s,i,S,1);break;case 2:case 9:if(sv(S)){Pt=0,$a=null,$y(i);break}i=function(){Pt!==2&&Pt!==9||er!==s||(Pt=7),as(s)},S.then(i,i);break e;case 3:Pt=7;break e;case 4:Pt=5;break e;case 7:sv(S)?(Pt=0,$a=null,$y(i)):(Pt=0,$a=null,_o(s,i,S,7));break;case 5:var D=null;switch(Et.tag){case 26:D=Et.memoizedState;case 5:case 27:var B=Et;if(!D||A2(D)){Pt=0,$a=null;var J=B.sibling;if(J!==null)Et=J;else{var fe=B.return;fe!==null?(Et=fe,mf(fe)):Et=null}break t}}Pt=0,$a=null,_o(s,i,S,5);break;case 6:Pt=0,$a=null,_o(s,i,S,6);break;case 8:Px(),pr=6;break e;default:throw Error(a(462))}}A3();break}catch(_e){Vy(s,_e)}while(!0);return Ss=nl=null,ee.H=h,ee.A=g,Bt=u,Et!==null?0:(er=null,Ct=0,Mu(),pr)}function A3(){for(;Et!==null&&!Qe();)Xy(Et)}function Xy(s){var i=by(s.alternate,s,js);s.memoizedProps=s.pendingProps,i===null?mf(s):Et=i}function $y(s){var i=s,u=i.alternate;switch(i.tag){case 15:case 0:i=xy(u,i,i.pendingProps,i.type,void 0,Ct);break;case 11:i=xy(u,i,i.pendingProps,i.type.render,i.ref,Ct);break;case 5:tx(i);default:Sy(u,i),i=Et=Y1(i,js),i=by(u,i,js)}s.memoizedProps=s.pendingProps,i===null?mf(s):Et=i}function _o(s,i,u,h){Ss=nl=null,tx(i),mo=null,Vc=0;var g=i.return;try{if(v3(s,g,i,u,Ct)){pr=1,sf(s,cn(u,s.current)),Et=null;return}}catch(S){if(g!==null)throw Et=g,S;pr=1,sf(s,cn(u,s.current)),Et=null;return}i.flags&32768?(Ft||h===1?s=!0:yo||(Ct&536870912)!==0?s=!1:(ci=s=!0,(h===2||h===9||h===3||h===6)&&(h=hn.current,h!==null&&h.tag===13&&(h.flags|=16384))),Yy(i,s)):mf(i)}function mf(s){var i=s;do{if((i.flags&32768)!==0){Yy(i,ci);return}s=i.return;var u=b3(i.alternate,i,js);if(u!==null){Et=u;return}if(i=i.sibling,i!==null){Et=i;return}Et=i=s}while(i!==null);pr===0&&(pr=5)}function Yy(s,i){do{var u=w3(s.alternate,s);if(u!==null){u.flags&=32767,Et=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!i&&(s=s.sibling,s!==null)){Et=s;return}Et=s=u}while(s!==null);pr=6,Et=null}function Ky(s,i,u,h,g,S,D,B,J){s.cancelPendingCommit=null;do pf();while(ra!==0);if((Bt&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(S=i.lanes|i.childLanes,S|=jh,nn(s,u,S,D,B,J),s===er&&(Et=er=null,Ct=0),wo=i,di=s,So=u,Mx=S,Lx=g,Uy=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,F3(hr,function(){return t2(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=ee.T,ee.T=null,g=le.p,le.p=2,D=Bt,Bt|=4;try{S3(s,i,u)}finally{Bt=D,le.p=g,ee.T=h}}ra=1,Qy(),Zy(),Jy()}}function Qy(){if(ra===1){ra=0;var s=di,i=wo,u=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null;var h=le.p;le.p=2;var g=Bt;Bt|=4;try{Fy(i,s);var S=Zx,D=I1(s.containerInfo),B=S.focusedElem,J=S.selectionRange;if(D!==B&&B&&B.ownerDocument&&P1(B.ownerDocument.documentElement,B)){if(J!==null&&kh(B)){var fe=J.start,_e=J.end;if(_e===void 0&&(_e=fe),"selectionStart"in B)B.selectionStart=fe,B.selectionEnd=Math.min(_e,B.value.length);else{var Ne=B.ownerDocument||document,xe=Ne&&Ne.defaultView||window;if(xe.getSelection){var pe=xe.getSelection(),at=B.textContent.length,Ze=Math.min(J.start,at),Wt=J.end===void 0?Ze:Math.min(J.end,at);!pe.extend&&Ze>Wt&&(D=Wt,Wt=Ze,Ze=D);var oe=B1(B,Ze),se=B1(B,Wt);if(oe&&se&&(pe.rangeCount!==1||pe.anchorNode!==oe.node||pe.anchorOffset!==oe.offset||pe.focusNode!==se.node||pe.focusOffset!==se.offset)){var ue=Ne.createRange();ue.setStart(oe.node,oe.offset),pe.removeAllRanges(),Ze>Wt?(pe.addRange(ue),pe.extend(se.node,se.offset)):(ue.setEnd(se.node,se.offset),pe.addRange(ue))}}}}for(Ne=[],pe=B;pe=pe.parentNode;)pe.nodeType===1&&Ne.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Ne.length;B++){var ke=Ne[B];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Cf=!!Qx,Zx=Qx=null}finally{Bt=g,le.p=h,ee.T=u}}s.current=i,ra=2}}function Zy(){if(ra===2){ra=0;var s=di,i=wo,u=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||u){u=ee.T,ee.T=null;var h=le.p;le.p=2;var g=Bt;Bt|=4;try{Ay(s,i.alternate,i)}finally{Bt=g,le.p=h,ee.T=u}}ra=3}}function Jy(){if(ra===4||ra===3){ra=0,tt();var s=di,i=wo,u=So,h=Uy;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ra=5:(ra=0,wo=di=null,e2(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(fi=null),vc(u),i=i.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Cr,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=ee.T,g=le.p,le.p=2,ee.T=null;try{for(var S=s.onRecoverableError,D=0;D<h.length;D++){var B=h[D];S(B.value,{componentStack:B.stack})}}finally{ee.T=i,le.p=g}}(So&3)!==0&&pf(),as(s),g=s.pendingLanes,(u&4194090)!==0&&(g&42)!==0?s===Bx?Jc++:(Jc=0,Bx=s):Jc=0,e0(0)}}function e2(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Fc(i)))}function pf(s){return Qy(),Zy(),Jy(),t2()}function t2(){if(ra!==5)return!1;var s=di,i=Mx;Mx=0;var u=vc(So),h=ee.T,g=le.p;try{le.p=32>u?32:u,ee.T=null,u=Lx,Lx=null;var S=di,D=So;if(ra=0,wo=di=null,So=0,(Bt&6)!==0)throw Error(a(331));var B=Bt;if(Bt|=4,Py(S.current),My(S,S.current,D,u),Bt=B,e0(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Cr,S)}catch{}return!0}finally{le.p=g,ee.T=h,e2(s,i)}}function r2(s,i,u){i=cn(u,i),i=mx(s.stateNode,i,2),s=ri(s,i,2),s!==null&&(ea(s,2),as(s))}function Kt(s,i,u){if(s.tag===3)r2(s,s,u);else for(;i!==null;){if(i.tag===3){r2(i,s,u);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(fi===null||!fi.has(h))){s=cn(u,s),u=iy(2),h=ri(i,u,2),h!==null&&(ly(u,h,i,s),ea(h,2),as(h));break}}i=i.return}}function zx(s,i,u){var h=s.pingCache;if(h===null){h=s.pingCache=new k3;var g=new Set;h.set(i,g)}else g=h.get(i),g===void 0&&(g=new Set,h.set(i,g));g.has(u)||(Rx=!0,g.add(u),s=j3.bind(null,s,i,u),i.then(s,s))}function j3(s,i,u){var h=s.pingCache;h!==null&&h.delete(i),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,er===s&&(Ct&u)===u&&(pr===4||pr===3&&(Ct&62914560)===Ct&&300>De()-Ox?(Bt&2)===0&&Eo(s,0):Dx|=u,bo===Ct&&(bo=0)),as(s)}function a2(s,i){i===0&&(i=ot()),s=no(s,i),s!==null&&(ea(s,i),as(s))}function R3(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),a2(s,u)}function D3(s,i){var u=0;switch(s.tag){case 13:var h=s.stateNode,g=s.memoizedState;g!==null&&(u=g.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(i),a2(s,u)}function F3(s,i){return st(s,i)}var gf=null,ko=null,Hx=!1,vf=!1,Gx=!1,fl=0;function as(s){s!==ko&&s.next===null&&(ko===null?gf=ko=s:ko=ko.next=s),vf=!0,Hx||(Hx=!0,M3())}function e0(s,i){if(!Gx&&vf){Gx=!0;do for(var u=!1,h=gf;h!==null;){if(s!==0){var g=h.pendingLanes;if(g===0)var S=0;else{var D=h.suspendedLanes,B=h.pingedLanes;S=(1<<31-Mt(42|s)+1)-1,S&=g&~(D&~B),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,l2(h,S))}else S=Ct,S=Oe(h,h===er?S:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(S&3)===0||Ue(h,S)||(u=!0,l2(h,S));h=h.next}while(u);Gx=!1}}function O3(){n2()}function n2(){vf=Hx=!1;var s=0;fl!==0&&(G3()&&(s=fl),fl=0);for(var i=De(),u=null,h=gf;h!==null;){var g=h.next,S=s2(h,i);S===0?(h.next=null,u===null?gf=g:u.next=g,g===null&&(ko=u)):(u=h,(s!==0||(S&3)!==0)&&(vf=!0)),h=g}e0(s)}function s2(s,i){for(var u=s.suspendedLanes,h=s.pingedLanes,g=s.expirationTimes,S=s.pendingLanes&-62914561;0<S;){var D=31-Mt(S),B=1<<D,J=g[D];J===-1?((B&u)===0||(B&h)!==0)&&(g[D]=Ye(B,i)):J<=i&&(s.expiredLanes|=B),S&=~B}if(i=er,u=Ct,u=Oe(s,s===i?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===i&&(Pt===2||Pt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&it(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Ue(s,u)){if(i=u&-u,i===s.callbackPriority)return i;switch(h!==null&&it(h),vc(u)){case 2:case 8:u=Zr;break;case 32:u=hr;break;case 268435456:u=ya;break;default:u=hr}return h=i2.bind(null,s),u=st(u,h),s.callbackPriority=i,s.callbackNode=u,i}return h!==null&&h!==null&&it(h),s.callbackPriority=2,s.callbackNode=null,2}function i2(s,i){if(ra!==0&&ra!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(pf()&&s.callbackNode!==u)return null;var h=Ct;return h=Oe(s,s===er?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(Hy(s,h,i),s2(s,De()),s.callbackNode!=null&&s.callbackNode===u?i2.bind(null,s):null)}function l2(s,i){if(pf())return null;Hy(s,i,!0)}function M3(){q3(function(){(Bt&6)!==0?st(dr,O3):n2()})}function Vx(){return fl===0&&(fl=qe()),fl}function o2(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Cu(""+s)}function c2(s,i){var u=i.ownerDocument.createElement("input");return u.name=i.name,u.value=i.value,s.id&&u.setAttribute("form",s.id),i.parentNode.insertBefore(u,i),s=new FormData(s),u.parentNode.removeChild(u),s}function L3(s,i,u,h,g){if(i==="submit"&&u&&u.stateNode===g){var S=o2((g[Vr]||null).action),D=h.submitter;D&&(i=(i=D[Vr]||null)?o2(i.formAction):D.getAttribute("formAction"),i!==null&&(S=i,D=null));var B=new Du("action","action",null,h,g);s.push({event:B,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(fl!==0){var J=D?c2(g,D):new FormData(g);ux(u,{pending:!0,data:J,method:g.method,action:S},null,J)}}else typeof S=="function"&&(B.preventDefault(),J=D?c2(g,D):new FormData(g),ux(u,{pending:!0,data:J,method:g.method,action:S},S,J))},currentTarget:g}]})}}for(var qx=0;qx<Ah.length;qx++){var Wx=Ah[qx],B3=Wx.toLowerCase(),P3=Wx[0].toUpperCase()+Wx.slice(1);Dn(B3,"on"+P3)}Dn(H1,"onAnimationEnd"),Dn(G1,"onAnimationIteration"),Dn(V1,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(t3,"onTransitionRun"),Dn(r3,"onTransitionStart"),Dn(a3,"onTransitionCancel"),Dn(q1,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Re("onBeforeInput",["compositionend","keypress","textInput","paste"]),Re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var t0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(t0));function u2(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],g=h.event;h=h.listeners;e:{var S=void 0;if(i)for(var D=h.length-1;0<=D;D--){var B=h[D],J=B.instance,fe=B.currentTarget;if(B=B.listener,J!==S&&g.isPropagationStopped())break e;S=B,g.currentTarget=fe;try{S(g)}catch(_e){nf(_e)}g.currentTarget=null,S=J}else for(D=0;D<h.length;D++){if(B=h[D],J=B.instance,fe=B.currentTarget,B=B.listener,J!==S&&g.isPropagationStopped())break e;S=B,g.currentTarget=fe;try{S(g)}catch(_e){nf(_e)}g.currentTarget=null,S=J}}}}function _t(s,i){var u=i[yc];u===void 0&&(u=i[yc]=new Set);var h=s+"__bubble";u.has(h)||(f2(i,s,2,!1),u.add(h))}function Xx(s,i,u){var h=0;i&&(h|=4),f2(u,s,h,i)}var yf="_reactListening"+Math.random().toString(36).slice(2);function $x(s){if(!s[yf]){s[yf]=!0,he.forEach(function(u){u!=="selectionchange"&&(I3.has(u)||Xx(u,!1,s),Xx(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[yf]||(i[yf]=!0,Xx("selectionchange",!1,i))}}function f2(s,i,u,h){switch(M2(i)){case 2:var g=dT;break;case 8:g=hT;break;default:g=om}u=g.bind(null,i,u,s),g=void 0,!ph||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),h?g!==void 0?s.addEventListener(i,u,{capture:!0,passive:g}):s.addEventListener(i,u,!0):g!==void 0?s.addEventListener(i,u,{passive:g}):s.addEventListener(i,u,!1)}function Yx(s,i,u,h,g){var S=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var D=h.tag;if(D===3||D===4){var B=h.stateNode.containerInfo;if(B===g)break;if(D===4)for(D=h.return;D!==null;){var J=D.tag;if((J===3||J===4)&&D.stateNode.containerInfo===g)return;D=D.return}for(;B!==null;){if(D=W(B),D===null)return;if(J=D.tag,J===5||J===6||J===26||J===27){h=S=D;continue e}B=B.parentNode}}h=h.return}v1(function(){var fe=S,_e=xh(u),Ne=[];e:{var xe=W1.get(s);if(xe!==void 0){var pe=Du,at=s;switch(s){case"keypress":if(ju(u)===0)break e;case"keydown":case"keyup":pe=Fk;break;case"focusin":at="focus",pe=bh;break;case"focusout":at="blur",pe=bh;break;case"beforeblur":case"afterblur":pe=bh;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=w1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=wk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=Lk;break;case H1:case G1:case V1:pe=_k;break;case q1:pe=Pk;break;case"scroll":case"scrollend":pe=yk;break;case"wheel":pe=Uk;break;case"copy":case"cut":case"paste":pe=Tk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=E1;break;case"toggle":case"beforetoggle":pe=Hk}var Ze=(i&4)!==0,Wt=!Ze&&(s==="scroll"||s==="scrollend"),oe=Ze?xe!==null?xe+"Capture":null:xe;Ze=[];for(var se=fe,ue;se!==null;){var ke=se;if(ue=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||ue===null||oe===null||(ke=bc(se,oe),ke!=null&&Ze.push(r0(se,ke,ue))),Wt)break;se=se.return}0<Ze.length&&(xe=new pe(xe,at,null,u,_e),Ne.push({event:xe,listeners:Ze}))}}if((i&7)===0){e:{if(xe=s==="mouseover"||s==="pointerover",pe=s==="mouseout"||s==="pointerout",xe&&u!==hh&&(at=u.relatedTarget||u.fromElement)&&(W(at)||at[Ks]))break e;if((pe||xe)&&(xe=_e.window===_e?_e:(xe=_e.ownerDocument)?xe.defaultView||xe.parentWindow:window,pe?(at=u.relatedTarget||u.toElement,pe=fe,at=at?W(at):null,at!==null&&(Wt=l(at),Ze=at.tag,at!==Wt||Ze!==5&&Ze!==27&&Ze!==6)&&(at=null)):(pe=null,at=fe),pe!==at)){if(Ze=w1,ke="onMouseLeave",oe="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(Ze=E1,ke="onPointerLeave",oe="onPointerEnter",se="pointer"),Wt=pe==null?xe:de(pe),ue=at==null?xe:de(at),xe=new Ze(ke,se+"leave",pe,u,_e),xe.target=Wt,xe.relatedTarget=ue,ke=null,W(_e)===fe&&(Ze=new Ze(oe,se+"enter",at,u,_e),Ze.target=ue,Ze.relatedTarget=Wt,ke=Ze),Wt=ke,pe&&at)t:{for(Ze=pe,oe=at,se=0,ue=Ze;ue;ue=To(ue))se++;for(ue=0,ke=oe;ke;ke=To(ke))ue++;for(;0<se-ue;)Ze=To(Ze),se--;for(;0<ue-se;)oe=To(oe),ue--;for(;se--;){if(Ze===oe||oe!==null&&Ze===oe.alternate)break t;Ze=To(Ze),oe=To(oe)}Ze=null}else Ze=null;pe!==null&&d2(Ne,xe,pe,Ze,!1),at!==null&&Wt!==null&&d2(Ne,Wt,at,Ze,!0)}}e:{if(xe=fe?de(fe):window,pe=xe.nodeName&&xe.nodeName.toLowerCase(),pe==="select"||pe==="input"&&xe.type==="file")var Ge=R1;else if(A1(xe))if(D1)Ge=Zk;else{Ge=Kk;var yt=Yk}else pe=xe.nodeName,!pe||pe.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?fe&&dh(fe.elementType)&&(Ge=R1):Ge=Qk;if(Ge&&(Ge=Ge(s,fe))){j1(Ne,Ge,u,_e);break e}yt&&yt(s,xe,fe),s==="focusout"&&fe&&xe.type==="number"&&fe.memoizedProps.value!=null&&fh(xe,"number",xe.value)}switch(yt=fe?de(fe):window,s){case"focusin":(A1(yt)||yt.contentEditable==="true")&&(to=yt,Th=fe,Cc=null);break;case"focusout":Cc=Th=to=null;break;case"mousedown":Nh=!0;break;case"contextmenu":case"mouseup":case"dragend":Nh=!1,U1(Ne,u,_e);break;case"selectionchange":if(e3)break;case"keydown":case"keyup":U1(Ne,u,_e)}var We;if(Sh)e:{switch(s){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else eo?N1(s,u)&&(Je="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Je="onCompositionStart");Je&&(_1&&u.locale!=="ko"&&(eo||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&eo&&(We=y1()):(Zs=_e,gh="value"in Zs?Zs.value:Zs.textContent,eo=!0)),yt=bf(fe,Je),0<yt.length&&(Je=new S1(Je,s,null,u,_e),Ne.push({event:Je,listeners:yt}),We?Je.data=We:(We=C1(u),We!==null&&(Je.data=We)))),(We=Vk?qk(s,u):Wk(s,u))&&(Je=bf(fe,"onBeforeInput"),0<Je.length&&(yt=new S1("onBeforeInput","beforeinput",null,u,_e),Ne.push({event:yt,listeners:Je}),yt.data=We)),L3(Ne,s,fe,u,_e)}u2(Ne,i)})}function r0(s,i,u){return{instance:s,listener:i,currentTarget:u}}function bf(s,i){for(var u=i+"Capture",h=[];s!==null;){var g=s,S=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||S===null||(g=bc(s,u),g!=null&&h.unshift(r0(s,g,S)),g=bc(s,i),g!=null&&h.push(r0(s,g,S))),s.tag===3)return h;s=s.return}return[]}function To(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function d2(s,i,u,h,g){for(var S=i._reactName,D=[];u!==null&&u!==h;){var B=u,J=B.alternate,fe=B.stateNode;if(B=B.tag,J!==null&&J===h)break;B!==5&&B!==26&&B!==27||fe===null||(J=fe,g?(fe=bc(u,S),fe!=null&&D.unshift(r0(u,fe,J))):g||(fe=bc(u,S),fe!=null&&D.push(r0(u,fe,J)))),u=u.return}D.length!==0&&s.push({event:i,listeners:D})}var U3=/\r\n?/g,z3=/\u0000|\uFFFD/g;function h2(s){return(typeof s=="string"?s:""+s).replace(U3,`
`).replace(z3,"")}function x2(s,i){return i=h2(i),h2(s)===i}function wf(){}function qt(s,i,u,h,g,S){switch(u){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Ql(s,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Ql(s,""+h);break;case"className":Gt(s,"class",h);break;case"tabIndex":Gt(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Gt(s,u,h);break;case"style":p1(s,h,S);break;case"data":if(i!=="object"){Gt(s,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Cu(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(i!=="input"&&qt(s,i,"name",g.name,g,null),qt(s,i,"formEncType",g.formEncType,g,null),qt(s,i,"formMethod",g.formMethod,g,null),qt(s,i,"formTarget",g.formTarget,g,null)):(qt(s,i,"encType",g.encType,g,null),qt(s,i,"method",g.method,g,null),qt(s,i,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Cu(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=wf);break;case"onScroll":h!=null&&_t("scroll",s);break;case"onScrollEnd":h!=null&&_t("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=Cu(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":_t("beforetoggle",s),_t("toggle",s),Ht(s,"popover",h);break;case"xlinkActuate":Jt(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Jt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Jt(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Jt(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Jt(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Jt(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Ht(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=gk.get(u)||u,Ht(s,u,h))}}function Kx(s,i,u,h,g,S){switch(u){case"style":p1(s,h,S);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"children":typeof h=="string"?Ql(s,h):(typeof h=="number"||typeof h=="bigint")&&Ql(s,""+h);break;case"onScroll":h!=null&&_t("scroll",s);break;case"onScrollEnd":h!=null&&_t("scrollend",s);break;case"onClick":h!=null&&(s.onclick=wf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!me.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),i=u.slice(2,g?u.length-7:void 0),S=s[Vr]||null,S=S!=null?S[u]:null,typeof S=="function"&&s.removeEventListener(i,S,g),typeof h=="function")){typeof S!="function"&&S!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(i,h,g);break e}u in s?s[u]=h:h===!0?s.setAttribute(u,""):Ht(s,u,h)}}}function aa(s,i,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",s),_t("load",s);var h=!1,g=!1,S;for(S in u)if(u.hasOwnProperty(S)){var D=u[S];if(D!=null)switch(S){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:qt(s,i,S,D,u,null)}}g&&qt(s,i,"srcSet",u.srcSet,u,null),h&&qt(s,i,"src",u.src,u,null);return;case"input":_t("invalid",s);var B=S=D=g=null,J=null,fe=null;for(h in u)if(u.hasOwnProperty(h)){var _e=u[h];if(_e!=null)switch(h){case"name":g=_e;break;case"type":D=_e;break;case"checked":J=_e;break;case"defaultChecked":fe=_e;break;case"value":S=_e;break;case"defaultValue":B=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(a(137,i));break;default:qt(s,i,h,_e,u,null)}}d1(s,S,B,J,fe,D,g,!1),Tu(s);return;case"select":_t("invalid",s),h=D=S=null;for(g in u)if(u.hasOwnProperty(g)&&(B=u[g],B!=null))switch(g){case"value":S=B;break;case"defaultValue":D=B;break;case"multiple":h=B;default:qt(s,i,g,B,u,null)}i=S,u=D,s.multiple=!!h,i!=null?Kl(s,!!h,i,!1):u!=null&&Kl(s,!!h,u,!0);return;case"textarea":_t("invalid",s),S=g=h=null;for(D in u)if(u.hasOwnProperty(D)&&(B=u[D],B!=null))switch(D){case"value":h=B;break;case"defaultValue":g=B;break;case"children":S=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(a(91));break;default:qt(s,i,D,B,u,null)}x1(s,h,g,S),Tu(s);return;case"option":for(J in u)if(u.hasOwnProperty(J)&&(h=u[J],h!=null))switch(J){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:qt(s,i,J,h,u,null)}return;case"dialog":_t("beforetoggle",s),_t("toggle",s),_t("cancel",s),_t("close",s);break;case"iframe":case"object":_t("load",s);break;case"video":case"audio":for(h=0;h<t0.length;h++)_t(t0[h],s);break;case"image":_t("error",s),_t("load",s);break;case"details":_t("toggle",s);break;case"embed":case"source":case"link":_t("error",s),_t("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in u)if(u.hasOwnProperty(fe)&&(h=u[fe],h!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:qt(s,i,fe,h,u,null)}return;default:if(dh(i)){for(_e in u)u.hasOwnProperty(_e)&&(h=u[_e],h!==void 0&&Kx(s,i,_e,h,u,void 0));return}}for(B in u)u.hasOwnProperty(B)&&(h=u[B],h!=null&&qt(s,i,B,h,u,null))}function H3(s,i,u,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,S=null,D=null,B=null,J=null,fe=null,_e=null;for(pe in u){var Ne=u[pe];if(u.hasOwnProperty(pe)&&Ne!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":J=Ne;default:h.hasOwnProperty(pe)||qt(s,i,pe,null,h,Ne)}}for(var xe in h){var pe=h[xe];if(Ne=u[xe],h.hasOwnProperty(xe)&&(pe!=null||Ne!=null))switch(xe){case"type":S=pe;break;case"name":g=pe;break;case"checked":fe=pe;break;case"defaultChecked":_e=pe;break;case"value":D=pe;break;case"defaultValue":B=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,i));break;default:pe!==Ne&&qt(s,i,xe,pe,h,Ne)}}uh(s,D,B,J,fe,_e,S,g);return;case"select":pe=D=B=xe=null;for(S in u)if(J=u[S],u.hasOwnProperty(S)&&J!=null)switch(S){case"value":break;case"multiple":pe=J;default:h.hasOwnProperty(S)||qt(s,i,S,null,h,J)}for(g in h)if(S=h[g],J=u[g],h.hasOwnProperty(g)&&(S!=null||J!=null))switch(g){case"value":xe=S;break;case"defaultValue":B=S;break;case"multiple":D=S;default:S!==J&&qt(s,i,g,S,h,J)}i=B,u=D,h=pe,xe!=null?Kl(s,!!u,xe,!1):!!h!=!!u&&(i!=null?Kl(s,!!u,i,!0):Kl(s,!!u,u?[]:"",!1));return;case"textarea":pe=xe=null;for(B in u)if(g=u[B],u.hasOwnProperty(B)&&g!=null&&!h.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:qt(s,i,B,null,h,g)}for(D in h)if(g=h[D],S=u[D],h.hasOwnProperty(D)&&(g!=null||S!=null))switch(D){case"value":xe=g;break;case"defaultValue":pe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(a(91));break;default:g!==S&&qt(s,i,D,g,h,S)}h1(s,xe,pe);return;case"option":for(var at in u)if(xe=u[at],u.hasOwnProperty(at)&&xe!=null&&!h.hasOwnProperty(at))switch(at){case"selected":s.selected=!1;break;default:qt(s,i,at,null,h,xe)}for(J in h)if(xe=h[J],pe=u[J],h.hasOwnProperty(J)&&xe!==pe&&(xe!=null||pe!=null))switch(J){case"selected":s.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:qt(s,i,J,xe,h,pe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in u)xe=u[Ze],u.hasOwnProperty(Ze)&&xe!=null&&!h.hasOwnProperty(Ze)&&qt(s,i,Ze,null,h,xe);for(fe in h)if(xe=h[fe],pe=u[fe],h.hasOwnProperty(fe)&&xe!==pe&&(xe!=null||pe!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,i));break;default:qt(s,i,fe,xe,h,pe)}return;default:if(dh(i)){for(var Wt in u)xe=u[Wt],u.hasOwnProperty(Wt)&&xe!==void 0&&!h.hasOwnProperty(Wt)&&Kx(s,i,Wt,void 0,h,xe);for(_e in h)xe=h[_e],pe=u[_e],!h.hasOwnProperty(_e)||xe===pe||xe===void 0&&pe===void 0||Kx(s,i,_e,xe,h,pe);return}}for(var oe in u)xe=u[oe],u.hasOwnProperty(oe)&&xe!=null&&!h.hasOwnProperty(oe)&&qt(s,i,oe,null,h,xe);for(Ne in h)xe=h[Ne],pe=u[Ne],!h.hasOwnProperty(Ne)||xe===pe||xe==null&&pe==null||qt(s,i,Ne,xe,h,pe)}var Qx=null,Zx=null;function Sf(s){return s.nodeType===9?s:s.ownerDocument}function m2(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function p2(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Jx(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var em=null;function G3(){var s=window.event;return s&&s.type==="popstate"?s===em?!1:(em=s,!0):(em=null,!1)}var g2=typeof setTimeout=="function"?setTimeout:void 0,V3=typeof clearTimeout=="function"?clearTimeout:void 0,v2=typeof Promise=="function"?Promise:void 0,q3=typeof queueMicrotask=="function"?queueMicrotask:typeof v2<"u"?function(s){return v2.resolve(null).then(s).catch(W3)}:g2;function W3(s){setTimeout(function(){throw s})}function xi(s){return s==="head"}function y2(s,i){var u=i,h=0,g=0;do{var S=u.nextSibling;if(s.removeChild(u),S&&S.nodeType===8)if(u=S.data,u==="/$"){if(0<h&&8>h){u=h;var D=s.ownerDocument;if(u&1&&a0(D.documentElement),u&2&&a0(D.body),u&4)for(u=D.head,a0(u),D=u.firstChild;D;){var B=D.nextSibling,J=D.nodeName;D[G]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&D.rel.toLowerCase()==="stylesheet"||u.removeChild(D),D=B}}if(g===0){s.removeChild(S),f0(i);return}g--}else u==="$"||u==="$?"||u==="$!"?g++:h=u.charCodeAt(0)-48;else h=0;u=S}while(u);f0(i)}function tm(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var u=i;switch(i=i.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":tm(u),q(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function X3(s,i,u,h){for(;s.nodeType===1;){var g=u;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[G])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(S=s.getAttribute("rel"),S==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(S!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(S=s.getAttribute("src"),(S!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&S&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var S=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===S)return s}else return s;if(s=On(s.nextSibling),s===null)break}return null}function $3(s,i,u){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=On(s.nextSibling),s===null))return null;return s}function rm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Y3(s,i){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")i();else{var h=function(){i(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function On(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var am=null;function b2(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}function w2(s,i,u){switch(i=Sf(u),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function a0(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);q(s)}var mn=new Map,S2=new Set;function Ef(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Rs=le.d;le.d={f:K3,r:Q3,D:Z3,C:J3,L:eT,m:tT,X:aT,S:rT,M:nT};function K3(){var s=Rs.f(),i=xf();return s||i}function Q3(s){var i=K(s);i!==null&&i.tag===5&&i.type==="form"?Hv(i):Rs.r(s)}var No=typeof document>"u"?null:document;function E2(s,i,u){var h=No;if(h&&typeof i=="string"&&i){var g=on(i);g='link[rel="'+s+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),S2.has(g)||(S2.add(g),s={rel:s,crossOrigin:u,href:i},h.querySelector(g)===null&&(i=h.createElement("link"),aa(i,"link",s),ce(i),h.head.appendChild(i)))}}function Z3(s){Rs.D(s),E2("dns-prefetch",s,null)}function J3(s,i){Rs.C(s,i),E2("preconnect",s,i)}function eT(s,i,u){Rs.L(s,i,u);var h=No;if(h&&s&&i){var g='link[rel="preload"][as="'+on(i)+'"]';i==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+on(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+on(u.imageSizes)+'"]')):g+='[href="'+on(s)+'"]';var S=g;switch(i){case"style":S=Co(s);break;case"script":S=Ao(s)}mn.has(S)||(s=m({rel:"preload",href:i==="image"&&u&&u.imageSrcSet?void 0:s,as:i},u),mn.set(S,s),h.querySelector(g)!==null||i==="style"&&h.querySelector(n0(S))||i==="script"&&h.querySelector(s0(S))||(i=h.createElement("link"),aa(i,"link",s),ce(i),h.head.appendChild(i)))}}function tT(s,i){Rs.m(s,i);var u=No;if(u&&s){var h=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+on(h)+'"][href="'+on(s)+'"]',S=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Ao(s)}if(!mn.has(S)&&(s=m({rel:"modulepreload",href:s},i),mn.set(S,s),u.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(s0(S)))return}h=u.createElement("link"),aa(h,"link",s),ce(h),u.head.appendChild(h)}}}function rT(s,i,u){Rs.S(s,i,u);var h=No;if(h&&s){var g=Se(h).hoistableStyles,S=Co(s);i=i||"default";var D=g.get(S);if(!D){var B={loading:0,preload:null};if(D=h.querySelector(n0(S)))B.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":i},u),(u=mn.get(S))&&nm(s,u);var J=D=h.createElement("link");ce(J),aa(J,"link",s),J._p=new Promise(function(fe,_e){J.onload=fe,J.onerror=_e}),J.addEventListener("load",function(){B.loading|=1}),J.addEventListener("error",function(){B.loading|=2}),B.loading|=4,_f(D,i,h)}D={type:"stylesheet",instance:D,count:1,state:B},g.set(S,D)}}}function aT(s,i){Rs.X(s,i);var u=No;if(u&&s){var h=Se(u).hoistableScripts,g=Ao(s),S=h.get(g);S||(S=u.querySelector(s0(g)),S||(s=m({src:s,async:!0},i),(i=mn.get(g))&&sm(s,i),S=u.createElement("script"),ce(S),aa(S,"link",s),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},h.set(g,S))}}function nT(s,i){Rs.M(s,i);var u=No;if(u&&s){var h=Se(u).hoistableScripts,g=Ao(s),S=h.get(g);S||(S=u.querySelector(s0(g)),S||(s=m({src:s,async:!0,type:"module"},i),(i=mn.get(g))&&sm(s,i),S=u.createElement("script"),ce(S),aa(S,"link",s),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},h.set(g,S))}}function _2(s,i,u,h){var g=(g=re.current)?Ef(g):null;if(!g)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(i=Co(u.href),u=Se(g).hoistableStyles,h=u.get(i),h||(h={type:"style",instance:null,count:0,state:null},u.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Co(u.href);var S=Se(g).hoistableStyles,D=S.get(s);if(D||(g=g.ownerDocument||g,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(s,D),(S=g.querySelector(n0(s)))&&!S._p&&(D.instance=S,D.state.loading=5),mn.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},mn.set(s,u),S||sT(g,s,u,D.state))),i&&h===null)throw Error(a(528,""));return D}if(i&&h!==null)throw Error(a(529,""));return null;case"script":return i=u.async,u=u.src,typeof u=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ao(u),u=Se(g).hoistableScripts,h=u.get(i),h||(h={type:"script",instance:null,count:0,state:null},u.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Co(s){return'href="'+on(s)+'"'}function n0(s){return'link[rel="stylesheet"]['+s+"]"}function k2(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function sT(s,i,u,h){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=s.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),aa(i,"link",u),ce(i),s.head.appendChild(i))}function Ao(s){return'[src="'+on(s)+'"]'}function s0(s){return"script[async]"+s}function T2(s,i,u){if(i.count++,i.instance===null)switch(i.type){case"style":var h=s.querySelector('style[data-href~="'+on(u.href)+'"]');if(h)return i.instance=h,ce(h),h;var g=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),ce(h),aa(h,"style",g),_f(h,u.precedence,s),i.instance=h;case"stylesheet":g=Co(u.href);var S=s.querySelector(n0(g));if(S)return i.state.loading|=4,i.instance=S,ce(S),S;h=k2(u),(g=mn.get(g))&&nm(h,g),S=(s.ownerDocument||s).createElement("link"),ce(S);var D=S;return D._p=new Promise(function(B,J){D.onload=B,D.onerror=J}),aa(S,"link",h),i.state.loading|=4,_f(S,u.precedence,s),i.instance=S;case"script":return S=Ao(u.src),(g=s.querySelector(s0(S)))?(i.instance=g,ce(g),g):(h=u,(g=mn.get(S))&&(h=m({},u),sm(h,g)),s=s.ownerDocument||s,g=s.createElement("script"),ce(g),aa(g,"link",h),s.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,_f(h,u.precedence,s));return i.instance}function _f(s,i,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,S=g,D=0;D<h.length;D++){var B=h[D];if(B.dataset.precedence===i)S=B;else if(S!==g)break}S?S.parentNode.insertBefore(s,S.nextSibling):(i=u.nodeType===9?u.head:u,i.insertBefore(s,i.firstChild))}function nm(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function sm(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var kf=null;function N2(s,i,u){if(kf===null){var h=new Map,g=kf=new Map;g.set(u,h)}else g=kf,h=g.get(u),h||(h=new Map,g.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),g=0;g<u.length;g++){var S=u[g];if(!(S[G]||S[Gr]||s==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var D=S.getAttribute(i)||"";D=s+D;var B=h.get(D);B?B.push(S):h.set(D,[S])}}return h}function C2(s,i,u){s=s.ownerDocument||s,s.head.insertBefore(u,i==="title"?s.querySelector("head > title"):null)}function iT(s,i,u){if(u===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function A2(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var i0=null;function lT(){}function oT(s,i,u){if(i0===null)throw Error(a(475));var h=i0;if(i.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var g=Co(u.href),S=s.querySelector(n0(g));if(S){s=S._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(h.count++,h=Tf.bind(h),s.then(h,h)),i.state.loading|=4,i.instance=S,ce(S);return}S=s.ownerDocument||s,u=k2(u),(g=mn.get(g))&&nm(u,g),S=S.createElement("link"),ce(S);var D=S;D._p=new Promise(function(B,J){D.onload=B,D.onerror=J}),aa(S,"link",u),i.instance=S}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(h.count++,i=Tf.bind(h),s.addEventListener("load",i),s.addEventListener("error",i))}}function cT(){if(i0===null)throw Error(a(475));var s=i0;return s.stylesheets&&s.count===0&&im(s,s.stylesheets),0<s.count?function(i){var u=setTimeout(function(){if(s.stylesheets&&im(s,s.stylesheets),s.unsuspend){var h=s.unsuspend;s.unsuspend=null,h()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Tf(){if(this.count--,this.count===0){if(this.stylesheets)im(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Nf=null;function im(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Nf=new Map,i.forEach(uT,s),Nf=null,Tf.call(s))}function uT(s,i){if(!(i.state.loading&4)){var u=Nf.get(s);if(u)var h=u.get(null);else{u=new Map,Nf.set(s,u);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<g.length;S++){var D=g[S];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(u.set(D.dataset.precedence,D),h=D)}h&&u.set(null,h)}g=i.instance,D=g.getAttribute("data-precedence"),S=u.get(D)||h,S===h&&u.set(null,g),u.set(D,g),this.count++,h=Tf.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),S?S.parentNode.insertBefore(g,S.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),i.state.loading|=4}}var l0={$$typeof:k,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function fT(s,i,u,h,g,S,D,B){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jr(0),this.hiddenUpdates=Jr(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=S,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function j2(s,i,u,h,g,S,D,B,J,fe,_e,Ne){return s=new fT(s,i,u,D,B,J,fe,Ne),i=1,S===!0&&(i|=24),S=qa(3,null,null,i),s.current=S,S.stateNode=s,i=zh(),i.refCount++,s.pooledCache=i,i.refCount++,S.memoizedState={element:h,isDehydrated:u,cache:i},qh(S),s}function R2(s){return s?(s=so,s):so}function D2(s,i,u,h,g,S){g=R2(g),h.context===null?h.context=g:h.pendingContext=g,h=ti(i),h.payload={element:u},S=S===void 0?null:S,S!==null&&(h.callback=S),u=ri(s,h,i),u!==null&&(Ka(u,s,i),Bc(u,s,i))}function F2(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function lm(s,i){F2(s,i),(s=s.alternate)&&F2(s,i)}function O2(s){if(s.tag===13){var i=no(s,67108864);i!==null&&Ka(i,s,67108864),lm(s,67108864)}}var Cf=!0;function dT(s,i,u,h){var g=ee.T;ee.T=null;var S=le.p;try{le.p=2,om(s,i,u,h)}finally{le.p=S,ee.T=g}}function hT(s,i,u,h){var g=ee.T;ee.T=null;var S=le.p;try{le.p=8,om(s,i,u,h)}finally{le.p=S,ee.T=g}}function om(s,i,u,h){if(Cf){var g=cm(h);if(g===null)Yx(s,i,h,Af,u),L2(s,h);else if(mT(g,s,i,u,h))h.stopPropagation();else if(L2(s,h),i&4&&-1<xT.indexOf(s)){for(;g!==null;){var S=K(g);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var D=Ra(S.pendingLanes);if(D!==0){var B=S;for(B.pendingLanes|=2,B.entangledLanes|=2;D;){var J=1<<31-Mt(D);B.entanglements[1]|=J,D&=~J}as(S),(Bt&6)===0&&(df=De()+500,e0(0))}}break;case 13:B=no(S,2),B!==null&&Ka(B,S,2),xf(),lm(S,2)}if(S=cm(h),S===null&&Yx(s,i,h,Af,u),S===g)break;g=S}g!==null&&h.stopPropagation()}else Yx(s,i,h,null,u)}}function cm(s){return s=xh(s),um(s)}var Af=null;function um(s){if(Af=null,s=W(s),s!==null){var i=l(s);if(i===null)s=null;else{var u=i.tag;if(u===13){if(s=o(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Af=s,null}function M2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ot()){case dr:return 2;case Zr:return 8;case hr:case An:return 32;case ya:return 268435456;default:return 32}default:return 32}}var fm=!1,mi=null,pi=null,gi=null,o0=new Map,c0=new Map,vi=[],xT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function L2(s,i){switch(s){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":gi=null;break;case"pointerover":case"pointerout":o0.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":c0.delete(i.pointerId)}}function u0(s,i,u,h,g,S){return s===null||s.nativeEvent!==S?(s={blockedOn:i,domEventName:u,eventSystemFlags:h,nativeEvent:S,targetContainers:[g]},i!==null&&(i=K(i),i!==null&&O2(i)),s):(s.eventSystemFlags|=h,i=s.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),s)}function mT(s,i,u,h,g){switch(i){case"focusin":return mi=u0(mi,s,i,u,h,g),!0;case"dragenter":return pi=u0(pi,s,i,u,h,g),!0;case"mouseover":return gi=u0(gi,s,i,u,h,g),!0;case"pointerover":var S=g.pointerId;return o0.set(S,u0(o0.get(S)||null,s,i,u,h,g)),!0;case"gotpointercapture":return S=g.pointerId,c0.set(S,u0(c0.get(S)||null,s,i,u,h,g)),!0}return!1}function B2(s){var i=W(s.target);if(i!==null){var u=l(i);if(u!==null){if(i=u.tag,i===13){if(i=o(u),i!==null){s.blockedOn=i,oh(s.priority,function(){if(u.tag===13){var h=Ya();h=Qn(h);var g=no(u,h);g!==null&&Ka(g,u,h),lm(u,h)}});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function jf(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=cm(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);hh=h,u.target.dispatchEvent(h),hh=null}else return i=K(u),i!==null&&O2(i),s.blockedOn=u,!1;i.shift()}return!0}function P2(s,i,u){jf(s)&&u.delete(i)}function pT(){fm=!1,mi!==null&&jf(mi)&&(mi=null),pi!==null&&jf(pi)&&(pi=null),gi!==null&&jf(gi)&&(gi=null),o0.forEach(P2),c0.forEach(P2)}function Rf(s,i){s.blockedOn===i&&(s.blockedOn=null,fm||(fm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,pT)))}var Df=null;function I2(s){Df!==s&&(Df=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Df===s&&(Df=null);for(var i=0;i<s.length;i+=3){var u=s[i],h=s[i+1],g=s[i+2];if(typeof h!="function"){if(um(h||u)===null)continue;break}var S=K(u);S!==null&&(s.splice(i,3),i-=3,ux(S,{pending:!0,data:g,method:u.method,action:h},h,g))}}))}function f0(s){function i(J){return Rf(J,s)}mi!==null&&Rf(mi,s),pi!==null&&Rf(pi,s),gi!==null&&Rf(gi,s),o0.forEach(i),c0.forEach(i);for(var u=0;u<vi.length;u++){var h=vi[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<vi.length&&(u=vi[0],u.blockedOn===null);)B2(u),u.blockedOn===null&&vi.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var g=u[h],S=u[h+1],D=g[Vr]||null;if(typeof S=="function")D||I2(u);else if(D){var B=null;if(S&&S.hasAttribute("formAction")){if(g=S,D=S[Vr]||null)B=D.formAction;else if(um(g)!==null)continue}else B=D.action;typeof B=="function"?u[h+1]=B:(u.splice(h,3),h-=3),I2(u)}}}function dm(s){this._internalRoot=s}Ff.prototype.render=dm.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var u=i.current,h=Ya();D2(u,h,s,i,null,null)},Ff.prototype.unmount=dm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;D2(s.current,2,null,s,null,null),xf(),i[Ks]=null}};function Ff(s){this._internalRoot=s}Ff.prototype.unstable_scheduleHydration=function(s){if(s){var i=ku();s={blockedOn:null,target:s,priority:i};for(var u=0;u<vi.length&&i!==0&&i<vi[u].priority;u++);vi.splice(u,0,s),u===0&&B2(s)}};var U2=t.version;if(U2!=="19.1.0")throw Error(a(527,U2,"19.1.0"));le.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=d(i),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var gT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{Cr=Of.inject(gT),or=Of}catch{}}return h0.createRoot=function(s,i){if(!n(s))throw Error(a(299));var u=!1,h="",g=ry,S=ay,D=ny,B=null;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(S=i.onCaughtError),i.onRecoverableError!==void 0&&(D=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(B=i.unstable_transitionCallbacks)),i=j2(s,1,!1,null,null,u,h,g,S,D,B,null),s[Ks]=i.current,$x(s),new dm(i)},h0.hydrateRoot=function(s,i,u){if(!n(s))throw Error(a(299));var h=!1,g="",S=ry,D=ay,B=ny,J=null,fe=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(D=u.onCaughtError),u.onRecoverableError!==void 0&&(B=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(J=u.unstable_transitionCallbacks),u.formState!==void 0&&(fe=u.formState)),i=j2(s,1,!0,i,u??null,h,g,S,D,B,J,fe),i.context=R2(null),u=i.current,h=Ya(),h=Qn(h),g=ti(h),g.callback=null,ri(u,g,h),u=h,i.current.lanes=u,ea(i,u),as(i),s[Ks]=i.current,$x(s),new Ff(i)},h0.version="19.1.0",h0}var Q2;function NT(){if(Q2)return pm.exports;Q2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pm.exports=TT(),pm.exports}var CT=NT(),x0={},Z2;function AT(){if(Z2)return x0;Z2=1,Object.defineProperty(x0,"__esModule",{value:!0}),x0.parse=o,x0.serialize=x;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,l=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,y){const b=new l,w=v.length;if(w<2)return b;const E=(y==null?void 0:y.decode)||m;let _=0;do{const N=v.indexOf("=",_);if(N===-1)break;const k=v.indexOf(";",_),F=k===-1?w:k;if(N>F){_=v.lastIndexOf(";",N-1)+1;continue}const j=f(v,_,N),R=d(v,N,j),T=v.slice(j,R);if(b[T]===void 0){let C=f(v,N+1,F),O=d(v,F,C);const V=E(v.slice(C,O));b[T]=V}_=F+1}while(_<w);return b}function f(v,y,b){do{const w=v.charCodeAt(y);if(w!==32&&w!==9)return y}while(++y<b);return b}function d(v,y,b){for(;y>b;){const w=v.charCodeAt(--y);if(w!==32&&w!==9)return y+1}return b}function x(v,y,b){const w=(b==null?void 0:b.encode)||encodeURIComponent;if(!e.test(v))throw new TypeError(`argument name is invalid: ${v}`);const E=w(y);if(!t.test(E))throw new TypeError(`argument val is invalid: ${y}`);let _=v+"="+E;if(!b)return _;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);_+="; Max-Age="+b.maxAge}if(b.domain){if(!r.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);_+="; Domain="+b.domain}if(b.path){if(!a.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);_+="; Path="+b.path}if(b.expires){if(!p(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);_+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(_+="; HttpOnly"),b.secure&&(_+="; Secure"),b.partitioned&&(_+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return _}function m(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function p(v){return n.call(v)==="[object Date]"}return x0}AT();var J2="popstate";function jT(e={}){function t(a,n){let{pathname:l,search:o,hash:f}=a.location;return sp("",{pathname:l,search:o,hash:f},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:O0(n)}return DT(t,r,null,e)}function lr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function _n(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function RT(){return Math.random().toString(36).substring(2,10)}function eb(e,t){return{usr:e.state,key:e.key,idx:t}}function sp(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?lc(t):t,state:r,key:t&&t.key||a||RT()}}function O0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function lc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function DT(e,t,r,a={}){let{window:n=document.defaultView,v5Compat:l=!1}=a,o=n.history,f="POP",d=null,x=m();x==null&&(x=0,o.replaceState({...o.state,idx:x},""));function m(){return(o.state||{idx:null}).idx}function p(){f="POP";let E=m(),_=E==null?null:E-x;x=E,d&&d({action:f,location:w.location,delta:_})}function v(E,_){f="PUSH";let N=sp(w.location,E,_);x=m()+1;let k=eb(N,x),F=w.createHref(N);try{o.pushState(k,"",F)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;n.location.assign(F)}l&&d&&d({action:f,location:w.location,delta:1})}function y(E,_){f="REPLACE";let N=sp(w.location,E,_);x=m();let k=eb(N,x),F=w.createHref(N);o.replaceState(k,"",F),l&&d&&d({action:f,location:w.location,delta:0})}function b(E){return FT(E)}let w={get action(){return f},get location(){return e(n,o)},listen(E){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(J2,p),d=E,()=>{n.removeEventListener(J2,p),d=null}},createHref(E){return t(n,E)},createURL:b,encodeLocation(E){let _=b(E);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:v,replace:y,go(E){return o.go(E)}};return w}function FT(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),lr(r,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:O0(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function LS(e,t,r="/"){return OT(e,t,r,!1)}function OT(e,t,r,a){let n=typeof t=="string"?lc(t):t,l=Vs(n.pathname||"/",r);if(l==null)return null;let o=BS(e);MT(o);let f=null;for(let d=0;f==null&&d<o.length;++d){let x=WT(l);f=VT(o[d],x,a)}return f}function BS(e,t=[],r=[],a=""){let n=(l,o,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};d.relativePath.startsWith("/")&&(lr(d.relativePath.startsWith(a),`Absolute route path "${d.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(a.length));let x=Is([a,d.relativePath]),m=r.concat(d);l.children&&l.children.length>0&&(lr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),BS(l.children,t,m,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:HT(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))n(l,o);else for(let d of PS(l.path))n(l,o,d)}),t}function PS(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),l=r.replace(/\?$/,"");if(a.length===0)return n?[l,""]:[l];let o=PS(a.join("/")),f=[];return f.push(...o.map(d=>d===""?l:[l,d].join("/"))),n&&f.push(...o),f.map(d=>e.startsWith("/")&&d===""?"/":d)}function MT(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:GT(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var LT=/^:[\w-]+$/,BT=3,PT=2,IT=1,UT=10,zT=-2,tb=e=>e==="*";function HT(e,t){let r=e.split("/"),a=r.length;return r.some(tb)&&(a+=zT),t&&(a+=PT),r.filter(n=>!tb(n)).reduce((n,l)=>n+(LT.test(l)?BT:l===""?IT:UT),a)}function GT(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function VT(e,t,r=!1){let{routesMeta:a}=e,n={},l="/",o=[];for(let f=0;f<a.length;++f){let d=a[f],x=f===a.length-1,m=l==="/"?t:t.slice(l.length)||"/",p=pd({path:d.relativePath,caseSensitive:d.caseSensitive,end:x},m),v=d.route;if(!p&&x&&r&&!a[a.length-1].route.index&&(p=pd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!p)return null;Object.assign(n,p.params),o.push({params:n,pathname:Is([l,p.pathname]),pathnameBase:KT(Is([l,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(l=Is([l,p.pathnameBase]))}return o}function pd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=qT(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let l=n[0],o=l.replace(/(.)\/+$/,"$1"),f=n.slice(1);return{params:a.reduce((x,{paramName:m,isOptional:p},v)=>{if(m==="*"){let b=f[v]||"";o=l.slice(0,l.length-b.length).replace(/(.)\/+$/,"$1")}const y=f[v];return p&&!y?x[m]=void 0:x[m]=(y||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function qT(e,t=!1,r=!0){_n(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,d)=>(a.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function WT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return _n(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Vs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function XT(e,t="/"){let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?lc(e):e;return{pathname:r?r.startsWith("/")?r:$T(r,t):t,search:QT(a),hash:ZT(n)}}function $T(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function bm(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Yp(e){let t=YT(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function Kp(e,t,r,a=!1){let n;typeof e=="string"?n=lc(e):(n={...e},lr(!n.pathname||!n.pathname.includes("?"),bm("?","pathname","search",n)),lr(!n.pathname||!n.pathname.includes("#"),bm("#","pathname","hash",n)),lr(!n.search||!n.search.includes("#"),bm("#","search","hash",n)));let l=e===""||n.pathname==="",o=l?"/":n.pathname,f;if(o==null)f=r;else{let p=t.length-1;if(!a&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),p-=1;n.pathname=v.join("/")}f=p>=0?t[p]:"/"}let d=XT(n,f),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(x||m)&&(d.pathname+="/"),d}var Is=e=>e.join("/").replace(/\/\/+/g,"/"),KT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),QT=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ZT=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function JT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var IS=["POST","PUT","PATCH","DELETE"];new Set(IS);var eN=["GET",...IS];new Set(eN);var oc=A.createContext(null);oc.displayName="DataRouter";var Ld=A.createContext(null);Ld.displayName="DataRouterState";var US=A.createContext({isTransitioning:!1});US.displayName="ViewTransition";var tN=A.createContext(new Map);tN.displayName="Fetchers";var rN=A.createContext(null);rN.displayName="Await";var qn=A.createContext(null);qn.displayName="Navigation";var su=A.createContext(null);su.displayName="Location";var Tn=A.createContext({outlet:null,matches:[],isDataRoute:!1});Tn.displayName="Route";var Qp=A.createContext(null);Qp.displayName="RouteError";function aN(e,{relative:t}={}){lr(cc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=A.useContext(qn),{hash:n,pathname:l,search:o}=iu(e,{relative:t}),f=l;return r!=="/"&&(f=l==="/"?r:Is([r,l])),a.createHref({pathname:f,search:o,hash:n})}function cc(){return A.useContext(su)!=null}function xs(){return lr(cc(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(su).location}var zS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function HS(e){A.useContext(qn).static||A.useLayoutEffect(e)}function ja(){let{isDataRoute:e}=A.useContext(Tn);return e?vN():nN()}function nN(){lr(cc(),"useNavigate() may be used only in the context of a <Router> component.");let e=A.useContext(oc),{basename:t,navigator:r}=A.useContext(qn),{matches:a}=A.useContext(Tn),{pathname:n}=xs(),l=JSON.stringify(Yp(a)),o=A.useRef(!1);return HS(()=>{o.current=!0}),A.useCallback((d,x={})=>{if(_n(o.current,zS),!o.current)return;if(typeof d=="number"){r.go(d);return}let m=Kp(d,JSON.parse(l),n,x.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Is([t,m.pathname])),(x.replace?r.replace:r.push)(m,x.state,x)},[t,r,l,n,e])}var sN=A.createContext(null);function iN(e){let t=A.useContext(Tn).outlet;return t&&A.createElement(sN.Provider,{value:e},t)}function Nn(){let{matches:e}=A.useContext(Tn),t=e[e.length-1];return t?t.params:{}}function iu(e,{relative:t}={}){let{matches:r}=A.useContext(Tn),{pathname:a}=xs(),n=JSON.stringify(Yp(r));return A.useMemo(()=>Kp(e,JSON.parse(n),a,t==="path"),[e,n,a,t])}function lN(e,t){return GS(e,t)}function GS(e,t,r,a){var _;lr(cc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=A.useContext(qn),{matches:l}=A.useContext(Tn),o=l[l.length-1],f=o?o.params:{},d=o?o.pathname:"/",x=o?o.pathnameBase:"/",m=o&&o.route;{let N=m&&m.path||"";VS(d,!m||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let p=xs(),v;if(t){let N=typeof t=="string"?lc(t):t;lr(x==="/"||((_=N.pathname)==null?void 0:_.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=p;let y=v.pathname||"/",b=y;if(x!=="/"){let N=x.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(N.length).join("/")}let w=LS(e,{pathname:b});_n(m||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),_n(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=dN(w&&w.map(N=>Object.assign({},N,{params:Object.assign({},f,N.params),pathname:Is([x,n.encodeLocation?n.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?x:Is([x,n.encodeLocation?n.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,r,a);return t&&E?A.createElement(su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function oN(){let e=gN(),t=JT(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:l},"ErrorBoundary")," or"," ",A.createElement("code",{style:l},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),r?A.createElement("pre",{style:n},r):null,o)}var cN=A.createElement(oN,null),uN=class extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?A.createElement(Tn.Provider,{value:this.props.routeContext},A.createElement(Qp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fN({routeContext:e,match:t,children:r}){let a=A.useContext(oc);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),A.createElement(Tn.Provider,{value:e},r)}function dN(e,t=[],r=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,l=r==null?void 0:r.errors;if(l!=null){let d=n.findIndex(x=>x.route.id&&(l==null?void 0:l[x.route.id])!==void 0);lr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),n=n.slice(0,Math.min(n.length,d+1))}let o=!1,f=-1;if(r)for(let d=0;d<n.length;d++){let x=n[d];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=d),x.route.id){let{loaderData:m,errors:p}=r,v=x.route.loader&&!m.hasOwnProperty(x.route.id)&&(!p||p[x.route.id]===void 0);if(x.route.lazy||v){o=!0,f>=0?n=n.slice(0,f+1):n=[n[0]];break}}}return n.reduceRight((d,x,m)=>{let p,v=!1,y=null,b=null;r&&(p=l&&x.route.id?l[x.route.id]:void 0,y=x.route.errorElement||cN,o&&(f<0&&m===0?(VS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,b=null):f===m&&(v=!0,b=x.route.hydrateFallbackElement||null)));let w=t.concat(n.slice(0,m+1)),E=()=>{let _;return p?_=y:v?_=b:x.route.Component?_=A.createElement(x.route.Component,null):x.route.element?_=x.route.element:_=d,A.createElement(fN,{match:x,routeContext:{outlet:d,matches:w,isDataRoute:r!=null},children:_})};return r&&(x.route.ErrorBoundary||x.route.errorElement||m===0)?A.createElement(uN,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:E(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):E()},null)}function Zp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hN(e){let t=A.useContext(oc);return lr(t,Zp(e)),t}function xN(e){let t=A.useContext(Ld);return lr(t,Zp(e)),t}function mN(e){let t=A.useContext(Tn);return lr(t,Zp(e)),t}function Jp(e){let t=mN(e),r=t.matches[t.matches.length-1];return lr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function pN(){return Jp("useRouteId")}function gN(){var a;let e=A.useContext(Qp),t=xN("useRouteError"),r=Jp("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[r]}function vN(){let{router:e}=hN("useNavigate"),t=Jp("useNavigate"),r=A.useRef(!1);return HS(()=>{r.current=!0}),A.useCallback(async(n,l={})=>{_n(r.current,zS),r.current&&(typeof n=="number"?e.navigate(n):await e.navigate(n,{fromRouteId:t,...l}))},[e,t])}var rb={};function VS(e,t,r){!t&&!rb[e]&&(rb[e]=!0,_n(!1,r))}A.memo(yN);function yN({routes:e,future:t,state:r}){return GS(e,void 0,r,t)}function wm({to:e,replace:t,state:r,relative:a}){lr(cc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=A.useContext(qn);_n(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=A.useContext(Tn),{pathname:o}=xs(),f=ja(),d=Kp(e,Yp(l),o,a==="path"),x=JSON.stringify(d);return A.useEffect(()=>{f(JSON.parse(x),{replace:t,state:r,relative:a})},[f,x,a,t,r]),null}function Bs(e){return iN(e.context)}function ft(e){lr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function bN({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:l=!1}){lr(!cc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=A.useMemo(()=>({basename:o,navigator:n,static:l,future:{}}),[o,n,l]);typeof r=="string"&&(r=lc(r));let{pathname:d="/",search:x="",hash:m="",state:p=null,key:v="default"}=r,y=A.useMemo(()=>{let b=Vs(d,o);return b==null?null:{location:{pathname:b,search:x,hash:m,state:p,key:v},navigationType:a}},[o,d,x,m,p,v,a]);return _n(y!=null,`<Router basename="${o}"> is not able to match the URL "${d}${x}${m}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:A.createElement(qn.Provider,{value:f},A.createElement(su.Provider,{children:t,value:y}))}function wN({children:e,location:t}){return lN(ip(e),t)}function ip(e,t=[]){let r=[];return A.Children.forEach(e,(a,n)=>{if(!A.isValidElement(a))return;let l=[...t,n];if(a.type===A.Fragment){r.push.apply(r,ip(a.props.children,l));return}lr(a.type===ft,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),lr(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=ip(a.props.children,l)),r.push(o)}),r}var sd="get",id="application/x-www-form-urlencoded";function Bd(e){return e!=null&&typeof e.tagName=="string"}function SN(e){return Bd(e)&&e.tagName.toLowerCase()==="button"}function EN(e){return Bd(e)&&e.tagName.toLowerCase()==="form"}function _N(e){return Bd(e)&&e.tagName.toLowerCase()==="input"}function kN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function TN(e,t){return e.button===0&&(!t||t==="_self")&&!kN(e)}function lp(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function NN(e,t){let r=lp(e);return t&&t.forEach((a,n)=>{r.has(n)||t.getAll(n).forEach(l=>{r.append(n,l)})}),r}var Bf=null;function CN(){if(Bf===null)try{new FormData(document.createElement("form"),0),Bf=!1}catch{Bf=!0}return Bf}var AN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sm(e){return e!=null&&!AN.has(e)?(_n(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${id}"`),null):e}function jN(e,t){let r,a,n,l,o;if(EN(e)){let f=e.getAttribute("action");a=f?Vs(f,t):null,r=e.getAttribute("method")||sd,n=Sm(e.getAttribute("enctype"))||id,l=new FormData(e)}else if(SN(e)||_N(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||f.getAttribute("action");if(a=d?Vs(d,t):null,r=e.getAttribute("formmethod")||f.getAttribute("method")||sd,n=Sm(e.getAttribute("formenctype"))||Sm(f.getAttribute("enctype"))||id,l=new FormData(f,e),!CN()){let{name:x,type:m,value:p}=e;if(m==="image"){let v=x?`${x}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else x&&l.append(x,p)}}else{if(Bd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=sd,a=null,n=id,o=e}return l&&n==="text/plain"&&(o=l,l=void 0),{action:a,method:r.toLowerCase(),encType:n,formData:l,body:o}}function eg(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function RN(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function DN(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function FN(e,t,r){let a=await Promise.all(e.map(async n=>{let l=t.routes[n.route.id];if(l){let o=await RN(l,r);return o.links?o.links():[]}return[]}));return BN(a.flat(1).filter(DN).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function ab(e,t,r,a,n,l){let o=(d,x)=>r[x]?d.route.id!==r[x].route.id:!0,f=(d,x)=>{var m;return r[x].pathname!==d.pathname||((m=r[x].route.path)==null?void 0:m.endsWith("*"))&&r[x].params["*"]!==d.params["*"]};return l==="assets"?t.filter((d,x)=>o(d,x)||f(d,x)):l==="data"?t.filter((d,x)=>{var p;let m=a.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(o(d,x)||f(d,x))return!0;if(d.route.shouldRevalidate){let v=d.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function ON(e,t,{includeHydrateFallback:r}={}){return MN(e.map(a=>{let n=t.routes[a.route.id];if(!n)return[];let l=[n.module];return n.clientActionModule&&(l=l.concat(n.clientActionModule)),n.clientLoaderModule&&(l=l.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(l=l.concat(n.hydrateFallbackModule)),n.imports&&(l=l.concat(n.imports)),l}).flat(1))}function MN(e){return[...new Set(e)]}function LN(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function BN(e,t){let r=new Set;return new Set(t),e.reduce((a,n)=>{let l=JSON.stringify(LN(n));return r.has(l)||(r.add(l),a.push({key:l,link:n})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var PN=new Set([100,101,204,205]);function IN(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Vs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function qS(){let e=A.useContext(oc);return eg(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function UN(){let e=A.useContext(Ld);return eg(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var tg=A.createContext(void 0);tg.displayName="FrameworkContext";function WS(){let e=A.useContext(tg);return eg(e,"You must render this element inside a <HydratedRouter> element"),e}function zN(e,t){let r=A.useContext(tg),[a,n]=A.useState(!1),[l,o]=A.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:x,onMouseLeave:m,onTouchStart:p}=t,v=A.useRef(null);A.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let w=_=>{_.forEach(N=>{o(N.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[e]),A.useEffect(()=>{if(a){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[a]);let y=()=>{n(!0)},b=()=>{n(!1),o(!1)};return r?e!=="intent"?[l,v,{}]:[l,v,{onFocus:m0(f,y),onBlur:m0(d,b),onMouseEnter:m0(x,y),onMouseLeave:m0(m,b),onTouchStart:m0(p,y)}]:[!1,v,{}]}function m0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function HN({page:e,...t}){let{router:r}=qS(),a=A.useMemo(()=>LS(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?A.createElement(VN,{page:e,matches:a,...t}):null}function GN(e){let{manifest:t,routeModules:r}=WS(),[a,n]=A.useState([]);return A.useEffect(()=>{let l=!1;return FN(e,t,r).then(o=>{l||n(o)}),()=>{l=!0}},[e,t,r]),a}function VN({page:e,matches:t,...r}){let a=xs(),{manifest:n,routeModules:l}=WS(),{basename:o}=qS(),{loaderData:f,matches:d}=UN(),x=A.useMemo(()=>ab(e,t,d,n,a,"data"),[e,t,d,n,a]),m=A.useMemo(()=>ab(e,t,d,n,a,"assets"),[e,t,d,n,a]),p=A.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let b=new Set,w=!1;if(t.forEach(_=>{var k;let N=n.routes[_.route.id];!N||!N.hasLoader||(!x.some(F=>F.route.id===_.route.id)&&_.route.id in f&&((k=l[_.route.id])!=null&&k.shouldRevalidate)||N.hasClientLoader?w=!0:b.add(_.route.id))}),b.size===0)return[];let E=IN(e,o);return w&&b.size>0&&E.searchParams.set("_routes",t.filter(_=>b.has(_.route.id)).map(_=>_.route.id).join(",")),[E.pathname+E.search]},[o,f,a,n,x,t,e,l]),v=A.useMemo(()=>ON(m,n),[m,n]),y=GN(m);return A.createElement(A.Fragment,null,p.map(b=>A.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),v.map(b=>A.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),y.map(({key:b,link:w})=>A.createElement("link",{key:b,...w})))}function qN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var XS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{XS&&(window.__reactRouterVersion="7.6.2")}catch{}function WN({basename:e,children:t,window:r}){let a=A.useRef();a.current==null&&(a.current=jT({window:r,v5Compat:!0}));let n=a.current,[l,o]=A.useState({action:n.action,location:n.location}),f=A.useCallback(d=>{A.startTransition(()=>o(d))},[o]);return A.useLayoutEffect(()=>n.listen(f),[n,f]),A.createElement(bN,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:n})}var $S=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tl=A.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:n,reloadDocument:l,replace:o,state:f,target:d,to:x,preventScrollReset:m,viewTransition:p,...v},y){let{basename:b}=A.useContext(qn),w=typeof x=="string"&&$S.test(x),E,_=!1;if(typeof x=="string"&&w&&(E=x,XS))try{let O=new URL(window.location.href),V=x.startsWith("//")?new URL(O.protocol+x):new URL(x),z=Vs(V.pathname,b);V.origin===O.origin&&z!=null?x=z+V.search+V.hash:_=!0}catch{_n(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=aN(x,{relative:n}),[k,F,j]=zN(a,v),R=YN(x,{replace:o,state:f,target:d,preventScrollReset:m,relative:n,viewTransition:p});function T(O){t&&t(O),O.defaultPrevented||R(O)}let C=A.createElement("a",{...v,...j,href:E||N,onClick:_||l?t:T,ref:qN(y,F),target:d,"data-discover":!w&&r==="render"?"true":void 0});return k&&!w?A.createElement(A.Fragment,null,C,A.createElement(HN,{page:N})):C});Tl.displayName="Link";var M0=A.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:n=!1,style:l,to:o,viewTransition:f,children:d,...x},m){let p=iu(o,{relative:x.relative}),v=xs(),y=A.useContext(Ld),{navigator:b,basename:w}=A.useContext(qn),E=y!=null&&e5(p)&&f===!0,_=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,N=v.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(N=N.toLowerCase(),k=k?k.toLowerCase():null,_=_.toLowerCase()),k&&w&&(k=Vs(k,w)||k);const F=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let j=N===_||!n&&N.startsWith(_)&&N.charAt(F)==="/",R=k!=null&&(k===_||!n&&k.startsWith(_)&&k.charAt(_.length)==="/"),T={isActive:j,isPending:R,isTransitioning:E},C=j?t:void 0,O;typeof a=="function"?O=a(T):O=[a,j?"active":null,R?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let V=typeof l=="function"?l(T):l;return A.createElement(Tl,{...x,"aria-current":C,className:O,ref:m,style:V,to:o,viewTransition:f},typeof d=="function"?d(T):d)});M0.displayName="NavLink";var XN=A.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:l,method:o=sd,action:f,onSubmit:d,relative:x,preventScrollReset:m,viewTransition:p,...v},y)=>{let b=ZN(),w=JN(f,{relative:x}),E=o.toLowerCase()==="get"?"get":"post",_=typeof f=="string"&&$S.test(f),N=k=>{if(d&&d(k),k.defaultPrevented)return;k.preventDefault();let F=k.nativeEvent.submitter,j=(F==null?void 0:F.getAttribute("formmethod"))||o;b(F||k.currentTarget,{fetcherKey:t,method:j,navigate:r,replace:n,state:l,relative:x,preventScrollReset:m,viewTransition:p})};return A.createElement("form",{ref:y,method:E,action:w,onSubmit:a?d:N,...v,"data-discover":!_&&e==="render"?"true":void 0})});XN.displayName="Form";function $N(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YS(e){let t=A.useContext(oc);return lr(t,$N(e)),t}function YN(e,{target:t,replace:r,state:a,preventScrollReset:n,relative:l,viewTransition:o}={}){let f=ja(),d=xs(),x=iu(e,{relative:l});return A.useCallback(m=>{if(TN(m,t)){m.preventDefault();let p=r!==void 0?r:O0(d)===O0(x);f(e,{replace:p,state:a,preventScrollReset:n,relative:l,viewTransition:o})}},[d,f,x,r,a,t,e,n,l,o])}function KS(e){_n(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=A.useRef(lp(e)),r=A.useRef(!1),a=xs(),n=A.useMemo(()=>NN(a.search,r.current?null:t.current),[a.search]),l=ja(),o=A.useCallback((f,d)=>{const x=lp(typeof f=="function"?f(n):f);r.current=!0,l("?"+x,d)},[l,n]);return[n,o]}var KN=0,QN=()=>`__${String(++KN)}__`;function ZN(){let{router:e}=YS("useSubmit"),{basename:t}=A.useContext(qn),r=pN();return A.useCallback(async(a,n={})=>{let{action:l,method:o,encType:f,formData:d,body:x}=jN(a,t);if(n.navigate===!1){let m=n.fetcherKey||QN();await e.fetch(m,r,n.action||l,{preventScrollReset:n.preventScrollReset,formData:d,body:x,formMethod:n.method||o,formEncType:n.encType||f,flushSync:n.flushSync})}else await e.navigate(n.action||l,{preventScrollReset:n.preventScrollReset,formData:d,body:x,formMethod:n.method||o,formEncType:n.encType||f,replace:n.replace,state:n.state,fromRouteId:r,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,r])}function JN(e,{relative:t}={}){let{basename:r}=A.useContext(qn),a=A.useContext(Tn);lr(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),l={...iu(e||".",{relative:t})},o=xs();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),d=f.getAll("index");if(d.some(m=>m==="")){f.delete("index"),d.filter(p=>p).forEach(p=>f.append("index",p));let m=f.toString();l.search=m?`?${m}`:""}}return(!e||e===".")&&n.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:Is([r,l.pathname])),O0(l)}function e5(e,t={}){let r=A.useContext(US);lr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=YS("useViewTransitionState"),n=iu(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=Vs(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=Vs(r.nextLocation.pathname,a)||r.nextLocation.pathname;return pd(n.pathname,o)!=null||pd(n.pathname,l)!=null}[...PN];var QS=Md();const ZS=A.createContext({theme:"light",toggle:()=>{}}),t5=()=>A.useContext(ZS);function r5({children:e}){const[t,r]=A.useState("light"),a=()=>r(n=>n==="light"?"dark":"light");return A.useEffect(()=>{document.documentElement.classList.toggle("dark",t==="dark")},[t]),c.jsx(ZS.Provider,{value:{theme:t,toggle:a},children:e})}function JS(e,t){return function(){return e.apply(t,arguments)}}const{toString:a5}=Object.prototype,{getPrototypeOf:rg}=Object,{iterator:Pd,toStringTag:e4}=Symbol,Id=(e=>t=>{const r=a5.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Wn=e=>(e=e.toLowerCase(),t=>Id(t)===e),Ud=e=>t=>typeof t===e,{isArray:uc}=Array,L0=Ud("undefined");function n5(e){return e!==null&&!L0(e)&&e.constructor!==null&&!L0(e.constructor)&&Ia(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const t4=Wn("ArrayBuffer");function s5(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&t4(e.buffer),t}const i5=Ud("string"),Ia=Ud("function"),r4=Ud("number"),zd=e=>e!==null&&typeof e=="object",l5=e=>e===!0||e===!1,ld=e=>{if(Id(e)!=="object")return!1;const t=rg(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(e4 in e)&&!(Pd in e)},o5=Wn("Date"),c5=Wn("File"),u5=Wn("Blob"),f5=Wn("FileList"),d5=e=>zd(e)&&Ia(e.pipe),h5=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ia(e.append)&&((t=Id(e))==="formdata"||t==="object"&&Ia(e.toString)&&e.toString()==="[object FormData]"))},x5=Wn("URLSearchParams"),[m5,p5,g5,v5]=["ReadableStream","Request","Response","Headers"].map(Wn),y5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function lu(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),uc(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let f;for(a=0;a<o;a++)f=l[a],t.call(null,e[f],f,e)}}function a4(e,t){t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const hl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,n4=e=>!L0(e)&&e!==hl;function op(){const{caseless:e}=n4(this)&&this||{},t={},r=(a,n)=>{const l=e&&a4(t,n)||n;ld(t[l])&&ld(a)?t[l]=op(t[l],a):ld(a)?t[l]=op({},a):uc(a)?t[l]=a.slice():t[l]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&lu(arguments[a],r);return t}const b5=(e,t,r,{allOwnKeys:a}={})=>(lu(t,(n,l)=>{r&&Ia(n)?e[l]=JS(n,r):e[l]=n},{allOwnKeys:a}),e),w5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),S5=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},E5=(e,t,r,a)=>{let n,l,o;const f={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),l=n.length;l-- >0;)o=n[l],(!a||a(o,e,t))&&!f[o]&&(t[o]=e[o],f[o]=!0);e=r!==!1&&rg(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},_5=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},k5=e=>{if(!e)return null;if(uc(e))return e;let t=e.length;if(!r4(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},T5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&rg(Uint8Array)),N5=(e,t)=>{const a=(e&&e[Pd]).call(e);let n;for(;(n=a.next())&&!n.done;){const l=n.value;t.call(e,l[0],l[1])}},C5=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},A5=Wn("HTMLFormElement"),j5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),nb=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),R5=Wn("RegExp"),s4=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};lu(r,(n,l)=>{let o;(o=t(n,l,e))!==!1&&(a[l]=o||n)}),Object.defineProperties(e,a)},D5=e=>{s4(e,(t,r)=>{if(Ia(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(Ia(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},F5=(e,t)=>{const r={},a=n=>{n.forEach(l=>{r[l]=!0})};return uc(e)?a(e):a(String(e).split(t)),r},O5=()=>{},M5=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function L5(e){return!!(e&&Ia(e.append)&&e[e4]==="FormData"&&e[Pd])}const B5=e=>{const t=new Array(10),r=(a,n)=>{if(zd(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[n]=a;const l=uc(a)?[]:{};return lu(a,(o,f)=>{const d=r(o,n+1);!L0(d)&&(l[f]=d)}),t[n]=void 0,l}}return a};return r(e,0)},P5=Wn("AsyncFunction"),I5=e=>e&&(zd(e)||Ia(e))&&Ia(e.then)&&Ia(e.catch),i4=((e,t)=>e?setImmediate:t?((r,a)=>(hl.addEventListener("message",({source:n,data:l})=>{n===hl&&l===r&&a.length&&a.shift()()},!1),n=>{a.push(n),hl.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ia(hl.postMessage)),U5=typeof queueMicrotask<"u"?queueMicrotask.bind(hl):typeof process<"u"&&process.nextTick||i4,z5=e=>e!=null&&Ia(e[Pd]),ye={isArray:uc,isArrayBuffer:t4,isBuffer:n5,isFormData:h5,isArrayBufferView:s5,isString:i5,isNumber:r4,isBoolean:l5,isObject:zd,isPlainObject:ld,isReadableStream:m5,isRequest:p5,isResponse:g5,isHeaders:v5,isUndefined:L0,isDate:o5,isFile:c5,isBlob:u5,isRegExp:R5,isFunction:Ia,isStream:d5,isURLSearchParams:x5,isTypedArray:T5,isFileList:f5,forEach:lu,merge:op,extend:b5,trim:y5,stripBOM:w5,inherits:S5,toFlatObject:E5,kindOf:Id,kindOfTest:Wn,endsWith:_5,toArray:k5,forEachEntry:N5,matchAll:C5,isHTMLForm:A5,hasOwnProperty:nb,hasOwnProp:nb,reduceDescriptors:s4,freezeMethods:D5,toObjectSet:F5,toCamelCase:j5,noop:O5,toFiniteNumber:M5,findKey:a4,global:hl,isContextDefined:n4,isSpecCompliantForm:L5,toJSONObject:B5,isAsyncFn:P5,isThenable:I5,setImmediate:i4,asap:U5,isIterable:z5};function dt(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}ye.inherits(dt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ye.toJSONObject(this.config),code:this.code,status:this.status}}});const l4=dt.prototype,o4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{o4[e]={value:e}});Object.defineProperties(dt,o4);Object.defineProperty(l4,"isAxiosError",{value:!0});dt.from=(e,t,r,a,n,l)=>{const o=Object.create(l4);return ye.toFlatObject(e,o,function(d){return d!==Error.prototype},f=>f!=="isAxiosError"),dt.call(o,e.message,t,r,a,n),o.cause=e,o.name=e.name,l&&Object.assign(o,l),o};const H5=null;function cp(e){return ye.isPlainObject(e)||ye.isArray(e)}function c4(e){return ye.endsWith(e,"[]")?e.slice(0,-2):e}function sb(e,t,r){return e?e.concat(t).map(function(n,l){return n=c4(n),!r&&l?"["+n+"]":n}).join(r?".":""):t}function G5(e){return ye.isArray(e)&&!e.some(cp)}const V5=ye.toFlatObject(ye,{},null,function(t){return/^is[A-Z]/.test(t)});function Hd(e,t,r){if(!ye.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ye.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,E){return!ye.isUndefined(E[w])});const a=r.metaTokens,n=r.visitor||m,l=r.dots,o=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&ye.isSpecCompliantForm(t);if(!ye.isFunction(n))throw new TypeError("visitor must be a function");function x(b){if(b===null)return"";if(ye.isDate(b))return b.toISOString();if(!d&&ye.isBlob(b))throw new dt("Blob is not supported. Use a Buffer instead.");return ye.isArrayBuffer(b)||ye.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function m(b,w,E){let _=b;if(b&&!E&&typeof b=="object"){if(ye.endsWith(w,"{}"))w=a?w:w.slice(0,-2),b=JSON.stringify(b);else if(ye.isArray(b)&&G5(b)||(ye.isFileList(b)||ye.endsWith(w,"[]"))&&(_=ye.toArray(b)))return w=c4(w),_.forEach(function(k,F){!(ye.isUndefined(k)||k===null)&&t.append(o===!0?sb([w],F,l):o===null?w:w+"[]",x(k))}),!1}return cp(b)?!0:(t.append(sb(E,w,l),x(b)),!1)}const p=[],v=Object.assign(V5,{defaultVisitor:m,convertValue:x,isVisitable:cp});function y(b,w){if(!ye.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+w.join("."));p.push(b),ye.forEach(b,function(_,N){(!(ye.isUndefined(_)||_===null)&&n.call(t,_,ye.isString(N)?N.trim():N,w,v))===!0&&y(_,w?w.concat(N):[N])}),p.pop()}}if(!ye.isObject(e))throw new TypeError("data must be an object");return y(e),t}function ib(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function ag(e,t){this._pairs=[],e&&Hd(e,this,t)}const u4=ag.prototype;u4.append=function(t,r){this._pairs.push([t,r])};u4.toString=function(t){const r=t?function(a){return t.call(this,a,ib)}:ib;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function q5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function f4(e,t,r){if(!t)return e;const a=r&&r.encode||q5;ye.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(t,r):l=ye.isURLSearchParams(t)?t.toString():new ag(t,r).toString(a),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class lb{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ye.forEach(this.handlers,function(a){a!==null&&t(a)})}}const d4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},W5=typeof URLSearchParams<"u"?URLSearchParams:ag,X5=typeof FormData<"u"?FormData:null,$5=typeof Blob<"u"?Blob:null,Y5={isBrowser:!0,classes:{URLSearchParams:W5,FormData:X5,Blob:$5},protocols:["http","https","file","blob","url","data"]},ng=typeof window<"u"&&typeof document<"u",up=typeof navigator=="object"&&navigator||void 0,K5=ng&&(!up||["ReactNative","NativeScript","NS"].indexOf(up.product)<0),Q5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Z5=ng&&window.location.href||"http://localhost",J5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ng,hasStandardBrowserEnv:K5,hasStandardBrowserWebWorkerEnv:Q5,navigator:up,origin:Z5},Symbol.toStringTag,{value:"Module"})),xa={...J5,...Y5};function eC(e,t){return Hd(e,new xa.classes.URLSearchParams,Object.assign({visitor:function(r,a,n,l){return xa.isNode&&ye.isBuffer(r)?(this.append(a,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function tC(e){return ye.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function rC(e){const t={},r=Object.keys(e);let a;const n=r.length;let l;for(a=0;a<n;a++)l=r[a],t[l]=e[l];return t}function h4(e){function t(r,a,n,l){let o=r[l++];if(o==="__proto__")return!0;const f=Number.isFinite(+o),d=l>=r.length;return o=!o&&ye.isArray(n)?n.length:o,d?(ye.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!f):((!n[o]||!ye.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],l)&&ye.isArray(n[o])&&(n[o]=rC(n[o])),!f)}if(ye.isFormData(e)&&ye.isFunction(e.entries)){const r={};return ye.forEachEntry(e,(a,n)=>{t(tC(a),n,r,0)}),r}return null}function aC(e,t,r){if(ye.isString(e))try{return(t||JSON.parse)(e),ye.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const ou={transitional:d4,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,l=ye.isObject(t);if(l&&ye.isHTMLForm(t)&&(t=new FormData(t)),ye.isFormData(t))return n?JSON.stringify(h4(t)):t;if(ye.isArrayBuffer(t)||ye.isBuffer(t)||ye.isStream(t)||ye.isFile(t)||ye.isBlob(t)||ye.isReadableStream(t))return t;if(ye.isArrayBufferView(t))return t.buffer;if(ye.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return eC(t,this.formSerializer).toString();if((f=ye.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Hd(f?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),aC(t)):t}],transformResponse:[function(t){const r=this.transitional||ou.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(ye.isResponse(t)||ye.isReadableStream(t))return t;if(t&&ye.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(f){if(o)throw f.name==="SyntaxError"?dt.from(f,dt.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xa.classes.FormData,Blob:xa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ye.forEach(["delete","get","head","post","put","patch"],e=>{ou.headers[e]={}});const nC=ye.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sC=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&nC[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},ob=Symbol("internals");function p0(e){return e&&String(e).trim().toLowerCase()}function od(e){return e===!1||e==null?e:ye.isArray(e)?e.map(od):String(e)}function iC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const lC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Em(e,t,r,a,n){if(ye.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!ye.isString(t)){if(ye.isString(a))return t.indexOf(a)!==-1;if(ye.isRegExp(a))return a.test(t)}}function oC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function cC(e,t){const r=ye.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,l,o){return this[a].call(this,t,n,l,o)},configurable:!0})})}let Ua=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function l(f,d,x){const m=p0(d);if(!m)throw new Error("header name must be a non-empty string");const p=ye.findKey(n,m);(!p||n[p]===void 0||x===!0||x===void 0&&n[p]!==!1)&&(n[p||d]=od(f))}const o=(f,d)=>ye.forEach(f,(x,m)=>l(x,m,d));if(ye.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ye.isString(t)&&(t=t.trim())&&!lC(t))o(sC(t),r);else if(ye.isObject(t)&&ye.isIterable(t)){let f={},d,x;for(const m of t){if(!ye.isArray(m))throw TypeError("Object iterator must return a key-value pair");f[x=m[0]]=(d=f[x])?ye.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}o(f,r)}else t!=null&&l(r,t,a);return this}get(t,r){if(t=p0(t),t){const a=ye.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return iC(n);if(ye.isFunction(r))return r.call(this,n,a);if(ye.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=p0(t),t){const a=ye.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||Em(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function l(o){if(o=p0(o),o){const f=ye.findKey(a,o);f&&(!r||Em(a,a[f],f,r))&&(delete a[f],n=!0)}}return ye.isArray(t)?t.forEach(l):l(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const l=r[a];(!t||Em(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const r=this,a={};return ye.forEach(this,(n,l)=>{const o=ye.findKey(a,l);if(o){r[o]=od(n),delete r[l];return}const f=t?oC(l):String(l).trim();f!==l&&delete r[l],r[f]=od(n),a[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ye.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&ye.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[ob]=this[ob]={accessors:{}}).accessors,n=this.prototype;function l(o){const f=p0(o);a[f]||(cC(n,o),a[f]=!0)}return ye.isArray(t)?t.forEach(l):l(t),this}};Ua.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ye.reduceDescriptors(Ua.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});ye.freezeMethods(Ua);function _m(e,t){const r=this||ou,a=t||r,n=Ua.from(a.headers);let l=a.data;return ye.forEach(e,function(f){l=f.call(r,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function x4(e){return!!(e&&e.__CANCEL__)}function fc(e,t,r){dt.call(this,e??"canceled",dt.ERR_CANCELED,t,r),this.name="CanceledError"}ye.inherits(fc,dt,{__CANCEL__:!0});function m4(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new dt("Request failed with status code "+r.status,[dt.ERR_BAD_REQUEST,dt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function uC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function fC(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,l=0,o;return t=t!==void 0?t:1e3,function(d){const x=Date.now(),m=a[l];o||(o=x),r[n]=d,a[n]=x;let p=l,v=0;for(;p!==n;)v+=r[p++],p=p%e;if(n=(n+1)%e,n===l&&(l=(l+1)%e),x-o<t)return;const y=m&&x-m;return y?Math.round(v*1e3/y):void 0}}function dC(e,t){let r=0,a=1e3/t,n,l;const o=(x,m=Date.now())=>{r=m,n=null,l&&(clearTimeout(l),l=null),e.apply(null,x)};return[(...x)=>{const m=Date.now(),p=m-r;p>=a?o(x,m):(n=x,l||(l=setTimeout(()=>{l=null,o(n)},a-p)))},()=>n&&o(n)]}const gd=(e,t,r=3)=>{let a=0;const n=fC(50,250);return dC(l=>{const o=l.loaded,f=l.lengthComputable?l.total:void 0,d=o-a,x=n(d),m=o<=f;a=o;const p={loaded:o,total:f,progress:f?o/f:void 0,bytes:d,rate:x||void 0,estimated:x&&f&&m?(f-o)/x:void 0,event:l,lengthComputable:f!=null,[t?"download":"upload"]:!0};e(p)},r)},cb=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},ub=e=>(...t)=>ye.asap(()=>e(...t)),hC=xa.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,xa.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(xa.origin),xa.navigator&&/(msie|trident)/i.test(xa.navigator.userAgent)):()=>!0,xC=xa.hasStandardBrowserEnv?{write(e,t,r,a,n,l){const o=[e+"="+encodeURIComponent(t)];ye.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),ye.isString(a)&&o.push("path="+a),ye.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function mC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function pC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function p4(e,t,r){let a=!mC(t);return e&&(a||r==!1)?pC(e,t):t}const fb=e=>e instanceof Ua?{...e}:e;function Dl(e,t){t=t||{};const r={};function a(x,m,p,v){return ye.isPlainObject(x)&&ye.isPlainObject(m)?ye.merge.call({caseless:v},x,m):ye.isPlainObject(m)?ye.merge({},m):ye.isArray(m)?m.slice():m}function n(x,m,p,v){if(ye.isUndefined(m)){if(!ye.isUndefined(x))return a(void 0,x,p,v)}else return a(x,m,p,v)}function l(x,m){if(!ye.isUndefined(m))return a(void 0,m)}function o(x,m){if(ye.isUndefined(m)){if(!ye.isUndefined(x))return a(void 0,x)}else return a(void 0,m)}function f(x,m,p){if(p in t)return a(x,m);if(p in e)return a(void 0,x)}const d={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:f,headers:(x,m,p)=>n(fb(x),fb(m),p,!0)};return ye.forEach(Object.keys(Object.assign({},e,t)),function(m){const p=d[m]||n,v=p(e[m],t[m],m);ye.isUndefined(v)&&p!==f||(r[m]=v)}),r}const g4=e=>{const t=Dl({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:f}=t;t.headers=o=Ua.from(o),t.url=f4(p4(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&o.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let d;if(ye.isFormData(r)){if(xa.hasStandardBrowserEnv||xa.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((d=o.getContentType())!==!1){const[x,...m]=d?d.split(";").map(p=>p.trim()).filter(Boolean):[];o.setContentType([x||"multipart/form-data",...m].join("; "))}}if(xa.hasStandardBrowserEnv&&(a&&ye.isFunction(a)&&(a=a(t)),a||a!==!1&&hC(t.url))){const x=n&&l&&xC.read(l);x&&o.set(n,x)}return t},gC=typeof XMLHttpRequest<"u",vC=gC&&function(e){return new Promise(function(r,a){const n=g4(e);let l=n.data;const o=Ua.from(n.headers).normalize();let{responseType:f,onUploadProgress:d,onDownloadProgress:x}=n,m,p,v,y,b;function w(){y&&y(),b&&b(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function _(){if(!E)return;const k=Ua.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),j={data:!f||f==="text"||f==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:k,config:e,request:E};m4(function(T){r(T),w()},function(T){a(T),w()},j),E=null}"onloadend"in E?E.onloadend=_:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(_)},E.onabort=function(){E&&(a(new dt("Request aborted",dt.ECONNABORTED,e,E)),E=null)},E.onerror=function(){a(new dt("Network Error",dt.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let F=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const j=n.transitional||d4;n.timeoutErrorMessage&&(F=n.timeoutErrorMessage),a(new dt(F,j.clarifyTimeoutError?dt.ETIMEDOUT:dt.ECONNABORTED,e,E)),E=null},l===void 0&&o.setContentType(null),"setRequestHeader"in E&&ye.forEach(o.toJSON(),function(F,j){E.setRequestHeader(j,F)}),ye.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),f&&f!=="json"&&(E.responseType=n.responseType),x&&([v,b]=gd(x,!0),E.addEventListener("progress",v)),d&&E.upload&&([p,y]=gd(d),E.upload.addEventListener("progress",p),E.upload.addEventListener("loadend",y)),(n.cancelToken||n.signal)&&(m=k=>{E&&(a(!k||k.type?new fc(null,e,E):k),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const N=uC(n.url);if(N&&xa.protocols.indexOf(N)===-1){a(new dt("Unsupported protocol "+N+":",dt.ERR_BAD_REQUEST,e));return}E.send(l||null)})},yC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const l=function(x){if(!n){n=!0,f();const m=x instanceof Error?x:this.reason;a.abort(m instanceof dt?m:new fc(m instanceof Error?m.message:m))}};let o=t&&setTimeout(()=>{o=null,l(new dt(`timeout ${t} of ms exceeded`,dt.ETIMEDOUT))},t);const f=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:d}=a;return d.unsubscribe=()=>ye.asap(f),d}},bC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},wC=async function*(e,t){for await(const r of SC(e))yield*bC(r,t)},SC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},db=(e,t,r,a)=>{const n=wC(e,t);let l=0,o,f=d=>{o||(o=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:x,value:m}=await n.next();if(x){f(),d.close();return}let p=m.byteLength;if(r){let v=l+=p;r(v)}d.enqueue(new Uint8Array(m))}catch(x){throw f(x),x}},cancel(d){return f(d),n.return()}},{highWaterMark:2})},Gd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",v4=Gd&&typeof ReadableStream=="function",EC=Gd&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),y4=(e,...t)=>{try{return!!e(...t)}catch{return!1}},_C=v4&&y4(()=>{let e=!1;const t=new Request(xa.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),hb=64*1024,fp=v4&&y4(()=>ye.isReadableStream(new Response("").body)),vd={stream:fp&&(e=>e.body)};Gd&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!vd[t]&&(vd[t]=ye.isFunction(e[t])?r=>r[t]():(r,a)=>{throw new dt(`Response type '${t}' is not supported`,dt.ERR_NOT_SUPPORT,a)})})})(new Response);const kC=async e=>{if(e==null)return 0;if(ye.isBlob(e))return e.size;if(ye.isSpecCompliantForm(e))return(await new Request(xa.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ye.isArrayBufferView(e)||ye.isArrayBuffer(e))return e.byteLength;if(ye.isURLSearchParams(e)&&(e=e+""),ye.isString(e))return(await EC(e)).byteLength},TC=async(e,t)=>{const r=ye.toFiniteNumber(e.getContentLength());return r??kC(t)},NC=Gd&&(async e=>{let{url:t,method:r,data:a,signal:n,cancelToken:l,timeout:o,onDownloadProgress:f,onUploadProgress:d,responseType:x,headers:m,withCredentials:p="same-origin",fetchOptions:v}=g4(e);x=x?(x+"").toLowerCase():"text";let y=yC([n,l&&l.toAbortSignal()],o),b;const w=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let E;try{if(d&&_C&&r!=="get"&&r!=="head"&&(E=await TC(m,a))!==0){let j=new Request(t,{method:"POST",body:a,duplex:"half"}),R;if(ye.isFormData(a)&&(R=j.headers.get("content-type"))&&m.setContentType(R),j.body){const[T,C]=cb(E,gd(ub(d)));a=db(j.body,hb,T,C)}}ye.isString(p)||(p=p?"include":"omit");const _="credentials"in Request.prototype;b=new Request(t,{...v,signal:y,method:r.toUpperCase(),headers:m.normalize().toJSON(),body:a,duplex:"half",credentials:_?p:void 0});let N=await fetch(b);const k=fp&&(x==="stream"||x==="response");if(fp&&(f||k&&w)){const j={};["status","statusText","headers"].forEach(O=>{j[O]=N[O]});const R=ye.toFiniteNumber(N.headers.get("content-length")),[T,C]=f&&cb(R,gd(ub(f),!0))||[];N=new Response(db(N.body,hb,T,()=>{C&&C(),w&&w()}),j)}x=x||"text";let F=await vd[ye.findKey(vd,x)||"text"](N,e);return!k&&w&&w(),await new Promise((j,R)=>{m4(j,R,{data:F,headers:Ua.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:b})})}catch(_){throw w&&w(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new dt("Network Error",dt.ERR_NETWORK,e,b),{cause:_.cause||_}):dt.from(_,_&&_.code,e,b)}}),dp={http:H5,xhr:vC,fetch:NC};ye.forEach(dp,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const xb=e=>`- ${e}`,CC=e=>ye.isFunction(e)||e===null||e===!1,b4={getAdapter:e=>{e=ye.isArray(e)?e:[e];const{length:t}=e;let r,a;const n={};for(let l=0;l<t;l++){r=e[l];let o;if(a=r,!CC(r)&&(a=dp[(o=String(r)).toLowerCase()],a===void 0))throw new dt(`Unknown adapter '${o}'`);if(a)break;n[o||"#"+l]=a}if(!a){const l=Object.entries(n).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=t?l.length>1?`since :
`+l.map(xb).join(`
`):" "+xb(l[0]):"as no adapter specified";throw new dt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:dp};function km(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new fc(null,e)}function mb(e){return km(e),e.headers=Ua.from(e.headers),e.data=_m.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),b4.getAdapter(e.adapter||ou.adapter)(e).then(function(a){return km(e),a.data=_m.call(e,e.transformResponse,a),a.headers=Ua.from(a.headers),a},function(a){return x4(a)||(km(e),a&&a.response&&(a.response.data=_m.call(e,e.transformResponse,a.response),a.response.headers=Ua.from(a.response.headers))),Promise.reject(a)})}const w4="1.9.0",Vd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Vd[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const pb={};Vd.transitional=function(t,r,a){function n(l,o){return"[Axios v"+w4+"] Transitional option '"+l+"'"+o+(a?". "+a:"")}return(l,o,f)=>{if(t===!1)throw new dt(n(o," has been removed"+(r?" in "+r:"")),dt.ERR_DEPRECATED);return r&&!pb[o]&&(pb[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,o,f):!0}};Vd.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function AC(e,t,r){if(typeof e!="object")throw new dt("options must be an object",dt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const l=a[n],o=t[l];if(o){const f=e[l],d=f===void 0||o(f,l,e);if(d!==!0)throw new dt("option "+l+" must be "+d,dt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new dt("Unknown option "+l,dt.ERR_BAD_OPTION)}}const cd={assertOptions:AC,validators:Vd},ns=cd.validators;let Nl=class{constructor(t){this.defaults=t||{},this.interceptors={request:new lb,response:new lb}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Dl(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:l}=r;a!==void 0&&cd.assertOptions(a,{silentJSONParsing:ns.transitional(ns.boolean),forcedJSONParsing:ns.transitional(ns.boolean),clarifyTimeoutError:ns.transitional(ns.boolean)},!1),n!=null&&(ye.isFunction(n)?r.paramsSerializer={serialize:n}:cd.assertOptions(n,{encode:ns.function,serialize:ns.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),cd.assertOptions(r,{baseUrl:ns.spelling("baseURL"),withXsrfToken:ns.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&ye.merge(l.common,l[r.method]);l&&ye.forEach(["delete","get","head","post","put","patch","common"],b=>{delete l[b]}),r.headers=Ua.concat(o,l);const f=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(r)===!1||(d=d&&w.synchronous,f.unshift(w.fulfilled,w.rejected))});const x=[];this.interceptors.response.forEach(function(w){x.push(w.fulfilled,w.rejected)});let m,p=0,v;if(!d){const b=[mb.bind(this),void 0];for(b.unshift.apply(b,f),b.push.apply(b,x),v=b.length,m=Promise.resolve(r);p<v;)m=m.then(b[p++],b[p++]);return m}v=f.length;let y=r;for(p=0;p<v;){const b=f[p++],w=f[p++];try{y=b(y)}catch(E){w.call(this,E);break}}try{m=mb.call(this,y)}catch(b){return Promise.reject(b)}for(p=0,v=x.length;p<v;)m=m.then(x[p++],x[p++]);return m}getUri(t){t=Dl(this.defaults,t);const r=p4(t.baseURL,t.url,t.allowAbsoluteUrls);return f4(r,t.params,t.paramsSerializer)}};ye.forEach(["delete","get","head","options"],function(t){Nl.prototype[t]=function(r,a){return this.request(Dl(a||{},{method:t,url:r,data:(a||{}).data}))}});ye.forEach(["post","put","patch"],function(t){function r(a){return function(l,o,f){return this.request(Dl(f||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Nl.prototype[t]=r(),Nl.prototype[t+"Form"]=r(!0)});let jC=class S4{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const a=this;this.promise.then(n=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](n);a._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(f=>{a.subscribe(f),l=f}).then(n);return o.cancel=function(){a.unsubscribe(l)},o},t(function(l,o,f){a.reason||(a.reason=new fc(l,o,f),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new S4(function(n){t=n}),cancel:t}}};function RC(e){return function(r){return e.apply(null,r)}}function DC(e){return ye.isObject(e)&&e.isAxiosError===!0}const hp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hp).forEach(([e,t])=>{hp[t]=e});function E4(e){const t=new Nl(e),r=JS(Nl.prototype.request,t);return ye.extend(r,Nl.prototype,t,{allOwnKeys:!0}),ye.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return E4(Dl(e,n))},r}const Tr=E4(ou);Tr.Axios=Nl;Tr.CanceledError=fc;Tr.CancelToken=jC;Tr.isCancel=x4;Tr.VERSION=w4;Tr.toFormData=Hd;Tr.AxiosError=dt;Tr.Cancel=Tr.CanceledError;Tr.all=function(t){return Promise.all(t)};Tr.spread=RC;Tr.isAxiosError=DC;Tr.mergeConfig=Dl;Tr.AxiosHeaders=Ua;Tr.formToJSON=e=>h4(ye.isHTMLForm(e)?new FormData(e):e);Tr.getAdapter=b4.getAdapter;Tr.HttpStatusCode=hp;Tr.default=Tr;const{Axios:cH,AxiosError:uH,CanceledError:fH,isCancel:dH,CancelToken:hH,VERSION:xH,all:mH,Cancel:pH,isAxiosError:gH,spread:vH,toFormData:yH,AxiosHeaders:bH,HttpStatusCode:wH,formToJSON:SH,getAdapter:EH,mergeConfig:_H}=Tr,Xe=Tr.create({baseURL:"https://api.bigdaysmanager.com/api/v1",headers:{"Content-Type":"application/json"}});Xe.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const r="abcd1234",a="my-big-day-prod";return e.headers.apiKey=r,e.headers.author=a,e});var dc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Fl=typeof window>"u"||"Deno"in globalThis;function _a(){}function FC(e,t){return typeof e=="function"?e(t):e}function xp(e){return typeof e=="number"&&e>=0&&e!==1/0}function _4(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Pi(e,t){return typeof e=="function"?e(t):e}function In(e,t){return typeof e=="function"?e(t):e}function gb(e,t){const{type:r="all",exact:a,fetchStatus:n,predicate:l,queryKey:o,stale:f}=e;if(o){if(a){if(t.queryHash!==sg(o,t.options))return!1}else if(!B0(t.queryKey,o))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof f=="boolean"&&t.isStale()!==f||n&&n!==t.state.fetchStatus||l&&!l(t))}function vb(e,t){const{exact:r,status:a,predicate:n,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(Ol(t.options.mutationKey)!==Ol(l))return!1}else if(!B0(t.options.mutationKey,l))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function sg(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ol)(e)}function Ol(e){return JSON.stringify(e,(t,r)=>mp(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function B0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>B0(e[r],t[r])):!1}function k4(e,t){if(e===t)return e;const r=yb(e)&&yb(t);if(r||mp(e)&&mp(t)){const a=r?e:Object.keys(e),n=a.length,l=r?t:Object.keys(t),o=l.length,f=r?[]:{},d=new Set(a);let x=0;for(let m=0;m<o;m++){const p=r?m:l[m];(!r&&d.has(p)||r)&&e[p]===void 0&&t[p]===void 0?(f[p]=void 0,x++):(f[p]=k4(e[p],t[p]),f[p]===e[p]&&e[p]!==void 0&&x++)}return n===o&&x===n?e:f}return t}function yd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function yb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function mp(e){if(!bb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!bb(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function bb(e){return Object.prototype.toString.call(e)==="[object Object]"}function OC(e){return new Promise(t=>{setTimeout(t,e)})}function pp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?k4(e,t):t}function MC(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function LC(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var ig=Symbol();function T4(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ig?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function N4(e,t){return typeof e=="function"?e(...t):!!e}var gl,ki,Vo,TS,BC=(TS=class extends dc{constructor(){super();Ke(this,gl);Ke(this,ki);Ke(this,Vo);He(this,Vo,t=>{if(!Fl&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ae(this,ki)||this.setEventListener(ae(this,Vo))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,ki))==null||t.call(this),He(this,ki,void 0))}setEventListener(t){var r;He(this,Vo,t),(r=ae(this,ki))==null||r.call(this),He(this,ki,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){ae(this,gl)!==t&&(He(this,gl,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ae(this,gl)=="boolean"?ae(this,gl):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},gl=new WeakMap,ki=new WeakMap,Vo=new WeakMap,TS),lg=new BC,qo,Ti,Wo,NS,PC=(NS=class extends dc{constructor(){super();Ke(this,qo,!0);Ke(this,Ti);Ke(this,Wo);He(this,Wo,t=>{if(!Fl&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){ae(this,Ti)||this.setEventListener(ae(this,Wo))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,Ti))==null||t.call(this),He(this,Ti,void 0))}setEventListener(t){var r;He(this,Wo,t),(r=ae(this,Ti))==null||r.call(this),He(this,Ti,t(this.setOnline.bind(this)))}setOnline(t){ae(this,qo)!==t&&(He(this,qo,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return ae(this,qo)}},qo=new WeakMap,Ti=new WeakMap,Wo=new WeakMap,NS),bd=new PC;function gp(){let e,t;const r=new Promise((n,l)=>{e=n,t=l});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),e(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function IC(e){return Math.min(1e3*2**e,3e4)}function C4(e){return(e??"online")==="online"?bd.isOnline():!0}var A4=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Tm(e){return e instanceof A4}function j4(e){let t=!1,r=0,a=!1,n;const l=gp(),o=w=>{var E;a||(v(new A4(w)),(E=e.abort)==null||E.call(e))},f=()=>{t=!0},d=()=>{t=!1},x=()=>lg.isFocused()&&(e.networkMode==="always"||bd.isOnline())&&e.canRun(),m=()=>C4(e.networkMode)&&e.canRun(),p=w=>{var E;a||(a=!0,(E=e.onSuccess)==null||E.call(e,w),n==null||n(),l.resolve(w))},v=w=>{var E;a||(a=!0,(E=e.onError)==null||E.call(e,w),n==null||n(),l.reject(w))},y=()=>new Promise(w=>{var E;n=_=>{(a||x())&&w(_)},(E=e.onPause)==null||E.call(e)}).then(()=>{var w;n=void 0,a||(w=e.onContinue)==null||w.call(e)}),b=()=>{if(a)return;let w;const E=r===0?e.initialPromise:void 0;try{w=E??e.fn()}catch(_){w=Promise.reject(_)}Promise.resolve(w).then(p).catch(_=>{var R;if(a)return;const N=e.retry??(Fl?0:3),k=e.retryDelay??IC,F=typeof k=="function"?k(r,_):k,j=N===!0||typeof N=="number"&&r<N||typeof N=="function"&&N(r,_);if(t||!j){v(_);return}r++,(R=e.onFail)==null||R.call(e,r,_),OC(F).then(()=>x()?void 0:y()).then(()=>{t?v(_):b()})})};return{promise:l,cancel:o,continue:()=>(n==null||n(),l),cancelRetry:f,continueRetry:d,canStart:m,start:()=>(m()?b():y().then(b),l)}}var UC=e=>setTimeout(e,0);function zC(){let e=[],t=0,r=f=>{f()},a=f=>{f()},n=UC;const l=f=>{t?e.push(f):n(()=>{r(f)})},o=()=>{const f=e;e=[],f.length&&n(()=>{a(()=>{f.forEach(d=>{r(d)})})})};return{batch:f=>{let d;t++;try{d=f()}finally{t--,t||o()}return d},batchCalls:f=>(...d)=>{l(()=>{f(...d)})},schedule:l,setNotifyFunction:f=>{r=f},setBatchNotifyFunction:f=>{a=f},setScheduler:f=>{n=f}}}var Ir=zC(),vl,CS,R4=(CS=class{constructor(){Ke(this,vl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),xp(this.gcTime)&&He(this,vl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Fl?1/0:5*60*1e3))}clearGcTimeout(){ae(this,vl)&&(clearTimeout(ae(this,vl)),He(this,vl,void 0))}},vl=new WeakMap,CS),Xo,$o,wn,yl,ua,tu,bl,Bn,Os,AS,HC=(AS=class extends R4{constructor(t){super();Ke(this,Bn);Ke(this,Xo);Ke(this,$o);Ke(this,wn);Ke(this,yl);Ke(this,ua);Ke(this,tu);Ke(this,bl);He(this,bl,!1),He(this,tu,t.defaultOptions),this.setOptions(t.options),this.observers=[],He(this,yl,t.client),He(this,wn,ae(this,yl).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,He(this,Xo,GC(this.options)),this.state=t.state??ae(this,Xo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ae(this,ua))==null?void 0:t.promise}setOptions(t){this.options={...ae(this,tu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ae(this,wn).remove(this)}setData(t,r){const a=pp(this.state.data,t,this.options);return pt(this,Bn,Os).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){pt(this,Bn,Os).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=ae(this,ua))==null?void 0:a.promise;return(n=ae(this,ua))==null||n.cancel(t),r?r.then(_a).catch(_a):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ae(this,Xo))}isActive(){return this.observers.some(t=>In(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ig||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Pi(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!_4(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,ua))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,ua))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ae(this,wn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ae(this,ua)&&(ae(this,bl)?ae(this,ua).cancel({revert:!0}):ae(this,ua).cancelRetry()),this.scheduleGc()),ae(this,wn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||pt(this,Bn,Os).call(this,{type:"invalidate"})}fetch(t,r){var x,m,p;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ae(this,ua))return ae(this,ua).continueRetry(),ae(this,ua).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(y=>y.options.queryFn);v&&this.setOptions(v.options)}const a=new AbortController,n=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(He(this,bl,!0),a.signal)})},l=()=>{const v=T4(this.options,r),b=(()=>{const w={client:ae(this,yl),queryKey:this.queryKey,meta:this.meta};return n(w),w})();return He(this,bl,!1),this.options.persister?this.options.persister(v,b,this):v(b)},f=(()=>{const v={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ae(this,yl),state:this.state,fetchFn:l};return n(v),v})();(x=this.options.behavior)==null||x.onFetch(f,this),He(this,$o,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=f.fetchOptions)==null?void 0:m.meta))&&pt(this,Bn,Os).call(this,{type:"fetch",meta:(p=f.fetchOptions)==null?void 0:p.meta});const d=v=>{var y,b,w,E;Tm(v)&&v.silent||pt(this,Bn,Os).call(this,{type:"error",error:v}),Tm(v)||((b=(y=ae(this,wn).config).onError)==null||b.call(y,v,this),(E=(w=ae(this,wn).config).onSettled)==null||E.call(w,this.state.data,v,this)),this.scheduleGc()};return He(this,ua,j4({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,abort:a.abort.bind(a),onSuccess:v=>{var y,b,w,E;if(v===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(_){d(_);return}(b=(y=ae(this,wn).config).onSuccess)==null||b.call(y,v,this),(E=(w=ae(this,wn).config).onSettled)==null||E.call(w,v,this.state.error,this),this.scheduleGc()},onError:d,onFail:(v,y)=>{pt(this,Bn,Os).call(this,{type:"failed",failureCount:v,error:y})},onPause:()=>{pt(this,Bn,Os).call(this,{type:"pause"})},onContinue:()=>{pt(this,Bn,Os).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0})),ae(this,ua).start()}},Xo=new WeakMap,$o=new WeakMap,wn=new WeakMap,yl=new WeakMap,ua=new WeakMap,tu=new WeakMap,bl=new WeakMap,Bn=new WeakSet,Os=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...D4(a.data,this.options),fetchMeta:t.meta??null};case"success":return{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return Tm(n)&&n.revert&&ae(this,$o)?{...ae(this,$o),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),Ir.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),ae(this,wn).notify({query:this,type:"updated",action:t})})},AS);function D4(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:C4(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function GC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var us,jS,VC=(jS=class extends dc{constructor(t={}){super();Ke(this,us);this.config=t,He(this,us,new Map)}build(t,r,a){const n=r.queryKey,l=r.queryHash??sg(n,r);let o=this.get(l);return o||(o=new HC({client:t,queryKey:n,queryHash:l,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){ae(this,us).has(t.queryHash)||(ae(this,us).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ae(this,us).get(t.queryHash);r&&(t.destroy(),r===t&&ae(this,us).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ir.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ae(this,us).get(t)}getAll(){return[...ae(this,us).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>gb(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>gb(t,a)):r}notify(t){Ir.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ir.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ir.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},us=new WeakMap,jS),fs,wa,wl,ds,Ei,RS,qC=(RS=class extends R4{constructor(t){super();Ke(this,ds);Ke(this,fs);Ke(this,wa);Ke(this,wl);this.mutationId=t.mutationId,He(this,wa,t.mutationCache),He(this,fs,[]),this.state=t.state||F4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ae(this,fs).includes(t)||(ae(this,fs).push(t),this.clearGcTimeout(),ae(this,wa).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){He(this,fs,ae(this,fs).filter(r=>r!==t)),this.scheduleGc(),ae(this,wa).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ae(this,fs).length||(this.state.status==="pending"?this.scheduleGc():ae(this,wa).remove(this))}continue(){var t;return((t=ae(this,wl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,f,d,x,m,p,v,y,b,w,E,_,N,k,F,j,R,T,C;const r=()=>{pt(this,ds,Ei).call(this,{type:"continue"})};He(this,wl,j4({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(O,V)=>{pt(this,ds,Ei).call(this,{type:"failed",failureCount:O,error:V})},onPause:()=>{pt(this,ds,Ei).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ae(this,wa).canRun(this)}));const a=this.state.status==="pending",n=!ae(this,wl).canStart();try{if(a)r();else{pt(this,ds,Ei).call(this,{type:"pending",variables:t,isPaused:n}),await((o=(l=ae(this,wa).config).onMutate)==null?void 0:o.call(l,t,this));const V=await((d=(f=this.options).onMutate)==null?void 0:d.call(f,t));V!==this.state.context&&pt(this,ds,Ei).call(this,{type:"pending",context:V,variables:t,isPaused:n})}const O=await ae(this,wl).start();return await((m=(x=ae(this,wa).config).onSuccess)==null?void 0:m.call(x,O,t,this.state.context,this)),await((v=(p=this.options).onSuccess)==null?void 0:v.call(p,O,t,this.state.context)),await((b=(y=ae(this,wa).config).onSettled)==null?void 0:b.call(y,O,null,this.state.variables,this.state.context,this)),await((E=(w=this.options).onSettled)==null?void 0:E.call(w,O,null,t,this.state.context)),pt(this,ds,Ei).call(this,{type:"success",data:O}),O}catch(O){try{throw await((N=(_=ae(this,wa).config).onError)==null?void 0:N.call(_,O,t,this.state.context,this)),await((F=(k=this.options).onError)==null?void 0:F.call(k,O,t,this.state.context)),await((R=(j=ae(this,wa).config).onSettled)==null?void 0:R.call(j,void 0,O,this.state.variables,this.state.context,this)),await((C=(T=this.options).onSettled)==null?void 0:C.call(T,void 0,O,t,this.state.context)),O}finally{pt(this,ds,Ei).call(this,{type:"error",error:O})}}finally{ae(this,wa).runNext(this)}}},fs=new WeakMap,wa=new WeakMap,wl=new WeakMap,ds=new WeakSet,Ei=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ir.batch(()=>{ae(this,fs).forEach(a=>{a.onMutationUpdate(t)}),ae(this,wa).notify({mutation:this,type:"updated",action:t})})},RS);function F4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ms,Pn,ru,DS,WC=(DS=class extends dc{constructor(t={}){super();Ke(this,Ms);Ke(this,Pn);Ke(this,ru);this.config=t,He(this,Ms,new Set),He(this,Pn,new Map),He(this,ru,0)}build(t,r,a){const n=new qC({mutationCache:this,mutationId:++Mf(this,ru)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){ae(this,Ms).add(t);const r=Pf(t);if(typeof r=="string"){const a=ae(this,Pn).get(r);a?a.push(t):ae(this,Pn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ae(this,Ms).delete(t)){const r=Pf(t);if(typeof r=="string"){const a=ae(this,Pn).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&ae(this,Pn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Pf(t);if(typeof r=="string"){const a=ae(this,Pn).get(r),n=a==null?void 0:a.find(l=>l.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=Pf(t);if(typeof r=="string"){const n=(a=ae(this,Pn).get(r))==null?void 0:a.find(l=>l!==t&&l.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ir.batch(()=>{ae(this,Ms).forEach(t=>{this.notify({type:"removed",mutation:t})}),ae(this,Ms).clear(),ae(this,Pn).clear()})}getAll(){return Array.from(ae(this,Ms))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>vb(r,a))}findAll(t={}){return this.getAll().filter(r=>vb(t,r))}notify(t){Ir.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ir.batch(()=>Promise.all(t.map(r=>r.continue().catch(_a))))}},Ms=new WeakMap,Pn=new WeakMap,ru=new WeakMap,DS);function Pf(e){var t;return(t=e.options.scope)==null?void 0:t.id}function wb(e){return{onFetch:(t,r)=>{var m,p,v,y,b;const a=t.options,n=(v=(p=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:p.fetchMore)==null?void 0:v.direction,l=((y=t.state.data)==null?void 0:y.pages)||[],o=((b=t.state.data)==null?void 0:b.pageParams)||[];let f={pages:[],pageParams:[]},d=0;const x=async()=>{let w=!1;const E=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(t.signal.aborted?w=!0:t.signal.addEventListener("abort",()=>{w=!0}),t.signal)})},_=T4(t.options,t.fetchOptions),N=async(k,F,j)=>{if(w)return Promise.reject();if(F==null&&k.pages.length)return Promise.resolve(k);const T=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:F,direction:j?"backward":"forward",meta:t.options.meta};return E(z),z})(),C=await _(T),{maxPages:O}=t.options,V=j?LC:MC;return{pages:V(k.pages,C,O),pageParams:V(k.pageParams,F,O)}};if(n&&l.length){const k=n==="backward",F=k?XC:Sb,j={pages:l,pageParams:o},R=F(a,j);f=await N(j,R,k)}else{const k=e??l.length;do{const F=d===0?o[0]??a.initialPageParam:Sb(a,f);if(d>0&&F==null)break;f=await N(f,F),d++}while(d<k)}return f};t.options.persister?t.fetchFn=()=>{var w,E;return(E=(w=t.options).persister)==null?void 0:E.call(w,x,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=x}}}function Sb(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function XC(e,{pages:t,pageParams:r}){var a;return t.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,t[0],t,r[0],r):void 0}var gr,Ni,Ci,Yo,Ko,Ai,Qo,Zo,FS,$C=(FS=class{constructor(e={}){Ke(this,gr);Ke(this,Ni);Ke(this,Ci);Ke(this,Yo);Ke(this,Ko);Ke(this,Ai);Ke(this,Qo);Ke(this,Zo);He(this,gr,e.queryCache||new VC),He(this,Ni,e.mutationCache||new WC),He(this,Ci,e.defaultOptions||{}),He(this,Yo,new Map),He(this,Ko,new Map),He(this,Ai,0)}mount(){Mf(this,Ai)._++,ae(this,Ai)===1&&(He(this,Qo,lg.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,gr).onFocus())})),He(this,Zo,bd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,gr).onOnline())})))}unmount(){var e,t;Mf(this,Ai)._--,ae(this,Ai)===0&&((e=ae(this,Qo))==null||e.call(this),He(this,Qo,void 0),(t=ae(this,Zo))==null||t.call(this),He(this,Zo,void 0))}isFetching(e){return ae(this,gr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ae(this,Ni).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,gr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ae(this,gr).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Pi(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return ae(this,gr).findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=ae(this,gr).get(a.queryHash),l=n==null?void 0:n.state.data,o=FC(t,l);if(o!==void 0)return ae(this,gr).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Ir.batch(()=>ae(this,gr).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,gr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ae(this,gr);Ir.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ae(this,gr);return Ir.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=Ir.batch(()=>ae(this,gr).findAll(e).map(n=>n.cancel(r)));return Promise.all(a).then(_a).catch(_a)}invalidateQueries(e,t={}){return Ir.batch(()=>(ae(this,gr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=Ir.batch(()=>ae(this,gr).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let l=n.fetch(void 0,r);return r.throwOnError||(l=l.catch(_a)),n.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(a).then(_a)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ae(this,gr).build(this,t);return r.isStaleByTime(Pi(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(_a).catch(_a)}fetchInfiniteQuery(e){return e.behavior=wb(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(_a).catch(_a)}ensureInfiniteQueryData(e){return e.behavior=wb(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return bd.isOnline()?ae(this,Ni).resumePausedMutations():Promise.resolve()}getQueryCache(){return ae(this,gr)}getMutationCache(){return ae(this,Ni)}getDefaultOptions(){return ae(this,Ci)}setDefaultOptions(e){He(this,Ci,e)}setQueryDefaults(e,t){ae(this,Yo).set(Ol(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ae(this,Yo).values()],r={};return t.forEach(a=>{B0(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){ae(this,Ko).set(Ol(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ae(this,Ko).values()],r={};return t.forEach(a=>{B0(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ae(this,Ci).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=sg(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ig&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ae(this,Ci).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ae(this,gr).clear(),ae(this,Ni).clear()}},gr=new WeakMap,Ni=new WeakMap,Ci=new WeakMap,Yo=new WeakMap,Ko=new WeakMap,Ai=new WeakMap,Qo=new WeakMap,Zo=new WeakMap,FS),La,Tt,au,Sa,Sl,Jo,ji,Ri,nu,ec,tc,El,_l,Di,rc,Lt,w0,vp,yp,bp,wp,Sp,Ep,_p,O4,OS,YC=(OS=class extends dc{constructor(t,r){super();Ke(this,Lt);Ke(this,La);Ke(this,Tt);Ke(this,au);Ke(this,Sa);Ke(this,Sl);Ke(this,Jo);Ke(this,ji);Ke(this,Ri);Ke(this,nu);Ke(this,ec);Ke(this,tc);Ke(this,El);Ke(this,_l);Ke(this,Di);Ke(this,rc,new Set);this.options=r,He(this,La,t),He(this,Ri,null),He(this,ji,gp()),this.options.experimental_prefetchInRender||ae(this,ji).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ae(this,Tt).addObserver(this),Eb(ae(this,Tt),this.options)?pt(this,Lt,w0).call(this):this.updateResult(),pt(this,Lt,wp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return kp(ae(this,Tt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return kp(ae(this,Tt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,pt(this,Lt,Sp).call(this),pt(this,Lt,Ep).call(this),ae(this,Tt).removeObserver(this)}setOptions(t){const r=this.options,a=ae(this,Tt);if(this.options=ae(this,La).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof In(this.options.enabled,ae(this,Tt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");pt(this,Lt,_p).call(this),ae(this,Tt).setOptions(this.options),r._defaulted&&!yd(this.options,r)&&ae(this,La).getQueryCache().notify({type:"observerOptionsUpdated",query:ae(this,Tt),observer:this});const n=this.hasListeners();n&&_b(ae(this,Tt),a,this.options,r)&&pt(this,Lt,w0).call(this),this.updateResult(),n&&(ae(this,Tt)!==a||In(this.options.enabled,ae(this,Tt))!==In(r.enabled,ae(this,Tt))||Pi(this.options.staleTime,ae(this,Tt))!==Pi(r.staleTime,ae(this,Tt)))&&pt(this,Lt,vp).call(this);const l=pt(this,Lt,yp).call(this);n&&(ae(this,Tt)!==a||In(this.options.enabled,ae(this,Tt))!==In(r.enabled,ae(this,Tt))||l!==ae(this,Di))&&pt(this,Lt,bp).call(this,l)}getOptimisticResult(t){const r=ae(this,La).getQueryCache().build(ae(this,La),t),a=this.createResult(r,t);return QC(this,a)&&(He(this,Sa,a),He(this,Jo,this.options),He(this,Sl,ae(this,Tt).state)),a}getCurrentResult(){return ae(this,Sa)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),Reflect.get(a,n))})}trackProp(t){ae(this,rc).add(t)}getCurrentQuery(){return ae(this,Tt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=ae(this,La).defaultQueryOptions(t),a=ae(this,La).getQueryCache().build(ae(this,La),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return pt(this,Lt,w0).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ae(this,Sa)))}createResult(t,r){var O;const a=ae(this,Tt),n=this.options,l=ae(this,Sa),o=ae(this,Sl),f=ae(this,Jo),x=t!==a?t.state:ae(this,au),{state:m}=t;let p={...m},v=!1,y;if(r._optimisticResults){const V=this.hasListeners(),z=!V&&Eb(t,r),H=V&&_b(t,a,r,n);(z||H)&&(p={...p,...D4(m.data,t.options)}),r._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:b,errorUpdatedAt:w,status:E}=p;y=p.data;let _=!1;if(r.placeholderData!==void 0&&y===void 0&&E==="pending"){let V;l!=null&&l.isPlaceholderData&&r.placeholderData===(f==null?void 0:f.placeholderData)?(V=l.data,_=!0):V=typeof r.placeholderData=="function"?r.placeholderData((O=ae(this,tc))==null?void 0:O.state.data,ae(this,tc)):r.placeholderData,V!==void 0&&(E="success",y=pp(l==null?void 0:l.data,V,r),v=!0)}if(r.select&&y!==void 0&&!_)if(l&&y===(o==null?void 0:o.data)&&r.select===ae(this,nu))y=ae(this,ec);else try{He(this,nu,r.select),y=r.select(y),y=pp(l==null?void 0:l.data,y,r),He(this,ec,y),He(this,Ri,null)}catch(V){He(this,Ri,V)}ae(this,Ri)&&(b=ae(this,Ri),y=ae(this,ec),w=Date.now(),E="error");const N=p.fetchStatus==="fetching",k=E==="pending",F=E==="error",j=k&&N,R=y!==void 0,C={status:E,fetchStatus:p.fetchStatus,isPending:k,isSuccess:E==="success",isError:F,isInitialLoading:j,isLoading:j,data:y,dataUpdatedAt:p.dataUpdatedAt,error:b,errorUpdatedAt:w,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>x.dataUpdateCount||p.errorUpdateCount>x.errorUpdateCount,isFetching:N,isRefetching:N&&!k,isLoadingError:F&&!R,isPaused:p.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:F&&R,isStale:og(t,r),refetch:this.refetch,promise:ae(this,ji)};if(this.options.experimental_prefetchInRender){const V=ie=>{C.status==="error"?ie.reject(C.error):C.data!==void 0&&ie.resolve(C.data)},z=()=>{const ie=He(this,ji,C.promise=gp());V(ie)},H=ae(this,ji);switch(H.status){case"pending":t.queryHash===a.queryHash&&V(H);break;case"fulfilled":(C.status==="error"||C.data!==H.value)&&z();break;case"rejected":(C.status!=="error"||C.error!==H.reason)&&z();break}}return C}updateResult(){const t=ae(this,Sa),r=this.createResult(ae(this,Tt),this.options);if(He(this,Sl,ae(this,Tt).state),He(this,Jo,this.options),ae(this,Sl).data!==void 0&&He(this,tc,ae(this,Tt)),yd(r,t))return;He(this,Sa,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,l=typeof n=="function"?n():n;if(l==="all"||!l&&!ae(this,rc).size)return!0;const o=new Set(l??ae(this,rc));return this.options.throwOnError&&o.add("error"),Object.keys(ae(this,Sa)).some(f=>{const d=f;return ae(this,Sa)[d]!==t[d]&&o.has(d)})};pt(this,Lt,O4).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&pt(this,Lt,wp).call(this)}},La=new WeakMap,Tt=new WeakMap,au=new WeakMap,Sa=new WeakMap,Sl=new WeakMap,Jo=new WeakMap,ji=new WeakMap,Ri=new WeakMap,nu=new WeakMap,ec=new WeakMap,tc=new WeakMap,El=new WeakMap,_l=new WeakMap,Di=new WeakMap,rc=new WeakMap,Lt=new WeakSet,w0=function(t){pt(this,Lt,_p).call(this);let r=ae(this,Tt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(_a)),r},vp=function(){pt(this,Lt,Sp).call(this);const t=Pi(this.options.staleTime,ae(this,Tt));if(Fl||ae(this,Sa).isStale||!xp(t))return;const a=_4(ae(this,Sa).dataUpdatedAt,t)+1;He(this,El,setTimeout(()=>{ae(this,Sa).isStale||this.updateResult()},a))},yp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ae(this,Tt)):this.options.refetchInterval)??!1},bp=function(t){pt(this,Lt,Ep).call(this),He(this,Di,t),!(Fl||In(this.options.enabled,ae(this,Tt))===!1||!xp(ae(this,Di))||ae(this,Di)===0)&&He(this,_l,setInterval(()=>{(this.options.refetchIntervalInBackground||lg.isFocused())&&pt(this,Lt,w0).call(this)},ae(this,Di)))},wp=function(){pt(this,Lt,vp).call(this),pt(this,Lt,bp).call(this,pt(this,Lt,yp).call(this))},Sp=function(){ae(this,El)&&(clearTimeout(ae(this,El)),He(this,El,void 0))},Ep=function(){ae(this,_l)&&(clearInterval(ae(this,_l)),He(this,_l,void 0))},_p=function(){const t=ae(this,La).getQueryCache().build(ae(this,La),this.options);if(t===ae(this,Tt))return;const r=ae(this,Tt);He(this,Tt,t),He(this,au,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},O4=function(t){Ir.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(ae(this,Sa))}),ae(this,La).getQueryCache().notify({query:ae(this,Tt),type:"observerResultsUpdated"})})},OS);function KC(e,t){return In(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Eb(e,t){return KC(e,t)||e.state.data!==void 0&&kp(e,t,t.refetchOnMount)}function kp(e,t,r){if(In(t.enabled,e)!==!1&&Pi(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&og(e,t)}return!1}function _b(e,t,r,a){return(e!==t||In(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&og(e,r)}function og(e,t){return In(t.enabled,e)!==!1&&e.isStaleByTime(Pi(t.staleTime,e))}function QC(e,t){return!yd(e.getCurrentResult(),t)}var Fi,Oi,Ba,Ls,Gs,ud,Tp,MS,ZC=(MS=class extends dc{constructor(r,a){super();Ke(this,Gs);Ke(this,Fi);Ke(this,Oi);Ke(this,Ba);Ke(this,Ls);He(this,Fi,r),this.setOptions(a),this.bindMethods(),pt(this,Gs,ud).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=ae(this,Fi).defaultMutationOptions(r),yd(this.options,a)||ae(this,Fi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ae(this,Ba),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Ol(a.mutationKey)!==Ol(this.options.mutationKey)?this.reset():((n=ae(this,Ba))==null?void 0:n.state.status)==="pending"&&ae(this,Ba).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=ae(this,Ba))==null||r.removeObserver(this)}onMutationUpdate(r){pt(this,Gs,ud).call(this),pt(this,Gs,Tp).call(this,r)}getCurrentResult(){return ae(this,Oi)}reset(){var r;(r=ae(this,Ba))==null||r.removeObserver(this),He(this,Ba,void 0),pt(this,Gs,ud).call(this),pt(this,Gs,Tp).call(this)}mutate(r,a){var n;return He(this,Ls,a),(n=ae(this,Ba))==null||n.removeObserver(this),He(this,Ba,ae(this,Fi).getMutationCache().build(ae(this,Fi),this.options)),ae(this,Ba).addObserver(this),ae(this,Ba).execute(r)}},Fi=new WeakMap,Oi=new WeakMap,Ba=new WeakMap,Ls=new WeakMap,Gs=new WeakSet,ud=function(){var a;const r=((a=ae(this,Ba))==null?void 0:a.state)??F4();He(this,Oi,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Tp=function(r){Ir.batch(()=>{var a,n,l,o,f,d,x,m;if(ae(this,Ls)&&this.hasListeners()){const p=ae(this,Oi).variables,v=ae(this,Oi).context;(r==null?void 0:r.type)==="success"?((n=(a=ae(this,Ls)).onSuccess)==null||n.call(a,r.data,p,v),(o=(l=ae(this,Ls)).onSettled)==null||o.call(l,r.data,null,p,v)):(r==null?void 0:r.type)==="error"&&((d=(f=ae(this,Ls)).onError)==null||d.call(f,r.error,p,v),(m=(x=ae(this,Ls)).onSettled)==null||m.call(x,void 0,r.error,p,v))}this.listeners.forEach(p=>{p(ae(this,Oi))})})},MS),M4=A.createContext(void 0),wt=e=>{const t=A.useContext(M4);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},JC=({client:e,children:t})=>(A.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(M4.Provider,{value:e,children:t})),L4=A.createContext(!1),eA=()=>A.useContext(L4);L4.Provider;function tA(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var rA=A.createContext(tA()),aA=()=>A.useContext(rA),nA=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},sA=e=>{A.useEffect(()=>{e.clearReset()},[e])},iA=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(n&&e.data===void 0||N4(r,[e.error,a])),lA=e=>{if(e.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},oA=(e,t)=>e.isLoading&&e.isFetching&&!t,cA=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,kb=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function uA(e,t,r){var p,v,y,b,w;const a=eA(),n=aA(),l=wt(),o=l.defaultQueryOptions(e);(v=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||v.call(p,o),o._optimisticResults=a?"isRestoring":"optimistic",lA(o),nA(o,n),sA(n);const f=!l.getQueryCache().get(o.queryHash),[d]=A.useState(()=>new t(l,o)),x=d.getOptimisticResult(o),m=!a&&e.subscribed!==!1;if(A.useSyncExternalStore(A.useCallback(E=>{const _=m?d.subscribe(Ir.batchCalls(E)):_a;return d.updateResult(),_},[d,m]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),A.useEffect(()=>{d.setOptions(o)},[o,d]),cA(o,x))throw kb(o,d,n);if(iA({result:x,errorResetBoundary:n,throwOnError:o.throwOnError,query:l.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw x.error;if((b=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||b.call(y,o,x),o.experimental_prefetchInRender&&!Fl&&oA(x,a)){const E=f?kb(o,d,n):(w=l.getQueryCache().get(o.queryHash))==null?void 0:w.promise;E==null||E.catch(_a).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?x:d.trackResult(x)}function Qr(e,t){return uA(e,YC)}function kt(e,t){const r=wt(),[a]=A.useState(()=>new ZC(r,e));A.useEffect(()=>{a.setOptions(e)},[a,e]);const n=A.useSyncExternalStore(A.useCallback(o=>a.subscribe(Ir.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=A.useCallback((o,f)=>{a.mutate(o,f).catch(_a)},[a]);if(n.error&&N4(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}const B4={login:"/User/Login",me:"/auth/me"},hc={all:"/event/GetEventsList",byId:e=>`/event/${e}`,create:"/event/Create",update:"/event/Update",updateTableQuantity:"/event/UpdateTableQuantity",activateEvent:e=>`/event/Activate/${e}`,deactivateEvent:e=>`/event/Deactivate/${e}`,previewEvent:"/event/Preview",delete:e=>`/events/${e}`,importRsvps:e=>`/events/${e}/rsvps/import`,exportRsvps:e=>`/events/${e}/rsvps/export`},cu={all:e=>`/rsvp/GetRsvp/List/${e}`,forEvent:e=>`/rsvp/GetRsvp/List/${e}`,byId:(e,t)=>`/events/${e}/rsvps/${t}`,create:()=>"/rsvp/Create",update:()=>"/rsvp/Update",delete:()=>"/rsvp/Delete"},Gi={all:e=>`/TableArrangement/Summary/${e}`,byId:e=>`/TableArrangement/Summary/${e}`,create:"/TableArrangement/Create",bulkCreate:"/TableArrangement/BulkCreate",update:"/TableArrangement/Update",delete:e=>`/TableArrangement/Delete/${e}`,updateLayout:e=>`/tables/${e}/layout`,tableGuests:e=>`/tables/${e}/guests`,reassignGuest:(e,t)=>`/tables/${e}/guests/${t}/reassign`},zl={all:e=>`/Guest/ByEvent/${e}`,byTable:e=>`/Guest/ByTable/${e}`,create:"/Guest/Create",update:"/Guest/Update",assignTable:(e,t)=>`/Guest/${e}/AssignTable/${t}`,unassignTable:e=>`/Guest/${e}/UnassignTable`},uu={all:"/seating",byId:e=>`/seating/${e}`,create:"/seating",update:e=>`/seating/${e}`,delete:e=>`/seating/${e}`},fu={all:"/users",byId:e=>`/users/${e}`,create:"/users",update:e=>`/users/${e}`,delete:e=>`/users/${e}`},cg={getByEvent:e=>`/Wallet/GetWalletByEvent/${e}`,getByGuid:(e,t)=>`/Wallet/${e}?eventId=${t}`,create:"/Wallet/Create",update:"/Wallet/Update",delete:"/Wallet/Delete",activate:e=>`/Wallet/Activate/${e}`,deactivate:e=>`/Wallet/Deactivate/${e}`},qd={getByWallet:(e,t)=>`/Transaction/${e}/transactions?eventGuid=${t}`,getById:(e,t)=>`/Transaction/${e}?eventGuid=${t}`,create:"/Transaction/Create",update:"/Transaction/Update",delete:"/Transaction/Delete"},Wd={all:e=>`/question/GetQuestions/${e}`,create:()=>"/question/Create",update:()=>"/question/Update",activate:()=>"/question/Activate",deactivate:()=>"/question/Deactivate",delete:(e,t)=>`/events/${e}/rsvp-form-fields/${t}`},P4={submit:()=>"/rsvp/Create",designByToken:e=>`/RsvpDesign/public/${e}`},ug={get:e=>`/RsvpDesign/${e}/design`,save:e=>`/RsvpDesign/${e}/design`,publish:(e,t)=>`/RsvpDesign/${e}/design/${t}/publish`},fA={summary:e=>`/Dashboard/Summary/${e}`};function dA(){const e=wt();return{login:kt({mutationFn:r=>Xe.post(B4.login,r).then(a=>a.data),onSuccess:({token:r})=>{localStorage.setItem("token",r),e.invalidateQueries({queryKey:["me"]})}})}}const fg=A.createContext({user:null,login:async()=>{},logout:()=>{},loading:!1}),Nm="temp-admin-token",Cm={id:"temp-admin",name:"Admin",email:"admin@bigdays.com"};function hA({children:e}){const{login:t}=dA(),[r,a]=A.useState(()=>localStorage.getItem("token")===Nm?Cm:null),[n,l]=A.useState(()=>!!localStorage.getItem("token")&&localStorage.getItem("token")!==Nm),{data:o,isLoading:f}=Qr({queryKey:["me"],queryFn:()=>Xe.get(B4.me).then(m=>m.data),enabled:n}),d=async m=>{if(m.email===Cm.email&&m.password==="Abc123"){localStorage.setItem("token",Nm),a(Cm);return}await t.mutateAsync(m),l(!0)},x=()=>{localStorage.removeItem("token"),l(!1),a(null),window.location.replace("/login")};return c.jsx(fg.Provider,{value:{user:r??o??null,login:d,logout:x,loading:f||t.isPending},children:e})}function xA(e){return e.toISOString().slice(0,10)}function Tb(e){const t=new Date(e).getTime(),r=Date.now(),a=Math.max(t-r,0),n=Math.floor(a/(1e3*60*60*24)),l=Math.floor(a/(1e3*60*60)%24),o=Math.floor(a/(1e3*60)%60),f=Math.floor(a/1e3%60),d=x=>x.toString().padStart(2,"0");return{days:d(n),hours:d(l),minutes:d(o),seconds:d(f)}}function mA(){const e=ja(),t=A.useMemo(()=>{const f=new Date;return f.setDate(f.getDate()+90),xA(f)},[]),[r,a]=A.useState(t),[n,l]=A.useState(()=>Tb(t));A.useEffect(()=>{const f=setInterval(()=>l(Tb(r)),1e3);return()=>clearInterval(f)},[r]);const o=[{label:"days",value:n.days},{label:"hours",value:n.hours},{label:"minutes",value:n.minutes},{label:"seconds",value:n.seconds}];return c.jsxs("section",{className:"bg-background text-center text-text py-20 space-y-20",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsx("h2",{className:"text-4xl font-playfair italic text-primary",children:"Save The Date"}),c.jsx("p",{className:"text-lg font-semibold",children:"Customize your countdown"}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-center gap-4 max-w-xl mx-auto",children:[c.jsx("label",{className:"text-sm font-semibold text-gray-600",htmlFor:"wedding-date",children:"Wedding date"}),c.jsx("input",{id:"wedding-date",type:"date",value:r,onChange:f=>a(f.target.value),className:"border rounded-lg px-3 py-2 shadow-sm"})]}),c.jsx("div",{className:"flex justify-center gap-6 mt-8 flex-wrap",children:o.map(({label:f,value:d})=>c.jsxs("div",{className:"w-28 h-28 rounded-full border-2 border-secondary flex flex-col justify-center items-center bg-white/60",children:[c.jsx("span",{className:"text-3xl text-primary font-semibold",children:d}),c.jsx("span",{className:"text-sm text-gray-500 uppercase tracking-wide",children:f})]},f))})]}),c.jsx("div",{className:"bg-[#fffaf0] py-16 px-4",children:c.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Stress-free planning"}),c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Share timelines, notes, and last-minute updates with everyone helping on your big day. Keep your vision aligned without endless chats."})]}),c.jsx("div",{className:"mx-auto",children:c.jsx("img",{src:"https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e",alt:"Bride and Groom",className:"w-64 h-64 object-cover rounded-md shadow-lg"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Designed for both of you"}),c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Give guests a beautiful RSVP experience, track VIPs, and manage seating in minutes. No more juggling spreadsheets or scattered tools."})]})]})}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h2",{className:"text-2xl font-semibold",children:"Plan. Invite. Celebrate."}),c.jsx("p",{className:"max-w-xl mx-auto mt-2 text-gray-600",children:"Streamline your wedding with real-time RSVP analytics, seating charts, and guided setup."}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[c.jsx("button",{className:"px-6 py-3 rounded-2xl bg-accent text-white shadow-lg",onClick:()=>e("/app/events?new=1"),children:"Start a new event"}),c.jsx("button",{className:"px-6 py-3 rounded-2xl border-2 border-accent text-accent shadow-lg",onClick:()=>e("/app/events?demo=1"),children:"Explore a demo setup"})]})]})]})}function du(){return A.useContext(fg)}function Zt({label:e,type:t="text",options:r,value:a,onChange:n,required:l=!1,className:o="",name:f,id:d,placeholder:x,disabled:m,autoFocus:p,min:v,max:y,step:b,rows:w=3,hint:E,error:_,emptyOptionLabel:N=" select "}){const k="w-full border rounded p-2 disabled:opacity-60 disabled:cursor-not-allowed",F=_?"border-red-500":"border-gray-300",j=_?"text-red-600":"text-gray-500";return c.jsxs("div",{className:`space-y-1 ${o}`,children:[c.jsxs("label",{htmlFor:d,className:"block font-medium",children:[e,l&&c.jsx("span",{className:"ml-1 text-red-600",children:"*"})]}),t==="textarea"?c.jsx("textarea",{id:d,name:f,rows:w,className:`${k} ${F}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:p}):t==="select"?c.jsxs("select",{id:d,name:f,className:`${k} ${F}`,value:a,onChange:n,disabled:m,required:l,autoFocus:p,children:[c.jsx("option",{value:"",children:N}),r==null?void 0:r.map(R=>c.jsx("option",{value:R,children:R},R))]}):t==="radio"?c.jsx("div",{className:"flex flex-wrap gap-3",children:r==null?void 0:r.map(R=>c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"radio",id:d?`${d}-${R}`:void 0,name:f,value:R,checked:a===R,onChange:n,disabled:m,required:l}),c.jsx("span",{children:R})]},R))}):t==="checkbox"?c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{id:d,name:f,type:"checkbox",checked:a==="true",onChange:R=>{const T={...R,target:{...R.target,value:R.target.checked?"true":"false"}};n(T)},disabled:m,required:l}),c.jsx("span",{children:e})]}):c.jsx("input",{id:d,name:f,type:t,className:`${k} ${F}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:p,min:v,max:y,step:b}),(E||_)&&c.jsx("p",{className:`text-xs ${j}`,children:_??E})]})}const Xn=()=>c.jsxs("svg",{className:"animate-spin h-5 w-5 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),Me=({type:e="button",variant:t="primary",loading:r=!1,children:a,className:n="",...l})=>{const o="px-4 py-2 rounded-xl font-semibold inline-flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-60 disabled:cursor-not-allowed",f=t==="primary"?"bg-gradient-to-r from-primary to-secondary text-white shadow-lg shadow-primary/25 hover:brightness-105 active:translate-y-[1px] focus:ring-primary/40":t==="secondary"?"bg-white text-text border border-primary/15 hover:border-primary/30 hover:bg-primary/5 dark:bg-accent dark:text-white dark:border-white/10 dark:hover:bg-white/10 focus:ring-primary/25":"bg-transparent text-primary hover:bg-primary/10 dark:hover:bg-white/10 focus:ring-primary/15";return c.jsx("button",{type:e,className:`${o} ${f} ${n}`,disabled:r||l.disabled,...l,children:r?c.jsx(Xn,{}):a})};function pA(){var v,y;const{login:e,loading:t}=du(),r=ja(),n=((y=(v=xs().state)==null?void 0:v.from)==null?void 0:y.pathname)||"/app",[l,o]=A.useState(""),[f,d]=A.useState(""),[x,m]=A.useState(null),p=async b=>{var w,E;b.preventDefault(),m(null);try{await e({email:l,password:f}),r(n,{replace:!0})}catch(_){m(((E=(w=_.response)==null?void 0:w.data)==null?void 0:E.message)||"Login failed")}};return c.jsxs("form",{onSubmit:p,className:"max-w-md mx-auto p-6 bg-background text-text space-y-6 ",children:[c.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Sign In"}),c.jsx(Zt,{label:"Email",type:"email",value:l,onChange:b=>o(b.target.value)}),c.jsx(Zt,{label:"Password",type:"password",value:f,onChange:b=>d(b.target.value)}),x&&c.jsx("p",{className:"text-red-500 text-sm",children:x}),c.jsx(Me,{type:"submit",variant:"primary",disabled:t,children:t?"Signing in":"Sign In"})]})}function gA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}))}const P0=A.forwardRef(gA);function vA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"}))}const Np=A.forwardRef(vA);function yA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"}))}const bA=A.forwardRef(yA);function wA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"}))}const SA=A.forwardRef(wA);function EA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}))}const _A=A.forwardRef(EA);function kA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"}))}const TA=A.forwardRef(kA);function NA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const CA=A.forwardRef(NA);function AA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"}))}const jA=A.forwardRef(AA);function RA(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const dg=A.forwardRef(RA),Nb=[{to:"/",label:"HOME"},{to:"/contact",label:"CONTACT"},{to:"/story",label:"STORY"},{to:"/events",label:"EVENTS"},{to:"/people",label:"PEOPLE"},{to:"/gallery",label:"GALLERY"},{to:"/rsvp",label:"RSVP"},{to:"/blog",label:"BLOG"},{to:"/login",label:"LOGIN"}];function DA(){const[e,t]=A.useState(!1);return c.jsxs("header",{className:"bg-background text-text shadow-sm",children:[c.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between py-4 px-6",children:[c.jsx("div",{className:"text-2xl font-playfair italic text-primary",children:"C & C"}),c.jsx("nav",{className:"hidden md:flex space-x-6 font-medium",children:Nb.map(({to:r,label:a})=>c.jsx(M0,{to:r,className:({isActive:n})=>n?"text-secondary underline":"hover:text-secondary",children:a},r))}),c.jsx("button",{className:"md:hidden p-2 rounded hover:bg-secondary/10","aria-label":"Toggle menu",onClick:()=>t(r=>!r),children:e?c.jsx(dg,{className:"h-6 w-6 text-text"}):c.jsx(bA,{className:"h-6 w-6 text-text"})})]}),e&&c.jsx("nav",{className:"md:hidden bg-background border-t border-gray-200",children:c.jsx("ul",{className:"space-y-1 py-4 px-6 font-medium",children:Nb.map(({to:r,label:a})=>c.jsx("li",{children:c.jsx(M0,{to:r,className:({isActive:n})=>n?"block py-2 text-secondary underline":"block py-2 hover:text-secondary",onClick:()=>t(!1),children:a})},r))})})]})}function FA(){return c.jsx("footer",{className:"bg-background text-text py-8 px-6 mt-20",children:c.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-2 text-sm text-gray-600",children:[c.jsxs("p",{children:[" ",new Date().getFullYear()," My Big Day. All rights reserved."]}),c.jsx("p",{children:"Built with  using React, Vite & Tailwind CSS."})]})})}function OA({children:e}){return c.jsxs("div",{className:"min-h-screen bg-background text-text flex flex-col",children:[c.jsx(DA,{}),c.jsx("main",{className:"flex-1 container mx-auto px-4 pt-3",children:e??c.jsx(Bs,{})}),c.jsx(FA,{})]})}function Cp(e){return{id:e.eventGuid.toString(),title:e.eventName,date:e.eventDate,noOfTable:e.noOfTable,description:e.eventDescription,location:e.eventLocation,raw:e}}function hg(e=!1){return Qr({queryKey:["events",e],queryFn:async()=>{var n;const t=await Xe.get(hc.all),r=Array.isArray((n=t.data)==null?void 0:n.data)?t.data.data:[];return e?r.map(Cp):r.filter(l=>!l.isDeleted).map(Cp)}})}function MA(e,t){return Qr({queryKey:["event",e],enabled:!!e,queryFn:async()=>{var n;const a=(n=(await Xe.get(hc.byId(e))).data)==null?void 0:n.data;if(!a)throw new Error("Event not found");return Cp(a)}})}function LA(){const e=wt();return kt({mutationFn:async t=>(await Xe.post(hc.create,t)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function BA(){const e=wt();return kt({mutationFn:async t=>(await Xe.post(hc.update,t)).data,onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["events"]}),e.invalidateQueries({queryKey:["event",r.eventGuid]})}})}function I4(){const e=wt();return kt({mutationFn:async t=>(console.log("[mutate] activate",t),(await Xe.put(hc.activateEvent(t))).data),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function U4(){const e=wt();return kt({mutationFn:async t=>(console.log("[mutate] deactivate",t),(await Xe.put(hc.deactivateEvent(t))).data),onMutate:t=>{console.log("[onMutate] deactivating",t)},onSuccess:(t,r)=>{console.log("[onSuccess] deactivated",r),e.invalidateQueries({queryKey:["events"]})},onError:(t,r)=>{console.error("[onError] deactivating",r,t)}})}const z4=A.createContext({eventId:void 0,event:void 0,events:[],isSelectorOpen:!1,mustChooseEvent:!1,setEventId:()=>{},openSelector:()=>{},closeSelector:()=>{}});function PA({children:e}){const{data:t}=hg(),[r,a]=A.useState(()=>localStorage.getItem("eventId")||void 0),[n,l]=A.useState(!1),o=!r,f=p=>{localStorage.setItem("eventId",p),a(p),l(!1)},d=()=>l(!0),x=()=>{o||l(!1)},m=t==null?void 0:t.find(p=>p.id===r);return c.jsx(z4.Provider,{value:{eventId:r,event:m,events:t,isSelectorOpen:n,mustChooseEvent:o,setEventId:f,openSelector:d,closeSelector:x},children:e})}function Hr(){return A.useContext(z4)}var Am,Cb;function IA(){if(Cb)return Am;Cb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"}))}return Am=e.forwardRef(t),Am}var UA=IA();const zA=Vn(UA);var jm,Ab;function HA(){if(Ab)return jm;Ab=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"}))}return jm=e.forwardRef(t),jm}var GA=HA();const VA=Vn(GA);var Rm,jb;function qA(){if(jb)return Rm;jb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}))}return Rm=e.forwardRef(t),Rm}var WA=qA();const XA=Vn(WA);function $A({onMenuToggle:e}){const{theme:t,toggle:r}=t5(),{event:a}=Hr();return c.jsxs("header",{className:"sticky top-0 z-40 flex items-center gap-4 px-6 py-3 bg-background/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-primary/10 dark:border-white/10",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[e&&c.jsx("button",{className:"md:hidden p-2 rounded-lg text-text/70 hover:bg-primary/5 dark:text-white/70 dark:hover:bg-white/10 transition",onClick:e,"aria-label":"Toggle sidebar",children:c.jsx(zA,{className:"h-5 w-5"})}),a&&c.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-text/50 dark:text-white/50",children:a.title}),a.date&&c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-text/20 dark:text-white/20",children:"/"}),c.jsx("span",{className:"text-text/40 dark:text-white/40",children:new Date(a.date).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})})]})]})]}),c.jsx("div",{className:"flex-1"}),c.jsx("button",{onClick:r,"aria-label":"Toggle dark mode",className:"p-2 rounded-lg text-text/50 hover:text-text hover:bg-primary/5 dark:text-white/50 dark:hover:text-white dark:hover:bg-white/10 transition",children:t==="light"?c.jsx(VA,{className:"h-5 w-5"}):c.jsx(XA,{className:"h-5 w-5"})})]})}var Dm,Rb;function YA(){if(Rb)return Dm;Rb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}return Dm=e.forwardRef(t),Dm}var KA=YA();const QA=Vn(KA);var Fm,Db;function ZA(){if(Db)return Fm;Db=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"}))}return Fm=e.forwardRef(t),Fm}var JA=ZA();const e6=Vn(JA);var Om,Fb;function t6(){if(Fb)return Om;Fb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"}))}return Om=e.forwardRef(t),Om}var r6=t6();const a6=Vn(r6);var Mm,Ob;function n6(){if(Ob)return Mm;Ob=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"}))}return Mm=e.forwardRef(t),Mm}var s6=n6();const Mb=Vn(s6);var Lm,Lb;function i6(){if(Lb)return Lm;Lb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))}return Lm=e.forwardRef(t),Lm}var l6=i6();const o6=Vn(l6);var Bm,Bb;function c6(){if(Bb)return Bm;Bb=1;const e=Ga();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}))}return Bm=e.forwardRef(t),Bm}var u6=c6();const f6=Vn(u6);function d6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"}))}const fd=A.forwardRef(d6);function h6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const x6=A.forwardRef(h6);function m6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const I0=A.forwardRef(m6);function p6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),A.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const Pb=A.forwardRef(p6);function g6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),A.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"}))}const v6=A.forwardRef(g6);function y6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"}))}const b6=A.forwardRef(y6);function w6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),A.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"}))}const Ap=A.forwardRef(w6);function S6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"}))}const E6=A.forwardRef(S6);function _6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"}))}const k6=A.forwardRef(_6);function T6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const N6=A.forwardRef(T6);function C6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),A.createElement("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}))}const Ib=A.forwardRef(C6);function A6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z",clipRule:"evenodd"}))}const j6=A.forwardRef(A6);function R6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M5 4a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H5zm-1 9v-1h5v2H5a1 1 0 01-1-1zm7 1h4a1 1 0 001-1v-1h-5v2zm0-4h5V8h-5v2zM9 8H4v2h5V8z",clipRule:"evenodd"}))}const jp=A.forwardRef(R6);function D6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"}))}const dd=A.forwardRef(D6);function F6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"}))}const hd=A.forwardRef(F6);function O6(e,t){return A.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),A.createElement("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const M6=A.forwardRef(O6),L6=[{to:"/app/dashboard",label:"Dashboard",Icon:k6},{to:"/app/events",label:"Events",Icon:fd},{to:"/app/rsvps",label:"RSVPs",Icon:v6},{to:"/app/guests",label:"Guests",Icon:dd},{to:"/app/tables",label:"Tables",Icon:jp,end:!0},{to:"/app/tables/floorplan",label:"Floor Plan",Icon:M6},{to:"/app/wallet",label:"Wallet",Icon:Ap},{to:"/app/users",label:"Users",Icon:hd}];function B6({isOpen:e,onClose:t}){const{event:r,openSelector:a,mustChooseEvent:n}=Hr(),{user:l,logout:o}=du(),[f,d]=kl.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`
          fixed inset-0 bg-black/30 z-20 transition-opacity md:hidden
          ${e?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
        `,onClick:t}),c.jsx("aside",{className:`
          fixed inset-y-0 left-0 w-72 text-text
          bg-background border-r border-primary/10
          dark:bg-slate-900 dark:border-white/10 dark:text-white
          z-30 transform transition-all
          ${e?"translate-x-0":"-translate-x-full"}
          md:static md:translate-x-0
          ${f?"md:w-20":"md:w-64"}
        `,children:c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:`flex items-center justify-between px-4 py-4 border-b border-primary/10 dark:border-white/10 ${f?"md:px-3":"md:px-5"}`,children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-9 w-9 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center flex-shrink-0",children:c.jsx(E6,{className:"h-5 w-5"})}),!f&&c.jsx("span",{className:"text-sm font-semibold tracking-tight",children:"My Big Days"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{className:"hidden md:inline-flex p-1.5 rounded-lg text-text/50 hover:text-text hover:bg-primary/5 dark:text-white/40 dark:hover:text-white dark:hover:bg-white/10 transition",onClick:()=>d(x=>!x),"aria-label":f?"Expand sidebar":"Collapse sidebar",children:f?c.jsx(a6,{className:"h-4 w-4"}):c.jsx(e6,{className:"h-4 w-4"})}),c.jsx("button",{className:"md:hidden p-1.5 rounded-lg text-text/50 hover:text-text transition",onClick:t,"aria-label":"Close sidebar",children:c.jsx(QA,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:`flex-1 overflow-y-auto py-3 space-y-3 ${f?"md:px-2":"px-3"}`,children:[c.jsxs("div",{className:"px-1",children:[c.jsx("button",{onClick:a,className:`w-full rounded-xl p-3 text-left transition
                  bg-primary/5 hover:bg-primary/10 border border-primary/10
                  dark:bg-white/5 dark:hover:bg-white/10 dark:border-white/10
                  ${f?"px-2 py-3 flex justify-center":""}
                `,children:c.jsxs("div",{className:`flex items-center gap-3 ${f?"justify-center":""}`,children:[c.jsx(j6,{className:`h-5 w-5 flex-shrink-0 ${n?"text-amber-500":"text-primary"}`}),!f&&c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:`text-[11px] uppercase tracking-wide font-medium ${n?"text-amber-600 dark:text-amber-400":"text-text/50 dark:text-white/50"}`,children:n?"Select an event":"Current event"}),c.jsx("p",{className:"text-sm font-semibold truncate",children:(r==null?void 0:r.title)??"No event selected"})]}),!f&&c.jsx(f6,{className:"h-4 w-4 text-text/30 dark:text-white/30 flex-shrink-0"})]})}),n&&!f&&c.jsx("p",{className:"mt-2 text-xs text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-lg px-3 py-2",children:"Select an event to get started."})]}),c.jsx("nav",{className:"space-y-0.5",children:L6.map(({to:x,label:m,Icon:p,end:v})=>c.jsxs(M0,{to:x,end:v,title:m,onClick:t,className:({isActive:y})=>`group flex items-center gap-3 ${f?"justify-center px-2":"px-3"} py-2.5 rounded-lg transition-colors text-sm
                     ${y?"bg-primary/10 text-primary font-semibold dark:bg-primary/20 dark:text-primary":"text-text/70 hover:bg-primary/5 hover:text-text dark:text-white/60 dark:hover:bg-white/5 dark:hover:text-white"}`,children:[c.jsx(p,{className:"h-5 w-5 flex-shrink-0"}),!f&&c.jsx("span",{children:m})]},x))})]}),c.jsx("div",{className:"border-t border-primary/10 dark:border-white/10 p-3",children:f?c.jsx("button",{onClick:o,className:"w-full flex justify-center p-2 rounded-lg text-text/40 hover:text-red-500 hover:bg-red-50 dark:text-white/30 dark:hover:text-red-400 dark:hover:bg-red-500/10 transition","aria-label":"Logout",children:c.jsx(Mb,{className:"h-5 w-5"})}):c.jsxs("div",{className:"flex items-center gap-3 px-2 py-2",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 dark:bg-white/10 grid place-items-center flex-shrink-0",children:c.jsx(o6,{className:"h-5 w-5 text-primary dark:text-white/70"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium truncate",children:(l==null?void 0:l.name)??"User"}),c.jsx("p",{className:"text-xs text-text/50 dark:text-white/40 truncate",children:(l==null?void 0:l.email)??""})]}),c.jsx("button",{onClick:o,className:"p-1.5 rounded-lg text-text/40 hover:text-red-500 hover:bg-red-50 dark:text-white/30 dark:hover:text-red-400 dark:hover:bg-red-500/10 transition","aria-label":"Logout",children:c.jsx(Mb,{className:"h-4 w-4"})})]})})]})})]})}const $n=({isOpen:e,title:t,onClose:r,children:a,className:n=""})=>e?c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-100",children:c.jsxs("div",{className:"bg-background text-text rounded-lg shadow-lg max-w-lg w-full p-6 "+n,children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:t&&c.jsx("h3",{className:"text-lg font-semibold",children:t})}),c.jsx("div",{children:a})]})}):null,hu=({message:e})=>c.jsx("div",{className:"p-2 bg-red-100 text-red-800 rounded text-sm mb-4",children:e});function Ub(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(isNaN(t.getTime()))return e.slice(0,10);const r=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-r).toISOString().slice(0,10)}const Xd=({isOpen:e,onClose:t,onSuccess:r,initial:a,className:n=""})=>{const[l,o]=A.useState((a==null?void 0:a.title)||""),[f,d]=A.useState(Ub(a==null?void 0:a.date)),[x,m]=A.useState(a!=null&&a.noOfTable?Number(a.noOfTable):0),[p,v]=A.useState((a==null?void 0:a.description)||""),[y,b]=A.useState((a==null?void 0:a.location)||""),w=LA(),E=BA(),[_,N]=A.useState(null);A.useEffect(()=>{e&&(o((a==null?void 0:a.title)||""),d(Ub(a==null?void 0:a.date)),m(a!=null&&a.noOfTable?Number(a.noOfTable):0),v((a==null?void 0:a.description)||""),b((a==null?void 0:a.location)||""),N(null))},[e,a]);const k=!!a,F=async j=>{var R,T;j.preventDefault();try{if(k&&a){const C=await E.mutateAsync({eventGuid:a.id,name:l,date:f,time:"",description:p,location:y,userID:0,noOfTable:x});r==null||r(C)}else{const C=await w.mutateAsync({name:l,date:f,description:p,location:y,userID:"0",noOfTable:x.toString()});r==null||r(C)}t()}catch(C){console.error(C),N(((T=(R=C.response)==null?void 0:R.data)==null?void 0:T.message)||"Something went wrong.")}};return c.jsx($n,{isOpen:e,onClose:t,title:k?"Edit Event":"New Event",className:n,children:c.jsxs("form",{onSubmit:F,className:"space-y-4",children:[_&&c.jsx(hu,{message:_}),c.jsx(Zt,{label:"Title",value:l,onChange:j=>o(j.target.value)}),c.jsx(Zt,{label:"Date",type:"date",value:f,onChange:j=>d(j.target.value)}),c.jsx(Zt,{label:"Number of Tables",type:"number",value:x.toString(),onChange:j=>m(Number(j.target.value))}),c.jsx(Zt,{label:"Description",value:p,onChange:j=>v(j.target.value)}),c.jsx(Zt,{label:"Location",value:y,onChange:j=>b(j.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Me,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),c.jsx(Me,{type:"submit",variant:"primary",loading:w.isPending||E.isPending,children:k?E.isPending?"Saving":"Save":w.isPending?"Creating":"Create"})]})]})})};function P6(){const{isSelectorOpen:e,mustChooseEvent:t,events:r=[],eventId:a,setEventId:n,closeSelector:l}=Hr(),o=U4(),f=I4(),[d,x]=A.useState(!1),[m,p]=A.useState(void 0);if(!(t||e))return null;const y=T=>{n(T)},b=()=>{p(void 0),x(!0)},w=T=>{p(T),x(!0)},E=T=>o.mutate(T),_=T=>f.mutate(T),N=()=>x(!1),k=T=>{n(T.id),x(!1)},F=t?"Choose an event to unlock your dashboard":"Switch the event you're working on",j=t?"Pick an existing celebration or create a new one to continue planning.":"Keep everything in sync by switching the active event for tables, RSVPs, and wallet.",R=()=>{t||l()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-50 transition-opacity",onClick:R}),c.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4 overflow-auto",children:c.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl grid md:grid-cols-[1fr_1.15fr] overflow-hidden border border-primary/10",children:[c.jsxs("div",{className:"relative bg-gradient-to-br from-primary via-slate-900 to-secondary text-white p-8 flex flex-col gap-6",children:[c.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_18%_22%,rgba(255,255,255,0.08),transparent_35%),radial-gradient(circle_at_88%_12%,rgba(255,255,255,0.12),transparent_35%)]"}),c.jsxs("div",{className:"relative space-y-3",children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-indigo-200/80 font-semibold",children:"Event workspace"}),c.jsx("h2",{className:"text-2xl font-bold leading-tight",children:F}),c.jsx("p",{className:"text-indigo-100/90 text-sm max-w-md",children:j})]}),c.jsxs("div",{className:"relative grid grid-cols-1 gap-3 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(SA,{className:"w-5 h-5 text-amber-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Unified status"}),c.jsx("p",{className:"text-indigo-100/80",children:"Tables, RSVPs, wallet and seating stay on the active event."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(TA,{className:"w-5 h-5 text-sky-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Safe switching"}),c.jsx("p",{className:"text-indigo-100/80",children:"Change events without altering any of your existing data."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(_A,{className:"w-5 h-5 text-emerald-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Quick create"}),c.jsx("p",{className:"text-indigo-100/80",children:"Start a fresh celebration directly from this selector."})]})]})]}),c.jsxs("div",{className:"relative mt-auto",children:[c.jsx(Me,{onClick:b,className:"w-full justify-center bg-white text-primary hover:bg-primary/10",children:"Start a new event"}),c.jsx("p",{className:"text-xs text-indigo-100/80 text-center mt-3",children:"You'll return here whenever you need to focus on a different event."})]})]}),c.jsxs("div",{className:"flex flex-col bg-accent/30",children:[c.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-gray-200",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Event library"}),c.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Active & archived plans"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Select an event to continue. Everything else stays intact."})]}),c.jsx("button",{onClick:l,className:"p-2 rounded-full border text-gray-500 hover:bg-gray-100 transition disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Close selector",disabled:t,children:c.jsx(dg,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-3 scrollbar-thin scrollbar-thumb-primary/20",children:r.length===0?c.jsx("div",{className:"h-full min-h-[280px] flex items-center justify-center text-center p-6 bg-white rounded-xl border border-dashed border-primary/20",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"No events yet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create your first celebration to unlock the dashboard experience."}),c.jsx(Me,{onClick:b,children:"Create an event"})]})}):c.jsx("ul",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:r.map(T=>{var z;const C=a===T.id,O=!!((z=T==null?void 0:T.raw)!=null&&z.isDeleted),V=T.date?new Date(T.date).toLocaleDateString():"Date pending";return c.jsxs("li",{role:"option","aria-selected":C,tabIndex:0,onKeyDown:H=>{(H.key==="Enter"||H.key===" ")&&(H.preventDefault(),y(T.id))},onClick:()=>y(T.id),className:`group relative rounded-xl border transition shadow-sm bg-white cursor-pointer outline-none ${C?"border-primary ring-2 ring-primary/25 shadow-primary/15":"border-primary/10 hover:border-primary/30 hover:shadow-md focus:ring-2 focus:ring-primary/25"}`,children:[c.jsx("div",{className:"absolute right-3 top-3",children:C?c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-indigo-50 text-indigo-700",children:[c.jsx(I0,{className:"w-4 h-4"})," Active"]}):O?c.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-amber-50 text-amber-700",children:"Archived"}):c.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-slate-100 text-slate-700",children:"Ready"})}),c.jsxs("div",{className:"px-4 pt-5 pb-4 space-y-2",children:[c.jsxs("h4",{className:"text-base font-semibold text-slate-900 pr-20 flex items-center gap-2",children:[c.jsx("span",{className:`inline-flex h-2.5 w-2.5 rounded-full ${C?"bg-emerald-500":"bg-primary"}`}),T.title]}),c.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(P0,{className:"w-4 h-4"}),c.jsx("span",{children:V})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Np,{className:"w-4 h-4"}),c.jsx("span",{children:T.location||"Add a venue"})]})]}),T.description&&c.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-wrap",children:[c.jsxs("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:["Tables: ",T.noOfTable??"-"]}),c.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:O?"Archived plan":"Live plan"})]})]}),c.jsxs("div",{className:"px-4 pb-4 pt-2 flex flex-wrap gap-2",children:[c.jsx(Me,{onClick:H=>{H.stopPropagation(),y(T.id)},className:`flex-1 justify-center ${C?"bg-emerald-600 hover:bg-emerald-500":""}`,children:C?"Using this event":"Use this event"}),c.jsx(Me,{variant:"secondary",onClick:H=>{H.stopPropagation(),w(T)},children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:H=>{H.stopPropagation(),O?_(T.id):E(T.id)},children:O?"Activate":"Archive"})]})]},T.id)})})}),c.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex flex-wrap gap-3 items-center justify-between bg-white",children:[c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"}),c.jsx("span",{children:t?"Choose an event to continue":"Switch anytime without losing changes"})]}),c.jsxs("div",{className:"flex gap-2",children:[!t&&c.jsx(Me,{variant:"secondary",onClick:l,children:"Cancel"}),c.jsx(Me,{onClick:b,children:"Create new event"})]})]})]})]})}),c.jsx(Xd,{isOpen:d,initial:m,onClose:N,onSuccess:k,className:"z-70"})]})}function I6(){const[e,t]=kl.useState(!1),{isSelectorOpen:r,mustChooseEvent:a}=Hr();return c.jsxs("div",{className:"flex h-screen bg-background dark:bg-slate-950 text-text",children:[c.jsx(B6,{isOpen:e,onClose:()=>t(!1)}),c.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[c.jsx($A,{onMenuToggle:()=>t(n=>!n)}),c.jsx("main",{className:"flex-1 p-6 overflow-auto",children:c.jsx(Bs,{})})]}),(a||r)&&c.jsx(P6,{})]})}const an=({message:e="Loading..."})=>c.jsxs("div",{className:"flex flex-col items-center justify-center py-32 gap-4 animate-fade-in",children:[c.jsx("div",{className:"text-primary",children:c.jsx(Xn,{})}),c.jsx("p",{className:"text-sm text-text/50 dark:text-white/50",children:e})]});function U6(){const[e,t]=A.useState(!1),{data:r=[],isLoading:a,isError:n}=hg(e),l=U4(),o=I4(),[f,d]=A.useState({open:!1}),x=ja(),{setEventId:m,eventId:p}=Hr(),[v,y]=A.useState(""),[b,w]=A.useState("upcoming"),[E,_]=KS();A.useEffect(()=>{const T=E.get("new")==="1",C=E.get("demo")==="1";if(T||C){const O=new Date;O.setMonth(O.getMonth()+2);const V=C?{title:"Sample Summer Wedding",date:O.toISOString().slice(0,10),description:"Pre-fill details to see how planning works.",location:"Pick your dream venue",noOfTable:12}:void 0;d({open:!0,event:V});const z=new URLSearchParams(E);z.delete("new"),z.delete("demo"),_(z,{replace:!0})}},[E,_]);const N=A.useMemo(()=>r.find(T=>T.id===p),[r,p]),k=A.useMemo(()=>{const T=v.toLowerCase();return r.filter(O=>{var V;return O.title.toLowerCase().includes(T)||((V=O.location)==null?void 0:V.toLowerCase().includes(T))}).sort((O,V)=>{if(b==="name")return O.title.localeCompare(V.title);const z=new Date(O.date).getTime(),H=new Date(V.date).getTime();return b==="upcoming"?z-H:H-z})},[r,v,b]),F=r.filter(T=>{var C;return!((C=T.raw)!=null&&C.isDeleted)}).length,j=r.filter(T=>{var C;return(C=T.raw)==null?void 0:C.isDeleted}).length,R=r.length?new Date(Math.min(...r.map(T=>new Date(T.date).getTime()).filter(T=>!Number.isNaN(T)))):void 0;return a?c.jsx(an,{message:"Loading events..."}):n?c.jsx("p",{children:"Failed to load events."}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Your Events"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Prioritize the next celebration or revisit archived plans."})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsxs(Me,{variant:e?"primary":"secondary",onClick:()=>t(T=>!T),children:[e?"Hide":"Show"," archived"]})})]}),N&&c.jsxs("div",{className:"p-4 rounded-xl border border-primary/25 bg-white shadow-sm shadow-primary/10 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(I0,{className:"w-6 h-6 text-primary mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-primary font-semibold",children:"Active event"}),c.jsx("p",{className:"text-lg font-semibold text-gray-800",children:N.title}),c.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[c.jsx(P0,{className:"w-4 h-4"}),new Date(N.date).toLocaleDateString()," ",c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Np,{className:"w-4 h-4"}),N.location||"Add a venue"]})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Me,{onClick:()=>x("/app/rsvps"),children:"Continue planning"}),c.jsx(Me,{variant:"secondary",onClick:()=>x(`${N.id}/form-fields`),children:"Customize fields"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Active events"}),c.jsx("p",{className:"text-2xl font-semibold text-primary",children:F})]}),c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Archived events"}),c.jsx("p",{className:"text-2xl font-semibold text-secondary",children:j})]}),c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Upcoming next"}),c.jsx("p",{className:"text-md text-gray-700",children:R?R.toLocaleDateString():"Add a date"})]})]}),c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[c.jsxs("div",{className:"flex flex-1 gap-3",children:[c.jsx("input",{type:"search",value:v,onChange:T=>y(T.target.value),placeholder:"Search by name or location",className:"w-full border border-primary/20 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary/20"}),c.jsxs("select",{value:b,onChange:T=>w(T.target.value),className:"border border-primary/20 rounded-lg px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-primary/20",children:[c.jsx("option",{value:"upcoming",children:"Soonest first"}),c.jsx("option",{value:"recent",children:"Most recent"}),c.jsx("option",{value:"name",children:"Alphabetical"})]})]}),c.jsxs("div",{className:"hidden lg:block text-right text-sm text-gray-500",children:["Welcome to ",c.jsx("span",{className:"text-secondary font-semibold",children:"My Big Day"})]})]}),k.length===0?c.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70",children:[c.jsx("p",{className:"text-lg font-semibold",children:"No events match your filters."}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create one to start planning or clear the search."}),c.jsx(Me,{onClick:()=>d({open:!0}),children:"Create your first event"})]}):c.jsx("ul",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:k.map(T=>{var V;const C=p===T.id,O=!!((V=T==null?void 0:T.raw)!=null&&V.isDeleted);return c.jsx("li",{className:`p-4 rounded-xl border shadow-sm transition hover:shadow-md bg-white/90 backdrop-blur dark:bg-gray-800 ${C?"border-primary":"border-gray-100"}`,children:c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:T.title}),C&&c.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-semibold px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:[c.jsx(I0,{className:"w-4 h-4"})," Active"]}),O&&c.jsx("span",{className:"inline-block text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800",children:"Archived"})]}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex flex-wrap items-center gap-2",children:[c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx(P0,{className:"w-4 h-4"}),new Date(T.date).toLocaleDateString()]}),c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx(Np,{className:"w-4 h-4"}),T.location||"Add a venue"]})]}),T.description&&c.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),c.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-3",children:[c.jsxs("span",{children:["Tables: ",T.noOfTable??"Not set"]}),c.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),c.jsx("span",{children:O?"Archived plan":"Ready for guests"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx(Me,{onClick:()=>{m(T.id),x("/app/rsvps")},children:C?" Active":"Select event"}),c.jsx(Me,{variant:"secondary",onClick:()=>x(`${T.id}/form-fields`),children:"Form fields"}),c.jsx(Me,{variant:"secondary",onClick:()=>x(`${T.id}/edit`),children:"Edit details"}),O?c.jsx(Me,{variant:"primary",style:{backgroundColor:"#16a34a",borderColor:"#16a34a"},onClick:()=>o.mutate(T.id),disabled:o.isPending,children:o.isPending?"Activating":"Activate"}):c.jsx(Me,{variant:"secondary",style:{backgroundColor:"#dc2626",borderColor:"#dc2626"},onClick:()=>l.mutate(T.id),disabled:l.isPending,children:l.isPending?"Deactivating":"Archive"})]})]})},T.id)})}),c.jsx(Xd,{isOpen:f.open,onClose:()=>d({open:!1}),onSuccess:()=>d({open:!1}),initial:f.event})]}),c.jsx(Bs,{})]})}function z6(){const{id:e}=Nn(),t=ja(),{data:r,isLoading:a,isError:n}=MA(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Xn,{})}):n||!r?c.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load Event."}):c.jsx(Xd,{isOpen:!0,initial:r,onClose:()=>t(-1)})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var wd={};wd.version="0.18.5";var H4=1252,H6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mg=function(e){H6.indexOf(e)!=-1&&(H4=xg[0]=e)};function G6(){mg(1252)}var Un=function(e){mg(e)};function pg(){Un(1200),G6()}function zb(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function V6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function G4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var S0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?V6(e.slice(2)):t==254&&r==255?G4(e.slice(2)):t==65279?e.slice(1):e},If=function(t){return String.fromCharCode(t)},Hb=function(t){return String.fromCharCode(t)},U0,Mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function z0(e){for(var t="",r=0,a=0,n=0,l=0,o=0,f=0,d=0,x=0;x<e.length;)r=e.charCodeAt(x++),l=r>>2,a=e.charCodeAt(x++),o=(r&3)<<4|a>>4,n=e.charCodeAt(x++),f=(a&15)<<2|n>>6,d=n&63,isNaN(a)?f=d=64:isNaN(n)&&(d=64),t+=Mi.charAt(l)+Mi.charAt(o)+Mi.charAt(f)+Mi.charAt(d);return t}function rn(e){var t="",r=0,a=0,n=0,l=0,o=0,f=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Mi.indexOf(e.charAt(x++)),o=Mi.indexOf(e.charAt(x++)),r=l<<2|o>>4,t+=String.fromCharCode(r),f=Mi.indexOf(e.charAt(x++)),a=(o&15)<<4|f>>2,f!==64&&(t+=String.fromCharCode(a)),d=Mi.indexOf(e.charAt(x++)),n=(f&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var vt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ii(e){return vt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Gb(e){return vt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ja=function(t){return vt?Xs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $d(e){if(typeof ArrayBuffer>"u")return Ja(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Vi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function q6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function gg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return gg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Yr=vt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Xs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function W6(e){for(var t=[],r=0,a=e.length+250,n=Ii(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var f=e.charCodeAt(++l)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|f>>6&15|(o&3)<<4,n[r++]=128|f&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Ii(65535),a=65530)}return t.push(n.slice(0,r)),Yr(t)}var Aa=/\u0000/g,E0=/[\u0001-\u0006]/g;function Uo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function zn(e,t){var r=""+e;return r.length>=t?r:vr("0",t-r.length)+r}function vg(e,t){var r=""+e;return r.length>=t?r:vr(" ",t-r.length)+r}function Sd(e,t){var r=""+e;return r.length>=t?r:r+vr(" ",t-r.length)}function X6(e,t){var r=""+Math.round(e);return r.length>=t?r:vr("0",t-r.length)+r}function $6(e,t){var r=""+e;return r.length>=t?r:vr("0",t-r.length)+r}var Vb=Math.pow(2,32);function jo(e,t){if(e>Vb||e<-Vb)return X6(e,t);var r=Math.round(e);return $6(r,t)}function Ed(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var qb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Y6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Wb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _d(e,t,r){for(var a=e<0?-1:1,n=e*a,l=0,o=1,f=0,d=1,x=0,m=0,p=Math.floor(n);x<t&&(p=Math.floor(n),f=p*o+l,m=p*x+d,!(n-p<5e-8));)n=1/(n-p),l=o,o=f,d=x,x=m;if(m>t&&(x>t?(m=d,f=l):(m=x,f=o)),!r)return[0,a*f,m];var v=Math.floor(a*f/m);return[v,a*f-v*m,m]}function xl(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),l=0,o=[],f={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),t&&t.date1904&&(a+=1462),f.u>.9999&&(f.u=0,++n==86400&&(f.T=n=0,++a,++f.D)),a===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),a<60&&(l=(l+6)%7),r&&(l=rj(d,o))}return f.y=o[0],f.m=o[1],f.d=o[2],f.S=n%60,n=Math.floor(n/60),f.M=n%60,n=Math.floor(n/60),f.H=n,f.q=l,f}var V4=new Date(1899,11,31,0,0,0),Q6=V4.getTime(),Z6=new Date(1900,2,1,0,0,0);function q4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Z6&&(r+=24*60*60*1e3),(r-(Q6+(e.getTimezoneOffset()-V4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function yg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ej(e){var t=e<0?12:11,r=yg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function tj(e){var t=yg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function H0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ej(e):t===10?r=e.toFixed(10).substr(0,12):r=tj(e),yg(J6(r.toUpperCase()))}function Ml(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):H0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return kn(14,q4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function rj(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function aj(e,t,r,a){var n="",l=0,o=0,f=r.y,d,x=0;switch(e){case 98:f=r.y+543;case 121:switch(t.length){case 1:case 2:d=f%100,x=2;break;default:d=f%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,x=t.length;break;case 3:return Pm[r.m-1][1];case 5:return Pm[r.m-1][0];default:return Pm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,x=t.length;break;case 3:return qb[r.q][0];default:return qb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?zn(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(n=zn(l,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:d=f,x=1;break}var m=x>0?zn(d,x):"";return m}function Li(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var W4=/%/g;function nj(e,t,r){var a=t.replace(W4,""),n=t.length-a.length;return Us(e,a,r*Math.pow(10,2*n))+vr("%",n)}function sj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function X4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+X4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,x,m){return d+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $4=/# (\?+)( ?)\/( ?)(\d+)/;function ij(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),l=Math.floor(n/a),o=n-l*a,f=a;return r+(l===0?"":""+l)+" "+(o===0?vr(" ",e[1].length+1+e[4].length):vg(o,e[1].length)+e[2]+"/"+e[3]+zn(f,e[4].length))}function lj(e,t,r){return r+(t===0?"":""+t)+vr(" ",e[1].length+2+e[4].length)}var Y4=/^#*0*\.([0#]+)/,K4=/\).*[0#]/,Q4=/\(###\) ###\\?-####/;function ka(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Xb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $b(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function oj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function cj(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gn("n",a,r):"("+gn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sj(e,t,r);if(t.indexOf("%")!==-1)return nj(e,t,r);if(t.indexOf("E")!==-1)return X4(t,r);if(t.charCodeAt(0)===36)return"$"+gn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,f,d=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+jo(d,t.length);if(t.match(/^[#?]+$/))return n=jo(r,0),n==="0"&&(n=""),n.length>t.length?n:ka(t.substr(0,t.length-n.length))+n;if(l=t.match($4))return ij(l,d,x);if(t.match(/^#+0+$/))return x+jo(d,t.length-t.indexOf("0"));if(l=t.match(Y4))return n=Xb(r,l[1].length).replace(/^([^\.]+)$/,"$1."+ka(l[1])).replace(/\.$/,"."+ka(l[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+vr("0",ka(l[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+Xb(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Li(jo(d,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gn(e,t,-r):Li(""+(Math.floor(r)+oj(r,l[1].length)))+"."+zn($b(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return gn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Uo(gn(e,t.replace(/[\\-]/g,""),r)),o=0,Uo(Uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(t.match(Q4))return n=gn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=_d(d,Math.pow(10,o)-1,!1),n=""+x,m=Us("n",l[1],f[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=Sd(f[2],o),m.length<l[4].length&&(m=ka(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=_d(d,Math.pow(10,o)-1,!0),x+(f[0]||(f[1]?"":"0"))+" "+(f[1]?vg(f[1],o)+l[2]+"/"+l[3]+Sd(f[2],o):vr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=jo(r,0),t.length<=n.length?n:ka(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var p=t.indexOf(".")-o,v=t.length-n.length-p;return ka(t.substr(0,p)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=$b(r,l[1].length),r<0?"-"+gn(e,t,-r):Li(cj(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?zn(0,3-b.length):"")+b})+"."+zn(o,l[1].length);switch(t){case"###,##0.00":return gn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Li(jo(d,0));return y!=="0"?x+y:"";case"###,###.00":return gn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function uj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function fj(e,t,r){var a=t.replace(W4,""),n=t.length-a.length;return Us(e,a,r*Math.pow(10,2*n))+vr("%",n)}function Z4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Z4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,x,m){return d+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ls(e,t,r){if(e.charCodeAt(0)===40&&!t.match(K4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ls("n",a,r):"("+ls("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uj(e,t,r);if(t.indexOf("%")!==-1)return fj(e,t,r);if(t.indexOf("E")!==-1)return Z4(t,r);if(t.charCodeAt(0)===36)return"$"+ls(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,f,d=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+zn(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ka(t.substr(0,t.length-n.length))+n;if(l=t.match($4))return lj(l,d,x);if(t.match(/^#+0+$/))return x+zn(d,t.length-t.indexOf("0"));if(l=t.match(Y4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ka(l[1])).replace(/\.$/,"."+ka(l[1])),n=n.replace(/\.(\d*)$/,function(b,w){return"."+w+vr("0",ka(l[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Li(""+d);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ls(e,t,-r):Li(""+r)+"."+vr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return ls(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Uo(ls(e,t.replace(/[\\-]/g,""),r)),o=0,Uo(Uo(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(t.match(Q4))return n=ls(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=_d(d,Math.pow(10,o)-1,!1),n=""+x,m=Us("n",l[1],f[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=Sd(f[2],o),m.length<l[4].length&&(m=ka(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=_d(d,Math.pow(10,o)-1,!0),x+(f[0]||(f[1]?"":"0"))+" "+(f[1]?vg(f[1],o)+l[2]+"/"+l[3]+Sd(f[2],o):vr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ka(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var p=t.indexOf(".")-o,v=t.length-n.length-p;return ka(t.substr(0,p)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ls(e,t,-r):Li(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?zn(0,3-b.length):"")+b})+"."+zn(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Li(""+d);return y!=="0"?x+y:"";default:if(t.match(/\.[0#?]*$/))return ls(e,t.slice(0,t.lastIndexOf(".")),r)+ka(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Us(e,t,r){return(r|0)===r?ls(e,t,r):gn(e,t,r)}function dj(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var J4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xc(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Ed(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(J4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function hj(e,t,r,a){for(var n=[],l="",o=0,f="",d="t",x,m,p,v="H";o<e.length;)switch(f=e.charAt(o)){case"G":if(!Ed(e,o))throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(p=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(p);n[n.length]={t:"t",v:l},++o;break;case"\\":var y=e.charAt(++o),b=y==="("||y===")"?y:"t";n[n.length]={t:b,v:y},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=xl(t,r,e.charAt(o+1)==="2"),x==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},d=f,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=xl(t,r),x==null))return"";for(l=f;++o<e.length&&e.charAt(o).toLowerCase()===f;)l+=f;f==="m"&&d.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=v),n[n.length]={t:f,v:l},d=f;break;case"A":case"a":case"":var w={t:f,v:f};if(x==null&&(x=xl(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(w.v=x.H>=12?"P":"A"),w.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(w.v=x.H>=12?"PM":"AM"),w.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(w.v=x.H>=12?"":""),w.t="T",o+=5,v="h"):(w.t="t",++o),x==null&&w.t==="T")return"";n[n.length]=w,d=f;break;case"[":for(l=f;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(J4)){if(x==null&&(x=xl(t,r),x==null))return"";n[n.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",xc(e)||(n[n.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=f;++o<e.length&&(f=e.charAt(o))==="0";)l+=f;n[n.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++o<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(o))>-1;)l+=f;n[n.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++o)===f;)l+=f;n[n.length]={t:f,v:l},d=f;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":f,v:f},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);n[n.length]={t:"D",v:l};break;case" ":n[n.length]={t:f,v:f},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"t",v:f},++o;break}var E=0,_=0,N;for(o=n.length-1,d="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=v,d="h",E<1&&(E=1);break;case"s":(N=n[o].v.match(/\.0+$/))&&(_=Math.max(_,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":d=n[o].t;break;case"m":d==="s"&&(n[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&n[o].v.match(/[Hh]/)&&(E=1),E<2&&n[o].v.match(/[Mm]/)&&(E=2),E<3&&n[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var k="",F;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=aj(n[o].t.charCodeAt(0),n[o].v,x,_),n[o].t="t";break;case"n":case"?":for(F=o+1;n[F]!=null&&((f=n[F].t)==="?"||f==="D"||(f===" "||f==="t")&&n[F+1]!=null&&(n[F+1].t==="?"||n[F+1].t==="t"&&n[F+1].v==="/")||n[o].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(n[F].v==="/"||n[F].v===" "&&n[F+1]!=null&&n[F+1].t=="?"));)n[o].v+=n[F].v,n[F]={v:"",t:";"},++F;k+=n[o].v,o=F-1;break;case"G":n[o].t="t",n[o].v=Ml(t,r);break}var j="",R,T;if(k.length>0){k.charCodeAt(0)==40?(R=t<0&&k.charCodeAt(0)===45?-t:t,T=Us("n",k,R)):(R=t<0&&a>1?-t:t,T=Us("n",k,R),R<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),F=T.length-1;var C=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){C=o;break}var O=n.length;if(C===n.length&&T.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(F>=n[o].v.length-1?(F-=n[o].v.length,n[o].v=T.substr(F+1,n[o].v.length)):F<0?n[o].v="":(n[o].v=T.substr(0,F+1),F=-1),n[o].t="t",O=o);F>=0&&O<n.length&&(n[O].v=T.substr(0,F+1)+n[O].v)}else if(C!==n.length&&T.indexOf("E")===-1){for(F=T.indexOf(".")-1,o=C;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(m=n[o].v.indexOf(".")>-1&&o===C?n[o].v.indexOf(".")-1:n[o].v.length-1,j=n[o].v.substr(m+1);m>=0;--m)F>=0&&(n[o].v.charAt(m)==="0"||n[o].v.charAt(m)==="#")&&(j=T.charAt(F--)+j);n[o].v=j,n[o].t="t",O=o}for(F>=0&&O<n.length&&(n[O].v=T.substr(0,F+1)+n[O].v),F=T.indexOf(".")+1,o=C;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==C)){for(m=n[o].v.indexOf(".")>-1&&o===C?n[o].v.indexOf(".")+1:0,j=n[o].v.substr(0,m);m<n[o].v.length;++m)F<T.length&&(j+=T.charAt(F++));n[o].v=j,n[o].t="t",O=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(R=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Us(n[o].t,n[o].v,R),n[o].t="t");var V="";for(o=0;o!==n.length;++o)n[o]!=null&&(V+=n[o].v);return V}var Yb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function xj(e,t){var r=dj(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Yb),f=r[1].match(Yb);return Kb(t,o)?[a,r[0]]:Kb(t,f)?[a,r[1]]:[a,r[o!=null&&f!=null?2:1]]}return[a,l]}function kn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:et)[e],a==null&&(a=r.table&&r.table[Wb[e]]||et[Wb[e]]),a==null&&(a=K6[e]||"General");break}if(Ed(a,0))return Ml(t,r);t instanceof Date&&(t=q4(t,r.date1904));var n=xj(a,t);if(Ed(n[1]))return Ml(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return hj(n[1],t,r,n[0])}function zs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(et[r]==null){t<0&&(t=r);continue}if(et[r]==e){t=r;break}}t<0&&(t=391)}return et[t]=e,t}function Yd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&zs(e[t],t)}function mc(){et=Y6()}var mj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pj(e){var t=typeof e=="number"?et[e]:e;return t=t.replace(eE,"(\\d+)"),new RegExp("^"+t+"$")}function gj(e,t,r){var a=-1,n=-1,l=-1,o=-1,f=-1,d=-1;(t.match(eE)||[]).forEach(function(p,v){var y=parseInt(r[v+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=y;break;case"d":l=y;break;case"h":o=y;break;case"s":d=y;break;case"m":o>=0?f=y:n=y;break}}),d>=0&&f==-1&&n>=0&&(f=n,n=-1);var x=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&f==-1&&d==-1?x:a==-1&&n==-1&&l==-1?m:x+"T"+m}var vj=function(){var e={};e.version="1.2.0";function t(){for(var T=0,C=new Array(256),O=0;O!=256;++O)T=O,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,C[O]=T;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function a(T){var C=0,O=0,V=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)z[V]=T[V];for(V=0;V!=256;++V)for(O=T[V],C=256+V;C<4096;C+=256)O=z[C]=O>>>8^T[O&255];var H=[];for(V=1;V!=16;++V)H[V-1]=typeof Int32Array<"u"?z.subarray(V*256,V*256+256):z.slice(V*256,V*256+256);return H}var n=a(r),l=n[0],o=n[1],f=n[2],d=n[3],x=n[4],m=n[5],p=n[6],v=n[7],y=n[8],b=n[9],w=n[10],E=n[11],_=n[12],N=n[13],k=n[14];function F(T,C){for(var O=C^-1,V=0,z=T.length;V<z;)O=O>>>8^r[(O^T.charCodeAt(V++))&255];return~O}function j(T,C){for(var O=C^-1,V=T.length-15,z=0;z<V;)O=k[T[z++]^O&255]^N[T[z++]^O>>8&255]^_[T[z++]^O>>16&255]^E[T[z++]^O>>>24]^w[T[z++]]^b[T[z++]]^y[T[z++]]^v[T[z++]]^p[T[z++]]^m[T[z++]]^x[T[z++]]^d[T[z++]]^f[T[z++]]^o[T[z++]]^l[T[z++]]^r[T[z++]];for(V+=15;z<V;)O=O>>>8^r[(O^T[z++])&255];return~O}function R(T,C){for(var O=C^-1,V=0,z=T.length,H=0,ie=0;V<z;)H=T.charCodeAt(V++),H<128?O=O>>>8^r[(O^H)&255]:H<2048?(O=O>>>8^r[(O^(192|H>>6&31))&255],O=O>>>8^r[(O^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,ie=T.charCodeAt(V++)&1023,O=O>>>8^r[(O^(240|H>>8&7))&255],O=O>>>8^r[(O^(128|H>>2&63))&255],O=O>>>8^r[(O^(128|ie>>6&15|(H&3)<<4))&255],O=O>>>8^r[(O^(128|ie&63))&255]):(O=O>>>8^r[(O^(224|H>>12&15))&255],O=O>>>8^r[(O^(128|H>>6&63))&255],O=O>>>8^r[(O^(128|H&63))&255]);return~O}return e.table=r,e.bstr=F,e.buf=j,e.str=R,e}(),$e=function(){var t={};t.version="1.2.1";function r(M,X){for(var G=M.split("/"),q=X.split("/"),W=0,K=0,de=Math.min(G.length,q.length);W<de;++W){if(K=G[W].length-q[W].length)return K;if(G[W]!=q[W])return G[W]<q[W]?-1:1}return G.length-q.length}function a(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:a(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(0,X+1)}function n(M){if(M.charAt(M.length-1)=="/")return n(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(X+1)}function l(M,X){typeof X=="string"&&(X=new Date(X));var G=X.getHours();G=G<<6|X.getMinutes(),G=G<<5|X.getSeconds()>>>1,M.write_shift(2,G);var q=X.getFullYear()-1980;q=q<<4|X.getMonth()+1,q=q<<5|X.getDate(),M.write_shift(2,q)}function o(M){var X=M.read_shift(2)&65535,G=M.read_shift(2)&65535,q=new Date,W=G&31;G>>>=5;var K=G&15;G>>>=4,q.setMilliseconds(0),q.setFullYear(G+1980),q.setMonth(K-1),q.setDate(W);var de=X&31;X>>>=5;var Se=X&63;return X>>>=6,q.setHours(X),q.setMinutes(Se),q.setSeconds(de<<1),q}function f(M){sa(M,0);for(var X={},G=0;M.l<=M.length-4;){var q=M.read_shift(2),W=M.read_shift(2),K=M.l+W,de={};switch(q){case 21589:G=M.read_shift(1),G&1&&(de.mtime=M.read_shift(4)),W>5&&(G&2&&(de.atime=M.read_shift(4)),G&4&&(de.ctime=M.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}M.l=K,X[q]=de}return X}var d;function x(){return d||(d={})}function m(M,X){if(M[0]==80&&M[1]==75)return ot(M,X);if((M[0]|32)==109&&(M[1]|32)==105)return oh(M,X);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var G=3,q=512,W=0,K=0,de=0,Se=0,ce=0,he=[],me=M.slice(0,512);sa(me,0);var Re=p(me);switch(G=Re[0],G){case 3:q=512;break;case 4:q=4096;break;case 0:if(Re[1]==0)return ot(M,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}q!==512&&(me=M.slice(0,q),sa(me,28));var Le=M.slice(0,q);v(me,G);var ze=me.read_shift(4,"i");if(G===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);me.l+=4,de=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),Se=me.read_shift(4,"i"),W=me.read_shift(4,"i"),ce=me.read_shift(4,"i"),K=me.read_shift(4,"i");for(var Fe=-1,Ie=0;Ie<109&&(Fe=me.read_shift(4,"i"),!(Fe<0));++Ie)he[Ie]=Fe;var ct=y(M,q);E(ce,K,ct,q,he);var Ht=N(ct,de,he,q);Ht[de].name="!Directory",W>0&&Se!==ie&&(Ht[Se].name="!MiniFAT"),Ht[he[0]].name="!FAT",Ht.fat_addrs=he,Ht.ssz=q;var Gt={},Jt=[],gs=[],Qs=[];k(de,Ht,ct,Jt,W,Gt,gs,Se),b(gs,Qs,Jt),Jt.shift();var sn={FileIndex:gs,FullPaths:Qs};return X&&X.raw&&(sn.raw={header:Le,sectors:ct}),sn}function p(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(we,"Header Signature: "),M.l+=16;var X=M.read_shift(2,"u");return[M.read_shift(2,"u"),X]}function v(M,X){var G=9;switch(M.l+=2,G=M.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function y(M,X){for(var G=Math.ceil(M.length/X)-1,q=[],W=1;W<G;++W)q[W-1]=M.slice(W*X,(W+1)*X);return q[G-1]=M.slice(G*X),q}function b(M,X,G){for(var q=0,W=0,K=0,de=0,Se=0,ce=G.length,he=[],me=[];q<ce;++q)he[q]=me[q]=q,X[q]=G[q];for(;Se<me.length;++Se)q=me[Se],W=M[q].L,K=M[q].R,de=M[q].C,he[q]===q&&(W!==-1&&he[W]!==W&&(he[q]=he[W]),K!==-1&&he[K]!==K&&(he[q]=he[K])),de!==-1&&(he[de]=q),W!==-1&&q!=he[q]&&(he[W]=he[q],me.lastIndexOf(W)<Se&&me.push(W)),K!==-1&&q!=he[q]&&(he[K]=he[q],me.lastIndexOf(K)<Se&&me.push(K));for(q=1;q<ce;++q)he[q]===q&&(K!==-1&&he[K]!==K?he[q]=he[K]:W!==-1&&he[W]!==W&&(he[q]=he[W]));for(q=1;q<ce;++q)if(M[q].type!==0){if(Se=q,Se!=he[Se])do Se=he[Se],X[q]=X[Se]+"/"+X[q];while(Se!==0&&he[Se]!==-1&&Se!=he[Se]);he[q]=-1}for(X[0]+="/",q=1;q<ce;++q)M[q].type!==2&&(X[q]+="/")}function w(M,X,G){for(var q=M.start,W=M.size,K=[],de=q;G&&W>0&&de>=0;)K.push(X.slice(de*H,de*H+H)),W-=H,de=dl(G,de*4);return K.length===0?Ee(0):Yr(K).slice(0,M.size)}function E(M,X,G,q,W){var K=ie;if(M===ie){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var de=G[M],Se=(q>>>2)-1;if(!de)return;for(var ce=0;ce<Se&&(K=dl(de,ce*4))!==ie;++ce)W.push(K);E(dl(de,q-4),X-1,G,q,W)}}function _(M,X,G,q,W){var K=[],de=[];W||(W=[]);var Se=q-1,ce=0,he=0;for(ce=X;ce>=0;){W[ce]=!0,K[K.length]=ce,de.push(M[ce]);var me=G[Math.floor(ce*4/q)];if(he=ce*4&Se,q<4+he)throw new Error("FAT boundary crossed: "+ce+" 4 "+q);if(!M[me])break;ce=dl(M[me],he)}return{nodes:K,data:ow([de])}}function N(M,X,G,q){var W=M.length,K=[],de=[],Se=[],ce=[],he=q-1,me=0,Re=0,Le=0,ze=0;for(me=0;me<W;++me)if(Se=[],Le=me+X,Le>=W&&(Le-=W),!de[Le]){ce=[];var Fe=[];for(Re=Le;Re>=0;){Fe[Re]=!0,de[Re]=!0,Se[Se.length]=Re,ce.push(M[Re]);var Ie=G[Math.floor(Re*4/q)];if(ze=Re*4&he,q<4+ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+q);if(!M[Ie]||(Re=dl(M[Ie],ze),Fe[Re]))break}K[Le]={nodes:Se,data:ow([ce])}}return K}function k(M,X,G,q,W,K,de,Se){for(var ce=0,he=q.length?2:0,me=X[M].data,Re=0,Le=0,ze;Re<me.length;Re+=128){var Fe=me.slice(Re,Re+128);sa(Fe,64),Le=Fe.read_shift(2),ze=Tg(Fe,0,Le-he),q.push(ze);var Ie={name:ze,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},ct=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);ct!==0&&(Ie.ct=F(Fe,Fe.l-8));var Ht=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Ht!==0&&(Ie.mt=F(Fe,Fe.l-8)),Ie.start=Fe.read_shift(4,"i"),Ie.size=Fe.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=ie,Ie.name=""),Ie.type===5?(ce=Ie.start,W>0&&ce!==ie&&(X[ce].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",X[Ie.start]===void 0&&(X[Ie.start]=_(G,Ie.start,X.fat_addrs,X.ssz)),X[Ie.start].name=Ie.name,Ie.content=X[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:ce!==ie&&Ie.start!==ie&&X[ce]&&(Ie.content=w(Ie,X[ce].data,(X[Se]||{}).data))),Ie.content&&sa(Ie.content,0),K[ze]=Ie,de.push(Ie)}}function F(M,X){return new Date((Za(M,X+4)/1e7*Math.pow(2,32)+Za(M,X)/1e7-11644473600)*1e3)}function j(M,X){return x(),m(d.readFileSync(M),X)}function R(M,X){var G=X&&X.type;switch(G||vt&&Buffer.isBuffer(M)&&(G="buffer"),G||"base64"){case"file":return j(M,X);case"base64":return m(Ja(rn(M)),X);case"binary":return m(Ja(M),X)}return m(M,X)}function T(M,X){var G=X||{},q=G.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=q+"/",M.FileIndex[0]={name:q,type:5}),G.CLSID&&(M.FileIndex[0].clsid=G.CLSID),C(M)}function C(M){var X="Sh33tJ5";if(!$e.find(M,"/"+X)){var G=Ee(4);G[0]=55,G[1]=G[3]=50,G[2]=54,M.FileIndex.push({name:X,type:2,content:G,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+X),O(M)}}function O(M,X){T(M);for(var G=!1,q=!1,W=M.FullPaths.length-1;W>=0;--W){var K=M.FileIndex[W];switch(K.type){case 0:q?G=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(K.R*K.L*K.C)&&(G=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!X)){var de=new Date(1987,1,19),Se=0,ce=Object.create?Object.create(null):{},he=[];for(W=0;W<M.FullPaths.length;++W)ce[M.FullPaths[W]]=!0,M.FileIndex[W].type!==0&&he.push([M.FullPaths[W],M.FileIndex[W]]);for(W=0;W<he.length;++W){var me=a(he[W][0]);q=ce[me],q||(he.push([me,{name:n(me).replace("/",""),type:1,clsid:ee,ct:de,mt:de,content:null}]),ce[me]=!0)}for(he.sort(function(ze,Fe){return r(ze[0],Fe[0])}),M.FullPaths=[],M.FileIndex=[],W=0;W<he.length;++W)M.FullPaths[W]=he[W][0],M.FileIndex[W]=he[W][1];for(W=0;W<he.length;++W){var Re=M.FileIndex[W],Le=M.FullPaths[W];if(Re.name=n(Le).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||ee,W===0)Re.C=he.length>1?1:-1,Re.size=0,Re.type=5;else if(Le.slice(-1)=="/"){for(Se=W+1;Se<he.length&&a(M.FullPaths[Se])!=Le;++Se);for(Re.C=Se>=he.length?-1:Se,Se=W+1;Se<he.length&&a(M.FullPaths[Se])!=a(Le);++Se);Re.R=Se>=he.length?-1:Se,Re.type=1}else a(M.FullPaths[W+1]||"")==a(Le)&&(Re.R=W+1),Re.type=2}}}function V(M,X){var G=X||{};if(G.fileType=="mad")return Zn(M,G);switch(O(M),G.fileType){case"zip":return ea(M,G)}var q=function(ze){for(var Fe=0,Ie=0,ct=0;ct<ze.FileIndex.length;++ct){var Ht=ze.FileIndex[ct];if(Ht.content){var Gt=Ht.content.length;Gt>0&&(Gt<4096?Fe+=Gt+63>>6:Ie+=Gt+511>>9)}}for(var Jt=ze.FullPaths.length+3>>2,gs=Fe+7>>3,Qs=Fe+127>>7,sn=gs+Ie+Jt+Qs,jn=sn+127>>7,Yi=jn<=109?0:Math.ceil((jn-109)/127);sn+jn+Yi+127>>7>jn;)Yi=++jn<=109?0:Math.ceil((jn-109)/127);var Rn=[1,Yi,jn,Qs,Jt,Ie,Fe,0];return ze.FileIndex[0].size=Fe<<6,Rn[7]=(ze.FileIndex[0].start=Rn[0]+Rn[1]+Rn[2]+Rn[3]+Rn[4]+Rn[5])+(Rn[6]+7>>3),Rn}(M),W=Ee(q[7]<<9),K=0,de=0;{for(K=0;K<8;++K)W.write_shift(1,ge[K]);for(K=0;K<8;++K)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),K=0;K<3;++K)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,q[2]),W.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:ie),W.write_shift(4,q[3]),W.write_shift(-4,q[1]?q[0]-1:ie),W.write_shift(4,q[1]),K=0;K<109;++K)W.write_shift(-4,K<q[2]?q[1]+K:-1)}if(q[1])for(de=0;de<q[1];++de){for(;K<236+de*127;++K)W.write_shift(-4,K<q[2]?q[1]+K:-1);W.write_shift(-4,de===q[1]-1?ie:de+1)}var Se=function(ze){for(de+=ze;K<de-1;++K)W.write_shift(-4,K+1);ze&&(++K,W.write_shift(-4,ie))};for(de=K=0,de+=q[1];K<de;++K)W.write_shift(-4,le.DIFSECT);for(de+=q[2];K<de;++K)W.write_shift(-4,le.FATSECT);Se(q[3]),Se(q[4]);for(var ce=0,he=0,me=M.FileIndex[0];ce<M.FileIndex.length;++ce)me=M.FileIndex[ce],me.content&&(he=me.content.length,!(he<4096)&&(me.start=de,Se(he+511>>9)));for(Se(q[6]+7>>3);W.l&511;)W.write_shift(-4,le.ENDOFCHAIN);for(de=K=0,ce=0;ce<M.FileIndex.length;++ce)me=M.FileIndex[ce],me.content&&(he=me.content.length,!(!he||he>=4096)&&(me.start=de,Se(he+63>>6)));for(;W.l&511;)W.write_shift(-4,le.ENDOFCHAIN);for(K=0;K<q[4]<<2;++K){var Re=M.FullPaths[K];if(!Re||Re.length===0){for(ce=0;ce<17;++ce)W.write_shift(4,0);for(ce=0;ce<3;++ce)W.write_shift(4,-1);for(ce=0;ce<12;++ce)W.write_shift(4,0);continue}me=M.FileIndex[K],K===0&&(me.start=me.size?me.start-1:ie);var Le=K===0&&G.root||me.name;if(he=2*(Le.length+1),W.write_shift(64,Le,"utf16le"),W.write_shift(2,he),W.write_shift(1,me.type),W.write_shift(1,me.color),W.write_shift(-4,me.L),W.write_shift(-4,me.R),W.write_shift(-4,me.C),me.clsid)W.write_shift(16,me.clsid,"hex");else for(ce=0;ce<4;++ce)W.write_shift(4,0);W.write_shift(4,me.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,me.start),W.write_shift(4,me.size),W.write_shift(4,0)}for(K=1;K<M.FileIndex.length;++K)if(me=M.FileIndex[K],me.size>=4096)if(W.l=me.start+1<<9,vt&&Buffer.isBuffer(me.content))me.content.copy(W,W.l,0,me.size),W.l+=me.size+511&-512;else{for(ce=0;ce<me.size;++ce)W.write_shift(1,me.content[ce]);for(;ce&511;++ce)W.write_shift(1,0)}for(K=1;K<M.FileIndex.length;++K)if(me=M.FileIndex[K],me.size>0&&me.size<4096)if(vt&&Buffer.isBuffer(me.content))me.content.copy(W,W.l,0,me.size),W.l+=me.size+63&-64;else{for(ce=0;ce<me.size;++ce)W.write_shift(1,me.content[ce]);for(;ce&63;++ce)W.write_shift(1,0)}if(vt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function z(M,X){var G=M.FullPaths.map(function(ce){return ce.toUpperCase()}),q=G.map(function(ce){var he=ce.split("/");return he[he.length-(ce.slice(-1)=="/"?2:1)]}),W=!1;X.charCodeAt(0)===47?(W=!0,X=G[0].slice(0,-1)+X):W=X.indexOf("/")!==-1;var K=X.toUpperCase(),de=W===!0?G.indexOf(K):q.indexOf(K);if(de!==-1)return M.FileIndex[de];var Se=!K.match(E0);for(K=K.replace(Aa,""),Se&&(K=K.replace(E0,"!")),de=0;de<G.length;++de)if((Se?G[de].replace(E0,"!"):G[de]).replace(Aa,"")==K||(Se?q[de].replace(E0,"!"):q[de]).replace(Aa,"")==K)return M.FileIndex[de];return null}var H=64,ie=-2,we="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:we,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(M,X,G){x();var q=V(M,G);d.writeFileSync(X,q)}function te(M){for(var X=new Array(M.length),G=0;G<M.length;++G)X[G]=String.fromCharCode(M[G]);return X.join("")}function I(M,X){var G=V(M,X);switch(X&&X.type||"buffer"){case"file":return x(),d.writeFileSync(X.filename,G),G;case"binary":return typeof G=="string"?G:te(G);case"base64":return z0(typeof G=="string"?G:te(G));case"buffer":if(vt)return Buffer.isBuffer(G)?G:Xs(G);case"array":return typeof G=="string"?Ja(G):G}return G}var Z;function L(M){try{var X=M.InflateRaw,G=new X;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)Z=M;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function P(M,X){if(!Z)return Ye(M,X);var G=Z.InflateRaw,q=new G,W=q._processChunk(M.slice(M.l),q._finishFlushFlag);return M.l+=q.bytesRead,W}function U(M){return Z?Z.deflateRawSync(M):lt(M)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(M){var X=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(X>>16|X>>8|X)&255}for(var Te=typeof Uint8Array<"u",Ae=Te?new Uint8Array(256):[],Ve=0;Ve<256;++Ve)Ae[Ve]=be(Ve);function Q(M,X){var G=Ae[M&255];return X<=8?G>>>8-X:(G=G<<8|Ae[M>>8&255],X<=16?G>>>16-X:(G=G<<8|Ae[M>>16&255],G>>>24-X))}function st(M,X){var G=X&7,q=X>>>3;return(M[q]|(G<=6?0:M[q+1]<<8))>>>G&3}function it(M,X){var G=X&7,q=X>>>3;return(M[q]|(G<=5?0:M[q+1]<<8))>>>G&7}function Qe(M,X){var G=X&7,q=X>>>3;return(M[q]|(G<=4?0:M[q+1]<<8))>>>G&15}function tt(M,X){var G=X&7,q=X>>>3;return(M[q]|(G<=3?0:M[q+1]<<8))>>>G&31}function De(M,X){var G=X&7,q=X>>>3;return(M[q]|(G<=1?0:M[q+1]<<8))>>>G&127}function Ot(M,X,G){var q=X&7,W=X>>>3,K=(1<<G)-1,de=M[W]>>>q;return G<8-q||(de|=M[W+1]<<8-q,G<16-q)||(de|=M[W+2]<<16-q,G<24-q)||(de|=M[W+3]<<24-q),de&K}function dr(M,X,G){var q=X&7,W=X>>>3;return q<=5?M[W]|=(G&7)<<q:(M[W]|=G<<q&255,M[W+1]=(G&7)>>8-q),X+3}function Zr(M,X,G){var q=X&7,W=X>>>3;return G=(G&1)<<q,M[W]|=G,X+1}function hr(M,X,G){var q=X&7,W=X>>>3;return G<<=q,M[W]|=G&255,G>>>=8,M[W+1]=G,X+8}function An(M,X,G){var q=X&7,W=X>>>3;return G<<=q,M[W]|=G&255,G>>>=8,M[W+1]=G&255,M[W+2]=G>>>8,X+16}function ya(M,X){var G=M.length,q=2*G>X?2*G:X+5,W=0;if(G>=X)return M;if(vt){var K=Gb(q);if(M.copy)M.copy(K);else for(;W<M.length;++W)K[W]=M[W];return K}else if(Te){var de=new Uint8Array(q);if(de.set)de.set(M);else for(;W<G;++W)de[W]=M[W];return de}return M.length=q,M}function xr(M){for(var X=new Array(M),G=0;G<M;++G)X[G]=0;return X}function Yt(M,X,G){var q=1,W=0,K=0,de=0,Se=0,ce=M.length,he=Te?new Uint16Array(32):xr(32);for(K=0;K<32;++K)he[K]=0;for(K=ce;K<G;++K)M[K]=0;ce=M.length;var me=Te?new Uint16Array(ce):xr(ce);for(K=0;K<ce;++K)he[W=M[K]]++,q<W&&(q=W),me[K]=0;for(he[0]=0,K=1;K<=q;++K)he[K+16]=Se=Se+he[K-1]<<1;for(K=0;K<ce;++K)Se=M[K],Se!=0&&(me[K]=he[Se+16]++);var Re=0;for(K=0;K<ce;++K)if(Re=M[K],Re!=0)for(Se=Q(me[K],q)>>q-Re,de=(1<<q+4-Re)-1;de>=0;--de)X[Se|de<<Re]=Re&15|K<<4;return q}var Cr=Te?new Uint16Array(512):xr(512),or=Te?new Uint16Array(32):xr(32);if(!Te){for(var Nt=0;Nt<512;++Nt)Cr[Nt]=0;for(Nt=0;Nt<32;++Nt)or[Nt]=0}(function(){for(var M=[],X=0;X<32;X++)M.push(5);Yt(M,or,32);var G=[];for(X=0;X<=143;X++)G.push(8);for(;X<=255;X++)G.push(9);for(;X<=279;X++)G.push(7);for(;X<=287;X++)G.push(8);Yt(G,Cr,288)})();var Mt=function(){for(var X=Te?new Uint8Array(32768):[],G=0,q=0;G<ve.length-1;++G)for(;q<ve[G+1];++q)X[q]=G;for(;q<32768;++q)X[q]=29;var W=Te?new Uint8Array(259):[];for(G=0,q=0;G<re.length-1;++G)for(;q<re[G+1];++q)W[q]=G;function K(Se,ce){for(var he=0;he<Se.length;){var me=Math.min(65535,Se.length-he),Re=he+me==Se.length;for(ce.write_shift(1,+Re),ce.write_shift(2,me),ce.write_shift(2,~me&65535);me-- >0;)ce[ce.l++]=Se[he++]}return ce.l}function de(Se,ce){for(var he=0,me=0,Re=Te?new Uint16Array(32768):[];me<Se.length;){var Le=Math.min(65535,Se.length-me);if(Le<10){for(he=dr(ce,he,+(me+Le==Se.length)),he&7&&(he+=8-(he&7)),ce.l=he/8|0,ce.write_shift(2,Le),ce.write_shift(2,~Le&65535);Le-- >0;)ce[ce.l++]=Se[me++];he=ce.l*8;continue}he=dr(ce,he,+(me+Le==Se.length)+2);for(var ze=0;Le-- >0;){var Fe=Se[me];ze=(ze<<5^Fe)&32767;var Ie=-1,ct=0;if((Ie=Re[ze])&&(Ie|=me&-32768,Ie>me&&(Ie-=32768),Ie<me))for(;Se[Ie+ct]==Se[me+ct]&&ct<250;)++ct;if(ct>2){Fe=W[ct],Fe<=22?he=hr(ce,he,Ae[Fe+1]>>1)-1:(hr(ce,he,3),he+=5,hr(ce,he,Ae[Fe-23]>>5),he+=3);var Ht=Fe<8?0:Fe-4>>2;Ht>0&&(An(ce,he,ct-re[Fe]),he+=Ht),Fe=X[me-Ie],he=hr(ce,he,Ae[Fe]>>3),he-=3;var Gt=Fe<4?0:Fe-2>>1;Gt>0&&(An(ce,he,me-Ie-ve[Fe]),he+=Gt);for(var Jt=0;Jt<ct;++Jt)Re[ze]=me&32767,ze=(ze<<5^Se[me])&32767,++me;Le-=ct-1}else Fe<=143?Fe=Fe+48:he=Zr(ce,he,1),he=hr(ce,he,Ae[Fe]),Re[ze]=me&32767,++me}he=hr(ce,he,0)-1}return ce.l=(he+7)/8|0,ce.l}return function(ce,he){return ce.length<8?K(ce,he):de(ce,he)}}();function lt(M){var X=Ee(50+Math.floor(M.length*1.1)),G=Mt(M,X);return X.slice(0,G)}var Ce=Te?new Uint16Array(32768):xr(32768),ut=Te?new Uint16Array(32768):xr(32768),St=Te?new Uint16Array(128):xr(128),Mr=1,Ra=1;function Oe(M,X){var G=tt(M,X)+257;X+=5;var q=tt(M,X)+1;X+=5;var W=Qe(M,X)+4;X+=4;for(var K=0,de=Te?new Uint8Array(19):xr(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,he=Te?new Uint8Array(8):xr(8),me=Te?new Uint8Array(8):xr(8),Re=de.length,Le=0;Le<W;++Le)de[Y[Le]]=K=it(M,X),ce<K&&(ce=K),he[K]++,X+=3;var ze=0;for(he[0]=0,Le=1;Le<=ce;++Le)me[Le]=ze=ze+he[Le-1]<<1;for(Le=0;Le<Re;++Le)(ze=de[Le])!=0&&(Se[Le]=me[ze]++);var Fe=0;for(Le=0;Le<Re;++Le)if(Fe=de[Le],Fe!=0){ze=Ae[Se[Le]]>>8-Fe;for(var Ie=(1<<7-Fe)-1;Ie>=0;--Ie)St[ze|Ie<<Fe]=Fe&7|Le<<3}var ct=[];for(ce=1;ct.length<G+q;)switch(ze=St[De(M,X)],X+=ze&7,ze>>>=3){case 16:for(K=3+st(M,X),X+=2,ze=ct[ct.length-1];K-- >0;)ct.push(ze);break;case 17:for(K=3+it(M,X),X+=3;K-- >0;)ct.push(0);break;case 18:for(K=11+De(M,X),X+=7;K-- >0;)ct.push(0);break;default:ct.push(ze),ce<ze&&(ce=ze);break}var Ht=ct.slice(0,G),Gt=ct.slice(G);for(Le=G;Le<286;++Le)Ht[Le]=0;for(Le=q;Le<30;++Le)Gt[Le]=0;return Mr=Yt(Ht,Ce,286),Ra=Yt(Gt,ut,30),X}function Ue(M,X){if(M[0]==3&&!(M[1]&3))return[Ii(X),2];for(var G=0,q=0,W=Gb(X||1<<18),K=0,de=W.length>>>0,Se=0,ce=0;(q&1)==0;){if(q=it(M,G),G+=3,q>>>1)q>>1==1?(Se=9,ce=5):(G=Oe(M,G),Se=Mr,ce=Ra);else{G&7&&(G+=8-(G&7));var he=M[G>>>3]|M[(G>>>3)+1]<<8;if(G+=32,he>0)for(!X&&de<K+he&&(W=ya(W,K+he),de=W.length);he-- >0;)W[K++]=M[G>>>3],G+=8;continue}for(;;){!X&&de<K+32767&&(W=ya(W,K+32767),de=W.length);var me=Ot(M,G,Se),Re=q>>>1==1?Cr[me]:Ce[me];if(G+=Re&15,Re>>>=4,(Re>>>8&255)===0)W[K++]=Re;else{if(Re==256)break;Re-=257;var Le=Re<8?0:Re-4>>2;Le>5&&(Le=0);var ze=K+re[Re];Le>0&&(ze+=Ot(M,G,Le),G+=Le),me=Ot(M,G,ce),Re=q>>>1==1?or[me]:ut[me],G+=Re&15,Re>>>=4;var Fe=Re<4?0:Re-2>>1,Ie=ve[Re];for(Fe>0&&(Ie+=Ot(M,G,Fe),G+=Fe),!X&&de<ze&&(W=ya(W,ze+100),de=W.length);K<ze;)W[K]=W[K-Ie],++K}}}return X?[W,G+7>>>3]:[W.slice(0,K),G+7>>>3]}function Ye(M,X){var G=M.slice(M.l||0),q=Ue(G,X);return M.l+=q[1],q[0]}function qe(M,X){if(M)typeof console<"u"&&console.error(X);else throw new Error(X)}function ot(M,X){var G=M;sa(G,0);var q=[],W=[],K={FileIndex:q,FullPaths:W};T(K,{root:X.root});for(var de=G.length-4;(G[de]!=80||G[de+1]!=75||G[de+2]!=5||G[de+3]!=6)&&de>=0;)--de;G.l=de+4,G.l+=4;var Se=G.read_shift(2);G.l+=6;var ce=G.read_shift(4);for(G.l=ce,de=0;de<Se;++de){G.l+=20;var he=G.read_shift(4),me=G.read_shift(4),Re=G.read_shift(2),Le=G.read_shift(2),ze=G.read_shift(2);G.l+=8;var Fe=G.read_shift(4),Ie=f(G.slice(G.l+Re,G.l+Re+Le));G.l+=Re+Le+ze;var ct=G.l;G.l=Fe+4,Jr(G,he,me,K,Ie),G.l=ct}return K}function Jr(M,X,G,q,W){M.l+=2;var K=M.read_shift(2),de=M.read_shift(2),Se=o(M);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var ce=M.read_shift(4),he=M.read_shift(4),me=M.read_shift(4),Re=M.read_shift(2),Le=M.read_shift(2),ze="",Fe=0;Fe<Re;++Fe)ze+=String.fromCharCode(M[M.l++]);if(Le){var Ie=f(M.slice(M.l,M.l+Le));(Ie[21589]||{}).mt&&(Se=Ie[21589].mt),((W||{})[21589]||{}).mt&&(Se=W[21589].mt)}M.l+=Le;var ct=M.slice(M.l,M.l+he);switch(de){case 8:ct=P(M,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Ht=!1;K&8&&(ce=M.read_shift(4),ce==134695760&&(ce=M.read_shift(4),Ht=!0),he=M.read_shift(4),me=M.read_shift(4)),he!=X&&qe(Ht,"Bad compressed size: "+X+" != "+he),me!=G&&qe(Ht,"Bad uncompressed size: "+G+" != "+me),Vr(q,ze,ct,{unsafe:!0,mt:Se})}function ea(M,X){var G=X||{},q=[],W=[],K=Ee(1),de=G.compression?8:0,Se=0,ce=0,he=0,me=0,Re=0,Le=M.FullPaths[0],ze=Le,Fe=M.FileIndex[0],Ie=[],ct=0;for(ce=1;ce<M.FullPaths.length;++ce)if(ze=M.FullPaths[ce].slice(Le.length),Fe=M.FileIndex[ce],!(!Fe.size||!Fe.content||ze=="Sh33tJ5")){var Ht=me,Gt=Ee(ze.length);for(he=0;he<ze.length;++he)Gt.write_shift(1,ze.charCodeAt(he)&127);Gt=Gt.slice(0,Gt.l),Ie[Re]=vj.buf(Fe.content,0);var Jt=Fe.content;de==8&&(Jt=U(Jt)),K=Ee(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,Se),K.write_shift(2,de),Fe.mt?l(K,Fe.mt):K.write_shift(4,0),K.write_shift(-4,Ie[Re]),K.write_shift(4,Jt.length),K.write_shift(4,Fe.content.length),K.write_shift(2,Gt.length),K.write_shift(2,0),me+=K.length,q.push(K),me+=Gt.length,q.push(Gt),me+=Jt.length,q.push(Jt),K=Ee(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,Se),K.write_shift(2,de),K.write_shift(4,0),K.write_shift(-4,Ie[Re]),K.write_shift(4,Jt.length),K.write_shift(4,Fe.content.length),K.write_shift(2,Gt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Ht),ct+=K.l,W.push(K),ct+=Gt.length,W.push(Gt),++Re}return K=Ee(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Re),K.write_shift(2,Re),K.write_shift(4,ct),K.write_shift(4,me),K.write_shift(2,0),Yr([Yr(q),Yr(W),K])}var nn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Yn(M,X){if(M.ctype)return M.ctype;var G=M.name||"",q=G.match(/\.([^\.]+)$/);return q&&nn[q[1]]||X&&(q=(G=X).match(/[\.\\]([^\.\\])+$/),q&&nn[q[1]])?nn[q[1]]:"application/octet-stream"}function Kn(M){for(var X=z0(M),G=[],q=0;q<X.length;q+=76)G.push(X.slice(q,q+76));return G.join(`\r
`)+`\r
`}function Qn(M){var X=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var me=he.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],q=X.split(`\r
`),W=0;W<q.length;++W){var K=q[W];if(K.length==0){G.push("");continue}for(var de=0;de<K.length;){var Se=76,ce=K.slice(de,de+Se);ce.charAt(Se-1)=="="?Se--:ce.charAt(Se-2)=="="?Se-=2:ce.charAt(Se-3)=="="&&(Se-=3),ce=K.slice(de,de+Se),de+=Se,de<K.length&&(ce+="="),G.push(ce)}}return G.join(`\r
`)}function vc(M){for(var X=[],G=0;G<M.length;++G){for(var q=M[G];G<=M.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+M[++G];X.push(q)}for(var W=0;W<X.length;++W)X[W]=X[W].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Ja(X.join(`\r
`))}function ku(M,X,G){for(var q="",W="",K="",de,Se=0;Se<10;++Se){var ce=X[Se];if(!ce||ce.match(/^\s*$/))break;var he=ce.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":q=he[2].trim();break;case"content-type":K=he[2].trim();break;case"content-transfer-encoding":W=he[2].trim();break}}switch(++Se,W.toLowerCase()){case"base64":de=Ja(rn(X.slice(Se).join("")));break;case"quoted-printable":de=vc(X.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var me=Vr(M,q.slice(G.length),de,{unsafe:!0});K&&(me.ctype=K)}function oh(M,X){if(te(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=X&&X.root||"",q=(vt&&Buffer.isBuffer(M)?M.toString("binary"):te(M)).split(`\r
`),W=0,K="";for(W=0;W<q.length;++W)if(K=q[W],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),G||(G=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),K.slice(0,G.length)!=G););var de=(q[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Se="--"+(de[1]||""),ce=[],he=[],me={FileIndex:ce,FullPaths:he};T(me);var Re,Le=0;for(W=0;W<q.length;++W){var ze=q[W];ze!==Se&&ze!==Se+"--"||(Le++&&ku(me,q.slice(Re,W),G),Re=W)}return me}function Zn(M,X){var G=X||{},q=G.boundary||"SheetJS";q="------="+q;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],K=M.FullPaths[0],de=K,Se=M.FileIndex[0],ce=1;ce<M.FullPaths.length;++ce)if(de=M.FullPaths[ce].slice(K.length),Se=M.FileIndex[ce],!(!Se.size||!Se.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var he=Se.content,me=vt&&Buffer.isBuffer(he)?he.toString("binary"):te(he),Re=0,Le=Math.min(1024,me.length),ze=0,Fe=0;Fe<=Le;++Fe)(ze=me.charCodeAt(Fe))>=32&&ze<128&&++Re;var Ie=Re>=Le*4/5;W.push(q),W.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+de),W.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),W.push("Content-Type: "+Yn(Se,de)),W.push(""),W.push(Ie?Qn(me):Kn(me))}return W.push(q+`--\r
`),W.join(`\r
`)}function Gr(M){var X={};return T(X,M),X}function Vr(M,X,G,q){var W=q&&q.unsafe;W||T(M);var K=!W&&$e.find(M,X);if(!K){var de=M.FullPaths[0];X.slice(0,de.length)==de?de=X:(de.slice(-1)!="/"&&(de+="/"),de=(de+X).replace("//","/")),K={name:n(X),type:2},M.FileIndex.push(K),M.FullPaths.push(de),W||$e.utils.cfb_gc(M)}return K.content=G,K.size=G?G.length:0,q&&(q.CLSID&&(K.clsid=q.CLSID),q.mt&&(K.mt=q.mt),q.ct&&(K.ct=q.ct)),K}function Ks(M,X){T(M);var G=$e.find(M,X);if(G){for(var q=0;q<M.FileIndex.length;++q)if(M.FileIndex[q]==G)return M.FileIndex.splice(q,1),M.FullPaths.splice(q,1),!0}return!1}function yc(M,X,G){T(M);var q=$e.find(M,X);if(q){for(var W=0;W<M.FileIndex.length;++W)if(M.FileIndex[W]==q)return M.FileIndex[W].name=n(G),M.FullPaths[W]=G,!0}return!1}function ch(M){O(M,!0)}return t.find=z,t.read=R,t.parse=m,t.write=I,t.writeFile=ne,t.utils={cfb_new:Gr,cfb_add:Vr,cfb_del:Ks,cfb_mov:yc,cfb_gc:ch,ReadShift:k0,CheckField:SE,prep_blob:sa,bconcat:Yr,use_zlib:L,_deflateRaw:lt,_inflateRaw:Ye,consts:le},t}();function yj(e){return typeof e=="string"?$d(e):Array.isArray(e)?q6(e):e}function xu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=$d(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?hs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([yj(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=Vi(t)),f.write(t),f.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function bj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function br(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Qb(e,t){for(var r=[],a=br(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Kd(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Qd(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function wj(e){for(var t=[],r=br(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var kd=new Date(1899,11,30,0,0,0);function zr(e,t){var r=e.getTime(),a=kd.getTime()+(e.getTimezoneOffset()-kd.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var tE=new Date,Sj=kd.getTime()+(tE.getTimezoneOffset()-kd.getTimezoneOffset())*6e4,Zb=tE.getTimezoneOffset();function Zd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Sj),t.getTimezoneOffset()!==Zb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Zb)*6e4),t}function Ej(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=n.length;++l)if(n[l]){switch(r=1,l>3&&(a=!0),n[l].slice(n[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[l].slice(n[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[l],10)}return t}var Jb=new Date("2017-02-19T19:06:09.000Z"),rE=isNaN(Jb.getFullYear())?new Date("2/19/17"):Jb,_j=rE.getFullYear()==2017;function nr(e,t){var r=new Date(e);if(_j)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(rE.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Ll(e,t){if(vt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return hs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return hs(G4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return hs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return hs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sr(e[r]));return t}function vr(e,t){for(var r="";r.length<t;)r+=e;return r}function Hn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var kj=["january","february","march","april","may","june","july","august","september","october","november","december"];function ac(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&kj.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Tj=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),o=[l[0]],f=1;f<l.length;++f)o.push(n),o.push(l[f]);return o}}();function aE(e){return e?e.content&&e.type?Ll(e.content,!0):e.data?S0(e.data):e.asNodeBuffer&&vt?S0(e.asNodeBuffer().toString("binary")):e.asBinary?S0(e.asBinary()):e._data&&e._data.getContent?S0(Ll(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function nE(e){if(!e)return null;if(e.data)return zb(e.data);if(e.asNodeBuffer&&vt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?zb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Nj(e){return e&&e.name.slice(-4)===".bin"?nE(e):aE(e)}function bn(e,t){for(var r=e.FullPaths||br(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function bg(e,t){var r=bn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Fr(e,t,r){if(!r)return Nj(bg(e,t));if(!t)return null;try{return Fr(e,t)}catch{return null}}function en(e,t,r){if(!r)return aE(bg(e,t));if(!t)return null;try{return en(e,t)}catch{return null}}function Cj(e,t,r){return nE(bg(e,t))}function ew(e){for(var t=e.FullPaths||br(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return vt?a=Xs(r):a=W6(r),$e.utils.cfb_add(e,t,a)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function wg(){return $e.utils.cfb_new()}function sE(e,t){switch(t.type){case"base64":return $e.read(e,{type:"base64"});case"binary":return $e.read(e,{type:"binary"});case"buffer":case"array":return $e.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function _0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Nr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Aj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,jj=/<[^>]*>/g,va=Nr.match(tw)?tw:jj,Rj=/<\w*:/,Dj=/<(\/?)\w+:/;function nt(e,t,r){for(var a={},n=0,l=0;n!==e.length&&!((l=e.charCodeAt(n))===32||l===10||l===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(Aj),f=0,d="",x=0,m="",p="",v=1;if(o)for(x=0;x!=o.length;++x){for(p=o[x],l=0;l!=p.length&&p.charCodeAt(l)!==61;++l);for(m=p.slice(0,l).trim();p.charCodeAt(l+1)==32;)++l;for(v=(n=p.charCodeAt(l+1))==34||n==39?1:0,d=p.slice(l+1+v,p.length-v),f=0;f!=m.length&&m.charCodeAt(f)!==58;++f);if(f===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=d,a[m.toLowerCase()]=d;else{var y=(f===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(f+1);if(a[y]&&m.slice(f-3,f)=="ext")continue;a[y]=d,a[y.toLowerCase()]=d}}return a}function ms(e){return e.replace(Dj,"<$1")}var iE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sg=Kd(iE),At=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",l=n.indexOf("<![CDATA[");if(l==-1)return n.replace(e,function(f,d){return iE[f]||String.fromCharCode(parseInt(d,f.indexOf("x")>-1?16:10))||f}).replace(t,function(f,d){return String.fromCharCode(parseInt(d,16))});var o=n.indexOf("]]>");return r(n.slice(0,l))+n.slice(l+9,o)+r(n.slice(o+3))}}(),Eg=/[&<>'"]/g,Fj=/[\u0000-\u0008\u000b-\u001f]/g;function zt(e){var t=e+"";return t.replace(Eg,function(r){return Sg[r]}).replace(Fj,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function rw(e){return zt(e).replace(/ /g,"_x0020_")}var lE=/[\u0000-\u001f]/g;function _g(e){var t=e+"";return t.replace(Eg,function(r){return Sg[r]}).replace(/\n/g,"<br/>").replace(lE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Oj(e){var t=e+"";return t.replace(Eg,function(r){return Sg[r]}).replace(lE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var aw=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Mj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ar(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Im(e){for(var t="",r=0,a=0,n=0,l=0,o=0,f=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|l&63);continue}o=e.charCodeAt(r++),f=((a&7)<<18|(n&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(f>>>10&1023)),t+=String.fromCharCode(56320+(f&1023))}return t}function nw(e){var t=Ii(2*e.length),r,a,n=1,l=0,o=0,f;for(a=0;a<e.length;a+=n)n=1,(f=e.charCodeAt(a))<128?r=f:f<224?(r=(f&31)*64+(e.charCodeAt(a+1)&63),n=2):f<240?(r=(f&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(f&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function sw(e){return Xs(e,"binary").toString("utf8")}var Uf="foo bar baz",$t=vt&&(sw(Uf)==Im(Uf)&&sw||nw(Uf)==Im(Uf)&&nw)||Im,hs=vt?function(e){return Xs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},G0=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),oE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),Lj=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Bj=/<\/?(?:vt:)?variant>/g,Pj=/<(?:vt:)([^>]*)>([\s\S]*)</;function iw(e,t){var r=nt(e),a=e.match(Lj(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(l){var o=l.replace(Bj,"").match(Pj);o&&n.push({v:$t(o[2]),t:o[1]})}),n}var cE=/(^\s|\s$|\n)/;function ia(e,t){return"<"+e+(t.match(cE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function V0(e){return br(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?V0(r):"")+(t!=null?(t.match(cE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Rp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Ij(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",zt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",zt(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",Rp(e));throw new Error("Unable to serialize "+e)}function kg(e){if(vt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return $t(Vi(gg(e)));throw new Error("Bad input format: expected Buffer or string")}var q0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Hl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Uj(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,l=5;l>=0;--l)n=n*256+e[t+l];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function zj(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,l=0,o=a?-t:t;isFinite(o)?o==0?n=l=0:(n=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?n=-1022:(l-=Math.pow(2,52),n+=1023)):(n=2047,l=isNaN(t)?26985:0);for(var f=0;f<=5;++f,l/=256)e[r+f]=l&255;e[r+6]=(n&15)<<4|l&15,e[r+7]=n>>4|a}var lw=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,l=e[0][a].length;n<l;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},ow=vt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Xs(t)})):lw(e)}:lw,cw=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Ps(e,n)));return a.join("").replace(Aa,"")},Tg=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Aa,""):cw(e,t,r)}:cw,uw=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},uE=vt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):uw(e,t,r)}:uw,fw=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Bo(e,n)));return a.join("")},mu=vt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):fw(t,r,a)}:fw,fE=function(e,t){var r=Za(e,t);return r>0?mu(e,t+4,t+4+r-1):""},dE=fE,hE=function(e,t){var r=Za(e,t);return r>0?mu(e,t+4,t+4+r-1):""},xE=hE,mE=function(e,t){var r=2*Za(e,t);return r>0?mu(e,t+4,t+4+r-1):""},pE=mE,gE=function(t,r){var a=Za(t,r);return a>0?Tg(t,r+4,r+4+a):""},vE=gE,yE=function(e,t){var r=Za(e,t);return r>0?mu(e,t+4,t+4+r):""},bE=yE,wE=function(e,t){return Uj(e,t)},Td=wE,Ng=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};vt&&(dE=function(t,r){if(!Buffer.isBuffer(t))return fE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},xE=function(t,r){if(!Buffer.isBuffer(t))return hE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},pE=function(t,r){if(!Buffer.isBuffer(t))return mE(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},vE=function(t,r){if(!Buffer.isBuffer(t))return gE(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},bE=function(t,r){if(!Buffer.isBuffer(t))return yE(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Td=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):wE(t,r)},Ng=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bo=function(e,t){return e[t]},Ps=function(e,t){return e[t+1]*256+e[t]},Hj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Za=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},dl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Gj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function k0(e,t){var r="",a,n,l=[],o,f,d,x;switch(t){case"dbcs":if(x=this.l,vt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(Ps(this,x)),x+=2;e*=2;break;case"utf8":r=mu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tg(this,this.l,this.l+e);break;case"wstr":return k0.call(this,e,"dbcs");case"lpstr-ansi":r=dE(this,this.l),e=4+Za(this,this.l);break;case"lpstr-cp":r=xE(this,this.l),e=4+Za(this,this.l);break;case"lpwstr":r=pE(this,this.l),e=4+2*Za(this,this.l);break;case"lpp4":e=4+Za(this,this.l),r=vE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Za(this,this.l),r=bE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Bo(this,this.l+e++))!==0;)l.push(If(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=Ps(this,this.l+e))!==0;)l.push(If(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",x=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Bo(this,x),this.l=x+1,f=k0.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(If(Ps(this,x))),x+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",x=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Bo(this,x),this.l=x+1,f=k0.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(If(Bo(this,x))),x+=1}r=l.join("");break;default:switch(e){case 1:return a=Bo(this,this.l),this.l++,a;case 2:return a=(t==="i"?Hj:Ps)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?dl:Gj)(this,this.l),this.l+=4,a):(n=Za(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Td(this,this.l):n=Td([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=uE(this,this.l,e);break}}return this.l+=e,r}var Vj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},qj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Wj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Xj(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Wj(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Vj(this,t,this.l);break;case 8:if(a=8,r==="f"){zj(this,t,this.l);break}case 16:break;case-4:a=4,qj(this,t,this.l);break}return this.l+=a,this}function SE(e,t){var r=uE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function sa(e,t){e.l=t,e.read_shift=k0,e.chk=SE,e.write_shift=Xj}function ga(e,t){e.l+=t}function Ee(e){var t=Ii(e);return sa(t,0),t}function $s(e,t,r){if(e){var a,n,l;sa(e,e.l||0);for(var o=e.length,f=0,d=0;e.l<o;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var x=Q0[f]||Q0[65535];for(a=e.read_shift(1),l=a&127,n=1;n<4&&a&128;++n)l+=((a=e.read_shift(1))&127)<<7*n;d=e.l+l;var m=x.f&&x.f(e,l,r);if(e.l=d,t(m,x,f))return}}}function za(){var e=[],t=vt?256:2048,r=function(x){var m=Ee(x);return sa(m,0),m},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(x){return a&&x<a.length-a.l?a:(n(),a=r(Math.max(x+1,t)))},o=function(){return n(),Yr(e)},f=function(x){n(),a=x,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:f,end:o,_bufs:e}}function je(e,t,r,a){var n=+t,l;if(!isNaN(n)){a||(a=Q0[n].p||(r||[]).length||0),l=1+(n>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var f=0;f!=4;++f)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Ng(r)&&e.push(r)}}function T0(e,t,r){var a=sr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function dw(e,t,r){var a=sr(e);return a.s=T0(a.s,t.s,r),a.e=T0(a.e,t.s,r),a}function N0(e,t){if(e.cRel&&e.c<0)for(e=sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=rt(e);return!e.cRel&&e.cRel!=null&&(r=Kj(r)),!e.rRel&&e.rRel!=null&&(r=$j(r)),r}function Um(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ur(e.s.c)+":"+(e.e.cRel?"":"$")+ur(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kr(e.s.r)+":"+(e.e.rRel?"":"$")+kr(e.e.r):N0(e.s,t.biff)+":"+N0(e.e,t.biff)}function Cg(e){return parseInt(Yj(e),10)-1}function kr(e){return""+(e+1)}function $j(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Yj(e){return e.replace(/\$(\d+)$/,"$1")}function Ag(e){for(var t=Qj(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function ur(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Kj(e){return e.replace(/^([A-Z])/,"$$$1")}function Qj(e){return e.replace(/^\$([A-Z])/,"$1")}function Zj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ha(e){var t=e.indexOf(":");return t==-1?{s:fr(e),e:fr(e)}:{s:fr(e.slice(0,t)),e:fr(e.slice(t+1))}}function ht(e,t){return typeof t>"u"||typeof t=="number"?ht(e.s,e.e):(typeof e!="string"&&(e=rt(e)),typeof t!="string"&&(t=rt(t)),e==t?e:e+":"+t)}function jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,l=e.length;for(r=0;a<l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===l||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function hw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=kn(e.z,r?zr(t):t)}catch{}try{return e.w=kn((e.XF||{}).numFmtId||(r?14:0),r?zr(t):t)}catch{return""+t}}function qs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ys[e.v]||e.v:t==null?hw(e,e.v):hw(e,t))}function qi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function EE(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,l=e||(n?[]:{}),o=0,f=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?fr(a.origin):a.origin;o=d.r,f=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=jt(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[p].length;++v)if(!(typeof t[p][v]>"u")){var y={v:t[p][v]},b=o+p,w=f+v;if(x.s.r>b&&(x.s.r=b),x.s.c>w&&(x.s.c=w),x.e.r<b&&(x.e.r=b),x.e.c<w&&(x.e.c=w),t[p][v]&&typeof t[p][v]=="object"&&!Array.isArray(t[p][v])&&!(t[p][v]instanceof Date))y=t[p][v];else if(Array.isArray(y.v)&&(y.f=t[p][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(a.nullError)y.t="e",y.v=0;else if(a.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=a.dateNF||et[14],a.cellDates?(y.t="d",y.w=kn(y.z,zr(y.v))):(y.t="n",y.v=zr(y.v),y.w=kn(y.z,y.v))):y.t="s";if(n)l[b]||(l[b]=[]),l[b][w]&&l[b][w].z&&(y.z=l[b][w].z),l[b][w]=y;else{var E=rt({c:w,r:b});l[E]&&l[E].z&&(y.z=l[E].z),l[E]=y}}}return x.s.c<1e7&&(l["!ref"]=ht(x)),l}function pc(e,t){return EE(null,e,t)}function Jj(e){return e.read_shift(4,"i")}function Gn(e,t){return t||(t=Ee(4)),t.write_shift(4,e),t}function pa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Kr(e,t){var r=!1;return t==null&&(r=!0,t=Ee(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function e8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function t8(e,t){return t||(t=Ee(4)),t.write_shift(2,0),t.write_shift(2,0),t}function jg(e,t){var r=e.l,a=e.read_shift(1),n=pa(e),l=[],o={t:n,h:n};if((a&1)!==0){for(var f=e.read_shift(4),d=0;d!=f;++d)l.push(e8(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function r8(e,t){var r=!1;return t==null&&(r=!0,t=Ee(15+4*e.t.length)),t.write_shift(1,0),Kr(e.t,t),r?t.slice(0,t.l):t}var a8=jg;function n8(e,t){var r=!1;return t==null&&(r=!0,t=Ee(23+4*e.t.length)),t.write_shift(1,1),Kr(e.t,t),t.write_shift(4,1),t8({},t),r?t.slice(0,t.l):t}function Cn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Gl(e,t){return t==null&&(t=Ee(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Vl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ql(e,t){return t==null&&(t=Ee(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var s8=pa,_E=Kr;function Rg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Nd(e,t){var r=!1;return t==null&&(r=!0,t=Ee(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var i8=pa,Dp=Rg,Dg=Nd;function Fg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Td([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):dl(t,0)>>2;return r?n/100:n}function kE(e,t){t==null&&(t=Ee(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function TE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function l8(e,t){return t||(t=Ee(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wl=TE,gc=l8;function ma(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Bl(e,t){return(t||Ee(8)).write_shift(8,e,"f")}function o8(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var x=Cl[n];x&&(t.rgb=X0(x));break;case 2:t.rgb=X0([o,f,d]);break;case 3:t.theme=n;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Cd(e,t){if(t||(t=Ee(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function c8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function u8(e,t){t||(t=Ee(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function NE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function f8(e){return NE(e,1)}function d8(e){return NE(e,2)}var Og=2,Pa=3,zf=11,xw=12,Ad=19,Hf=64,h8=65,x8=71,m8=4108,p8=4126,$r=80,CE=81,g8=[$r,CE],Fp={1:{n:"CodePage",t:Og},2:{n:"Category",t:$r},3:{n:"PresentationFormat",t:$r},4:{n:"ByteCount",t:Pa},5:{n:"LineCount",t:Pa},6:{n:"ParagraphCount",t:Pa},7:{n:"SlideCount",t:Pa},8:{n:"NoteCount",t:Pa},9:{n:"HiddenCount",t:Pa},10:{n:"MultimediaClipCount",t:Pa},11:{n:"ScaleCrop",t:zf},12:{n:"HeadingPairs",t:m8},13:{n:"TitlesOfParts",t:p8},14:{n:"Manager",t:$r},15:{n:"Company",t:$r},16:{n:"LinksUpToDate",t:zf},17:{n:"CharacterCount",t:Pa},19:{n:"SharedDoc",t:zf},22:{n:"HyperlinksChanged",t:zf},23:{n:"AppVersion",t:Pa,p:"version"},24:{n:"DigSig",t:h8},26:{n:"ContentType",t:$r},27:{n:"ContentStatus",t:$r},28:{n:"Language",t:$r},29:{n:"Version",t:$r},255:{},2147483648:{n:"Locale",t:Ad},2147483651:{n:"Behavior",t:Ad},1919054434:{}},Op={1:{n:"CodePage",t:Og},2:{n:"Title",t:$r},3:{n:"Subject",t:$r},4:{n:"Author",t:$r},5:{n:"Keywords",t:$r},6:{n:"Comments",t:$r},7:{n:"Template",t:$r},8:{n:"LastAuthor",t:$r},9:{n:"RevNumber",t:$r},10:{n:"EditTime",t:Hf},11:{n:"LastPrinted",t:Hf},12:{n:"CreatedDate",t:Hf},13:{n:"ModifiedDate",t:Hf},14:{n:"PageCount",t:Pa},15:{n:"WordCount",t:Pa},16:{n:"CharCount",t:Pa},17:{n:"Thumbnail",t:x8},18:{n:"Application",t:$r},19:{n:"DocSecurity",t:Pa},255:{},2147483648:{n:"Locale",t:Ad},2147483651:{n:"Behavior",t:Ad},1919054434:{}},mw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},v8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function y8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var b8=y8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cl=sr(b8),Ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},AE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Mg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function w8(e){var t=Mg();if(!e||!e.match)return t;var r={};if((e.match(va)||[]).forEach(function(a){var n=nt(a);switch(n[0].replace(Rj,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Mp[n.ContentType]]!==void 0&&t[Mp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Ur.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function jE(e,t){var r=wj(Mp),a=[],n;a[a.length]=Nr,a[a.length]=Be("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Be("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){e[d]&&e[d].length>0&&(n=e[d][0],a[a.length]=Be("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Gf[d][t.bookType]||Gf[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(x){a[a.length]=Be("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:Gf[d][t.bookType]||Gf[d].xlsx})})},f=function(d){(e[d]||[]).forEach(function(x){a[a.length]=Be("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:r[d][0]})})};return l("workbooks"),o("sheets"),o("charts"),f("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),o("metadata"),f("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function W0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function C0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(va)||[]).forEach(function(n){var l=nt(n);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:_0(l.Target,t);r[f]=o,a[l.Id]=o}}),r["!id"]=a,r}function zo(e){var t=[Nr,Be("Relationships",null,{xmlns:Ur.RELS})];return br(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ut(e,t,r,a,n,l){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var S8="application/vnd.oasis.opendocument.spreadsheet";function E8(e,t){for(var r=kg(e),a,n;a=q0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=nt(a[0],!1),n.path=="/"&&n.type!==S8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function _8(e){var t=[Nr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function pw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function k8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function T8(e){var t=[Nr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(pw(e[r][0],e[r][1])),t.push(k8("",e[r][0]));return t.push(pw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function RE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+wd.version+"</meta:generator></office:meta></office:document-meta>"}var En=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],N8=function(){for(var e=new Array(En.length),t=0;t<En.length;++t){var r=En[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function DE(e){var t={};e=$t(e);for(var r=0;r<En.length;++r){var a=En[r],n=e.match(N8[r]);n!=null&&n.length>0&&(t[a[1]]=At(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=nr(t[a[1]]))}return t}function zm(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=zt(t),a[a.length]=r?Be(e,t,r):ia(e,t))}function FE(e,t){var r=t||{},a=[Nr,Be("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&zm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&zm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var l=0;l!=En.length;++l){var o=En[l],f=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&zm(o[0],f,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Al=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],OE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ME(e,t,r,a){var n=[];if(typeof e=="string")n=iw(e,a);else for(var l=0;l<e.length;++l)n=n.concat(e[l].map(function(m){return{v:m}}));var o=typeof t=="string"?iw(t,a).map(function(m){return m.v}):t,f=0,d=0;if(o.length>0)for(var x=0;x!==n.length;x+=2){switch(d=+n[x+1].v,n[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=o.slice(f,f+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=o.slice(f,f+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=o.slice(f,f+d);break}f+=d}}function C8(e,t,r){var a={};return t||(t={}),e=$t(e),Al.forEach(function(n){var l=(e.match(G0(n[0]))||[])[1];switch(n[2]){case"string":l&&(t[n[1]]=At(l));break;case"bool":t[n[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&ME(a.HeadingPairs,a.TitlesOfParts,t,r),t}function LE(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=Nr,t[t.length]=Be("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),Al.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=zt(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+zt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var A8=/<[^>]+>[^<]*/g;function j8(e,t){var r={},a="",n=e.match(A8);if(n)for(var l=0;l!=n.length;++l){var o=n[l],f=nt(o);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":a=At(f.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var d=o.split(">"),x=d[0].slice(4),m=d[1];switch(x){case"lpstr":case"bstr":case"lpwstr":r[a]=At(m);break;case"bool":r[a]=ar(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=nr(m);break;case"cy":case"error":r[a]=At(m);break;default:if(x.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,d)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function BE(e){var t=[Nr,Be("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return t.join("");var r=1;return br(e).forEach(function(n){++r,t[t.length]=Be("property",Ij(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:zt(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Lp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hm;function R8(e,t,r){Hm||(Hm=Kd(Lp)),t=Hm[t]||t,e[t]=r}function D8(e,t){var r=[];return br(Lp).map(function(a){for(var n=0;n<En.length;++n)if(En[n][1]==a)return En[n];for(n=0;n<Al.length;++n)if(Al[n][1]==a)return Al[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ia(Lp[a[1]]||a[1],n))}}),Be("DocumentProperties",r.join(""),{xmlns:Qa.o})}function F8(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&br(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<En.length;++o)if(l==En[o][1])return;for(o=0;o<Al.length;++o)if(l==Al[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var f=e[l],d="string";typeof f=="number"?(d="float",f=String(f)):f===!0||f===!1?(d="boolean",f=f?"1":"0"):f=String(f),n.push(Be(rw(l),f,{"dt:dt":d}))}}),t&&br(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],f="string";typeof o=="number"?(f="float",o=String(o)):o===!0||o===!1?(f="boolean",o=o?"1":"0"):o instanceof Date?(f="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Be(rw(l),o,{"dt:dt":f}))}}),"<"+a+' xmlns="'+Qa.o+'">'+n.join("")+"</"+a+">"}function Lg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function O8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),n+=l);var o=Ee(8);return o.write_shift(4,a),o.write_shift(4,n),o}function PE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function IE(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function UE(e,t,r){return t===31?IE(e):PE(e,t,r)}function Bp(e,t,r){return UE(e,t,r===!1?0:4)}function M8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return UE(e,t,0)}function L8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Aa,""),e.l-n&2&&(e.l+=2)}return r}function B8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Aa,"");return r}function P8(e){var t=e.l,r=jd(e,CE);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=jd(e,Pa);return[r,a]}function I8(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(P8(e));return r}function gw(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var l=e.read_shift(4),o=e.read_shift(4);a[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Aa,"").replace(E0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function zE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function U8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function jd(e,t,r){var a=e.read_shift(2),n,l=r||{};if(e.l+=2,t!==xw&&a!==t&&g8.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===xw?a:t){case 2:return n=e.read_shift(2,"i"),l.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return PE(e,a,4).replace(Aa,"");case 31:return IE(e);case 64:return Lg(e);case 65:return zE(e);case 71:return U8(e);case 80:return Bp(e,a,!l.raw).replace(Aa,"");case 81:return M8(e,a).replace(Aa,"");case 4108:return I8(e);case 4126:case 4127:return a==4127?L8(e):B8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function vw(e,t){var r=Ee(4),a=Ee(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Ee(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=O8(t);break;case 31:case 80:for(a=Ee(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yr([r,a])}function yw(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0,f=0,d=-1,x={};for(o=0;o!=n;++o){var m=e.read_shift(4),p=e.read_shift(4);l[o]=[m,p+r]}l.sort(function(N,k){return N[1]-k[1]});var v={};for(o=0;o!=n;++o){if(e.l!==l[o][1]){var y=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(y=!1,e.l=l[o][1]),y)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var b=t[l[o][0]];if(v[b.n]=jd(e,b.t,{raw:!0}),b.p==="version"&&(v[b.n]=String(v[b.n]>>16)+"."+("0000"+String(v[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(v[b.n]){case 0:v[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Un(f=v[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[b.n])}}else if(l[o][0]===1){if(f=v.CodePage=jd(e,Og),Un(f),d!==-1){var w=e.l;e.l=l[d][1],x=gw(e,f),e.l=w}}else if(l[o][0]===0){if(f===0){d=o,e.l=l[o+1][1];continue}x=gw(e,f)}else{var E=x[l[o][0]],_;switch(e[e.l]){case 65:e.l+=4,_=zE(e);break;case 30:e.l+=4,_=Bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Bp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=_r(e,4);break;case 64:e.l+=4,_=nr(Lg(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[E]=_}}return e.l=r+a,v}var HE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function z8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function bw(e,t,r){var a=Ee(8),n=[],l=[],o=8,f=0,d=Ee(8),x=Ee(8);if(d.write_shift(4,2),d.write_shift(4,1200),x.write_shift(4,1),l.push(d),n.push(x),o+=8+d.length,!t){x=Ee(8),x.write_shift(4,0),n.unshift(x);var m=[Ee(4)];for(m[0].write_shift(4,e.length),f=0;f<e.length;++f){var p=e[f][0];for(d=Ee(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,f+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Yr(m),l.unshift(d),o+=8+d.length}for(f=0;f<e.length;++f)if(!(t&&!t[e[f][0]])&&!(HE.indexOf(e[f][0])>-1||OE.indexOf(e[f][0])>-1)&&e[f][1]!=null){var v=e[f][1],y=0;if(t){y=+t[e[f][0]];var b=r[y];if(b.p=="version"&&typeof v=="string"){var w=v.split(".");v=(+w[0]<<16)+(+w[1]||0)}d=vw(b.t,v)}else{var E=z8(v);E==-1&&(E=31,v=String(v)),d=vw(E,v)}l.push(d),x=Ee(8),x.write_shift(4,t?y:2+f),n.push(x),o+=8+d.length}var _=8*(l.length+1);for(f=0;f<l.length;++f)n[f].write_shift(4,_),_+=l[f].length;return a.write_shift(4,o),a.write_shift(4,l.length),Yr([a].concat(n).concat(l))}function ww(e,t,r){var a=e.content;if(!a)return{};sa(a,0);var n,l,o,f,d=0;a.chk("feff","Byte Order: "),a.read_shift(2);var x=a.read_shift(4),m=a.read_shift(16);if(m!==$e.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(l=a.read_shift(16),f=a.read_shift(4),n===1&&f!==a.l)throw new Error("Length mismatch: "+f+" !== "+a.l);n===2&&(o=a.read_shift(16),d=a.read_shift(4));var p=yw(a,t),v={SystemIdentifier:x};for(var y in p)v[y]=p[y];if(v.FMTID=l,n===1)return v;if(d-a.l==2&&(a.l+=2),a.l!==d)throw new Error("Length mismatch 2: "+a.l+" !== "+d);var b;try{b=yw(a,null)}catch{}for(y in b)v[y]=b[y];return v.FMTID=[l,o],v}function Sw(e,t,r,a,n,l){var o=Ee(n?68:48),f=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var d=bw(e,r,a);if(f.push(d),n){var x=bw(n,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+d.length),f.push(x)}return Yr(f)}function bi(e,t){return e.read_shift(t),null}function H8(e,t){t||(t=Ee(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function G8(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function _r(e,t){return e.read_shift(t)===1}function Ta(e,t){return t||(t=Ee(2)),t.write_shift(2,+!!e),t}function Or(e){return e.read_shift(2,"u")}function Sn(e,t){return t||(t=Ee(2)),t.write_shift(2,e),t}function GE(e,t){return G8(e,t,Or)}function V8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function VE(e,t,r){return r||(r=Ee(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function pu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function q8(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,l=1+(r&1),o=0,f,d={};n&&(o=e.read_shift(2)),a&&(f=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,x);return n&&(e.l+=4*o),a&&(e.l+=f),d.t=m,n||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function W8(e){var t=e.t||"",r=Ee(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Ee(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Yr(n)}function Pl(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function gu(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Pl(e,a,r)}function Xl(e,t,r){if(r.biff>5)return gu(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function qE(e,t,r){return r||(r=Ee(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function X8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function $8(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Aa,"");return a&&(e.l+=24),n}function Y8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Aa,"");return r+o}function K8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return $8(e);case"0303000000000000c000000000000046":return Y8(e);default:throw new Error("Unsupported Moniker "+r)}}function Vf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Aa,""):"";return r}function Ew(e,t){t||(t=Ee(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Q8(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var l,o,f,d,x="",m,p;n&16&&(l=Vf(e,r-e.l)),n&128&&(o=Vf(e,r-e.l)),(n&257)===257&&(f=Vf(e,r-e.l)),(n&257)===1&&(d=K8(e,r-e.l)),n&8&&(x=Vf(e,r-e.l)),n&32&&(m=e.read_shift(16)),n&64&&(p=Lg(e)),e.l=r;var v=o||f||d||"";v&&x&&(v+="#"+x),v||(v="#"+x),n&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return m&&(y.guid=m),p&&(y.time=p),l&&(y.Tooltip=l),y}function Z8(e){var t=Ee(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),l=n>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)a=a.slice(1),Ew(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var f=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(f.length+1)),r=0;r<f.length;++r)t.write_shift(2,f.charCodeAt(r));t.write_shift(2,0),l&8&&Ew(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,a.length-3*d+1),r=0;r<a.length-3*d;++r)t.write_shift(1,a.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function WE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function XE(e,t){var r=WE(e);return r[3]=0,r}function ps(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Il(e,t,r,a){return a||(a=Ee(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function J8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function eR(e,t,r){return t===0?"":Xl(e,t,r)}function tR(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,l,o]}function $E(e){var t=e.read_shift(2),r=Fg(e);return[t,r]}function rR(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=pu(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,n}function Jd(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function YE(e,t){return t||(t=Ee(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function KE(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var aR=KE;function QE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function nR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ca(e){e.l+=2,e.l+=e.read_shift(2)}var iR={0:ca,4:ca,5:ca,6:ca,7:sR,8:ca,9:ca,10:ca,11:ca,12:ca,13:nR,14:ca,15:ca,16:ca,17:ca,18:ca,19:ca,20:ca,21:QE};function lR(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(iR[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function qf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Bg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Ee(n);return l.write_shift(2,a),l.write_shift(2,t),n>4&&l.write_shift(2,29282),n>6&&l.write_shift(2,1997),n>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function oR(e,t){return t===0||e.read_shift(2),1200}function cR(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=Xl(e,0,r);return e.read_shift(t+a-e.l),n}function uR(e,t){var r=!t||t.biff==8,a=Ee(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function fR(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function dR(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=pu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:l,name:o}}function hR(e,t){var r=!t||t.biff>=8?2:1,a=Ee(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function xR(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0;o!=n&&e.l<r;++o)l.push(q8(e));return l.Count=a,l.Unique=n,l}function mR(e,t){var r=Ee(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=W8(e[n]);var l=Yr([r].concat(a));return l.parts=[r.length].concat(a.map(function(o){return o.length})),l}function pR(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function gR(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function vR(e){var t=J8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function yR(e){return e.read_shift(2),e.read_shift(4)}function _w(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,n]}function bR(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),x=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:l,CurTab:o,FirstTab:f,Selected:d,TabRatio:x}}function wR(){var e=Ee(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function SR(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function ER(e){var t=Ee(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function _R(){}function kR(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=pu(e,0,r),a}function TR(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,l=Ee(n);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function NR(e){var t=ps(e);return t.isst=e.read_shift(4),t}function CR(e,t,r,a){var n=Ee(10);return Il(e,t,a,n),n.write_shift(4,r),n}function AR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=ps(e);r.biff==2&&e.l++;var l=gu(e,a-e.l,r);return n.val=l,n}function jR(e,t,r,a,n){var l=!n||n.biff==8,o=Ee(8+ +l+(1+l)*r.length);return Il(e,t,a,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function RR(e,t,r){var a=e.read_shift(2),n=Xl(e,0,r);return[a,n]}function DR(e,t,r,a){var n=r&&r.biff==5;a||(a=Ee(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var FR=Xl;function kw(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,l=e.read_shift(n),o=e.read_shift(n),f=e.read_shift(2),d=e.read_shift(2);return e.l=a,{s:{r:l,c:f},e:{r:o,c:d}}}function OR(e,t){var r=t.biff==8||!t.biff?4:2,a=Ee(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function MR(e){var t=e.read_shift(2),r=e.read_shift(2),a=$E(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function LR(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push($E(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:l}}function BR(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:l}}function PR(e,t,r,a){var n={},l=e.read_shift(4),o=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(2);return n.patternType=v8[f>>26],a.cellStyles&&(n.alc=l&7,n.fWrap=l>>3&1,n.alcV=l>>4&7,n.fJustLast=l>>7&1,n.trot=l>>8&255,n.cIndent=l>>16&15,n.fShrinkToFit=l>>20&1,n.iReadOrder=l>>22&2,n.fAtrNum=l>>26&1,n.fAtrFnt=l>>27&1,n.fAtrAlc=l>>28&1,n.fAtrBdr=l>>29&1,n.fAtrPat=l>>30&1,n.fAtrProt=l>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=f&127,n.icvBottom=f>>7&127,n.icvDiag=f>>14&127,n.dgDiag=f>>21&15,n.icvFore=d&127,n.icvBack=d>>7&127,n.fsxButton=d>>14&1),n}function IR(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=PR(e,t,a.fStyle,r),a}function Tw(e,t,r,a){var n=r&&r.biff==5;a||(a=Ee(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&n&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function UR(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function zR(e){var t=Ee(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Nw(e,t,r){var a=ps(e);(r.biff==2||t==9)&&++e.l;var n=V8(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function HR(e,t,r,a,n,l){var o=Ee(8);return Il(e,t,a,o),VE(r,l,o),o}function GR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ps(e),n=ma(e);return a.val=n,a}function VR(e,t,r,a){var n=Ee(14);return Il(e,t,a,n),Bl(r,n),n}var Cw=eR;function qR(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,n];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Pl(e,l),f=[];a>e.l;)f.push(gu(e));return[l,n,o,f]}function Aw(e,t,r){var a=e.read_shift(2),n,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=rR(e,t-2,r)),l.body=n||e.read_shift(t-2),typeof n=="string"&&(l.Name=n),l}var WR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function jw(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),f=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var x=Pl(e,o,r);n&32&&(x=WR[x.charCodeAt(0)]);var m=a-e.l;r&&r.biff==2&&--m;var p=a==e.l||f===0||!(m>0)?[]:lM(e,m,r,f);return{chKey:l,Name:x,itab:d,rgce:p}}function ZE(e,t,r){if(r.biff<8)return XR(e,t,r);for(var a=[],n=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(tR(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function XR(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=pu(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function $R(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),l=Pl(e,a,r),o=Pl(e,n,r);return[l,o]}function YR(e,t,r){var a=KE(e);e.l++;var n=e.read_shift(1);return t-=8,[oM(e,t,r),n,a]}function Rw(e,t,r){var a=aR(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,sM(e,t,r)]}function KR(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function QR(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=Xl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},f,o,l]}}function ZR(e,t,r){return QR(e,t,r)}function JR(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Jd(e));return r}function eD(e){var t=Ee(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)YE(e[r],t);return t}function tD(e,t,r){if(r&&r.biff<8)return aD(e,t,r);var a=QE(e),n=lR(e,t-22,a[1]);return{cmo:a,ft:n}}var rD={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function aD(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((rD[a]||ga)(e,t,r)),{cmo:[n,a,l],ft:o}}function nD(e,t,r){var a=e.l,n="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=X8(e,6,r);var f=e.read_shift(2);e.read_shift(2),Or(e,2);var d=e.read_shift(2);e.l+=d;for(var x=1;x<e.lens.length-1;++x){if(e.l-a!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],p=Pl(e,e.lens[x+1]-e.lens[x]-1);if(n+=p,n.length>=(m?f:2*f))break}if(n.length!==f&&n.length!==f*2)throw new Error("cchText: "+f+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function sD(e,t){var r=Jd(e);e.l+=16;var a=Q8(e,t-24);return[r,a]}function iD(e){var t=Ee(24),r=fr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Yr([t,Z8(e[1])])}function lD(e,t){e.read_shift(2);var r=Jd(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Aa,""),[r,a]}function oD(e){var t=e[1].Tooltip,r=Ee(10+2*(t.length+1));r.write_shift(2,2048);var a=fr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function cD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=mw[r]||r,r=e.read_shift(2),t[1]=mw[r]||r,t}function uD(e){return e||(e=Ee(4)),e.write_shift(2,1),e.write_shift(2,1),e}function fD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XE(e));return r}function dD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XE(e));return r}function hD(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function JE(e,t,r){if(!r.cellStyles)return ga(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),f=e.read_shift(a),d=e.read_shift(2);a==2&&(e.l+=2);var x={s:n,e:l,w:o,ixfe:f,flags:d};return(r.biff>=5||!r.biff)&&(x.level=d>>8&7),x}function xD(e,t){var r=Ee(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function mD(e,t){var r={};return t<32||(e.l+=16,r.header=ma(e),r.footer=ma(e),e.l+=2),r}function pD(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function gD(e){for(var t=Ee(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var vD=ps,yD=GE,bD=gu;function wD(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function SD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ps(e);++e.l;var n=Xl(e,t-7,r);return a.t="str",a.val=n,a}function ED(e){var t=ps(e);++e.l;var r=ma(e);return t.t="n",t.val=r,t}function _D(e,t,r){var a=Ee(15);return wu(a,e,t),a.write_shift(8,r,"f"),a}function kD(e){var t=ps(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function TD(e,t,r){var a=Ee(9);return wu(a,e,t),a.write_shift(2,r),a}function ND(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function CD(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function AD(e,t,r){var a=e.l+t,n=ps(e),l=e.read_shift(2),o=Pl(e,l,r);return e.l=a,n.t="str",n.val=o,n}var jD=[2,3,48,49,131,139,140,245],Pp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Kd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(f,d){var x=[],m=Ii(1);switch(d.type){case"base64":m=Ja(rn(f));break;case"binary":m=Ja(f);break;case"buffer":case"array":m=f;break}sa(m,0);var p=m.read_shift(1),v=!!(p&136),y=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var w=0,E=521;p==2&&(w=m.read_shift(2)),m.l+=3,p!=2&&(w=m.read_shift(4)),w>1048576&&(w=1e6),p!=2&&(E=m.read_shift(2));var _=m.read_shift(2),N=d.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(N=e[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var k=[],F={},j=Math.min(m.length,p==2?521:E-10-(y?264:0)),R=b?32:11;m.l<j&&m[m.l]!=13;)switch(F={},F.name=U0.utils.decode(N,m.slice(m.l,m.l+R)).replace(/[\u0000\r\n].*$/g,""),m.l+=R,F.type=String.fromCharCode(m.read_shift(1)),p!=2&&!b&&(F.offset=m.read_shift(4)),F.len=m.read_shift(1),p==2&&(F.offset=m.read_shift(2)),F.dec=m.read_shift(1),F.name.length&&k.push(F),p!=2&&(m.l+=b?13:14),F.type){case"B":(!y||F.len!=8)&&d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var T=0,C=0;for(x[0]=[],C=0;C!=k.length;++C)x[0][C]=k[C].name;for(;w-- >0;){if(m[m.l]===42){m.l+=_;continue}for(++m.l,x[++T]=[],C=0,C=0;C!=k.length;++C){var O=m.slice(m.l,m.l+k[C].len);m.l+=k[C].len,sa(O,0);var V=U0.utils.decode(N,O);switch(k[C].type){case"C":V.trim().length&&(x[T][C]=V.replace(/\s+$/,""));break;case"D":V.length===8?x[T][C]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):x[T][C]=V;break;case"F":x[T][C]=parseFloat(V.trim());break;case"+":case"I":x[T][C]=b?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":x[T][C]=!0;break;case"N":case"F":x[T][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));x[T][C]="##MEMO##"+(b?parseInt(V.trim(),10):O.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(x[T][C]=+V||0);break;case"@":x[T][C]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":x[T][C]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":x[T][C]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[T][C]=-O.read_shift(-8,"f");break;case"B":if(y&&k[C].len==8){x[T][C]=O.read_shift(8,"f");break}case"G":case"P":O.l+=k[C].len;break;case"0":if(k[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[C].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),d.DBF=k,x}function a(f,d){var x=d||{};x.dateNF||(x.dateNF="yyyymmdd");var m=pc(r(f,x),x);return m["!cols"]=x.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete x.DBF,m}function n(f,d){try{return qi(a(f,d),d)}catch(x){if(d&&d.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(f,d){var x=d||{};if(+x.codepage>=0&&Un(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=za(),p=Fd(f,{header:1,raw:!0,cellDates:!0}),v=p[0],y=p.slice(1),b=f["!cols"]||[],w=0,E=0,_=0,N=1;for(w=0;w<v.length;++w){if(((b[w]||{}).DBF||{}).name){v[w]=b[w].DBF.name,++_;continue}if(v[w]!=null){if(++_,typeof v[w]=="number"&&(v[w]=v[w].toString(10)),typeof v[w]!="string")throw new Error("DBF Invalid column name "+v[w]+" |"+typeof v[w]+"|");if(v.indexOf(v[w])!==w){for(E=0;E<1024;++E)if(v.indexOf(v[w]+"_"+E)==-1){v[w]+="_"+E;break}}}}var k=jt(f["!ref"]),F=[],j=[],R=[];for(w=0;w<=k.e.c-k.s.c;++w){var T="",C="",O=0,V=[];for(E=0;E<y.length;++E)y[E][w]!=null&&V.push(y[E][w]);if(V.length==0||v[w]==null){F[w]="?";continue}for(E=0;E<V.length;++E){switch(typeof V[E]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=V[E]instanceof Date?"D":"C";break;default:C="C"}O=Math.max(O,String(V[E]).length),T=T&&T!=C?"C":C}O>250&&(O=250),C=((b[w]||{}).DBF||{}).type,C=="C"&&b[w].DBF.len>O&&(O=b[w].DBF.len),T=="B"&&C=="N"&&(T="N",R[w]=b[w].DBF.dec,O=b[w].DBF.len),j[w]=T=="C"||C=="N"?O:l[T]||0,N+=j[w],F[w]=T}var z=m.next(32);for(z.write_shift(4,318902576),z.write_shift(4,y.length),z.write_shift(2,296+32*_),z.write_shift(2,N),w=0;w<4;++w)z.write_shift(4,0);for(z.write_shift(4,0|(+t[H4]||3)<<8),w=0,E=0;w<v.length;++w)if(v[w]!=null){var H=m.next(32),ie=(v[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,ie,"sbcs"),H.write_shift(1,F[w]=="?"?"C":F[w],"sbcs"),H.write_shift(4,E),H.write_shift(1,j[w]||l[F[w]]||0),H.write_shift(1,R[w]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),E+=j[w]||l[F[w]]||0}var we=m.next(264);for(we.write_shift(4,13),w=0;w<65;++w)we.write_shift(4,0);for(w=0;w<y.length;++w){var ge=m.next(N);for(ge.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(F[E]){case"L":ge.write_shift(1,y[w][E]==null?63:y[w][E]?84:70);break;case"B":ge.write_shift(8,y[w][E]||0,"f");break;case"N":var ee="0";for(typeof y[w][E]=="number"&&(ee=y[w][E].toFixed(R[E]||0)),_=0;_<j[E]-ee.length;++_)ge.write_shift(1,32);ge.write_shift(1,ee,"sbcs");break;case"D":y[w][E]?(ge.write_shift(4,("0000"+y[w][E].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(y[w][E].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+y[w][E].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var le=String(y[w][E]!=null?y[w][E]:"").slice(0,j[E]);for(ge.write_shift(1,le,"sbcs"),_=0;_<j[E]-le.length;++_)ge.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),e_=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+br(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,y){var b=e[y];return typeof b=="number"?Hb(b):b},a=function(v,y,b){var w=y.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?v:Hb(w)};e["|"]=254;function n(v,y){switch(y.type){case"base64":return l(rn(v),y);case"binary":return l(v,y);case"buffer":return l(vt&&Buffer.isBuffer(v)?v.toString("binary"):Vi(v),y);case"array":return l(Ll(v),y)}throw new Error("Unrecognized type "+y.type)}function l(v,y){var b=v.split(/[\n\r]+/),w=-1,E=-1,_=0,N=0,k=[],F=[],j=null,R={},T=[],C=[],O=[],V=0,z;for(+y.codepage>=0&&Un(+y.codepage);_!==b.length;++_){V=0;var H=b[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),ie=H.replace(/;;/g,"\0").split(";").map(function(Y){return Y.replace(/\u0000/g,";")}),we=ie[0],ge;if(H.length>0)switch(we){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&F.push(H.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,le=!1,ne=!1,te=!1,I=-1,Z=-1;for(N=1;N<ie.length;++N)switch(ie[N].charAt(0)){case"A":break;case"X":E=parseInt(ie[N].slice(1))-1,le=!0;break;case"Y":for(w=parseInt(ie[N].slice(1))-1,le||(E=0),z=k.length;z<=w;++z)k[z]=[];break;case"K":ge=ie[N].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Hn(ge))?isNaN(ac(ge).getDate())||(ge=nr(ge)):(ge=Hn(ge),j!==null&&xc(j)&&(ge=Zd(ge))),ee=!0;break;case"E":te=!0;var L=Ho(ie[N].slice(1),{r:w,c:E});k[w][E]=[k[w][E],L];break;case"S":ne=!0,k[w][E]=[k[w][E],"S5S"];break;case"G":break;case"R":I=parseInt(ie[N].slice(1))-1;break;case"C":Z=parseInt(ie[N].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+H)}if(ee&&(k[w][E]&&k[w][E].length==2?k[w][E][0]=ge:k[w][E]=ge,j=null),ne){if(te)throw new Error("SYLK shared formula cannot have own formula");var P=I>-1&&k[I][Z];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");k[w][E][1]=v_(P[1],{r:w-I,c:E-Z})}break;case"F":var U=0;for(N=1;N<ie.length;++N)switch(ie[N].charAt(0)){case"X":E=parseInt(ie[N].slice(1))-1,++U;break;case"Y":for(w=parseInt(ie[N].slice(1))-1,z=k.length;z<=w;++z)k[z]=[];break;case"M":V=parseInt(ie[N].slice(1))/20;break;case"F":break;case"G":break;case"P":j=F[parseInt(ie[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=ie[N].slice(1).split(" "),z=parseInt(O[0],10);z<=parseInt(O[1],10);++z)V=parseInt(O[2],10),C[z-1]=V===0?{hidden:!0}:{wch:V},Ui(C[z-1]);break;case"C":E=parseInt(ie[N].slice(1))-1,C[E]||(C[E]={});break;case"R":w=parseInt(ie[N].slice(1))-1,T[w]||(T[w]={}),V>0?(T[w].hpt=V,T[w].hpx=sc(V)):V===0&&(T[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+H)}U<1&&(j=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+H)}}return T.length>0&&(R["!rows"]=T),C.length>0&&(R["!cols"]=C),y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),[k,R]}function o(v,y){var b=n(v,y),w=b[0],E=b[1],_=pc(w,y);return br(E).forEach(function(N){_[N]=E[N]}),_}function f(v,y){return qi(o(v,y),y)}function d(v,y,b,w){var E="C;Y"+(b+1)+";X"+(w+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+Gg(v.f,{r:b,c:w}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function x(v,y){y.forEach(function(b,w){var E="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?E+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=$0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Y0(b.wpx)),typeof b.wch=="number"&&(E+=Math.round(b.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,y){y.forEach(function(b,w){var E="F;";b.hidden?E+="M0;":b.hpt?E+="M"+20*b.hpt+";":b.hpx&&(E+="M"+20*K0(b.hpx)+";"),E.length>2&&v.push(E+"R"+(w+1))})}function p(v,y){var b=["ID;PWXL;N;E"],w=[],E=jt(v["!ref"]),_,N=Array.isArray(v),k=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&x(b,v["!cols"]),v["!rows"]&&m(b,v["!rows"]),b.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var F=E.s.r;F<=E.e.r;++F)for(var j=E.s.c;j<=E.e.c;++j){var R=rt({r:F,c:j});_=N?(v[F]||[])[j]:v[R],!(!_||_.v==null&&(!_.f||_.F))&&w.push(d(_,v,F,j))}return b.join(k)+k+w.join(k)+k+"E"+k}return{to_workbook:f,to_sheet:o,from_sheet:p}}(),t_=function(){function e(l,o){switch(o.type){case"base64":return t(rn(l),o);case"binary":return t(l,o);case"buffer":return t(vt&&Buffer.isBuffer(l)?l.toString("binary"):Vi(l),o);case"array":return t(Ll(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var f=l.split(`
`),d=-1,x=-1,m=0,p=[];m!==f.length;++m){if(f[m].trim()==="BOT"){p[++d]=[],x=0;continue}if(!(d<0)){var v=f[m].trim().split(","),y=v[0],b=v[1];++m;for(var w=f[m]||"";(w.match(/["]/g)||[]).length&1&&m<f.length-1;)w+=`
`+f[++m];switch(w=w.trim(),+y){case-1:if(w==="BOT"){p[++d]=[],x=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?p[d][x]=!0:w==="FALSE"?p[d][x]=!1:isNaN(Hn(b))?isNaN(ac(b).getDate())?p[d][x]=b:p[d][x]=nr(b):p[d][x]=Hn(b),++x;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),p[d][x++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function r(l,o){return pc(e(l,o),o)}function a(l,o){return qi(r(l,o),o)}var n=function(){var l=function(d,x,m,p,v){d.push(x),d.push(m+","+p),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,x,m,p){d.push(x+","+m),d.push(x==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(d){var x=[],m=jt(d["!ref"]),p,v=Array.isArray(d);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var y=m.s.r;y<=m.e.r;++y){o(x,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var w=rt({r:y,c:b});if(p=v?(d[y]||[])[b]:d[w],!p){o(x,1,0,"");continue}switch(p.t){case"n":var E=p.w;!E&&p.v!=null&&(E=p.v),E==null?p.f&&!p.F?o(x,1,0,"="+p.f):o(x,1,0,""):o(x,0,E,"V");break;case"b":o(x,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=kn(p.z||et[14],zr(nr(p.v)))),o(x,0,p.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var _=`\r
`,N=x.join(_);return N}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),r_=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,v){for(var y=p.split(`
`),b=-1,w=-1,E=0,_=[];E!==y.length;++E){var N=y[E].trim().split(":");if(N[0]==="cell"){var k=fr(N[1]);if(_.length<=k.r)for(b=_.length;b<=k.r;++b)_[b]||(_[b]=[]);switch(b=k.r,w=k.c,N[2]){case"t":_[b][w]=e(N[3]);break;case"v":_[b][w]=+N[3];break;case"vtf":var F=N[N.length-1];case"vtc":switch(N[3]){case"nl":_[b][w]=!!+N[4];break;default:_[b][w]=+N[4];break}N[2]=="vtf"&&(_[b][w]=[_[b][w],F])}}}return v&&v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}function a(p,v){return pc(r(p,v),v)}function n(p,v){return qi(a(p,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function x(p){if(!p||!p["!ref"])return"";for(var v=[],y=[],b,w="",E=Ha(p["!ref"]),_=Array.isArray(p),N=E.s.r;N<=E.e.r;++N)for(var k=E.s.c;k<=E.e.c;++k)if(w=rt({r:N,c:k}),b=_?(p[N]||[])[k]:p[w],!(!b||b.v==null||b.t==="z")){switch(y=["cell",w,"t"],b.t){case"s":case"str":y.push(t(b.v));break;case"n":b.f?(y[2]="vtf",y[3]="n",y[4]=b.v,y[5]=t(b.f)):(y[2]="v",y[3]=b.v);break;case"b":y[2]="vt"+(b.f?"f":"c"),y[3]="nl",y[4]=b.v?"1":"0",y[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var F=zr(nr(b.v));y[2]="vtc",y[3]="nd",y[4]=""+F,y[5]=b.w||kn(b.z||et[14],F);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(p){return[l,o,f,o,x(p),d].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}}(),nc=function(){function e(m,p,v,y,b){b.raw?p[v][y]=m:m===""||(m==="TRUE"?p[v][y]=!0:m==="FALSE"?p[v][y]=!1:isNaN(Hn(m))?isNaN(ac(m).getDate())?p[v][y]=m:p[v][y]=nr(m):p[v][y]=Hn(m))}function t(m,p){var v=p||{},y=[];if(!m||m.length===0)return y;for(var b=m.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var E=10,_=0,N=0;N<=w;++N)_=b[N].indexOf(" "),_==-1?_=b[N].length:_++,E=Math.max(E,_);for(N=0;N<=w;++N){y[N]=[];var k=0;for(e(b[N].slice(0,E).trim(),y,N,k,v),k=1;k<=(b[N].length-E)/10+1;++k)e(b[N].slice(E+(k-1)*10,E+k*10).trim(),y,N,k,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var p={},v=!1,y=0,b=0;y<m.length;++y)(b=m.charCodeAt(y))==34?v=!v:!v&&b in r&&(p[b]=(p[b]||0)+1);b=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&b.push([p[y],y]);if(!b.length){p=a;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&b.push([p[y],y])}return b.sort(function(w,E){return w[0]-E[0]||a[w[1]]-a[E[1]]}),r[b.pop()[1]]||44}function l(m,p){var v=p||{},y="",b=v.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(y=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(y=m.charAt(4),m=m.slice(6)):y=n(m.slice(0,1024)):v&&v.FS?y=v.FS:y=n(m.slice(0,1024));var E=0,_=0,N=0,k=0,F=0,j=y.charCodeAt(0),R=!1,T=0,C=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var O=v.dateNF!=null?pj(v.dateNF):null;function V(){var z=m.slice(k,F),H={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)H.t="z";else if(v.raw)H.t="s",H.v=z;else if(z.trim().length===0)H.t="s",H.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(H.t="s",H.v=z.slice(2,-1).replace(/""/g,'"')):qO(z)?(H.t="n",H.f=z.slice(1)):(H.t="s",H.v=z);else if(z=="TRUE")H.t="b",H.v=!0;else if(z=="FALSE")H.t="b",H.v=!1;else if(!isNaN(N=Hn(z)))H.t="n",v.cellText!==!1&&(H.w=z),H.v=N;else if(!isNaN(ac(z).getDate())||O&&z.match(O)){H.z=v.dateNF||et[14];var ie=0;O&&z.match(O)&&(z=gj(z,v.dateNF,z.match(O)||[]),ie=1),v.cellDates?(H.t="d",H.v=nr(z,ie)):(H.t="n",H.v=zr(nr(z,ie))),v.cellText!==!1&&(H.w=kn(H.z,H.v instanceof Date?zr(H.v):H.v)),v.cellNF||delete H.z}else H.t="s",H.v=z;if(H.t=="z"||(v.dense?(b[E]||(b[E]=[]),b[E][_]=H):b[rt({c:_,r:E})]=H),k=F+1,C=m.charCodeAt(k),w.e.c<_&&(w.e.c=_),w.e.r<E&&(w.e.r=E),T==j)++_;else if(_=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;F<m.length;++F)switch(T=m.charCodeAt(F)){case 34:C===34&&(R=!R);break;case j:case 10:case 13:if(!R&&V())break e;break}return F-k>0&&V(),b["!ref"]=ht(w),b}function o(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,p):pc(t(m,p),p)}function f(m,p){var v="",y=p.type=="string"?[0,0,0,0]:Qg(m,p);switch(p.type){case"base64":v=rn(m);break;case"binary":v=m;break;case"buffer":p.codepage==65001?v=m.toString("utf8"):p.codepage&&typeof U0<"u"||(v=vt&&Buffer.isBuffer(m)?m.toString("binary"):Vi(m));break;case"array":v=Ll(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=$t(v.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?v=$t(v):p.type=="binary"&&typeof U0<"u",v.slice(0,19)=="socialcalc:version:"?r_.to_sheet(p.type=="string"?v:$t(v),p):o(v,p)}function d(m,p){return qi(f(m,p),p)}function x(m){for(var p=[],v=jt(m["!ref"]),y,b=Array.isArray(m),w=v.s.r;w<=v.e.r;++w){for(var E=[],_=v.s.c;_<=v.e.c;++_){var N=rt({r:w,c:_});if(y=b?(m[w]||[])[_]:m[N],!y||y.v==null){E.push("          ");continue}for(var k=(y.w||(qs(y),y.w)||"").slice(0,10);k.length<10;)k+=" ";E.push(k+(_===0?" ":""))}p.push(E.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:f,from_sheet:x}}();function RD(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=e_.to_workbook(e,r);return r.WTF=a,n}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return nc.to_workbook(e,t)}}var jl=function(){function e(L,P,U){if(L){sa(L,L.l||0);for(var Y=U.Enum||I;L.l<L.length;){var re=L.read_shift(2),ve=Y[re]||Y[65535],be=L.read_shift(2),Te=L.l+be,Ae=ve.f&&ve.f(L,be,U);if(L.l=Te,P(Ae,ve,re))return}}}function t(L,P){switch(P.type){case"base64":return r(Ja(rn(L)),P);case"binary":return r(Ja(L),P);case"buffer":case"array":return r(L,P)}throw"Unsupported type "+P.type}function r(L,P){if(!L)return L;var U=P||{},Y=U.dense?[]:{},re="Sheet1",ve="",be=0,Te={},Ae=[],Ve=[],Q={s:{r:0,c:0},e:{r:0,c:0}},st=U.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)U.Enum=I,e(L,function(De,Ot,dr){switch(dr){case 0:U.vers=De,De>=4096&&(U.qpro=!0);break;case 6:Q=De;break;case 204:De&&(ve=De);break;case 222:ve=De;break;case 15:case 51:U.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:dr==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=U.dateNF||et[14],U.cellDates&&(De[1].t="d",De[1].v=Zd(De[1].v))),U.qpro&&De[3]>be&&(Y["!ref"]=ht(Q),Te[re]=Y,Ae.push(re),Y=U.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},be=De[3],re=ve||"Sheet"+(be+1),ve="");var Zr=U.dense?(Y[De[0].r]||[])[De[0].c]:Y[rt(De[0])];if(Zr){Zr.t=De[1].t,Zr.v=De[1].v,De[1].z!=null&&(Zr.z=De[1].z),De[1].f!=null&&(Zr.f=De[1].f);break}U.dense?(Y[De[0].r]||(Y[De[0].r]=[]),Y[De[0].r][De[0].c]=De[1]):Y[rt(De[0])]=De[1];break}},U);else if(L[2]==26||L[2]==14)U.Enum=Z,L[2]==14&&(U.qpro=!0,L.l=0),e(L,function(De,Ot,dr){switch(dr){case 204:re=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>be&&(Y["!ref"]=ht(Q),Te[re]=Y,Ae.push(re),Y=U.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},be=De[3],re="Sheet"+(be+1)),st>0&&De[0].r>=st)break;U.dense?(Y[De[0].r]||(Y[De[0].r]=[]),Y[De[0].r][De[0].c]=De[1]):Y[rt(De[0])]=De[1],Q.e.c<De[0].c&&(Q.e.c=De[0].c),Q.e.r<De[0].r&&(Q.e.r=De[0].r);break;case 27:De[14e3]&&(Ve[De[14e3][0]]=De[14e3][1]);break;case 1537:Ve[De[0]]=De[1],De[0]==be&&(re=De[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(Y["!ref"]=ht(Q),Te[ve||re]=Y,Ae.push(ve||re),!Ve.length)return{SheetNames:Ae,Sheets:Te};for(var it={},Qe=[],tt=0;tt<Ve.length;++tt)Te[Ae[tt]]?(Qe.push(Ve[tt]||Ae[tt]),it[Ve[tt]]=Te[Ve[tt]]||Te[Ae[tt]]):(Qe.push(Ve[tt]),it[Ve[tt]]={"!ref":"A1"});return{SheetNames:Qe,Sheets:it}}function a(L,P){var U=P||{};if(+U.codepage>=0&&Un(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var Y=za(),re=jt(L["!ref"]),ve=Array.isArray(L),be=[];Pe(Y,0,l(1030)),Pe(Y,6,d(re));for(var Te=Math.min(re.e.r,8191),Ae=re.s.r;Ae<=Te;++Ae)for(var Ve=kr(Ae),Q=re.s.c;Q<=re.e.c;++Q){Ae===re.s.r&&(be[Q]=ur(Q));var st=be[Q]+Ve,it=ve?(L[Ae]||[])[Q]:L[st];if(!(!it||it.t=="z"))if(it.t=="n")(it.v|0)==it.v&&it.v>=-32768&&it.v<=32767?Pe(Y,13,y(Ae,Q,it.v)):Pe(Y,14,w(Ae,Q,it.v));else{var Qe=qs(it);Pe(Y,15,p(Ae,Q,Qe.slice(0,239)))}}return Pe(Y,1),Y.end()}function n(L,P){var U=P||{};if(+U.codepage>=0&&Un(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var Y=za();Pe(Y,0,o(L));for(var re=0,ve=0;re<L.SheetNames.length;++re)(L.Sheets[L.SheetNames[re]]||{})["!ref"]&&Pe(Y,27,te(L.SheetNames[re],ve++));var be=0;for(re=0;re<L.SheetNames.length;++re){var Te=L.Sheets[L.SheetNames[re]];if(!(!Te||!Te["!ref"])){for(var Ae=jt(Te["!ref"]),Ve=Array.isArray(Te),Q=[],st=Math.min(Ae.e.r,8191),it=Ae.s.r;it<=st;++it)for(var Qe=kr(it),tt=Ae.s.c;tt<=Ae.e.c;++tt){it===Ae.s.r&&(Q[tt]=ur(tt));var De=Q[tt]+Qe,Ot=Ve?(Te[it]||[])[tt]:Te[De];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")Pe(Y,23,V(it,tt,be,Ot.v));else{var dr=qs(Ot);Pe(Y,22,T(it,tt,be,dr.slice(0,239)))}}++be}}return Pe(Y,1),Y.end()}function l(L){var P=Ee(2);return P.write_shift(2,L),P}function o(L){var P=Ee(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var U=0,Y=0,re=0,ve=0;ve<L.SheetNames.length;++ve){var be=L.SheetNames[ve],Te=L.Sheets[be];if(!(!Te||!Te["!ref"])){++re;var Ae=Ha(Te["!ref"]);U<Ae.e.r&&(U=Ae.e.r),Y<Ae.e.c&&(Y=Ae.e.c)}}return U>8191&&(U=8191),P.write_shift(2,U),P.write_shift(1,re),P.write_shift(1,Y),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function f(L,P,U){var Y={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&U.qpro?(Y.s.c=L.read_shift(1),L.l++,Y.s.r=L.read_shift(2),Y.e.c=L.read_shift(1),L.l++,Y.e.r=L.read_shift(2),Y):(Y.s.c=L.read_shift(2),Y.s.r=L.read_shift(2),P==12&&U.qpro&&(L.l+=2),Y.e.c=L.read_shift(2),Y.e.r=L.read_shift(2),P==12&&U.qpro&&(L.l+=2),Y.s.c==65535&&(Y.s.c=Y.e.c=Y.s.r=Y.e.r=0),Y)}function d(L){var P=Ee(8);return P.write_shift(2,L.s.c),P.write_shift(2,L.s.r),P.write_shift(2,L.e.c),P.write_shift(2,L.e.r),P}function x(L,P,U){var Y=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(Y[0].c=L.read_shift(1),Y[3]=L.read_shift(1),Y[0].r=L.read_shift(2),L.l+=2):(Y[2]=L.read_shift(1),Y[0].c=L.read_shift(2),Y[0].r=L.read_shift(2)),Y}function m(L,P,U){var Y=L.l+P,re=x(L,P,U);if(re[1].t="s",U.vers==20768){L.l++;var ve=L.read_shift(1);return re[1].v=L.read_shift(ve,"utf8"),re}return U.qpro&&L.l++,re[1].v=L.read_shift(Y-L.l,"cstr"),re}function p(L,P,U){var Y=Ee(7+U.length);Y.write_shift(1,255),Y.write_shift(2,P),Y.write_shift(2,L),Y.write_shift(1,39);for(var re=0;re<Y.length;++re){var ve=U.charCodeAt(re);Y.write_shift(1,ve>=128?95:ve)}return Y.write_shift(1,0),Y}function v(L,P,U){var Y=x(L,P,U);return Y[1].v=L.read_shift(2,"i"),Y}function y(L,P,U){var Y=Ee(7);return Y.write_shift(1,255),Y.write_shift(2,P),Y.write_shift(2,L),Y.write_shift(2,U,"i"),Y}function b(L,P,U){var Y=x(L,P,U);return Y[1].v=L.read_shift(8,"f"),Y}function w(L,P,U){var Y=Ee(13);return Y.write_shift(1,255),Y.write_shift(2,P),Y.write_shift(2,L),Y.write_shift(8,U,"f"),Y}function E(L,P,U){var Y=L.l+P,re=x(L,P,U);if(re[1].v=L.read_shift(8,"f"),U.qpro)L.l=Y;else{var ve=L.read_shift(2);F(L.slice(L.l,L.l+ve),re),L.l+=ve}return re}function _(L,P,U){var Y=P&32768;return P&=-32769,P=(Y?L:0)+(P>=8192?P-16384:P),(Y?"":"$")+(U?ur(P):kr(P))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(L,P){sa(L,0);for(var U=[],Y=0,re="",ve="",be="",Te="";L.l<L.length;){var Ae=L[L.l++];switch(Ae){case 0:U.push(L.read_shift(8,"f"));break;case 1:ve=_(P[0].c,L.read_shift(2),!0),re=_(P[0].r,L.read_shift(2),!1),U.push(ve+re);break;case 2:{var Ve=_(P[0].c,L.read_shift(2),!0),Q=_(P[0].r,L.read_shift(2),!1);ve=_(P[0].c,L.read_shift(2),!0),re=_(P[0].r,L.read_shift(2),!1),U.push(Ve+Q+":"+ve+re)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(L.read_shift(2));break;case 6:{for(var st="";Ae=L[L.l++];)st+=String.fromCharCode(Ae);U.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Te=U.pop(),be=U.pop(),U.push(["AND","OR"][Ae-20]+"("+be+","+Te+")");break;default:if(Ae<32&&k[Ae])Te=U.pop(),be=U.pop(),U.push(be+k[Ae]+Te);else if(N[Ae]){if(Y=N[Ae][1],Y==69&&(Y=L[L.l++]),Y>U.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+U.join("|")+"|");return}var it=U.slice(-Y);U.length-=Y,U.push(N[Ae][0]+"("+it.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}U.length==1?P[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function j(L){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=L.read_shift(2),P[3]=L[L.l++],P[0].c=L[L.l++],P}function R(L,P){var U=j(L);return U[1].t="s",U[1].v=L.read_shift(P-4,"cstr"),U}function T(L,P,U,Y){var re=Ee(6+Y.length);re.write_shift(2,L),re.write_shift(1,U),re.write_shift(1,P),re.write_shift(1,39);for(var ve=0;ve<Y.length;++ve){var be=Y.charCodeAt(ve);re.write_shift(1,be>=128?95:be)}return re.write_shift(1,0),re}function C(L,P){var U=j(L);U[1].v=L.read_shift(2);var Y=U[1].v>>1;if(U[1].v&1)switch(Y&7){case 0:Y=(Y>>3)*5e3;break;case 1:Y=(Y>>3)*500;break;case 2:Y=(Y>>3)/20;break;case 3:Y=(Y>>3)/200;break;case 4:Y=(Y>>3)/2e3;break;case 5:Y=(Y>>3)/2e4;break;case 6:Y=(Y>>3)/16;break;case 7:Y=(Y>>3)/64;break}return U[1].v=Y,U}function O(L,P){var U=j(L),Y=L.read_shift(4),re=L.read_shift(4),ve=L.read_shift(2);if(ve==65535)return Y===0&&re===3221225472?(U[1].t="e",U[1].v=15):Y===0&&re===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var be=ve&32768;return ve=(ve&32767)-16446,U[1].v=(1-be*2)*(re*Math.pow(2,ve+32)+Y*Math.pow(2,ve)),U}function V(L,P,U,Y){var re=Ee(14);if(re.write_shift(2,L),re.write_shift(1,U),re.write_shift(1,P),Y==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var ve=0,be=0,Te=0,Ae=0;return Y<0&&(ve=1,Y=-Y),be=Math.log2(Y)|0,Y/=Math.pow(2,be-31),Ae=Y>>>0,(Ae&2147483648)==0&&(Y/=2,++be,Ae=Y>>>0),Y-=Ae,Ae|=2147483648,Ae>>>=0,Y*=Math.pow(2,32),Te=Y>>>0,re.write_shift(4,Te),re.write_shift(4,Ae),be+=16383+(ve?32768:0),re.write_shift(2,be),re}function z(L,P){var U=O(L);return L.l+=P-14,U}function H(L,P){var U=j(L),Y=L.read_shift(4);return U[1].v=Y>>6,U}function ie(L,P){var U=j(L),Y=L.read_shift(8,"f");return U[1].v=Y,U}function we(L,P){var U=ie(L);return L.l+=P-10,U}function ge(L,P){return L[L.l+P-1]==0?L.read_shift(P,"cstr"):""}function ee(L,P){var U=L[L.l++];U>P-1&&(U=P-1);for(var Y="";Y.length<U;)Y+=String.fromCharCode(L[L.l++]);return Y}function le(L,P,U){if(!(!U.qpro||P<21)){var Y=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var re=L.read_shift(P-21,"cstr");return[Y,re]}}function ne(L,P){for(var U={},Y=L.l+P;L.l<Y;){var re=L.read_shift(2);if(re==14e3){for(U[re]=[0,""],U[re][0]=L.read_shift(2);L[L.l];)U[re][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return U}function te(L,P){var U=Ee(5+L.length);U.write_shift(2,14e3),U.write_shift(2,P);for(var Y=0;Y<L.length;++Y){var re=L.charCodeAt(Y);U[U.l++]=re>127?95:re}return U[U.l++]=0,U}var I={0:{n:"BOF",f:Or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},Z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:we},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function DD(e){var t={},r=e.match(va),a=0,n=!1;if(r)for(;a!=r.length;++a){var l=nt(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=xg[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(l[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+l[0])}}return t}var FD=function(){var e=G0("t"),t=G0("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var f={t:"s",v:At(o[1])},d=l.match(t);return d&&(f.s=DD(d[1])),f}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(f){return f.v})}}(),OD=function(){var t=/(\r\n|\n)/g;function r(n,l,o){var f=[];n.u&&f.push("text-decoration: underline;"),n.uval&&f.push("text-underline-style:"+n.uval+";"),n.sz&&f.push("font-size:"+n.sz+"pt;"),n.outline&&f.push("text-effect: outline;"),n.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),n.b&&(l.push("<b>"),o.push("</b>")),n.i&&(l.push("<i>"),o.push("</i>")),n.strike&&(l.push("<s>"),o.push("</s>"));var d=n.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(l.push("<"+d+">"),o.push("</"+d+">")),o.push("</span>"),n}function a(n){var l=[[],n.v,[]];return n.v?(n.s&&r(n.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}}(),MD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LD=/<(?:\w+:)?r>/,BD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=At($t(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=$t(e),r&&(a.h=_g(a.t))):e.match(LD)&&(a.r=$t(e),a.t=At($t((e.replace(BD,"").match(MD)||[]).join("").replace(va,""))),r&&(a.h=OD(FD(a.r)))),a):{t:""}}var PD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ID=/<(?:\w+:)?(?:si|sstItem)>/g,UD=/<\/(?:\w+:)?(?:si|sstItem)>/;function zD(e,t){var r=[],a="";if(!e)return r;var n=e.match(PD);if(n){a=n[2].replace(ID,"").split(UD);for(var l=0;l!=a.length;++l){var o=Pg(a[l].trim(),t);o!=null&&(r[r.length]=o)}n=nt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var HD=/^\s|\s$|[\t\n\r]/;function a_(e,t){if(!t.bookSST)return"";var r=[Nr];r[r.length]=Be("sst",null,{xmlns:Hl[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],l="<si>";n.r?l+=n.r:(l+="<t",n.t||(n.t=""),n.t.match(HD)&&(l+=' xml:space="preserve"'),l+=">"+zt(n.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function GD(e){return[e.read_shift(4),e.read_shift(4)]}function VD(e,t){var r=[],a=!1;return $s(e,function(l,o,f){switch(f){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),r}function qD(e,t){return t||(t=Ee(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var WD=r8;function XD(e){var t=za();je(t,159,qD(e));for(var r=0;r<e.length;++r)je(t,19,WD(e[r]));return je(t,160),t.end()}function n_(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Hs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function $D(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Hs(e,4),t.U=Hs(e,4),t.W=Hs(e,4),t}function YD(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),l=[];n-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function KD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(YD(e));return t}function QD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function ZD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Hs(e,4),t.U=Hs(e,4),t.W=Hs(e,4),t}function JD(e){var t=ZD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function s_(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function i_(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function eF(e){var t=Hs(e);switch(t.Minor){case 2:return[t.Minor,tF(e)];case 3:return[t.Minor,rF()];case 4:return[t.Minor,aF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function tF(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=s_(e,r),n=i_(e,e.length-e.l);return{t:"Std",h:a,v:n}}function rF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aF(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(va,function(l){var o=nt(l);switch(ms(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(f){a[f]=o[f]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function nF(e,t){var r={},a=r.EncryptionVersionInfo=Hs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=s_(e,n),t-=n,r.EncryptionVerifier=i_(e,t),r}function sF(e){var t={},r=t.EncryptionVersionInfo=Hs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ig(e){var t=0,r,a=n_(e),n=a.length+1,l,o,f,d,x;for(r=Ii(n),r[0]=a.length,l=1;l!=n;++l)r[l]=a[l-1];for(l=n-1;l>=0;--l)o=r[l],f=(t&16384)===0?0:1,d=t<<1&32767,x=f|d,t=x^o;return t^52811}var l_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,f){return a(o^f)},l=function(o){for(var f=t[o.length-1],d=104,x=o.length-1;x>=0;--x)for(var m=o[x],p=0;p!=7;++p)m&64&&(f^=r[d]),m*=2,--d;return f};return function(o){for(var f=n_(o),d=l(f),x=f.length,m=Ii(16),p=0;p!=16;++p)m[p]=0;var v,y,b;for((x&1)===1&&(v=d>>8,m[x]=n(e[0],v),--x,v=d&255,y=f[f.length-1],m[x]=n(y,v));x>0;)--x,v=d>>8,m[x]=n(f[x],v),--x,v=d&255,m[x]=n(f[x],v);for(x=15,b=15-f.length;b>0;)v=d>>8,m[x]=n(e[b],v),--x,--b,v=d&255,m[x]=n(f[x],v),--x,--b;return m}}(),iF=function(e,t,r,a,n){n||(n=t),a||(a=l_(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=a[r],o=(o>>5|o<<3)&255,n[l]=o,++r;return[n,r,a]},lF=function(e){var t=0,r=l_(e);return function(a){var n=iF("",a,t,r);return t=n[1],n[0]}};function oF(e,t,r,a){var n={key:Or(e),verificationBytes:Or(e)};return r.password&&(n.verifier=Ig(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=lF(r.password)),n}function cF(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=sF(e):a.Data=nF(e,t),a}function uF(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?cF(e,t-2,a):oF(e,r.biff>=8?t:t-2,r,a),a}var o_=function(){function e(n,l){switch(l.type){case"base64":return t(rn(n),l);case"binary":return t(n,l);case"buffer":return t(vt&&Buffer.isBuffer(n)?n.toString("binary"):Vi(n),l);case"array":return t(Ll(n),l)}throw new Error("Unrecognized type "+l.type)}function t(n,l){var o=l||{},f=o.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,p){Array.isArray(f)&&(f[p]=[]);for(var v=/\\\w+\b/g,y=0,b,w=-1;b=v.exec(m);){switch(b[0]){case"\\cell":var E=m.slice(y,v.lastIndex-b[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var _={v:E,t:"s"};Array.isArray(f)?f[p][w]=_:f[rt({r:p,c:w})]=_}break}y=v.lastIndex}w>x.e.c&&(x.e.c=w)}),f["!ref"]=ht(x),f}function r(n,l){return qi(e(n,l),l)}function a(n){for(var l=["{\\rtf1\\ansi"],o=jt(n["!ref"]),f,d=Array.isArray(n),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var p=rt({r:x,c:m});f=d?(n[x]||[])[m]:n[p],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(qs(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function fF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function X0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function dF(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),l=Math.min(t,r,a),o=n-l;if(o===0)return[0,0,t];var f=0,d=0,x=n+l;switch(d=o/(x>1?2-x:x),n){case t:f=((r-a)/o+6)%6;break;case r:f=(a-t)/o+2;break;case a:f=(t-r)/o+4;break}return[f/6,d,x/2]}function hF(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),l=a-n/2,o=[l,l,l],f=6*t,d;if(r!==0)switch(f|0){case 0:case 6:d=n*f,o[0]+=n,o[1]+=d;break;case 1:d=n*(2-f),o[0]+=d,o[1]+=n;break;case 2:d=n*(f-2),o[1]+=n,o[2]+=d;break;case 3:d=n*(4-f),o[1]+=d,o[2]+=n;break;case 4:d=n*(f-4),o[2]+=n,o[0]+=d;break;case 5:d=n*(6-f),o[2]+=d,o[0]+=n;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function Rd(e,t){if(t===0)return e;var r=dF(fF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),X0(hF(r))}var c_=6,xF=15,mF=1,ha=c_;function $0(e){return Math.floor((e+Math.round(128/ha)/256)*ha)}function Y0(e){return Math.floor((e-5)/ha*100+.5)/100}function Dd(e){return Math.round((e*ha+5)/ha*256)/256}function Gm(e){return Dd(Y0($0(e)))}function Ug(e){var t=Math.abs(e-Gm(e)),r=ha;if(t>.005)for(ha=mF;ha<xF;++ha)Math.abs(e-Gm(e))<=t&&(t=Math.abs(e-Gm(e)),r=ha);ha=r}function Ui(e){e.width?(e.wpx=$0(e.width),e.wch=Y0(e.wpx),e.MDW=ha):e.wpx?(e.wch=Y0(e.wpx),e.width=Dd(e.wch),e.MDW=ha):typeof e.wch=="number"&&(e.width=Dd(e.wch),e.wpx=$0(e.width),e.MDW=ha),e.customWidth&&delete e.customWidth}var pF=96,u_=pF;function K0(e){return e*96/u_}function sc(e){return e*u_/96}var gF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function vF(e,t,r,a){t.Borders=[];var n={},l=!1;(e[0].match(va)||[]).forEach(function(o){var f=nt(o);switch(ms(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},f.diagonalUp&&(n.diagonalUp=ar(f.diagonalUp)),f.diagonalDown&&(n.diagonalDown=ar(f.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function yF(e,t,r,a){t.Fills=[];var n={},l=!1;(e[0].match(va)||[]).forEach(function(o){var f=nt(o);switch(ms(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":f.patternType&&(n.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),f.indexed&&(n.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(n.bgColor.theme=parseInt(f.theme,10)),f.tint&&(n.bgColor.tint=parseFloat(f.tint)),f.rgb&&(n.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),f.theme&&(n.fgColor.theme=parseInt(f.theme,10)),f.tint&&(n.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(n.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function bF(e,t,r,a){t.Fonts=[];var n={},l=!1;(e[0].match(va)||[]).forEach(function(o){var f=nt(o);switch(ms(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":f.val&&(n.name=$t(f.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=f.val?ar(f.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=f.val?ar(f.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(f.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=f.val?ar(f.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=f.val?ar(f.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=f.val?ar(f.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=f.val?ar(f.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=f.val?ar(f.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":f.val&&(n.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(n.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(n.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(n.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=xg[parseInt(f.val,10)];break;case"<color":if(n.color||(n.color={}),f.auto&&(n.color.auto=ar(f.auto)),f.rgb)n.color.rgb=f.rgb.slice(-6);else if(f.indexed){n.color.index=parseInt(f.indexed,10);var d=Cl[n.color.index];n.color.index==81&&(d=Cl[1]),d||(d=Cl[1]),n.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else f.theme&&(n.color.theme=parseInt(f.theme,10),f.tint&&(n.color.tint=parseFloat(f.tint)),f.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Rd(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function wF(e,t,r){t.NumberFmt=[];for(var a=br(et),n=0;n<a.length;++n)t.NumberFmt[a[n]]=et[a[n]];var l=e[0].match(va);if(l)for(n=0;n<l.length;++n){var o=nt(l[n]);switch(ms(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=At($t(o.formatCode)),d=parseInt(o.numFmtId,10);if(t.NumberFmt[d]=f,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=f}zs(f,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function SF(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:a,formatCode:zt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Wf=["numFmtId","fillId","fontId","borderId","xfId"],Xf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function EF(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(va)||[]).forEach(function(l){var o=nt(l),f=0;switch(ms(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],f=0;f<Wf.length;++f)a[Wf[f]]&&(a[Wf[f]]=parseInt(a[Wf[f]],10));for(f=0;f<Xf.length;++f)a[Xf[f]]&&(a[Xf[f]]=ar(a[Xf[f]]));if(t.NumberFmt&&a.numFmtId>392){for(f=392;f>60;--f)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[f]){a.numFmtId=f;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};o.vertical&&(d.vertical=o.vertical),o.horizontal&&(d.horizontal=o.horizontal),o.textRotation!=null&&(d.textRotation=o.textRotation),o.indent&&(d.indent=o.indent),o.wrapText&&(d.wrapText=ar(o.wrapText)),a.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function _F(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var kF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,d,x){var m={};if(!f)return m;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=f.match(t))&&wF(p,m,x),(p=f.match(n))&&bF(p,m,d,x),(p=f.match(a))&&yF(p,m,d,x),(p=f.match(l))&&vF(p,m,d,x),(p=f.match(r))&&EF(p,m,x),m}}();function f_(e,t){var r=[Nr,Be("styleSheet",null,{xmlns:Hl[0],"xmlns:vt":Ur.vt})],a;return e.SSF&&(a=SF(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=_F(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function TF(e,t){var r=e.read_shift(2),a=pa(e);return[r,a]}function NF(e,t,r){r||(r=Ee(6+4*t.length)),r.write_shift(2,e),Kr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function CF(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=c8(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var f=e.read_shift(1);f>0&&(a.family=f);var d=e.read_shift(1);switch(d>0&&(a.charset=d),e.l++,a.color=o8(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=pa(e),a}function AF(e,t){t||(t=Ee(25+4*32)),t.write_shift(2,e.sz*20),u8(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Cd(e.color,t);var a=0;return a=2,t.write_shift(1,a),Kr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var jF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Vm,RF=ga;function Dw(e,t){t||(t=Ee(4*3+8*7+16*1)),Vm||(Vm=Kd(jF));var r=Vm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Cd({auto:1},t),Cd({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function DF(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function d_(e,t,r){r||(r=Ee(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function g0(e,t){return t||(t=Ee(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var FF=ga;function OF(e,t){return t||(t=Ee(51)),t.write_shift(1,0),g0(null,t),g0(null,t),g0(null,t),g0(null,t),g0(null,t),t.length>t.l?t.slice(0,t.l):t}function MF(e,t){return t||(t=Ee(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Nd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function LF(e,t,r){var a=Ee(2052);return a.write_shift(4,e),Nd(t,a),Nd(r,a),a.length>a.l?a.slice(0,a.l):a}function BF(e,t,r){var a={};a.NumberFmt=[];for(var n in et)a.NumberFmt[n]=et[n];a.CellXf=[],a.Fonts=[];var l=[],o=!1;return $s(e,function(d,x,m){switch(m){case 44:a.NumberFmt[d[0]]=d[1],zs(d[1],d[0]);break;case 43:a.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=Rd(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function PF(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(je(e,615,Gn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&je(e,44,NF(n,t[n]))}),je(e,616))}}function IF(e){var t=1;je(e,611,Gn(t)),je(e,43,AF({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function UF(e){var t=2;je(e,603,Gn(t)),je(e,45,Dw({patternType:"none"})),je(e,45,Dw({patternType:"gray125"})),je(e,604)}function zF(e){var t=1;je(e,613,Gn(t)),je(e,46,OF()),je(e,614)}function HF(e){var t=1;je(e,626,Gn(t)),je(e,47,d_({numFmtId:0},65535)),je(e,627)}function GF(e,t){je(e,617,Gn(t.length)),t.forEach(function(r){je(e,47,d_(r,0))}),je(e,618)}function VF(e){var t=1;je(e,619,Gn(t)),je(e,48,MF({xfId:0,name:"Normal"})),je(e,620)}function qF(e){var t=0;je(e,505,Gn(t)),je(e,506)}function WF(e){var t=0;je(e,508,LF(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function XF(e,t){var r=za();return je(r,278),PF(r,e.SSF),IF(r),UF(r),zF(r),HF(r),GF(r,t.cellXfs),VF(r),qF(r),WF(r),je(r,279),r.end()}var $F=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YF(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(va)||[]).forEach(function(n){var l=nt(n);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[$F.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function KF(){}function QF(){}var ZF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JF=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eO=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tO(e,t,r){t.themeElements={};var a;[["clrScheme",ZF,YF],["fontScheme",JF,KF],["fmtScheme",eO,QF]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var rO=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function h_(e,t){(!e||e.length===0)&&(e=zg());var r,a={};if(!(r=e.match(rO)))throw new Error("themeElements not found in theme");return tO(r[0],a,t),a.raw=e,a}function zg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Nr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aO(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var o;try{o=sE(l,{type:"array"})}catch{return}var f=en(o,"theme/theme/theme1.xml",!0);if(f)return h_(f,r)}}function nO(e){return e.read_shift(4)}function sO(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=iO(e,4);break;case 2:t.xclrValue=WE(e);break;case 3:t.xclrValue=nO(e);break;case 4:e.l+=4;break}return e.l+=8,t}function iO(e,t){return ga(e,t)}function lO(e,t){return ga(e,t)}function oO(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=sO(e);break;case 6:a[1]=lO(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function cO(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),l=[];n-- >0;)l.push(oO(e,r-e.l));return{ixfe:a,ext:l}}function uO(e,t){t.forEach(function(r){r[0]})}function fO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:pa(e)}}function dO(e){var t=Ee(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Kr(e.name,t),t.slice(0,t.l)}function hO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function xO(e){var t=Ee(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function mO(e,t){var r=Ee(8+2*t.length);return r.write_shift(4,e),Kr(t,r),r.slice(0,r.l)}function pO(e){return e.l+=4,e.read_shift(4)!=0}function gO(e,t){var r=Ee(8);return r.write_shift(4,e),r.write_shift(4,1),r}function vO(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},l=[],o=!1,f=2;return $s(e,function(d,x,m){switch(m){case 335:a.Types.push({name:d.name});break;case 51:d.forEach(function(p){f==1?a.Cell.push({type:a.Types[p[0]-1].name,index:p[1]}):f==0&&a.Value.push({type:a.Types[p[0]-1].name,index:p[1]})});break;case 337:f=d?1:0;break;case 338:f=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||n.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function yO(){var e=za();return je(e,332),je(e,334,Gn(1)),je(e,335,dO({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,mO(1,"XLDAPR")),je(e,52),je(e,35,Gn(514)),je(e,4096,Gn(0)),je(e,4097,Sn(1)),je(e,36),je(e,53),je(e,340),je(e,337,gO(1)),je(e,51,xO([[1,0]])),je(e,338),je(e,333),e.end()}function bO(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,l=2,o;return e.replace(va,function(f){var d=nt(f);switch(ms(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<a.Types.length;++x)a.Types[x].name==d.name&&(o=a.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[d.t-1].name,index:+d.v}):l==0&&a.Value.push({type:a.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+d.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return f}),a}function x_(){var e=[Nr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function wO(e){var t=[];if(!e)return t;var r=1;return(e.match(va)||[]).forEach(function(a){var n=nt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function SO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=rt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function EO(e,t,r){var a=[];return $s(e,function(l,o,f){switch(f){case 63:a.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function _O(e,t,r,a){if(!e)return e;var n=a||{},l=!1;$s(e,function(f,d,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!d.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},n)}function kO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Po=1024;function m_(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Be("xml",null,{"xmlns:v":Qa.v,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:mv":Qa.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Po<e*1e3;)Po+=1e3;return t.forEach(function(l){var o=fr(l[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var d=f.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Be("v:fill",d,f),m={on:"t",obscured:"t"};++Po,n=n.concat(["<v:shape"+V0({id:"_x0000_s"+Po,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Be("v:shadow",null,m),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ia("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ia("x:AutoFill","False"),ia("x:Row",String(o.r)),ia("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Fw(e,t,r,a){var n=Array.isArray(e),l;t.forEach(function(o){var f=fr(o.ref);if(n?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[o.ref],!l){l={t:"z"},n?e[f.r][f.c]=l:e[o.ref]=l;var d=jt(e["!ref"]||"BDWGO1000001:A1");d.s.r>f.r&&(d.s.r=f.r),d.e.r<f.r&&(d.e.r=f.r),d.s.c>f.c&&(d.s.c=f.c),d.e.c<f.c&&(d.e.c=f.c);var x=ht(d);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var p=l.c.length-1;p>=0;--p){if(!r&&l.c[p].T)return;r&&!l.c[p].T&&l.c.splice(p,1)}if(r&&a){for(p=0;p<a.length;++p)if(m.a==a[p].id){m.a=a[p].name||m.a;break}}l.c.push(m)})}function TO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&r.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?comment[^>]*>/);if(f){var d=nt(f[0]),x={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=fr(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var p=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!p&&!!p[1]&&Pg(p[1])||{r:"",t:"",h:""};x.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),x.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(x.h=v.h),a.push(x)}}}}),a}function p_(e){var t=[Nr,Be("comments",null,{xmlns:Hl[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var l=zt(n.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(n=r.indexOf(zt(d.a))),l.push(d.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),l.length<=1)t.push(ia("t",zt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,f=1;f<l.length;++f)o+=`Reply:
    `+l[f]+`
`;t.push(ia("t",zt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function NO(e,t){var r=[],a=!1,n={},l=0;return e.replace(va,function(f,d){var x=nt(f);switch(ms(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":l=d+f.length;break;case"</text>":n.t=e.slice(l,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return f}),r}function CO(e,t,r){var a=[Nr,Be("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var l="";(n[1]||[]).forEach(function(o,f){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};f==0?l=d.id:d.parentId=l,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Be("threadedComment",ia("text",o.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function AO(e,t){var r=[],a=!1;return e.replace(va,function(l){var o=nt(l);switch(ms(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function jO(e){var t=[Nr,Be("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Hl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function RO(e){var t={};t.iauthor=e.read_shift(4);var r=Wl(e);return t.rfx=r.s,t.ref=rt(r.s),e.l+=16,t}function DO(e,t){return t==null&&(t=Ee(36)),t.write_shift(4,e[1].iauthor),gc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var FO=pa;function OO(e){return Kr(e.slice(0,54))}function MO(e,t){var r=[],a=[],n={},l=!1;return $s(e,function(f,d,x){switch(x){case 632:a.push(f);break;case 635:n=f;break;case 637:n.t=f.t,n.h=f.h,n.r=f.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}function LO(e){var t=za(),r=[];return je(t,628),je(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),je(t,632,OO(n.a)))})}),je(t,631),je(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var l={s:fr(a[0]),e:fr(a[0])};je(t,635,DO([l,n])),n.t&&n.t.length>0&&je(t,637,n8(n)),je(t,636),delete n.iauthor})}),je(t,634),je(t,629),t.end()}var BO="application/vnd.ms-office.vbaProject";function PO(e){var t=$e.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$e.utils.cfb_add(t,n,e.FileIndex[a].content)}}),$e.write(t)}function IO(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&$e.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var g_=["xlsb","xlsm","xlam","biff8","xla"];function UO(){return{"!type":"dialog"}}function zO(){return{"!type":"dialog"}}function HO(){return{"!type":"macro"}}function GO(){return{"!type":"macro"}}var Ho=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,l,o){var f=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return f?m+=t.c:--m,d?x+=t.r:--x,n+(f?"":"$")+ur(m)+(d?"":"$")+kr(x)}return function(n,l){return t=l,n.replace(e,r)}}(),Hg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Gg=function(){return function(t,r){return t.replace(Hg,function(a,n,l,o,f,d){var x=Ag(o)-(l?0:r.c),m=Cg(d)-(f?0:r.r),p=m==0?"":f?m+1:"["+m+"]",v=x==0?"":l?x+1:"["+x+"]";return n+"R"+p+"C"+v})}}();function v_(e,t){return e.replace(Hg,function(r,a,n,l,o,f){return a+(n=="$"?n+l:ur(Ag(l)+t.c))+(o=="$"?o+f:kr(Cg(f)+t.r))})}function VO(e,t,r){var a=Ha(t),n=a.s,l=fr(r),o={r:l.r-n.r,c:l.c-n.c};return v_(e,o)}function qO(e){return e.length!=1}function Ow(e){return e.replace(/_xlfn\./g,"")}function Rr(e){e.l+=1}function zi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function y_(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return b_(e);r.biff==12&&(a=4)}var n=e.read_shift(a),l=e.read_shift(a),o=zi(e),f=zi(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function b_(e){var t=zi(e),r=zi(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function WO(e,t,r){if(r.biff<8)return b_(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),l=zi(e),o=zi(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function w_(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return XO(e);var a=e.read_shift(r&&r.biff==12?4:2),n=zi(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function XO(e){var t=zi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function $O(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YO(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return KO(e);var n=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;n>524287;)n-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:n,c:l,cRel:o,rRel:f}}function KO(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function QO(e,t,r){var a=(e[e.l++]&96)>>5,n=y_(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function ZO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=y_(e,l,r);return[a,n,o]}function JO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function e7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,n]}function t7(e,t,r){var a=(e[e.l++]&96)>>5,n=WO(e,t-1,r);return[a,n]}function r7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Mw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function a7(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],l=0;l<=a;++l)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function n7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function s7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function i7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function l7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function S_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function o7(e){return e.read_shift(2),S_(e)}function c7(e){return e.read_shift(2),S_(e)}function u7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=w_(e,0,r);return[a,n]}function f7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=YO(e,0,r);return[a,n]}function d7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=w_(e,0,r);return[a,n,l]}function h7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[pM[n],k_[n],a]}function x7(e,t,r){var a=e[e.l++],n=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:m7(e);return[n,(l[0]===0?k_:mM)[l[1]]]}function m7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function p7(e,t,r){e.l+=r&&r.biff==2?3:4}function g7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function v7(e){return e.l++,Ys[e.read_shift(1)]}function y7(e){return e.l++,e.read_shift(2)}function b7(e){return e.l++,e.read_shift(1)!==0}function w7(e){return e.l++,ma(e)}function S7(e,t,r){return e.l++,pu(e,t-1,r)}function E7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=_r(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ys[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ma(e);break;case 2:r[1]=Xl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _7(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],l=0;l!=a;++l)n.push((r.biff==12?Wl:Jd)(e));return n}function k7(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var f=0;f!=n;++f)o[l][f]=E7(e,r.biff);return o}function T7(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,l=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function N7(e,t,r){if(r.biff==5)return C7(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),l=e.read_shift(4);return[a,n,l]}function C7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function A7(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function j7(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function R7(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function D7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,n]}var F7=ga,O7=ga,M7=ga;function vu(e,t,r){return e.l+=2,[$O(e)]}function Vg(e){return e.l+=6,[]}var L7=vu,B7=Vg,P7=Vg,I7=vu;function E_(e){return e.l+=2,[Or(e),e.read_shift(2)&1]}var U7=vu,z7=E_,H7=Vg,G7=vu,V7=vu,q7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function W7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),l=e.read_shift(2),o=q7[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:l}}function X7(e){return e.l+=2,[e.read_shift(4)]}function $7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Y7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function K7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Q7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Z7(e){return e.l+=4,[0,0]}var Lw={1:{n:"PtgExp",f:g7},2:{n:"PtgTbl",f:M7},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:S7},26:{n:"PtgSheet",f:$7},27:{n:"PtgEndSheet",f:Y7},28:{n:"PtgErr",f:v7},29:{n:"PtgBool",f:b7},30:{n:"PtgInt",f:y7},31:{n:"PtgNum",f:w7},32:{n:"PtgArray",f:r7},33:{n:"PtgFunc",f:h7},34:{n:"PtgFuncVar",f:x7},35:{n:"PtgName",f:T7},36:{n:"PtgRef",f:u7},37:{n:"PtgArea",f:QO},38:{n:"PtgMemArea",f:A7},39:{n:"PtgMemErr",f:F7},40:{n:"PtgMemNoMem",f:O7},41:{n:"PtgMemFunc",f:j7},42:{n:"PtgRefErr",f:R7},43:{n:"PtgAreaErr",f:JO},44:{n:"PtgRefN",f:f7},45:{n:"PtgAreaN",f:t7},46:{n:"PtgMemAreaN",f:K7},47:{n:"PtgMemNoMemN",f:Q7},57:{n:"PtgNameX",f:N7},58:{n:"PtgRef3d",f:d7},59:{n:"PtgArea3d",f:ZO},60:{n:"PtgRefErr3d",f:D7},61:{n:"PtgAreaErr3d",f:e7},255:{}},J7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},eM={1:{n:"PtgElfLel",f:E_},2:{n:"PtgElfRw",f:G7},3:{n:"PtgElfCol",f:L7},6:{n:"PtgElfRwV",f:V7},7:{n:"PtgElfColV",f:I7},10:{n:"PtgElfRadical",f:U7},11:{n:"PtgElfRadicalS",f:H7},13:{n:"PtgElfColS",f:B7},15:{n:"PtgElfColSV",f:P7},16:{n:"PtgElfRadicalLel",f:z7},25:{n:"PtgList",f:W7},29:{n:"PtgSxName",f:X7},255:{}},tM={0:{n:"PtgAttrNoop",f:Z7},1:{n:"PtgAttrSemi",f:l7},2:{n:"PtgAttrIf",f:s7},4:{n:"PtgAttrChoose",f:a7},8:{n:"PtgAttrGoto",f:n7},16:{n:"PtgAttrSum",f:p7},32:{n:"PtgAttrBaxcel",f:Mw},33:{n:"PtgAttrBaxcel",f:Mw},64:{n:"PtgAttrSpace",f:o7},65:{n:"PtgAttrSpaceSemi",f:c7},128:{n:"PtgAttrIfError",f:i7},255:{}};function yu(e,t,r,a){if(a.biff<8)return ga(e,t);for(var n=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=k7(e,0,a),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=_7(e,r[o][1],a),l.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&l.push(ga(e,t)),l}function bu(e,t,r){for(var a=e.l+t,n,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],n=Lw[l]||Lw[J7[l]],(l===24||l===25)&&(n=(l===24?eM:tM)[e[e.l+1]]),!n||!n.f?ga(e,t):o.push([n.n,n.f(e,t,r)]);return o}function rM(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var aM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function __(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Bw(e,t,r){var a=__(e,t,r);return a=="#REF"?a:nM(a,r)}function da(e,t,r,a,n){var l=n&&n.biff||8,o={s:{c:0,r:0}},f=[],d,x,m,p=0,v=0,y,b="";if(!e[0]||!e[0][0])return"";for(var w=-1,E="",_=0,N=e[0].length;_<N;++_){var k=e[0][_];switch(k[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=f.pop(),x=f.pop(),w>=0){switch(e[0][w][1][0]){case 0:E=vr(" ",e[0][w][1][1]);break;case 1:E=vr("\r",e[0][w][1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}x=x+E,w=-1}f.push(x+aM[k[0]]+d);break;case"PtgIsect":d=f.pop(),x=f.pop(),f.push(x+" "+d);break;case"PtgUnion":d=f.pop(),x=f.pop(),f.push(x+","+d);break;case"PtgRange":d=f.pop(),x=f.pop(),f.push(x+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=T0(k[1][1],o,n),f.push(N0(m,l));break;case"PtgRefN":m=r?T0(k[1][1],r,n):k[1][1],f.push(N0(m,l));break;case"PtgRef3d":p=k[1][1],m=T0(k[1][2],o,n),b=Bw(a,p,n),f.push(b+"!"+N0(m,l));break;case"PtgFunc":case"PtgFuncVar":var F=k[1][0],j=k[1][1];F||(F=0),F&=127;var R=F==0?[]:f.slice(-F);f.length-=F,j==="User"&&(j=R.shift()),f.push(j+"("+R.join(",")+")");break;case"PtgBool":f.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(k[1]);break;case"PtgNum":f.push(String(k[1]));break;case"PtgStr":f.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(k[1]);break;case"PtgAreaN":y=dw(k[1][1],r?{s:r}:o,n),f.push(Um(y,n));break;case"PtgArea":y=dw(k[1][1],o,n),f.push(Um(y,n));break;case"PtgArea3d":p=k[1][1],y=k[1][2],b=Bw(a,p,n),f.push(b+"!"+Um(y,n));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=k[1][2];var T=(a.names||[])[v-1]||(a[0]||[])[v],C=T?T.Name:"SH33TJSNAME"+String(v);C&&C.slice(0,6)=="_xlfn."&&!n.xlfn&&(C=C.slice(6)),f.push(C);break;case"PtgNameX":var O=k[1][1];v=k[1][2];var V;if(n.biff<=5)O<0&&(O=-O),a[O]&&(V=a[O][v]);else{var z="";if(((a[O]||[])[0]||[])[0]==14849||(((a[O]||[])[0]||[])[0]==1025?a[O][v]&&a[O][v].itab>0&&(z=a.SheetNames[a[O][v].itab-1]+"!"):z=a.SheetNames[v-1]+"!"),a[O]&&a[O][v])z+=a[O][v].Name;else if(a[0]&&a[0][v])z+=a[0][v].Name;else{var H=(__(a,O,n)||"").split(";;");H[v-1]?z=H[v-1]:z+="SH33TJSERRX"}f.push(z);break}V||(V={Name:"SH33TJSERRY"}),f.push(V.Name);break;case"PtgParen":var ie="(",we=")";if(w>=0){switch(E="",e[0][w][1][0]){case 2:ie=vr(" ",e[0][w][1][1])+ie;break;case 3:ie=vr("\r",e[0][w][1][1])+ie;break;case 4:we=vr(" ",e[0][w][1][1])+we;break;case 5:we=vr("\r",e[0][w][1][1])+we;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}f.push(ie+f.pop()+we);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":m={c:k[1][1],r:k[1][0]};var ge={c:r.c,r:r.r};if(a.sharedf[rt(m)]){var ee=a.sharedf[rt(m)];f.push(da(ee,o,ge,a,n))}else{var le=!1;for(d=0;d!=a.arrayf.length;++d)if(x=a.arrayf[d],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){f.push(da(x[1],o,ge,a,n)),le=!0;break}le||f.push(k[1])}break;case"PtgArray":f.push("{"+rM(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&w>=0&&ne.indexOf(e[0][_][0])==-1){k=e[0][w];var te=!0;switch(k[1][0]){case 4:te=!1;case 0:E=vr(" ",k[1][1]);break;case 5:te=!1;case 1:E=vr("\r",k[1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}f.push((te?E:"")+f.pop()+(te?"":E)),w=-1}}if(f.length>1&&n.WTF)throw new Error("bad formula stack");return f[0]}function sM(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],ga(e,t-2)];var f=bu(e,o,r);return t!==o+n&&(l=yu(e,t-o-n,f,r)),e.l=a,[f,l]}function iM(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],ga(e,t-2)];var f=bu(e,o,r);return t!==o+n&&(l=yu(e,t-o-n,f,r)),e.l=a,[f,l]}function lM(e,t,r,a){var n=e.l+t,l=bu(e,a,r),o;return n!==e.l&&(o=yu(e,n-e.l,l,r)),[l,o]}function oM(e,t,r){var a=e.l+t,n,l=e.read_shift(2),o=bu(e,l,r);return l==65535?[[],ga(e,t-2)]:(t!==l+2&&(n=yu(e,a-l-2,o,r)),[o,n])}function cM(e){var t;if(Ps(e,e.l+6)!==65535)return[ma(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function uM(e){if(e==null){var t=Ee(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Bl(e);return Bl(0)}function qm(e,t,r){var a=e.l+t,n=ps(e);r.biff==2&&++e.l;var l=cM(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var f=iM(e,a-e.l,r);return{cell:n,val:l[0],formula:f,shared:o>>3&1,tt:l[1]}}function fM(e,t,r,a,n){var l=Il(t,r,n),o=uM(e.v),f=Ee(6),d=33;f.write_shift(2,d),f.write_shift(4,0);for(var x=Ee(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var p=Yr([l,o,f,x]);return p}function eh(e,t,r){var a=e.read_shift(4),n=bu(e,a,r),l=e.read_shift(4),o=l>0?yu(e,l,n,r):null;return[n,o]}var dM=eh,th=eh,hM=eh,xM=eh,mM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},k_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Pw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gM(e){var t="of:="+e.replace(Hg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Wm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function vM(e){return e.replace(/\./,"!")}var A0={},Go={},j0=typeof Map<"u";function qg(e,t,r){var a=0,n=e.length;if(r){if(j0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=j0?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(j0?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function rh(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ha=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Y0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Dd(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Rl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Wi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,l=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){zs(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=l;++n)if(e[n].numFmtId===a)return n;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function T_(e,t,r,a,n,l){try{a.cellNF&&(e.z=et[t])}catch(f){if(a.WTF)throw f}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(et[t]==null&&zs(mj[t]||"General",t),e.t==="e")e.w=e.w||Ys[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=H0(e.v);else if(e.t==="d"){var o=zr(e.v);(o|0)===o?e.w=o.toString(10):e.w=H0(o)}else{if(e.v===void 0)return"";e.w=Ml(e.v,Go)}else e.t==="d"?e.w=kn(t,zr(e.v),Go):e.w=kn(t,e.v,Go)}catch(f){if(a.WTF)throw f}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Rd(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Rd(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(a.WTF&&l.Fills)throw f}}}function yM(e,t,r){if(e&&e["!ref"]){var a=jt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function bM(e,t){var r=jt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ht(r))}var wM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,SM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,EM=/<(?:\w:)?hyperlink [^>]*>/mg,_M=/"(\w*:\w*)"/,kM=/<(?:\w:)?col\b[^>]*[\/]?>/g,TM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,NM=/<(?:\w:)?pageMargins[^>]*\/>/g,N_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,CM=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,AM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function jM(e,t,r,a,n,l,o){if(!e)return e;a||(a={"!id":{}});var f=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",p=e.match(SM);p?(x=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):x=m=e;var v=x.match(N_);v?Wg(v[0],f,n,r):(v=x.match(CM))&&DM(v[0],v[1]||"",f,n,r);var y=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var b=x.slice(y,y+50).match(_M);b&&bM(f,b[1])}var w=x.match(AM);w&&w[1]&&qM(w[1],n);var E=[];if(t.cellStyles){var _=x.match(kM);_&&UM(E,_)}p&&$M(p[1],f,t,d,l,o);var N=m.match(TM);N&&(f["!autofilter"]=HM(N[0]));var k=[],F=m.match(wM);if(F)for(y=0;y!=F.length;++y)k[y]=jt(F[y].slice(F[y].indexOf('"')+1));var j=m.match(EM);j&&BM(f,j,a);var R=m.match(NM);if(R&&(f["!margins"]=PM(nt(R[0]))),!f["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(f["!ref"]=ht(d)),t.sheetRows>0&&f["!ref"]){var T=jt(f["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>d.e.r&&(T.e.r=d.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>d.e.c&&(T.e.c=d.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),f["!fullref"]=f["!ref"],f["!ref"]=ht(T))}return E.length>0&&(f["!cols"]=E),k.length>0&&(f["!merges"]=k),f}function RM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ht(e[r])+'"/>';return t+"</mergeCells>"}function Wg(e,t,r,a){var n=nt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=At($t(n.codeName)))}function DM(e,t,r,a,n){Wg(e.slice(0,e.indexOf(">")),r,a,n)}function FM(e,t,r,a,n){var l=!1,o={},f=null;if(a.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}l=!0,o.codeName=hs(zt(d))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),f=(f||"")+Be("outlinePr",null,x)}!l&&!f||(n[n.length]=Be("sheetPr",f,o))}var OM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],MM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LM(e){var t={sheet:1};return OM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),MM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Ig(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function BM(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var l=nt($t(t[n]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+At(l.location))):(l.Target="#"+At(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=jt(l.ref),d=f.s.r;d<=f.e.r;++d)for(var x=f.s.c;x<=f.e.c;++x){var m=rt({c:x,r:d});a?(e[d]||(e[d]=[]),e[d][x]||(e[d][x]={t:"z",v:void 0}),e[d][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function PM(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function IM(e){return Rl(e),Be("pageMargins",null,e)}function UM(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=nt(t[a],!0);n.hidden&&(n.hidden=ar(n.hidden));var l=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Ug(n.width)),Ui(n);l<=o;)e[l++]=sr(n)}}function zM(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Be("col",null,rh(n,a)));return r[r.length]="</cols>",r.join("")}function HM(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function GM(e,t,r,a){var n=typeof e.ref=="string"?e.ref:ht(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Ha(n);o.s.r==o.e.r&&(o.e.r=Ha(t["!ref"]).e.r,n=ht(o));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Be("autoFilter",null,{ref:n})}var VM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qM(e,t){t.Views||(t.Views=[{}]),(e.match(VM)||[]).forEach(function(r,a){var n=nt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),ar(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function WM(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,n),{})}function XM(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Ys[e.v];break;case"d":a&&a.cellDates?n=nr(e.v,-1).toISOString():(e=sr(e),e.t="n",n=""+(e.v=zr(nr(e.v)))),typeof e.z>"u"&&(e.z=et[14]);break;default:n=e.v;break}var f=ia("v",zt(n)),d={r:t},x=Wi(a.cellXfs,e,a);switch(x!==0&&(d.s=x),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){f=ia("v",""+qg(a.Strings,e.v,a.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Be("f",zt(e.f),m)+(e.v!=null?f:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Be("c",f,d)}var $M=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,l=G0("v"),o=G0("f");return function(d,x,m,p,v,y){for(var b=0,w="",E=[],_=[],N=0,k=0,F=0,j="",R,T,C=0,O=0,V,z,H=0,ie=0,we=Array.isArray(y.CellXf),ge,ee=[],le=[],ne=Array.isArray(x),te=[],I={},Z=!1,L=!!m.sheetStubs,P=d.split(t),U=0,Y=P.length;U!=Y;++U){w=P[U].trim();var re=w.length;if(re!==0){var ve=0;e:for(b=0;b<re;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(T=nt(w.slice(ve,b),!0),C=T.r!=null?parseInt(T.r,10):C+1,O=-1,m.sheetRows&&m.sheetRows<C)continue;I={},Z=!1,T.ht&&(Z=!0,I.hpt=parseFloat(T.ht),I.hpx=sc(I.hpt)),T.hidden=="1"&&(Z=!0,I.hidden=!0),T.outlineLevel!=null&&(Z=!0,I.level=+T.outlineLevel),Z&&(te[C-1]=I)}break;case"<":ve=b;break}if(ve>=b)break;if(T=nt(w.slice(ve,b),!0),C=T.r!=null?parseInt(T.r,10):C+1,O=-1,!(m.sheetRows&&m.sheetRows<C)){p.s.r>C-1&&(p.s.r=C-1),p.e.r<C-1&&(p.e.r=C-1),m&&m.cellStyles&&(I={},Z=!1,T.ht&&(Z=!0,I.hpt=parseFloat(T.ht),I.hpx=sc(I.hpt)),T.hidden=="1"&&(Z=!0,I.hidden=!0),T.outlineLevel!=null&&(Z=!0,I.level=+T.outlineLevel),Z&&(te[C-1]=I)),E=w.slice(b).split(e);for(var be=0;be!=E.length&&E[be].trim().charAt(0)=="<";++be);for(E=E.slice(be),b=0;b!=E.length;++b)if(w=E[b].trim(),w.length!==0){if(_=w.match(r),N=b,k=0,F=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,_!=null&&_.length===2){for(N=0,j=_[1],k=0;k!=j.length&&!((F=j.charCodeAt(k)-64)<1||F>26);++k)N=26*N+F;--N,O=N}else++O;for(k=0;k!=w.length&&w.charCodeAt(k)!==62;++k);if(++k,T=nt(w.slice(0,k),!0),T.r||(T.r=rt({r:C-1,c:O})),j=w.slice(k),R={t:""},(_=j.match(l))!=null&&_[1]!==""&&(R.v=At(_[1])),m.cellFormula){if((_=j.match(o))!=null&&_[1]!==""){if(R.f=At($t(_[1])).replace(/\r\n/g,`
`),m.xlfn||(R.f=Ow(R.f)),_[0].indexOf('t="array"')>-1)R.F=(j.match(n)||[])[1],R.F.indexOf(":")>-1&&ee.push([jt(R.F),R.F]);else if(_[0].indexOf('t="shared"')>-1){z=nt(_[0]);var Te=At($t(_[1]));m.xlfn||(Te=Ow(Te)),le[parseInt(z.si,10)]=[z,Te,T.r]}}else(_=j.match(/<f[^>]*\/>/))&&(z=nt(_[0]),le[z.si]&&(R.f=VO(le[z.si][1],le[z.si][2],T.r)));var Ae=fr(T.r);for(k=0;k<ee.length;++k)Ae.r>=ee[k][0].s.r&&Ae.r<=ee[k][0].e.r&&Ae.c>=ee[k][0].s.c&&Ae.c<=ee[k][0].e.c&&(R.F=ee[k][1])}if(T.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(L)R.t="z";else continue;else R.t=T.t||"n";switch(p.s.c>O&&(p.s.c=O),p.e.c<O&&(p.e.c=O),R.t){case"n":if(R.v==""||R.v==null){if(!L)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!L)continue;R.t="z"}else V=A0[parseInt(R.v,10)],R.v=V.t,R.r=V.r,m.cellHTML&&(R.h=V.h);break;case"str":R.t="s",R.v=R.v!=null?$t(R.v):"",m.cellHTML&&(R.h=_g(R.v));break;case"inlineStr":_=j.match(a),R.t="s",_!=null&&(V=Pg(_[1]))?(R.v=V.t,m.cellHTML&&(R.h=V.h)):R.v="";break;case"b":R.v=ar(R.v);break;case"d":m.cellDates?R.v=nr(R.v,1):(R.v=zr(nr(R.v,1)),R.t="n");break;case"e":(!m||m.cellText!==!1)&&(R.w=R.v),R.v=AE[R.v];break}if(H=ie=0,ge=null,we&&T.s!==void 0&&(ge=y.CellXf[T.s],ge!=null&&(ge.numFmtId!=null&&(H=ge.numFmtId),m.cellStyles&&ge.fillId!=null&&(ie=ge.fillId))),T_(R,H,ie,m,v,y),m.cellDates&&we&&R.t=="n"&&xc(et[H])&&(R.t="d",R.v=Zd(R.v)),T.cm&&m.xlmeta){var Ve=(m.xlmeta.Cell||[])[+T.cm-1];Ve&&Ve.type=="XLDAPR"&&(R.D=!0)}if(ne){var Q=fr(T.r);x[Q.r]||(x[Q.r]=[]),x[Q.r][Q.c]=R}else x[T.r]=R}}}}te.length>0&&(x["!rows"]=te)}}();function YM(e,t,r,a){var n=[],l=[],o=jt(e["!ref"]),f="",d,x="",m=[],p=0,v=0,y=e["!rows"],b=Array.isArray(e),w={r:x},E,_=-1;for(v=o.s.c;v<=o.e.c;++v)m[v]=ur(v);for(p=o.s.r;p<=o.e.r;++p){for(l=[],x=kr(p),v=o.s.c;v<=o.e.c;++v){d=m[v]+x;var N=b?(e[p]||[])[v]:e[d];N!==void 0&&(f=XM(N,d,e,t))!=null&&l.push(f)}(l.length>0||y&&y[p])&&(w={r:x},y&&y[p]&&(E=y[p],E.hidden&&(w.hidden=1),_=-1,E.hpx?_=K0(E.hpx):E.hpt&&(_=E.hpt),_>-1&&(w.ht=_,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),n[n.length]=Be("row",l.join(""),w))}if(y)for(;p<y.length;++p)y&&y[p]&&(w={r:p+1},E=y[p],E.hidden&&(w.hidden=1),_=-1,E.hpx?_=K0(E.hpx):E.hpt&&(_=E.hpt),_>-1&&(w.ht=_,w.customHeight=1),E.level&&(w.outlineLevel=E.level),n[n.length]=Be("row","",w));return n.join("")}function C_(e,t,r,a){var n=[Nr,Be("worksheet",null,{xmlns:Hl[0],"xmlns:r":Ur.r})],l=r.SheetNames[e],o=0,f="",d=r.Sheets[l];d==null&&(d={});var x=d["!ref"]||"A1",m=jt(x);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=ht(m)}a||(a={}),d["!comments"]=[];var p=[];FM(d,r,e,t,n),n[n.length]=Be("dimension",null,{ref:x}),n[n.length]=WM(d,t,e,r),t.sheetFormat&&(n[n.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=zM(d,d["!cols"])),n[o=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(f=YM(d,t),f.length>0&&(n[n.length]=f)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),d["!protect"]&&(n[n.length]=LM(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=GM(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=RM(d["!merges"]));var v=-1,y,b=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=Ut(a,-1,zt(w[1].Target).replace(/#.*$/,""),bt.HLINK),y["r:id"]="rId"+b),(v=w[1].Target.indexOf("#"))>-1&&(y.location=zt(w[1].Target.slice(v+1))),w[1].Tooltip&&(y.tooltip=zt(w[1].Tooltip)),n[n.length]=Be("hyperlink",null,y))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=IM(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ia("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:x}))),p.length>0&&(b=Ut(a,-1,"../drawings/drawing"+(e+1)+".xml",bt.DRAW),n[n.length]=Be("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=p),d["!comments"].length>0&&(b=Ut(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML),n[n.length]=Be("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function KM(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=n/20),r}function QM(e,t,r){var a=Ee(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;n.hpx?l=K0(n.hpx)*20:n.hpt&&(l=n.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var f=0,d=a.l;a.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var p=-1,v=-1,y=m<<10;y<m+1<<10;++y){x.c=y;var b=Array.isArray(r)?(r[x.r]||[])[x.c]:r[rt(x)];b&&(p<0&&(p=y),v=y)}p<0||(++f,a.write_shift(4,p),a.write_shift(4,v))}var w=a.l;return a.l=d,a.write_shift(4,f),a.l=w,a.length>a.l?a.slice(0,a.l):a}function ZM(e,t,r,a){var n=QM(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&je(e,0,n)}var JM=Wl,e9=gc;function t9(){}function r9(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=s8(e),r}function a9(e,t,r){r==null&&(r=Ee(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Cd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_E(e,r),r.slice(0,r.l)}function n9(e){var t=Cn(e);return[t]}function s9(e,t,r){return r==null&&(r=Ee(8)),Gl(t,r)}function i9(e){var t=Vl(e);return[t]}function l9(e,t,r){return r==null&&(r=Ee(4)),ql(t,r)}function o9(e){var t=Cn(e),r=e.read_shift(1);return[t,r,"b"]}function c9(e,t,r){return r==null&&(r=Ee(9)),Gl(t,r),r.write_shift(1,e.v?1:0),r}function u9(e){var t=Vl(e),r=e.read_shift(1);return[t,r,"b"]}function f9(e,t,r){return r==null&&(r=Ee(5)),ql(t,r),r.write_shift(1,e.v?1:0),r}function d9(e){var t=Cn(e),r=e.read_shift(1);return[t,r,"e"]}function h9(e,t,r){return r==null&&(r=Ee(9)),Gl(t,r),r.write_shift(1,e.v),r}function x9(e){var t=Vl(e),r=e.read_shift(1);return[t,r,"e"]}function m9(e,t,r){return r==null&&(r=Ee(8)),ql(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function p9(e){var t=Cn(e),r=e.read_shift(4);return[t,r,"s"]}function g9(e,t,r){return r==null&&(r=Ee(12)),Gl(t,r),r.write_shift(4,t.v),r}function v9(e){var t=Vl(e),r=e.read_shift(4);return[t,r,"s"]}function y9(e,t,r){return r==null&&(r=Ee(8)),ql(t,r),r.write_shift(4,t.v),r}function b9(e){var t=Cn(e),r=ma(e);return[t,r,"n"]}function w9(e,t,r){return r==null&&(r=Ee(16)),Gl(t,r),Bl(e.v,r),r}function A_(e){var t=Vl(e),r=ma(e);return[t,r,"n"]}function S9(e,t,r){return r==null&&(r=Ee(12)),ql(t,r),Bl(e.v,r),r}function E9(e){var t=Cn(e),r=Fg(e);return[t,r,"n"]}function _9(e,t,r){return r==null&&(r=Ee(12)),Gl(t,r),kE(e.v,r),r}function k9(e){var t=Vl(e),r=Fg(e);return[t,r,"n"]}function T9(e,t,r){return r==null&&(r=Ee(8)),ql(t,r),kE(e.v,r),r}function N9(e){var t=Cn(e),r=jg(e);return[t,r,"is"]}function C9(e){var t=Cn(e),r=pa(e);return[t,r,"str"]}function A9(e,t,r){return r==null&&(r=Ee(12+4*e.v.length)),Gl(t,r),Kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function j9(e){var t=Vl(e),r=pa(e);return[t,r,"str"]}function R9(e,t,r){return r==null&&(r=Ee(8+4*e.v.length)),ql(t,r),Kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function D9(e,t,r){var a=e.l+t,n=Cn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"b"];if(r.cellFormula){e.l+=2;var f=th(e,a-e.l,r);o[3]=da(f,null,n,r.supbooks,r)}else e.l=a;return o}function F9(e,t,r){var a=e.l+t,n=Cn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"e"];if(r.cellFormula){e.l+=2;var f=th(e,a-e.l,r);o[3]=da(f,null,n,r.supbooks,r)}else e.l=a;return o}function O9(e,t,r){var a=e.l+t,n=Cn(e);n.r=r["!row"];var l=ma(e),o=[n,l,"n"];if(r.cellFormula){e.l+=2;var f=th(e,a-e.l,r);o[3]=da(f,null,n,r.supbooks,r)}else e.l=a;return o}function M9(e,t,r){var a=e.l+t,n=Cn(e);n.r=r["!row"];var l=pa(e),o=[n,l,"str"];if(r.cellFormula){e.l+=2;var f=th(e,a-e.l,r);o[3]=da(f,null,n,r.supbooks,r)}else e.l=a;return o}var L9=Wl,B9=gc;function P9(e,t){return t==null&&(t=Ee(4)),t.write_shift(4,e),t}function I9(e,t){var r=e.l+t,a=Wl(e),n=Rg(e),l=pa(e),o=pa(e),f=pa(e);e.l=r;var d={rfx:a,relId:n,loc:l,display:f};return o&&(d.Tooltip=o),d}function U9(e,t){var r=Ee(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));gc({s:fr(e[0]),e:fr(e[0])},r),Dg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Kr(n||"",r),Kr(e[1].Tooltip||"",r),Kr("",r),r.slice(0,r.l)}function z9(){}function H9(e,t,r){var a=e.l+t,n=TE(e),l=e.read_shift(1),o=[n];if(o[2]=l,r.cellFormula){var f=dM(e,a-e.l,r);o[1]=f}else e.l=a;return o}function G9(e,t,r){var a=e.l+t,n=Wl(e),l=[n];if(r.cellFormula){var o=xM(e,a-e.l,r);l[1]=o,e.l=a}else e.l=a;return l}function V9(e,t,r){r==null&&(r=Ee(18));var a=rh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var j_=["left","right","top","bottom","header","footer"];function q9(e){var t={};return j_.forEach(function(r){t[r]=ma(e)}),t}function W9(e,t){return t==null&&(t=Ee(6*8)),Rl(e),j_.forEach(function(r){Bl(e[r],t)}),t}function X9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function $9(e,t,r){r==null&&(r=Ee(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Y9(e){var t=Ee(24);return t.write_shift(4,4),t.write_shift(4,1),gc(e,t),t}function K9(e,t){return t==null&&(t=Ee(16*4+2)),t.write_shift(2,e.password?Ig(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Q9(){}function Z9(){}function J9(e,t,r,a,n,l,o){if(!e)return e;var f=t||{};a||(a={"!id":{}});var d=f.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,v=!1,y,b,w,E,_,N,k,F,j,R=[];f.biff=12,f["!row"]=0;var T=0,C=!1,O=[],V={},z=f.supbooks||n.supbooks||[[]];if(z.sharedf=V,z.arrayf=O,z.SheetNames=n.SheetNames||n.Sheets.map(function(ne){return ne.name}),!f.supbooks&&(f.supbooks=z,n.Names))for(var H=0;H<n.Names.length;++H)z[0][H+1]=n.Names[H];var ie=[],we=[],ge=!1;Q0[16]={n:"BrtShortReal",f:A_};var ee;if($s(e,function(te,I,Z){if(!v)switch(Z){case 148:x=te;break;case 0:y=te,f.sheetRows&&f.sheetRows<=y.r&&(v=!0),F=kr(E=y.r),f["!row"]=y.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=sc(te.hpt)),we[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:te[2]},te[2]){case"n":b.v=te[1];break;case"s":k=A0[te[1]],b.v=k.t,b.r=k.r;break;case"b":b.v=!!te[1];break;case"e":b.v=te[1],f.cellText!==!1&&(b.w=Ys[b.v]);break;case"str":b.t="s",b.v=te[1];break;case"is":b.t="s",b.v=te[1].t;break}if((w=o.CellXf[te[0].iStyleRef])&&T_(b,w.numFmtId,null,f,l,o),_=te[0].c==-1?_+1:te[0].c,f.dense?(d[E]||(d[E]=[]),d[E][_]=b):d[ur(_)+F]=b,f.cellFormula){for(C=!1,T=0;T<O.length;++T){var L=O[T];y.r>=L[0].s.r&&y.r<=L[0].e.r&&_>=L[0].s.c&&_<=L[0].e.c&&(b.F=ht(L[0]),C=!0)}!C&&te.length>3&&(b.f=te[3])}if(m.s.r>y.r&&(m.s.r=y.r),m.s.c>_&&(m.s.c=_),m.e.r<y.r&&(m.e.r=y.r),m.e.c<_&&(m.e.c=_),f.cellDates&&w&&b.t=="n"&&xc(et[w.numFmtId])){var P=xl(b.v);P&&(b.t="d",b.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}ee&&(ee.type=="XLDAPR"&&(b.D=!0),ee=void 0);break;case 1:case 12:if(!f.sheetStubs||p)break;b={t:"z",v:void 0},_=te[0].c==-1?_+1:te[0].c,f.dense?(d[E]||(d[E]=[]),d[E][_]=b):d[ur(_)+F]=b,m.s.r>y.r&&(m.s.r=y.r),m.s.c>_&&(m.s.c=_),m.e.r<y.r&&(m.e.r=y.r),m.e.c<_&&(m.e.c=_),ee&&(ee.type=="XLDAPR"&&(b.D=!0),ee=void 0);break;case 176:R.push(te);break;case 49:ee=((f.xlmeta||{}).Cell||[])[te-1];break;case 494:var U=a["!id"][te.relId];for(U?(te.Target=U.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=U):te.relId==""&&(te.Target="#"+te.loc),E=te.rfx.s.r;E<=te.rfx.e.r;++E)for(_=te.rfx.s.c;_<=te.rfx.e.c;++_)f.dense?(d[E]||(d[E]=[]),d[E][_]||(d[E][_]={t:"z",v:void 0}),d[E][_].l=te):(N=rt({c:_,r:E}),d[N]||(d[N]={t:"z",v:void 0}),d[N].l=te);break;case 426:if(!f.cellFormula)break;O.push(te),j=f.dense?d[E][_]:d[ur(_)+F],j.f=da(te[1],m,{r:y.r,c:_},z,f),j.F=ht(te[0]);break;case 427:if(!f.cellFormula)break;V[rt(te[0].s)]=te[1],j=f.dense?d[E][_]:d[ur(_)+F],j.f=da(te[1],m,{r:y.r,c:_},z,f);break;case 60:if(!f.cellStyles)break;for(;te.e>=te.s;)ie[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},ge||(ge=!0,Ug(te.w/256)),Ui(ie[te.e+1]);break;case 161:d["!autofilter"]={ref:ht(te)};break;case 476:d["!margins"]=te;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),te.name&&(n.Sheets[r].CodeName=te.name),(te.above||te.left)&&(d["!outline"]={above:te.above,left:te.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),te.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!I.T){if(!p||f.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},f),delete f.supbooks,delete f["!row"],!d["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(d["!ref"]=ht(x||m)),f.sheetRows&&d["!ref"]){var le=jt(d["!ref"]);f.sheetRows<=+le.e.r&&(le.e.r=f.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),d["!fullref"]=d["!ref"],d["!ref"]=ht(le))}return R.length>0&&(d["!merges"]=R),ie.length>0&&(d["!cols"]=ie),we.length>0&&(d["!rows"]=we),d}function eL(e,t,r,a,n,l,o){if(t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=sr(t),t.z=t.z||et[14],t.v=zr(nr(t.v)),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}var d={r,c:a};switch(d.s=Wi(n.cellXfs,t,n),t.l&&l["!links"].push([rt(d),t.l]),t.c&&l["!comments"].push([rt(d),t.c]),t.t){case"s":case"str":return n.bookSST?(f=qg(n.Strings,t.v,n.revStrings),d.t="s",d.v=f,o?je(e,18,y9(t,d)):je(e,7,g9(t,d))):(d.t="str",o?je(e,17,R9(t,d)):je(e,6,A9(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?je(e,13,T9(t,d)):je(e,2,_9(t,d)):o?je(e,16,S9(t,d)):je(e,5,w9(t,d)),!0;case"b":return d.t="b",o?je(e,15,f9(t,d)):je(e,4,c9(t,d)),!0;case"e":return d.t="e",o?je(e,14,m9(t,d)):je(e,3,h9(t,d)),!0}return o?je(e,12,l9(t,d)):je(e,1,s9(t,d)),!0}function tL(e,t,r,a){var n=jt(t["!ref"]||"A1"),l,o="",f=[];je(e,145);var d=Array.isArray(t),x=n.e.r;t["!rows"]&&(x=Math.max(n.e.r,t["!rows"].length-1));for(var m=n.s.r;m<=x;++m){o=kr(m),ZM(e,t,n,m);var p=!1;if(m<=n.e.r)for(var v=n.s.c;v<=n.e.c;++v){m===n.s.r&&(f[v]=ur(v)),l=f[v]+o;var y=d?(t[m]||[])[v]:t[l];if(!y){p=!1;continue}p=eL(e,y,m,v,a,t,p)}}je(e,146)}function rL(e,t){!t||!t["!merges"]||(je(e,177,P9(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,B9(r))}),je(e,178))}function aL(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,a){r&&je(e,60,V9(a,r))}),je(e,391))}function nL(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,Y9(jt(t["!ref"]))),je(e,650))}function sL(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Ut(r,-1,a[1].Target.replace(/#.*$/,""),bt.HLINK);je(e,494,U9(a,n))}}),delete t["!links"]}function iL(e,t,r,a){if(t["!comments"].length>0){var n=Ut(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);je(e,551,Dg("rId"+n)),t["!legacy"]=n}}function lL(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],l=typeof n.ref=="string"?n.ref:ht(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,f=Ha(l);f.s.r==f.e.r&&(f.e.r=Ha(t["!ref"]).e.r,l=ht(f));for(var d=0;d<o.length;++d){var x=o[d];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==a){x.Ref="'"+r.SheetNames[a]+"'!"+l;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),je(e,161,gc(jt(l))),je(e,162)}}function oL(e,t,r){je(e,133),je(e,137,$9(t,r)),je(e,138),je(e,134)}function cL(e,t){t["!protect"]&&je(e,535,K9(t["!protect"]))}function uL(e,t,r,a){var n=za(),l=r.SheetNames[e],o=r.Sheets[l]||{},f=l;try{r&&r.Workbook&&(f=r.Workbook.Sheets[e].CodeName||f)}catch{}var d=jt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],je(n,129),(r.vbaraw||o["!outline"])&&je(n,147,a9(f,o["!outline"])),je(n,148,e9(d)),oL(n,o,r.Workbook),aL(n,o),tL(n,o,e,t),cL(n,o),lL(n,o,r,e),rL(n,o),sL(n,o,a),o["!margins"]&&je(n,476,W9(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&nL(n,o),iL(n,o,e,a),je(n,130),n.end()}function fL(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,n,a]}function dL(e,t,r,a,n,l){var o=l||{"!type":"chart"};if(!e)return l;var f=0,d=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var v=fL(p);m.s.r=m.s.c=0,m.e.c=f,x=ur(f),v[0].forEach(function(y,b){o[x+kr(b)]={t:"n",v:y,z:v[1]},d=b}),m.e.r<d&&(m.e.r=d),++f}),f>0&&(o["!ref"]=ht(m)),o}function hL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,f=e.match(N_);return f&&Wg(f[0],l,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function xL(e,t){e.l+=10;var r=pa(e);return{name:r}}function mL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return $s(e,function(d,x,m){switch(m){case 550:l["!rel"]=d;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),d.name&&(n.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Xg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gL=[],vL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Iw(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var l=t[n];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=ar(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function Uw(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=ar(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function R_(e){Uw(e.WBProps,Xg),Uw(e.CalcPr,vL),Iw(e.WBView,pL),Iw(e.Sheets,gL),Go.date1904=ar(e.WBProps.date1904)}function yL(e){return!e.Workbook||!e.Workbook.WBProps?"false":ar(e.Workbook.WBProps.date1904)?"true":"false"}var bL="][*?/\\".split("");function D_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bL.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function wL(e,t,r){e.forEach(function(a,n){D_(a);for(var l=0;l<n;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function SL(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];wL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)yM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var EL=/<\w+:workbook/;function _L(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",l={},o=0;if(e.replace(va,function(d,x){var m=nt(d);switch(ms(m[0])){case"<?xml":break;case"<workbook":d.match(EL)&&(n="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Xg.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=ar(m[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:r.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(r.WBProps.CodeName=$t(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=At($t(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=$t(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),ar(m.hidden||"0")&&(l.Hidden=!0),o=x+d.length;break;case"</definedName>":l.Ref=At($t(e.slice(o,x))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),Hl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return R_(r),r}function F_(e){var t=[Nr];t[t.length]=Be("workbook",null,{xmlns:Hl[0],"xmlns:r":Ur.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Xg.forEach(function(f){e.Workbook.WBProps[f[0]]!=null&&e.Workbook.WBProps[f[0]]!=f[1]&&(a[f[0]]=e.Workbook.WBProps[f[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Be("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],l=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!n[l]||!n[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:zt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),n[l])switch(n[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Be("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(f){var d={name:f.Name};f.Comment&&(d.comment=f.Comment),f.Sheet!=null&&(d.localSheetId=""+f.Sheet),f.Hidden&&(d.hidden="1"),f.Ref&&(t[t.length]=Be("definedName",zt(f.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function kL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dp(e),r.name=pa(e),r}function TL(e,t){return t||(t=Ee(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Dg(e.strRelID,t),Kr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function NL(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?pa(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function CL(e,t){t||(t=Ee(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_E(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function AL(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function jL(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),l=i8(e),o=hM(e,0,r),f=Rg(e);e.l=a;var d={Name:l,Ptg:o};return n<268435455&&(d.Sheet=n),f&&(d.Comment=f),d}function RL(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],Q0[16]={n:"BrtFRTArchID$",f:AL},$s(e,function(d,x,m){switch(m){case 156:o.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=da(d.Ptg,null,null,o,t),delete t.SID,delete d.Ptg,l.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,d]):o[0]=[m,d],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(d),o.XTI=o.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!x.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),R_(r),r.Names=l,r.supbooks=o,r}function DL(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,TL(n))}je(e,144)}function FL(e,t){t||(t=Ee(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Kr("SheetJS",t),Kr(wd.version,t),Kr(wd.version,t),Kr("7262",t),t.length>t.l?t.slice(0,t.l):t}function OL(e,t){t||(t=Ee(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ML(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&l==-1&&(l=a);l>n||(je(e,135),je(e,158,OL(n)),je(e,136))}}function LL(e,t){var r=za();return je(r,131),je(r,128,FL()),je(r,153,CL(e.Workbook&&e.Workbook.WBProps||null)),ML(r,e),DL(r,e),je(r,132),r.end()}function BL(e,t,r){return t.slice(-4)===".bin"?RL(e,r):_L(e,r)}function PL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?J9(e,a,r,n,l,o,f):jM(e,a,r,n,l,o,f)}function IL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?mL(e,a,r,n,l):hL(e,a,r,n,l)}function UL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?HO():GO()}function zL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?UO():zO()}function HL(e,t,r,a){return t.slice(-4)===".bin"?BF(e,r,a):kF(e,r,a)}function GL(e,t,r){return h_(e,r)}function VL(e,t,r){return t.slice(-4)===".bin"?VD(e,r):zD(e,r)}function qL(e,t,r){return t.slice(-4)===".bin"?MO(e,r):TO(e,r)}function WL(e,t,r){return t.slice(-4)===".bin"?EO(e):wO(e)}function XL(e,t,r,a){return r.slice(-4)===".bin"?_O(e,t,r,a):void 0}function $L(e,t,r){return t.slice(-4)===".bin"?vO(e,t,r):bO(e,t,r)}function YL(e,t,r){return(t.slice(-4)===".bin"?LL:F_)(e)}function KL(e,t,r,a,n){return(t.slice(-4)===".bin"?uL:C_)(e,r,a,n)}function QL(e,t,r){return(t.slice(-4)===".bin"?XF:f_)(e,r)}function ZL(e,t,r){return(t.slice(-4)===".bin"?XD:a_)(e,r)}function JL(e,t,r){return(t.slice(-4)===".bin"?LO:p_)(e)}function eB(e){return(e.slice(-4)===".bin"?yO:x_)()}var O_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,M_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(O_),l,o,f,d;if(n)for(d=0;d!=n.length;++d)l=n[d].match(M_),(o=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(o+1),a[f]=l[2].slice(1,l[2].length-1));return a}function tB(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(O_),n,l,o,f;if(a)for(f=0;f!=a.length;++f)n=a[f].match(M_),(l=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(l+1),r[o]=n[2].slice(1,n[2].length-1));return r}var R0;function rB(e,t){var r=R0[e]||At(e);return r==="General"?Ml(t):kn(r,t)}function aB(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=ar(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=nr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[At(t)]=n}function nB(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ys[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=H0(e.v):e.w=Ml(e.v):e.w=rB(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=R0[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&xc(a)){var n=xl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(l){if(r.WTF)throw l}}}function sB(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=gF[a.Pattern]||a.Pattern)}e[t.ID]=t}function iB(e,t,r,a,n,l,o,f,d,x){var m="General",p=a.StyleID,v={};x=x||{};var y=[],b=0;for(p===void 0&&f&&(p=f.StyleID),p===void 0&&o&&(p=o.StyleID);l[p]!==void 0&&(l[p].nf&&(m=l[p].nf),l[p].Interior&&y.push(l[p].Interior),!!l[p].Parent);)p=l[p].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=ar(e);break;case"String":a.t="s",a.r=aw(At(e)),a.v=e.indexOf("<")>-1?At(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(nr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=At(e):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=AE[e],x.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=aw(t||e));break}if(nB(a,m,x),x.cellFormula!==!1)if(a.Formula){var w=At(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=Ho(w,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Ho("RC:RC",n):a.ArrayRange&&(a.F=Ho(a.ArrayRange,n),d.push([jt(a.F),a.F]))}else for(b=0;b<d.length;++b)n.r>=d[b][0].s.r&&n.r<=d[b][0].e.r&&n.c>=d[b][0].s.c&&n.c<=d[b][0].e.c&&(a.F=d[b][1]);x.cellStyles&&(y.forEach(function(E){!v.patternType&&E.patternType&&(v.patternType=E.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function lB(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Xm(e,t){var r=t||{};mc();var a=S0(kg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=$t(a));var n=a.slice(0,1024).toLowerCase(),l=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=sr(r);return o.type="string",nc.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ot){n.indexOf("<"+Ot)>=0&&(l=!0)}),l)return WB(a,r);R0={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,d=[],x,m={},p=[],v=r.dense?[]:{},y="",b={},w={},E=Mn('<Data ss:Type="String">'),_=0,N=0,k=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},R={},T="",C=0,O=[],V={},z={},H=0,ie=[],we=[],ge={},ee=[],le,ne=!1,te=[],I=[],Z={},L=0,P=0,U={Sheets:[],WBProps:{date1904:!1}},Y={};q0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";f=q0.exec(a);)switch(f[3]=(re=f[3]).toLowerCase()){case"data":if(re=="data"){if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break}if(d[d.length-1][1])break;f[1]==="/"?iB(a.slice(_,f.index),T,E,d[d.length-1][0]=="comment"?ge:b,{c:N,r:k},j,ee[N],w,te,r):(T="",E=Mn(f[0]),_=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(we.length>0&&(b.c=we),(!r.sheetRows||r.sheetRows>k)&&b.v!==void 0&&(r.dense?(v[k]||(v[k]=[]),v[k][N]=b):v[ur(N)+kr(k)]=b),b.HRef&&(b.l={Target:At(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(L=N+(parseInt(b.MergeAcross,10)|0),P=k+(parseInt(b.MergeDown,10)|0),O.push({s:{c:N,r:k},e:{c:L,r:P}})),!r.sheetStubs)b.MergeAcross?N=L+1:++N;else if(b.MergeAcross||b.MergeDown){for(var ve=N;ve<=L;++ve)for(var be=k;be<=P;++be)(ve>N||be>k)&&(r.dense?(v[be]||(v[be]=[]),v[be][ve]={t:"z"}):v[ur(ve)+kr(be)]={t:"z"});N=L+1}else++N;else b=tB(f[0]),b.Index&&(N=+b.Index-1),N<F.s.c&&(F.s.c=N),N>F.e.c&&(F.e.c=N),f[0].slice(-2)==="/>"&&++N,we=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(k<F.s.r&&(F.s.r=k),k>F.e.r&&(F.e.r=k),f[0].slice(-2)==="/>"&&(w=Mn(f[0]),w.Index&&(k=+w.Index-1)),N=0,++k):(w=Mn(f[0]),w.Index&&(k=+w.Index-1),Z={},(w.AutoFitHeight=="0"||w.Height)&&(Z.hpx=parseInt(w.Height,10),Z.hpt=K0(Z.hpx),I[k]=Z),w.Hidden=="1"&&(Z.hidden=!0,I[k]=Z));break;case"worksheet":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"));p.push(y),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(v["!ref"]=ht(F),r.sheetRows&&r.sheetRows<=F.e.r&&(v["!fullref"]=v["!ref"],F.e.r=r.sheetRows-1,v["!ref"]=ht(F))),O.length&&(v["!merges"]=O),ee.length>0&&(v["!cols"]=ee),I.length>0&&(v["!rows"]=I),m[y]=v}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=N=0,d.push([f[3],!1]),x=Mn(f[0]),y=At(x.Name),v=r.dense?[]:{},O=[],te=[],I=[],Y={name:y,Hidden:0},U.Sheets.push(Y);break;case"table":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else{if(f[0].slice(-2)=="/>")break;d.push([f[3],!1]),ee=[],ne=!1}break;case"style":f[1]==="/"?sB(j,R,r):R=Mn(f[0]);break;case"numberformat":R.nf=At(Mn(f[0]).Format||"General"),R0[R.nf]&&(R.nf=R0[R.nf]);for(var Te=0;Te!=392&&et[Te]!=R.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(et[Te]==null){zs(R.nf,Te);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(le=Mn(f[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!ne&&le.wpx>10){ne=!0,ha=c_;for(var Ae=0;Ae<ee.length;++Ae)ee[Ae]&&Ui(ee[Ae])}ne&&Ui(le),ee[le.Index-1||ee.length]=le;for(var Ve=0;Ve<+le.Span;++Ve)ee[ee.length]=sr(le);break;case"namedrange":if(f[1]==="/")break;U.Names||(U.Names=[]);var Q=nt(f[0]),st={Name:Q.Name,Ref:Ho(Q.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(st.Sheet=U.Sheets.length-1),U.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?T+=a.slice(C,f.index):C=f.index+f[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=Mn(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?R8(V,re,a.slice(H,f.index)):H=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else d.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"));lB(ge),we.push(ge)}else d.push([f[3],!1]),x=Mn(f[0]),ge={a:x.Author};break;case"autofilter":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var it=Mn(f[0]);v["!autofilter"]={ref:Ho(it.Range).replace(/\$/g,"")},d.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"null":break;default:if(d.length==0&&f[3]=="document"||d.length==0&&f[3]=="uof")return qw(a,r);var Qe=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Qe=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Qe=!1}break;case"excelworkbook":switch(f[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Qe=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:Qe=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(a.slice(H,f.index)){case"SheetHidden":Y.Hidden=1;break;case"SheetVeryHidden":Y.Hidden=2;break}else H=f.index+f[0].length;break;case"header":v["!margins"]||Rl(v["!margins"]={},"xlml"),isNaN(+nt(f[0]).Margin)||(v["!margins"].header=+nt(f[0]).Margin);break;case"footer":v["!margins"]||Rl(v["!margins"]={},"xlml"),isNaN(+nt(f[0]).Margin)||(v["!margins"].footer=+nt(f[0]).Margin);break;case"pagemargins":var tt=nt(f[0]);v["!margins"]||Rl(v["!margins"]={},"xlml"),isNaN(+tt.Top)||(v["!margins"].top=+tt.Top),isNaN(+tt.Left)||(v["!margins"].left=+tt.Left),isNaN(+tt.Right)||(v["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(v["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Qe=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Qe=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Qe=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Qe=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Qe=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Qe=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Qe=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Qe=!1}break;case"smarttags":break;default:Qe=!1;break}if(Qe||f[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?aB(z,re,ie,a.slice(H,f.index)):(ie=f,H=f.index+f[0].length);break}if(r.WTF)throw"Unrecognized tag: "+f[3]+"|"+d.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=m),De.SheetNames=p,De.Workbook=U,De.SSF=sr(et),De.Props=V,De.Custprops=z,De}function Ip(e,t){switch(Yg(t=t||{}),t.type||"base64"){case"base64":return Xm(rn(e),t);case"binary":case"buffer":case"file":return Xm(e,t);case"array":return Xm(Vi(e),t)}}function oB(e,t){var r=[];return e.Props&&r.push(D8(e.Props,t)),e.Custprops&&r.push(F8(e.Props,e.Custprops)),r.join("")}function cB(){return""}function uB(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var l=[];l.push(Be("NumberFormat",null,{"ss:Format":zt(et[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Be("Style",l.join(""),o))}),Be("Styles",r.join(""))}function L_(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Gg(e.Ref,{r:0,c:0})})}function fB(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(L_(n)))}return Be("Names",r.join(""))}function dB(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,l=[],o=0;o<n.length;++o){var f=n[o];f.Sheet==r&&(f.Name.match(/^_xlfn\./)||l.push(L_(f)))}return l.join("")}function hB(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Be("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ia("ProtectContents","True")),e["!protect"].objects&&n.push(ia("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ia("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ia("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ia("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Be("WorksheetOptions",n.join(""),{xmlns:Qa.x})}function xB(e){return e.map(function(t){var r=Mj(t.t||""),a=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",a,{"ss:Author":t.a})}).join("")}function mB(e,t,r,a,n,l,o){if(!e||e.v==null&&e.f==null)return"";var f={};if(e.f&&(f["ss:Formula"]="="+zt(Gg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=fr(e.F.slice(t.length+1));f["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(f["ss:HRef"]=zt(e.l.Target),e.l.Tooltip&&(f["x:HRefScreenTip"]=zt(e.l.Tooltip))),r["!merges"])for(var x=r["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(f["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(f["ss:MergeDown"]=x[m].e.r-x[m].s.r));var p="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":p="Number",v=String(e.v);break;case"b":p="Boolean",v=e.v?"1":"0";break;case"e":p="Error",v=Ys[e.v];break;case"d":p="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||et[14]);break;case"s":p="String",v=Oj(e.v||"");break}var y=Wi(a.cellXfs,e,a);f["ss:StyleID"]="s"+(21+y),f["ss:Index"]=o.c+1;var b=e.v!=null?v:"",w=e.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(e.c||[]).length>0&&(w+=xB(e.c)),Be("Cell",w,f)}function pB(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=sc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gB(e,t,r,a){if(!e["!ref"])return"";var n=jt(e["!ref"]),l=e["!merges"]||[],o=0,f=[];e["!cols"]&&e["!cols"].forEach(function(E,_){Ui(E);var N=!!E.width,k=rh(_,E),F={"ss:Index":_+1};N&&(F["ss:Width"]=$0(k.width)),E.hidden&&(F["ss:Hidden"]="1"),f.push(Be("Column",null,F))});for(var d=Array.isArray(e),x=n.s.r;x<=n.e.r;++x){for(var m=[pB(x,(e["!rows"]||[])[x])],p=n.s.c;p<=n.e.c;++p){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>p)&&!(l[o].s.r>x)&&!(l[o].e.c<p)&&!(l[o].e.r<x)){(l[o].s.c!=p||l[o].s.r!=x)&&(v=!0);break}if(!v){var y={r:x,c:p},b=rt(y),w=d?(e[x]||[])[p]:e[b];m.push(mB(w,b,e,t,r,a,y))}}m.push("</Row>"),m.length>2&&f.push(m.join(""))}return f.join("")}function vB(e,t,r){var a=[],n=r.SheetNames[e],l=r.Sheets[n],o=l?dB(l,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?gB(l,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(hB(l,t,e,r)),a.join("")}function yB(e,t){t||(t={}),e.SSF||(e.SSF=sr(et)),e.SSF&&(mc(),Yd(e.SSF),t.revssf=Qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(oB(e,t)),r.push(cB()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Be("Worksheet",vB(a,t,e),{"ss:Name":zt(e.SheetNames[a])}));return r[2]=uB(e,t),r[3]=fB(e),Nr+Be("Workbook",r.join(""),{xmlns:Qa.ss,"xmlns:o":Qa.o,"xmlns:x":Qa.x,"xmlns:ss":Qa.ss,"xmlns:dt":Qa.dt,"xmlns:html":Qa.html})}function bB(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=f8(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=d8(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var wB=[60,1084,2066,2165,2175];function SB(e,t,r,a,n){var l=a,o=[],f=r.slice(r.l,r.l+l);if(n&&n.enc&&n.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(f)}o.push(f),r.l+=l;for(var d=Ps(r,r.l),x=Up[d],m=0;x!=null&&wB.indexOf(d)>-1;)l=Ps(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),f=r.slice(m,r.l+4+l),o.push(f),r.l+=4+l,x=Up[d=Ps(r,r.l)];var p=Yr(o);sa(p,0);var v=0;p.lens=[];for(var y=0;y<o.length;++y)p.lens.push(v),v+=o[y].length;if(p.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+a;return t.f(p,p.length,n)}function ss(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=et[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ys[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=H0(e.v):e.w=Ml(e.v):e.w=kn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&xc(et[a]||String(a))){var n=xl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function $f(e,t,r){return{v:e,ixfe:t,t:r}}function EB(e,t){var r={opts:{}},a={},n=t.dense?[]:{},l={},o={},f=null,d=[],x="",m={},p,v="",y,b,w,E,_={},N=[],k,F,j=[],R=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},O=function(lt){return lt<8?Cl[lt]:lt<64&&R[lt-8]||Cl[lt]},V=function(lt,Ce,ut){var St=Ce.XF.data;if(!(!St||!St.patternType||!ut||!ut.cellStyles)){Ce.s={},Ce.s.patternType=St.patternType;var Mr;(Mr=X0(O(St.icvFore)))&&(Ce.s.fgColor={rgb:Mr}),(Mr=X0(O(St.icvBack)))&&(Ce.s.bgColor={rgb:Mr})}},z=function(lt,Ce,ut){if(!(Z>1)&&!(ut.sheetRows&&lt.r>=ut.sheetRows)){if(ut.cellStyles&&Ce.XF&&Ce.XF.data&&V(lt,Ce,ut),delete Ce.ixfe,delete Ce.XF,p=lt,v=rt(lt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<o.s.r&&(o.s.r=lt.r),lt.c<o.s.c&&(o.s.c=lt.c),lt.r+1>o.e.r&&(o.e.r=lt.r+1),lt.c+1>o.e.c&&(o.e.c=lt.c+1),ut.cellFormula&&Ce.f){for(var St=0;St<N.length;++St)if(!(N[St][0].s.c>lt.c||N[St][0].s.r>lt.r)&&!(N[St][0].e.c<lt.c||N[St][0].e.r<lt.r)){Ce.F=ht(N[St][0]),(N[St][0].s.c!=lt.c||N[St][0].s.r!=lt.r)&&delete Ce.f,Ce.f&&(Ce.f=""+da(N[St][1],o,lt,te,H));break}}ut.dense?(n[lt.r]||(n[lt.r]=[]),n[lt.r][lt.c]=Ce):n[v]=Ce}},H={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(H.password=t.password);var ie,we=[],ge=[],ee=[],le=[],ne=!1,te=[];te.SheetNames=H.snames,te.sharedf=H.sharedf,te.arrayf=H.arrayf,te.names=[],te.XTI=[];var I=0,Z=0,L=0,P=[],U=[],Y;H.codepage=1200,Un(1200);for(var re=!1;e.l<e.length-1;){var ve=e.l,be=e.read_shift(2);if(be===0&&I===10)break;var Te=e.l===e.length?0:e.read_shift(2),Ae=Up[be];if(Ae&&Ae.f){if(t.bookSheets&&I===133&&be!==133)break;if(I=be,Ae.r===2||Ae.r==12){var Ve=e.read_shift(2);if(Te-=2,!H.enc&&Ve!==be&&((Ve&255)<<8|Ve>>8)!==be)throw new Error("rt mismatch: "+Ve+"!="+be);Ae.r==12&&(e.l+=10,Te-=10)}var Q={};if(be===10?Q=Ae.f(e,Te,H):Q=SB(be,Ae,e,Te,H),Z==0&&[9,521,1033,2057].indexOf(I)===-1)continue;switch(be){case 34:r.opts.Date1904=T.WBProps.date1904=Q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(H.enc||(e.l=0),H.enc=Q,!t.password)throw new Error("File is password-protected");if(Q.valid==null)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=Q;break;case 66:var st=Number(Q);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}Un(H.codepage=st),re=!0;break;case 317:H.rrtabid=Q;break;case 25:H.winlocked=Q;break;case 439:r.opts.RefreshAll=Q;break;case 12:r.opts.CalcCount=Q;break;case 16:r.opts.CalcDelta=Q;break;case 17:r.opts.CalcIter=Q;break;case 13:r.opts.CalcMode=Q;break;case 14:r.opts.CalcPrecision=Q;break;case 95:r.opts.CalcSaveRecalc=Q;break;case 15:H.CalcRefMode=Q;break;case 2211:r.opts.FullCalc=Q;break;case 129:Q.fDialog&&(n["!type"]="dialog"),Q.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),Q.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:j.push(Q);break;case 430:te.push([Q]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(Q);break;case 24:case 536:Y={Name:Q.Name,Ref:da(Q.rgce,o,null,te,H)},Q.itab>0&&(Y.Sheet=Q.itab-1),te.names.push(Y),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(Q),Q.Name=="_xlnm._FilterDatabase"&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&Q.rgce[0][0][0]=="PtgArea3d"&&(U[Q.itab-1]={ref:ht(Q.rgce[0][0][1][2])});break;case 22:H.ExternCount=Q;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(Q),te.XTI=te.XTI.concat(Q);break;case 2196:if(H.biff<8)break;Y!=null&&(Y.Comment=Q[1]);break;case 18:n["!protect"]=Q;break;case 19:Q!==0&&H.WTF&&console.error("Password verifier: "+Q);break;case 133:l[Q.pos]=Q,H.snames.push(Q.name);break;case 10:{if(--Z)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=ht(o),t.sheetRows&&t.sheetRows<=o.e.r){var it=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ht(o),o.e.r=it}o.e.r++,o.e.c++}we.length>0&&(n["!merges"]=we),ge.length>0&&(n["!objects"]=ge),ee.length>0&&(n["!cols"]=ee),le.length>0&&(n["!rows"]=le),T.Sheets.push(C)}x===""?m=n:a[x]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),H.biffguess=Q.BIFFVer==0,Q.BIFFVer==0&&Q.dt==4096&&(H.biff=5,re=!0,Un(H.codepage=28591)),H.biff==8&&Q.BIFFVer==0&&Q.dt==16&&(H.biff=2),Z++)break;if(n=t.dense?[]:{},H.biff<8&&!re&&(re=!0,Un(H.codepage=t.codepage||1252)),H.biff<5||Q.BIFFVer==0&&Q.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Qe={pos:e.l-Te,name:x};l[Qe.pos]=Qe,H.snames.push(x)}else x=(l[ve]||{name:""}).name;Q.dt==32&&(n["!type"]="chart"),Q.dt==64&&(n["!type"]="macro"),we=[],ge=[],H.arrayf=N=[],ee=[],le=[],ne=!1,C={Hidden:(l[ve]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[Q.r]||[])[Q.c]:n[rt({c:Q.c,r:Q.r})])&&++Q.c,k={ixfe:Q.ixfe,XF:j[Q.ixfe]||{},v:Q.val,t:"n"},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t);break;case 5:case 517:k={ixfe:Q.ixfe,XF:j[Q.ixfe],v:Q.val,t:Q.t},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t);break;case 638:k={ixfe:Q.ixfe,XF:j[Q.ixfe],v:Q.rknum,t:"n"},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t);break;case 189:for(var tt=Q.c;tt<=Q.C;++tt){var De=Q.rkrec[tt-Q.c][0];k={ixfe:De,XF:j[De],v:Q.rkrec[tt-Q.c][1],t:"n"},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:tt,r:Q.r},k,t)}break;case 6:case 518:case 1030:{if(Q.val=="String"){f=Q;break}if(k=$f(Q.val,Q.cell.ixfe,Q.tt),k.XF=j[k.ixfe],t.cellFormula){var Ot=Q.formula;if(Ot&&Ot[0]&&Ot[0][0]&&Ot[0][0][0]=="PtgExp"){var dr=Ot[0][0][1][0],Zr=Ot[0][0][1][1],hr=rt({r:dr,c:Zr});_[hr]?k.f=""+da(Q.formula,o,Q.cell,te,H):k.F=((t.dense?(n[dr]||[])[Zr]:n[hr])||{}).F}else k.f=""+da(Q.formula,o,Q.cell,te,H)}L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z(Q.cell,k,t),f=Q}break;case 7:case 519:if(f)f.val=Q,k=$f(Q,f.cell.ixfe,"s"),k.XF=j[k.ixfe],t.cellFormula&&(k.f=""+da(f.formula,o,f.cell,te,H)),L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z(f.cell,k,t),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(Q);var An=rt(Q[0].s);if(y=t.dense?(n[Q[0].s.r]||[])[Q[0].s.c]:n[An],t.cellFormula&&y){if(!f||!An||!y)break;y.f=""+da(Q[1],o,Q[0],te,H),y.F=ht(Q[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!f)break;_[rt(f.cell)]=Q[0],y=t.dense?(n[f.cell.r]||[])[f.cell.c]:n[rt(f.cell)],(y||{}).f=""+da(Q[0],o,p,te,H)}}break;case 253:k=$f(d[Q.isst].t,Q.ixfe,"s"),d[Q.isst].h&&(k.h=d[Q.isst].h),k.XF=j[k.ixfe],L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t);break;case 513:t.sheetStubs&&(k={ixfe:Q.ixfe,XF:j[Q.ixfe],t:"z"},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t));break;case 190:if(t.sheetStubs)for(var ya=Q.c;ya<=Q.C;++ya){var xr=Q.ixfe[ya-Q.c];k={ixfe:xr,XF:j[xr],t:"z"},L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:ya,r:Q.r},k,t)}break;case 214:case 516:case 4:k=$f(Q.val,Q.ixfe,"s"),k.XF=j[k.ixfe],L>0&&(k.z=P[k.ixfe>>8&63]),ss(k,t,r.opts.Date1904),z({c:Q.c,r:Q.r},k,t);break;case 0:case 512:Z===1&&(o=Q);break;case 252:d=Q;break;case 1054:if(H.biff==4){P[L++]=Q[1];for(var Yt=0;Yt<L+163&&et[Yt]!=Q[1];++Yt);Yt>=163&&zs(Q[1],L+163)}else zs(Q[1],Q[0]);break;case 30:{P[L++]=Q;for(var Cr=0;Cr<L+163&&et[Cr]!=Q;++Cr);Cr>=163&&zs(Q,L+163)}break;case 229:we=we.concat(Q);break;case 93:ge[Q.cmo[0]]=H.lastobj=Q;break;case 438:H.lastobj.TxO=Q;break;case 127:H.lastobj.ImData=Q;break;case 440:for(E=Q[0].s.r;E<=Q[0].e.r;++E)for(w=Q[0].s.c;w<=Q[0].e.c;++w)y=t.dense?(n[E]||[])[w]:n[rt({c:w,r:E})],y&&(y.l=Q[1]);break;case 2048:for(E=Q[0].s.r;E<=Q[0].e.r;++E)for(w=Q[0].s.c;w<=Q[0].e.c;++w)y=t.dense?(n[E]||[])[w]:n[rt({c:w,r:E})],y&&y.l&&(y.l.Tooltip=Q[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;y=t.dense?(n[Q[0].r]||[])[Q[0].c]:n[rt(Q[0])];var or=ge[Q[2]];y||(t.dense?(n[Q[0].r]||(n[Q[0].r]=[]),y=n[Q[0].r][Q[0].c]={t:"z"}):y=n[rt(Q[0])]={t:"z"},o.e.r=Math.max(o.e.r,Q[0].r),o.s.r=Math.min(o.s.r,Q[0].r),o.e.c=Math.max(o.e.c,Q[0].c),o.s.c=Math.min(o.s.c,Q[0].c)),y.c||(y.c=[]),b={a:Q[1],t:or.TxO.t},y.c.push(b)}break;case 2173:uO(j[Q.ixfe],Q.ext);break;case 125:{if(!H.cellStyles)break;for(;Q.e>=Q.s;)ee[Q.e--]={width:Q.w/256,level:Q.level||0,hidden:!!(Q.flags&1)},ne||(ne=!0,Ug(Q.w/256)),Ui(ee[Q.e+1])}break;case 520:{var Nt={};Q.level!=null&&(le[Q.r]=Nt,Nt.level=Q.level),Q.hidden&&(le[Q.r]=Nt,Nt.hidden=!0),Q.hpt&&(le[Q.r]=Nt,Nt.hpt=Q.hpt,Nt.hpx=sc(Q.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Rl(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=Q;break;case 161:n["!margins"]||Rl(n["!margins"]={}),n["!margins"].header=Q.header,n["!margins"].footer=Q.footer;break;case 574:Q.RTL&&(T.Views[0].RTL=!0);break;case 146:R=Q;break;case 2198:ie=Q;break;case 140:F=Q;break;case 442:x?C.CodeName=Q||C.name:T.WBProps.CodeName=Q||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+be.toString(16)),e.l+=Te}return r.SheetNames=br(l).sort(function(Mt,lt){return Number(Mt)-Number(lt)}).map(function(Mt){return l[Mt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&U.forEach(function(Mt,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=Mt}),r.Strings=d,r.SSF=sr(et),H.enc&&(r.Encryption=H.enc),ie&&(r.Themes=ie),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),te.names.length>0&&(T.Names=te.names),r.Workbook=T,r}var D0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _B(e,t,r){var a=$e.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=ww(a,Fp,D0.DSI);for(var l in n)t[l]=n[l]}catch(x){if(r.WTF)throw x}var o=$e.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var f=ww(o,Op,D0.SI);for(var d in f)t[d]==null&&(t[d]=f[d])}catch(x){if(r.WTF)throw x}t.HeadingPairs&&t.TitlesOfParts&&(ME(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function kB(e,t){var r=[],a=[],n=[],l=0,o,f=Qb(Fp,"n"),d=Qb(Op,"n");if(e.Props)for(o=br(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(d,o[l])?a:n).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=br(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(d,o[l])?a:n).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<n.length;++l)HE.indexOf(n[l][0])>-1||OE.indexOf(n[l][0])>-1||n[l][1]!=null&&x.push(n[l]);a.length&&$e.utils.cfb_add(t,"/SummaryInformation",Sw(a,D0.SI,d,Op)),(r.length||x.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",Sw(r,D0.DSI,f,Fp,x.length?x:null,D0.UDI))}function B_(e,t){t||(t={}),Yg(t),pg(),t.codepage&&mg(t.codepage);var r,a;if(e.FullPaths){if($e.find(e,"/encryption"))throw new Error("File is password-protected");r=$e.find(e,"!CompObj"),a=$e.find(e,"/Workbook")||$e.find(e,"/Book")}else{switch(t.type){case"base64":e=Ja(rn(e));break;case"binary":e=Ja(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}sa(e,0),a={content:e}}var n,l;if(r&&bB(r),t.bookProps&&!t.bookSheets)n={};else{var o=vt?"buffer":"array";if(a&&a.content)n=EB(a.content,t);else if((l=$e.find(e,"PerfectOffice_MAIN"))&&l.content)n=jl.to_workbook(l.content,(t.type=o,t));else if((l=$e.find(e,"NativeContent_MAIN"))&&l.content)n=jl.to_workbook(l.content,(t.type=o,t));else throw(l=$e.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$e.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=PO(e))}var f={};return e.FullPaths&&_B(e,f,t),n.Props=n.Custprops=f,t.bookFiles&&(n.cfb=e),n}function TB(e,t){var r=t||{},a=$e.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(a,n,P_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&kB(e,a),r.biff==8&&e.vbaraw&&IO(a,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Q0={0:{f:KM},1:{f:n9},2:{f:E9},3:{f:d9},4:{f:o9},5:{f:b9},6:{f:C9},7:{f:p9},8:{f:M9},9:{f:O9},10:{f:D9},11:{f:F9},12:{f:i9},13:{f:k9},14:{f:x9},15:{f:u9},16:{f:A_},17:{f:j9},18:{f:v9},19:{f:jg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jL},40:{},42:{},43:{f:CF},44:{f:TF},45:{f:RF},46:{f:FF},47:{f:DF},48:{},49:{f:Jj},50:{},51:{f:hO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:JE},62:{f:N9},63:{f:SO},64:{f:Q9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ga,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:r9},148:{f:JM,p:16},151:{f:z9},152:{},153:{f:NL},154:{},155:{},156:{f:kL},157:{},158:{},159:{T:1,f:GD},160:{T:-1},161:{T:1,f:Wl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:L9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fO},336:{T:-1},337:{f:pO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:H9},427:{f:G9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:q9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:t9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:I9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FO},633:{T:1},634:{T:-1},635:{T:1,f:RO},636:{T:-1},637:{f:a8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:xL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Z9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Up={6:{f:qm},10:{f:bi},12:{f:Or},13:{f:Or},14:{f:_r},15:{f:_r},16:{f:ma},17:{f:_r},18:{f:_r},19:{f:Or},20:{f:Cw},21:{f:Cw},23:{f:ZE},24:{f:jw},25:{f:_r},26:{},27:{},28:{f:ZR},29:{},34:{f:_r},35:{f:Aw},38:{f:ma},39:{f:ma},40:{f:ma},41:{f:ma},42:{f:_r},43:{f:_r},47:{f:uF},49:{f:kR},51:{f:Or},60:{},61:{f:bR},64:{f:_r},65:{f:_R},66:{f:Or},77:{},80:{},81:{},82:{},85:{f:Or},89:{},90:{},91:{},92:{f:cR},93:{f:tD},94:{},95:{f:_r},96:{},97:{},99:{f:_r},125:{f:JE},128:{f:UR},129:{f:fR},130:{f:Or},131:{f:_r},132:{f:_r},133:{f:dR},134:{},140:{f:cD},141:{f:Or},144:{},146:{f:dD},151:{},152:{},153:{},154:{},155:{},156:{f:Or},157:{},158:{},160:{f:yD},161:{f:mD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:LR},190:{f:BR},193:{f:bi},197:{},198:{},199:{},200:{},201:{},202:{f:_r},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Or},220:{},221:{f:_r},222:{},224:{f:IR},225:{f:oR},226:{f:bi},227:{},229:{f:JR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:xR},253:{f:NR},255:{f:pR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:GE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:_r},353:{f:bi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:qR},431:{f:_r},432:{},433:{},434:{},437:{},438:{f:nD},439:{f:_r},440:{f:sD},441:{},442:{f:gu},443:{},444:{f:Or},445:{},446:{},448:{f:bi},449:{f:yR,r:2},450:{f:bi},512:{f:kw},513:{f:vD},515:{f:GR},516:{f:AR},517:{f:Nw},519:{f:bD},520:{f:gR},523:{},545:{f:Rw},549:{f:_w},566:{},574:{f:SR},638:{f:MR},659:{},1048:{},1054:{f:RR},1084:{},1212:{f:YR},2048:{f:lD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:hD,r:12},2173:{f:cO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:_r,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$R,r:12},2197:{},2198:{f:aO,r:12},2199:{},2200:{},2201:{},2202:{f:KR,r:12},2203:{f:bi},2204:{},2205:{},2206:{},2207:{},2211:{f:vR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:pD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:fD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:kw},1:{},2:{f:kD},3:{f:ED},4:{f:SD},5:{f:Nw},7:{f:ND},8:{},9:{f:qf},11:{},22:{f:Or},30:{f:FR},31:{},32:{},33:{f:Rw},36:{},37:{f:_w},50:{f:CD},62:{},52:{},67:{},68:{f:Or},69:{},86:{},126:{},127:{f:wD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:AD},223:{},234:{},354:{},421:{},518:{f:qm},521:{f:qf},536:{f:jw},547:{f:Aw},561:{},579:{},1030:{f:qm},1033:{f:qf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pe(e,t,r,a){var n=t;if(!isNaN(n)){var l=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,l),l>0&&Ng(r)&&e.push(r)}}function NB(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Pe(e,t,r,n);var l=t;if(!isNaN(l)){for(var o=r.parts||[],f=0,d=0,x=0;x+(o[f]||8224)<=8224;)x+=o[f]||8224,f++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(r.slice(d,d+x)),d+=x;d<n;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[f]||8224)<=8224;)x+=o[f]||8224,f++;m.write_shift(2,x),e.push(r.slice(d,d+x)),d+=x}}}function wu(e,t,r){return e||(e=Ee(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function CB(e,t,r,a){var n=Ee(9);return wu(n,e,t),VE(r,a||"b",n),n}function AB(e,t,r){var a=Ee(8+2*r.length);return wu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function jB(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?zr(nr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Pe(e,2,TD(r,a,n)):Pe(e,3,_D(r,a,n));return;case"b":case"e":Pe(e,5,CB(r,a,t.v,t.t));return;case"s":case"str":Pe(e,4,AB(r,a,(t.v||"").slice(0,255)));return}Pe(e,1,wu(null,r,a))}function RB(e,t,r,a){var n=Array.isArray(t),l=jt(t["!ref"]||"A1"),o,f="",d=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=ht(l)}for(var x=l.s.r;x<=l.e.r;++x){f=kr(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(d[m]=ur(m)),o=d[m]+f;var p=n?(t[x]||[])[m]:t[o];p&&jB(e,p,x,m)}}}function DB(e,t){for(var r=t||{},a=za(),n=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(n=l);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Pe(a,r.biff==4?1033:r.biff==3?521:9,Bg(e,16,r)),RB(a,e.Sheets[e.SheetNames[n]],n,r),Pe(a,10),a.end()}function FB(e,t,r){Pe(e,49,TR({sz:12,name:"Arial"},r))}function OB(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Pe(e,1054,DR(n,t[n],r))})}function MB(e,t){var r=Ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Pe(e,2151,r),r=Ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),YE(jt(t["!ref"]||"A1"),r),r.write_shift(4,4),Pe(e,2152,r)}function LB(e,t){for(var r=0;r<16;++r)Pe(e,224,Tw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Pe(e,224,Tw(a,0,t))})}function BB(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Pe(e,440,iD(a)),a[1].Tooltip&&Pe(e,2048,oD(a))}delete t["!links"]}function PB(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Pe(e,125,xD(rh(n,a),n))})}}function IB(e,t,r,a,n){var l=16+Wi(n.cellXfs,t,n);if(t.v==null&&!t.bf){Pe(e,513,Il(r,a,l));return}if(t.bf)Pe(e,6,fM(t,r,a,n,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?zr(nr(t.v)):t.v;Pe(e,515,VR(r,a,o,l));break;case"b":case"e":Pe(e,517,HR(r,a,t.v,l,n,t.t));break;case"s":case"str":if(n.bookSST){var f=qg(n.Strings,t.v,n.revStrings);Pe(e,253,CR(r,a,f,l))}else Pe(e,516,jR(r,a,(t.v||"").slice(0,255),l,n));break;default:Pe(e,513,Il(r,a,l))}}function UB(e,t,r){var a=za(),n=r.SheetNames[e],l=r.Sheets[n]||{},o=(r||{}).Workbook||{},f=(o.Sheets||[])[e]||{},d=Array.isArray(l),x=t.biff==8,m,p="",v=[],y=jt(l["!ref"]||"A1"),b=x?65536:16384;if(y.e.c>255||y.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,b-1)}Pe(a,2057,Bg(r,16,t)),Pe(a,13,Sn(1)),Pe(a,12,Sn(100)),Pe(a,15,Ta(!0)),Pe(a,17,Ta(!1)),Pe(a,16,Bl(.001)),Pe(a,95,Ta(!0)),Pe(a,42,Ta(!1)),Pe(a,43,Ta(!1)),Pe(a,130,Sn(1)),Pe(a,128,zR()),Pe(a,131,Ta(!1)),Pe(a,132,Ta(!1)),x&&PB(a,l["!cols"]),Pe(a,512,OR(y,t)),x&&(l["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){p=kr(w);for(var E=y.s.c;E<=y.e.c;++E){w===y.s.r&&(v[E]=ur(E)),m=v[E]+p;var _=d?(l[w]||[])[E]:l[m];_&&(IB(a,_,w,E,t),x&&_.l&&l["!links"].push([m,_.l]))}}var N=f.CodeName||f.name||n;return x&&Pe(a,574,ER((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Pe(a,229,eD(l["!merges"])),x&&BB(a,l),Pe(a,442,qE(N)),x&&MB(a,l),Pe(a,10),a.end()}function zB(e,t,r){var a=za(),n=(e||{}).Workbook||{},l=n.Sheets||[],o=n.WBProps||{},f=r.biff==8,d=r.biff==5;if(Pe(a,2057,Bg(e,5,r)),r.bookType=="xla"&&Pe(a,135),Pe(a,225,f?Sn(1200):null),Pe(a,193,H8(2)),d&&Pe(a,191),d&&Pe(a,192),Pe(a,226),Pe(a,92,uR("SheetJS",r)),Pe(a,66,Sn(f?1200:1252)),f&&Pe(a,353,Sn(0)),f&&Pe(a,448),Pe(a,317,gD(e.SheetNames.length)),f&&e.vbaraw&&Pe(a,211),f&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Pe(a,442,qE(x))}Pe(a,156,Sn(17)),Pe(a,25,Ta(!1)),Pe(a,18,Ta(!1)),Pe(a,19,Sn(0)),f&&Pe(a,431,Ta(!1)),f&&Pe(a,444,Sn(0)),Pe(a,61,wR()),Pe(a,64,Ta(!1)),Pe(a,141,Sn(0)),Pe(a,34,Ta(yL(e)=="true")),Pe(a,14,Ta(!0)),f&&Pe(a,439,Ta(!1)),Pe(a,218,Sn(0)),FB(a,e,r),OB(a,e.SSF,r),LB(a,r),f&&Pe(a,352,Ta(!1));var m=a.end(),p=za();f&&Pe(p,140,uD()),f&&r.Strings&&NB(p,252,mR(r.Strings)),Pe(p,10);var v=p.end(),y=za(),b=0,w=0;for(w=0;w<e.SheetNames.length;++w)b+=(f?12:11)+(f?2:1)*e.SheetNames[w].length;var E=m.length+b+v.length;for(w=0;w<e.SheetNames.length;++w){var _=l[w]||{};Pe(y,133,hR({pos:E,hs:_.Hidden||0,dt:0,name:e.SheetNames[w]},r)),E+=t[w].length}var N=y.end();if(b!=N.length)throw new Error("BS8 "+b+" != "+N.length);var k=[];return m.length&&k.push(m),N.length&&k.push(N),v.length&&k.push(v),Yr(k)}function HB(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=sr(et)),e&&e.SSF&&(mc(),Yd(e.SSF),r.revssf=Qd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Kg(r),r.cellXfs=[],Wi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=UB(n,r,e);return a.unshift(zB(e,a,r)),Yr(a)}function P_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ha(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return HB(e,t);case 4:case 3:case 2:return DB(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function zw(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=n.index,f=l&&l.index||e.length,d=Tj(e.slice(o,f),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,p=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<d.length;++o){var w=d[o].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++x,r.sheetRows&&r.sheetRows<=x){--x;break}m=0;continue}if(!(E!="<td"&&E!="<th")){var _=w.split(/<\/t[dh]>/i);for(f=0;f<_.length;++f){var N=_[f].trim();if(N.match(/<t[dh]/i)){for(var k=N,F=0;k.charAt(0)=="<"&&(F=k.indexOf(">"))>-1;)k=k.slice(F+1);for(var j=0;j<b.length;++j){var R=b[j];R.s.c==m&&R.s.r<x&&x<=R.e.r&&(m=R.e.c+1,j=-1)}var T=nt(N.slice(0,N.indexOf(">")));v=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||v>1)&&b.push({s:{r:x,c:m},e:{r:x+(p||1)-1,c:m+v-1}});var C=T.t||T["data-t"]||"";if(!k.length){m+=v;continue}if(k=oE(k),y.s.r>x&&(y.s.r=x),y.e.r<x&&(y.e.r=x),y.s.c>m&&(y.s.c=m),y.e.c<m&&(y.e.c=m),!k.length){m+=v;continue}var O={t:"s",v:k};r.raw||!k.trim().length||C=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(Hn(k))?isNaN(ac(k).getDate())||(O={t:"d",v:nr(k)},r.cellDates||(O={t:"n",v:zr(O.v)}),O.z=r.dateNF||et[14]):O={t:"n",v:Hn(k)}),r.dense?(a[x]||(a[x]=[]),a[x][m]=O):a[rt({r:x,c:m})]=O,m+=v}}}}return a["!ref"]=ht(y),b.length&&(a["!merges"]=b),a}function GB(e,t,r,a){for(var n=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var f=0,d=0,x=0;x<n.length;++x)if(!(n[x].s.r>r||n[x].s.c>o)&&!(n[x].e.r<r||n[x].e.c<o)){if(n[x].s.r<r||n[x].s.c<o){f=-1;break}f=n[x].e.r-n[x].s.r+1,d=n[x].e.c-n[x].s.c+1;break}if(!(f<0)){var m=rt({r,c:o}),p=a.dense?(e[r]||[])[o]:e[m],v=p&&p.v!=null&&(p.h||_g(p.w||(qs(p),p.w)||""))||"",y={};f>1&&(y.rowspan=f),d>1&&(y.colspan=d),a.editable?v='<span contenteditable="true">'+v+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+p.l.Target+'">'+v+"</a>")),y.id=(a.id||"sjs")+"-"+m,l.push(Be("td",v,y))}}var b="<tr>";return b+l.join("")+"</tr>"}var VB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qB="</body></html>";function WB(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return qi(zw(r[0],t),t);var a=Jg();return r.forEach(function(n,l){e1(a,zw(n,t),"Sheet"+(l+1))}),a}function XB(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function I_(e,t){var r=t||{},a=r.header!=null?r.header:VB,n=r.footer!=null?r.footer:qB,l=[a],o=Ha(e["!ref"]);r.dense=Array.isArray(e),l.push(XB(e,o,r));for(var f=o.s.r;f<=o.e.r;++f)l.push(GB(e,o,f,r));return l.push("</table>"+n),l.join("")}function U_(e,t,r){var a=r||{},n=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?fr(a.origin):a.origin;n=o.r,l=o.c}var f=t.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,f.length),x={s:{r:0,c:0},e:{r:n,c:l}};if(e["!ref"]){var m=Ha(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),n==-1&&(x.e.r=n=m.e.r+1)}var p=[],v=0,y=e["!rows"]||(e["!rows"]=[]),b=0,w=0,E=0,_=0,N=0,k=0;for(e["!cols"]||(e["!cols"]=[]);b<f.length&&w<d;++b){var F=f[b];if(Hw(F)){if(a.display)continue;y[w]={hidden:!0}}var j=F.children;for(E=_=0;E<j.length;++E){var R=j[E];if(!(a.display&&Hw(R))){var T=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):oE(R.innerHTML),C=R.getAttribute("data-z")||R.getAttribute("z");for(v=0;v<p.length;++v){var O=p[v];O.s.c==_+l&&O.s.r<w+n&&w+n<=O.e.r&&(_=O.e.c+1-l,v=-1)}k=+R.getAttribute("colspan")||1,((N=+R.getAttribute("rowspan")||1)>1||k>1)&&p.push({s:{r:w+n,c:_+l},e:{r:w+n+(N||1)-1,c:_+l+(k||1)-1}});var V={t:"s",v:T},z=R.getAttribute("data-t")||R.getAttribute("t")||"";T!=null&&(T.length==0?V.t=z||"z":a.raw||T.trim().length==0||z=="s"||(T==="TRUE"?V={t:"b",v:!0}:T==="FALSE"?V={t:"b",v:!1}:isNaN(Hn(T))?isNaN(ac(T).getDate())||(V={t:"d",v:nr(T)},a.cellDates||(V={t:"n",v:zr(V.v)}),V.z=a.dateNF||et[14]):V={t:"n",v:Hn(T)})),V.z===void 0&&C!=null&&(V.z=C);var H="",ie=R.getElementsByTagName("A");if(ie&&ie.length)for(var we=0;we<ie.length&&!(ie[we].hasAttribute("href")&&(H=ie[we].getAttribute("href"),H.charAt(0)!="#"));++we);H&&H.charAt(0)!="#"&&(V.l={Target:H}),a.dense?(e[w+n]||(e[w+n]=[]),e[w+n][_+l]=V):e[rt({c:_+l,r:w+n})]=V,x.e.c<_+l&&(x.e.c=_+l),_+=k}}++w}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),x.e.r=Math.max(x.e.r,w-1+n),e["!ref"]=ht(x),w>=d&&(e["!fullref"]=ht((x.e.r=f.length-b+w-1+n,x))),e}function z_(e,t){var r=t||{},a=r.dense?[]:{};return U_(a,e,t)}function $B(e,t){return qi(z_(e,t),t)}function Hw(e){var t="",r=YB(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function YB(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function KB(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=At(t.replace(/<[^>]*>/g,""));return[r]}var Gw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function H_(e,t){var r=t||{},a=kg(e),n=[],l,o,f={name:""},d="",x=0,m,p,v={},y=[],b=r.dense?[]:{},w,E,_={value:""},N="",k=0,F=[],j=-1,R=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,O={},V=[],z={},H=0,ie=0,we=[],ge=1,ee=1,le=[],ne={Names:[]},te={},I=["",""],Z=[],L={},P="",U=0,Y=!1,re=!1,ve=0;for(q0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=q0.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?b["!ref"]=ht(T):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(b["!fullref"]=b["!ref"],T.e.r=r.sheetRows-1,b["!ref"]=ht(T)),V.length&&(b["!merges"]=V),we.length&&(b["!rows"]=we),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),y.push(m.name),v[m.name]=b,re=!1):w[0].charAt(w[0].length-2)!=="/"&&(m=nt(w[0],!1),j=R=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,b=r.dense?[]:{},V=[],we=[],re=!0);break;case"table-row-group":w[1]==="/"?--C:++C;break;case"table-row":case"":if(w[1]==="/"){j+=ge,ge=1;break}if(p=nt(w[0],!1),p.?j=p.-1:j==-1&&(j=0),ge=+p["number-rows-repeated"]||1,ge<10)for(ve=0;ve<ge;++ve)C>0&&(we[j+ve]={level:C});R=-1;break;case"covered-table-cell":w[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(b[j]||(b[j]=[]),b[j][R]={t:"z"}):b[rt({r:j,c:R})]={t:"z"}),N="",F=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++R,_=nt(w[0],!1),ee=parseInt(_["number-columns-repeated"]||"1",10),E={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(E.f=Pw(At(_.formula))),(_.||_["value-type"])=="string"&&(E.t="s",E.v=At(_["string-value"]||""),r.dense?(b[j]||(b[j]=[]),b[j][R]=E):b[rt({r:j,c:R})]=E),R+=ee-1;else if(w[1]!=="/"){++R,N="",k=0,F=[],ee=1;var be=ge?j+ge-1:j;if(R>T.e.c&&(T.e.c=R),R<T.s.c&&(T.s.c=R),j<T.s.r&&(T.s.r=j),be>T.e.r&&(T.e.r=be),_=nt(w[0],!1),Z=[],L={},E={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=At(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(H=parseInt(_["number-matrix-rows-spanned"],10)||0,ie=parseInt(_["number-matrix-columns-spanned"],10)||0,z={s:{r:j,c:R},e:{r:j+H-1,c:R+ie-1}},E.F=ht(z),le.push([z,E.F])),_.formula)E.f=Pw(_.formula);else for(ve=0;ve<le.length;++ve)j>=le[ve][0].s.r&&j<=le[ve][0].e.r&&R>=le[ve][0].s.c&&R<=le[ve][0].e.c&&(E.F=le[ve][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(H=parseInt(_["number-rows-spanned"],10)||0,ie=parseInt(_["number-columns-spanned"],10)||0,z={s:{r:j,c:R},e:{r:j+H-1,c:R+ie-1}},V.push(z)),_["number-columns-repeated"]&&(ee=parseInt(_["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ar(_["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(_.value);break;case"percentage":E.t="n",E.v=parseFloat(_.value);break;case"currency":E.t="n",E.v=parseFloat(_.value);break;case"date":E.t="d",E.v=nr(_["date-value"]),r.cellDates||(E.t="n",E.v=zr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=Ej(_["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Zd(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(_.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",_["string-value"]!=null&&(N=At(_["string-value"]),F=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Y=!1,E.t==="s"&&(E.v=N||"",F.length&&(E.R=F),Y=k==0),te.Target&&(E.l=te),Z.length>0&&(E.c=Z,Z=[]),N&&r.cellText!==!1&&(E.w=N),Y&&(E.t="z",delete E.v),(!Y||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Te=0;Te<ge;++Te){if(ee=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(b[j+Te]||(b[j+Te]=[]),b[j+Te][R]=Te==0?E:sr(E);--ee>0;)b[j+Te][R+ee]=sr(E);else for(b[rt({r:j+Te,c:R})]=E;--ee>0;)b[rt({r:j+Te,c:R+ee})]=sr(E);T.e.c<=R&&(T.e.c=R)}ee=parseInt(_["number-columns-repeated"]||"1",10),R+=ee-1,ee=0,E={},N="",F=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l;L.t=N,F.length&&(L.R=F),L.a=P,Z.push(L)}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);P="",U=0,N="",k=0,F=[];break;case"creator":w[1]==="/"?P=a.slice(U,w.index):U=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);N="",k=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(O[f.name]=d,(l=n.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(d="",f=nt(w[0],!1),n.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=nt(w[0],!1),d+=Gw[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=nt(w[0],!1),d+=Gw[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":d+=a.slice(x,w.index);break}else x=w.index+w[0].length;break;case"named-range":o=nt(w[0],!1),I=Wm(o["cell-range-address"]);var Ae={Name:o.name,Ref:I[0]+"!"+I[1]};re&&(Ae.Sheet=y.length),ne.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(w[1]==="/"&&(!_||!_["string-value"])){var Ve=KB(a.slice(k,w.index));N=(N.length>0?N+`
`:"")+Ve[0]}else nt(w[0],!1),k=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{I=Wm(nt(w[0])["target-range-address"]),v[I[0]]["!autofilter"]={ref:I[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(te=nt(w[0],!1),!te.href)break;te.Target=At(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(I=Wm(te.Target.slice(1)),te.Target="#"+I[0]+"!"+I[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var Q={Sheets:v,SheetNames:y,Workbook:ne};return r.bookSheets&&delete Q.Sheets,Q}function Vw(e,t){t=t||{},bn(e,"META-INF/manifest.xml")&&E8(Fr(e,"META-INF/manifest.xml"),t);var r=en(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=H_($t(r),t);return bn(e,"meta.xml")&&(a.Props=DE(Fr(e,"meta.xml"))),a}function qw(e,t){return H_(e,t)}var QB=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+V0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Nr+t}}(),Ww=function(){var e=function(l){return zt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,o,f){var d=[];d.push('      <table:table table:name="'+zt(o.SheetNames[f])+`" table:style-name="ta1">
`);var x=0,m=0,p=Ha(l["!ref"]||"A1"),v=l["!merges"]||[],y=0,b=Array.isArray(l);if(l["!cols"])for(m=0;m<=p.e.c;++m)d.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",E=l["!rows"]||[];for(x=0;x<p.s.r;++x)w=E[x]?' table:style-name="ro'+E[x].ods+'"':"",d.push("        <table:table-row"+w+`></table:table-row>
`);for(;x<=p.e.r;++x){for(w=E[x]?' table:style-name="ro'+E[x].ods+'"':"",d.push("        <table:table-row"+w+`>
`),m=0;m<p.s.c;++m)d.push(t);for(;m<=p.e.c;++m){var _=!1,N={},k="";for(y=0;y!=v.length;++y)if(!(v[y].s.c>m)&&!(v[y].s.r>x)&&!(v[y].e.c<m)&&!(v[y].e.r<x)){(v[y].s.c!=m||v[y].s.r!=x)&&(_=!0),N["table:number-columns-spanned"]=v[y].e.c-v[y].s.c+1,N["table:number-rows-spanned"]=v[y].e.r-v[y].s.r+1;break}if(_){d.push(r);continue}var F=rt({r:x,c:m}),j=b?(l[x]||[])[m]:l[F];if(j&&j.f&&(N["table:formula"]=zt(gM(j.f)),j.F&&j.F.slice(0,F.length)==F)){var R=Ha(j.F);N["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,N["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!j){d.push(t);continue}switch(j.t){case"b":k=j.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=j.v?"true":"false";break;case"n":k=j.w||String(j.v||0),N["office:value-type"]="float",N["office:value"]=j.v||0;break;case"s":case"str":k=j.v==null?"":j.v,N["office:value-type"]="string";break;case"d":k=j.w||nr(j.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=nr(j.v).toISOString(),N["table:style-name"]="ce1";break;default:d.push(t);continue}var T=e(k);if(j.l&&j.l.Target){var C=j.l.Target;C=C.charAt(0)=="#"?"#"+vM(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),T=Be("text:a",T,{"xlink:href":C.replace(/&/g,"&amp;")})}d.push("          "+Be("table:table-cell",Be("text:p",T,{}),N)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var f=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var p=x["!cols"][m];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Ui(p),p.ods=f;var v=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++f}}});var d=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=d;var p=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,f){var d=[Nr],x=V0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=V0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(d.push("<office:document"+x+m+`>
`),d.push(RE().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+x+`>
`),n(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)d.push(a(o.Sheets[o.SheetNames[p]],o,p));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),f.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function G_(e,t){if(t.bookType=="fods")return Ww(e,t);var r=wg(),a="",n=[],l=[];return a="mimetype",mt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",mt(r,a,Ww(e,t)),n.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",mt(r,a,QB(e,t)),n.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",mt(r,a,Nr+RE()),n.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",mt(r,a,T8(l)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",mt(r,a,_8(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ul(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):$t(Vi(e))}function ZB(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ja(hs(e))}function JB(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Hi(e){var t=e.reduce(function(n,l){return n+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function Xw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eP(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function tP(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;n>=1;++l,n/=256)e[t+l]=n&255;e[t+15]|=r>=0?0:128}function Z0(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function It(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function yr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Dt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Z0(e,r),l=n&7;n=Math.floor(n/8);var o=0,f;if(n==0)break;switch(l){case 0:{for(var d=r[0];e[r[0]++]>=128;);f=e.slice(d,r[0])}break;case 5:o=4,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Z0(e,r),f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(n," at offset ").concat(a))}var x={data:f,type:l};t[n]==null?t[n]=[x]:t[n].push(x)}return t}function na(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(It(a*8+n.type)),n.type==2&&t.push(It(n.data.length)),t.push(n.data))})}),Hi(t)}function $g(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function vn(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Z0(e,a),l=Dt(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:yr(l[1][0].data),messages:[]};l[2].forEach(function(f){var d=Dt(f.data),x=yr(d[3][0].data);o.messages.push({meta:d,data:e.slice(a[0],a[0]+x)}),a[0]+=x}),(t=l[3])!=null&&t[0]&&(o.merge=yr(l[3][0].data)>>>0>0),r.push(o)}return r}function Ro(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:It(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:It(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:It(o.data.length)}],a[2].push({data:na(o.meta),type:2})});var l=na(a);t.push(It(l.length)),t.push(l),n.forEach(function(o){return t.push(o)})}),Hi(t)}function rP(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Z0(t,r),n=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var f=o-59;o=t[r[0]],f>1&&(o|=t[r[0]+1]<<8),f>2&&(o|=t[r[0]+2]<<16),f>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=f}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,x=0;if(l==1?(x=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(x=(t[r[0]++]>>2)+1,l==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Hi(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(x>=d)for(n.push(n[0].slice(-d)),x-=d;x>=n[n.length-1].length;)n.push(n[n.length-1]),x-=n[n.length-1].length;n.push(n[0].slice(-d,-d+x))}}var m=Hi(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function yn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rP(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Hi(t)}function Do(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var l=It(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Hi(t)}function aP(e,t,r,a){var n=Ul(e),l=n.getUint32(4,!0),o=(a>1?12:8)+Xw(l&(a>1?3470:398))*4,f=-1,d=-1,x=NaN,m=new Date(2001,0,1);l&512&&(f=n.getUint32(o,!0),o+=4),o+=Xw(l&(a>1?12288:4096))*4,l&16&&(d=n.getUint32(o,!0),o+=4),l&32&&(x=n.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:x};break;case 3:p={t:"s",v:t[d]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:x>0};break;case 7:p={t:"n",v:x/86400};break;case 8:p={t:"e",v:0};break;case 9:if(f>-1)p={t:"s",v:r[f]};else if(d>-1)p={t:"s",v:t[d]};else if(!isNaN(x))p={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function nP(e,t,r){var a=Ul(e),n=a.getUint32(8,!0),l=12,o=-1,f=-1,d=NaN,x=NaN,m=new Date(2001,0,1);n&1&&(d=eP(e,l),l+=16),n&2&&(x=a.getFloat64(l,!0),l+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8),n&8&&(f=a.getUint32(l,!0),l+=4),n&16&&(o=a.getUint32(l,!0),l+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[f]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:x>0};break;case 7:p={t:"n",v:x/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return p}function $m(e,t){var r=new Uint8Array(32),a=Ul(r),n=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,tP(r,n,e.v),l|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),l|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,n)}function Ym(e,t){var r=new Uint8Array(32),a=Ul(r),n=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),l|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),l|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,n)}function sP(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return aP(e,t,r,e[0]);case 5:return nP(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function fa(e){var t=Dt(e);return Z0(t[1][0].data)}function $w(e,t){var r=Dt(t.data),a=yr(r[1][0].data),n=r[3],l=[];return(n||[]).forEach(function(o){var f=Dt(o.data),d=yr(f[1][0].data)>>>0;switch(a){case 1:l[d]=zp(f[3][0].data);break;case 8:{var x=e[fa(f[9][0].data)][0],m=Dt(x.data),p=e[fa(m[1][0].data)][0],v=yr(p.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=Dt(p.data);l[d]=y[3].map(function(b){return zp(b.data)}).join("")}break}}),l}function iP(e,t){var r,a,n,l,o,f,d,x,m,p,v,y,b,w,E=Dt(e),_=yr(E[1][0].data)>>>0,N=yr(E[2][0].data)>>>0,k=((a=(r=E[8])==null?void 0:r[0])==null?void 0:a.data)&&yr(E[8][0].data)>0||!1,F,j;if((l=(n=E[7])==null?void 0:n[0])!=null&&l.data&&t!=0)F=(f=(o=E[7])==null?void 0:o[0])==null?void 0:f.data,j=(x=(d=E[6])==null?void 0:d[0])==null?void 0:x.data;else if((p=(m=E[4])==null?void 0:m[0])!=null&&p.data&&t!=1)F=(y=(v=E[4])==null?void 0:v[0])==null?void 0:y.data,j=(w=(b=E[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=k?4:1,T=Ul(F),C=[],O=0;O<F.length/2;++O){var V=T.getUint16(O*2,!0);V<65535&&C.push([O,V])}if(C.length!=N)throw"Expected ".concat(N," cells, found ").concat(C.length);var z=[];for(O=0;O<C.length-1;++O)z[C[O][0]]=j.subarray(C[O][1]*R,C[O+1][1]*R);return C.length>=1&&(z[C[C.length-1][0]]=j.subarray(C[C.length-1][1]*R)),{R:_,cells:z}}function lP(e,t){var r,a=Dt(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?yr(a[7][0].data)>>>0>0?1:0:-1,l=$g(a[5],function(o){return iP(o,n)});return{nrows:yr(a[4][0].data)>>>0,data:l.reduce(function(o,f){return o[f.R]||(o[f.R]=[]),f.cells.forEach(function(d,x){if(o[f.R][x])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(x));o[f.R][x]=d}),o},[])}}function oP(e,t,r){var a,n=Dt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(yr(n[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(l.e.c=(yr(n[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=ht(l);var o=Dt(n[4][0].data),f=$w(e,e[fa(o[4][0].data)][0]),d=(a=o[17])!=null&&a[0]?$w(e,e[fa(o[17][0].data)][0]):[],x=Dt(o[3][0].data),m=0;x[1].forEach(function(p){var v=Dt(p.data),y=e[fa(v[2][0].data)][0],b=yr(y.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=lP(e,y);w.data.forEach(function(E,_){E.forEach(function(N,k){var F=rt({r:m+_,c:k}),j=sP(N,f,d);j&&(r[F]=j)})}),m+=w.nrows})}function cP(e,t){var r=Dt(t.data),a={"!ref":"A1"},n=e[fa(r[2][0].data)],l=yr(n[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return oP(e,n[0],a),a}function uP(e,t){var r,a=Dt(t.data),n={name:(r=a[1])!=null&&r[0]?zp(a[1][0].data):"",sheets:[]},l=$g(a[2],fa);return l.forEach(function(o){e[o].forEach(function(f){var d=yr(f.meta[1][0].data);d==6e3&&n.sheets.push(cP(e,f))})}),n}function fP(e,t){var r=Jg(),a=Dt(t.data),n=$g(a[1],fa);if(n.forEach(function(l){e[l].forEach(function(o){var f=yr(o.meta[1][0].data);if(f==2){var d=uP(e,o);d.sheets.forEach(function(x,m){e1(r,x,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Km(e){var t,r,a,n,l={},o=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var x;try{x=yn(d.content)}catch(p){return console.log("?? "+d.content.length+" "+(p.message||p))}var m;try{m=vn(x)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){l[p.id]=p.messages,o.push(p.id)})}}),!o.length)throw new Error("File has no messages");var f=((n=(a=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&yr(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||o.forEach(function(d){l[d].forEach(function(x){var m=yr(x.meta[1][0].data)>>>0;if(m==1)if(!f)f=x;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return fP(l,f)}function dP(e,t,r){var a,n,l,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var f=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&yr(e[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var d=0,x=Ul(e[7][0].data),m=0,p=[],v=Ul(e[4][0].data),y=0,b=[],w=0;w<t.length;++w){if(t[w]==null){x.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}x.setUint16(w*2,m,!0),v.setUint16(w*2,y,!0);var E,_;switch(typeof t[w]){case"string":E=$m({t:"s",v:t[w]},r),_=Ym({t:"s",v:t[w]},r);break;case"number":E=$m({t:"n",v:t[w]},r),_=Ym({t:"n",v:t[w]},r);break;case"boolean":E=$m({t:"b",v:t[w]},r),_=Ym({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}p.push(E),m+=E.length,b.push(_),y+=_.length,++d}for(e[2][0].data=It(d);w<e[7][0].data.length/2;++w)x.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return e[6][0].data=Hi(p),e[3][0].data=Hi(b),d}function hP(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ha(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ht(a)));var l=Fd(r,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(P){return P.forEach(function(U){typeof U=="string"&&o.push(U)})});var f={},d=[],x=$e.read(t.numbers,{type:"base64"});x.FileIndex.map(function(P,U){return[P,x.FullPaths[U]]}).forEach(function(P){var U=P[0],Y=P[1];if(U.type==2&&U.name.match(/\.iwa/)){var re=U.content,ve=yn(re),be=vn(ve);be.forEach(function(Te){d.push(Te.id),f[Te.id]={deps:[],location:Y,type:yr(Te.messages[0].meta[1][0].data)}})}}),d.sort(function(P,U){return P-U});var m=d.filter(function(P){return P>1}).map(function(P){return[P,It(P)]});x.FileIndex.map(function(P,U){return[P,x.FullPaths[U]]}).forEach(function(P){var U=P[0];if(P[1],!!U.name.match(/\.iwa/)){var Y=vn(yn(U.content));Y.forEach(function(re){re.messages.forEach(function(ve){m.forEach(function(be){re.messages.some(function(Te){return yr(Te.meta[1][0].data)!=11006&&JB(Te.data,be[1])})&&f[be[0]].deps.push(re.id)})})})}});for(var p=$e.find(x,f[1].location),v=vn(yn(p.content)),y,b=0;b<v.length;++b){var w=v[b];w.id==1&&(y=w)}var E=fa(Dt(y.messages[0].data)[1][0].data);for(p=$e.find(x,f[E].location),v=vn(yn(p.content)),b=0;b<v.length;++b)w=v[b],w.id==E&&(y=w);for(E=fa(Dt(y.messages[0].data)[2][0].data),p=$e.find(x,f[E].location),v=vn(yn(p.content)),b=0;b<v.length;++b)w=v[b],w.id==E&&(y=w);for(E=fa(Dt(y.messages[0].data)[2][0].data),p=$e.find(x,f[E].location),v=vn(yn(p.content)),b=0;b<v.length;++b)w=v[b],w.id==E&&(y=w);var _=Dt(y.messages[0].data);{_[6][0].data=It(a.e.r+1),_[7][0].data=It(a.e.c+1);var N=fa(_[46][0].data),k=$e.find(x,f[N].location),F=vn(yn(k.content));{for(var j=0;j<F.length&&F[j].id!=N;++j);if(F[j].id!=N)throw"Bad ColumnRowUIDMapArchive";var R=Dt(F[j].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var T=0;T<=a.e.c;++T){var C=[];C[1]=C[2]=[{type:0,data:It(T+420690)}],R[1].push({type:2,data:na(C)}),R[2].push({type:0,data:It(T)}),R[3].push({type:0,data:It(T)})}R[4]=[],R[5]=[],R[6]=[];for(var O=0;O<=a.e.r;++O)C=[],C[1]=C[2]=[{type:0,data:It(O+726270)}],R[4].push({type:2,data:na(C)}),R[5].push({type:0,data:It(O)}),R[6].push({type:0,data:It(O)});F[j].messages[0].data=na(R)}k.content=Do(Ro(F)),k.size=k.content.length,delete _[46];var V=Dt(_[4][0].data);{V[7][0].data=It(a.e.r+1);var z=Dt(V[1][0].data),H=fa(z[2][0].data);k=$e.find(x,f[H].location),F=vn(yn(k.content));{if(F[0].id!=H)throw"Bad HeaderStorageBucket";var ie=Dt(F[0].messages[0].data);for(O=0;O<l.length;++O){var we=Dt(ie[2][0].data);we[1][0].data=It(O),we[4][0].data=It(l[O].length),ie[2][O]={type:ie[2][0].type,data:na(we)}}F[0].messages[0].data=na(ie)}k.content=Do(Ro(F)),k.size=k.content.length;var ge=fa(V[2][0].data);k=$e.find(x,f[ge].location),F=vn(yn(k.content));{if(F[0].id!=ge)throw"Bad HeaderStorageBucket";for(ie=Dt(F[0].messages[0].data),T=0;T<=a.e.c;++T)we=Dt(ie[2][0].data),we[1][0].data=It(T),we[4][0].data=It(a.e.r+1),ie[2][T]={type:ie[2][0].type,data:na(we)};F[0].messages[0].data=na(ie)}k.content=Do(Ro(F)),k.size=k.content.length;var ee=fa(V[4][0].data);(function(){for(var P=$e.find(x,f[ee].location),U=vn(yn(P.content)),Y,re=0;re<U.length;++re){var ve=U[re];ve.id==ee&&(Y=ve)}var be=Dt(Y.messages[0].data);{be[3]=[];var Te=[];o.forEach(function(Q,st){Te[1]=[{type:0,data:It(st)}],Te[2]=[{type:0,data:It(1)}],Te[3]=[{type:2,data:ZB(Q)}],be[3].push({type:2,data:na(Te)})})}Y.messages[0].data=na(be);var Ae=Ro(U),Ve=Do(Ae);P.content=Ve,P.size=P.content.length})();var le=Dt(V[3][0].data);{var ne=le[1][0];delete le[2];var te=Dt(ne.data);{var I=fa(te[2][0].data);(function(){for(var P=$e.find(x,f[I].location),U=vn(yn(P.content)),Y,re=0;re<U.length;++re){var ve=U[re];ve.id==I&&(Y=ve)}var be=Dt(Y.messages[0].data);{delete be[6],delete le[7];var Te=new Uint8Array(be[5][0].data);be[5]=[];for(var Ae=0,Ve=0;Ve<=a.e.r;++Ve){var Q=Dt(Te);Ae+=dP(Q,l[Ve],o),Q[1][0].data=It(Ve),be[5].push({data:na(Q),type:2})}be[1]=[{type:0,data:It(a.e.c+1)}],be[2]=[{type:0,data:It(a.e.r+1)}],be[3]=[{type:0,data:It(Ae)}],be[4]=[{type:0,data:It(a.e.r+1)}]}Y.messages[0].data=na(be);var st=Ro(U),it=Do(st);P.content=it,P.size=P.content.length})()}ne.data=na(te)}V[3][0].data=na(le)}_[4][0].data=na(V)}y.messages[0].data=na(_);var Z=Ro(v),L=Do(Z);return p.content=L,p.size=p.content.length,x}function V_(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Yg(e){V_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Kg(e){V_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function xP(e){return bt.WS.indexOf(e)>-1?"sheet":e==bt.CS?"chart":e==bt.DS?"dialog":e==bt.MS?"macro":e&&e.length?e:"sheet"}function mP(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,xP(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function pP(e,t,r,a,n,l,o,f,d,x,m,p){try{l[a]=C0(en(e,r,!0),t);var v=Fr(e,t),y;switch(f){case"sheet":y=PL(v,t,n,d,l[a],x,m,p);break;case"chart":if(y=IL(v,t,n,d,l[a],x,m,p),!y||!y["!drawel"])break;var b=_0(y["!drawel"].Target,t),w=W0(b),E=kO(en(e,b,!0),C0(en(e,w,!0),b)),_=_0(E,b),N=W0(_);y=dL(en(e,_,!0),_,d,C0(en(e,N,!0),_),x,y);break;case"macro":y=UL(v,t,n,d,l[a],x,m,p);break;case"dialog":y=zL(v,t,n,d,l[a],x,m,p);break;default:throw new Error("Unrecognized sheet type "+f)}o[a]=y;var k=[];l&&l[a]&&br(l[a]).forEach(function(F){var j="";if(l[a][F].Type==bt.CMNT){j=_0(l[a][F].Target,t);var R=qL(Fr(e,j,!0),j,d);if(!R||!R.length)return;Fw(y,R,!1)}l[a][F].Type==bt.TCMNT&&(j=_0(l[a][F].Target,t),k=k.concat(NO(Fr(e,j,!0),d)))}),k&&k.length&&Fw(y,k,!0,d.people||[])}catch(F){if(d.WTF)throw F}}function pn(e){return e.charAt(0)=="/"?e.slice(1):e}function gP(e,t){if(mc(),t=t||{},Yg(t),bn(e,"META-INF/manifest.xml")||bn(e,"objectdata.xml"))return Vw(e,t);if(bn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Km<"u"){if(e.FileIndex)return Km(e);var r=$e.utils.cfb_new();return ew(e).forEach(function(we){mt(r,we,Cj(e,we))}),Km(r)}throw new Error("Unsupported NUMBERS file")}if(!bn(e,"[Content_Types].xml"))throw bn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):bn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=ew(e),n=w8(en(e,"[Content_Types].xml")),l=!1,o,f;if(n.workbooks.length===0&&(f="xl/workbook.xml",Fr(e,f,!0)&&n.workbooks.push(f)),n.workbooks.length===0){if(f="xl/workbook.bin",!Fr(e,f,!0))throw new Error("Could not find workbook");n.workbooks.push(f),l=!0}n.workbooks[0].slice(-3)=="bin"&&(l=!0);var d={},x={};if(!t.bookSheets&&!t.bookProps){if(A0=[],n.sst)try{A0=VL(Fr(e,pn(n.sst)),n.sst,t)}catch(we){if(t.WTF)throw we}t.cellStyles&&n.themes.length&&(d=GL(en(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(x=HL(Fr(e,pn(n.style)),n.style,d,t))}n.links.map(function(we){try{var ge=C0(en(e,W0(pn(we))),we);return XL(Fr(e,pn(we)),ge,we,t)}catch{}});var m=BL(Fr(e,pn(n.workbooks[0])),n.workbooks[0],t),p={},v="";n.coreprops.length&&(v=Fr(e,pn(n.coreprops[0]),!0),v&&(p=DE(v)),n.extprops.length!==0&&(v=Fr(e,pn(n.extprops[0]),!0),v&&C8(v,p,t)));var y={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(v=en(e,pn(n.custprops[0]),!0),v&&(y=j8(v,t)));var b={};if((t.bookSheets||t.bookProps)&&(m.Sheets?o=m.Sheets.map(function(ge){return ge.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),t.bookProps&&(b.Props=p,b.Custprops=y),t.bookSheets&&typeof o<"u"&&(b.SheetNames=o),t.bookSheets?b.SheetNames:t.bookProps))return b;o={};var w={};t.bookDeps&&n.calcchain&&(w=WL(Fr(e,pn(n.calcchain)),n.calcchain));var E=0,_={},N,k;{var F=m.Sheets;p.Worksheets=F.length,p.SheetNames=[];for(var j=0;j!=F.length;++j)p.SheetNames[j]=F[j].name}var R=l?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),C=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");bn(e,C)||(C="xl/_rels/workbook."+R+".rels");var O=C0(en(e,C,!0),C.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=$L(Fr(e,pn(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=AO(Fr(e,pn(n.people[0])),t)),O&&(O=mP(O,m.Sheets));var V=Fr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=p.Worksheets;++E){var z="sheet";if(O&&O[E]?(N="xl/"+O[E][1].replace(/[\/]?xl\//,""),bn(e,N)||(N=O[E][1]),bn(e,N)||(N=C.replace(/_rels\/.*$/,"")+O[E][1]),z=O[E][2]):(N="xl/worksheets/sheet"+(E+1-V)+"."+R,N=N.replace(/sheet0\./,"sheet.")),k=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(p.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var H=!1,ie=0;ie!=t.sheets.length;++ie)typeof t.sheets[ie]=="number"&&t.sheets[ie]==E&&(H=1),typeof t.sheets[ie]=="string"&&t.sheets[ie].toLowerCase()==p.SheetNames[E].toLowerCase()&&(H=1);if(!H)continue e}}pP(e,N,k,p.SheetNames[E],E,_,o,z,t,m,d,x)}return b={Directory:n,Workbook:m,Props:p,Custprops:y,Deps:w,Sheets:o,SheetNames:p.SheetNames,Strings:A0,Styles:x,Themes:d,SSF:sr(et)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(we,ge){we=we.replace(/^Root Entry[\/]/,""),b.keys.push(we),b.files[we]=e.FileIndex[ge]}))),t&&t.bookVBA&&(n.vba.length>0?b.vbaraw=Fr(e,pn(n.vba[0]),!0):n.defaults&&n.defaults.bin===BO&&(b.vbaraw=Fr(e,"xl/vbaProject.bin",!0))),b}function vP(e,t){var r=t||{},a="Workbook",n=$e.find(e,a);try{if(a="/!DataSpaces/Version",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if($D(n.content),a="/!DataSpaces/DataSpaceMap",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=KD(n.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=QD(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);JD(n.content)}catch{}if(a="/EncryptionInfo",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var f=eF(n.content);if(a="/EncryptedPackage",n=$e.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],n.content,r.password||"",r);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function yP(e,t){return t.bookType=="ods"?G_(e,t):t.bookType=="numbers"?hP(e,t):t.bookType=="xlsb"?bP(e,t):wP(e,t)}function bP(e,t){Po=1024,e&&!e.SSF&&(e.SSF=sr(et)),e&&e.SSF&&(mc(),Yd(e.SSF),t.revssf=Qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,j0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=g_.indexOf(t.bookType)>-1,n=Mg();Kg(t=t||{});var l=wg(),o="",f=0;if(t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(l,o,FE(e.Props,t)),n.coreprops.push(o),Ut(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&d.push(e.SheetNames[x]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,mt(l,o,LE(e.Props)),n.extprops.push(o),Ut(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&br(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(l,o,BE(e.Custprops)),n.custprops.push(o),Ut(t.rels,4,o,bt.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var m={"!id":{}},p=e.Sheets[e.SheetNames[f-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,mt(l,o,KL(f-1,o,t,e,m)),n.sheets.push(o),Ut(t.wbrels,-1,"worksheets/sheet"+f+"."+r,bt.WS[0])}if(p){var y=p["!comments"],b=!1,w="";y&&y.length>0&&(w="xl/comments"+f+"."+r,mt(l,w,JL(y,w)),n.comments.push(w),Ut(m,-1,"../comments"+f+"."+r,bt.CMNT),b=!0),p["!legacy"]&&b&&mt(l,"xl/drawings/vmlDrawing"+f+".vml",m_(f,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&mt(l,W0(o),zo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(l,o,ZL(t.Strings,o,t)),n.strs.push(o),Ut(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,mt(l,o,YL(e,o)),n.workbooks.push(o),Ut(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",mt(l,o,zg(e.Themes,t)),n.themes.push(o),Ut(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,mt(l,o,QL(e,o,t)),n.styles.push(o),Ut(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",mt(l,o,e.vbaraw),n.vba.push(o),Ut(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,mt(l,o,eB(o)),n.metadata.push(o),Ut(t.wbrels,-1,"metadata."+r,bt.XLMETA),mt(l,"[Content_Types].xml",jE(n,t)),mt(l,"_rels/.rels",zo(t.rels)),mt(l,"xl/_rels/workbook."+r+".rels",zo(t.wbrels)),delete t.revssf,delete t.ssf,l}function wP(e,t){Po=1024,e&&!e.SSF&&(e.SSF=sr(et)),e&&e.SSF&&(mc(),Yd(e.SSF),t.revssf=Qd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,j0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=g_.indexOf(t.bookType)>-1,n=Mg();Kg(t=t||{});var l=wg(),o="",f=0;if(t.cellXfs=[],Wi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",mt(l,o,FE(e.Props,t)),n.coreprops.push(o),Ut(t.rels,2,o,bt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&d.push(e.SheetNames[x]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,mt(l,o,LE(e.Props)),n.extprops.push(o),Ut(t.rels,3,o,bt.EXT_PROPS),e.Custprops!==e.Props&&br(e.Custprops||{}).length>0&&(o="docProps/custom.xml",mt(l,o,BE(e.Custprops)),n.custprops.push(o),Ut(t.rels,4,o,bt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,f=1;f<=e.SheetNames.length;++f){var p={"!id":{}},v=e.Sheets[e.SheetNames[f-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,mt(l,o,C_(f-1,t,e,p)),n.sheets.push(o),Ut(t.wbrels,-1,"worksheets/sheet"+f+"."+r,bt.WS[0])}if(v){var b=v["!comments"],w=!1,E="";if(b&&b.length>0){var _=!1;b.forEach(function(N){N[1].forEach(function(k){k.T==!0&&(_=!0)})}),_&&(E="xl/threadedComments/threadedComment"+f+"."+r,mt(l,E,CO(b,m,t)),n.threadedcomments.push(E),Ut(p,-1,"../threadedComments/threadedComment"+f+"."+r,bt.TCMNT)),E="xl/comments"+f+"."+r,mt(l,E,p_(b)),n.comments.push(E),Ut(p,-1,"../comments"+f+"."+r,bt.CMNT),w=!0}v["!legacy"]&&w&&mt(l,"xl/drawings/vmlDrawing"+f+".vml",m_(f,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&mt(l,W0(o),zo(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,mt(l,o,a_(t.Strings,t)),n.strs.push(o),Ut(t.wbrels,-1,"sharedStrings."+r,bt.SST)),o="xl/workbook."+r,mt(l,o,F_(e)),n.workbooks.push(o),Ut(t.rels,1,o,bt.WB),o="xl/theme/theme1.xml",mt(l,o,zg(e.Themes,t)),n.themes.push(o),Ut(t.wbrels,-1,"theme/theme1.xml",bt.THEME),o="xl/styles."+r,mt(l,o,f_(e,t)),n.styles.push(o),Ut(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",mt(l,o,e.vbaraw),n.vba.push(o),Ut(t.wbrels,-1,"vbaProject.bin",bt.VBA)),o="xl/metadata."+r,mt(l,o,x_()),n.metadata.push(o),Ut(t.wbrels,-1,"metadata."+r,bt.XLMETA),m.length>1&&(o="xl/persons/person.xml",mt(l,o,jO(m)),n.people.push(o),Ut(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),mt(l,"[Content_Types].xml",jE(n,t)),mt(l,"_rels/.rels",zo(t.rels)),mt(l,"xl/_rels/workbook."+r+".rels",zo(t.wbrels)),delete t.revssf,delete t.ssf,l}function Qg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=rn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function SP(e,t){return $e.find(e,"EncryptedPackage")?vP(e,t):B_(e,t)}function EP(e,t){var r,a=e,n=t||{};return n.type||(n.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r=sE(a,n),gP(r,n)}function q_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ip(e.slice(r),t);default:break e}return nc.to_workbook(e,t)}function _P(e,t){var r="",a=Qg(e,t);switch(t.type){case"base64":r=rn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ll(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=$t(r)),t.type="binary",q_(r,t)}function kP(e,t){var r=e;return t.type=="base64"&&(r=rn(r)),r=U0.utils.decode(1200,r.slice(2),"str"),t.type="binary",q_(r,t)}function TP(e){return e.match(/[^\x00-\x7F]/)?hs(e):e}function Qm(e,t,r,a){return a?(r.type="string",nc.to_workbook(e,r)):nc.to_workbook(t,r)}function Hp(e,t){pg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hp(new Uint8Array(e),(r=sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Go={},r.dateNF&&(Go.dateNF=r.dateNF),r.type||(r.type=vt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=vt?"buffer":"binary",a=bj(e),typeof Uint8Array<"u"&&!vt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=TP(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),f=new Uint8Array(o);if(f.foo="bar",!f.foo)return r=sr(r),r.type="array",Hp(gg(a),r)}switch((n=Qg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return SP($e.read(a,r),r);break;case 9:if(n[1]<=8)return B_(a,r);break;case 60:return Ip(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return RD(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return t_.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?EP(a,r):Qm(e,a,r,l);case 239:return n[3]===60?Ip(a,r):Qm(e,a,r,l);case 255:if(n[1]===254)return kP(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return jl.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return jl.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Pp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return o_.to_workbook(a,r);break;case 10:case 13:case 32:return _P(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return jD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Pp.to_workbook(a,r):Qm(e,a,r,l)}function W_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return xu(t.file,$e.write(e,{type:vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function NP(e,t){var r=sr(t||{}),a=yP(e,r);return CP(a,r)}function CP(e,t){var r={},a=vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array($d(n))}return t.password&&typeof encrypt_agile<"u"?W_(encrypt_agile(n,t.password),t):t.type==="file"?xu(t.file,n):t.type=="string"?$t(n):n}function AP(e,t){var r=t||{},a=TB(e,r);return W_(a,r)}function os(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return z0(hs(a));case"binary":return hs(a);case"string":return e;case"file":return xu(t.file,a,"utf8");case"buffer":return vt?Xs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):os(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function jP(e,t){switch(t.type){case"base64":return z0(e);case"binary":return e;case"string":return e;case"file":return xu(t.file,e,"binary");case"buffer":return vt?Xs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Yf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?z0(r):t.type=="string"?$t(r):r;case"file":return xu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function X_(e,t){pg(),SL(e);var r=sr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=X_(e,r);return r.type="array",$d(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return os(yB(e,r),r);case"slk":case"sylk":return os(e_.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return os(I_(e.Sheets[e.SheetNames[n]],r),r);case"txt":return jP($_(e.Sheets[e.SheetNames[n]],r),r);case"csv":return os(Zg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return os(t_.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Yf(Pp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return os(nc.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return os(o_.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return os(r_.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return os(G_(e,r),r);case"wk1":return Yf(jl.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Yf(jl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Yf(P_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),AP(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NP(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function RP(e,t,r,a,n,l,o,f){var d=kr(r),x=f.defval,m=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),p=!0,v=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var b=o?e[r][y]:e[a[y]+d];if(b===void 0||b.t===void 0){if(x===void 0)continue;l[y]!=null&&(v[l[y]]=x);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[y]!=null){if(w==null)if(b.t=="e"&&w===null)v[l[y]]=null;else if(x!==void 0)v[l[y]]=x;else if(m&&w===null)v[l[y]]=null;else continue;else v[l[y]]=m&&(b.t!=="n"||b.t==="n"&&f.rawNumbers!==!1)?w:qs(b,w,f);w!=null&&(p=!1)}}return{row:v,isempty:p}}function Fd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,l=[],o=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?a=1:x.header==="A"?a=2:Array.isArray(x.header)?a=3:x.header==null&&(a=0),typeof m){case"string":d=jt(m);break;case"number":d=jt(e["!ref"]),d.s.r=m;break;default:d=m}a>0&&(n=0);var p=kr(d.s.r),v=[],y=[],b=0,w=0,E=Array.isArray(e),_=d.s.r,N=0,k={};E&&!e[_]&&(e[_]=[]);var F=x.skipHidden&&e["!cols"]||[],j=x.skipHidden&&e["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(F[N]||{}).hidden)switch(v[N]=ur(N),r=E?e[_][N]:e[v[N]+p],a){case 1:l[N]=N-d.s.c;break;case 2:l[N]=v[N];break;case 3:l[N]=x.header[N-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),f=o=qs(r,null,x),w=k[o]||0,!w)k[o]=1;else{do f=o+"_"+w++;while(k[f]);k[o]=w,k[f]=1}l[N]=f}for(_=d.s.r+n;_<=d.e.r;++_)if(!(j[_]||{}).hidden){var R=RP(e,d,_,v,a,l,E,x);(R.isempty===!1||(a===1?x.blankrows!==!1:x.blankrows))&&(y[b++]=R.row)}return y.length=b,y}var Yw=/"/g;function DP(e,t,r,a,n,l,o,f){for(var d=!0,x=[],m="",p=kr(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var y=f.dense?(e[r]||[])[v]:e[a[v]+p];if(y==null)m="";else if(y.v!=null){d=!1,m=""+(f.rawNumbers&&y.t=="n"?y.v:qs(y,null,f));for(var b=0,w=0;b!==m.length;++b)if((w=m.charCodeAt(b))===n||w===l||w===34||f.forceQuotes){m='"'+m.replace(Yw,'""')+'"';break}m=="ID"&&(m='"ID"')}else y.f!=null&&!y.F?(d=!1,m="="+y.f,m.indexOf(",")>=0&&(m='"'+m.replace(Yw,'""')+'"')):m="";x.push(m)}return f.blankrows===!1&&d?null:x.join(o)}function Zg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=jt(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),f=a.RS!==void 0?a.RS:`
`,d=f.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",p=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],y=a.skipHidden&&e["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(v[b]||{}).hidden||(p[b]=ur(b));for(var w=0,E=n.s.r;E<=n.e.r;++E)(y[E]||{}).hidden||(m=DP(e,n,E,p,o,d,l,a),m!=null&&(a.strip&&(m=m.replace(x,"")),(m||a.blankrows!==!1)&&r.push((w++?f:"")+m)));return delete a.dense,r.join("")}function $_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Zg(e,t);return r}function FP(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=jt(e["!ref"]),l="",o=[],f,d=[],x=Array.isArray(e);for(f=n.s.c;f<=n.e.c;++f)o[f]=ur(f);for(var m=n.s.r;m<=n.e.r;++m)for(l=kr(m),f=n.s.c;f<=n.e.c;++f)if(t=o[f]+l,r=x?(e[m]||[])[f]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}d[d.length]=t+"="+a}return d}function Y_(e,t,r){var a=r||{},n=+!a.skipHeader,l=e||{},o=0,f=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?fr(a.origin):a.origin;o=d.r,f=d.c}var x,m={s:{c:0,r:0},e:{c:f,r:o+t.length-1+n}};if(l["!ref"]){var p=jt(l["!ref"]);m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),o==-1&&(o=p.e.r+1,m.e.r=o+t.length-1+n)}else o==-1&&(o=0,m.e.r=t.length-1+n);var v=a.header||[],y=0;t.forEach(function(w,E){br(w).forEach(function(_){(y=v.indexOf(_))==-1&&(v[y=v.length]=_);var N=w[_],k="z",F="",j=rt({c:f+y,r:o+E+n});x=J0(l,j),N&&typeof N=="object"&&!(N instanceof Date)?l[j]=N:(typeof N=="number"?k="n":typeof N=="boolean"?k="b":typeof N=="string"?k="s":N instanceof Date?(k="d",a.cellDates||(k="n",N=zr(N)),F=a.dateNF||et[14]):N===null&&a.nullError&&(k="e",N=0),x?(x.t=k,x.v=N,delete x.w,delete x.R,F&&(x.z=F)):l[j]=x={t:k,v:N},F&&(x.z=F))})}),m.e.c=Math.max(m.e.c,f+v.length-1);var b=kr(o);if(n)for(y=0;y<v.length;++y)l[ur(y+f)+b]={t:"s",v:v[y]};return l["!ref"]=ht(m),l}function OP(e,t){return Y_(null,e,t)}function J0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=fr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?J0(e,rt(t)):J0(e,rt({r:t,c:r||0}))}function MP(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Jg(){return{SheetNames:[],Sheets:{}}}function e1(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);n=l&&+l[2]||0;var o=l&&l[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(D_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function LP(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=MP(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function BP(e,t){return e.z=t,e}function K_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function PP(e,t,r){return K_(e,"#"+t,r)}function IP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function UP(e,t,r,a){for(var n=typeof t!="string"?t:jt(t),l=typeof t=="string"?t:ht(t),o=n.s.r;o<=n.e.r;++o)for(var f=n.s.c;f<=n.e.c;++f){var d=J0(e,o,f);d.t="n",d.F=l,delete d.v,o==n.s.r&&f==n.s.c&&(d.f=r,a&&(d.D=!0))}return e}var Kf={encode_col:ur,encode_row:kr,encode_cell:rt,encode_range:ht,decode_col:Ag,decode_row:Cg,split_cell:Zj,decode_cell:fr,decode_range:Ha,format_cell:qs,sheet_add_aoa:EE,sheet_add_json:Y_,sheet_add_dom:U_,aoa_to_sheet:pc,json_to_sheet:OP,table_to_sheet:z_,table_to_book:$B,sheet_to_csv:Zg,sheet_to_txt:$_,sheet_to_json:Fd,sheet_to_html:I_,sheet_to_formulae:FP,sheet_to_row_object_array:Fd,sheet_get_cell:J0,book_new:Jg,book_append_sheet:e1,book_set_sheet_visibility:LP,cell_set_number_format:BP,cell_set_hyperlink:K_,cell_set_internal_link:PP,cell_add_comment:IP,sheet_set_array_formula:UP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},xd={exports:{}},zP=xd.exports,Kw;function HP(){return Kw||(Kw=1,function(e,t){(function(r,a){a()})(zP,function(){function r(x,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function a(x,m,p){var v=new XMLHttpRequest;v.open("GET",x),v.responseType="blob",v.onload=function(){d(v.response,m,p)},v.onerror=function(){console.error("could not download file")},v.send()}function n(x){var m=new XMLHttpRequest;m.open("HEAD",x,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function l(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(m)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Lf=="object"&&Lf.global===Lf?Lf:void 0,f=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!f?function(x,m,p){var v=o.URL||o.webkitURL,y=document.createElement("a");m=m||x.name||"download",y.download=m,y.rel="noopener",typeof x=="string"?(y.href=x,y.origin===location.origin?l(y):n(y.href)?a(x,m,p):l(y,y.target="_blank")):(y.href=v.createObjectURL(x),setTimeout(function(){v.revokeObjectURL(y.href)},4e4),setTimeout(function(){l(y)},0))}:"msSaveOrOpenBlob"in navigator?function(x,m,p){if(m=m||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(r(x,p),m);else if(n(x))a(x,m,p);else{var v=document.createElement("a");v.href=x,v.target="_blank",setTimeout(function(){l(v)})}}:function(x,m,p,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof x=="string")return a(x,m,p);var y=x.type==="application/octet-stream",b=/constructor/i.test(o.HTMLElement)||o.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||y&&b||f)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var k=E.result;k=w?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=k:location=k,v=null},E.readAsDataURL(x)}else{var _=o.URL||o.webkitURL,N=_.createObjectURL(x);v?v.location=N:location.href=N,v=null,setTimeout(function(){_.revokeObjectURL(N)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})}(xd)),xd.exports}var GP=HP();let VP={data:""},qP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||VP,WP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,XP=/\/\*[^]*?\*\/|  +/g,Qw=/\n+/g,_i=(e,t)=>{let r="",a="",n="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+o+";":a+=l[1]=="f"?_i(o,l):l+"{"+_i(o,l[1]=="k"?"":t)+"}":typeof o=="object"?a+=_i(o,t?t.replace(/([^,])+/g,f=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,f):f?f+" "+d:d)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=_i.p?_i.p(l,o):l+":"+o+";")}return r+(t&&n?t+"{"+n+"}":n)+a},Ds={},Q_=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Q_(e[r]);return t}return e},$P=(e,t,r,a,n)=>{let l=Q_(e),o=Ds[l]||(Ds[l]=(d=>{let x=0,m=11;for(;x<d.length;)m=101*m+d.charCodeAt(x++)>>>0;return"go"+m})(l));if(!Ds[o]){let d=l!==e?e:(x=>{let m,p,v=[{}];for(;m=WP.exec(x.replace(XP,""));)m[4]?v.shift():m[3]?(p=m[3].replace(Qw," ").trim(),v.unshift(v[0][p]=v[0][p]||{})):v[0][m[1]]=m[2].replace(Qw," ").trim();return v[0]})(e);Ds[o]=_i(n?{["@keyframes "+o]:d}:d,r?"":"."+o)}let f=r&&Ds.g?Ds.g:null;return r&&(Ds.g=Ds[o]),((d,x,m,p)=>{p?x.data=x.data.replace(p,d):x.data.indexOf(d)===-1&&(x.data=m?d+x.data:x.data+d)})(Ds[o],t,a,f),o},YP=(e,t,r)=>e.reduce((a,n,l)=>{let o=t[l];if(o&&o.call){let f=o(r),d=f&&f.props&&f.props.className||/^go/.test(f)&&f;o=d?"."+d:f&&typeof f=="object"?f.props?"":_i(f,""):f===!1?"":f}return a+n+(o??"")},"");function ah(e){let t=this||{},r=e.call?e(t.p):e;return $P(r.unshift?r.raw?YP(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,qP(t.target),t.g,t.o,t.k)}let Z_,Gp,Vp;ah.bind({g:1});let Ws=ah.bind({k:1});function KP(e,t,r,a){_i.p=t,Z_=e,Gp=r,Vp=a}function Xi(e,t){let r=this||{};return function(){let a=arguments;function n(l,o){let f=Object.assign({},l),d=f.className||n.className;r.p=Object.assign({theme:Gp&&Gp()},f),r.o=/ *go\d+/.test(d),f.className=ah.apply(r,a)+(d?" "+d:"");let x=e;return e[0]&&(x=f.as||e,delete f.as),Vp&&x[0]&&Vp(f),Z_(x,f)}return n}}var QP=e=>typeof e=="function",Od=(e,t)=>QP(e)?e(t):e,ZP=(()=>{let e=0;return()=>(++e).toString()})(),J_=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),JP=20,ek=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,JP)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:r}=t;return ek(e,{type:e.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(l=>l.id===a||a===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let n=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+n}))}}},md=[],ml={toasts:[],pausedAt:void 0},$l=e=>{ml=ek(ml,e),md.forEach(t=>{t(ml)})},eI={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},tI=(e={})=>{let[t,r]=A.useState(ml),a=A.useRef(ml);A.useEffect(()=>(a.current!==ml&&r(ml),md.push(r),()=>{let l=md.indexOf(r);l>-1&&md.splice(l,1)}),[]);let n=t.toasts.map(l=>{var o,f,d;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((o=e[l.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:l.duration||((f=e[l.type])==null?void 0:f.duration)||(e==null?void 0:e.duration)||eI[l.type],style:{...e.style,...(d=e[l.type])==null?void 0:d.style,...l.style}}});return{...t,toasts:n}},rI=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||ZP()}),Su=e=>(t,r)=>{let a=rI(t,e,r);return $l({type:2,toast:a}),a.id},Na=(e,t)=>Su("blank")(e,t);Na.error=Su("error");Na.success=Su("success");Na.loading=Su("loading");Na.custom=Su("custom");Na.dismiss=e=>{$l({type:3,toastId:e})};Na.remove=e=>$l({type:4,toastId:e});Na.promise=(e,t,r)=>{let a=Na.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(n=>{let l=t.success?Od(t.success,n):void 0;return l?Na.success(l,{id:a,...r,...r==null?void 0:r.success}):Na.dismiss(a),n}).catch(n=>{let l=t.error?Od(t.error,n):void 0;l?Na.error(l,{id:a,...r,...r==null?void 0:r.error}):Na.dismiss(a)}),e};var aI=(e,t)=>{$l({type:1,toast:{id:e,height:t}})},nI=()=>{$l({type:5,time:Date.now()})},F0=new Map,sI=1e3,iI=(e,t=sI)=>{if(F0.has(e))return;let r=setTimeout(()=>{F0.delete(e),$l({type:4,toastId:e})},t);F0.set(e,r)},lI=e=>{let{toasts:t,pausedAt:r}=tI(e);A.useEffect(()=>{if(r)return;let l=Date.now(),o=t.map(f=>{if(f.duration===1/0)return;let d=(f.duration||0)+f.pauseDuration-(l-f.createdAt);if(d<0){f.visible&&Na.dismiss(f.id);return}return setTimeout(()=>Na.dismiss(f.id),d)});return()=>{o.forEach(f=>f&&clearTimeout(f))}},[t,r]);let a=A.useCallback(()=>{r&&$l({type:6,time:Date.now()})},[r]),n=A.useCallback((l,o)=>{let{reverseOrder:f=!1,gutter:d=8,defaultPosition:x}=o||{},m=t.filter(y=>(y.position||x)===(l.position||x)&&y.height),p=m.findIndex(y=>y.id===l.id),v=m.filter((y,b)=>b<p&&y.visible).length;return m.filter(y=>y.visible).slice(...f?[v+1]:[0,v]).reduce((y,b)=>y+(b.height||0)+d,0)},[t]);return A.useEffect(()=>{t.forEach(l=>{if(l.dismissed)iI(l.id,l.removeDelay);else{let o=F0.get(l.id);o&&(clearTimeout(o),F0.delete(l.id))}})},[t]),{toasts:t,handlers:{updateHeight:aI,startPause:nI,endPause:a,calculateOffset:n}}},oI=Ws`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,cI=Ws`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,uI=Ws`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,fI=Xi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${oI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${cI} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${uI} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,dI=Ws`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,hI=Xi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${dI} 1s linear infinite;
`,xI=Ws`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,mI=Ws`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,pI=Xi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${xI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${mI} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,gI=Xi("div")`
  position: absolute;
`,vI=Xi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,yI=Ws`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,bI=Xi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${yI} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,wI=({toast:e})=>{let{icon:t,type:r,iconTheme:a}=e;return t!==void 0?typeof t=="string"?A.createElement(bI,null,t):t:r==="blank"?null:A.createElement(vI,null,A.createElement(hI,{...a}),r!=="loading"&&A.createElement(gI,null,r==="error"?A.createElement(fI,{...a}):A.createElement(pI,{...a})))},SI=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,EI=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,_I="0%{opacity:0;} 100%{opacity:1;}",kI="0%{opacity:1;} 100%{opacity:0;}",TI=Xi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,NI=Xi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,CI=(e,t)=>{let r=e.includes("top")?1:-1,[a,n]=J_()?[_I,kI]:[SI(r),EI(r)];return{animation:t?`${Ws(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ws(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},AI=A.memo(({toast:e,position:t,style:r,children:a})=>{let n=e.height?CI(e.position||t||"top-center",e.visible):{opacity:0},l=A.createElement(wI,{toast:e}),o=A.createElement(NI,{...e.ariaProps},Od(e.message,e));return A.createElement(TI,{className:e.className,style:{...n,...r,...e.style}},typeof a=="function"?a({icon:l,message:o}):A.createElement(A.Fragment,null,l,o))});KP(A.createElement);var jI=({id:e,className:t,style:r,onHeightUpdate:a,children:n})=>{let l=A.useCallback(o=>{if(o){let f=()=>{let d=o.getBoundingClientRect().height;a(e,d)};f(),new MutationObserver(f).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,a]);return A.createElement("div",{ref:l,className:t,style:r},n)},RI=(e,t)=>{let r=e.includes("top"),a=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:J_()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},DI=ah`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Qf=16,FI=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:a,children:n,containerStyle:l,containerClassName:o})=>{let{toasts:f,handlers:d}=lI(r);return A.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Qf,left:Qf,right:Qf,bottom:Qf,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},f.map(x=>{let m=x.position||t,p=d.calculateOffset(x,{reverseOrder:e,gutter:a,defaultPosition:t}),v=RI(m,p);return A.createElement(jI,{id:x.id,key:x.id,onHeightUpdate:d.updateHeight,className:x.visible?DI:"",style:v},x.type==="custom"?Od(x.message,x):n?n(x):A.createElement(AI,{toast:x,position:m}))}))},tn=Na;function OI(e){return Qr({queryKey:["rsvps",e],queryFn:async()=>{var n;const t=await Xe.get(cu.forEvent(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:Array.isArray(r==null?void 0:r.data)?r.data:[]).map(l=>({id:l.id??l.rsvpId??l.rsvpGuid??l._id,rsvpId:l.rsvpId??l.id,rsvpGuid:l.rsvpGuid??l.rsvpGuid??void 0,eventId:l.eventId,guestName:l.guestName??l.name??"",noOfPax:l.noOfPax!==void 0&&l.noOfPax!==null?l.noOfPax:1,name:l.name,createdBy:l.createdBy??"",remarks:l.remarks??"",phoneNo:l.phoneNo??"",tableId:l.tableId??l.table_id??void 0}))},enabled:!!e,staleTime:6e4})}function MI(e,t){return Qr({queryKey:["rsvp",t],queryFn:async()=>(await Xe.get(cu.byId(e,t))).data})}function tk(e){const t=wt();return kt({mutationFn:r=>Xe.post(cu.create(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function rk(e){const t=wt();return kt({mutationFn:async r=>(await Xe.post(cu.update(),r)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function LI(e){const t=wt();return kt({mutationFn:r=>Xe.post(cu.delete(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function t1(e,t){return Qr({queryKey:["formFields",e],enabled:!!e&&((t==null?void 0:t.enabled)??!0),queryFn:async()=>{var l;if(!e)return[];const a=((l=(await Xe.get(Wd.all(e))).data)==null?void 0:l.data)??[],n={0:"text",1:"textarea",2:"select",3:"radio",4:"checkbox",5:"email",6:"number",7:"date"};return(Array.isArray(a)?a:[]).map(o=>({questionId:String(o.questionId??o.id??""),id:String(o.questionId??o.id??""),eventId:o.eventId,label:o.label??o.text??o.name??"",name:o.name??(o.label??o.text??"").toLowerCase().replace(/\s+/g,"_"),text:o.text??o.label??"",isRequired:o.isRequired??o.required??!1,type:typeof o.type=="number"?o.type:void 0,typeKey:typeof o.type=="number"?n[o.type]:o.typeKey??o.type,options:Array.isArray(o.options)||typeof o.options=="string"?o.options:void 0,order:o.order??0}))}})}function BI(e){const t=wt();return kt({mutationFn:r=>Xe.post(Wd.create(),r).then(a=>a.data),onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function PI(e){const t=wt();return kt({mutationFn:r=>{const a={...r,questionId:r.questionId??r.id};return delete a.id,Xe.post(Wd.update(),a).then(n=>n.data)},onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function II(e){const t=wt();return kt({mutationFn:()=>Xe.post(Wd.deactivate()).then(r=>r.data),onSuccess:()=>t.invalidateQueries({queryKey:["formFields",e]})})}const r1=({isOpen:e,onClose:t,eventId:r,initial:a,onSave:n})=>{const{user:l}=du(),[o,f]=A.useState((a==null?void 0:a.guestName)??(a==null?void 0:a.name)??""),[d,x]=A.useState((a==null?void 0:a.noOfPax)??1),[m,p]=A.useState((a==null?void 0:a.phoneNo)??""),[v,y]=A.useState((a==null?void 0:a.remarks)??""),[b,w]=A.useState({}),{data:E=[]}=t1(r),[_,N]=A.useState(!1),[k,F]=A.useState(""),[j,R]=A.useState(""),[T,C]=A.useState("");A.useEffect(()=>{e&&!_&&(f((a==null?void 0:a.guestName)??(a==null?void 0:a.name)??""),x((a==null?void 0:a.noOfPax)??1),p((a==null?void 0:a.phoneNo)??""),y((a==null?void 0:a.remarks)??""),w(E.reduce((V,z)=>{const H=z.name??z.id??z.questionId;return H&&(V[H]=(a==null?void 0:a[H])??""),V},{})),F(""),R(""),C(""),N(!0)),e||N(!1)},[e,a==null?void 0:a.rsvpId,E,_]);const O=V=>{V.preventDefault();let z=!1;if(o.trim()?F(""):(F("Guest name is required"),z=!0),m.trim()?R(""):(R("Phone number is required"),z=!0),d===""||d===null||d===void 0?(C("Number of pax is required"),z=!0):Number(d)<0?(C("Number of pax cannot be negative"),z=!0):Number.isInteger(Number(d))?C(""):(C("Number of pax must be a whole number"),z=!0),z)return;const H=(l==null?void 0:l.id)??(l==null?void 0:l.name)??"System",ie={eventId:r,guestName:o.trim(),noOfPax:Number(d),remarks:v.trim(),phoneNo:m.trim(),...b};a?(ie.updatedBy=H,ie.rsvpGuid=a.rsvpGuid):ie.createdBy=H,n(ie,(a==null?void 0:a.id)??(a==null?void 0:a.rsvpId)),t()};return c.jsx($n,{isOpen:e,onClose:t,title:a?"Edit RSVP":"New RSVP",children:c.jsxs("form",{onSubmit:O,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Zt,{label:"Guest Name",value:o,onChange:V=>{f(V.target.value),F("")},required:!0}),k&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:k})]}),c.jsxs("div",{children:[c.jsx(Zt,{label:"Phone",value:m,onChange:V=>{p(V.target.value),R("")},required:!0}),j&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:j})]}),c.jsxs("div",{children:[c.jsx(Zt,{label:"No of Pax",type:"number",value:String(d),onChange:V=>{x(V.target.value),C("")},min:0,step:1,required:!0}),T&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:T})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),c.jsx("textarea",{className:"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/30",value:v,onChange:V=>y(V.target.value),rows:3,placeholder:"Add any notes"})]}),E.map(V=>c.jsx(Zt,{label:V.label,type:V.type,required:V.required,options:V.options,value:b[V.name]??"",onChange:z=>w(H=>({...H,[V.name]:z.target.value}))},V.id)),c.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",children:a?"Save":"Create"})]})]})})},Eu=({isOpen:e,isDeleting:t,onConfirm:r,onCancel:a,title:n,description:l="This action cannot be undone.",children:o})=>e?c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[c.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"w-6 h-6 text-red-600 dark:text-red-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:n}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l})]})]})}),c.jsx("div",{className:"p-6",children:o}),c.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-100 dark:border-gray-700 flex gap-3",children:[c.jsx(Me,{onClick:a,variant:"secondary",disabled:t,className:"flex-1",children:"Cancel"}),c.jsx(Me,{onClick:r,disabled:t,className:"flex-1 bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:t?c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Deleting..."]}):"Delete"})]})]})}):null;function Yl({title:e="No Events Yet",message:t="Create your first event to get started with planning your big day!",showButton:r=!0}){const a=ja(),{data:n=[]}=hg();return n.filter(o=>{var f;return!((f=o.raw)!=null&&f.isDeleted)}).length>0?null:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[c.jsx("div",{className:"h-20 w-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 grid place-items-center",children:c.jsx(P0,{className:"h-10 w-10 text-indigo-600 dark:text-indigo-400"})}),c.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:e}),c.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:t}),r&&c.jsxs(Me,{onClick:()=>a("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[c.jsx(P0,{className:"h-5 w-5"}),"Create Your First Event"]})]})})}function UI(){const{eventId:e}=Hr(),{data:t=[],isLoading:r,isError:a}=OI(e),n=tk(e),l=rk(e),o=LI(e),{user:f}=du(),d=(f==null?void 0:f.id)??(f==null?void 0:f.name)??"System",x=wt(),[m,p]=A.useState({open:!1}),[v,y]=A.useState({open:!1,rsvp:null}),b=A.useRef(null),[w,E]=A.useState(""),[_,N]=A.useState("list");if(!e)return c.jsx(Yl,{title:"No Events to Manage RSVPs",message:"Create your first event to start managing guest responses and invitations."});if(r)return c.jsx(an,{message:"Loading RSVPs..."});if(a)return c.jsx("p",{className:"text-red-500 p-4",children:"Failed to load RSVPs."});const k=z=>y({open:!0,rsvp:z}),F=()=>y({open:!1,rsvp:null}),j=async()=>{if(v.rsvp)try{await o.mutateAsync({rsvpGuid:v.rsvp.rsvpGuid??v.rsvp.rsvpId??v.rsvp.id,eventId:e}),y({open:!1,rsvp:null})}catch(z){console.error("Failed to delete RSVP:",z)}},R=t.filter(z=>(z.guestName??"").toLowerCase().includes(w.toLowerCase())),T=t.reduce((z,H)=>(z.total+=1,z.pax+=H.noOfPax??0,z),{total:0,pax:0}),C=()=>{const z=t.map(({eventId:we,...ge})=>ge),H=Kf.json_to_sheet(z),ie=Kf.book_new();Kf.book_append_sheet(ie,H,"RSVPs"),GP.saveAs(new Blob([X_(ie,{bookType:"xlsx",type:"array"})]),"rsvps.xlsx")},O=()=>{var z;return(z=b.current)==null?void 0:z.click()},V=async z=>{var we;const H=(we=z.target.files)==null?void 0:we[0];if(!H)return;const ie=new FileReader;ie.onload=async ge=>{var ee;try{const le=(ee=ge.target)==null?void 0:ee.result;if(!le)throw new Error("Empty file");const ne=Hp(le,{type:"array"}),te=ne.Sheets[ne.SheetNames[0]],I=Kf.sheet_to_json(te,{header:1,defval:""}),Z=I[0].map(P=>P.trim().toLowerCase().replace(/\s+/g,""));let L=0;for(const P of I.slice(1)){const U=Object.fromEntries(P.map((ve,be)=>[Z[be],String(ve)])),Y={guestName:U.guestname||"",noOfPax:Number(U.noofpax||1),phoneNo:U.phoneno||"",remarks:U.remarks||""},re=t.find(ve=>ve.name===Y.guestName);if(re){const ve=re.rsvpGuid??re.rsvpId??re.id;await l.mutateAsync({rsvpGuid:ve,...Y,updatedBy:d})}else await n.mutateAsync(Y);L++}tn.success(`Imported ${L} rows`)}catch(le){console.error(le),tn.error(le instanceof Error?le.message:"Import failed")}finally{b.current&&(b.current.value="")}},ie.onerror=()=>tn.error("File read error"),ie.readAsArrayBuffer(H)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col gap-1",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider",children:"Total RSVPs"}),c.jsx("p",{className:"text-3xl font-bold text-primary",children:T.total})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col gap-1",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500 uppercase tracking-wider",children:"Total Pax"}),c.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:T.pax})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-5 gap-3",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"RSVPs"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Tl,{to:"/app/rsvps/designer",children:c.jsx(Me,{variant:"secondary",children:"Design RSVP Card"})}),c.jsx(Me,{onClick:()=>p({open:!0}),children:"+ New RSVP"}),c.jsxs(Me,{disabled:!0,variant:"secondary",onClick:O,children:["Import",c.jsx("span",{className:"ml-1.5 text-xs bg-yellow-100 text-yellow-700 px-1.5 py-0.5 rounded-full",children:"Soon"})]}),c.jsxs(Me,{disabled:!0,variant:"secondary",onClick:C,children:["Export",c.jsx("span",{className:"ml-1.5 text-xs bg-yellow-100 text-yellow-700 px-1.5 py-0.5 rounded-full",children:"Soon"})]})]})]}),c.jsx("input",{ref:b,type:"file",accept:".csv,.xlsx",className:"hidden",onChange:V}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 mb-5",children:[c.jsx("input",{type:"text",placeholder:"Search guests",value:w,onChange:z=>E(z.target.value),className:"md:ml-auto w-full md:w-64 border border-gray-200 dark:border-gray-600 rounded-xl px-3 py-2 text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/30"}),c.jsxs("div",{className:"flex gap-1.5",children:[c.jsx("button",{onClick:()=>N("list"),className:`p-2 rounded-xl transition-colors ${_==="list"?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,"aria-label":"List view",children:c.jsx(jA,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>N("grid"),className:`p-2 rounded-xl transition-colors ${_==="grid"?"bg-primary text-white":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,"aria-label":"Grid view",children:c.jsx(CA,{className:"h-5 w-5"})})]})]}),R.length===0&&c.jsxs("div",{className:"text-center py-20 text-gray-400 dark:text-gray-600",children:[c.jsx("p",{className:"text-4xl mb-3",children:""}),c.jsx("p",{className:"font-medium text-gray-500 dark:text-gray-400",children:w?"No RSVPs match your search.":"No RSVPs yet."}),!w&&c.jsx("p",{className:"text-sm mt-1 text-gray-400 dark:text-gray-500",children:"Add your first guest using the button above."})]}),_==="grid"&&R.length>0&&c.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:R.map(z=>c.jsxs("li",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-4 flex flex-col gap-3 hover:shadow-md dark:hover:shadow-gray-900/40 transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsx("h3",{className:"font-semibold text-gray-800 dark:text-gray-100 leading-snug",children:z.guestName}),z.noOfPax!=null&&c.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full shrink-0",children:[z.noOfPax," pax"]})]}),z.phoneNo&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:z.phoneNo}),z.remarks&&c.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 line-clamp-2",children:z.remarks}),c.jsxs("div",{className:"mt-auto flex gap-2 pt-2 border-t border-gray-100 dark:border-gray-700",children:[c.jsx(Me,{variant:"secondary",onClick:()=>p({open:!0,rsvp:z}),children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:()=>k(z),children:"Delete"})]})]},z.id))}),_==="list"&&R.length>0&&c.jsx("div",{className:"rounded-2xl border border-gray-100 dark:border-gray-700 overflow-hidden shadow-sm",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("tr",{children:[c.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide text-xs",children:"Guest"}),c.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide text-xs",children:"Phone"}),c.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide text-xs",children:"Pax"}),c.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide text-xs",children:"Remarks"}),c.jsx("th",{className:"px-4 py-3"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-50 dark:divide-gray-700/60 bg-white dark:bg-gray-900",children:R.map(z=>c.jsxs("tr",{className:"hover:bg-gray-50/70 dark:hover:bg-gray-800/60 transition-colors",children:[c.jsx("td",{className:"px-4 py-3 font-medium text-gray-800 dark:text-gray-100",children:z.guestName}),c.jsx("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400",children:z.phoneNo||""}),c.jsx("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:z.noOfPax??""}),c.jsx("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400 max-w-[220px] truncate",children:z.remarks||""}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Me,{variant:"secondary",onClick:()=>p({open:!0,rsvp:z}),children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:()=>k(z),children:"Delete"})]})})]},z.id))})]})}),c.jsx(r1,{isOpen:m.open,onClose:()=>p({open:!1}),initial:m.rsvp,eventId:e,onSave:async(z,H)=>{try{H?await l.mutateAsync({rsvpGuid:H,...z}):await n.mutateAsync(z),x.invalidateQueries({queryKey:["rsvps",e]})}catch(ie){console.error("RSVP save error",ie)}finally{p({open:!1})}}}),c.jsx(Eu,{isOpen:v.open,isDeleting:o.isPending,onConfirm:j,onCancel:F,title:"Delete RSVP?",description:"Are you sure you want to delete this RSVP? This will permanently remove it from your guest list.",children:v.rsvp&&c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:[c.jsx("p",{className:"font-medium text-gray-800 dark:text-gray-100 mb-1",children:v.rsvp.guestName}),v.rsvp.phoneNo&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Phone: ",v.rsvp.phoneNo]}),v.rsvp.noOfPax!=null&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Pax: ",v.rsvp.noOfPax]})]})})]})}function zI(e,t){const r={id:e.id,type:e.type};if(e.background){const a={opacity:e.background.overlay??.4,color:"#0f172a"},n={images:e.background.images.map(l=>({id:l.id,src:l.src,alt:l.alt})),activeImageId:e.background.activeImageId,overlay:a};r.background=n}switch(e.sectionImage&&(r.sectionImage={id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}),e.type){case"headline":r.title=e.title,r.subtitle=e.subtitle,r.align=e.align,r.accentClass=e.accent,r.accentColor=t;break;case"text":r.body=e.body,r.width=e.width==="full"?100:50,r.align=e.align,r.muted=e.muted;break;case"info":r.label=e.label,r.content=e.content,r.accentClass=e.accent,r.accentColor=t;break;case"formField":if(r.label=e.label,r.placeholder=e.placeholder,r.required=e.required,r.width=e.width==="full"?100:50,r.hint=e.hint,e.questionId){r.questionId=e.questionId;const a=parseInt(e.questionId,10);r.formFieldId=isNaN(a)?void 0:a}e.fieldCardColor&&(r.fieldCardColor=e.fieldCardColor),e.fieldCardTextColor&&(r.fieldCardTextColor=e.fieldCardTextColor);break;case"cta":r.ctaLabel=e.label,r.href=e.href,r.align=e.align,e.ctaColor&&(r.ctaColor=e.ctaColor),e.ctaTextColor&&(r.ctaTextColor=e.ctaTextColor);break;case"image":r.images=e.images.map(a=>({id:a.id,src:a.src,alt:a.alt})),r.activeImageId=e.activeImageId,r.caption=e.caption,r.height=e.height;break;case"attendance":r.title=e.title,r.subtitle=e.subtitle,r.width=e.width==="half"?50:100;break;case"guestDetails":r.title=e.title,r.subtitle=e.subtitle,r.width=e.width==="half"?50:100,e.showFields&&(r.showFields={...e.showFields});break}return r}function HI(e){var n,l;const t=e.background?{images:e.background.images.map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.background.activeImageId,overlay:((n=e.background.overlay)==null?void 0:n.opacity)??.4}:{images:[],overlay:.4},r=e.sectionImage?{id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}:null,a={id:e.id,background:t,sectionImage:r};switch(e.type){case"headline":return{...a,type:"headline",title:e.title??"",subtitle:e.subtitle,align:e.align??"center",accent:e.accentClass??"text-white"};case"text":return{...a,type:"text",body:e.body??"",width:e.width===50?"half":"full",align:e.align??"left",muted:e.muted};case"info":return{...a,type:"info",label:e.label??"",content:e.content??"",accent:e.accentClass??"bg-white/20 text-white"};case"formField":return{...a,type:"formField",label:e.label??"",placeholder:e.placeholder,required:e.required??!1,width:e.width===50?"half":"full",hint:e.hint,questionId:e.questionId??((l=e.formFieldId)==null?void 0:l.toString()),fieldCardColor:e.fieldCardColor,fieldCardTextColor:e.fieldCardTextColor};case"cta":return{...a,type:"cta",label:e.ctaLabel??e.label??"",href:e.href,align:e.align??"center",ctaColor:e.ctaColor,ctaTextColor:e.ctaTextColor};case"image":return{...a,type:"image",images:(e.images??[]).map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.activeImageId,caption:e.caption,height:e.height??"medium"};case"attendance":return{...a,type:"attendance",title:e.title??"Will you be attending?",subtitle:e.subtitle,width:e.width===50?"half":"full"};case"guestDetails":return{...a,type:"guestDetails",title:e.title??"Your details",subtitle:e.subtitle,width:e.width===50?"half":"full",showFields:e.showFields??{name:!0,phone:!0,pax:!0},cardColor:e.cardColor,cardTextColor:e.cardTextColor};default:return{...a,type:"text",body:"Unknown block type",width:"full",align:"left"}}}function GI(e,t,r,a,n=!1,l=!0){return{eventId:t,design:{theme:{accentColor:e.accentColor,background:{type:e.globalBackgroundType,color:e.globalBackgroundColor,assetUrl:e.globalBackgroundAsset},overlayOpacity:e.globalOverlay,musicUrl:e.globalMusicUrl??void 0,submitButtonColor:e.submitButtonColor,submitButtonTextColor:e.submitButtonTextColor,submitButtonLabel:e.submitButtonLabel},layout:{width:1200,maxHeight:0},previewModes:["mobile","desktop"],blocks:e.blocks.map(o=>zI(o,e.accentColor)),flowPreset:e.flowPreset,formFieldConfigs:e.formFieldConfigs},isPublished:n,isDraft:l}}function qp(e){const{design:t}=e,r="version"in e?e.version:void 0,a="shareToken"in e?e.shareToken:void 0,n="eventGuid"in e?e.eventGuid:void 0;return{blocks:t.blocks.map(HI),flowPreset:t.flowPreset??"serene",globalBackgroundType:t.theme.background.type??"color",globalBackgroundAsset:t.theme.background.assetUrl??"",globalBackgroundColor:t.theme.background.color??"#f6f1e4",globalOverlay:t.theme.overlayOpacity??.25,accentColor:t.theme.accentColor??"#f97316",globalMusicUrl:t.theme.musicUrl??void 0,submitButtonColor:t.theme.submitButtonColor,submitButtonTextColor:t.theme.submitButtonTextColor,submitButtonLabel:t.theme.submitButtonLabel,eventGuid:n,version:r,shareToken:a??null,publicLink:null,formFieldConfigs:t.formFieldConfigs}}function VI(e){return Qr({queryKey:["rsvpDesign",e],queryFn:async()=>{var t,r;try{const a=await Xe.get(ug.get(e)),n=((t=a.data)==null?void 0:t.data)??a.data;return!n||!n.design?null:qp(n)}catch(a){if(((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:5*6e4})}function qI(e){const t=wt();return kt({mutationFn:async({design:r,isPublished:a=!1,isDraft:n=!0,shareToken:l,publicLink:o})=>{const f=GI(r,e,l,o,a,n);return(await Xe.post(ug.save(e),f)).data},onSuccess:()=>{t.invalidateQueries({queryKey:["rsvpDesign",e]}),t.refetchQueries({queryKey:["rsvpDesign",e]})}})}function WI({eventName:e,isLoadingDesign:t,isSaving:r,isSaveSuccess:a,eventId:n,publicLink:l,linkCopied:o,onSave:f,onPreview:d,onGenerateLink:x,onCopyLink:m}){return c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:c.jsxs("div",{className:"flex flex-col gap-3 px-5 py-4 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[c.jsx(Tl,{to:"/app/rsvps",className:"shrink-0 rounded-xl border border-gray-200 px-3 py-1.5 text-xs font-semibold text-gray-500 hover:border-gray-300 hover:bg-gray-50 transition",children:" Back"}),c.jsx("div",{className:"h-5 w-px bg-gray-200 hidden sm:block"}),c.jsxs("div",{className:"min-w-0",children:[c.jsx("p",{className:"text-[10px] uppercase tracking-widest text-gray-400",children:"RSVP designer"}),c.jsx("h1",{className:"text-lg font-bold text-gray-900 leading-tight truncate",children:e??"Design your RSVP invite"})]})]}),c.jsxs("div",{className:"flex shrink-0 items-center gap-2.5",children:[t&&c.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-primary",children:[c.jsx(Xn,{}),c.jsx("span",{className:"hidden sm:inline",children:"Loading"})]}),a&&!r&&c.jsx("span",{className:"rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-semibold text-emerald-600 border border-emerald-100",children:" Saved"}),c.jsx(Me,{variant:"secondary",onClick:d,children:"Preview"}),c.jsx(Me,{onClick:f,disabled:r||t||!n,children:r?"Saving":"Save design"})]})]})}),c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"border-b border-gray-100 bg-gray-50 px-5 py-3.5 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-bold text-gray-800",children:"Share with guests"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Generate a unique link so guests can view the invitation and RSVP."})]}),c.jsxs("div",{className:"flex flex-wrap gap-2 shrink-0",children:[c.jsx(Me,{variant:"secondary",onClick:x,children:l?"Regenerate link":"Generate link"}),l&&c.jsx("a",{href:l,target:"_blank",rel:"noreferrer",className:"rounded-full border border-gray-200 bg-white px-4 py-2 text-sm font-semibold text-gray-700 hover:border-primary hover:text-primary transition",children:"Open as guest "})]})]}),l&&c.jsxs("div",{className:"flex flex-col gap-2 px-5 py-3.5 sm:flex-row sm:items-center",children:[c.jsx("input",{value:l,readOnly:!0,className:"flex-1 rounded-xl border border-gray-200 bg-gray-50 px-3 py-2 text-sm text-gray-600 font-mono focus:outline-none"}),c.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[c.jsx(Me,{variant:"secondary",onClick:m,children:o?"Copied!":"Copy link"}),o&&c.jsx("span",{className:"text-xs font-semibold text-emerald-600",children:" Ready to share"})]})]}),!l&&c.jsxs("div",{className:"px-5 py-3 text-xs text-gray-400",children:["No link generated yet  click ",c.jsx("span",{className:"font-semibold text-gray-500",children:"Generate link"})," above."]})]})]})}const Zw={headline:"Headline",text:"Paragraph",info:"Info badge",formField:"Form field",cta:"CTA button",image:"Image gallery",attendance:"Attendance",guestDetails:"Guest details"},Jw={headline:"H",text:"T",info:"i",formField:"",cta:"",image:"",attendance:"",guestDetails:""};function XI(e){var t;switch(e.type){case"headline":return e.title||"Untitled headline";case"text":return e.body||"Empty paragraph";case"info":return e.label?`${e.label}: ${e.content}`:"Info badge";case"formField":return e.label||"Custom form field";case"cta":return e.label||"CTA button";case"image":return(t=e.images)!=null&&t.length?`${e.images.length} image(s)`:"No images yet";case"attendance":return e.title||"Will you be attending?";case"guestDetails":return e.title||"Your details";default:return""}}function $I({block:e,isSelected:t,accentColor:r,onSelect:a,onDragStart:n,onDragOver:l,onDragEnd:o}){var m,p,v,y;const f=((m=e.background)==null?void 0:m.images.find(b=>{var w;return b.id===((w=e.background)==null?void 0:w.activeImageId)}))??((v=(p=e.background)==null?void 0:p.images)==null?void 0:v[0])??(e.type==="image"?e.images.find(b=>b.id===e.activeImageId)??e.images[0]:void 0),d=((y=e.background)==null?void 0:y.images.length)??0,x=XI(e);return c.jsxs("div",{draggable:!0,onDragStart:n,onDragOver:l,onDragEnd:o,onClick:a,className:`group flex cursor-grab items-center gap-3 rounded-xl border px-3 py-2.5 transition active:cursor-grabbing ${t?"border-primary bg-primary/5 shadow-sm ring-1 ring-primary/20":"border-gray-200 bg-white hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("div",{className:"flex flex-shrink-0 flex-col items-center gap-0.5 opacity-30 group-hover:opacity-60",children:[0,1,2].map(b=>c.jsxs("div",{className:"flex gap-0.5",children:[c.jsx("div",{className:"h-1 w-1 rounded-full bg-gray-500"}),c.jsx("div",{className:"h-1 w-1 rounded-full bg-gray-500"})]},b))}),c.jsx("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg text-sm font-bold text-white shadow-sm",style:{background:t?r:"#94a3b8"},title:Zw[e.type],children:Jw[e.type]}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-sm font-semibold text-gray-800 truncate",children:Zw[e.type]}),d>0&&c.jsxs("span",{className:"shrink-0 rounded-full px-1.5 py-0.5 text-[10px] font-semibold",style:{background:`${r}20`,color:r},children:[d," bg"]})]}),c.jsx("p",{className:"truncate text-xs text-gray-400",children:x})]}),f?c.jsx("img",{src:f.src,alt:f.alt??"",className:"h-11 w-11 flex-shrink-0 rounded-lg object-cover ring-1 ring-gray-200"}):c.jsx("div",{className:"h-11 w-11 flex-shrink-0 rounded-lg border border-dashed border-gray-200 flex items-center justify-center text-xs text-gray-300",children:Jw[e.type]})]})}const YI=[{type:"headline",label:"Headline",desc:"Big title + subtitle",icon:"H"},{type:"text",label:"Paragraph",desc:"Body text section",icon:"T"},{type:"info",label:"Info badge",desc:"Label + content pill",icon:"i"},{type:"attendance",label:"Attendance",desc:"Yes / No / Maybe toggle",icon:""},{type:"guestDetails",label:"Guest info",desc:"Name, phone, pax fields",icon:""},{type:"formField",label:"Form field",desc:"Custom RSVP question",icon:""},{type:"cta",label:"CTA button",desc:"Styled call-to-action button",icon:""}];function KI({onAdd:e,onUploadImages:t,availableQuestions:r,isFetchingQuestions:a,onInsertQuestion:n}){const[l,o]=A.useState(""),f=()=>{l&&(n(l),o(""))},d=a?"Loading questions":r.length===0?"No RSVP questions for this event yet.":`${r.length} question${r.length!==1?"s":""} available`;return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400",children:"Add a block"}),c.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[YI.map(({type:x,label:m,desc:p,icon:v})=>c.jsxs("button",{type:"button",onClick:()=>e(x),className:"flex flex-col gap-0.5 rounded-xl border border-gray-200 bg-gray-50 px-3 py-2.5 text-left transition hover:border-primary hover:bg-primary/5",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-sm leading-none",children:v}),c.jsx("span",{className:"text-xs font-semibold text-gray-700",children:m})]}),c.jsx("p",{className:"text-[10px] leading-tight text-gray-400",children:p})]},x)),c.jsxs("label",{className:"flex flex-col gap-0.5 cursor-pointer rounded-xl border border-gray-200 bg-gray-50 px-3 py-2.5 text-left transition hover:border-primary hover:bg-primary/5",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("span",{className:"text-sm leading-none",children:""}),c.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Upload image"})]}),c.jsx("p",{className:"text-[10px] leading-tight text-gray-400",children:"Photo or gallery block"}),c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:x=>x.target.files&&t(x.target.files)})]})]})]}),c.jsxs("div",{className:"rounded-xl border border-dashed border-gray-200 bg-gray-50 p-3 space-y-2",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400",children:"Insert RSVP question"}),c.jsx("p",{className:"mt-0.5 text-[10px] text-gray-400",children:d})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("select",{value:l,onChange:x=>o(x.target.value),disabled:r.length===0||a,className:"flex-1 rounded-lg border border-gray-200 px-2 py-2 text-sm focus:border-primary focus:outline-none disabled:opacity-50",children:[c.jsx("option",{value:"",children:"Select a question"}),r.map(x=>c.jsxs("option",{value:x.id??x.questionId,children:[x.label||x.text||x.name,x.isRequired?" *":""]},x.id??x.questionId))]}),c.jsx(Me,{disabled:!l,onClick:f,className:"flex-shrink-0",children:"Add"})]})]})]})}function QI({blocks:e,selectedId:t,accentColor:r,formFields:a,isFetchingQuestions:n,onSelect:l,onReorder:o,onAdd:f,onUploadImages:d,onInsertQuestion:x}){const[m,p]=A.useState(null);return c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 bg-gray-50 px-4 py-3.5",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-sm font-bold text-gray-800",children:"Blocks"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Drag to reorder  Click to edit"})]}),c.jsx("span",{className:"rounded-full bg-white border border-gray-200 px-2 py-0.5 text-xs font-semibold text-gray-500",children:e.length})]}),c.jsxs("div",{className:"p-4 space-y-4",children:[e.length===0?c.jsx("div",{className:"rounded-xl border border-dashed border-gray-200 py-8 text-center text-sm text-gray-400",children:"No blocks yet. Add one below."}):c.jsx("div",{className:"space-y-2",children:e.map(v=>c.jsx($I,{block:v,isSelected:t===v.id,accentColor:r,onSelect:()=>l(v.id),onDragStart:y=>{p(v.id),y.dataTransfer.setData("text/plain",v.id)},onDragOver:y=>{y.preventDefault(),m&&m!==v.id&&o(m,v.id)},onDragEnd:()=>p(null)},v.id))}),c.jsx("div",{className:"border-t border-gray-100 pt-4",children:c.jsx(KI,{onAdd:f,onUploadImages:d,availableQuestions:a,isFetchingQuestions:n,onInsertQuestion:x})})]})]})}const Zm=e=>e==="center"||e==="right"?e:"left",Zf=e=>e==="half"?"half":"full",eS=({icon:e,title:t,note:r,open:a,onToggle:n})=>c.jsxs("button",{type:"button",onClick:n,className:"flex w-full items-center justify-between rounded-xl border border-gray-200 bg-gray-50 px-3 py-2.5 text-left transition hover:bg-gray-100",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm",children:e}),c.jsx("span",{className:"text-xs font-semibold uppercase tracking-widest text-gray-600",children:t}),r&&c.jsx("span",{className:"text-[10px] text-gray-400",children:r})]}),c.jsx("span",{className:`text-gray-400 text-sm transition-transform duration-200 ${a?"rotate-0":"-rotate-90"}`,children:""})]}),Xt=({label:e,children:t,hint:r})=>c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-xs font-medium text-gray-500",children:e}),t,r&&c.jsx("p",{className:"text-[10px] text-gray-400",children:r})]}),Fo=({label:e,value:t,defaultValue:r,onChange:a})=>c.jsx(Xt,{label:e,children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"color",value:t??r,onChange:n=>a(n.target.value),className:"h-9 w-14 cursor-pointer rounded-lg border border-gray-200 p-0.5"}),c.jsx("span",{className:"font-mono text-xs text-gray-500",children:t??r}),t&&t!==r&&c.jsx("button",{type:"button",onClick:()=>a(r),className:"text-[10px] text-gray-400 underline hover:text-gray-600",children:"reset"})]})}),Qt="w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/20 transition",ZI={headline:"Headline",text:"Paragraph",info:"Info badge",formField:"Form field",cta:"CTA button",image:"Image gallery",attendance:"Attendance",guestDetails:"Guest details"},JI={headline:"H",text:"T",info:"i",formField:"",cta:"",image:"",attendance:"",guestDetails:""};function eU({block:e,accentColor:t,formFields:r,onUpdate:a,onRemove:n,onAddBackgroundImages:l,onSetActiveBackground:o,onSetOverlay:f,onRemoveBackgroundImage:d,onSetSectionImage:x,onClearSectionImage:m,onReplaceImage:p,onAppendImages:v,onApplyQuestion:y}){var R,T;const[b,w]=A.useState(!1),[E,_]=A.useState(!1);if(!e)return c.jsxs("div",{className:"flex h-64 flex-col items-center justify-center rounded-2xl border-2 border-dashed border-gray-200 bg-gray-50 p-8 text-center",children:[c.jsx("div",{className:"mb-3 flex h-14 w-14 items-center justify-center rounded-2xl bg-white shadow-sm text-2xl",children:""}),c.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Select a block to edit"}),c.jsx("p",{className:"mt-1 text-xs text-gray-400",children:"Pick any block from the list on the left to customise its content, colors, and background."})]});const N=((R=e.background)==null?void 0:R.images)??[],k=((T=e.background)==null?void 0:T.overlay)??.4,F=N.length>0?`${N.length} image${N.length!==1?"s":""}`:void 0,j=e.sectionImage?"1 image set":void 0;return c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between border-b border-gray-100 bg-gray-50 px-5 py-3.5",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl text-sm font-bold text-white shadow-sm shrink-0",style:{background:t},children:JI[e.type]??e.type[0].toUpperCase()}),c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:"Editing block"}),c.jsx("h3",{className:"text-sm font-bold text-gray-800 leading-tight",children:ZI[e.type]??e.type})]})]}),c.jsx("button",{type:"button",onClick:()=>n(e.id),className:"rounded-lg border border-rose-100 bg-rose-50 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:bg-rose-100 hover:border-rose-200",children:"Remove"})]}),c.jsxs("div",{className:"space-y-4 p-5",children:[e.type==="headline"&&c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title,onChange:C=>a(e.id,{title:C.target.value}),className:Qt,placeholder:"Welcome to our wedding"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:C=>a(e.id,{subtitle:C.target.value}),className:Qt,placeholder:"Save the date"})}),c.jsx(Xt,{label:"Alignment",children:c.jsxs("select",{value:e.align,onChange:C=>a(e.id,{align:Zm(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})}),c.jsx(Xt,{label:"Accent CSS classes",hint:"e.g. text-white, text-yellow-200",children:c.jsx("input",{value:e.accent,onChange:C=>a(e.id,{accent:C.target.value}),className:Qt,placeholder:"text-white"})})]})}),e.type==="text"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Xt,{label:"Body text",children:c.jsx("textarea",{value:e.body,onChange:C=>a(e.id,{body:C.target.value}),className:Qt,rows:4,placeholder:"Tell your story"})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width,onChange:C=>a(e.id,{width:Zf(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})}),c.jsx(Xt,{label:"Alignment",children:c.jsxs("select",{value:e.align,onChange:C=>a(e.id,{align:Zm(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})})]}),c.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:!!e.muted,onChange:C=>a(e.id,{muted:C.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-primary"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Use softer / muted text tone"})]})]}),e.type==="info"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Label",children:c.jsx("input",{value:e.label,onChange:C=>a(e.id,{label:C.target.value}),className:Qt,placeholder:"Date"})}),c.jsx(Xt,{label:"Content",children:c.jsx("input",{value:e.content,onChange:C=>a(e.id,{content:C.target.value}),className:Qt,placeholder:"Saturday, 15 March 2025"})})]}),c.jsx(Xt,{label:"Accent CSS classes",hint:"e.g. bg-white/20 text-white border border-white/30",children:c.jsx("input",{value:e.accent,onChange:C=>a(e.id,{accent:C.target.value}),className:Qt,placeholder:"bg-white/20 text-white border border-white/30"})})]}),e.type==="formField"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs(Xt,{label:"Link to RSVP question",children:[c.jsxs("select",{value:e.questionId??"",onChange:C=>y(e.id,C.target.value||void 0),className:Qt,children:[c.jsx("option",{value:"",children:" Choose a question "}),r.map(C=>c.jsxs("option",{value:C.id??C.questionId,children:[C.label||C.text||C.name,C.isRequired?" *":"",C.typeKey?` (${C.typeKey})`:""]},C.id??C.questionId))]}),e.questionId?c.jsx("p",{className:"text-xs text-emerald-600 mt-1",children:" Linked  input type driven by question definition."}):c.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Select a question to activate this field."})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Label override",children:c.jsx("input",{value:e.label,onChange:C=>a(e.id,{label:C.target.value}),className:Qt,placeholder:"Leave blank to use question label"})}),c.jsx(Xt,{label:"Placeholder",children:c.jsx("input",{value:e.placeholder??"",onChange:C=>a(e.id,{placeholder:C.target.value}),className:Qt})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width,onChange:C=>a(e.id,{width:Zf(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})}),c.jsx(Xt,{label:"Required",children:c.jsxs("select",{value:e.required?"yes":"no",onChange:C=>a(e.id,{required:C.target.value==="yes"}),className:Qt,children:[c.jsx("option",{value:"yes",children:"Required"}),c.jsx("option",{value:"no",children:"Optional"})]})})]}),c.jsx(Xt,{label:"Hint text (shown below the field)",children:c.jsx("input",{value:e.hint??"",onChange:C=>a(e.id,{hint:C.target.value}),className:Qt,placeholder:"e.g. Dietary restrictions or special requests"})}),c.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 space-y-3",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Field appearance"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Fo,{label:"Card background",value:e.fieldCardColor,defaultValue:"#ffffff",onChange:C=>a(e.id,{fieldCardColor:C})}),c.jsx(Fo,{label:"Card text color",value:e.fieldCardTextColor,defaultValue:"#111827",onChange:C=>a(e.id,{fieldCardTextColor:C})})]}),c.jsxs("div",{className:"rounded-lg px-3 py-2.5 text-xs shadow-sm space-y-1.5",style:{backgroundColor:e.fieldCardColor??"#ffffff",color:e.fieldCardTextColor??"#111827"},children:[c.jsxs("p",{className:"font-medium",children:[e.label||"Field label",e.required?" *":""]}),c.jsx("div",{className:"rounded border px-2 py-1.5 text-[11px] opacity-60",style:{borderColor:`${e.fieldCardTextColor??"#111827"}30`},children:e.placeholder||"Guest input here"})]})]})]}),e.type==="cta"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Button label",children:c.jsx("input",{value:e.label,onChange:C=>a(e.id,{label:C.target.value}),className:Qt,placeholder:"Open RSVP"})}),c.jsx(Xt,{label:"Link / URL (optional)",hint:"Leave blank or # for a decorative button",children:c.jsx("input",{value:e.href??"",onChange:C=>a(e.id,{href:C.target.value}),className:Qt,placeholder:"https://"})}),c.jsx(Xt,{label:"Alignment",children:c.jsxs("select",{value:e.align,onChange:C=>a(e.id,{align:Zm(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})})]}),c.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 space-y-3",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Button appearance"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Fo,{label:"Button color",value:e.ctaColor,defaultValue:t,onChange:C=>a(e.id,{ctaColor:C})}),c.jsx(Fo,{label:"Text color",value:e.ctaTextColor,defaultValue:"#0f172a",onChange:C=>a(e.id,{ctaTextColor:C})})]}),c.jsx("div",{className:`flex ${e.align==="center"?"justify-center":e.align==="right"?"justify-end":"justify-start"}`,children:c.jsx("div",{className:"inline-flex items-center rounded-full px-5 py-2 text-sm font-semibold shadow",style:{background:e.ctaColor??t,color:e.ctaTextColor??"#0f172a"},children:e.label||"Preview button"})})]})]}),e.type==="attendance"&&c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title??"",onChange:C=>a(e.id,{title:C.target.value}),className:Qt,placeholder:"Will you be attending?"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:C=>a(e.id,{subtitle:C.target.value}),className:Qt,placeholder:"Please let us know"})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width??"full",onChange:C=>a(e.id,{width:Zf(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})})]})}),e.type==="guestDetails"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title??"",onChange:C=>a(e.id,{title:C.target.value}),className:Qt,placeholder:"Your details"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:C=>a(e.id,{subtitle:C.target.value}),className:Qt,placeholder:"Tell us about yourself"})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width??"full",onChange:C=>a(e.id,{width:Zf(C.target.value)}),className:Qt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})})]}),c.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 space-y-3",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Card appearance"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Fo,{label:"Card background",value:e.cardColor,defaultValue:"#ffffff",onChange:C=>a(e.id,{cardColor:C})}),c.jsx(Fo,{label:"Card text color",value:e.cardTextColor,defaultValue:"#111827",onChange:C=>a(e.id,{cardTextColor:C})})]}),c.jsx("div",{className:"rounded-lg px-3 py-2 text-xs font-medium shadow-sm",style:{backgroundColor:e.cardColor??"#ffffff",color:e.cardTextColor??"#111827"},children:"Name  Phone number  Number of guests  card preview"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Visible fields"}),[{key:"name",label:"Name"},{key:"phone",label:"Phone number"},{key:"pax",label:"Number of guests"}].map(({key:C,label:O})=>{var V;return c.jsxs("label",{className:"flex cursor-pointer items-center gap-2.5",children:[c.jsx("input",{type:"checkbox",checked:((V=e.showFields)==null?void 0:V[C])!==!1,onChange:z=>a(e.id,{showFields:{...e.showFields,[C]:z.target.checked}}),className:"h-4 w-4 rounded border-gray-300 text-primary"}),c.jsx("span",{className:"text-sm text-gray-600",children:O})]},C)})]})]}),e.type==="image"&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Xt,{label:"Caption (optional)",children:c.jsx("input",{value:e.caption??"",onChange:C=>a(e.id,{caption:C.target.value}),className:Qt,placeholder:"A blessed moment"})}),c.jsx(Xt,{label:"Block height",children:c.jsxs("select",{value:e.height??"medium",onChange:C=>a(e.id,{height:C.target.value==="tall"?"tall":C.target.value==="short"?"short":"medium"}),className:Qt,children:[c.jsx("option",{value:"short",children:"Compact"}),c.jsx("option",{value:"medium",children:"Standard"}),c.jsx("option",{value:"tall",children:"Tall"})]})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("label",{className:"cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary transition",children:["Replace first image",c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:C=>{var O;return((O=C.target.files)==null?void 0:O[0])&&p(e.id,C.target.files[0])}})]}),c.jsxs("label",{className:"cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary transition",children:["Add more images",c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:C=>C.target.files&&v(e.id,C.target.files)})]})]}),e.images.length>0?c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:e.images.map(C=>c.jsx("button",{type:"button",onClick:()=>a(e.id,{activeImageId:C.id}),className:`h-16 w-20 flex-shrink-0 overflow-hidden rounded-lg border-2 transition ${e.activeImageId===C.id?"border-primary shadow":"border-transparent hover:border-gray-300"}`,children:c.jsx("img",{src:C.src,alt:C.alt??"",className:"h-full w-full object-cover"})},C.id))}):c.jsx("p",{className:"text-xs text-gray-400",children:"No images uploaded yet."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(eS,{icon:"",title:"Section background",note:F,open:b,onToggle:()=>w(C=>!C)}),b&&c.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 space-y-2",children:[c.jsxs("label",{className:"block cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary transition",children:["+ Upload background images",c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:C=>C.target.files&&l(e.id,C.target.files)})]}),N.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:N.map(C=>{var O;return c.jsxs("div",{className:"relative flex-shrink-0",children:[c.jsx("button",{type:"button",onClick:()=>o(e.id,C.id),className:`h-14 w-20 overflow-hidden rounded-lg border-2 transition block ${((O=e.background)==null?void 0:O.activeImageId)===C.id?"border-primary shadow-md":"border-transparent hover:border-gray-300"}`,children:c.jsx("img",{src:C.src,alt:C.alt??"",className:"h-full w-full object-cover"})}),c.jsx("button",{type:"button",onClick:()=>d(e.id,C.id),className:"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-rose-500 text-white text-[10px] shadow hover:bg-rose-600",title:"Remove image",children:""})]},C.id)})}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[c.jsx("span",{children:"Overlay strength"}),c.jsxs("span",{children:[Math.round(k*100),"%"]})]}),c.jsx("input",{type:"range",min:0,max:.9,step:.05,value:k,onChange:C=>f(e.id,parseFloat(C.target.value)),className:"w-full accent-primary"})]})]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(eS,{icon:"",title:"Spotlight image",note:j,open:E,onToggle:()=>_(C=>!C)}),E&&c.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 p-3 space-y-2",children:[c.jsx("p",{className:"text-xs text-gray-400",children:"A full backdrop just for this block  ideal for hero moments."}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("label",{className:"flex-1 cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary transition",children:[e.sectionImage?"Replace spotlight image":"+ Set spotlight image",c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:C=>{var O;return((O=C.target.files)==null?void 0:O[0])&&x(e.id,C.target.files[0])}})]}),e.sectionImage&&c.jsx("button",{type:"button",onClick:()=>m(e.id),className:"rounded-lg border border-rose-100 bg-rose-50 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:bg-rose-100",children:"Remove"})]}),e.sectionImage&&c.jsx("div",{className:"overflow-hidden rounded-lg border",children:c.jsx("img",{src:e.sectionImage.src,alt:e.sectionImage.alt??"",className:"h-28 w-full object-cover"})})]})]})]})]})}const tU=[{value:"serene",label:"Serene",icon:"",desc:"Gentle blur + subtle hover lift"},{value:"parallax",label:"Parallax",icon:"",desc:"Backgrounds scroll at fixed depth"},{value:"stacked",label:"Stacked",icon:"",desc:"Snap-scroll between sections"}],Oo=({children:e})=>c.jsx("p",{className:"text-xs font-semibold uppercase tracking-widest text-gray-400",children:e}),Jf=({value:e,defaultValue:t,onChange:r})=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"color",value:e||t,onChange:a=>r(a.target.value),className:"h-9 w-14 cursor-pointer rounded-lg border border-gray-200 p-0.5"}),c.jsx("span",{className:"font-mono text-xs text-gray-500",children:e||t}),e&&e!==t&&c.jsx("button",{type:"button",onClick:()=>r(t),className:"text-[10px] text-gray-400 underline hover:text-gray-600",children:"reset"})]});function rU({globalBackgroundType:e,globalBackgroundColor:t,globalOverlay:r,accentColor:a,flowPreset:n,globalMusicUrl:l,submitButtonColor:o,submitButtonTextColor:f,submitButtonLabel:d,onChange:x,onUploadBackground:m,hasBackgroundAsset:p}){return c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"border-b border-gray-100 bg-gray-50 px-5 py-3.5",children:[c.jsx("h3",{className:"text-sm font-bold text-gray-800",children:"Global settings"}),c.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:"Background, colors, buttons, and music"})]}),c.jsxs("div",{className:"space-y-5 p-5",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsx(Oo,{children:"Background"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:["color","image","video"].map(v=>c.jsx("button",{type:"button",onClick:()=>x({globalBackgroundType:v}),className:`rounded-xl border py-2.5 text-xs font-semibold uppercase tracking-wide transition ${e===v?"border-primary bg-primary/5 text-primary shadow-sm":"border-gray-200 text-gray-500 hover:border-gray-300 hover:bg-gray-50"}`,children:v},v))}),e==="color"&&c.jsx(Jf,{value:t,defaultValue:"#f6f1e4",onChange:v=>x({globalBackgroundColor:v})}),(e==="image"||e==="video")&&c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("input",{type:"file",accept:e==="video"?"video/*":"image/*",onChange:v=>{var y;return((y=v.target.files)==null?void 0:y[0])&&m(v.target.files[0])},className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-xs text-gray-600 file:mr-2 file:rounded file:border-0 file:bg-gray-100 file:px-2 file:py-1 file:text-xs"}),p&&c.jsxs("p",{className:"text-xs font-medium text-emerald-600",children:[" ",e==="video"?"Video":"Image"," attached"]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Oo,{children:"Dark overlay"}),c.jsxs("span",{className:"text-xs tabular-nums text-gray-400",children:[Math.round(r*100),"%"]})]}),c.jsx("input",{type:"range",min:0,max:.9,step:.05,value:r,onChange:v=>x({globalOverlay:parseFloat(v.target.value)}),className:"w-full accent-primary"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Keeps text readable over photos and videos."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Oo,{children:"Accent color"}),c.jsx("div",{className:"flex items-center gap-3",children:c.jsx(Jf,{value:a,defaultValue:"#f97316",onChange:v=>x({accentColor:v})})}),c.jsx("p",{className:"text-xs text-gray-400",children:"Used for highlights and any button without a custom color."})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(Oo,{children:"Submit button"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Button label"}),c.jsx("input",{type:"text",value:d,onChange:v=>x({submitButtonLabel:v.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/20 transition",placeholder:"Submit RSVP"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Button color"}),c.jsx(Jf,{value:o,defaultValue:a,onChange:v=>x({submitButtonColor:v})})]}),c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Text color"}),c.jsx(Jf,{value:f,defaultValue:"#0f172a",onChange:v=>x({submitButtonTextColor:v})})]})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("div",{className:"inline-flex min-w-[160px] items-center justify-center rounded-full px-6 py-2.5 text-sm font-semibold shadow",style:{background:o||a,color:f||"#0f172a"},children:d||"Submit RSVP"})})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Oo,{children:"Scroll style"}),c.jsx("div",{className:"space-y-1.5",children:tU.map(({value:v,label:y,desc:b,icon:w})=>c.jsxs("button",{type:"button",onClick:()=>x({flowPreset:v}),className:`w-full rounded-xl border px-4 py-2.5 text-left transition ${n===v?"border-primary bg-primary/5 text-primary shadow-sm":"border-gray-200 text-gray-600 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm",children:w}),c.jsx("span",{className:"text-sm font-semibold",children:y})]}),c.jsx("p",{className:"mt-0.5 text-xs opacity-60",children:b})]},v))})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Oo,{children:"Ambient music"}),c.jsx("input",{type:"url",value:l,onChange:v=>x({globalMusicUrl:v.target.value}),className:"w-full rounded-xl border border-gray-200 px-3 py-2 text-sm focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary/20 transition",placeholder:"https://example.com/music.mp3"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Direct link to .mp3/.ogg  guests see a floating play button."})]})]})]})}const Fs=()=>Math.random().toString(36).slice(2,9);function ak(e,t){switch(e.type){case"headline":return c.jsxs("div",{className:`text-${e.align}`,children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/70",children:"Welcome"}),c.jsx("h2",{className:`mt-0.5 text-2xl font-extrabold text-white drop-shadow ${e.accent}`,children:e.title}),e.subtitle&&c.jsx("p",{className:"mt-1 text-xs text-white/75",children:e.subtitle})]});case"text":return c.jsx("p",{className:`text-sm leading-relaxed ${e.muted?"text-white/75":"text-white"}`,children:e.body});case"info":return c.jsxs("div",{className:`inline-flex items-center gap-2 rounded-full px-4 py-1.5 text-xs ${e.accent}`,children:[c.jsx("span",{className:"font-semibold uppercase tracking-wide",children:e.label}),c.jsx("span",{className:"text-white/80",children:e.content})]});case"formField":return c.jsxs("div",{className:e.width==="half"?"md:max-w-[50%]":"w-full",children:[c.jsxs("label",{className:"mb-1 block text-xs font-semibold text-white",children:[e.label,e.required&&c.jsx("span",{className:"ml-1 text-rose-300",children:"*"})]}),c.jsx("div",{className:"rounded-lg border border-white/30 bg-white/20 px-3 py-2 text-xs text-white/80",children:e.placeholder||"Guest response here"}),e.hint&&c.jsx("p",{className:"mt-1 text-[10px] text-white/60",children:e.hint})]});case"cta":return c.jsx("div",{className:`flex ${e.align==="center"?"justify-center":e.align==="right"?"justify-end":"justify-start"}`,children:c.jsx("button",{className:"rounded-full px-5 py-2 text-xs font-semibold shadow",style:{background:t,color:"#0f172a"},children:e.label})});case"image":{const r=e.images.find(n=>n.id===e.activeImageId)??e.images[0],a=e.height==="tall"?"h-56":e.height==="short"?"h-32":"h-44";return c.jsxs("div",{className:`overflow-hidden rounded-xl border border-white/15 bg-white/5 ${a}`,children:[r?c.jsx("img",{src:r.src,alt:r.alt??"",className:"h-full w-full object-cover",loading:"lazy"}):c.jsx("div",{className:"flex h-full items-center justify-center text-xs text-white/50",children:"Upload images to display"}),e.caption&&c.jsx("div",{className:"bg-black/35 px-3 py-1.5 text-[10px] text-white/75",children:e.caption})]})}case"attendance":return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-white",children:e.title||"Will you be attending?"}),e.subtitle&&c.jsx("p",{className:"text-[10px] text-white/60",children:e.subtitle}),c.jsx("div",{className:"flex gap-1.5",children:["Yes","No","Maybe"].map(r=>c.jsx("span",{className:"rounded-lg border border-white/20 bg-white/10 px-3 py-1 text-[10px] text-white/80",children:r},r))})]});case"guestDetails":{const r=e.showFields??{name:!0,phone:!0,pax:!0},a=Object.entries(r).filter(([,n])=>n!==!1).map(([n])=>n);return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-white",children:e.title||"Your details"}),e.subtitle&&c.jsx("p",{className:"text-[10px] text-white/60",children:e.subtitle}),c.jsx("div",{className:"flex flex-wrap gap-1",children:a.map(n=>c.jsx("span",{className:"rounded-md bg-white/10 px-2 py-0.5 text-[10px] text-white/70 capitalize",children:n},n))})]})}default:return null}}function aU({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,mode:o,flowPreset:f="serene"}){return c.jsxs("div",{className:`relative overflow-hidden rounded-[28px] border border-white/25 shadow-2xl bg-gradient-to-b from-slate-900 to-black ${o==="mobile"?"w-[360px] max-w-full":"w-full"}`,children:[c.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&c.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${n})`}})]}),c.jsxs("div",{className:"relative z-10 flex items-center justify-between px-4 py-2.5 text-[10px] uppercase tracking-[0.2em] text-white/70 bg-black/20 backdrop-blur-sm",children:[c.jsx("span",{children:o==="mobile"?"Mobile":"Desktop"}),c.jsx("span",{children:"RSVP preview"})]}),c.jsx("div",{className:"relative z-10 overflow-auto px-3 pb-5 pt-3",style:{maxHeight:o==="mobile"?600:700},children:c.jsx("div",{className:`space-y-3 ${f==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:e.map((d,x)=>{var y,b;const m=((y=d.background)==null?void 0:y.images)??[],p=((b=d.background)==null?void 0:b.overlay)??.35,v=m.find(w=>{var E;return w.id===((E=d.background)==null?void 0:E.activeImageId)})??m[0]??d.sectionImage;return c.jsxs("div",{className:`relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-3.5 transition duration-300 ${f==="stacked"?"scroll-snap-start":""} ${f==="serene"?"backdrop-blur":""}`,style:{backgroundImage:v?`linear-gradient(rgba(15,23,42,${p}),rgba(15,23,42,${p})),url(${v.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:f==="parallax"?"fixed":"scroll",transitionDelay:`${x*25}ms`},children:[c.jsxs("div",{className:"mb-1.5 flex items-center gap-1.5 text-[10px] uppercase text-white/60",children:[c.jsx("span",{className:"h-1.5 w-1.5 rounded-full",style:{background:l}}),d.type]}),c.jsx("div",{className:"text-white",children:ak(d,l)})]},d.id)})})})]})}function nU({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,flowPreset:o="serene"}){return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-white",children:[c.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&c.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${n})`}})]}),c.jsx("div",{className:`relative mx-auto flex max-w-5xl flex-col gap-6 px-4 py-12 ${o==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:e.map((f,d)=>{var y,b;const x=((y=f.background)==null?void 0:y.images)??[],m=x.find(w=>{var E;return w.id===((E=f.background)==null?void 0:E.activeImageId)})??x[0]??f.sectionImage,p=((b=f.background)==null?void 0:b.overlay)??.35,v=o==="serene"?"hover:-translate-y-1":"hover:-translate-y-2";return c.jsxs("section",{className:`group relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6 shadow-2xl ring-1 ring-white/5 transition duration-500 ${o==="stacked"?"scroll-snap-start":""} ${v}`,style:{backgroundImage:m?`linear-gradient(rgba(15,23,42,${p}),rgba(15,23,42,${p})),url(${m.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:o==="parallax"?"fixed":"scroll"},children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] uppercase tracking-[0.15em] text-white/60",children:[c.jsxs("span",{className:"inline-flex items-center gap-2",children:[c.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:l}}),f.type]}),c.jsxs("span",{className:"rounded-full bg-black/25 px-2 py-0.5 text-[10px]",children:["Scene ",d+1]})]}),c.jsx("div",{className:"space-y-3 text-white",children:ak(f,l)})]},f.id)})})]})}function sU(){const{event:e,eventId:t}=Hr()??{},{data:r=[],isFetching:a}=t1(t,{enabled:!!t}),{data:n,isLoading:l}=VI(t??""),{mutate:o,isPending:f,isSuccess:d,data:x}=qI(t??""),[m,p]=A.useState(!1),[v,y]=A.useState([{id:Fs(),type:"headline",title:"Welcome to our wedding",subtitle:"Save the date and RSVP below",align:"center",accent:"text-white",background:{images:[],overlay:.4}},{id:Fs(),type:"text",body:"Share your love story, travel tips, or invite message. Guests will scroll through each image-backed section just like an interactive invitation card.",width:"full",align:"left",muted:!0,background:{images:[],overlay:.4}},{id:Fs(),type:"attendance",title:"Will you be attending?",subtitle:"Please let us know",background:{images:[],overlay:.4}},{id:Fs(),type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,phone:!0,pax:!0},background:{images:[],overlay:.4}}]),[b,w]=A.useState(null),[E,_]=A.useState("color"),[N,k]=A.useState(""),[F,j]=A.useState("#f6f1e4"),[R,T]=A.useState(.25),[C,O]=A.useState("#f97316"),[V,z]=A.useState("serene"),[H,ie]=A.useState(""),[we,ge]=A.useState(""),[ee,le]=A.useState(""),[ne,te]=A.useState(""),[I,Z]=A.useState(!1),[L,P]=A.useState("mobile"),[U,Y]=A.useState(null),[re,ve]=A.useState(null),[be,Te]=A.useState(!1),[Ae,Ve]=A.useState(void 0),Q=A.useRef([]),st=A.useMemo(()=>r.slice().sort((Oe,Ue)=>(Oe.order??0)-(Ue.order??0)),[r]),it=A.useMemo(()=>v.find(Oe=>Oe.id===b)??null,[v,b]);A.useEffect(()=>()=>Q.current.forEach(Oe=>URL.revokeObjectURL(Oe)),[]),A.useEffect(()=>{var Oe;((Oe=x==null?void 0:x.data)==null?void 0:Oe.version)!==void 0&&Ve(x.data.version)},[x]),A.useEffect(()=>{var Oe;!n||m||((Oe=n.blocks)!=null&&Oe.length&&y(n.blocks),n.globalBackgroundType&&_(n.globalBackgroundType),n.globalBackgroundAsset&&k(n.globalBackgroundAsset),n.globalBackgroundColor&&j(n.globalBackgroundColor),n.globalOverlay!==void 0&&T(n.globalOverlay),n.accentColor&&O(n.accentColor),n.flowPreset&&z(n.flowPreset),n.globalMusicUrl&&ie(n.globalMusicUrl),n.submitButtonColor&&ge(n.submitButtonColor),n.submitButtonTextColor&&le(n.submitButtonTextColor),n.submitButtonLabel&&te(n.submitButtonLabel),n.version!==void 0&&Ve(n.version),n.shareToken&&(ve(n.shareToken),Y(`${window.location.origin}/rsvp/submit/${n.shareToken}`)),p(!0))},[n,m]),A.useEffect(()=>{re&&tt(re)},[re,v,N,F,E,R,C,V,H,we,ee,ne]);const Qe=Oe=>{const Ue=URL.createObjectURL(Oe);return Q.current.push(Ue),{id:Fs(),src:Ue,alt:Oe.name}},tt=Oe=>{typeof window>"u"||window.localStorage.setItem(`rsvp-share-${Oe}`,JSON.stringify({eventTitle:(e==null?void 0:e.title)??"RSVP invite",eventGuid:t??void 0,blocks:v,flowPreset:V,global:{backgroundColor:F,backgroundType:E,backgroundAsset:N,overlay:R,accentColor:C,musicUrl:H||void 0,submitButtonColor:we||void 0,submitButtonTextColor:ee||void 0,submitButtonLabel:ne||void 0},formFieldConfigs:st}))},De=Oe=>{const Ue=Fs(),Ye={headline:{id:Ue,type:"headline",title:"Custom headline",subtitle:"Add a subheader",align:"center",accent:"text-white",background:{images:[],overlay:.4}},text:{id:Ue,type:"text",body:"Tell your guests what to expect.",width:"full",align:"left",muted:!1,background:{images:[],overlay:.4}},info:{id:Ue,type:"info",label:"Highlight",content:"Dress code, parking, or venue info",accent:"bg-white/20 text-white border border-white/30",background:{images:[],overlay:.4}},attendance:{id:Ue,type:"attendance",title:"Will you be attending?",subtitle:"Please let us know",background:{images:[],overlay:.4}},guestDetails:{id:Ue,type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,phone:!0,pax:!0},background:{images:[],overlay:.4}},formField:{id:Ue,type:"formField",label:"Custom field",placeholder:"Placeholder",required:!1,width:"full",background:{images:[],overlay:.4}},cta:{id:Ue,type:"cta",label:"Open RSVP",href:"#",align:"center",background:{images:[],overlay:.4}},image:{id:Ue,type:"image",images:[],activeImageId:void 0,caption:"Add captions",height:"medium",background:{images:[],overlay:.4}}};y(qe=>[...qe,Ye[Oe]]),w(Ue)},Ot=(Oe,Ue)=>y(Ye=>Ye.map(qe=>qe.id===Oe?{...qe,...Ue}:qe)),dr=Oe=>{y(Ue=>Ue.filter(Ye=>Ye.id!==Oe)),b===Oe&&w(null)},Zr=(Oe,Ue)=>{const Ye=v.findIndex(ea=>ea.id===Oe),qe=v.findIndex(ea=>ea.id===Ue);if(Ye===-1||qe===-1||Ye===qe)return;const ot=[...v],[Jr]=ot.splice(Ye,1);ot.splice(qe,0,Jr),y(ot)},hr=Oe=>{if(!Oe)return;const Ue=st.find(Ye=>String(Ye.id??Ye.questionId)===String(Oe));Ue&&y(Ye=>{if(Ye.some(Jr=>Jr.type==="formField"&&Jr.questionId===Oe))return Ye;const qe=Fs(),ot={id:qe,type:"formField",label:Ue.label||Ue.text||"Custom field",placeholder:Array.isArray(Ue.options)?String(Ue.options[0]??""):"",required:Ue.isRequired??!1,width:"full",hint:Ue.typeKey?`${Ue.typeKey}${Ue.isRequired?"  required":""}`:void 0,questionId:String(Ue.id??Ue.questionId??""),background:{images:[],overlay:.4}};return w(qe),[...Ye,ot]})},An=(Oe,Ue)=>{if(!Ue)return;const Ye=st.find(qe=>String(qe.id??qe.questionId)===String(Ue));Ye&&y(qe=>qe.map(ot=>ot.id!==Oe||ot.type!=="formField"?ot:{...ot,label:Ye.label||Ye.text||ot.label,placeholder:Array.isArray(Ye.options)?String(Ye.options[0]??""):ot.placeholder??"",required:Ye.isRequired??ot.required??!1,hint:Ye.typeKey?`${Ye.typeKey}${Ye.isRequired?"  required":""}`:ot.hint,questionId:Ue}))},ya=Oe=>{const Ue=URL.createObjectURL(Oe);Q.current.push(Ue),k(Ue)},xr=Oe=>{var qe;const Ue=Array.from(Oe).map(Qe),Ye={id:Fs(),type:"image",images:Ue,activeImageId:(qe=Ue[0])==null?void 0:qe.id,caption:"Add a caption or blessing",height:"medium",background:{images:[],overlay:.4}};y(ot=>[...ot,Ye]),w(Ye.id)},Yt=(Oe,Ue)=>{const Ye=Array.from(Ue).map(Qe);y(qe=>qe.map(ot=>{var nn,Yn,Kn,Qn;if(ot.id!==Oe)return ot;const ea=[...((nn=ot.background)==null?void 0:nn.images)??[],...Ye];return{...ot,background:{images:ea,activeImageId:((Yn=ot.background)==null?void 0:Yn.activeImageId)??((Kn=ea[0])==null?void 0:Kn.id),overlay:((Qn=ot.background)==null?void 0:Qn.overlay)??.4}}}))},Cr=(Oe,Ue)=>y(Ye=>Ye.map(qe=>qe.id===Oe?{...qe,background:{...qe.background??{images:[]},activeImageId:Ue}}:qe)),or=(Oe,Ue)=>y(Ye=>Ye.map(qe=>{var Jr,ea,nn,Yn,Kn;if(qe.id!==Oe)return qe;const ot=(((Jr=qe.background)==null?void 0:Jr.images)??[]).filter(Qn=>Qn.id!==Ue);return{...qe,background:{images:ot,activeImageId:((ea=qe.background)==null?void 0:ea.activeImageId)===Ue?(nn=ot[0])==null?void 0:nn.id:(Yn=qe.background)==null?void 0:Yn.activeImageId,overlay:((Kn=qe.background)==null?void 0:Kn.overlay)??.4}}})),Nt=(Oe,Ue)=>y(Ye=>Ye.map(qe=>qe.id===Oe?{...qe,background:{...qe.background??{images:[]},overlay:Ue}}:qe)),Mt=(Oe,Ue)=>{const Ye=Qe(Ue);y(qe=>qe.map(ot=>ot.id===Oe?{...ot,sectionImage:Ye}:ot))},lt=Oe=>y(Ue=>Ue.map(Ye=>Ye.id===Oe?{...Ye,sectionImage:null}:Ye)),Ce=(Oe,Ue)=>{const Ye=Qe(Ue);y(qe=>qe.map(ot=>ot.id!==Oe||ot.type!=="image"?ot:{...ot,images:[Ye,...ot.images],activeImageId:Ye.id}))},ut=(Oe,Ue)=>{y(Ye=>Ye.map(qe=>{var Jr;if(qe.id!==Oe||qe.type!=="image")return qe;const ot=[...qe.images,...Array.from(Ue).map(Qe)];return{...qe,images:ot,activeImageId:qe.activeImageId??((Jr=ot[0])==null?void 0:Jr.id)}}))},St=()=>{if(!t)return;o({design:{blocks:v,flowPreset:V,globalBackgroundType:E,globalBackgroundAsset:N,globalBackgroundColor:F,globalOverlay:R,accentColor:C,globalMusicUrl:H||void 0,submitButtonColor:we||void 0,submitButtonTextColor:ee||void 0,submitButtonLabel:ne||void 0,shareToken:re,publicLink:U,formFieldConfigs:st},isPublished:!1,isDraft:!0,shareToken:re,publicLink:U})},Mr=()=>{const Oe=Fs(),Ue=`${window.location.origin}/rsvp/submit/${Oe}?event=${t}`;ve(Oe),Y(Ue),Te(!1),tt(Oe)},Ra=async()=>{!U||!navigator.clipboard||(await navigator.clipboard.writeText(U),Te(!0))};return t?c.jsxs("div",{className:"space-y-6",children:[c.jsx(WI,{eventName:e==null?void 0:e.title,isLoadingDesign:l,isSaving:f,isSaveSuccess:d,eventId:t,publicLink:U,linkCopied:be,onSave:St,onPreview:()=>Z(!0),onGenerateLink:Mr,onCopyLink:Ra}),c.jsxs("div",{className:"grid grid-cols-1 gap-5 xl:grid-cols-3 xl:items-start",children:[c.jsx("div",{className:"xl:col-span-1",children:c.jsx(QI,{blocks:v,selectedId:b,accentColor:C,formFields:st,isFetchingQuestions:a,onSelect:w,onReorder:Zr,onAdd:De,onUploadImages:xr,onInsertQuestion:hr})}),c.jsxs("div",{className:"space-y-5 xl:col-span-2 xl:sticky xl:top-4 xl:max-h-[calc(100vh-5rem)] xl:overflow-y-auto xl:pb-2",children:[c.jsx(rU,{globalBackgroundType:E,globalBackgroundColor:F,globalOverlay:R,accentColor:C,flowPreset:V,globalMusicUrl:H,submitButtonColor:we,submitButtonTextColor:ee,submitButtonLabel:ne,hasBackgroundAsset:!!N,onChange:Oe=>{Oe.globalBackgroundType!==void 0&&_(Oe.globalBackgroundType),Oe.globalBackgroundColor!==void 0&&j(Oe.globalBackgroundColor),Oe.globalOverlay!==void 0&&T(Oe.globalOverlay),Oe.accentColor!==void 0&&O(Oe.accentColor),Oe.flowPreset!==void 0&&z(Oe.flowPreset),Oe.globalMusicUrl!==void 0&&ie(Oe.globalMusicUrl),Oe.submitButtonColor!==void 0&&ge(Oe.submitButtonColor),Oe.submitButtonTextColor!==void 0&&le(Oe.submitButtonTextColor),Oe.submitButtonLabel!==void 0&&te(Oe.submitButtonLabel)},onUploadBackground:ya}),c.jsx(eU,{block:it,accentColor:C,formFields:st,onUpdate:Ot,onRemove:dr,onAddBackgroundImages:Yt,onSetActiveBackground:Cr,onSetOverlay:Nt,onRemoveBackgroundImage:or,onSetSectionImage:Mt,onClearSectionImage:lt,onReplaceImage:Ce,onAppendImages:ut,onApplyQuestion:An})]})]}),I&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4 py-6",children:c.jsxs("div",{className:"relative w-full max-w-5xl rounded-2xl bg-white shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Preview"}),c.jsx("p",{className:"text-lg font-bold text-gray-800",children:(e==null?void 0:e.title)??"Your RSVP invite"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"hidden gap-1 rounded-full bg-gray-100 p-1 text-sm md:flex",children:["mobile","desktop"].map(Oe=>c.jsx("button",{className:`rounded-full px-3 py-1 font-semibold capitalize transition ${L===Oe?"bg-white shadow":"text-gray-500 hover:text-gray-700"}`,onClick:()=>P(Oe),children:Oe},Oe))}),c.jsx("button",{className:"rounded-full bg-gray-100 px-3 py-1.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",onClick:()=>Z(!1),children:"Close"})]})]}),c.jsx("div",{className:"flex justify-center p-6",children:c.jsx(aU,{blocks:v,backgroundAsset:N,backgroundColor:F,backgroundType:E,overlay:R,accentColor:C,mode:L,flowPreset:V})})]})})]}):c.jsx(Yl,{title:"No Event for RSVP Design",message:"Create your first event to start customizing your RSVP page design."})}function iU(){var d;const{token:e}=Nn(),[t,r]=A.useState(null),[a,n]=A.useState(!0);A.useEffect(()=>{if(!e||typeof window>"u"){n(!1);return}const x=window.localStorage.getItem(`rsvp-share-${e}`);if(x)try{r(JSON.parse(x))}catch{r(null)}n(!1)},[e]);const l=(t==null?void 0:t.global)??{},o=(t==null?void 0:t.flowPreset)??"serene",f=e?`/rsvp/submit/${e}`:null;return a?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white",children:c.jsx(Xn,{})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-950 to-black px-4 py-10 text-white",children:c.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-6",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Guest preview"}),c.jsx("h1",{className:"text-3xl font-bold",children:(t==null?void 0:t.eventTitle)??"Shared RSVP preview"}),c.jsx("p",{className:"text-sm text-white/70",children:"This view mirrors the public invite experience generated from the designer."})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f&&c.jsx(Tl,{to:f,children:c.jsx(Me,{children:"RSVP Now"})}),c.jsx(Tl,{to:"/login",children:c.jsx(Me,{variant:"secondary",children:"Back to dashboard"})})]})]}),(d=t==null?void 0:t.blocks)!=null&&d.length?c.jsx("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-white/5 shadow-2xl",children:c.jsx(nU,{blocks:t.blocks,backgroundAsset:l.backgroundAsset??"",backgroundColor:l.backgroundColor??"#0f172a",backgroundType:l.backgroundType??"color",overlay:l.overlay??.3,accentColor:l.accentColor??"#f97316",flowPreset:o})}):c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6 text-white/80",children:[c.jsx("p",{className:"text-lg font-semibold text-white",children:"This preview link is empty."}),c.jsx("p",{className:"text-sm",children:"Ask the host to regenerate a link from the designer so you can view the invite card."})]}),f&&c.jsx("div",{className:"flex justify-center pt-2 pb-6",children:c.jsx(Tl,{to:f,children:c.jsx(Me,{className:"min-w-[180px]",children:"Submit your RSVP "})})})]})})}function nh(e){return Qr({queryKey:["guests",e],queryFn:async()=>{var n;const t=await Xe.get(zl.all(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:[]).map(l=>({id:l.guestId??l.id,guestId:l.guestId,eventId:l.eventId,eventGuid:l.eventGuid,rsvpId:l.rsvpId,tableId:l.tableId??void 0,name:l.name??"",phoneNo:l.phoneNo??"",pax:l.pax??1,groupId:l.groupId,seatIndex:l.seatIndex,flag:l.flag,notes:l.notes??"",createdDate:l.createdDate,lastUpdated:l.lastUpdated,isDeleted:l.isDeleted??!1,createdBy:l.createdBy??"",updatedBy:l.updatedBy??"",guestName:l.name??"",noOfPax:l.pax??1,guestType:l.flag||l.groupId||"Other",remarks:l.notes??"",status:"Confirmed"}))},staleTime:6e4,enabled:!!e})}function lU(e){const t=wt();return kt({mutationFn:r=>Xe.post(zl.create,r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]})}})}function oU(e){const t=wt();return kt({mutationFn:r=>Xe.put(zl.update,r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]})}})}function a1(e){const t=wt();return kt({mutationFn:({guestId:r,tableId:a})=>Xe.post(zl.assignTable(r,a)).then(n=>n.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function n1(e){const t=wt();return kt({mutationFn:r=>Xe.post(zl.unassignTable(r)).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function sh(e){return Qr({queryKey:["tables",e],queryFn:async()=>{var n;const r=(await Xe.get(Gi.all(e))).data;let a=((n=r==null?void 0:r.data)==null?void 0:n.tables)||(r==null?void 0:r.tables)||(r==null?void 0:r.data)||r||[];return Array.isArray(a)?a.map(l=>{var o;return{id:l.tableId,name:l.tableName,capacity:l.maxSeats,guests:l.guests||[],assignedCount:l.assignedCount??((o=l.guests)==null?void 0:o.length)??0,extraGuests:l.extraGuests,layout:l.layout}}):(console.warn("Unexpected tables API response format:",r),[])},enabled:!!e,staleTime:5*6e4})}function _u(e){return Qr({queryKey:["tables",e],queryFn:()=>Xe.get(Gi.byId(e)).then(t=>t.data),enabled:!!e})}function $i(e,t,r){t&&(e.invalidateQueries({queryKey:["tables",t]}),e.refetchQueries({queryKey:["tables",t]})),r&&(e.invalidateQueries({queryKey:["tables",r]}),e.invalidateQueries({queryKey:["rsvps",r]}),e.invalidateQueries({queryKey:["guests",r]}),e.refetchQueries({queryKey:["tables",r]}),e.refetchQueries({queryKey:["rsvps",r]}),e.refetchQueries({queryKey:["guests",r]})),!t&&!r&&(e.invalidateQueries({queryKey:["tables"]}),e.refetchQueries({queryKey:["tables"]}))}function cU(e){const t=wt();return kt({mutationFn:({name:r,capacity:a,eventId:n})=>Xe.post(Gi.create,{eventGuid:n,tableName:r,maxSeats:a}).then(l=>l.data),onSuccess:()=>$i(t,void 0,e)})}function uU(e){const t=wt();return kt({mutationFn:({eventGuid:r,tableName:a,quantity:n,maxSeats:l})=>Xe.post(Gi.bulkCreate,{eventGuid:r,tableName:a,quantity:n,maxSeats:l}).then(o=>o.data),onSuccess:()=>$i(t,void 0,e)})}function fU(e,t){const r=wt();return kt({mutationFn:({name:a,capacity:n})=>Xe.post(Gi.update,{tableId:e,tableName:a,maxSeats:n}).then(l=>l.data),onSuccess:()=>$i(r,e,t)})}function nk(e){const t=wt();return kt({mutationFn:r=>Xe.delete(Gi.delete(r)).then(a=>a.data),onSuccess:()=>$i(t,void 0,e)})}function dU(e,t){const r=wt();return kt({mutationFn:({extraGuests:a,tableName:n,maxSeats:l})=>Xe.post(Gi.update,{tableId:e,tableName:n,maxSeats:l,extraGuests:a}).then(o=>o.data),onSuccess:()=>$i(r,e,t)})}function hU(e,t){const r=wt();return kt({mutationFn:({layout:a})=>Xe.put(Gi.updateLayout(e),{layout:a}).then(n=>n.data),onSuccess:()=>$i(r,e,t)})}function xU(e){const t=wt();return kt({mutationFn:({guestId:r,tableId:a})=>Xe.post(zl.assignTable(r,a),{}).then(n=>n.data),onSuccess:()=>$i(t,void 0,e)})}function mU(e){const t=wt();return kt({mutationFn:r=>Xe.post(zl.unassignTable(r),{}).then(a=>a.data),onSuccess:()=>$i(t,void 0,e)})}const Bi=({label:e,value:t,variant:r="primary",icon:a})=>{const n={primary:"text-primary bg-primary/5 border-primary/20",secondary:"text-secondary bg-secondary/5 border-secondary/20",accent:"text-button bg-button/5 border-button/20",success:"text-green-600 bg-green-50 border-green-200 dark:text-green-400 dark:bg-green-900/20 dark:border-green-700/30",warning:"text-amber-600 bg-amber-50 border-amber-200 dark:text-amber-400 dark:bg-amber-900/20 dark:border-amber-700/30"},l={primary:"text-primary",secondary:"text-secondary",accent:"text-button",success:"text-green-600 dark:text-green-400",warning:"text-amber-600 dark:text-amber-400"};return c.jsx("div",{className:`p-4 rounded-xl border ${n[r]} transition-all hover:shadow-md`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1",children:e}),c.jsx("p",{className:`text-2xl font-bold ${l[r]}`,children:t})]}),a&&c.jsx("div",{className:`ml-3 ${l[r]} opacity-80`,children:a})]})})},pU=["Family","VIP","Friend","Other"],gU=({isOpen:e,onClose:t,guest:r,eventId:a})=>{du();const{event:n}=Hr(),l=lU(a),o=oU(a),{data:f=[]}=sh(a),[d,x]=A.useState(""),[m,p]=A.useState(""),[v,y]=A.useState(1),[b,w]=A.useState("Family"),[E,_]=A.useState(""),[N,k]=A.useState("");A.useEffect(()=>{e&&r?(x(r.name||r.guestName||""),p(r.phoneNo||""),y(r.pax??r.noOfPax??1),w(r.flag||r.guestType||"Family"),_(r.notes||r.remarks||""),k(r.tableId||"")):e&&!r&&(x(""),p(""),y(1),w("Family"),_(""),k(""))},[e,r]);const F=async R=>{if(R.preventDefault(),!d.trim()){tn.error("Guest name is required");return}try{if(r){const T=r.guestId??r.id;await o.mutateAsync({guestId:T,name:d.trim(),pax:v,phoneNo:m.trim(),flag:b,notes:E.trim(),tableId:N||void 0}),tn.success(`${d} updated successfully`)}else{const T=(n==null?void 0:n.id)??a;await l.mutateAsync({eventGuid:T,guestName:d.trim(),pax:v,phoneNo:m.trim(),tableId:N||void 0}),tn.success(`${d} created successfully`)}t()}catch(T){console.error("Guest save error:",T),tn.error(`Failed to ${r?"update":"create"} guest`)}},j=l.isPending||o.isPending;return c.jsx($n,{isOpen:e,onClose:t,title:r?"Edit Guest":"New Guest",children:c.jsxs("form",{onSubmit:F,className:"space-y-4",children:[c.jsx(Zt,{label:"Guest Name",value:d,onChange:R=>x(R.target.value),required:!0}),c.jsx(Zt,{label:"Phone Number",value:m,onChange:R=>p(R.target.value),type:"text"}),c.jsx(Zt,{label:"Number of Pax",type:"number",value:String(v),onChange:R=>y(Math.max(1,parseInt(R.target.value,10)||1)),min:1,step:1}),r&&c.jsxs("div",{children:[c.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Guest Type"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:pU.map(R=>c.jsx("button",{type:"button",onClick:()=>w(R),className:`px-3 py-1.5 rounded-full text-sm font-medium border transition-all ${b===R?"bg-primary text-white border-primary":"bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400 border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:R},R))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Table Assignment (Optional)"}),c.jsxs("select",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-600",value:N,onChange:R=>k(R.target.value),children:[c.jsx("option",{value:"",children:"Unassigned"}),f.map(R=>c.jsxs("option",{value:R.id,children:[R.name," (Capacity: ",R.capacity,")"]},R.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Notes"}),c.jsx("textarea",{className:"w-full border rounded-xl p-2 text-sm focus:ring-2 focus:ring-primary bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-600",value:E,onChange:R=>_(R.target.value),rows:3,placeholder:"Any special notes about this guest..."})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",loading:j,children:r?"Save Changes":"Create Guest"})]})]})})};function vU(){const{eventId:e}=Hr(),{data:t=[],isLoading:r,isError:a}=nh(e),{data:n=[],isLoading:l}=sh(e),o=a1(e),f=n1(e),[d,x]=A.useState("All"),[m,p]=A.useState(""),[v,y]=A.useState({open:!1}),[b,w]=A.useState({open:!1}),E=A.useMemo(()=>{const j=t.length,R=t.filter(O=>O.tableId).length,T=t.filter(O=>!O.tableId).length,C=t.filter(O=>O.guestType==="VIP").length;return{total:j,assigned:R,unassigned:T,vips:C}},[t]),_=A.useMemo(()=>{const j=new Map;return n.forEach(R=>{j.set(R.id,R.name)}),j},[n]),N=A.useMemo(()=>t.filter(j=>{const R=d==="All"||j.guestType===d,T=(j.guestName??j.name??"").toLowerCase().includes(m.toLowerCase());return R&&T}),[t,d,m]);if(!e)return c.jsx(Yl,{title:"No Events for Guest Management",message:"Create your first event to start adding and managing your guest list."});if(r||l)return c.jsx(an,{message:"Loading guests..."});if(a)return c.jsx("p",{children:"Failed to load guests."});const k=async(j,R)=>{try{await o.mutateAsync({guestId:j.guestId??j.id,tableId:R}),tn.success(`${j.guestName||j.name} assigned to table successfully`),w({open:!1})}catch(T){console.error("Assign table error:",T),tn.error("Failed to assign guest to table")}},F=async j=>{if(window.confirm(`Remove ${j.guestName||j.name} from ${_.get(j.tableId||"")}?`))try{await f.mutateAsync(j.guestId??j.id),tn.success(`${j.guestName||j.name} unassigned from table successfully`)}catch(R){console.error("Unassign table error:",R),tn.error("Failed to unassign guest from table")}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[c.jsx(Bi,{label:"Total Guests",value:E.total,variant:"primary",icon:c.jsx(dd,{className:"h-6 w-6"})}),c.jsx(Bi,{label:"Assigned",value:E.assigned,variant:"success",icon:c.jsx(hd,{className:"h-6 w-6"})}),c.jsx(Bi,{label:"Unassigned",value:E.unassigned,variant:"warning",icon:c.jsx(hd,{className:"h-6 w-6"})}),c.jsx(Bi,{label:"VIPs",value:E.vips,variant:"accent",icon:c.jsx(hd,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Guests"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:c.jsxs("div",{className:"px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl text-sm text-blue-700 dark:text-blue-300",children:[c.jsx("span",{className:"font-medium",children:"Note:"})," Guests are automatically created when RSVP submissions include attendees (pax > 0). ",c.jsx("br",{}),"Guest deletion is only available through the RSVP module."]})})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[c.jsx("select",{value:d,onChange:j=>x(j.target.value),className:"w-full md:w-1/4 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10",children:["All","Family","VIP","Friend","Other"].map(j=>c.jsx("option",{value:j,children:j},j))}),c.jsx("input",{type:"text",placeholder:"Search guests by name...",value:m,onChange:j=>p(j.target.value),className:"w-full md:flex-1 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10"})]}),N.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(dd,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m||d!=="All"?"No guests match your filters":"No guests yet. Create your first guest!"})]}),N.length>0&&c.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:N.map(j=>{const R=!!j.tableId;return c.jsxs("li",{className:`relative p-4 rounded-lg shadow flex flex-col justify-between transition-all ${R?"bg-green-50 dark:bg-green-900/10 border-2 border-green-200 dark:border-green-800":"bg-orange-50 dark:bg-orange-900/10 border-2 border-orange-200 dark:border-orange-800"}`,children:[c.jsx("span",{className:`absolute top-2 right-2 px-3 py-1 text-xs font-bold rounded-full ${R?"bg-green-600 text-white":"bg-orange-600 text-white"}`,children:R?"ASSIGNED":"UNASSIGNED"}),c.jsxs("div",{className:"space-y-2 mt-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:j.guestName}),j.phoneNo&&c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Phone: ",j.phoneNo]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(dd,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),c.jsxs("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[j.pax||j.noOfPax||1," ",(j.pax||j.noOfPax||1)===1?"person":"people",(j.pax||j.noOfPax||1)>1&&c.jsxs("span",{className:"ml-2 text-xs font-bold text-primary",children:["(+",(j.pax||j.noOfPax||1)-1,")"]})]})]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:c.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-sm font-medium border-2 ${j.guestType==="Family"?"border-blue-600 text-blue-600 dark:border-blue-400 dark:text-blue-400":j.guestType==="VIP"?"border-purple-600 text-purple-600 dark:border-purple-400 dark:text-purple-400":j.guestType==="Friend"?"border-indigo-600 text-indigo-600 dark:border-indigo-400 dark:text-indigo-400":"border-gray-400 text-gray-600 dark:border-gray-500 dark:text-gray-400"}`,children:j.guestType||"Other"})}),c.jsxs("div",{className:`mt-3 p-3 rounded-lg ${R?"bg-green-100 dark:bg-green-900/30":"bg-orange-100 dark:bg-orange-900/30"}`,children:[c.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Table Seating:"}),j.tableId?c.jsx("p",{className:"text-sm font-bold text-green-800 dark:text-green-300",children:_.get(j.tableId)||"Unknown Table"}):c.jsx("p",{className:"text-sm font-bold text-orange-800 dark:text-orange-300",children:"No table assigned"})]})]}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[c.jsx(Me,{variant:"secondary",onClick:()=>y({open:!0,guest:j}),children:"Edit"}),j.tableId?c.jsx(Me,{variant:"secondary",onClick:()=>F(j),className:"!bg-orange-600 !text-white hover:!bg-orange-700",children:"Unassign"}):c.jsx(Me,{variant:"primary",onClick:()=>w({open:!0,guest:j}),className:"!bg-green-600 !text-white hover:!bg-green-700",children:"Assign Table"})]})]},j.id)})}),c.jsx(gU,{isOpen:v.open,onClose:()=>y({open:!1}),guest:v.guest,eventId:e}),b.open&&b.guest&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white dark:bg-accent rounded-xl shadow-xl max-w-md w-full p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:["Assign ",b.guest.guestName," to Table"]}),c.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.length===0?c.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No tables available. Please create tables first."}):n.map(j=>c.jsxs("button",{onClick:()=>k(b.guest,j.id),className:"w-full text-left p-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 hover:border-primary dark:hover:border-primary hover:bg-primary/5 transition-colors",children:[c.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:j.name}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",j.capacity]})]},j.id))}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(Me,{variant:"secondary",onClick:()=>w({open:!1}),children:"Cancel"})})]})})]})}const yU=({trigger:e,children:t,className:r=""})=>{const[a,n]=A.useState(!1),l=A.useRef(null);A.useEffect(()=>{const d=x=>{l.current&&!l.current.contains(x.target)&&n(!1)};return a&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[a]);const o=d=>{d(),n(!1)},f=kl.Children.map(t,d=>kl.isValidElement(d)&&d.type===Wp?kl.cloneElement(d,{onClick:()=>o(d.props.onClick)}):d);return c.jsxs("div",{className:`relative inline-block ${r}`,ref:l,children:[c.jsx("div",{onClick:()=>n(!a),className:"cursor-pointer",children:e}),a&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-xl shadow-lg bg-white dark:bg-accent border border-gray-200 dark:border-gray-700 z-50 overflow-hidden",children:c.jsx("div",{className:"py-1",children:f})})]})},Wp=({onClick:e,children:t,className:r=""})=>c.jsx("button",{onClick:e,className:`w-full text-left px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-white/10 transition-colors ${r}`,children:t}),bU=({guest:e,onDragStart:t,onDragEnd:r,isDragging:a=!1})=>{var d;const[n,l]=A.useState(!1),o=x=>{x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("guestId",e.id),t==null||t(e.id)},f=()=>{r==null||r()};return c.jsxs("div",{draggable:"true",onDragStart:o,onDragEnd:f,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:`
        p-3 rounded-lg border-2 border-dashed border-gray-200 
        bg-white dark:bg-accent/50 dark:border-gray-600
        transition-all cursor-grab active:cursor-grabbing
        touch-none select-none
        ${n?"border-primary bg-indigo-50 dark:bg-primary/10 shadow-md":""}
        ${a?"opacity-50":"opacity-100"}
      `,role:"button",tabIndex:0,"aria-label":`Drag ${e.guestName} to assign to a table`,children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white",children:e.guestName}),e.paxCount&&e.paxCount>1&&c.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-xs font-medium text-gray-700 dark:text-gray-300 rounded",children:["+",e.paxCount-1]})]}),e.phoneNo&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:e.phoneNo}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.isVip&&c.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-300 text-xs font-medium rounded-full",children:"VIP"}),(d=e.dietaryRestrictions)==null?void 0:d.map((x,m)=>c.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium rounded-full",children:x},m))]})]})},wU=({table:e,onDrop:t,onEdit:r,onDelete:a,onUnassignGuest:n,draggedGuest:l})=>{const[o,f]=A.useState(!1),d=e.capacity-e.assignedCount,x=l?l.paxCount<=d:d>0,p={vip:{header:"from-purple-50 to-white dark:from-purple-900/20 dark:to-accent",icon:"from-purple-500 to-purple-700",badge:"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300"},"family-bride":{header:"from-pink-50 to-white dark:from-pink-900/20 dark:to-accent",icon:"from-pink-500 to-rose-600",badge:"bg-pink-100 text-pink-800 dark:bg-pink-900/40 dark:text-pink-300"},"family-groom":{header:"from-blue-50 to-white dark:from-blue-900/20 dark:to-accent",icon:"from-blue-500 to-blue-700",badge:"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300"},friends:{header:"from-green-50 to-white dark:from-green-900/20 dark:to-accent",icon:"from-green-500 to-emerald-600",badge:"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"},colleagues:{header:"from-orange-50 to-white dark:from-orange-900/20 dark:to-accent",icon:"from-orange-500 to-amber-600",badge:"bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"}}[e.category||"friends"],v=e.assignedCount/e.capacity*100,y=e.assignedCount>=e.capacity,b=_=>{x&&(_.preventDefault(),_.dataTransfer.dropEffect="move",f(!0))},w=()=>{f(!1)},E=_=>{if(_.preventDefault(),f(!1),!x)return;const N=_.dataTransfer.getData("guestId");N&&t&&t(N,e.id)};return c.jsxs("div",{onDragOver:b,onDragLeave:w,onDrop:E,className:`
        relative rounded-xl shadow-lg overflow-hidden transition-all
        ${o&&x?"ring-4 ring-primary ring-offset-2 shadow-2xl scale-[1.02]":""}
        ${!x&&l?"opacity-50 cursor-not-allowed":""}
        ${y?"opacity-75":""}
        hover:shadow-xl
      `,role:"region","aria-label":`${e.name} - ${e.assignedCount} of ${e.capacity} seats filled`,children:[c.jsxs("div",{className:`bg-gradient-to-r ${p.header} p-4 border-b`,children:[c.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white mb-1",children:e.name}),e.category&&c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.badge}`,children:e.category})})]}),c.jsxs("div",{className:"bg-white dark:bg-accent p-4",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[c.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Seats"}),c.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[e.assignedCount," / ",e.capacity]})]}),c.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-300 ${y?"bg-green-500":v>80?"bg-amber-500":"bg-primary"}`,style:{width:`${Math.min(v,100)}%`}})})]}),c.jsx("div",{className:"space-y-2 mb-4 max-h-48 overflow-y-auto",children:e.guests.length===0?c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-4",children:"No guests assigned yet"}):e.guests.map(_=>c.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-gray-50 dark:bg-gray-800 group hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-sm font-bold flex-shrink-0",children:_.guestName.charAt(0).toUpperCase()}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:_.guestName}),_.paxCount&&_.paxCount>1&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",_.paxCount-1," guests"]})]}),n&&c.jsx("button",{onClick:()=>n(_.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:"Unassign guest",children:c.jsx(dg,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]},_.id))}),c.jsxs("div",{className:"flex gap-2 pt-3 border-t dark:border-gray-700",children:[c.jsx(Me,{variant:"secondary",onClick:()=>r==null?void 0:r(e.id),className:"flex-1 text-sm py-2",children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:()=>a==null?void 0:a(e.id),className:"text-sm py-2",children:"Delete"})]})]}),o&&x&&c.jsx("div",{className:"absolute inset-0 bg-primary/10 border-4 border-dashed border-primary rounded-xl flex items-center justify-center pointer-events-none",children:c.jsx("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg",children:c.jsx("p",{className:"text-primary font-semibold",children:"Drop guest here"})})}),l&&!x&&c.jsx("div",{className:"absolute inset-0 bg-red-500/10 border-2 border-red-500 rounded-xl flex items-center justify-center pointer-events-none",children:c.jsxs("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg border-2 border-red-500",children:[c.jsx("p",{className:"text-red-600 font-semibold text-sm",children:"Not enough seats"}),c.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Need ",l.paxCount,", only ",d," available"]})]})})]})},rr={NONE:0,BRIDE_FAMILY:1,GROOM_FAMILY:2,BRIDE_RELATIVES:3,GROOM_RELATIVES:4,FRIENDS:5,COLLEAGUES:6,FAMILY_FRIENDS:7,NEIGHBORS:8,VIP:9},SU={[rr.NONE]:"None",[rr.BRIDE_FAMILY]:"Bride Family",[rr.GROOM_FAMILY]:"Groom Family",[rr.BRIDE_RELATIVES]:"Bride Relatives",[rr.GROOM_RELATIVES]:"Groom Relatives",[rr.FRIENDS]:"Friends",[rr.COLLEAGUES]:"Colleagues",[rr.FAMILY_FRIENDS]:"Family Friends",[rr.NEIGHBORS]:"Neighbors",[rr.VIP]:"VIP"},Jm={[rr.NONE]:"table",[rr.BRIDE_FAMILY]:"bridefamily",[rr.GROOM_FAMILY]:"groomfamily",[rr.BRIDE_RELATIVES]:"briderelatives",[rr.GROOM_RELATIVES]:"groomrelatives",[rr.FRIENDS]:"friends",[rr.COLLEAGUES]:"colleagues",[rr.FAMILY_FRIENDS]:"familyfriends",[rr.NEIGHBORS]:"neighbors",[rr.VIP]:"vip"};function EU(){return[rr.VIP,rr.BRIDE_FAMILY,rr.GROOM_FAMILY,rr.FRIENDS,rr.COLLEAGUES]}const _U=({isOpen:e,onClose:t})=>{const{eventId:r}=Hr(),[a,n]=A.useState(null),[l,o]=A.useState(!1),[f,d]=A.useState([]),[x,m]=A.useState(""),[p,v]=A.useState(""),[y,b]=A.useState("10"),w=uU(r);A.useEffect(()=>{if(e){const F=EU();d(F.map(j=>({category:j,quantity:0,capacity:10}))),m(""),v(""),b("10"),n(null),o(!1)}},[e]);const E=(F,j)=>{const R=[...f];R[F].quantity=Number(j)||0,d(R)},_=(F,j)=>{const R=[...f];R[F].capacity=Number(j)||1,d(R)},N=async F=>{F.preventDefault(),n(null);const j=f.filter(V=>V.quantity>0),R=Number(p)||0,T=Number(y)||0,C=x.trim()&&R>0;if(j.length===0&&!C){n("Please enter at least one table quantity");return}if(C){if(!x.trim()){n("Please enter a table prefix for custom tables");return}if(R<1){n("Custom table quantity must be at least 1");return}if(T<1){n("Custom table capacity must be at least 1");return}}if(j.find(V=>V.capacity<1)){n("All capacities must be at least 1");return}o(!0);try{for(const V of j){const z=Jm[V.category];await w.mutateAsync({eventGuid:r,tableName:z,quantity:V.quantity,maxSeats:V.capacity})}C&&await w.mutateAsync({eventGuid:r,tableName:x.trim(),quantity:R,maxSeats:T}),t()}catch(V){console.error("Failed to create tables:",V),n(V.message??"Failed to create tables. Please try again.")}finally{o(!1)}},k=f.reduce((F,j)=>F+j.quantity,0)+(Number(p)||0);return c.jsx($n,{isOpen:e,onClose:t,title:"Bulk Create Tables",className:"!max-w-4xl",children:c.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a&&c.jsx(hu,{message:a}),c.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-3 mb-4",children:c.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[c.jsx("strong",{children:"Quick Setup:"})," Enter quantities for each category. Tables will be auto-named (e.g., vip1, vip2, bridefamily1, friends1, etc.)"]})}),c.jsx("div",{className:"space-y-3",children:f.map((F,j)=>c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-3 bg-white dark:bg-accent/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:SU[F.category]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",Jm[F.category],"1, ",Jm[F.category],"2...)"]})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("input",{type:"number",min:"0",placeholder:"0",value:F.quantity||"",onChange:R=>E(j,R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("input",{type:"number",min:"1",value:F.capacity,onChange:R=>_(j,R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:F.quantity===0}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]},F.category))}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Custom Tables (Optional)"}),c.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-3",children:c.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[c.jsx("strong",{children:"Example:"}),' Prefix "family" with 5 tables creates: family1, family2, family3, family4, family5']})}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Table Prefix"}),c.jsx("input",{type:"text",placeholder:"e.g., family, special",value:x,onChange:F=>m(F.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"(prefix1, prefix2...)"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Quantity"}),c.jsx("input",{type:"number",min:"0",placeholder:"0",value:p,onChange:F=>v(F.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Capacity"}),c.jsx("input",{type:"number",min:"1",value:y,onChange:F=>b(F.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:!p||Number(p)===0}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]})]}),k>0&&c.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:c.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:[c.jsx("strong",{children:"Total:"})," ",k," tables will be created"]})}),c.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",disabled:l,children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",loading:l,disabled:k===0,children:l?"Creating...":`Create ${k} Table${k!==1?"s":""}`})]})]})})},ih=({isOpen:e,onClose:t,initial:r})=>{const{eventId:a}=Hr(),[n,l]=A.useState((r==null?void 0:r.name)||""),[o,f]=A.useState((r==null?void 0:r.capacity.toString())||"1"),[d,x]=A.useState(null),m=cU(a),p=fU((r==null?void 0:r.id)||"",a);A.useEffect(()=>{e&&(l((r==null?void 0:r.name)||""),f(((r==null?void 0:r.capacity)??10).toString()),x(null))},[e,r]);const v=!!r,y=async b=>{b.preventDefault();const w={name:n.trim(),capacity:Number(o),eventId:a};try{v&&r?await p.mutateAsync(w):await m.mutateAsync(w),t()}catch(E){console.error(E),x(E.message??"Something went wrong.")}};return c.jsx($n,{isOpen:e,onClose:t,title:v?"Edit Table":"New Table",children:c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[d&&c.jsx(hu,{message:d}),c.jsx(Zt,{label:"Table Name",value:n,onChange:b=>l(b.target.value)}),c.jsx(Zt,{label:"Capacity",type:"number",value:o,onChange:b=>f(b.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",children:v?"Save":"Create"})]})]})})};function kU(){const{eventId:e}=Hr(),{data:t=[],isLoading:r,isError:a}=sh(e),{data:n=[],isLoading:l,isError:o}=nh(e),f=nk(e),d=a1(e||""),x=n1(e||""),[m,p]=A.useState(""),[v,y]=A.useState("all"),[b,w]=A.useState(null),[E,_]=A.useState(null),[N,k]=A.useState(!1),[F,j]=A.useState(!1),[R,T]=A.useState(null),[C,O]=A.useState(null),V=A.useMemo(()=>{const Z=n.filter(U=>U.tableId).reduce((U,Y)=>U+(Y.pax||Y.noOfPax||1),0),L=n.filter(U=>!U.tableId).reduce((U,Y)=>U+(Y.pax||Y.noOfPax||1),0),P=t.reduce((U,Y)=>U+Y.capacity,0);return{totalTables:t.length,seatedGuests:Z,unassigned:L,totalCapacity:P}},[t,n]),z=A.useMemo(()=>n.filter(Z=>!Z.tableId),[n]),H=A.useMemo(()=>t.map(Z=>{const L=n.filter(P=>P.tableId===Z.id);return{...Z,guests:L.map(P=>({id:P.id,guestName:P.guestName||P.name,paxCount:P.pax||P.noOfPax||1})),assignedCount:L.reduce((P,U)=>P+(U.pax||U.noOfPax||1),0)}}),[t,n]),ie=A.useMemo(()=>H.filter(Z=>!(m&&!Z.name.toLowerCase().includes(m.toLowerCase())&&!Z.guests.some(P=>P.guestName.toLowerCase().includes(m.toLowerCase()))||v==="hasEmpty"&&Z.assignedCount>=Z.capacity||v==="full"&&Z.assignedCount<Z.capacity)),[H,m,v]);if(!e)return c.jsx(Yl,{title:"No Events for Table Management",message:"Create your first event to start organizing seating arrangements and table assignments."});if(r||l)return c.jsx(an,{message:"Loading tables..."});if(a||o)return c.jsx("p",{children:"Failed to load data."});const we=Z=>{const L=n.find(P=>P.id===Z);L&&(w(Z),_({id:Z,paxCount:L.pax||L.noOfPax||1}))},ge=()=>{w(null),_(null)},ee=(Z,L)=>{const P=n.find(ve=>ve.id===Z),U=H.find(ve=>ve.id===L);if(!P||!U)return;const Y=P.pax||P.noOfPax||1,re=U.capacity-U.assignedCount;if(Y>re){tn.error(`Cannot assign guest. This guest requires ${Y} seat(s), but only ${re} seat(s) available in ${U.name}.`,{duration:4e3});return}d.mutate({guestId:Z,tableId:L})},le=Z=>{x.mutate(Z)},ne=Z=>{const L=H.find(P=>P.id===Z);L&&T({id:L.id,name:L.name,capacity:L.capacity})},te=Z=>{const L=H.find(P=>P.id===Z);L&&O({id:L.id,name:L.name})},I=()=>{C&&(f.mutate(C.id),O(null))};return c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[c.jsx(Bi,{label:"Total Tables",value:V.totalTables,variant:"primary"}),c.jsx(Bi,{label:"Seated Guests",value:V.seatedGuests,variant:"success"}),c.jsx(Bi,{label:"Unassigned",value:V.unassigned,variant:"warning"}),c.jsx(Bi,{label:"Total Capacity",value:V.totalCapacity,variant:"secondary"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Table Arrangement"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs(Me,{variant:"secondary",disabled:!0,className:"opacity-50 cursor-not-allowed flex items-center gap-2",title:"Coming Soon",children:["Auto-Assign",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),c.jsxs(yU,{trigger:c.jsxs(Me,{children:["+ New Table ",c.jsx("span",{className:"ml-1",children:""})]}),children:[c.jsx(Wp,{onClick:()=>j(!0),children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Create Single Table"}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create one table at a time"})]})}),c.jsx(Wp,{onClick:()=>k(!0),children:c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:["Bulk Create"," ",c.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full",children:"Recommended"})]}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create by category or custom prefix"})]})})]})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[c.jsxs("select",{className:"w-full md:w-1/4 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:v,onChange:Z=>y(Z.target.value),children:[c.jsx("option",{value:"all",children:"All Tables"}),c.jsx("option",{value:"hasEmpty",children:"Has Empty Seats"}),c.jsx("option",{value:"full",children:"Full Tables"})]}),c.jsx("input",{placeholder:"Search guests or tables...",className:"w-full md:flex-1 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:m,onChange:Z=>p(Z.target.value)})]}),c.jsx("div",{className:"mb-6 p-4 rounded-xl bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-100 dark:border-indigo-800",children:c.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[c.jsx("strong",{children:"Tip:"})," Drag guests from the unassigned panel and drop them onto tables"]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 flex-1 min-h-0",children:[c.jsx("div",{className:"lg:col-span-1 lg:max-h-full",children:c.jsxs("div",{className:"lg:sticky lg:top-0 bg-white dark:bg-accent rounded-xl shadow-lg p-4 border border-gray-200 dark:border-gray-700",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Unassigned Guests (",z.length,")"]}),c.jsx("div",{className:"space-y-2 max-h-96 lg:max-h-[calc(100vh-350px)] overflow-y-auto",children:z.length===0?c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-8",children:"All guests have been assigned!"}):z.map(Z=>{var L,P;return c.jsx(bU,{guest:{id:Z.id,guestName:Z.guestName||Z.name,phoneNo:Z.phoneNo,paxCount:Z.pax||Z.noOfPax||1,isVip:(L=Z.remarks||Z.notes)==null?void 0:L.toLowerCase().includes("vip"),dietaryRestrictions:(P=Z.remarks||Z.notes)!=null&&P.toLowerCase().includes("vegetarian")?["Vegetarian"]:void 0},onDragStart:we,onDragEnd:ge,isDragging:b===Z.id},Z.id)})})]})}),c.jsx("div",{className:"lg:col-span-3 overflow-y-auto",children:ie.length===0?c.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70 dark:bg-accent/70",children:[c.jsx("p",{className:"text-lg font-semibold",children:"No tables found."}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:m?"No tables match your search. Try a different search term.":"Create your first table to start organizing your seating arrangements."}),c.jsx(Me,{onClick:()=>j(!0),children:"+ Create First Table"})]}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 pb-6",children:ie.map(Z=>c.jsx(wU,{table:Z,onDrop:ee,onEdit:ne,onDelete:te,onUnassignGuest:le,isDropTarget:!!b,draggedGuest:E},Z.id))})})]}),c.jsx(_U,{isOpen:N,onClose:()=>k(!1)}),c.jsx(ih,{isOpen:F||!!R,onClose:()=>{j(!1),T(null)},initial:R||void 0}),c.jsx(Eu,{isOpen:!!C,isDeleting:f.isPending,onConfirm:I,onCancel:()=>O(null),title:"Delete Table",description:"Are you sure you want to delete this table? This action cannot be undone.",children:C&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:C.name}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Table ID: ",C.id]})]})})})})]})}function TU(){const{tableId:e}=Nn(),t=ja(),{data:r,isLoading:a,isError:n}=_u(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Xn,{})}):n||!r?c.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load table."}):c.jsx(ih,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function NU(){return Qr({queryKey:["seating"],queryFn:async()=>(await Xe.get(uu.all)).data,staleTime:5*6e4})}function CU(e){return Qr({queryKey:["seating",e],queryFn:async()=>(await Xe.get(uu.byId(e))).data})}function AU(){const e=wt();return kt({mutationFn:async t=>(await Xe.post(uu.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}function jU(e){const t=wt();return kt({mutationFn:async r=>(await Xe.put(uu.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["seating"]})})}function RU(){const e=wt();return kt({mutationFn:async t=>(await Xe.delete(uu.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}const s1=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=A.useState((r==null?void 0:r.tableId)||""),[l,o]=A.useState((r==null?void 0:r.guestId)||""),f=AU(),d=jU((r==null?void 0:r.id)||""),[x,m]=A.useState(null);A.useEffect(()=>{e&&(n((r==null?void 0:r.tableId)||""),o((r==null?void 0:r.guestId)||""))},[e,r]);const p=!!r,v=async y=>{var w,E;y.preventDefault();const b={tableId:a,guestId:l};try{p&&r?await d.mutateAsync(b):await f.mutateAsync(b),t()}catch(_){console.error(_),m(((E=(w=_.response)==null?void 0:w.data)==null?void 0:E.message)||"Something went wrong.")}};return c.jsx($n,{isOpen:e,onClose:t,title:p?"Edit Seating":"New Seating",children:c.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&c.jsx(hu,{message:x}),c.jsx(Zt,{label:"Table ID",value:a,onChange:y=>n(y.target.value)}),c.jsx(Zt,{label:"Guest ID",value:l,onChange:y=>o(y.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",children:p?"Save":"Create"})]})]})})};function DU(){const{data:e,isLoading:t,isError:r}=NU(),a=RU(),[n,l]=A.useState({open:!1}),[o,f]=A.useState({open:!1,seat:null});if(t)return c.jsx(an,{});if(r)return c.jsx("p",{children:"Failed to load seating."});const d=p=>{f({open:!0,seat:p})},x=()=>{f({open:!1,seat:null})},m=async()=>{if(o.seat)try{await a.mutateAsync(o.seat.id),f({open:!1,seat:null})}catch(p){console.error("Failed to delete seat:",p)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Seating"}),c.jsx(Me,{onClick:()=>l({open:!0}),children:"New Seating"})]}),c.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-lg font-medium",children:["Table: ",p.tableId]}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Guest: ",p.guestId]})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:()=>l({open:!0,seat:{id:p.id,tableId:p.tableId,guestId:p.guestId}}),children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:()=>d({id:p.id,tableId:p.tableId,guestId:p.guestId}),children:"Delete"})]})]},p.id))}),c.jsx(s1,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.seat}),c.jsx(Eu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete Seating Assignment?",description:"Are you sure you want to delete this seating assignment? This action cannot be undone.",children:o.seat&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:["Table ID: ",o.seat.tableId]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Guest ID: ",o.seat.guestId]})]})})})})]})}function FU(){const{id:e}=Nn(),t=ja(),{data:r,isLoading:a,isError:n}=CU(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Xn,{})}):n||!r?c.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load seating."}):c.jsx(s1,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function OU(){return Qr({queryKey:["users"],queryFn:async()=>(await Xe.get(fu.all)).data,staleTime:5*6e4})}function MU(e){return Qr({queryKey:["user",e],queryFn:async()=>(await Xe.get(fu.byId(e))).data})}function LU(){const e=wt();return kt({mutationFn:async t=>(await Xe.post(fu.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}function BU(e){const t=wt();return kt({mutationFn:async r=>(await Xe.put(fu.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["users"]})})}function PU(){const e=wt();return kt({mutationFn:async t=>(await Xe.delete(fu.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}const i1=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=A.useState((r==null?void 0:r.name)||""),[l,o]=A.useState((r==null?void 0:r.email)||""),f=LU(),d=BU((r==null?void 0:r.id)||""),[x,m]=A.useState(null);A.useEffect(()=>{e&&(n((r==null?void 0:r.name)||""),o((r==null?void 0:r.email)||""))},[e,r]);const p=!!r,v=async y=>{var w,E;y.preventDefault();const b={name:a,email:l};try{p&&r?await d.mutateAsync(b):await f.mutateAsync(b),t()}catch(_){console.error(_),m(((E=(w=_.response)==null?void 0:w.data)==null?void 0:E.message)||"Something went wrong.")}};return c.jsx($n,{isOpen:e,onClose:t,title:p?"Edit User":"New User",children:c.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&c.jsx(hu,{message:x}),c.jsx(Zt,{label:"Name",value:a,onChange:y=>n(y.target.value)}),c.jsx(Zt,{label:"Email",type:"email",value:l,onChange:y=>o(y.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Me,{variant:"primary",type:"submit",children:p?"Save":"Create"})]})]})})};function IU(){const{data:e,isLoading:t,isError:r}=OU(),a=PU(),[n,l]=A.useState({open:!1}),[o,f]=A.useState({open:!1,user:null});if(t)return c.jsx(an,{message:"Loading users..."});if(r)return c.jsx("p",{children:"Failed to load users."});const d=p=>{f({open:!0,user:p})},x=()=>{f({open:!1,user:null})},m=async()=>{if(o.user)try{await a.mutateAsync(o.user.id),f({open:!1,user:null})}catch(p){console.error("Failed to delete user:",p)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Users"}),c.jsx(Me,{onClick:()=>l({open:!0}),children:" New User"})]}),c.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-lg font-medium",children:p.name}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.email})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:()=>l({open:!0,user:{id:p.id,name:p.name,email:p.email}}),children:"Edit"}),c.jsx(Me,{variant:"secondary",onClick:()=>d({id:p.id,name:p.name,email:p.email}),children:"Delete"})]})]},p.id))}),c.jsx(i1,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.user}),c.jsx(Eu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete User?",description:"Are you sure you want to delete this user? This action cannot be undone.",children:o.user&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:o.user.name}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Email: ",o.user.email]})]})})})})]})}function UU(){const{id:e}=Nn(),t=ja(),{data:r,isLoading:a,isError:n}=MU(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Xn,{})}):n||!r?c.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load user."}):c.jsx(i1,{isOpen:!0,initial:r,onClose:()=>t(-1)})}const sk="wallet-budget-",ik=(e,t)=>{try{localStorage.setItem(`${sk}${e}`,t.toString())}catch(r){console.error("Failed to save budget to localStorage:",r)}},zU=e=>{try{const t=localStorage.getItem(`${sk}${e}`);if(t===null)return null;const r=parseFloat(t);return isNaN(r)?null:r}catch(t){return console.error("Failed to read budget from localStorage:",t),null}};function l1(e){return{...e,totalBudget:e.budget,currency:e.currency}}function HU(e){return Qr({queryKey:["wallet",e],queryFn:async()=>{var t,r;try{const a=await Xe.get(cg.getByEvent(e));console.log("Wallet API Response:",a.data);const n=((t=a.data)==null?void 0:t.data)??a.data;if(!n||!Array.isArray(n)||n.length===0)return console.log("No wallet found in response"),null;const l=n[0];console.log("Found wallet (raw):",l);const o=l1(l);if(o.totalBudget===void 0||o.totalBudget===null){const f=zU(o.walletGuid);f!==null&&(o.totalBudget=f,console.log("Using localStorage budget (fallback):",f))}else console.log("Using backend budget:",o.totalBudget);return o}catch(a){if(console.error("Wallet API Error:",a),((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:1*6e4,refetchOnMount:!0})}function GU(){const e=wt();return kt({mutationFn:async({totalBudget:t,...r})=>{var f;const a={...r,budget:t};console.log("Creating wallet, payload:",a);const n=await Xe.post(cg.create,a),l=((f=n.data)==null?void 0:f.data)??n.data;console.log("Wallet created, backend response:",l);const o=l1(l);return t!==void 0&&o.walletGuid&&(ik(o.walletGuid,t),console.log("Saved budget to localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet"]}),e.refetchQueries({queryKey:["wallet",t.eventGuid]})}})}function VU(){const e=wt();return kt({mutationFn:async({totalBudget:t,...r})=>{var f;const a={...r,budget:t};console.log("Updating wallet, payload:",a);const n=await Xe.post(cg.update,a),l=((f=n.data)==null?void 0:f.data)??n.data;console.log("Wallet updated, backend response:",l);const o=l1(l);return t!==void 0&&o.walletGuid&&(ik(o.walletGuid,t),console.log("Updated budget in localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet",t.eventGuid]}),e.invalidateQueries({queryKey:["wallet",t.walletGuid]})}})}const Ca={Credit:0,Debit:1},Ea={Venue:"Venue",Catering:"Catering",Photography:"Photography",Decoration:"Decoration",Attire:"Attire",Entertainment:"Entertainment",Transport:"Transport",Invitation:"Invitation",Gifts:"Gifts",Others:"Others"},tr={Paid:"Paid",Pending:"Pending",Overdue:"Overdue"},qU=e=>{let t={_extended:{},notes:""};if(e.remarks)try{const r=JSON.parse(e.remarks);r&&typeof r=="object"&&"_extended"in r?t=r:t.notes=e.remarks}catch{t.notes=e.remarks}return{...e,category:e.category,remarks:t.notes||"",vendorName:t._extended.vendorName,vendorContact:t._extended.vendorContact,paymentStatus:t._extended.paymentStatus,dueDate:t._extended.dueDate}},WU=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},XU=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{transactionGuid:e.transactionGuid,walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},Io=(e,t="RM")=>{const a=Math.abs(e).toLocaleString("en-MY",{minimumFractionDigits:2,maximumFractionDigits:2});return`${t} ${a}`},lk=e=>e===0?"Credit":"Debit";function $U(e,t){return Qr({queryKey:["transactions",e],queryFn:async()=>{var r,a;try{const n=await Xe.get(qd.getByWallet(e,t)),l=((r=n.data)==null?void 0:r.data)??n.data;return!l||!Array.isArray(l)?[]:l.map(o=>qU(o))}catch(n){if(((a=n.response)==null?void 0:a.status)===404)return[];throw n}},enabled:!!e&&!!t,staleTime:2*6e4})}function YU(){const e=wt();return kt({mutationFn:async t=>{var n;const r=WU(t),a=await Xe.post(qd.create,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function KU(){const e=wt();return kt({mutationFn:async t=>{var n;const r=XU(t),a=await Xe.post(qd.update,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function QU(){const e=wt();return kt({mutationFn:async t=>{var a;const r=await Xe.post(qd.delete,t);return((a=r.data)==null?void 0:a.data)??r.data},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]})}})}const pl={MYR:"MYR",USD:"USD",SGD:"SGD",IDR:"IDR"},ic={[pl.MYR]:{flag:"",label:"Malaysian Ringgit",symbol:"RM"},[pl.USD]:{flag:"",label:"US Dollar",symbol:"$"},[pl.SGD]:{flag:"",label:"Singapore Dollar",symbol:"S$"},[pl.IDR]:{flag:"",label:"Indonesian Rupiah",symbol:"Rp"}},tS=({isOpen:e,onClose:t,eventGuid:r,userId:a,wallet:n})=>{const[l,o]=A.useState(pl.MYR),[f,d]=A.useState(""),[x,m]=A.useState({}),p=GU(),v=VU(),y=!!n;A.useEffect(()=>{var N;n?(o(n.currency),d(((N=n.totalBudget)==null?void 0:N.toString())||"")):(o(pl.MYR),d("")),m({})},[n,e]);const b=()=>{const N={};if(l||(N.currency="Please select a currency"),f){const k=parseFloat(f);(isNaN(k)||k<=0)&&(N.budget="Budget must be a positive number")}return m(N),Object.keys(N).length===0},w=async N=>{if(N.preventDefault(),!b())return;const k=f?parseFloat(f):void 0;try{if(y&&n)console.log("Updating wallet:",{eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:k}),await v.mutateAsync({eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:k});else{console.log("Creating wallet:",{eventGuid:r,userId:a,currency:l,totalBudget:k});const F=await p.mutateAsync({eventGuid:r,userId:a,currency:l,totalBudget:k});console.log("Wallet created successfully:",F)}t()}catch(F){console.error("Failed to save wallet:",F),alert("Failed to save wallet: "+F.message)}},E=()=>{!p.isPending&&!v.isPending&&t()},_=[{label:"Venue",percentage:"30%"},{label:"Catering",percentage:"25%"},{label:"Photography",percentage:"15%"},{label:"Decoration",percentage:"10%"},{label:"Attire",percentage:"10%"},{label:"Others",percentage:"10%"}];return c.jsx($n,{isOpen:e,onClose:E,title:y?"Update Wallet":"Setup Wallet",className:"max-w-md",children:c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y?"Update your wallet configuration":"Configure your event budget and currency"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Currency *"}),c.jsx("select",{value:l,onChange:N=>o(N.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:Object.values(pl).map(N=>{const k=ic[N];return c.jsxs("option",{value:N,children:[k.flag," ",N," - ",k.label]},N)})}),x.currency&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.currency})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Total Budget (Optional)"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:ic[l].symbol}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:f,onChange:N=>d(N.target.value),placeholder:"50000",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 pl-12 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Set your maximum budget for this event"}),x.budget&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.budget})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-primary/5 to-secondary/5 border border-primary/10",children:[c.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:" Suggested Budget Allocation"}),c.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400",children:_.map(N=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:[N.label,":"]}),c.jsx("span",{className:"font-medium",children:N.percentage})]},N.label))})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Me,{type:"button",variant:"secondary",onClick:E,disabled:p.isPending||v.isPending,className:"flex-1",children:"Cancel"}),c.jsx(Me,{type:"submit",variant:"primary",loading:p.isPending||v.isPending,className:"flex-1 bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:y?"Update Wallet":"Create Wallet"})]}),(p.isError||v.isError)&&c.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save wallet. Please try again."})]})})},eu={[Ea.Venue]:{emoji:"",label:"Venue",color:"purple",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"},[Ea.Catering]:{emoji:"",label:"Catering",color:"orange",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"},[Ea.Photography]:{emoji:"",label:"Photography",color:"pink",bgColor:"bg-pink-100",textColor:"text-pink-700",borderColor:"border-pink-200"},[Ea.Decoration]:{emoji:"",label:"Decoration",color:"teal",bgColor:"bg-teal-100",textColor:"text-teal-700",borderColor:"border-teal-200"},[Ea.Attire]:{emoji:"",label:"Attire",color:"indigo",bgColor:"bg-indigo-100",textColor:"text-indigo-700",borderColor:"border-indigo-200"},[Ea.Entertainment]:{emoji:"",label:"Entertainment",color:"violet",bgColor:"bg-violet-100",textColor:"text-violet-700",borderColor:"border-violet-200"},[Ea.Transport]:{emoji:"",label:"Transport",color:"blue",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"},[Ea.Invitation]:{emoji:"",label:"Invitation",color:"rose",bgColor:"bg-rose-100",textColor:"text-rose-700",borderColor:"border-rose-200"},[Ea.Gifts]:{emoji:"",label:"Gifts",color:"amber",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"},[Ea.Others]:{emoji:"",label:"Others",color:"gray",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}},rS=e=>eu[e]||eu[Ea.Others],ok=()=>Object.values(Ea),ZU=({isOpen:e,onClose:t,walletGuid:r,eventGuid:a,transaction:n})=>{const[l,o]=A.useState(Ca.Debit),[f,d]=A.useState(""),[x,m]=A.useState(""),[p,v]=A.useState(""),[y,b]=A.useState(Ea.Others),[w,E]=A.useState(""),[_,N]=A.useState(""),[k,F]=A.useState(tr.Paid),[j,R]=A.useState(""),[T,C]=A.useState(""),[O,V]=A.useState(""),[z,H]=A.useState({}),ie=YU(),we=KU(),ge=!!n;A.useEffect(()=>{n?(o(n.type),d(n.transactionName),m(n.amount.toString()),v(n.transactionDate?new Date(n.transactionDate).toISOString().split("T")[0]:""),b(n.category),E(n.vendorName||""),N(n.vendorContact||""),F(n.paymentStatus||tr.Paid),R(n.dueDate?new Date(n.dueDate).toISOString().split("T")[0]:""),C(n.referenceId||""),V(n.remarks||"")):ee(),H({})},[n,e]);const ee=()=>{o(Ca.Debit),d(""),m(""),v(new Date().toISOString().split("T")[0]),b(Ea.Others),E(""),N(""),F(tr.Paid),R(""),C(""),V("")},le=()=>{const I={};if(f.trim()||(I.transactionName="Transaction name is required"),!x)I.amount="Amount is required";else{const Z=parseFloat(x);(isNaN(Z)||Z<=0)&&(I.amount="Amount must be a positive number")}return p||(I.transactionDate="Transaction date is required"),y||(I.category="Category is required"),H(I),Object.keys(I).length===0},ne=async I=>{if(I.preventDefault(),!le())return;const Z={walletGuid:r,eventGuid:a,type:l,transactionName:f.trim(),amount:parseFloat(x),transactionDate:p,category:y,vendorName:w.trim()||void 0,vendorContact:_.trim()||void 0,paymentStatus:k,dueDate:j||void 0,referenceId:T.trim()||void 0,remarks:O.trim()||void 0};try{ge&&n?await we.mutateAsync({...Z,transactionGuid:n.transactionGuid}):await ie.mutateAsync(Z),t()}catch(L){console.error("Failed to save transaction:",L)}},te=()=>{!ie.isPending&&!we.isPending&&t()};return c.jsx($n,{isOpen:e,onClose:te,title:ge?"Edit Transaction":"Add Transaction",className:"max-w-lg max-h-[90vh] overflow-y-auto",children:c.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:ge?"Update transaction details":"Record a new expense or income"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Transaction Type *"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>o(Ca.Debit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===Ca.Debit?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-red-500 hover:bg-red-50 dark:hover:bg-red-900/10"}`,children:[c.jsx("span",{children:""})," Debit (Expense)"]}),c.jsxs("button",{type:"button",onClick:()=>o(Ca.Credit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===Ca.Credit?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/10"}`,children:[c.jsx("span",{children:""})," Credit (Income)"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Transaction Name *"}),c.jsx("input",{type:"text",value:f,onChange:I=>d(I.target.value),placeholder:"e.g. Venue Deposit Payment",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),z.transactionName&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:z.transactionName})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount *"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:x,onChange:I=>m(I.target.value),placeholder:"0.00",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),z.amount&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:z.amount})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date *"}),c.jsx("input",{type:"date",value:p,onChange:I=>v(I.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),z.transactionDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:z.transactionDate})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category *"}),c.jsx("select",{value:y,onChange:I=>b(I.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:ok().map(I=>{const Z=eu[I];return c.jsxs("option",{value:I,children:[Z.emoji," ",Z.label]},I)})}),z.category&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:z.category})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Vendor Information (Optional)"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Vendor Name"}),c.jsx("input",{type:"text",value:w,onChange:I=>E(I.target.value),placeholder:"e.g. Shangri-La Hotel",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Contact Number / Email"}),c.jsx("input",{type:"text",value:_,onChange:I=>N(I.target.value),placeholder:"e.g. +60 3-2074 3900",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Status"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{type:"button",onClick:()=>F(tr.Paid),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===tr.Paid?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Paid"}),c.jsx("button",{type:"button",onClick:()=>F(tr.Pending),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===tr.Pending?"border-amber-500 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Pending"}),c.jsx("button",{type:"button",onClick:()=>F(tr.Overdue),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===tr.Overdue?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Overdue"})]})]}),(k===tr.Pending||k===tr.Overdue)&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due Date (Optional)"}),c.jsx("input",{type:"date",value:j,onChange:I=>R(I.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reference ID (Optional)"}),c.jsx("input",{type:"text",value:T,onChange:I=>C(I.target.value),placeholder:"e.g. Invoice number, Receipt ID",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remarks (Optional)"}),c.jsx("textarea",{rows:2,value:O,onChange:I=>V(I.target.value),placeholder:"Additional notes...",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none"})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Me,{type:"button",variant:"secondary",onClick:te,disabled:ie.isPending||we.isPending,className:"flex-1",children:"Cancel"}),c.jsx(Me,{type:"submit",variant:"primary",loading:ie.isPending||we.isPending,className:"flex-1",children:ge?"Update Transaction":"Save Transaction"})]}),(ie.isError||we.isError)&&c.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save transaction. Please try again."})]})})},JU=({isOpen:e,onClose:t,transactions:r,wallet:a})=>{const[n,l]=A.useState(""),[o,f]=A.useState(""),[d,x]=A.useState("csv"),[m,p]=A.useState(!0),[v,y]=A.useState(!0),[b,w]=A.useState(!1),E=k=>!n&&!o?k:k.filter(F=>{if(!F.transactionDate)return!1;const j=new Date(F.transactionDate),R=n?new Date(n):null,T=o?new Date(o):null;return!(R&&j<R||T&&j>T)}),_=()=>{const k=E(r);if(k.length===0){alert("No transactions to export with the selected date range.");return}const F=ic[a.currency].symbol;let j="";if(j+=`Event Wallet Report
`,j+=`Currency: ${a.currency}
`,j+=`Generated: ${new Date().toLocaleDateString()}
`,j+=`Date Range: ${n||"All"} to ${o||"All"}
`,j+=`
`,m){j+=`Transaction Details
`;const O=["Date","Transaction Name","Type","Category",b?"Vendor":null,b?"Vendor Contact":null,"Amount","Status","Reference ID","Remarks"].filter(Boolean);j+=O.join(",")+`
`,k.forEach(V=>{const z=[V.transactionDate||"",`"${V.transactionName.replace(/"/g,'""')}"`,lk(V.type),V.category,b?`"${(V.vendorName||"").replace(/"/g,'""')}"`:null,b?`"${(V.vendorContact||"").replace(/"/g,'""')}"`:null,V.amount,V.paymentStatus||"",V.referenceId||"",`"${(V.remarks||"").replace(/"/g,'""')}"`].filter(H=>H!==null);j+=z.join(",")+`
`}),j+=`
`}if(v){j+=`Category Summary
`,j+=`Category,Total Spent,Percentage,Transaction Count
`;const O=new Map,V=k.filter(z=>z.type===1).reduce((z,H)=>z+H.amount,0);k.filter(z=>z.type===1).forEach(z=>{const H=O.get(z.category)||{amount:0,count:0};O.set(z.category,{amount:H.amount+z.amount,count:H.count+1})}),O.forEach((z,H)=>{const ie=V>0?z.amount/V*100:0;j+=`${H},${F} ${z.amount.toFixed(2)},${ie.toFixed(1)}%,${z.count}
`}),j+=`
`,j+=`Total Spending,${F} ${V.toFixed(2)}
`}const R=new Blob([j],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),C=URL.createObjectURL(R);T.setAttribute("href",C),T.setAttribute("download",`wallet-report-${Date.now()}.csv`),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T),t()},N=()=>{d==="csv"?_():alert(`${d.toUpperCase()} export coming soon!`)};return c.jsx($n,{isOpen:e,onClose:t,title:"Export Report",className:"max-w-md",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Download your transaction report"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"From"}),c.jsx("input",{type:"date",value:n,onChange:k=>l(k.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"To"}),c.jsx("input",{type:"date",value:o,onChange:k=>f(k.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Export Format"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>x("csv"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="csv"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="csv"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"CSV"})]}),c.jsxs("button",{type:"button",onClick:()=>x("excel"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="excel"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="excel"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"Excel"})]}),c.jsxs("button",{type:"button",onClick:()=>x("pdf"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="pdf"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="pdf"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"PDF"})]})]}),d!=="csv"&&c.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:["Note: ",d.toUpperCase()," export is coming soon. CSV is currently available."]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Include in Report"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:m,onChange:k=>p(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Transaction details"})]}),c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:v,onChange:k=>y(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Category summary"})]}),c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:b,onChange:k=>w(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Vendor information"})]})]})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Me,{type:"button",variant:"secondary",onClick:t,className:"flex-1",children:"Cancel"}),c.jsxs(Me,{type:"button",variant:"primary",onClick:N,className:"flex-1",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Download"]})]})]})})},ez=({wallet:e,transactions:t,onEditBudget:r})=>{const a=ic[e.currency].symbol,n=t.filter(m=>m.type===Ca.Debit).reduce((m,p)=>m+p.amount,0),l=t.filter(m=>m.type===Ca.Debit&&(m.paymentStatus===tr.Pending||m.paymentStatus===tr.Overdue)).reduce((m,p)=>m+p.amount,0),o=t.filter(m=>m.type===Ca.Debit&&(m.paymentStatus===tr.Pending||m.paymentStatus===tr.Overdue)).length,f=e.totalBudget||0,d=f-n,x=f>0?n/f*100:0;return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[c.jsxs("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-primary to-secondary text-white shadow-xl shadow-primary/20 cursor-pointer hover:shadow-2xl transition-shadow",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-white/20 backdrop-blur grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})})}),c.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/20 font-medium",children:e.currency})]}),c.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Total Budget"}),c.jsx("p",{className:"text-3xl font-bold mt-1",children:f>0?Io(f,a):"Not Set"}),c.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-white/70",children:c.jsxs("button",{onClick:r,className:"hover:text-white transition-colors",children:[" Click to ",f>0?"edit":"set"," budget"]})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-red-100 dark:bg-red-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-red-600 dark:text-red-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"})})}),f>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 font-semibold",children:[x.toFixed(0),"%"]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Current Spending"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800 dark:text-white mt-1",children:Io(n,a)}),f>0&&c.jsx("div",{className:"mt-3",children:c.jsx("div",{className:"w-full h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-red-400 to-red-600 rounded-full transition-all duration-500",style:{width:`${Math.min(x,100)}%`}})})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-emerald-100 dark:bg-emerald-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-emerald-600 dark:text-emerald-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 font-semibold",children:[(100-x).toFixed(0),"%"]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Remaining Budget"}),c.jsx("p",{className:`text-3xl font-bold mt-1 ${f>0?d>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:f>0?Io(d,a):"N/A"}),c.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs",children:f>0?d>=0?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:""}),c.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"On track"})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),c.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Over budget"})]}):c.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"Set budget to track"})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-amber-100 dark:bg-amber-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-amber-600 dark:text-amber-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 font-semibold",children:[o," item",o!==1?"s":""]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Pending Payments"}),c.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400 mt-1",children:Io(l,a)}),c.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-amber-600 dark:text-amber-400",children:[t.filter(m=>m.paymentStatus===tr.Overdue).length>0&&c.jsxs("span",{children:[""," ",t.filter(m=>m.paymentStatus===tr.Overdue).length," ","overdue payment",t.filter(m=>m.paymentStatus===tr.Overdue).length!==1?"s":""]}),o===0&&c.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:" All paid"})]})]})]})},tz=({wallet:e,transactions:t})=>{const r=ic[e.currency].symbol,a=t.filter(o=>o.type===Ca.Debit).reduce((o,f)=>o+f.amount,0),n=new Map;t.filter(o=>o.type===Ca.Debit).forEach(o=>{const f=n.get(o.category)||{amount:0,count:0};n.set(o.category,{amount:f.amount+o.amount,count:f.count+1})});const l=Array.from(n.entries()).map(([o,f])=>({category:o,amount:f.amount,percentage:a>0?f.amount/a*100:0,transactionCount:f.count})).sort((o,f)=>f.amount-o.amount);return l.length===0?c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),c.jsx("div",{className:"p-8 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm text-center",children:c.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No spending data yet. Start adding transactions to see your spending breakdown."})})]}):c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[l.map(({category:o,amount:f,percentage:d,transactionCount:x})=>{const m=rS(o),p=m.color;return c.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-xl",children:m.emoji}),c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:m.label})]}),c.jsx("p",{className:"text-lg font-bold text-slate-800 dark:text-white",children:Io(f,r)}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:`h-full rounded-full transition-all duration-500 bg-${p}-500`,style:{width:`${Math.min(d,100)}%`}})}),c.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:[d.toFixed(0),"%"]})]}),c.jsxs("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[x," transaction",x!==1?"s":""]})]},o)}),Object.values(Ea).filter(o=>!n.has(o)).slice(0,Math.max(0,6-l.length)).map(o=>{const f=rS(o);return c.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700 opacity-50",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-xl",children:f.emoji}),c.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:f.label})]}),c.jsxs("p",{className:"text-lg font-bold text-gray-400 dark:text-gray-500",children:[r," 0.00"]}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full",style:{width:"0%"}})}),c.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"0%"})]})]},o)})]})]})},rz=({wallet:e,transactions:t,onEditTransaction:r})=>{const[a,n]=A.useState("All"),[l,o]=A.useState("All"),[f,d]=A.useState("All"),[x,m]=A.useState(""),[p,v]=A.useState({open:!1,transaction:null}),y=QU(),b=ic[e.currency].symbol,w=A.useMemo(()=>t.filter(R=>{var T,C;if(a!=="All"&&R.category!==a)return!1;if(l!=="All"){const O=l==="Debit";if(O&&R.type!==Ca.Debit||!O&&R.type!==Ca.Credit)return!1}if(f!=="All"&&R.paymentStatus!==f)return!1;if(x){const O=x.toLowerCase();return R.transactionName.toLowerCase().includes(O)||((T=R.vendorName)==null?void 0:T.toLowerCase().includes(O))||((C=R.referenceId)==null?void 0:C.toLowerCase().includes(O))}return!0}),[t,a,l,f,x]),E=A.useMemo(()=>[...w].sort((R,T)=>{const C=R.transactionDate?new Date(R.transactionDate).getTime():0;return(T.transactionDate?new Date(T.transactionDate).getTime():0)-C}),[w]),_=R=>{v({open:!0,transaction:R})},N=()=>{v({open:!1,transaction:null})},k=async()=>{if(p.transaction)try{await y.mutateAsync({transactionGuid:p.transaction.transactionGuid,walletGuid:p.transaction.walletGuid,eventGuid:p.transaction.eventGuid}),v({open:!1,transaction:null})}catch(R){console.error("Failed to delete transaction:",R),alert("Failed to delete transaction. Please try again.")}},F=R=>{if(!R)return null;const C={[tr.Paid]:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400",dot:"bg-emerald-500",label:"Paid",icon:""},[tr.Pending]:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",dot:"bg-amber-500",label:"Pending",icon:""},[tr.Overdue]:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",dot:"bg-red-500 animate-pulse",label:"Overdue",icon:""}}[R];return c.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${C.bg} ${C.text} flex items-center gap-1 w-fit`,children:[c.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${C.dot}`}),C.label]})},j=R=>{let T="transaction-row transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/50";return R.paymentStatus===tr.Pending?T+=" bg-amber-50/30 dark:bg-amber-900/10":R.paymentStatus===tr.Overdue&&(T+=" bg-red-50/30 dark:bg-red-900/10"),T};return c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:a,onChange:R=>n(R.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Categories"}),ok().map(R=>{const T=eu[R];return c.jsxs("option",{value:R,children:[T.emoji," ",T.label]},R)})]}),c.jsxs("select",{value:l,onChange:R=>o(R.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Types"}),c.jsx("option",{value:"Debit",children:" Debit (Expense)"}),c.jsx("option",{value:"Credit",children:" Credit (Income)"})]}),c.jsxs("select",{value:f,onChange:R=>d(R.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Status"}),c.jsx("option",{value:tr.Paid,children:" Paid"}),c.jsx("option",{value:tr.Pending,children:" Pending"}),c.jsx("option",{value:tr.Overdue,children:" Overdue"})]})]}),c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),c.jsx("input",{type:"text",placeholder:"Search transactions, vendors, reference ID...",value:x,onChange:R=>m(R.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl pl-10 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-800 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white",children:"Transaction History"}),c.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-primary/10 text-primary",children:[E.length," transaction",E.length!==1?"s":""]})]}),c.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Sorted by: ",c.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:"Date (Newest)"})]})]}),E.length===0?c.jsx("div",{className:"p-8 text-center",children:c.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:x||a!=="All"||l!=="All"||f!=="All"?"No transactions match your filters. Try adjusting your search criteria.":"No transactions yet. Click 'Add Transaction' to get started."})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50 text-left",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Transaction"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Category"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Vendor"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:E.map(R=>{const T=eu[R.category],C=R.vendorName?R.vendorName.split(" ").map(O=>O[0]).join("").substring(0,2).toUpperCase():null;return c.jsxs("tr",{className:j(R),children:[c.jsxs("td",{className:"px-4 py-4",children:[c.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-white",children:R.transactionDate?new Date(R.transactionDate).toLocaleDateString("en-MY",{day:"2-digit",month:"short",year:"numeric"}):"N/A"}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:R.transactionDate?new Date(R.transactionDate).toLocaleTimeString("en-MY",{hour:"2-digit",minute:"2-digit"}):""})]}),c.jsx("td",{className:"px-4 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl ${T.bgColor} grid place-items-center text-lg`,children:T.emoji}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:R.transactionName}),R.referenceId&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",R.referenceId]})]})]})}),c.jsx("td",{className:"px-4 py-4",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${T.bgColor} ${T.textColor}`,children:T.label})}),c.jsx("td",{className:"px-4 py-4",children:R.vendorName?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`h-7 w-7 rounded-lg bg-gradient-to-br from-${T.color}-500 to-${T.color}-700 text-white text-xs font-bold grid place-items-center`,children:C}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:R.vendorName}),R.vendorContact&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:R.vendorContact})]})]}):c.jsx("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:""})}),c.jsxs("td",{className:"px-4 py-4",children:[c.jsxs("div",{className:`text-sm font-bold ${R.type===Ca.Debit?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[R.type===Ca.Debit?"- ":"+ ",Io(R.amount,b)]}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:lk(R.type)})]}),c.jsx("td",{className:"px-4 py-4",children:F(R.paymentStatus)}),c.jsx("td",{className:"px-4 py-4",children:c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>r(R),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 transition",title:"Edit",children:""}),c.jsx("button",{onClick:()=>_(R),disabled:y.isPending,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-500 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition disabled:opacity-50",title:"Delete",children:""})]})})]},R.transactionGuid)})})]})})]}),c.jsx(Eu,{isOpen:p.open,isDeleting:y.isPending,onConfirm:k,onCancel:N,title:"Delete Transaction?",description:"Are you sure you want to delete this transaction? This will permanently remove it from your records.",children:p.transaction&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:p.transaction.transactionName}),p.transaction.vendorName&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Vendor: ",p.transaction.vendorName]}),p.transaction.referenceId&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",p.transaction.referenceId]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:`text-sm font-bold ${p.transaction.type===1?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[p.transaction.type===1?"-":"+"," ",p.transaction.amount.toFixed(2)]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:p.transaction.category})]})]})})})]})};function az(){const{eventId:e}=Hr();if(!e)return c.jsx(Yl,{title:"No Events for Budget Tracking",message:"Create your first event to start managing your budget and tracking expenses."});const{user:t}=A.useContext(fg),{data:r,isLoading:a,isError:n}=HU(e),{data:l=[]}=$U((r==null?void 0:r.walletGuid)||"",e),[o,f]=A.useState({open:!1,editMode:!1}),[d,x]=A.useState({open:!1}),[m,p]=A.useState(!1),v=(_=!1)=>{f({open:!0,editMode:_})},y=()=>{f({open:!1,editMode:!1})},b=()=>{x({open:!0,transaction:void 0})},w=_=>{x({open:!0,transaction:_})},E=()=>{x({open:!1,transaction:void 0})};return a?c.jsx(an,{message:"Loading wallet..."}):n?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load wallet data"}),c.jsx(Me,{onClick:()=>window.location.reload(),variant:"secondary",children:"Try Again"})]})}):r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary flex items-center gap-2",children:" Wallet & Budget"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Track your event expenses and manage your budget"})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs(Me,{disabled:!0,variant:"secondary",className:"flex items-center gap-2 opacity-50 cursor-not-allowed relative",title:"Coming Soon",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),"Export Report",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),c.jsxs(Me,{onClick:()=>v(!0),className:"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg shadow-emerald-500/25 flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]}),c.jsxs(Me,{onClick:b,variant:"primary",className:"flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add Transaction"]})]})]}),c.jsx(ez,{wallet:r,transactions:l,onEditBudget:()=>v(!0)}),c.jsx(tz,{wallet:r,transactions:l}),c.jsx(rz,{wallet:r,transactions:l,onEditTransaction:w}),c.jsx(tS,{isOpen:o.open,onClose:y,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:o.editMode?r:null}),c.jsx(ZU,{isOpen:d.open,onClose:E,walletGuid:r.walletGuid,eventGuid:e,transaction:d.transaction}),c.jsx(JU,{isOpen:m,onClose:()=>p(!1),transactions:l,wallet:r})]}):c.jsxs("div",{className:"flex items-center justify-center h-screen",children:[c.jsxs("div",{className:"text-center max-w-md",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-primary to-secondary text-white text-4xl font-bold grid place-items-center mx-auto mb-6 shadow-xl shadow-primary/25",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Setup Your Wallet"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Get started by setting up your event wallet to track expenses and manage your budget."}),c.jsxs(Me,{onClick:()=>v(!1),variant:"primary",className:"bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]})]}),c.jsx(tS,{isOpen:o.open,onClose:y,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:null})]})}function nz(e){const t={0:"under_budget",1:"on_budget",2:"over_budget"};return{eventStats:{eventName:e.eventStats.eventName,eventDate:e.eventStats.eventDate,eventTime:e.eventStats.eventTime,eventLocation:e.eventStats.eventLocation,noOfTable:e.eventStats.noOfTable},rsvpStats:{totalRsvpsReceived:e.rsvpStats.totalRsvpsReceived,comingCount:e.rsvpStats.comingCount,notComingCount:e.rsvpStats.notComingCount,pendingCount:e.rsvpStats.pendingCount,totalGuestsConfirmed:e.rsvpStats.totalGuestsConfirmed,responseRate:e.rsvpStats.responseRate,newConfirmationsToday:e.rsvpStats.newConfirmationsToday},tableStats:{totalTables:e.tableStats.totalTables,arrangedTables:e.tableStats.arrangedTables,assignedGuests:e.tableStats.assignedGuests,unassignedGuests:e.tableStats.unassignedGuests,totalSeats:e.tableStats.totalSeats,occupiedSeats:e.tableStats.occupiedSeats},budgetStats:{totalBudget:e.budgetStats.totalBudget,spentAmount:e.budgetStats.spentAmount,remainingAmount:e.budgetStats.remainingAmount,spentPercentage:e.budgetStats.spentPercentage,status:t[e.budgetStats.status]||"under_budget"},recentActivity:e.recentActivity.map(r=>({activityType:r.activityType,description:r.description,details:r.details,timestamp:r.timestamp,icon:r.icon}))}}function sz(e){return Qr({queryKey:["dashboard",e],queryFn:async()=>{const t=await Xe.get(fA.summary(e));return nz(t.data.data)},enabled:!!e})}function iz(e){const t=new Date,r=new Date(e),a=t.getTime()-r.getTime(),n=Math.floor(a/(1e3*60)),l=Math.floor(a/(1e3*60*60)),o=Math.floor(a/(1e3*60*60*24));return n<1?"Just now":n<60?`${n} min ago`:l<24?`${l} hour${l>1?"s":""} ago`:o===1?"Yesterday":o<7?`${o} days ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function lz(){var o,f,d,x,m,p,v,y,b,w,E,_,N,k,F,j,R;const e=ja(),{eventId:t}=Hr(),{data:r,isLoading:a}=sz(t||""),[n,l]=A.useState({days:0,hours:0,minutes:0});return A.useEffect(()=>{const T=()=>{var ie;const O=(ie=r==null?void 0:r.eventStats)==null?void 0:ie.eventDate;if(!O)return;const V=new Date().getTime(),H=new Date(O).getTime()-V;if(H>0){const we=Math.floor(H/864e5),ge=Math.floor(H%(1e3*60*60*24)/(1e3*60*60)),ee=Math.floor(H%(1e3*60*60)/(1e3*60));l({days:we,hours:ge,minutes:ee})}else l({days:0,hours:0,minutes:0})};T();const C=setInterval(T,6e4);return()=>clearInterval(C)},[(o=r==null?void 0:r.eventStats)==null?void 0:o.eventDate]),t?a||!r?c.jsx(an,{message:"Loading dashboard..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-white mb-1",children:["Good ",new Date().getHours()<12?"Morning":"Afternoon","! "]}),c.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Here's what's happening with your events today."})]})}),c.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 p-8 text-white shadow-2xl shadow-indigo-500/30",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32"}),c.jsx("div",{className:"absolute bottom-0 left-1/2 w-48 h-48 bg-white/5 rounded-full translate-y-24"}),c.jsxs("div",{className:"relative flex flex-col lg:flex-row lg:items-center gap-6",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm font-medium mb-4",children:[c.jsx("span",{className:"h-2 w-2 rounded-full bg-green-400 animate-pulse"}),"Active Event"]}),c.jsx("h2",{className:"text-3xl font-bold mb-2",children:r.eventStats.eventName}),c.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-white/80",children:[r.eventStats.eventDate&&c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(fd,{className:"h-4 w-4"}),new Date(r.eventStats.eventDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),r.eventStats.eventLocation&&c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(N6,{className:"h-4 w-4"}),r.eventStats.eventLocation]})]})]}),c.jsx("div",{className:"flex flex-col items-center gap-2",children:n.days===0&&n.hours===0&&n.minutes===0?c.jsx("div",{className:"text-center py-4",children:c.jsx("p",{className:"text-2xl font-bold text-white",children:"Today is your big day! "})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.days}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Days"})]}),c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.hours}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Hours"})]}),c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.minutes}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Minutes"})]})]}),c.jsx("p",{className:"text-white/90 text-sm font-medium",children:n.days<15?"Almost there! ":"until your big day"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-green-400 to-emerald-500 grid place-items-center shadow-lg shadow-green-500/20 group-hover:scale-110 transition",children:c.jsx(I0,{className:"h-6 w-6 text-white"})})}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"RSVP Status"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-1",children:[((f=r==null?void 0:r.rsvpStats)==null?void 0:f.totalRsvpsReceived)??0," ",c.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ ",((d=r==null?void 0:r.rsvpStats)==null?void 0:d.totalGuestsConfirmed)??0," responded"]})]}),c.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-0.5",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Coming:"}),c.jsxs("span",{className:"font-semibold",children:[((x=r==null?void 0:r.rsvpStats)==null?void 0:x.comingCount)??0," guests"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Not Coming:"}),c.jsxs("span",{className:"font-semibold",children:[((m=r==null?void 0:r.rsvpStats)==null?void 0:m.notComingCount)??0," guests"]})]})]}),c.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex items-center gap-2 text-xs text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 transition",children:[c.jsx(Ib,{className:"h-4 w-4"}),"View RSVPs"]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-indigo-400 to-purple-500 grid place-items-center shadow-lg shadow-indigo-500/20 group-hover:scale-110 transition",children:c.jsx(Ap,{className:"h-6 w-6 text-white"})}),c.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${((p=r==null?void 0:r.budgetStats)==null?void 0:p.status)==="over_budget"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":((v=r==null?void 0:r.budgetStats)==null?void 0:v.status)==="on_budget"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}`,children:[((y=r==null?void 0:r.budgetStats)==null?void 0:y.spentPercentage)??0,"%"]})]}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Budget"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:["$",(((b=r==null?void 0:r.budgetStats)==null?void 0:b.spentAmount)??0).toLocaleString()," ",c.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ $",(((w=r==null?void 0:r.budgetStats)==null?void 0:w.totalBudget)??0).toLocaleString()]})]}),c.jsx("div",{className:"w-full h-2 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden mb-2",children:c.jsx("div",{className:`h-full rounded-full transition-all ${(((E=r==null?void 0:r.budgetStats)==null?void 0:E.spentPercentage)??0)>100?"bg-gradient-to-r from-red-400 to-red-500":(((_=r==null?void 0:r.budgetStats)==null?void 0:_.spentPercentage)??0)>=90?"bg-gradient-to-r from-amber-400 to-orange-500":"bg-gradient-to-r from-indigo-400 to-purple-500"}`,style:{width:`${Math.min(((N=r==null?void 0:r.budgetStats)==null?void 0:N.spentPercentage)??0,100)}%`}})}),c.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex items-center gap-2 text-xs text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition",children:[c.jsx(x6,{className:"h-4 w-4"}),"Manage Budget"]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-pink-100 dark:hover:border-pink-800 transition-all group",children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-pink-400 to-rose-500 grid place-items-center shadow-lg shadow-pink-500/20 group-hover:scale-110 transition",children:c.jsx(Pb,{className:"h-6 w-6 text-white"})})}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Seating Progress"}),c.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-1",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:"Guests seated:"}),c.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((k=r==null?void 0:r.tableStats)==null?void 0:k.assignedGuests)??0," / ",((F=r==null?void 0:r.tableStats)==null?void 0:F.totalSeats)??0]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:"Tables arranged:"}),c.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((j=r==null?void 0:r.tableStats)==null?void 0:j.arrangedTables)??0," / ",((R=r==null?void 0:r.tableStats)==null?void 0:R.totalTables)??0]})]})]}),c.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex items-center gap-2 text-xs text-pink-600 dark:text-pink-400 hover:text-pink-700 dark:hover:text-pink-300 transition",children:[c.jsx(jp,{className:"h-4 w-4"}),"Manage Tables"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 p-5",children:[c.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border border-green-100 dark:border-green-800 hover:border-green-200 dark:hover:border-green-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-green-100 dark:bg-green-900/50 group-hover:bg-green-200 dark:group-hover:bg-green-800 grid place-items-center transition",children:c.jsx(I0,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add RSVP"})]}),c.jsxs("button",{onClick:()=>e("/app/rsvps/designer"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 border border-indigo-100 dark:border-indigo-800 hover:border-indigo-200 dark:hover:border-indigo-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-indigo-100 dark:bg-indigo-900/50 group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800 grid place-items-center transition",children:c.jsx(Pb,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Design RSVP"})]}),c.jsxs("button",{disabled:!0,className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-950/20 dark:to-violet-950/20 border border-purple-100 dark:border-purple-800 opacity-60 cursor-not-allowed",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-purple-100 dark:bg-purple-900/50 grid place-items-center",children:c.jsx(Ib,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Send Invites"})]}),c.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 border border-amber-100 dark:border-amber-800 hover:border-amber-200 dark:hover:border-amber-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-amber-100 dark:bg-amber-900/50 group-hover:bg-amber-200 dark:group-hover:bg-amber-800 grid place-items-center transition",children:c.jsx(jp,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Arrange Seats"})]}),c.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-950/20 dark:to-rose-950/20 border border-pink-100 dark:border-pink-800 hover:border-pink-200 dark:hover:border-pink-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-pink-100 dark:bg-pink-900/50 group-hover:bg-pink-200 dark:group-hover:bg-pink-800 grid place-items-center transition",children:c.jsx(Ap,{className:"h-5 w-5 text-pink-600 dark:text-pink-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add Expense"})]})]})]}),c.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between",children:c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Recent Activity"}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Latest updates from your event"})]})}),c.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700 max-h-[400px] overflow-y-auto",children:r!=null&&r.recentActivity&&r.recentActivity.length>0?r.recentActivity.map((T,C)=>c.jsxs("div",{className:"px-6 py-4 hover:bg-slate-50/50 dark:hover:bg-slate-700/50 transition flex items-start gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 grid place-items-center flex-shrink-0",children:c.jsx("span",{className:"text-lg",children:T.icon})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm text-slate-800 dark:text-white",children:T.description}),T.details&&c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:T.details})]}),c.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 flex-shrink-0",children:iz(T.timestamp)})]},C)):c.jsxs("div",{className:"px-6 py-12 text-center",children:[c.jsx("div",{className:"h-16 w-16 rounded-2xl bg-slate-100 dark:bg-slate-700 grid place-items-center mx-auto mb-4",children:c.jsx(b6,{className:"h-8 w-8 text-slate-400 dark:text-slate-500"})}),c.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-2 font-medium",children:"No activity yet"}),c.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:"Activity will appear here as guests respond and you manage your event"})]})})]})]})]}):c.jsx("div",{className:"space-y-6",children:c.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 rounded-2xl p-8 text-center",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsx("div",{className:"h-20 w-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 grid place-items-center",children:c.jsx(fd,{className:"h-10 w-10 text-white"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Welcome to MyBigDays! "}),c.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Select an event from the sidebar to get started with your planning dashboard"}),c.jsxs(Me,{onClick:()=>e("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[c.jsx(fd,{className:"h-5 w-5"}),"Create Your First Event"]})]})})})}const oz={0:"text",1:"textarea",2:"select",3:"radio",4:"checkbox",5:"email",6:"number",7:"date"};function cz(e,t){return Qr({queryKey:["rsvpDesign","public",e,t],enabled:!!e||!!t,staleTime:5*6e4,queryFn:async()=>{var r,a,n,l,o,f,d,x,m,p,v;if(e)try{const y=await Xe.get(P4.designByToken(e)),b=((r=y.data)==null?void 0:r.data)??y.data;if(b!=null&&b.design){const w=qp(b);return!w.formFieldConfigs&&((a=b.design)!=null&&a.formFieldConfigs)&&(w.formFieldConfigs=b.design.formFieldConfigs),w}}catch{}if(e&&typeof window<"u"){const y=window.localStorage.getItem(`rsvp-share-${e}`);if(y)try{const b=JSON.parse(y);return{blocks:b.blocks??[],flowPreset:b.flowPreset??"serene",globalBackgroundType:((n=b.global)==null?void 0:n.backgroundType)??"color",globalBackgroundAsset:((l=b.global)==null?void 0:l.backgroundAsset)??"",globalBackgroundColor:((o=b.global)==null?void 0:o.backgroundColor)??"#0f172a",globalOverlay:((f=b.global)==null?void 0:f.overlay)??.3,accentColor:((d=b.global)==null?void 0:d.accentColor)??"#f97316",globalMusicUrl:((x=b.global)==null?void 0:x.musicUrl)??void 0,eventGuid:b.eventGuid??t??void 0,formFieldConfigs:b.formFieldConfigs??[]}}catch{}}if(t)try{const y=await Xe.get(ug.get(t)),b=((m=y.data)==null?void 0:m.data)??y.data;if(b!=null&&b.design){const w=qp(b);if(w.eventGuid=t,!((p=w.formFieldConfigs)!=null&&p.length))try{const _=((v=(await Xe.get(`/question/GetQuestions/${t}`)).data)==null?void 0:v.data)??[];w.formFieldConfigs=_.map(N=>({questionId:String(N.questionId??N.id??""),id:String(N.questionId??N.id??""),label:N.label??N.text??N.name??"",text:N.text??N.label??"",isRequired:N.isRequired??!1,type:typeof N.type=="number"?N.type:void 0,typeKey:typeof N.type=="number"?oz[N.type]??"text":N.typeKey??"text",options:N.options,order:N.order??0}))}catch{w.formFieldConfigs=[]}return w}}catch{}return null}})}function uz(){return kt({mutationFn:e=>{const t=Object.entries(e.answers).map(([r,a])=>({questionId:r,text:Array.isArray(a)?a.join(", "):String(a??"")}));return Xe.post(P4.submit(),{eventId:e.eventId,guestName:e.guestName,noOfPax:e.noOfPax,phoneNo:e.phoneNo??"",createdBy:e.guestName,answers:t}).then(r=>r.data)}})}function fz({design:e,formFields:t,eventId:r,onSubmit:a,isSubmitting:n}){const{blocks:l,flowPreset:o="serene",globalBackgroundType:f,globalBackgroundAsset:d,globalBackgroundColor:x,globalOverlay:m,accentColor:p,globalMusicUrl:v}=e,y=A.useMemo(()=>{const ne=[...l],te=ne.some(Z=>Z.type==="attendance"),I=ne.some(Z=>Z.type==="guestDetails");if(te||ne.splice(0,0,{id:"__auto_attendance__",type:"attendance",title:"Will you be attending?",subtitle:"Please let us know"}),!I){const Z=ne.findIndex(L=>L.type==="attendance");ne.splice(Z+1,0,{id:"__auto_guest_details__",type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,phone:!0,pax:!0}})}return ne},[l]),[b,w]=A.useState(""),[E,_]=A.useState(1),[N,k]=A.useState(""),[F,j]=A.useState({}),[R,T]=A.useState({}),[C,O]=A.useState(!1),V=A.useRef(null),z=ne=>T(te=>{const I={...te};return delete I[ne],I}),H=(ne,te)=>{j(I=>({...I,[ne]:te})),z(ne)},ie=(ne,te)=>{j(I=>{const Z=I[ne],L=Array.isArray(Z)?Z:Z?[Z]:[],P=L.includes(te)?L.filter(U=>U!==te):[...L,te];return{...I,[ne]:P}}),z(ne)},we=()=>{V.current&&(C?(V.current.pause(),O(!1)):(V.current.play().catch(()=>{}),O(!0)))},ge=()=>{const ne={},te=y.find(Z=>Z.type==="guestDetails"),I=((te==null?void 0:te.type)==="guestDetails"?te.showFields:void 0)??{name:!0,phone:!0,pax:!0};return I.name!==!1&&!b.trim()&&(ne.guestName="Name is required"),I.phone!==!1&&!N.trim()&&(ne.phoneNo="Phone number is required"),I.pax!==!1&&(!E||E<1)&&(ne.noOfPax="Please enter the number of guests"),y.forEach(Z=>{if(Z.type!=="formField"||!Z.questionId)return;const L=t.find(re=>(re.questionId??re.id)===Z.questionId);if(!(Z.required??(L==null?void 0:L.isRequired)??!1))return;const U=F[Z.questionId];(Array.isArray(U)?U.length===0:!(U??"").trim())&&(ne[Z.questionId]=`${Z.label||(L==null?void 0:L.label)||"This field"} is required`)}),T(ne),Object.keys(ne).length===0},ee=async ne=>{ne.preventDefault(),ge()&&await a({eventId:r,guestName:b.trim(),noOfPax:E,phoneNo:N.trim(),answers:F})},le=ne=>{var U,Y;const te=((U=ne.background)==null?void 0:U.images)??[],I=te.find(re=>{var ve;return re.id===((ve=ne.background)==null?void 0:ve.activeImageId)})??te[0]??ne.sectionImage,Z=((Y=ne.background)==null?void 0:Y.overlay)??.35,L=I?{backgroundImage:`linear-gradient(rgba(15,23,42,${Z}),rgba(15,23,42,${Z})),url(${I.src})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:o==="parallax"?"fixed":"scroll"}:{};let P=null;if(ne.type==="headline")P=c.jsxs("div",{className:`text-${ne.align}`,children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Welcome"}),c.jsx("h2",{className:`mt-1 text-4xl font-extrabold text-white drop-shadow ${ne.accent}`,children:ne.title}),ne.subtitle&&c.jsx("p",{className:"mt-2 text-base text-white/80",children:ne.subtitle})]});else if(ne.type==="text")P=c.jsx("p",{className:`leading-relaxed text-base ${ne.muted?"text-white/70":"text-white"} ${ne.width==="half"?"md:max-w-[50%]":"w-full"}`,children:ne.body});else if(ne.type==="info")P=c.jsxs("div",{className:`inline-flex items-center gap-3 rounded-full px-5 py-2.5 text-sm ${ne.accent}`,children:[c.jsx("span",{className:"font-semibold uppercase tracking-wide",children:ne.label}),c.jsx("span",{className:"opacity-80",children:ne.content})]});else{if(ne.type==="attendance")return null;if(ne.type==="guestDetails"){const re=ne.showFields??{name:!0,phone:!0,pax:!0};P=c.jsxs("div",{className:`space-y-4 ${ne.width==="half"?"md:max-w-[50%]":"w-full"}`,children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:ne.title||"Your details"}),ne.subtitle&&c.jsx("p",{className:"mt-0.5 text-xs text-white/60",children:ne.subtitle})]}),c.jsx("div",{className:"rounded-xl p-4 shadow-sm space-y-4",style:{backgroundColor:ne.cardColor??"#ffffff",color:ne.cardTextColor??"#111827"},children:c.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[re.name!==!1&&c.jsx(Zt,{label:"Your name",type:"text",required:!0,value:b,onChange:ve=>{w(ve.target.value),z("guestName")},placeholder:"Full name",error:R.guestName}),re.phone!==!1&&c.jsx(Zt,{label:"Phone number",type:"text",required:!0,value:N,onChange:ve=>{k(ve.target.value),z("phoneNo")},placeholder:"+60 12-345 6789",error:R.phoneNo}),re.pax!==!1&&c.jsx(Zt,{label:"Number of guests",type:"number",required:!0,value:String(E),onChange:ve=>{const be=parseInt(ve.target.value,10);_(isNaN(be)?1:Math.max(1,be)),z("noOfPax")},placeholder:"1",error:R.noOfPax})]})})]})}else if(ne.type==="formField"){if(!ne.questionId)return null;const re=t.find(Qe=>(Qe.questionId??Qe.id)===ne.questionId),ve=(re==null?void 0:re.options)??void 0,be=Array.isArray(ve)?ve:typeof ve=="string"?ve.split(",").map(Qe=>Qe.trim()):void 0,Te=(re==null?void 0:re.typeKey)??"text",Ae=ne.label||(re==null?void 0:re.label)||(re==null?void 0:re.text)||"Custom field",Ve=ne.required??(re==null?void 0:re.isRequired)??!1,Q=Te==="checkbox"&&be&&be.length>1,st=F[ne.questionId],it=Array.isArray(st)?st:st?[st]:[];P=c.jsx("div",{className:ne.width==="half"?"md:max-w-[50%]":"w-full",children:c.jsx("div",{className:"rounded-xl p-4 shadow-sm",style:{backgroundColor:ne.fieldCardColor??"#ffffff",color:ne.fieldCardTextColor??"#111827"},children:Q?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[Ae,Ve&&c.jsx("span",{className:"ml-1 text-rose-500",children:"*"})]}),be.map(Qe=>c.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:it.includes(Qe),onChange:()=>ie(ne.questionId,Qe),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700",children:Qe})]},Qe)),R[ne.questionId]&&c.jsx("p",{className:"text-xs text-rose-500",children:R[ne.questionId]})]}):c.jsx(Zt,{label:Ae,type:Te,options:be,required:Ve,placeholder:ne.placeholder,hint:ne.hint,value:st??"",onChange:Qe=>H(ne.questionId,Qe.target.value),error:R[ne.questionId]})})})}else if(ne.type==="cta"){const re={background:ne.ctaColor??p,color:ne.ctaTextColor??"#0f172a"},ve="inline-block rounded-full px-8 py-3 text-sm font-semibold shadow-lg transition hover:opacity-90";P=c.jsx("div",{className:`flex ${ne.align==="center"?"justify-center":ne.align==="right"?"justify-end":"justify-start"}`,children:ne.href&&ne.href!=="#"?c.jsx("a",{href:ne.href,target:"_blank",rel:"noreferrer",className:ve,style:re,children:ne.label}):c.jsx("button",{type:"button",className:ve,style:re,children:ne.label})})}else if(ne.type==="image"){const re=ne.images.find(be=>be.id===ne.activeImageId)??ne.images[0],ve=ne.height==="tall"?"h-80":ne.height==="short"?"h-48":"h-64";P=c.jsxs("div",{className:`overflow-hidden rounded-2xl ${ve}`,children:[re?c.jsx("img",{src:re.src,alt:re.alt??"",className:"h-full w-full object-cover",loading:"lazy"}):null,ne.caption&&c.jsx("p",{className:"bg-black/40 px-4 py-2 text-xs text-white/80",children:ne.caption})]})}}return P?c.jsx("section",{className:`relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6 shadow-xl ring-1 ring-white/5 backdrop-blur-sm transition duration-500 hover:-translate-y-1 ${o==="stacked"?"scroll-snap-start":""}`,style:L,children:P},ne.id):null};return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-white",children:[c.jsxs("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":!0,children:[f==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:x}}),f==="image"&&d&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${d})`}}),f==="video"&&d&&c.jsx("video",{className:"h-full w-full object-cover",src:d,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${m})`}})]}),v&&c.jsxs(c.Fragment,{children:[c.jsx("audio",{ref:V,src:v,loop:!0,preload:"none"}),c.jsx("button",{type:"button",onClick:we,title:C?"Pause music":"Play ambient music",className:"fixed bottom-6 right-6 z-50 flex h-12 w-12 items-center justify-center rounded-full border border-white/20 bg-black/60 text-white shadow-xl backdrop-blur-sm transition hover:bg-black/80",style:{borderColor:`${p}40`},children:C?c.jsxs("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),c.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]}):c.jsx("svg",{className:"h-5 w-5 translate-x-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M8 5v14l11-7z"})})})]}),c.jsx("form",{onSubmit:ee,noValidate:!0,children:c.jsxs("div",{className:`relative mx-auto flex max-w-3xl flex-col gap-6 px-4 py-12 ${o==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:[y.map(ne=>le(ne)),c.jsx("div",{className:"flex justify-center pb-8",children:c.jsxs("button",{type:"submit",disabled:n,className:"flex min-w-[220px] items-center justify-center gap-2 rounded-full px-8 py-4 text-base font-semibold shadow-xl transition hover:opacity-90 disabled:opacity-60",style:{background:e.submitButtonColor??p,color:e.submitButtonTextColor??"#0f172a"},children:[n&&c.jsx(Xn,{}),n?"Submitting...":e.submitButtonLabel||"Submit RSVP"]})})]})})]})}function dz({guestName:e,design:t}){const r=t.accentColor??"#f97316";return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 flex items-center justify-center px-4 text-white",children:[c.jsxs("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":!0,children:[t.globalBackgroundType==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t.globalBackgroundColor}}),t.globalBackgroundType==="image"&&t.globalBackgroundAsset&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${t.globalBackgroundAsset})`}}),t.globalBackgroundType==="video"&&t.globalBackgroundAsset&&c.jsx("video",{className:"h-full w-full object-cover",src:t.globalBackgroundAsset,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${t.globalOverlay})`}})]}),c.jsxs("div",{className:"relative z-10 max-w-md w-full text-center space-y-8",children:[c.jsx("div",{className:"mx-auto flex h-24 w-24 items-center justify-center rounded-full border-2",style:{background:`${r}20`,borderColor:`${r}50`},children:c.jsx("svg",{className:"h-12 w-12",style:{color:r},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-white drop-shadow",children:e?`Thank you, ${e}!`:"Thank you!"}),c.jsx("p",{className:"text-lg text-white/80",children:"Your RSVP has been received."}),c.jsx("p",{className:"text-sm text-white/50 leading-relaxed",children:"We're looking forward to celebrating with you. A confirmation will be sent to your email."})]}),c.jsx("div",{className:"mx-auto h-px w-16 rounded-full opacity-50",style:{background:r}}),c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/40",children:"See you soon"})]})]})}function aS(){var m;const{token:e}=Nn(),[t]=KS(),r=t.get("event")??void 0,{data:a,isLoading:n}=cz(e,r),l=uz(),[o,f]=A.useState(!1),[d,x]=A.useState("");return n?c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-950 text-white gap-3",children:[c.jsx(Xn,{}),c.jsx("p",{className:"text-sm text-white/50",children:"Loading invitation..."})]}):!a||!((m=a.blocks)!=null&&m.length)?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white px-4",children:c.jsxs("div",{className:"max-w-sm text-center space-y-4",children:[c.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-white/5 border border-white/10",children:c.jsx("svg",{className:"h-8 w-8 text-white/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Invalid or expired link"}),c.jsx("p",{className:"text-sm text-white/50 leading-relaxed",children:"This RSVP link doesn't exist or has expired. Please contact the host for the correct link."})]})}):o?c.jsx(dz,{guestName:d,design:a}):c.jsx(fz,{design:a,formFields:a.formFieldConfigs??[],eventId:a.eventGuid??"",onSubmit:async p=>{try{await l.mutateAsync(p),x(p.guestName),f(!0)}catch{tn.error("Failed to submit your RSVP. Please try again.")}},isSubmitting:l.isPending})}function hz(){return c.jsx("section",{className:"py-20 bg-background text-text",children:c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[c.jsx("h2",{className:"text-4xl font-playfair italic text-primary text-center",children:"Wedding Events"}),c.jsx("ul",{className:"space-y-4",children:[{label:"Ceremony",date:"Feb 14, 2025",time:"10:00 AM"},{label:"Reception",date:"Feb 14, 2025",time:"6:00 PM"}].map(e=>c.jsxs("li",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between",children:[c.jsx("span",{className:"font-semibold",children:e.label}),c.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.date," @ ",e.time]})]},e.label))})]})})}function xz(){const e=ja(),{eventId:t}=Hr();console.log("NewRsvpModal eventId:",t);const r=tk(t),a=n=>{r.mutate(n,{onSuccess:()=>{e(-1)}})};return c.jsx(r1,{isOpen:!0,onClose:()=>e(-1),eventId:t,onSave:a})}function mz(){const e=ja(),{eventId:t}=Hr(),{id:r}=Nn(),{data:a,isLoading:n}=MI(t,r),l=rk(t);if(n)return null;const o=(f,d)=>{const x=d;l.mutate({rsvpGuid:x,...f},{onSuccess:()=>e(-1)})};return c.jsx(r1,{isOpen:!0,onClose:()=>e(-1),eventId:t,initial:a,onSave:o})}const Mo={text:0,textarea:1,select:2,radio:3,checkbox:4,email:5,number:6,date:7},nS=["select","radio","checkbox"];function pz({isOpen:e,onClose:t,initial:r,onSave:a}){const n=A.useMemo(()=>{const _=Object.entries(Mo).find(([,N])=>N===((r==null?void 0:r.type)??Mo.text));return(_==null?void 0:_[0])??"text"},[r==null?void 0:r.type]),[l,o]=A.useState((r==null?void 0:r.text)??""),[f,d]=A.useState((r==null?void 0:r.isRequired)??!1),[x,m]=A.useState(n),[p,v]=A.useState((r==null?void 0:r.options)??""),[y,b]=A.useState(Number.isFinite(r==null?void 0:r.order)?r.order:0);A.useEffect(()=>{if(!e)return;o((r==null?void 0:r.text)??""),d((r==null?void 0:r.isRequired)??!1),b(Number.isFinite(r==null?void 0:r.order)?r.order:0);const _=Object.entries(Mo).find(([,N])=>N===((r==null?void 0:r.type)??Mo.text));m((_==null?void 0:_[0])??"text"),v((r==null?void 0:r.options)??"")},[e,r]);const w=_=>{_.preventDefault();const N={id:r==null?void 0:r.id,text:l,isRequired:f,type:Mo[x],options:nS.includes(x)?(p||"").trim():void 0,order:Number.isFinite(y)?y:0,isDeleted:(r==null?void 0:r.isDeleted)??!1};a(N)},E=nS.includes(x);return c.jsx($n,{isOpen:e,onClose:t,title:r?"Edit Field":"New Field",children:c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsx(Zt,{label:"Question Text",value:l,onChange:_=>o(_.target.value),placeholder:"e.g. Do you have any dietary requirements?"}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1",children:"Type"}),c.jsx("select",{value:x,onChange:_=>m(_.target.value),className:"w-full border rounded p-2",children:Object.keys(Mo).map(_=>c.jsx("option",{value:_,children:_},_))}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This maps to API numeric codes (e.g. text=0, textarea=1, select=2, )."})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{id:"required",type:"checkbox",checked:f,onChange:_=>d(_.target.checked)}),c.jsx("label",{htmlFor:"required",children:"Required"})]}),E&&c.jsx(Zt,{label:"Options (comma-separated)",value:p,onChange:_=>v(_.target.value),placeholder:"e.g. Beef, Chicken, Fish, Vegetarian"}),c.jsx(Zt,{label:"Order",type:"number",value:String(y),onChange:_=>b(Number(_.target.value)),placeholder:"0"}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Me,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),c.jsx(Me,{type:"submit",variant:"primary",children:r?"Save":"Create"})]})]})})}function gz(){const{id:e}=Nn(),t=e??"",{data:r,isLoading:a,isError:n}=t1(t),l=BI(),o=PI(),f=II(),[d,x]=A.useState({open:!1}),m=A.useMemo(()=>Array.isArray(r)?r:[],[r]);return t?a?c.jsx(an,{}):n?c.jsx("p",{children:"Failed to load form fields."}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-semibold",children:"Custom RSVP Fields"}),c.jsx(Me,{onClick:()=>x({open:!0}),children:"+ New Field"})]}),m.length===0?c.jsxs("div",{className:"text-center text-gray-500 py-10 bg-white dark:bg-gray-800 rounded-lg shadow",children:[c.jsx("p",{children:"No custom fields yet."}),c.jsxs("p",{className:"mt-2",children:["Click ",c.jsx("span",{className:"font-semibold",children:"+ New Field"})," to add one."]})]}):c.jsx("ul",{className:"space-y-2",children:m.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:p.label??p.text}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[typeof p.type=="number"?p.type:p.typeKey??String(p.type)," ",p.isRequired&&" required"]})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Me,{variant:"secondary",onClick:()=>x({open:!0,initial:p}),children:"Edit"}),c.jsx(Me,{variant:"primary",onClick:()=>{p.questionId&&f.mutate()},children:"Delete"})]})]},p.questionId??p.id))}),d.open&&c.jsx(pz,{isOpen:d.open,onClose:()=>x({open:!1}),initial:d.initial?{id:d.initial.questionId??d.initial.id,text:d.initial.text??d.initial.label??"",isRequired:d.initial.isRequired??!1,order:d.initial.order??0,type:d.initial.type??0,options:Array.isArray(d.initial.options)?d.initial.options.join(","):typeof d.initial.options=="string"?d.initial.options:void 0}:void 0,onSave:p=>{var y;if(!t)return;const v={text:p.text??"",type:p.type,isRequired:p.isRequired,options:p.options??"",eventGuid:t};(y=d.initial)!=null&&y.questionId?o.mutate({...v,questionId:d.initial.questionId.toString()}):l.mutate(v),x({open:!1})}})]}):c.jsx(Yl,{title:"No Event Selected",message:"Create your first event to start customizing your RSVP form fields."})}function vz(){const{tableId:e}=Nn(),{eventId:t}=Hr(),{data:r,isLoading:a}=_u(e),{data:n=[],isLoading:l}=nh(t),o=xU(t),f=mU(t),d=dU(e,t),[x,m]=A.useState((r==null?void 0:r.extraGuests)||0);if(a||l)return c.jsx(an,{});const p=n.filter(y=>y.tableId===e),v=n.filter(y=>!y.tableId);return c.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Unassigned Guests"}),v.length===0?c.jsx("p",{children:"All guests are assigned."}):c.jsx("ul",{className:"mt-2 space-y-2",children:v.map(y=>c.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[c.jsx("span",{children:y.guestName||y.name}),c.jsx(Me,{onClick:()=>o.mutate({guestId:y.id,tableId:e}),children:"Assign "})]},y.id))})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Assigned Guests"}),p.length===0?c.jsx("p",{children:"No one assigned yet."}):c.jsx("ul",{className:"mt-2 space-y-2",children:p.map(y=>c.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[c.jsx("span",{children:y.guestName||y.name}),c.jsx(Me,{variant:"secondary",onClick:()=>f.mutate(y.id),children:" Unassign"})]},y.id))}),c.jsxs("div",{className:"mt-6",children:[c.jsx("h3",{className:"font-medium",children:"Additional Guests"}),c.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[c.jsx(Me,{onClick:()=>m(y=>Math.max(0,y-1)),children:""}),c.jsx("span",{className:"px-4",children:x}),c.jsx(Me,{onClick:()=>m(y=>y+1),children:""}),c.jsx(Me,{variant:"primary",onClick:()=>d.mutate({extraGuests:x,tableName:(r==null?void 0:r.name)||"",maxSeats:(r==null?void 0:r.capacity)||0}),children:"Save"})]})]})]})]})}function yz(){return c.jsxs("div",{className:"space-y-4",children:[c.jsx("nav",{className:"border-b pb-2 flex space-x-4",children:[["","Summary"],["assignments","Assign Guests"],["layout","Layout"],["print","Print"],["edit","Edit"]].map(([e,t])=>c.jsx(M0,{to:e,end:e==="",className:({isActive:r})=>r?"border-b-2 border-button":void 0,children:t},e))}),c.jsx(Bs,{})]})}var v0={exports:{}},ep={},tp={exports:{}},rp,sS;function bz(){if(sS)return rp;sS=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return rp=e,rp}var ap,iS;function wz(){if(iS)return ap;iS=1;var e=bz();function t(){}function r(){}return r.resetWarningCache=t,ap=function(){function a(o,f,d,x,m,p){if(p!==e){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}a.isRequired=a;function n(){return a}var l={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:n,element:a,elementType:a,instanceOf:n,node:a,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},ap}var lS;function ck(){return lS||(lS=1,tp.exports=wz()()),tp.exports}function uk(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=uk(e[t]))&&(a&&(a+=" "),a+=r);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function oS(){for(var e,t,r=0,a="";r<arguments.length;)(e=arguments[r++])&&(t=uk(e))&&(a&&(a+=" "),a+=t);return a}const Sz=Object.freeze(Object.defineProperty({__proto__:null,clsx:oS,default:oS},Symbol.toStringTag,{value:"Module"})),Ez=yT(Sz);var Er={},wi={},cS;function lh(){if(cS)return wi;cS=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.dontSetMe=n,wi.findInArray=e,wi.int=a,wi.isFunction=t,wi.isNum=r;function e(l,o){for(let f=0,d=l.length;f<d;f++)if(o.apply(o,[l[f],f,l]))return l[f]}function t(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Function]"}function r(l){return typeof l=="number"&&!isNaN(l)}function a(l){return parseInt(l,10)}function n(l,o,f){if(l[o])return new Error("Invalid prop ".concat(o," passed to ").concat(f," - do not set this, set it on the child."))}return wi}var Si={},uS;function _z(){if(uS)return Si;uS=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.browserPrefixToKey=r,Si.browserPrefixToStyle=a,Si.default=void 0,Si.getPrefix=t;const e=["Moz","Webkit","O","ms"];function t(){var l;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const f=(l=window.document)===null||l===void 0||(l=l.documentElement)===null||l===void 0?void 0:l.style;if(!f||o in f)return"";for(let d=0;d<e.length;d++)if(r(o,e[d])in f)return e[d];return""}function r(l,o){return o?"".concat(o).concat(n(l)):l}function a(l,o){return o?"-".concat(o.toLowerCase(),"-").concat(l):l}function n(l){let o="",f=!0;for(let d=0;d<l.length;d++)f?(o+=l[d].toUpperCase(),f=!1):l[d]==="-"?f=!0:o+=l[d];return o}return Si.default=t(),Si}var fS;function o1(){if(fS)return Er;fS=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.addClassName=j,Er.addEvent=f,Er.addUserSelectStyles=k,Er.createCSSTransform=b,Er.createSVGTransform=w,Er.getTouch=_,Er.getTouchIdentifier=N,Er.getTranslation=E,Er.innerHeight=p,Er.innerWidth=v,Er.matchesSelector=l,Er.matchesSelectorAndParentsTo=o,Er.offsetXYFromParent=y,Er.outerHeight=x,Er.outerWidth=m,Er.removeClassName=R,Er.removeEvent=d,Er.removeUserSelectStyles=F;var e=lh(),t=a(_z());function r(T){if(typeof WeakMap!="function")return null;var C=new WeakMap,O=new WeakMap;return(r=function(V){return V?O:C})(T)}function a(T,C){if(T&&T.__esModule)return T;if(T===null||typeof T!="object"&&typeof T!="function")return{default:T};var O=r(C);if(O&&O.has(T))return O.get(T);var V={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in T)if(H!=="default"&&Object.prototype.hasOwnProperty.call(T,H)){var ie=z?Object.getOwnPropertyDescriptor(T,H):null;ie&&(ie.get||ie.set)?Object.defineProperty(V,H,ie):V[H]=T[H]}return V.default=T,O&&O.set(T,V),V}let n="";function l(T,C){return n||(n=(0,e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(O){return(0,e.isFunction)(T[O])})),(0,e.isFunction)(T[n])?T[n](C):!1}function o(T,C,O){let V=T;do{if(l(V,C))return!0;if(V===O)return!1;V=V.parentNode}while(V);return!1}function f(T,C,O,V){if(!T)return;const z={capture:!0,...V};T.addEventListener?T.addEventListener(C,O,z):T.attachEvent?T.attachEvent("on"+C,O):T["on"+C]=O}function d(T,C,O,V){if(!T)return;const z={capture:!0,...V};T.removeEventListener?T.removeEventListener(C,O,z):T.detachEvent?T.detachEvent("on"+C,O):T["on"+C]=null}function x(T){let C=T.clientHeight;const O=T.ownerDocument.defaultView.getComputedStyle(T);return C+=(0,e.int)(O.borderTopWidth),C+=(0,e.int)(O.borderBottomWidth),C}function m(T){let C=T.clientWidth;const O=T.ownerDocument.defaultView.getComputedStyle(T);return C+=(0,e.int)(O.borderLeftWidth),C+=(0,e.int)(O.borderRightWidth),C}function p(T){let C=T.clientHeight;const O=T.ownerDocument.defaultView.getComputedStyle(T);return C-=(0,e.int)(O.paddingTop),C-=(0,e.int)(O.paddingBottom),C}function v(T){let C=T.clientWidth;const O=T.ownerDocument.defaultView.getComputedStyle(T);return C-=(0,e.int)(O.paddingLeft),C-=(0,e.int)(O.paddingRight),C}function y(T,C,O){const z=C===C.ownerDocument.body?{left:0,top:0}:C.getBoundingClientRect(),H=(T.clientX+C.scrollLeft-z.left)/O,ie=(T.clientY+C.scrollTop-z.top)/O;return{x:H,y:ie}}function b(T,C){const O=E(T,C,"px");return{[(0,t.browserPrefixToKey)("transform",t.default)]:O}}function w(T,C){return E(T,C,"")}function E(T,C,O){let{x:V,y:z}=T,H="translate(".concat(V).concat(O,",").concat(z).concat(O,")");if(C){const ie="".concat(typeof C.x=="string"?C.x:C.x+O),we="".concat(typeof C.y=="string"?C.y:C.y+O);H="translate(".concat(ie,", ").concat(we,")")+H}return H}function _(T,C){return T.targetTouches&&(0,e.findInArray)(T.targetTouches,O=>C===O.identifier)||T.changedTouches&&(0,e.findInArray)(T.changedTouches,O=>C===O.identifier)}function N(T){if(T.targetTouches&&T.targetTouches[0])return T.targetTouches[0].identifier;if(T.changedTouches&&T.changedTouches[0])return T.changedTouches[0].identifier}function k(T){if(!T)return;let C=T.getElementById("react-draggable-style-el");C||(C=T.createElement("style"),C.type="text/css",C.id="react-draggable-style-el",C.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,C.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,T.getElementsByTagName("head")[0].appendChild(C)),T.body&&j(T.body,"react-draggable-transparent-selection")}function F(T){if(T)try{if(T.body&&R(T.body,"react-draggable-transparent-selection"),T.selection)T.selection.empty();else{const C=(T.defaultView||window).getSelection();C&&C.type!=="Caret"&&C.removeAllRanges()}}catch{}}function j(T,C){T.classList?T.classList.add(C):T.className.match(new RegExp("(?:^|\\s)".concat(C,"(?!\\S)")))||(T.className+=" ".concat(C))}function R(T,C){T.classList?T.classList.remove(C):T.className=T.className.replace(new RegExp("(?:^|\\s)".concat(C,"(?!\\S)"),"g"),"")}return Er}var is={},dS;function fk(){if(dS)return is;dS=1,Object.defineProperty(is,"__esModule",{value:!0}),is.canDragX=n,is.canDragY=l,is.createCoreData=f,is.createDraggableData=d,is.getBoundPosition=r,is.getControlPosition=o,is.snapToGrid=a;var e=lh(),t=o1();function r(p,v,y){if(!p.props.bounds)return[v,y];let{bounds:b}=p.props;b=typeof b=="string"?b:x(b);const w=m(p);if(typeof b=="string"){const{ownerDocument:E}=w,_=E.defaultView;let N;if(b==="parent"?N=w.parentNode:N=E.querySelector(b),!(N instanceof _.HTMLElement))throw new Error('Bounds selector "'+b+'" could not find an element.');const k=N,F=_.getComputedStyle(w),j=_.getComputedStyle(k);b={left:-w.offsetLeft+(0,e.int)(j.paddingLeft)+(0,e.int)(F.marginLeft),top:-w.offsetTop+(0,e.int)(j.paddingTop)+(0,e.int)(F.marginTop),right:(0,t.innerWidth)(k)-(0,t.outerWidth)(w)-w.offsetLeft+(0,e.int)(j.paddingRight)-(0,e.int)(F.marginRight),bottom:(0,t.innerHeight)(k)-(0,t.outerHeight)(w)-w.offsetTop+(0,e.int)(j.paddingBottom)-(0,e.int)(F.marginBottom)}}return(0,e.isNum)(b.right)&&(v=Math.min(v,b.right)),(0,e.isNum)(b.bottom)&&(y=Math.min(y,b.bottom)),(0,e.isNum)(b.left)&&(v=Math.max(v,b.left)),(0,e.isNum)(b.top)&&(y=Math.max(y,b.top)),[v,y]}function a(p,v,y){const b=Math.round(v/p[0])*p[0],w=Math.round(y/p[1])*p[1];return[b,w]}function n(p){return p.props.axis==="both"||p.props.axis==="x"}function l(p){return p.props.axis==="both"||p.props.axis==="y"}function o(p,v,y){const b=typeof v=="number"?(0,t.getTouch)(p,v):null;if(typeof v=="number"&&!b)return null;const w=m(y),E=y.props.offsetParent||w.offsetParent||w.ownerDocument.body;return(0,t.offsetXYFromParent)(b||p,E,y.props.scale)}function f(p,v,y){const b=!(0,e.isNum)(p.lastX),w=m(p);return b?{node:w,deltaX:0,deltaY:0,lastX:v,lastY:y,x:v,y}:{node:w,deltaX:v-p.lastX,deltaY:y-p.lastY,lastX:p.lastX,lastY:p.lastY,x:v,y}}function d(p,v){const y=p.props.scale;return{node:v.node,x:p.state.x+v.deltaX/y,y:p.state.y+v.deltaY/y,deltaX:v.deltaX/y,deltaY:v.deltaY/y,lastX:p.state.x,lastY:p.state.y}}function x(p){return{left:p.left,top:p.top,right:p.right,bottom:p.bottom}}function m(p){const v=p.findDOMNode();if(!v)throw new Error("<DraggableCore>: Unmounted during event!");return v}return is}var y0={},ed={},hS;function dk(){if(hS)return ed;hS=1,Object.defineProperty(ed,"__esModule",{value:!0}),ed.default=e;function e(){}return ed}var xS;function kz(){if(xS)return y0;xS=1,Object.defineProperty(y0,"__esModule",{value:!0}),y0.default=void 0;var e=x(Ga()),t=f(ck()),r=f(Md()),a=o1(),n=fk(),l=lh(),o=f(dk());function f(E){return E&&E.__esModule?E:{default:E}}function d(E){if(typeof WeakMap!="function")return null;var _=new WeakMap,N=new WeakMap;return(d=function(k){return k?N:_})(E)}function x(E,_){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var N=d(_);if(N&&N.has(E))return N.get(E);var k={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in E)if(j!=="default"&&Object.prototype.hasOwnProperty.call(E,j)){var R=F?Object.getOwnPropertyDescriptor(E,j):null;R&&(R.get||R.set)?Object.defineProperty(k,j,R):k[j]=E[j]}return k.default=E,N&&N.set(E,k),k}function m(E,_,N){return _=p(_),_ in E?Object.defineProperty(E,_,{value:N,enumerable:!0,configurable:!0,writable:!0}):E[_]=N,E}function p(E){var _=v(E,"string");return typeof _=="symbol"?_:String(_)}function v(E,_){if(typeof E!="object"||E===null)return E;var N=E[Symbol.toPrimitive];if(N!==void 0){var k=N.call(E,_);if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(E)}const y={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let b=y.mouse,w=class extends e.Component{constructor(){super(...arguments),m(this,"dragging",!1),m(this,"lastX",NaN),m(this,"lastY",NaN),m(this,"touchIdentifier",null),m(this,"mounted",!1),m(this,"handleDragStart",_=>{if(this.props.onMouseDown(_),!this.props.allowAnyClick&&typeof _.button=="number"&&_.button!==0)return!1;const N=this.findDOMNode();if(!N||!N.ownerDocument||!N.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:k}=N;if(this.props.disabled||!(_.target instanceof k.defaultView.Node)||this.props.handle&&!(0,a.matchesSelectorAndParentsTo)(_.target,this.props.handle,N)||this.props.cancel&&(0,a.matchesSelectorAndParentsTo)(_.target,this.props.cancel,N))return;_.type==="touchstart"&&_.preventDefault();const F=(0,a.getTouchIdentifier)(_);this.touchIdentifier=F;const j=(0,n.getControlPosition)(_,F,this);if(j==null)return;const{x:R,y:T}=j,C=(0,n.createCoreData)(this,R,T);(0,o.default)("DraggableCore: handleDragStart: %j",C),(0,o.default)("calling",this.props.onStart),!(this.props.onStart(_,C)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,a.addUserSelectStyles)(k),this.dragging=!0,this.lastX=R,this.lastY=T,(0,a.addEvent)(k,b.move,this.handleDrag),(0,a.addEvent)(k,b.stop,this.handleDragStop))}),m(this,"handleDrag",_=>{const N=(0,n.getControlPosition)(_,this.touchIdentifier,this);if(N==null)return;let{x:k,y:F}=N;if(Array.isArray(this.props.grid)){let T=k-this.lastX,C=F-this.lastY;if([T,C]=(0,n.snapToGrid)(this.props.grid,T,C),!T&&!C)return;k=this.lastX+T,F=this.lastY+C}const j=(0,n.createCoreData)(this,k,F);if((0,o.default)("DraggableCore: handleDrag: %j",j),this.props.onDrag(_,j)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const C=document.createEvent("MouseEvents");C.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(C)}return}this.lastX=k,this.lastY=F}),m(this,"handleDragStop",_=>{if(!this.dragging)return;const N=(0,n.getControlPosition)(_,this.touchIdentifier,this);if(N==null)return;let{x:k,y:F}=N;if(Array.isArray(this.props.grid)){let C=k-this.lastX||0,O=F-this.lastY||0;[C,O]=(0,n.snapToGrid)(this.props.grid,C,O),k=this.lastX+C,F=this.lastY+O}const j=(0,n.createCoreData)(this,k,F);if(this.props.onStop(_,j)===!1||this.mounted===!1)return!1;const T=this.findDOMNode();T&&this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(T.ownerDocument),(0,o.default)("DraggableCore: handleDragStop: %j",j),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,T&&((0,o.default)("DraggableCore: Removing handlers"),(0,a.removeEvent)(T.ownerDocument,b.move,this.handleDrag),(0,a.removeEvent)(T.ownerDocument,b.stop,this.handleDragStop))}),m(this,"onMouseDown",_=>(b=y.mouse,this.handleDragStart(_))),m(this,"onMouseUp",_=>(b=y.mouse,this.handleDragStop(_))),m(this,"onTouchStart",_=>(b=y.touch,this.handleDragStart(_))),m(this,"onTouchEnd",_=>(b=y.touch,this.handleDragStop(_)))}componentDidMount(){this.mounted=!0;const _=this.findDOMNode();_&&(0,a.addEvent)(_,y.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const _=this.findDOMNode();if(_){const{ownerDocument:N}=_;(0,a.removeEvent)(N,y.mouse.move,this.handleDrag),(0,a.removeEvent)(N,y.touch.move,this.handleDrag),(0,a.removeEvent)(N,y.mouse.stop,this.handleDragStop),(0,a.removeEvent)(N,y.touch.stop,this.handleDragStop),(0,a.removeEvent)(_,y.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(N)}}findDOMNode(){var _,N;return(_=this.props)!==null&&_!==void 0&&_.nodeRef?(N=this.props)===null||N===void 0||(N=N.nodeRef)===null||N===void 0?void 0:N.current:r.default.findDOMNode(this)}render(){return e.cloneElement(e.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return y0.default=w,m(w,"displayName","DraggableCore"),m(w,"propTypes",{allowAnyClick:t.default.bool,children:t.default.node.isRequired,disabled:t.default.bool,enableUserSelectHack:t.default.bool,offsetParent:function(E,_){if(E[_]&&E[_].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:t.default.arrayOf(t.default.number),handle:t.default.string,cancel:t.default.string,nodeRef:t.default.object,onStart:t.default.func,onDrag:t.default.func,onStop:t.default.func,onMouseDown:t.default.func,scale:t.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),m(w,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),y0}var mS;function Tz(){return mS||(mS=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),e.default=void 0;var t=v(Ga()),r=m(ck()),a=m(Md()),n=m(Ez),l=o1(),o=fk(),f=lh(),d=m(kz()),x=m(dk());function m(N){return N&&N.__esModule?N:{default:N}}function p(N){if(typeof WeakMap!="function")return null;var k=new WeakMap,F=new WeakMap;return(p=function(j){return j?F:k})(N)}function v(N,k){if(N&&N.__esModule)return N;if(N===null||typeof N!="object"&&typeof N!="function")return{default:N};var F=p(k);if(F&&F.has(N))return F.get(N);var j={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in N)if(T!=="default"&&Object.prototype.hasOwnProperty.call(N,T)){var C=R?Object.getOwnPropertyDescriptor(N,T):null;C&&(C.get||C.set)?Object.defineProperty(j,T,C):j[T]=N[T]}return j.default=N,F&&F.set(N,j),j}function y(){return y=Object.assign?Object.assign.bind():function(N){for(var k=1;k<arguments.length;k++){var F=arguments[k];for(var j in F)Object.prototype.hasOwnProperty.call(F,j)&&(N[j]=F[j])}return N},y.apply(this,arguments)}function b(N,k,F){return k=w(k),k in N?Object.defineProperty(N,k,{value:F,enumerable:!0,configurable:!0,writable:!0}):N[k]=F,N}function w(N){var k=E(N,"string");return typeof k=="symbol"?k:String(k)}function E(N,k){if(typeof N!="object"||N===null)return N;var F=N[Symbol.toPrimitive];if(F!==void 0){var j=F.call(N,k);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(N)}class _ extends t.Component{static getDerivedStateFromProps(k,F){let{position:j}=k,{prevPropsPosition:R}=F;return j&&(!R||j.x!==R.x||j.y!==R.y)?((0,x.default)("Draggable: getDerivedStateFromProps %j",{position:j,prevPropsPosition:R}),{x:j.x,y:j.y,prevPropsPosition:{...j}}):null}constructor(k){super(k),b(this,"onDragStart",(F,j)=>{if((0,x.default)("Draggable: onDragStart: %j",j),this.props.onStart(F,(0,o.createDraggableData)(this,j))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),b(this,"onDrag",(F,j)=>{if(!this.state.dragging)return!1;(0,x.default)("Draggable: onDrag: %j",j);const R=(0,o.createDraggableData)(this,j),T={x:R.x,y:R.y,slackX:0,slackY:0};if(this.props.bounds){const{x:O,y:V}=T;T.x+=this.state.slackX,T.y+=this.state.slackY;const[z,H]=(0,o.getBoundPosition)(this,T.x,T.y);T.x=z,T.y=H,T.slackX=this.state.slackX+(O-T.x),T.slackY=this.state.slackY+(V-T.y),R.x=T.x,R.y=T.y,R.deltaX=T.x-this.state.x,R.deltaY=T.y-this.state.y}if(this.props.onDrag(F,R)===!1)return!1;this.setState(T)}),b(this,"onDragStop",(F,j)=>{if(!this.state.dragging||this.props.onStop(F,(0,o.createDraggableData)(this,j))===!1)return!1;(0,x.default)("Draggable: onDragStop: %j",j);const T={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:O,y:V}=this.props.position;T.x=O,T.y=V}this.setState(T)}),this.state={dragging:!1,dragged:!1,x:k.position?k.position.x:k.defaultPosition.x,y:k.position?k.position.y:k.defaultPosition.y,prevPropsPosition:{...k.position},slackX:0,slackY:0,isElementSVG:!1},k.position&&!(k.onDrag||k.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var k,F;return(k=(F=this.props)===null||F===void 0||(F=F.nodeRef)===null||F===void 0?void 0:F.current)!==null&&k!==void 0?k:a.default.findDOMNode(this)}render(){const{axis:k,bounds:F,children:j,defaultPosition:R,defaultClassName:T,defaultClassNameDragging:C,defaultClassNameDragged:O,position:V,positionOffset:z,scale:H,...ie}=this.props;let we={},ge=null;const le=!!!V||this.state.dragging,ne=V||R,te={x:(0,o.canDragX)(this)&&le?this.state.x:ne.x,y:(0,o.canDragY)(this)&&le?this.state.y:ne.y};this.state.isElementSVG?ge=(0,l.createSVGTransform)(te,z):we=(0,l.createCSSTransform)(te,z);const I=(0,n.default)(j.props.className||"",T,{[C]:this.state.dragging,[O]:this.state.dragged});return t.createElement(d.default,y({},ie,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(j),{className:I,style:{...j.props.style,...we},transform:ge}))}}e.default=_,b(_,"displayName","Draggable"),b(_,"propTypes",{...d.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:f.dontSetMe,style:f.dontSetMe,transform:f.dontSetMe}),b(_,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(ep)),ep}var pS;function Nz(){if(pS)return v0.exports;pS=1;const{default:e,DraggableCore:t}=Tz();return v0.exports=e,v0.exports.default=e,v0.exports.DraggableCore=t,v0.exports}var Cz=Nz();const Az=Vn(Cz);var Dr=function(){return Dr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Dr.apply(this,arguments)},gS={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},vS={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},td={width:"20px",height:"20px",position:"absolute",zIndex:1},jz={top:Dr(Dr({},gS),{top:"-5px"}),right:Dr(Dr({},vS),{left:void 0,right:"-5px"}),bottom:Dr(Dr({},gS),{top:void 0,bottom:"-5px"}),left:Dr(Dr({},vS),{left:"-5px"}),topRight:Dr(Dr({},td),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Dr(Dr({},td),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Dr(Dr({},td),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Dr(Dr({},td),{left:"-10px",top:"-10px",cursor:"nw-resize"})},Rz=A.memo(function(e){var t=e.onResizeStart,r=e.direction,a=e.children,n=e.replaceStyles,l=e.className,o=A.useCallback(function(x){t(x,r)},[t,r]),f=A.useCallback(function(x){t(x,r)},[t,r]),d=A.useMemo(function(){return Dr(Dr({position:"absolute",userSelect:"none"},jz[r]),n??{})},[n,r]);return c.jsx("div",{className:l||void 0,style:d,onMouseDown:o,onTouchStart:f,children:a})}),Dz=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),cs=function(){return cs=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},cs.apply(this,arguments)},Fz={width:"auto",height:"auto"},rd=function(e,t,r){return Math.max(Math.min(e,r),t)},yS=function(e,t,r){var a=Math.round(e/t);return a*t+r*(a-1)},Lo=function(e,t){return new RegExp(e,"i").test(t)},ad=function(e){return!!(e.touches&&e.touches.length)},Oz=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},bS=function(e,t,r){r===void 0&&(r=0);var a=t.reduce(function(l,o,f){return Math.abs(o-e)<Math.abs(t[l]-e)?f:l},0),n=Math.abs(t[a]-e);return r===0||n<r?t[a]:e},np=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:"".concat(e,"px")},nd=function(e,t,r,a){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var n=Number(e.replace("%",""))/100;return t*n}if(e.endsWith("vw")){var n=Number(e.replace("vw",""))/100;return r*n}if(e.endsWith("vh")){var n=Number(e.replace("vh",""))/100;return a*n}}return e},Mz=function(e,t,r,a,n,l,o){return a=nd(a,e.width,t,r),n=nd(n,e.height,t,r),l=nd(l,e.width,t,r),o=nd(o,e.height,t,r),{maxWidth:typeof a>"u"?void 0:Number(a),maxHeight:typeof n>"u"?void 0:Number(n),minWidth:typeof l>"u"?void 0:Number(l),minHeight:typeof o>"u"?void 0:Number(o)}},Lz=function(e){return Array.isArray(e)?e:[e,e]},Bz=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],wS="__resizable_base__",Pz=function(e){Dz(t,e);function t(r){var a,n,l,o,f=e.call(this,r)||this;return f.ratio=1,f.resizable=null,f.parentLeft=0,f.parentTop=0,f.resizableLeft=0,f.resizableRight=0,f.resizableTop=0,f.resizableBottom=0,f.targetLeft=0,f.targetTop=0,f.delta={width:0,height:0},f.appendBase=function(){if(!f.resizable||!f.window)return null;var d=f.parentNode;if(!d)return null;var x=f.window.document.createElement("div");return x.style.width="100%",x.style.height="100%",x.style.position="absolute",x.style.transform="scale(0, 0)",x.style.left="0",x.style.flex="0 0 100%",x.classList?x.classList.add(wS):x.className+=wS,d.appendChild(x),x},f.removeBase=function(d){var x=f.parentNode;x&&x.removeChild(d)},f.state={isResizing:!1,width:(n=(a=f.propsSize)===null||a===void 0?void 0:a.width)!==null&&n!==void 0?n:"auto",height:(o=(l=f.propsSize)===null||l===void 0?void 0:l.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},f.onResizeStart=f.onResizeStart.bind(f),f.onMouseMove=f.onMouseMove.bind(f),f.onMouseUp=f.onMouseUp.bind(f),f}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Fz},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var r=0,a=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,l=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),r=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:n,a=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:l,this.resizable.style.position=o}return{width:r,height:a}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var r=this,a=this.props.size,n=function(f){var d;if(typeof r.state[f]>"u"||r.state[f]==="auto")return"auto";if(r.propsSize&&r.propsSize[f]&&(!((d=r.propsSize[f])===null||d===void 0)&&d.toString().endsWith("%"))){if(r.state[f].toString().endsWith("%"))return r.state[f].toString();var x=r.getParentSize(),m=Number(r.state[f].toString().replace("px","")),p=m/x[f]*100;return"".concat(p,"%")}return np(r.state[f])},l=a&&typeof a.width<"u"&&!this.state.isResizing?np(a.width):n("width"),o=a&&typeof a.height<"u"&&!this.state.isResizing?np(a.height):n("height");return{width:l,height:o}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var r=this.appendBase();if(!r)return{width:0,height:0};var a=!1,n=this.parentNode.style.flexWrap;n!=="wrap"&&(a=!0,this.parentNode.style.flexWrap="wrap"),r.style.position="relative",r.style.minWidth="100%",r.style.minHeight="100%";var l={width:r.offsetWidth,height:r.offsetHeight};return a&&(this.parentNode.style.flexWrap=n),this.removeBase(r),l},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var r=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:r.flexBasis!=="auto"?r.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(r,a){var n=this.propsSize&&this.propsSize[a];return this.state[a]==="auto"&&this.state.original[a]===r&&(typeof n>"u"||n==="auto")?"auto":r},t.prototype.calculateNewMaxFromBoundary=function(r,a){var n=this.props.boundsByDirection,l=this.state.direction,o=n&&Lo("left",l),f=n&&Lo("top",l),d,x;if(this.props.bounds==="parent"){var m=this.parentNode;m&&(d=o?this.resizableRight-this.parentLeft:m.offsetWidth+(this.parentLeft-this.resizableLeft),x=f?this.resizableBottom-this.parentTop:m.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(d=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,x=f?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(d=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),x=f?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return d&&Number.isFinite(d)&&(r=r&&r<d?r:d),x&&Number.isFinite(x)&&(a=a&&a<x?a:x),{maxWidth:r,maxHeight:a}},t.prototype.calculateNewSizeFromDirection=function(r,a){var n=this.props.scale||1,l=Lz(this.props.resizeRatio||1),o=l[0],f=l[1],d=this.state,x=d.direction,m=d.original,p=this.props,v=p.lockAspectRatio,y=p.lockAspectRatioExtraHeight,b=p.lockAspectRatioExtraWidth,w=m.width,E=m.height,_=y||0,N=b||0;return Lo("right",x)&&(w=m.width+(r-m.x)*o/n,v&&(E=(w-N)/this.ratio+_)),Lo("left",x)&&(w=m.width-(r-m.x)*o/n,v&&(E=(w-N)/this.ratio+_)),Lo("bottom",x)&&(E=m.height+(a-m.y)*f/n,v&&(w=(E-_)*this.ratio+N)),Lo("top",x)&&(E=m.height-(a-m.y)*f/n,v&&(w=(E-_)*this.ratio+N)),{newWidth:w,newHeight:E}},t.prototype.calculateNewSizeFromAspectRatio=function(r,a,n,l){var o=this.props,f=o.lockAspectRatio,d=o.lockAspectRatioExtraHeight,x=o.lockAspectRatioExtraWidth,m=typeof l.width>"u"?10:l.width,p=typeof n.width>"u"||n.width<0?r:n.width,v=typeof l.height>"u"?10:l.height,y=typeof n.height>"u"||n.height<0?a:n.height,b=d||0,w=x||0;if(f){var E=(v-b)*this.ratio+w,_=(y-b)*this.ratio+w,N=(m-w)/this.ratio+b,k=(p-w)/this.ratio+b,F=Math.max(m,E),j=Math.min(p,_),R=Math.max(v,N),T=Math.min(y,k);r=rd(r,F,j),a=rd(a,R,T)}else r=rd(r,m,p),a=rd(a,v,y);return{newWidth:r,newHeight:a}},t.prototype.setBoundingClientRect=function(){var r=1/(this.props.scale||1);if(this.props.bounds==="parent"){var a=this.parentNode;if(a){var n=a.getBoundingClientRect();this.parentLeft=n.left*r,this.parentTop=n.top*r}}if(this.props.bounds&&typeof this.props.bounds!="string"){var l=this.props.bounds.getBoundingClientRect();this.targetLeft=l.left*r,this.targetTop=l.top*r}if(this.resizable){var o=this.resizable.getBoundingClientRect(),f=o.left,d=o.top,x=o.right,m=o.bottom;this.resizableLeft=f*r,this.resizableRight=x*r,this.resizableTop=d*r,this.resizableBottom=m*r}},t.prototype.onResizeStart=function(r,a){if(!(!this.resizable||!this.window)){var n=0,l=0;if(r.nativeEvent&&Oz(r.nativeEvent)?(n=r.nativeEvent.clientX,l=r.nativeEvent.clientY):r.nativeEvent&&ad(r.nativeEvent)&&(n=r.nativeEvent.touches[0].clientX,l=r.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(r,a,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var f,d=this.window.getComputedStyle(this.resizable);if(d.flexBasis!=="auto"){var x=this.parentNode;if(x){var m=this.window.getComputedStyle(x).flexDirection;this.flexDir=m.startsWith("row")?"row":"column",f=d.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var p={original:{x:n,y:l,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:cs(cs({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(r.target).cursor||"auto"}),direction:a,flexBasis:f};this.setState(p)}},t.prototype.onMouseMove=function(r){var a=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&ad(r))try{r.preventDefault(),r.stopPropagation()}catch{}var n=this.props,l=n.maxWidth,o=n.maxHeight,f=n.minWidth,d=n.minHeight,x=ad(r)?r.touches[0].clientX:r.clientX,m=ad(r)?r.touches[0].clientY:r.clientY,p=this.state,v=p.direction,y=p.original,b=p.width,w=p.height,E=this.getParentSize(),_=Mz(E,this.window.innerWidth,this.window.innerHeight,l,o,f,d);l=_.maxWidth,o=_.maxHeight,f=_.minWidth,d=_.minHeight;var N=this.calculateNewSizeFromDirection(x,m),k=N.newHeight,F=N.newWidth,j=this.calculateNewMaxFromBoundary(l,o);this.props.snap&&this.props.snap.x&&(F=bS(F,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(k=bS(k,this.props.snap.y,this.props.snapGap));var R=this.calculateNewSizeFromAspectRatio(F,k,{width:j.maxWidth,height:j.maxHeight},{width:f,height:d});if(F=R.newWidth,k=R.newHeight,this.props.grid){var T=yS(F,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),C=yS(k,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),O=this.props.snapGap||0,V=O===0||Math.abs(T-F)<=O?T:F,z=O===0||Math.abs(C-k)<=O?C:k;F=V,k=z}var H={width:F-y.width,height:k-y.height};if(this.delta=H,b&&typeof b=="string"){if(b.endsWith("%")){var ie=F/E.width*100;F="".concat(ie,"%")}else if(b.endsWith("vw")){var we=F/this.window.innerWidth*100;F="".concat(we,"vw")}else if(b.endsWith("vh")){var ge=F/this.window.innerHeight*100;F="".concat(ge,"vh")}}if(w&&typeof w=="string"){if(w.endsWith("%")){var ie=k/E.height*100;k="".concat(ie,"%")}else if(w.endsWith("vw")){var we=k/this.window.innerWidth*100;k="".concat(we,"vw")}else if(w.endsWith("vh")){var ge=k/this.window.innerHeight*100;k="".concat(ge,"vh")}}var ee={width:this.createSizeForCssProperty(F,"width"),height:this.createSizeForCssProperty(k,"height")};this.flexDir==="row"?ee.flexBasis=ee.width:this.flexDir==="column"&&(ee.flexBasis=ee.height);var le=this.state.width!==ee.width,ne=this.state.height!==ee.height,te=this.state.flexBasis!==ee.flexBasis,I=le||ne||te;I&&QS.flushSync(function(){a.setState(ee)}),this.props.onResize&&I&&this.props.onResize(r,v,this.resizable,H)}},t.prototype.onMouseUp=function(r){var a,n,l=this.state,o=l.isResizing,f=l.direction;l.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(r,f,this.resizable,this.delta),this.props.size&&this.setState({width:(a=this.props.size.width)!==null&&a!==void 0?a:"auto",height:(n=this.props.size.height)!==null&&n!==void 0?n:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:cs(cs({},this.state.backgroundStyle),{cursor:"auto"})}))},t.prototype.updateSize=function(r){var a,n;this.setState({width:(a=r.width)!==null&&a!==void 0?a:"auto",height:(n=r.height)!==null&&n!==void 0?n:"auto"})},t.prototype.renderResizer=function(){var r=this,a=this.props,n=a.enable,l=a.handleStyles,o=a.handleClasses,f=a.handleWrapperStyle,d=a.handleWrapperClass,x=a.handleComponent;if(!n)return null;var m=Object.keys(n).map(function(p){return n[p]!==!1?c.jsx(Rz,{direction:p,onResizeStart:r.onResizeStart,replaceStyles:l&&l[p],className:o&&o[p],children:x&&x[p]?x[p]:null},p):null});return c.jsx("div",{className:d,style:f,children:m})},t.prototype.render=function(){var r=this,a=Object.keys(this.props).reduce(function(o,f){return Bz.indexOf(f)!==-1||(o[f]=r.props[f]),o},{}),n=cs(cs(cs({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var l=this.props.as||"div";return c.jsxs(l,cs({style:n,className:this.props.className},a,{ref:function(o){o&&(r.resizable=o)},children:[this.state.isResizing&&c.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(A.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Xp=function(e,t){return Xp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)a.hasOwnProperty(n)&&(r[n]=a[n])},Xp(e,t)};function Iz(e,t){Xp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Pr=function(){return Pr=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Pr.apply(this,arguments)};function Uz(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}var zz={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},Hz=function(e){return{bottom:e,bottomLeft:e,bottomRight:e,left:e,right:e,top:e,topLeft:e,topRight:e}},Gz=function(e){Iz(t,e);function t(r){var a=e.call(this,r)||this;return a.resizingPosition={x:0,y:0},a.offsetFromParent={left:0,top:0},a.resizableElement={current:null},a.originalPosition={x:0,y:0},a.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:r.maxWidth,maxHeight:r.maxHeight},a.onResizeStart=a.onResizeStart.bind(a),a.onResize=a.onResize.bind(a),a.onResizeStop=a.onResizeStop.bind(a),a.onDragStart=a.onDragStart.bind(a),a.onDrag=a.onDrag.bind(a),a.onDragStop=a.onDragStop.bind(a),a.getMaxSizesFromProps=a.getMaxSizesFromProps.bind(a),a}return t.prototype.componentDidMount=function(){this.updateOffsetFromParent();var r=this.offsetFromParent,a=r.left,n=r.top,l=this.getDraggablePosition(),o=l.x,f=l.y;this.draggable.setState({x:o-a,y:f-n}),this.forceUpdate()},t.prototype.getDraggablePosition=function(){var r=this.draggable.state,a=r.x,n=r.y;return{x:a,y:n}},t.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},t.prototype.getParentSize=function(){return this.resizable.getParentSize()},t.prototype.getMaxSizesFromProps=function(){var r=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,a=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:r,maxHeight:a}},t.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},t.prototype.getOffsetHeight=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/a;case"body":return document.body.offsetHeight/a;default:return r.offsetHeight}},t.prototype.getOffsetWidth=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/a;case"body":return document.body.offsetWidth/a;default:return r.offsetWidth}},t.prototype.onDragStart=function(r,a){this.props.onDragStart&&this.props.onDragStart(r,a);var n=this.getDraggablePosition();if(this.originalPosition=n,!!this.props.bounds){var l=this.getParent(),o=this.props.scale,f;if(this.props.bounds==="parent")f=l;else if(this.props.bounds==="body"){var d=l.getBoundingClientRect(),x=d.left,m=d.top,p=document.body.getBoundingClientRect(),v=-(x-l.offsetLeft*o-p.left)/o,y=-(m-l.offsetTop*o-p.top)/o,b=(document.body.offsetWidth-this.resizable.size.width*o)/o+v,w=(document.body.offsetHeight-this.resizable.size.height*o)/o+y;return this.setState({bounds:{top:y,right:b,bottom:w,left:v}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var E=l.getBoundingClientRect(),_=E.left,N=E.top,k=-(_-l.offsetLeft*o)/o,F=-(N-l.offsetTop*o)/o,b=(window.innerWidth-this.resizable.size.width*o)/o+k,w=(window.innerHeight-this.resizable.size.height*o)/o+F;return this.setState({bounds:{top:F,right:b,bottom:w,left:k}})}else typeof this.props.bounds=="string"?f=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(f=this.props.bounds);if(!(!(f instanceof HTMLElement)||!(l instanceof HTMLElement))){var j=f.getBoundingClientRect(),R=j.left,T=j.top,C=l.getBoundingClientRect(),O=C.left,V=C.top,z=(R-O)/o,H=T-V;if(this.resizable){this.updateOffsetFromParent();var ie=this.offsetFromParent;this.setState({bounds:{top:H-ie.top,right:z+(f.offsetWidth-this.resizable.size.width)-ie.left/o,bottom:H+(f.offsetHeight-this.resizable.size.height)-ie.top,left:z-ie.left/o}})}}}},t.prototype.onDrag=function(r,a){if(this.props.onDrag){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(r,Pr(Pr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(r,Pr(Pr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(r,Pr(Pr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onDragStop=function(r,a){if(this.props.onDragStop){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(r,Pr(Pr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(r,Pr(Pr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(r,Pr(Pr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onResizeStart=function(r,a,n){r.stopPropagation(),this.setState({resizing:!0});var l=this.props.scale,o=this.offsetFromParent,f=this.getDraggablePosition();if(this.resizingPosition={x:f.x+o.left,y:f.y+o.top},this.originalPosition=f,this.props.bounds){var d=this.getParent(),x=void 0;this.props.bounds==="parent"?x=d:this.props.bounds==="body"?x=document.body:this.props.bounds==="window"?x=window:typeof this.props.bounds=="string"?x=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(x=this.props.bounds);var m=this.getSelfElement();if(m instanceof Element&&(x instanceof HTMLElement||x===window)&&d instanceof HTMLElement){var p=this.getMaxSizesFromProps(),v=p.maxWidth,y=p.maxHeight,b=this.getParentSize();if(v&&typeof v=="string")if(v.endsWith("%")){var w=Number(v.replace("%",""))/100;v=b.width*w}else v.endsWith("px")&&(v=Number(v.replace("px","")));if(y&&typeof y=="string")if(y.endsWith("%")){var w=Number(y.replace("%",""))/100;y=b.height*w}else y.endsWith("px")&&(y=Number(y.replace("px","")));var E=m.getBoundingClientRect(),_=E.left,N=E.top,k=this.props.bounds==="window"?{left:0,top:0}:x.getBoundingClientRect(),F=k.left,j=k.top,R=this.getOffsetWidth(x),T=this.getOffsetHeight(x),C=a.toLowerCase().endsWith("left"),O=a.toLowerCase().endsWith("right"),V=a.startsWith("top"),z=a.startsWith("bottom");if((C||V)&&this.resizable){var H=(_-F)/l+this.resizable.size.width;this.setState({maxWidth:H>Number(v)?v:H})}if(O||this.props.lockAspectRatio&&!C&&!V){var H=R+(F-_)/l;this.setState({maxWidth:H>Number(v)?v:H})}if((V||C)&&this.resizable){var H=(N-j)/l+this.resizable.size.height;this.setState({maxHeight:H>Number(y)?y:H})}if(z||this.props.lockAspectRatio&&!V&&!C){var H=T+(j-N)/l;this.setState({maxHeight:H>Number(y)?y:H})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(r,a,n)},t.prototype.onResize=function(r,a,n,l){var o=this,f={x:this.originalPosition.x,y:this.originalPosition.y},d=-l.width,x=-l.height,m=["top","left","topLeft","bottomLeft","topRight"];m.includes(a)&&(a==="bottomLeft"?f.x+=d:(a==="topRight"||(f.x+=d),f.y+=x));var p=this.draggable.state;(f.x!==p.x||f.y!==p.y)&&QS.flushSync(function(){o.draggable.setState(f)}),this.updateOffsetFromParent();var v=this.offsetFromParent,y=this.getDraggablePosition().x+v.left,b=this.getDraggablePosition().y+v.top;this.resizingPosition={x:y,y:b},this.props.onResize&&this.props.onResize(r,a,n,l,{x:y,y:b})},t.prototype.onResizeStop=function(r,a,n,l){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),f=o.maxWidth,d=o.maxHeight;this.setState({maxWidth:f,maxHeight:d}),this.props.onResizeStop&&this.props.onResizeStop(r,a,n,l,this.resizingPosition)},t.prototype.updateSize=function(r){this.resizable&&this.resizable.updateSize({width:r.width,height:r.height})},t.prototype.updatePosition=function(r){this.draggable.setState(r)},t.prototype.updateOffsetFromParent=function(){var r=this.props.scale,a=this.getParent(),n=this.getSelfElement();if(!a||n===null)return{top:0,left:0};var l=a.getBoundingClientRect(),o=l.left,f=l.top,d=n.getBoundingClientRect(),x=this.getDraggablePosition(),m=a.scrollLeft,p=a.scrollTop;this.offsetFromParent={left:d.left-o+m-x.x*r,top:d.top-f+p-x.y*r}},t.prototype.render=function(){var r=this,a=this.props,n=a.disableDragging,l=a.style,o=a.dragHandleClassName,f=a.position,d=a.onMouseDown,x=a.onMouseUp,m=a.dragAxis,p=a.dragGrid,v=a.bounds,y=a.enableUserSelectHack,b=a.cancel,w=a.children;a.onResizeStart,a.onResize,a.onResizeStop,a.onDragStart,a.onDrag,a.onDragStop;var E=a.resizeHandleStyles,_=a.resizeHandleClasses,N=a.resizeHandleComponent,k=a.enableResizing,F=a.resizeGrid,j=a.resizeHandleWrapperClass,R=a.resizeHandleWrapperStyle,T=a.scale,C=a.allowAnyClick,O=a.dragPositionOffset,V=Uz(a,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),z=this.props.default?Pr({},this.props.default):void 0;delete V.default;var H=n||o?{cursor:"auto"}:{cursor:"move"},ie=Pr(Pr(Pr({},zz),H),l),we=this.offsetFromParent,ge=we.left,ee=we.top,le;f&&(le={x:f.x-ge,y:f.y-ee});var ne=this.state.resizing?void 0:le,te=this.state.resizing?"both":m;return A.createElement(Az,{ref:function(I){I&&(r.draggable=I)},handle:o?".".concat(o):void 0,defaultPosition:z,onMouseDown:d,onMouseUp:x,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:te,disabled:n,grid:p,bounds:v?this.state.bounds:void 0,position:ne,enableUserSelectHack:y,cancel:b,scale:T,allowAnyClick:C,nodeRef:this.resizableElement,positionOffset:O},A.createElement(Pz,Pr({},V,{ref:function(I){I&&(r.resizable=I,r.resizableElement.current=I.resizable)},defaultSize:z,size:this.props.size,enable:typeof k=="boolean"?Hz(k):k,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:ie,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:F,handleWrapperClass:j,handleWrapperStyle:R,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:E,handleClasses:_,handleComponent:N,scale:this.props.scale}),w))},t.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},t}(A.PureComponent);function Vz(){const{tableId:e}=Nn(),{eventId:t}=Hr(),{data:r,isLoading:a,error:n}=_u(e),l=hU(e,t),[o,f]=A.useState(()=>{var m;return((m=r==null?void 0:r.layout)==null?void 0:m.reduce((p,v)=>({...p,[v.guestId]:{x:v.x,y:v.y}}),{}))??{}});if(a)return c.jsx(an,{});if(n||!r)return c.jsx("p",{children:"Error loading layout."});const d=(m,p)=>{f(v=>({...v,[m]:{x:p.x,y:p.y}}))},x=()=>{const m=Object.entries(o).map(([p,v])=>({guestId:p,x:v.x,y:v.y}));l.mutate({layout:m})};return c.jsxs("div",{className:"relative h-[500px] border bg-gray-50",children:[r.guests.map(m=>{const p=o[m.id]??{x:20,y:20};return c.jsx(Gz,{size:{width:80,height:30},position:p,bounds:"parent",onDragStop:(v,y)=>d(m.id,y),children:c.jsx("div",{className:"p-1 bg-white dark:bg-gray-800 border rounded text-sm",children:m.guestName})},m.id)}),c.jsx("button",{onClick:x,className:"absolute bottom-4 right-4 bg-button text-white px-4 py-2 rounded",children:"Save Layout"})]})}function qz(){const{tableId:e}=Nn(),{data:t,isLoading:r,error:a}=_u(e);return r?c.jsx(an,{}):a||!t?c.jsx("p",{children:"Error loading print view."}):c.jsxs("div",{className:"p-4 print:p-0",children:[c.jsxs("h1",{className:"text-2xl font-semibold mb-4",children:["Seating Plan: ",t.name]}),c.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.guests.map(n=>c.jsx("div",{className:"border p-2 flex flex-col items-center print:border-gray-800",children:n.guestName},n.id))})]})}function Wz(){const{tableId:e}=Nn(),{data:t,isLoading:r,error:a}=_u(e);return r?c.jsx(an,{}):a||!t?c.jsx("p",{children:"Failed to load table."}):c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Guests at ",t.name," (",t.assignedCount,"/",t.capacity,")"]}),c.jsx("ul",{className:"space-y-2",children:t.guests.map(n=>c.jsxs("li",{className:"p-3 bg-white dark:bg-gray-800 rounded shadow",children:[c.jsx("p",{className:"font-medium",children:n.guestName}),n.phoneNo&&c.jsxs("p",{className:"text-sm",children:["Phone: ",n.phoneNo]}),n.noOfPax!==void 0&&c.jsxs("p",{className:"text-sm",children:["Pax: ",n.noOfPax]})]},n.id))})]})}const hk="floorplan-";function SS(e){try{const t=localStorage.getItem(hk+e);return t?JSON.parse(t):[]}catch{return[]}}function Xz(e,t){localStorage.setItem(hk+e,JSON.stringify(t))}function $z(e){const[t,r]=A.useState(()=>SS(e)),a=A.useRef(!1);A.useEffect(()=>{r(SS(e)),a.current=!1},[e]),A.useEffect(()=>{if(!a.current){a.current=!0;return}Xz(e,t)},[e,t]);const n=A.useCallback(p=>{r(v=>[...v,p])},[]),l=A.useCallback((p,v)=>{r(y=>y.map(b=>b.id===p?{...b,...v}:b))},[]),o=A.useCallback(p=>{r(v=>v.filter(y=>y.id!==p))},[]),f=A.useCallback((p,v=3)=>{r(y=>{const b=y.filter(O=>O.type!=="table"),w=y.filter(O=>O.type==="table"),E=w.filter(O=>p.includes(O.id)),_=Math.max(...E.map(O=>O.width),100),N=Math.max(...E.map(O=>O.height),100),k=_+80,F=N+80,j=60,R=60,T=E.map((O,V)=>({...O,x:j+V%v*k,y:R+Math.floor(V/v)*F})),C=w.filter(O=>!p.includes(O.id));return[...b,...T,...C]})},[]),d=A.useCallback((p,v)=>{if(v==="rect")return{width:Math.max(160,60+p*14),height:70};if(v==="square"){const b=Math.max(90,50+Math.ceil(p/4)*20);return{width:b,height:b}}const y=Math.max(100,60+p*6);return{width:y,height:y}},[]),x=A.useCallback((p,v="round")=>{r(y=>{let b=!1;const w=new Map(p.map(z=>[z.id,z.capacity])),E=y.map(z=>{if(z.type==="table"&&(!z.meta||!z.meta.shape)){b=!0;const H=w.get(z.id)??8,ie=d(H,"round");return{...z,...ie,meta:{...z.meta,shape:"round",capacity:H}}}return z}),_=new Set(E.filter(z=>z.type==="table").map(z=>z.id)),N=p.filter(z=>!_.has(z.id));if(N.length===0)return b?E:y;const k=3,F=260,j=240,R=60,T=60,O=E.filter(z=>z.type==="table").length,V=N.map((z,H)=>{const ie=d(z.capacity,v);return{id:z.id,type:"table",x:R+(O+H)%k*F,y:T+Math.floor((O+H)/k)*j,...ie,meta:{shape:v,capacity:z.capacity}}});return[...E,...V]})},[d]),m=A.useCallback((p,v)=>{r(y=>y.map(b=>{var _;if(b.id!==p||b.type!=="table")return b;const w=((_=b.meta)==null?void 0:_.capacity)??8,E=d(w,v);return{...b,...E,meta:{...b.meta,shape:v}}}))},[d]);return{floorItems:t,setFloorItems:r,addItem:n,updateItem:l,removeItem:o,autoArrange:f,syncTables:x,changeTableShape:m}}function ES(e,t,r){return r?Math.round(e/t)*t:e}const $p=26,Ln=$p/2,b0=6;function Yz(e,t,r,a){const n=[];if(e==="round"){const l=r/2,o=a/2,f=Math.max(r,a)/2+b0+Ln;for(let d=0;d<t;d++){const x=2*Math.PI*d/t-Math.PI/2;n.push({x:l+Math.cos(x)*f-Ln,y:o+Math.sin(x)*f-Ln})}}else if(e==="rect"){const l=t>=6?1:0,o=t-l*2,f=Math.ceil(o/2),d=o-f;let x=0;for(let m=0;m<f&&x<t;m++,x++)n.push({x:r/(f+1)*(m+1)-Ln,y:-32});for(let m=0;m<l&&x<t;m++,x++)n.push({x:r+b0,y:a/2-Ln});for(let m=0;m<d&&x<t;m++,x++)n.push({x:r/(d+1)*(m+1)-Ln,y:a+b0});for(let m=0;m<l&&x<t;m++,x++)n.push({x:-32,y:a/2-Ln})}else{const l=Math.ceil(t/4);let o=0;for(let f=0;f<l&&o<t;f++,o++){const d=(f+1)/(l+1);n.push({x:d*r-Ln,y:-32})}for(let f=0;f<l&&o<t;f++,o++){const d=(f+1)/(l+1);n.push({x:r+b0,y:d*a-Ln})}for(let f=0;f<l&&o<t;f++,o++){const d=(l-f)/(l+1);n.push({x:d*r-Ln,y:a+b0})}for(let f=0;f<l&&o<t;f++,o++){const d=(l-f)/(l+1);n.push({x:-32,y:d*a-Ln})}}return n}const _S=["linear-gradient(135deg, #7c3aed, #a855f7)","linear-gradient(135deg, #ec4899, #f43f5e)","linear-gradient(135deg, #3b82f6, #2563eb)","linear-gradient(135deg, #22c55e, #16a34a)","linear-gradient(135deg, #f97316, #ea580c)","linear-gradient(135deg, #8b5cf6, #6366f1)","linear-gradient(135deg, #06b6d4, #0891b2)","linear-gradient(135deg, #eab308, #ca8a04)"];function Kz(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return _S[Math.abs(t)%_S.length]}const Qz=({item:e,table:t,assignedGuests:r,zoom:a,selected:n,snapEnabled:l,snapSize:o,onSelect:f,onMove:d,onDoubleClick:x,onDropGuest:m,onSeatClick:p,onResize:v})=>{var z;const y=A.useRef(!1),b=A.useRef({x:0,y:0}),w=A.useRef(!1),E=A.useCallback(H=>{if(H.button!==0)return;H.stopPropagation(),f(e.id),y.current=!0,w.current=!1,b.current={x:(H.clientX-H.currentTarget.getBoundingClientRect().left)/a,y:(H.clientY-H.currentTarget.getBoundingClientRect().top)/a};const ie=ge=>{if(!y.current)return;w.current=!0;const ee=document.getElementById("floor-canvas-content");if(!ee)return;const le=ee.getBoundingClientRect(),ne=(ge.clientX-le.left)/a-b.current.x,te=(ge.clientY-le.top)/a-b.current.y;d(e.id,ES(ne,o,l),ES(te,o,l))},we=()=>{y.current=!1,window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",we)};window.addEventListener("mousemove",ie),window.addEventListener("mouseup",we)},[e.id,a,l,o,f,d]),_=A.useCallback(H=>{H.stopPropagation(),w.current||x(e.id)},[e.id,x]),N=A.useCallback(H=>{H.preventDefault(),H.dataTransfer.dropEffect="move"},[]),k=A.useCallback(H=>{H.preventDefault();const ie=H.dataTransfer.getData("guestId");ie&&t&&m(t.id,ie)},[t,m]);if(!t)return null;const F=t.capacity||8,j=r.length,R=((z=e.meta)==null?void 0:z.shape)||"round",T=Kz(e.id),O=R==="round"?"50%":R==="rect"?12:8,V=Yz(R,F,e.width,e.height);return c.jsxs("div",{style:{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",zIndex:n?100:10,transition:"box-shadow 0.2s, transform 0.1s"},onMouseDown:E,onDoubleClick:_,onDragOver:N,onDrop:k,children:[V.map((H,ie)=>{var le;const we=r[ie],ge=!!we,ee=(we==null?void 0:we.flag)==="VIP";return c.jsx("div",{title:ge?`${we.name}  click to unassign`:`Seat ${ie+1}  click to assign`,onClick:ne=>{ne.stopPropagation();const te=ne.currentTarget.getBoundingClientRect();p(e.id,ie,ge?we.id:null,te.left+te.width/2,te.top)},style:{position:"absolute",left:H.x,top:H.y,width:$p,height:$p,borderRadius:"50%",border:ge?ee?"2px solid #a855f7":"2px solid #22c55e":"2px dashed #cbd5e1",background:ge?ee?"linear-gradient(135deg, #a855f7, #7c3aed)":"linear-gradient(135deg, #22c55e, #16a34a)":"white",color:ge?"white":"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,cursor:"pointer",transition:"all 0.2s",zIndex:2},children:ge?((le=we.name)==null?void 0:le[0])??"G":ie+1},ie)}),c.jsxs("div",{style:{width:"100%",height:"100%",background:T,borderRadius:O,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",outline:n?"3px solid #4f46e5":"none",outlineOffset:n?4:void 0,boxShadow:n?"0 12px 30px rgba(79, 70, 229, 0.3)":"0 4px 12px rgba(0, 0, 0, 0.08)",transition:"box-shadow 0.2s, outline 0.15s"},children:[c.jsx("span",{style:{color:"white",fontSize:14,lineHeight:1},children:j>=F?"":""}),c.jsx("span",{style:{color:"white",fontSize:10,fontWeight:700,marginTop:2,letterSpacing:.3},children:t.name}),c.jsxs("span",{style:{color:"rgba(255,255,255,0.75)",fontSize:9,fontWeight:500},children:[j,"/",F]})]}),n&&c.jsx("div",{onMouseDown:H=>{H.stopPropagation(),H.preventDefault();const ie=H.clientX,we=H.clientY,ge=e.width,ee=e.height,le=te=>{const I=(te.clientX-ie)/a,Z=(te.clientY-we)/a;v(e.id,Math.max(50,ge+I),Math.max(50,ee+Z))},ne=()=>{window.removeEventListener("mousemove",le),window.removeEventListener("mouseup",ne)};window.addEventListener("mousemove",le),window.addEventListener("mouseup",ne)},style:{position:"absolute",bottom:-6,right:-6,width:14,height:14,background:"white",border:"2px solid #4f46e5",borderRadius:3,cursor:"nwse-resize",zIndex:10}})]})},Zz=({item:e,zoom:t,selected:r,onSelect:a,onMove:n,onResize:l})=>{const o=A.useRef(!1),f=A.useRef({x:0,y:0}),d=A.useCallback(b=>{if(b.button!==0)return;b.stopPropagation(),a(e.id),o.current=!0,f.current={x:(b.clientX-b.currentTarget.getBoundingClientRect().left)/t,y:(b.clientY-b.currentTarget.getBoundingClientRect().top)/t};const w=_=>{if(!o.current)return;const N=document.getElementById("floor-canvas-content");if(!N)return;const k=N.getBoundingClientRect(),F=(_.clientX-k.left)/t-f.current.x,j=(_.clientY-k.top)/t-f.current.y;n(e.id,F,j)},E=()=>{o.current=!1,window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",E)};window.addEventListener("mousemove",w),window.addEventListener("mouseup",E)},[e.id,t,a,n]),x=e.type==="stage",m=e.type==="danceFloor",p=e.type==="pillar";let v={position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:500,fontSize:10,zIndex:r?50:5,transition:"box-shadow 0.2s"};x?v={...v,background:"linear-gradient(135deg, #4f46e5, #7c3aed)",color:"white",fontWeight:600,letterSpacing:2,textTransform:"uppercase",fontSize:12,borderRadius:"4px 4px 40px 40px"}:m?v={...v,background:"repeating-conic-gradient(from 0deg, #f8fafc 0deg 90deg, #e0e7ff 90deg 180deg)",backgroundSize:"40px 40px",border:"3px solid #e2e8f0",borderRadius:8,color:"#64748b",fontSize:11}:p?v={...v,background:"radial-gradient(circle at 30% 30%, #78716c, #57534e)",border:"3px solid #44403c",borderRadius:"50%",boxShadow:"inset 0 -3px 8px rgba(0,0,0,0.3)",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"}:v={...v,background:"repeating-linear-gradient(45deg, #64748b, #64748b 10px, #475569 10px, #475569 20px)",border:"2px solid #334155",borderRadius:4,color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},r&&(v.outline="3px solid #4f46e5",v.outlineOffset=4,v.boxShadow="0 8px 25px rgba(79, 70, 229, 0.25)");const y=x?" Stage":m?" Dance Floor":p?"":" Wall";return c.jsxs("div",{style:v,onMouseDown:d,onClick:b=>{b.stopPropagation(),a(e.id)},children:[e.type==="wall"&&e.height>e.width?c.jsx("span",{style:{transform:"rotate(90deg)",whiteSpace:"nowrap"},children:y}):y,r&&c.jsx("div",{onMouseDown:b=>{b.stopPropagation(),b.preventDefault();const w=b.clientX,E=b.clientY,_=e.width,N=e.height,k=j=>{const R=(j.clientX-w)/t,T=(j.clientY-E)/t,C=p?20:30;l(e.id,Math.max(C,_+R),Math.max(C,N+T))},F=()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",F)};window.addEventListener("mousemove",k),window.addEventListener("mouseup",F)},style:{position:"absolute",bottom:-6,right:-6,width:14,height:14,background:"white",border:"2px solid #4f46e5",borderRadius:3,cursor:"nwse-resize",zIndex:10}})]})},Jz=({floorItems:e,tables:t,guests:r,zoom:a,panX:n,panY:l,selectedId:o,snapEnabled:f,snapSize:d,toolMode:x,onZoomChange:m,onPanChange:p,onSelect:v,onMoveItem:y,onDoubleClickTable:b,onDropGuest:w,onDeleteSelected:E,onCanvasClick:_,onSeatClick:N,onResizeItem:k})=>{var Z,L;const F=A.useRef(null),j=A.useRef(!1),R=A.useRef({x:0,y:0,px:0,py:0}),[T,C]=A.useState(!0);A.useEffect(()=>{o&&F.current&&F.current.focus()},[o]),A.useEffect(()=>{const P=setTimeout(()=>C(!1),8e3);return()=>clearTimeout(P)},[]),A.useEffect(()=>{const P=F.current;if(!P)return;const U=Y=>{Y.preventDefault();const re=Y.deltaY>0?-.1:.1;m(Math.min(2,Math.max(.3,a+re)))};return P.addEventListener("wheel",U,{passive:!1}),()=>P.removeEventListener("wheel",U)},[a,m]);const O=A.useCallback(P=>{var Y;if(!P.target.closest("[data-floor-item]")){if(x!=="select"){const re=(Y=F.current)==null?void 0:Y.getBoundingClientRect();if(re){const ve=(P.clientX-re.left-n)/a,be=(P.clientY-re.top-l)/a,Te=f?Math.round(ve/d)*d:ve,Ae=f?Math.round(be/d)*d:be;_(Te,Ae)}return}v(null),j.current=!0,R.current={x:P.clientX,y:P.clientY,px:n,py:l}}},[n,l,a,f,d,x,v,_]),V=A.useCallback(P=>{if(!j.current)return;const U=P.clientX-R.current.x,Y=P.clientY-R.current.y;p(R.current.px+U,R.current.py+Y)},[p]),z=A.useCallback(()=>{j.current=!1},[]),H=A.useCallback(P=>{(P.key==="Delete"||P.key==="Backspace")&&E(),P.key==="Escape"&&v(null)},[E,v]),ie=new Map(t.map(P=>[P.id,P])),we=180,ge=120,ee=2e3,le=1400,ne=we/ee,te=18,I=A.useCallback(P=>{P.stopPropagation(),P.preventDefault();const U=P.currentTarget.getBoundingClientRect(),Y=(be,Te)=>{var Ot,dr;const Ae=be-U.left,Ve=Te-U.top-te,Q=Ae/ne,st=Ve/ne,it=((Ot=F.current)==null?void 0:Ot.clientWidth)??800,Qe=((dr=F.current)==null?void 0:dr.clientHeight)??500,tt=-(Q*a)+it/2,De=-(st*a)+Qe/2;p(tt,De)};Y(P.clientX,P.clientY);const re=be=>Y(be.clientX,be.clientY),ve=()=>{window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ve)};window.addEventListener("mousemove",re),window.addEventListener("mouseup",ve)},[a,ne,p]);return c.jsxs("div",{ref:F,className:"floor-canvas flex-1 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 shadow-lg bg-white dark:bg-slate-900 relative",style:{background:`
          linear-gradient(90deg, rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(to bottom right, #f8fafc, #f1f5f9)`,backgroundSize:"40px 40px, 40px 40px, 100% 100%",cursor:x!=="select"?"crosshair":j.current?"grabbing":"grab",minHeight:400},tabIndex:0,onMouseDown:O,onMouseMove:V,onMouseUp:z,onMouseLeave:z,onKeyDown:H,children:[c.jsx("div",{id:"floor-canvas-content",style:{transform:`translate(${n}px, ${l}px) scale(${a})`,transformOrigin:"0 0",width:ee,height:le,position:"absolute",top:0,left:0},children:e.map(P=>{if(P.type==="table"){const U=ie.get(P.id),Y=r.filter(re=>re.tableId===P.id);return c.jsx("div",{"data-floor-item":!0,children:c.jsx(Qz,{item:P,table:U,assignedGuests:Y,zoom:a,selected:o===P.id,snapEnabled:f,snapSize:d,onSelect:v,onMove:y,onDoubleClick:b,onDropGuest:w,onSeatClick:N,onResize:k})},P.id)}return c.jsx("div",{"data-floor-item":!0,children:c.jsx(Zz,{item:P,zoom:a,selected:o===P.id,onSelect:v,onMove:y,onResize:k})},P.id)})}),T&&c.jsxs("div",{className:"absolute top-3 left-3 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-gray-200/80 dark:border-gray-700/80 rounded-lg px-3 py-2.5 shadow-lg max-w-[240px] z-20 animate-fade-in",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:"Quick Tips"}),c.jsx("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition -mt-0.5",onClick:()=>C(!1),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("ul",{className:"text-[10px] text-gray-500 dark:text-gray-400 space-y-0.5 leading-relaxed",children:[c.jsx("li",{children:"Drag tables to reposition"}),c.jsx("li",{children:"Double-click table to edit"}),c.jsx("li",{children:"Click seats to assign/unassign guests"}),c.jsx("li",{children:"Drag corner handle to resize"}),c.jsxs("li",{children:["Select + ",c.jsx("kbd",{className:"px-1 py-px bg-gray-100 dark:bg-slate-700 rounded text-[9px] font-mono",children:"Del"})," to remove obstacles"]}),c.jsx("li",{children:"Scroll to zoom, drag minimap to navigate"})]})]}),c.jsxs("div",{className:"absolute bottom-3 right-3 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-gray-200/80 dark:border-gray-700/80 rounded-lg overflow-hidden shadow-md z-20",style:{width:we,height:ge+te,cursor:"pointer"},onMouseDown:I,children:[c.jsx("div",{className:"px-2 py-0.5 text-[8px] text-gray-400 dark:text-gray-500 uppercase tracking-wider border-b border-gray-100 dark:border-gray-700/50 bg-gray-50/80 dark:bg-slate-900/50 font-medium select-none",children:"Overview  drag to navigate"}),c.jsxs("div",{className:"relative",style:{height:ge},children:[e.map(P=>{const U=P.type==="table",Y=U?"#7c3aed":P.type==="stage"?"#4f46e5":P.type==="danceFloor"?"#c7d2fe":"#64748b";return c.jsx("div",{style:{position:"absolute",left:P.x*ne,top:P.y*ne,width:Math.max(4,P.width*ne),height:Math.max(4,P.height*ne),background:Y,borderRadius:U||P.type==="pillar"?"50%":2,pointerEvents:"none"}},P.id)}),c.jsx("div",{style:{position:"absolute",border:"2px solid #4f46e5",background:"rgba(79, 70, 229, 0.1)",borderRadius:2,pointerEvents:"none",left:Math.max(0,-n/a)*ne,top:Math.max(0,-l/a)*ne,width:(((Z=F.current)==null?void 0:Z.clientWidth)??800)/a*ne,height:(((L=F.current)==null?void 0:L.clientHeight)??500)/a*ne}})]})]})]})},kS=({guests:e,tables:t})=>{const[r,a]=A.useState(""),[n,l]=A.useState(null),o=A.useMemo(()=>e.filter(m=>!m.tableId),[e]),f=A.useMemo(()=>e.filter(m=>!!m.tableId),[e]),d=A.useMemo(()=>{if(!r)return o;const m=r.toLowerCase();return o.filter(p=>{var v;return p.name.toLowerCase().includes(m)||((v=p.phoneNo)==null?void 0:v.toLowerCase().includes(m))})},[o,r]),x=A.useMemo(()=>new Map(t.map(m=>[m.id,m.name])),[t]);return c.jsxs("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4 text-primary",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),c.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:"Guests"})]}),c.jsxs("div",{className:"flex gap-1",children:[c.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-semibold rounded-full bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400",children:[f.length," seated"]}),c.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-semibold rounded-full bg-amber-50 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400",children:[o.length," pending"]})]})]}),c.jsx("div",{className:"px-3 py-2 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),c.jsx("input",{type:"text",placeholder:"Search guests...",value:r,onChange:m=>a(m.target.value),className:"w-full border border-gray-200 dark:border-gray-600 rounded-lg pl-8 pr-3 py-1.5 text-xs bg-gray-50 dark:bg-slate-800 text-slate-800 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition"})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",style:{scrollbarWidth:"thin"},children:[c.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-yellow-600 dark:text-yellow-400 font-semibold flex items-center gap-1 mb-2",children:[" Unassigned (",o.length,")"]}),d.length===0?c.jsx("div",{className:"text-center py-6",children:c.jsx("p",{className:"text-sm text-slate-400",children:r?"No matches found":"All guests are assigned!"})}):d.map(m=>c.jsxs("div",{draggable:!0,onDragStart:p=>{p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("guestId",m.id),l(m.id)},onDragEnd:()=>l(null),className:`p-3 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-slate-800 cursor-grab hover:border-primary hover:bg-indigo-50 dark:hover:bg-primary/10 transition-all ${n===m.id?"opacity-50":""}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),(m.pax??1)>0&&c.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400",children:[m.pax??1," pax"]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[m.phoneNo&&c.jsxs("span",{children:[" ",m.phoneNo]}),m.flag==="VIP"&&c.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]})]},m.id)),f.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-green-600 dark:text-green-400 font-semibold flex items-center gap-1 mt-4 mb-2",children:[" Assigned (",f.length,")"]}),f.slice(0,5).map(m=>c.jsx("div",{className:"p-3 rounded-lg border border-green-200 dark:border-green-800 bg-green-50/50 dark:bg-green-900/20",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),c.jsxs("p",{className:"text-[10px] text-green-600 dark:text-green-400",children:[x.get(m.tableId??"")??"Table","  Seat ",m.seatIndex??"?"]})]}),c.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:[m.pax??1," pax"]})]})},m.id)),f.length>5&&c.jsxs("p",{className:"text-center text-xs text-gray-400 py-2",children:["+ ",f.length-5," more assigned..."]})]})]})]})};let eH=0;function tH(){return`fp-${Date.now()}-${++eH}`}function rH(){var lt;const{eventId:e}=Hr(),{data:t=[],isLoading:r}=sh(e??""),{data:a=[],isLoading:n}=nh(e??""),l=a1(e??""),o=n1(e??""),f=nk(e??""),{floorItems:d,addItem:x,updateItem:m,removeItem:p,autoArrange:v,syncTables:y,changeTableShape:b}=$z(e??""),[w,E]=A.useState(1),[_,N]=A.useState(0),[k,F]=A.useState(0),[j,R]=A.useState(null),[T,C]=A.useState(!0),[O,V]=A.useState("select"),[z,H]=A.useState(!1),[ie,we]=A.useState(null),[ge,ee]=A.useState(null),[le,ne]=A.useState(!1),[te,I]=A.useState(null),Z=40,L=kl.useRef(null),P=kl.useRef(null);A.useEffect(()=>{if(t.length>0){const Ce=P.current||"round";y(t.map(ut=>({id:ut.id,capacity:ut.capacity||8})),Ce),P.current=null}},[t,y]),A.useEffect(()=>{if(!ge)return;const Ce=setTimeout(()=>ee(null),2500);return()=>clearTimeout(Ce)},[ge]);const U=A.useCallback((Ce,ut="")=>{ee({message:Ce,icon:ut})},[]),Y=A.useCallback((Ce,ut)=>{N(Ce),F(ut)},[]),re=A.useCallback((Ce,ut,St)=>{m(Ce,{x:ut,y:St})},[m]),ve=A.useCallback((Ce,ut,St)=>{m(Ce,{width:ut,height:St})},[m]),be=A.useCallback(Ce=>{R(Ce)},[]),Te=A.useCallback(()=>{if(!j)return;const Ce=d.find(ut=>ut.id===j);if(Ce){if(Ce.type==="table"){f.mutate(j,{onSuccess:()=>{p(j),R(null),U("Table deleted","")},onError:()=>U("Failed to delete table","")});return}p(j),R(null),U("Element removed","")}},[j,d,p,f,U]),Ae=A.useCallback(Ce=>{we(Ce),H(!0)},[]),Ve=A.useCallback(Ce=>{if(Ce==="select"){V("select");return}if(j){const ut=d.find(St=>St.id===j);if((ut==null?void 0:ut.type)==="table"){b(j,Ce),U(`Table shape changed to ${Ce}`,"");return}}V(Ce),U(`Click on canvas to place ${Ce} table`,"")},[j,d,b,U]),Q=A.useCallback((Ce,ut,St,Mr,Ra)=>{St?o.mutate(St,{onSuccess:()=>U("Guest unassigned",""),onError:()=>U("Failed to unassign guest","")}):I({tableId:Ce,seatIndex:ut,guestId:null,anchorX:Mr,anchorY:Ra})},[o,U]),st=A.useCallback(Ce=>{te&&(l.mutate({guestId:Ce,tableId:te.tableId},{onSuccess:()=>U("Guest assigned!",""),onError:()=>U("Failed to assign guest","")}),I(null))},[te,l,U]),it=A.useCallback((Ce,ut)=>{l.mutate({guestId:ut,tableId:Ce},{onSuccess:()=>U("Guest assigned!",""),onError:()=>U("Failed to assign guest","")})},[l,U]),Qe=A.useCallback(()=>{v(t.map(Ce=>Ce.id)),U("Tables auto-arranged","")},[v,t,U]),tt=A.useCallback(Ce=>{const ut={stage:{w:280,h:50},danceFloor:{w:180,h:160},pillar:{w:45,h:45},wall:{w:80,h:40}},St={stage:"",danceFloor:"",pillar:"",wall:""},Mr=ut[Ce]??{w:100,h:100};x({id:tH(),type:Ce,x:200+Math.random()*200,y:100+Math.random()*200,width:Mr.w,height:Mr.h}),U(`${Ce==="danceFloor"?"Dance floor":Ce.charAt(0).toUpperCase()+Ce.slice(1)} added!`,St[Ce]??"")},[x,U]),De=A.useCallback((Ce,ut)=>{O!=="select"&&(L.current={x:Ce,y:ut,shape:O},we(null),H(!0))},[O]),Ot=A.useCallback(()=>{H(!1),we(null),L.current&&(P.current=L.current.shape,L.current=null,V("select"))},[]),dr=A.useCallback(()=>{U("Layout saved!","")},[U]),Zr=A.useCallback(()=>{E(1),N(0),F(0),U("View reset","")},[U]),hr=A.useMemo(()=>a.filter(Ce=>!Ce.tableId).length,[a]),An=a.length-hr,ya=t.reduce((Ce,ut)=>Ce+(ut.capacity||0),0),xr=ie?t.find(Ce=>Ce.id===ie):void 0,Yt=j?d.find(Ce=>Ce.id===j):null,Cr=(Yt==null?void 0:Yt.type)==="table"?t.find(Ce=>Ce.id===j):null,or=(Yt==null?void 0:Yt.type)==="table"?((lt=Yt.meta)==null?void 0:lt.shape)||"round":null;if(!e)return c.jsx(Yl,{title:"No Event Selected",message:"Select or create an event to start designing your floor plan."});const Nt=Ce=>`p-1.5 rounded-md transition-all ${Ce?"bg-primary text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-white dark:hover:bg-slate-700"}`,Mt="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 transition";return c.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[c.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 px-5 pt-4 pb-2 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white tracking-tight",children:"Floor Plan"}),c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-400"}),t.length," tables"]}),c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400",children:[An,"/",ya," seated"]}),hr>0&&c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400",children:[hr," unassigned"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:Qe,className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold bg-emerald-500 text-white hover:bg-emerald-600 shadow-sm transition active:scale-[0.97]",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3.5 w-3.5",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})}),c.jsx("span",{className:"hidden sm:inline",children:"Auto-Arrange"})]}),c.jsxs("button",{onClick:()=>{we(null),H(!0)},className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold bg-primary text-white hover:brightness-110 shadow-sm transition active:scale-[0.97]",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3.5 w-3.5",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),c.jsx("span",{className:"hidden sm:inline",children:"New Table"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2 px-5 py-1.5 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-0.5 p-0.5 rounded-lg bg-gray-100/80 dark:bg-slate-800/80 border border-gray-200/60 dark:border-gray-700/60",children:[c.jsx("button",{onClick:()=>Ve("round"),className:Nt(O==="round"),title:"Round table",children:c.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${O==="round"?"border-white/60":"border-primary/60"}`})}),c.jsx("button",{onClick:()=>Ve("rect"),className:Nt(O==="rect"),title:"Long table",children:c.jsx("div",{className:`w-6 h-3.5 rounded-sm border-2 ${O==="rect"?"border-white/60":"border-secondary/60"}`})}),c.jsx("button",{onClick:()=>Ve("square"),className:Nt(O==="square"),title:"Square table",children:c.jsx("div",{className:`w-4 h-4 rounded-sm border-2 ${O==="square"?"border-white/60":"border-emerald-500/60"}`})}),c.jsx("div",{className:"w-px h-5 bg-gray-300/50 dark:bg-gray-600/50 mx-0.5"}),c.jsx("button",{onClick:()=>tt("stage"),className:Nt(!1),title:"Add stage",children:c.jsx("span",{className:"text-sm leading-none",children:""})}),c.jsx("button",{onClick:()=>tt("danceFloor"),className:Nt(!1),title:"Add dance floor",children:c.jsx("span",{className:"text-sm leading-none",children:""})}),c.jsx("div",{className:"w-px h-5 bg-gray-300/50 dark:bg-gray-600/50 mx-0.5"}),c.jsx("button",{onClick:()=>tt("wall"),className:Nt(!1),title:"Add wall",children:c.jsx("div",{className:"w-5 h-3.5 rounded-sm bg-gradient-to-br from-slate-400 to-slate-600"})}),c.jsx("button",{onClick:()=>tt("pillar"),className:Nt(!1),title:"Add pillar",children:c.jsx("div",{className:"w-4 h-4 rounded-full bg-gradient-to-br from-stone-400 to-stone-600"})})]}),Yt&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 animate-fade-in",children:[c.jsx("span",{className:"text-[11px] font-semibold text-indigo-600 dark:text-indigo-400 whitespace-nowrap",children:Yt.type==="table"?(Cr==null?void 0:Cr.name)??"Table":Yt.type==="stage"?"Stage":Yt.type==="danceFloor"?"Dance Floor":Yt.type==="pillar"?"Pillar":"Wall"}),Yt.type==="table"&&c.jsx("div",{className:"flex items-center gap-0.5 ml-1 p-0.5 rounded bg-indigo-100/80 dark:bg-indigo-800/40",children:["round","rect","square"].map(Ce=>c.jsxs("button",{onClick:()=>b(j,Ce),className:`p-1 rounded transition ${or===Ce?"bg-white dark:bg-indigo-700 shadow-sm":"hover:bg-white/60 dark:hover:bg-indigo-700/40"}`,title:`Change to ${Ce}`,children:[Ce==="round"&&c.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-indigo-500"}),Ce==="rect"&&c.jsx("div",{className:"w-5 h-2.5 rounded-sm border-2 border-indigo-500"}),Ce==="square"&&c.jsx("div",{className:"w-3 h-3 rounded-sm border-2 border-indigo-500"})]},Ce))}),c.jsxs("button",{onClick:Te,disabled:f.isPending,className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[11px] font-medium text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition disabled:opacity-50",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),f.isPending?"Deleting...":"Delete"]}),c.jsx("button",{onClick:()=>R(null),className:"ml-0.5 p-0.5 rounded text-indigo-400 hover:text-indigo-600 dark:hover:text-indigo-300 transition",title:"Deselect",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"ml-auto flex items-center gap-1.5",children:[c.jsxs("div",{className:"flex items-center rounded-lg bg-white dark:bg-slate-800 border border-gray-200 dark:border-gray-700 overflow-hidden",children:[c.jsx("button",{onClick:()=>E(Ce=>Math.max(.3,+(Ce-.1).toFixed(1))),className:"px-2 py-1 text-sm text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:""}),c.jsxs("span",{className:"px-2 py-1 text-[11px] font-medium text-gray-600 dark:text-gray-300 min-w-[42px] text-center border-x border-gray-200 dark:border-gray-700",children:[Math.round(w*100),"%"]}),c.jsx("button",{onClick:()=>E(Ce=>Math.min(2,+(Ce+.1).toFixed(1))),className:"px-2 py-1 text-sm text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:"+"})]}),c.jsxs("button",{onClick:()=>C(Ce=>!Ce),className:`px-2 py-1.5 rounded-lg text-[11px] font-semibold border transition ${T?"bg-primary/10 border-primary/30 text-primary dark:bg-primary/20":"bg-white dark:bg-slate-800 border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,title:`Snap to grid: ${T?"ON":"OFF"}`,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3.5 w-3.5 inline-block mr-0.5 -mt-px",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})}),"Snap"]}),c.jsx("button",{onClick:Zr,className:Mt,title:"Reset view",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"})})}),c.jsx("div",{className:"w-px h-5 bg-gray-200 dark:bg-gray-700"}),c.jsx("button",{onClick:dr,className:Mt,title:"Save layout",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"})})}),c.jsx("button",{onClick:()=>window.print(),className:Mt,title:"Print layout",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})})})]})]}),c.jsx("div",{className:"flex-1 flex gap-3 overflow-hidden px-5 pb-4 min-h-0",children:r||n?c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-3 text-primary animate-fade-in",children:[c.jsx(Xn,{}),c.jsx("p",{className:"text-sm text-text/50 dark:text-white/50",children:"Loading floor plan..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Jz,{floorItems:d,tables:t,guests:a,zoom:w,panX:_,panY:k,selectedId:j,snapEnabled:T,snapSize:Z,toolMode:O,onZoomChange:E,onPanChange:Y,onSelect:be,onMoveItem:re,onDoubleClickTable:Ae,onDropGuest:it,onDeleteSelected:Te,onCanvasClick:De,onSeatClick:Q,onResizeItem:ve}),c.jsx("div",{className:"hidden lg:flex h-full",children:c.jsx(kS,{guests:a,tables:t.map(Ce=>({id:Ce.id,name:Ce.name}))})}),c.jsxs("button",{onClick:()=>ne(!0),className:"lg:hidden fixed bottom-6 left-6 z-40 bg-primary text-white px-4 py-3 rounded-full shadow-lg shadow-primary/25 flex items-center gap-2 hover:brightness-110 transition active:scale-95",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),c.jsx("span",{className:"text-sm font-semibold",children:"Guests"}),hr>0&&c.jsx("span",{className:"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:hr})]})]})}),c.jsx(ih,{isOpen:z,onClose:Ot,initial:xr?{id:xr.id,name:xr.name,capacity:xr.capacity}:void 0}),le&&c.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 flex",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>ne(!1)}),c.jsxs("div",{className:"relative ml-auto h-full w-80 max-w-[85vw] animate-slide-left",children:[c.jsx("button",{onClick:()=>ne(!1),className:"absolute top-3 right-3 z-10 bg-gray-100 dark:bg-slate-700 rounded-full w-8 h-8 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600 transition",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),c.jsx(kS,{guests:a,tables:t.map(Ce=>({id:Ce.id,name:Ce.name}))})]})]}),te&&c.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>I(null),children:c.jsxs("div",{className:"absolute bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 w-64 max-h-72 overflow-hidden flex flex-col animate-fade-in",style:{left:Math.min(te.anchorX-128,window.innerWidth-272),top:Math.max(8,te.anchorY-280)},onClick:Ce=>Ce.stopPropagation(),children:[c.jsxs("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-slate-900",children:[c.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:"Assign Guest to Seat"}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Seat #",te.seatIndex+1]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-0.5",style:{scrollbarWidth:"thin"},children:a.filter(Ce=>!Ce.tableId).length===0?c.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No unassigned guests"}):a.filter(Ce=>!Ce.tableId).map(Ce=>c.jsxs("button",{onClick:()=>st(Ce.id),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-slate-700 transition flex items-center justify-between group",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:Ce.name}),Ce.flag==="VIP"&&c.jsx("span",{className:"ml-2 px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]}),c.jsxs("span",{className:"text-xs text-gray-400 group-hover:text-primary",children:[Ce.pax??1," pax"]})]},Ce.id))})]})}),ge&&c.jsxs("div",{className:"fixed bottom-6 right-6 z-50 bg-slate-800 dark:bg-slate-700 text-white px-5 py-3 rounded-xl shadow-2xl flex items-center gap-2.5 animate-slide-up text-sm",children:[c.jsx("span",{className:"text-base",children:ge.icon}),c.jsx("span",{children:ge.message})]})]})}function aH(){const e=ja();return c.jsxs(wN,{children:[c.jsx(ft,{path:"/rsvp/submit/:token",element:c.jsx(aS,{})}),c.jsxs(ft,{element:c.jsx(OA,{}),children:[c.jsx(ft,{path:"/",element:c.jsx(mA,{})}),c.jsx(ft,{path:"/login",element:c.jsx(pA,{})}),c.jsx(ft,{path:"/events",element:c.jsx(hz,{})}),c.jsx(ft,{path:"/rsvp",element:c.jsx(aS,{})}),c.jsx(ft,{path:"/rsvp/share/:token",element:c.jsx(iU,{})})]}),c.jsxs(ft,{path:"/app",element:c.jsx(I6,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(wm,{to:"dashboard",replace:!0})}),c.jsx(ft,{path:"dashboard",element:c.jsx(lz,{})}),c.jsxs(ft,{path:"events",element:c.jsx(Bs,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(U6,{})}),c.jsx(ft,{path:"new",element:c.jsx(Xd,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(ft,{path:":id/edit",element:c.jsx(z6,{})}),c.jsx(ft,{path:":id/form-fields",element:c.jsx(gz,{})})]}),c.jsxs(ft,{path:"rsvps",element:c.jsx(Bs,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(UI,{})}),c.jsx(ft,{path:"designer",element:c.jsx(sU,{})}),c.jsx(ft,{path:"new",element:c.jsx(xz,{})}),c.jsx(ft,{path:":id/edit",element:c.jsx(mz,{})})]}),c.jsx(ft,{path:"guests",element:c.jsx(vU,{})}),c.jsxs(ft,{path:"tables",element:c.jsx(Bs,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(kU,{})}),c.jsx(ft,{path:"floorplan",element:c.jsx(rH,{})}),c.jsx(ft,{path:"new",element:c.jsx(ih,{isOpen:!0,onClose:()=>e(-1)})}),c.jsxs(ft,{path:":tableId",element:c.jsx(yz,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(Wz,{})}),c.jsx(ft,{path:"assignments",element:c.jsx(vz,{})}),c.jsx(ft,{path:"layout",element:c.jsx(Vz,{})}),c.jsx(ft,{path:"print",element:c.jsx(qz,{})}),c.jsx(ft,{path:"edit",element:c.jsx(TU,{})})]})]}),c.jsxs(ft,{path:"seating",element:c.jsx(Bs,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(DU,{})}),c.jsx(ft,{path:"new",element:c.jsx(s1,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(ft,{path:":id/edit",element:c.jsx(FU,{})})]}),c.jsxs(ft,{path:"users",element:c.jsx(Bs,{}),children:[c.jsx(ft,{index:!0,element:c.jsx(IU,{})}),c.jsx(ft,{path:"new",element:c.jsx(i1,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(ft,{path:":id/edit",element:c.jsx(UU,{})})]}),c.jsx(ft,{path:"wallet",element:c.jsx(az,{})}),c.jsx(ft,{path:"*",element:c.jsx(wm,{to:"/app/dashboard",replace:!0})})]}),c.jsx(ft,{path:"*",element:c.jsx(wm,{to:"/",replace:!0})})]})}function nH(){return c.jsx(r5,{children:c.jsx(hA,{children:c.jsx(WN,{children:c.jsx(aH,{})})})})}const sH=new $C;CT.createRoot(document.getElementById("root")).render(c.jsx(A.StrictMode,{children:c.jsxs(JC,{client:sH,children:[c.jsx(PA,{children:c.jsx(nH,{})}),c.jsx(FI,{position:"top-right"})]})}));
