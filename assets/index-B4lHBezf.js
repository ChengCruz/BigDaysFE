var I2=e=>{throw TypeError(e)};var fm=(e,t,r)=>t.has(e)||I2("Cannot "+r);var ae=(e,t,r)=>(fm(e,t,"read from private field"),r?r.call(e):t.get(e)),Qe=(e,t,r)=>t.has(e)?I2("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ve=(e,t,r,a)=>(fm(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),ht=(e,t,r)=>(fm(e,t,"access private method"),r);var Of=(e,t,r,a)=>({set _(n){Ve(e,t,n,r)},get _(){return ae(e,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Mf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function xT(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),r}var dm={exports:{}},o0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U2;function mT(){if(U2)return o0;U2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,l){var o=null;if(l!==void 0&&(o=""+l),n.key!==void 0&&(o=""+n.key),"key"in n){l={};for(var f in n)f!=="key"&&(l[f]=n[f])}else l=n;return n=l.ref,{$$typeof:e,type:a,key:o,ref:n!==void 0?n:null,props:l}}return o0.Fragment=t,o0.jsx=r,o0.jsxs=r,o0}var z2;function pT(){return z2||(z2=1,dm.exports=mT()),dm.exports}var c=pT(),hm={exports:{}},ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H2;function gT(){if(H2)return ut;H2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function v(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function E(z,te,B){this.props=z,this.context=te,this.refs=S,this.updater=B||y}E.prototype.isReactComponent={},E.prototype.setState=function(z,te){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,te,"setState")},E.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function _(){}_.prototype=E.prototype;function N(z,te,B){this.props=z,this.context=te,this.refs=S,this.updater=B||y}var k=N.prototype=new _;k.constructor=N,b(k,E.prototype),k.isPureReactComponent=!0;var R=Array.isArray,A={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function T(z,te,B,I,M,W){return B=W.ref,{$$typeof:e,type:z,key:te,ref:B!==void 0?B:null,props:W}}function O(z,te){return T(z.type,te,void 0,void 0,void 0,z.props)}function F(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function q(z){var te={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(B){return te[B]})}var X=/\/+/g;function U(z,te){return typeof z=="object"&&z!==null&&z.key!=null?q(""+z.key):te.toString(36)}function ee(){}function oe(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(ee,ee):(z.status="pending",z.then(function(te){z.status==="pending"&&(z.status="fulfilled",z.value=te)},function(te){z.status==="pending"&&(z.status="rejected",z.reason=te)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function ce(z,te,B,I,M){var W=typeof z;(W==="undefined"||W==="boolean")&&(z=null);var ne=!1;if(z===null)ne=!0;else switch(W){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(z.$$typeof){case e:case t:ne=!0;break;case m:return ne=z._init,ce(ne(z._payload),te,B,I,M)}}if(ne)return M=M(z),ne=I===""?"."+U(z,0):I,R(M)?(B="",ne!=null&&(B=ne.replace(X,"$&/")+"/"),ce(M,te,B,"",function(Se){return Se})):M!=null&&(F(M)&&(M=O(M,B+(M.key==null||z&&z.key===M.key?"":(""+M.key).replace(X,"$&/")+"/")+ne)),te.push(M)),1;ne=0;var ye=I===""?".":I+":";if(R(z))for(var be=0;be<z.length;be++)I=z[be],W=ye+U(I,be),ne+=ce(I,te,B,W,M);else if(be=v(z),typeof be=="function")for(z=be.call(z),be=0;!(I=z.next()).done;)I=I.value,W=ye+U(I,be++),ne+=ce(I,te,B,W,M);else if(W==="object"){if(typeof z.then=="function")return ce(oe(z),te,B,I,M);throw te=String(z),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return ne}function Z(z,te,B){if(z==null)return z;var I=[],M=0;return ce(z,I,"","",function(W){return te.call(B,W,M++)}),I}function ie(z){if(z._status===-1){var te=z._result;te=te(),te.then(function(B){(z._status===0||z._status===-1)&&(z._status=1,z._result=B)},function(B){(z._status===0||z._status===-1)&&(z._status=2,z._result=B)}),z._status===-1&&(z._status=0,z._result=te)}if(z._status===1)return z._result.default;throw z._result}var ke=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function re(){}return ut.Children={map:Z,forEach:function(z,te,B){Z(z,function(){te.apply(this,arguments)},B)},count:function(z){var te=0;return Z(z,function(){te++}),te},toArray:function(z){return Z(z,function(te){return te})||[]},only:function(z){if(!F(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ut.Component=E,ut.Fragment=r,ut.Profiler=n,ut.PureComponent=N,ut.StrictMode=a,ut.Suspense=d,ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ut.__COMPILER_RUNTIME={__proto__:null,c:function(z){return A.H.useMemoCache(z)}},ut.cache=function(z){return function(){return z.apply(null,arguments)}},ut.cloneElement=function(z,te,B){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var I=b({},z.props),M=z.key,W=void 0;if(te!=null)for(ne in te.ref!==void 0&&(W=void 0),te.key!==void 0&&(M=""+te.key),te)!D.call(te,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&te.ref===void 0||(I[ne]=te[ne]);var ne=arguments.length-2;if(ne===1)I.children=B;else if(1<ne){for(var ye=Array(ne),be=0;be<ne;be++)ye[be]=arguments[be+2];I.children=ye}return T(z.type,M,void 0,void 0,W,I)},ut.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:l,_context:z},z},ut.createElement=function(z,te,B){var I,M={},W=null;if(te!=null)for(I in te.key!==void 0&&(W=""+te.key),te)D.call(te,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(M[I]=te[I]);var ne=arguments.length-2;if(ne===1)M.children=B;else if(1<ne){for(var ye=Array(ne),be=0;be<ne;be++)ye[be]=arguments[be+2];M.children=ye}if(z&&z.defaultProps)for(I in ne=z.defaultProps,ne)M[I]===void 0&&(M[I]=ne[I]);return T(z,W,void 0,void 0,null,M)},ut.createRef=function(){return{current:null}},ut.forwardRef=function(z){return{$$typeof:f,render:z}},ut.isValidElement=F,ut.lazy=function(z){return{$$typeof:m,_payload:{_status:-1,_result:z},_init:ie}},ut.memo=function(z,te){return{$$typeof:x,type:z,compare:te===void 0?null:te}},ut.startTransition=function(z){var te=A.T,B={};A.T=B;try{var I=z(),M=A.S;M!==null&&M(B,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(re,ke)}catch(W){ke(W)}finally{A.T=te}},ut.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ut.use=function(z){return A.H.use(z)},ut.useActionState=function(z,te,B){return A.H.useActionState(z,te,B)},ut.useCallback=function(z,te){return A.H.useCallback(z,te)},ut.useContext=function(z){return A.H.useContext(z)},ut.useDebugValue=function(){},ut.useDeferredValue=function(z,te){return A.H.useDeferredValue(z,te)},ut.useEffect=function(z,te,B){var I=A.H;if(typeof B=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return I.useEffect(z,te)},ut.useId=function(){return A.H.useId()},ut.useImperativeHandle=function(z,te,B){return A.H.useImperativeHandle(z,te,B)},ut.useInsertionEffect=function(z,te){return A.H.useInsertionEffect(z,te)},ut.useLayoutEffect=function(z,te){return A.H.useLayoutEffect(z,te)},ut.useMemo=function(z,te){return A.H.useMemo(z,te)},ut.useOptimistic=function(z,te){return A.H.useOptimistic(z,te)},ut.useReducer=function(z,te,B){return A.H.useReducer(z,te,B)},ut.useRef=function(z){return A.H.useRef(z)},ut.useState=function(z){return A.H.useState(z)},ut.useSyncExternalStore=function(z,te,B){return A.H.useSyncExternalStore(z,te,B)},ut.useTransition=function(){return A.H.useTransition()},ut.version="19.1.0",ut}var G2;function La(){return G2||(G2=1,hm.exports=gT()),hm.exports}var C=La();const bl=Bn(C);var xm={exports:{}},c0={},mm={exports:{}},pm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V2;function vT(){return V2||(V2=1,function(e){function t(Z,ie){var ke=Z.length;Z.push(ie);e:for(;0<ke;){var re=ke-1>>>1,z=Z[re];if(0<n(z,ie))Z[re]=ie,Z[ke]=z,ke=re;else break e}}function r(Z){return Z.length===0?null:Z[0]}function a(Z){if(Z.length===0)return null;var ie=Z[0],ke=Z.pop();if(ke!==ie){Z[0]=ke;e:for(var re=0,z=Z.length,te=z>>>1;re<te;){var B=2*(re+1)-1,I=Z[B],M=B+1,W=Z[M];if(0>n(I,ke))M<z&&0>n(W,I)?(Z[re]=W,Z[M]=ke,re=M):(Z[re]=I,Z[B]=ke,re=B);else if(M<z&&0>n(W,ke))Z[re]=W,Z[M]=ke,re=M;else break e}}return ie}function n(Z,ie){var ke=Z.sortIndex-ie.sortIndex;return ke!==0?ke:Z.id-ie.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,f=o.now();e.unstable_now=function(){return o.now()-f}}var d=[],x=[],m=1,p=null,v=3,y=!1,b=!1,S=!1,E=!1,_=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function R(Z){for(var ie=r(x);ie!==null;){if(ie.callback===null)a(x);else if(ie.startTime<=Z)a(x),ie.sortIndex=ie.expirationTime,t(d,ie);else break;ie=r(x)}}function A(Z){if(S=!1,R(Z),!b)if(r(d)!==null)b=!0,D||(D=!0,U());else{var ie=r(x);ie!==null&&ce(A,ie.startTime-Z)}}var D=!1,T=-1,O=5,F=-1;function q(){return E?!0:!(e.unstable_now()-F<O)}function X(){if(E=!1,D){var Z=e.unstable_now();F=Z;var ie=!0;try{e:{b=!1,S&&(S=!1,N(T),T=-1),y=!0;var ke=v;try{t:{for(R(Z),p=r(d);p!==null&&!(p.expirationTime>Z&&q());){var re=p.callback;if(typeof re=="function"){p.callback=null,v=p.priorityLevel;var z=re(p.expirationTime<=Z);if(Z=e.unstable_now(),typeof z=="function"){p.callback=z,R(Z),ie=!0;break t}p===r(d)&&a(d),R(Z)}else a(d);p=r(d)}if(p!==null)ie=!0;else{var te=r(x);te!==null&&ce(A,te.startTime-Z),ie=!1}}break e}finally{p=null,v=ke,y=!1}ie=void 0}}finally{ie?U():D=!1}}}var U;if(typeof k=="function")U=function(){k(X)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=X,U=function(){oe.postMessage(null)}}else U=function(){_(X,0)};function ce(Z,ie){T=_(function(){Z(e.unstable_now())},ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(Z){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var ke=v;v=ie;try{return Z()}finally{v=ke}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(Z,ie){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ke=v;v=Z;try{return ie()}finally{v=ke}},e.unstable_scheduleCallback=function(Z,ie,ke){var re=e.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?re+ke:re):ke=re,Z){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=ke+z,Z={id:m++,callback:ie,priorityLevel:Z,startTime:ke,expirationTime:z,sortIndex:-1},ke>re?(Z.sortIndex=ke,t(x,Z),r(d)===null&&Z===r(x)&&(S?(N(T),T=-1):S=!0,ce(A,ke-re))):(Z.sortIndex=z,t(d,Z),b||y||(b=!0,D||(D=!0,U()))),Z},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(Z){var ie=v;return function(){var ke=v;v=ie;try{return Z.apply(this,arguments)}finally{v=ke}}}}(pm)),pm}var q2;function yT(){return q2||(q2=1,mm.exports=vT()),mm.exports}var gm={exports:{}},ra={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W2;function bT(){if(W2)return ra;W2=1;var e=La();function t(d){var x="https://react.dev/errors/"+d;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)x+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function l(d,x,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:p==null?null:""+p,children:d,containerInfo:x,implementation:m}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,x){if(d==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return ra.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ra.createPortal=function(d,x){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return l(d,x,null,m)},ra.flushSync=function(d){var x=o.T,m=a.p;try{if(o.T=null,a.p=2,d)return d()}finally{o.T=x,a.p=m,a.d.f()}},ra.preconnect=function(d,x){typeof d=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,a.d.C(d,x))},ra.prefetchDNS=function(d){typeof d=="string"&&a.d.D(d)},ra.preinit=function(d,x){if(typeof d=="string"&&x&&typeof x.as=="string"){var m=x.as,p=f(m,x.crossOrigin),v=typeof x.integrity=="string"?x.integrity:void 0,y=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;m==="style"?a.d.S(d,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:y}):m==="script"&&a.d.X(d,{crossOrigin:p,integrity:v,fetchPriority:y,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},ra.preinitModule=function(d,x){if(typeof d=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var m=f(x.as,x.crossOrigin);a.d.M(d,{crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&a.d.M(d)},ra.preload=function(d,x){if(typeof d=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var m=x.as,p=f(m,x.crossOrigin);a.d.L(d,m,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},ra.preloadModule=function(d,x){if(typeof d=="string")if(x){var m=f(x.as,x.crossOrigin);a.d.m(d,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:m,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else a.d.m(d)},ra.requestFormReset=function(d){a.d.r(d)},ra.unstable_batchedUpdates=function(d,x){return d(x)},ra.useFormState=function(d,x,m){return o.H.useFormState(d,x,m)},ra.useFormStatus=function(){return o.H.useHostTransitionStatus()},ra.version="19.1.0",ra}var X2;function Fd(){if(X2)return gm.exports;X2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),gm.exports=bT(),gm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y2;function wT(){if(Y2)return c0;Y2=1;var e=yT(),t=La(),r=Fd();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(l(s)!==s)throw Error(a(188))}function d(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(a(188));return i!==s?null:s}for(var u=s,h=i;;){var g=u.return;if(g===null)break;var w=g.alternate;if(w===null){if(h=g.return,h!==null){u=h;continue}break}if(g.child===w.child){for(w=g.child;w;){if(w===u)return f(g),s;if(w===h)return f(g),i;w=w.sibling}throw Error(a(188))}if(u.return!==h.return)u=g,h=w;else{for(var j=!1,P=g.child;P;){if(P===u){j=!0,u=g,h=w;break}if(P===h){j=!0,h=g,u=w;break}P=P.sibling}if(!j){for(P=w.child;P;){if(P===u){j=!0,u=w,h=g;break}if(P===h){j=!0,h=w,u=g;break}P=P.sibling}if(!j)throw Error(a(189))}}if(u.alternate!==h)throw Error(a(190))}if(u.tag!==3)throw Error(a(188));return u.stateNode.current===u?s:i}function x(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=x(s),i!==null)return i;s=s.sibling}return null}var m=Object.assign,p=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=X&&s[X]||s["@@iterator"],typeof s=="function"?s:null)}var ee=Symbol.for("react.client.reference");function oe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ee?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case E:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case D:return"SuspenseList";case F:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case k:return(s.displayName||"Context")+".Provider";case N:return(s._context.displayName||"Context")+".Consumer";case R:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case T:return i=s.displayName||null,i!==null?i:oe(s.type)||"Memo";case O:i=s._payload,s=s._init;try{return oe(s(i))}catch{}}return null}var ce=Array.isArray,Z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke={pending:!1,data:null,method:null,action:null},re=[],z=-1;function te(s){return{current:s}}function B(s){0>z||(s.current=re[z],re[z]=null,z--)}function I(s,i){z++,re[z]=s.current,s.current=i}var M=te(null),W=te(null),ne=te(null),ye=te(null);function be(s,i){switch(I(ne,i),I(W,s),I(M,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?h2(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=h2(i),s=x2(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}B(M),I(M,s)}function Se(){B(M),B(W),B(ne)}function Ne(s){s.memoizedState!==null&&I(ye,s);var i=M.current,u=x2(i,s.type);i!==u&&(I(W,s),I(M,u))}function Xe(s){W.current===s&&(B(M),B(W)),ye.current===s&&(B(ye),a0._currentValue=ke)}var V=Object.prototype.hasOwnProperty,We=e.unstable_scheduleCallback,$e=e.unstable_cancelCallback,dt=e.unstable_shouldYield,Je=e.unstable_requestPaint,Oe=e.unstable_now,Ct=e.unstable_getCurrentPriorityLevel,Pt=e.unstable_ImmediatePriority,Rr=e.unstable_UserBlockingPriority,St=e.unstable_NormalPriority,wn=e.unstable_LowPriority,ha=e.unstable_IdlePriority,ur=e.log,qt=e.unstable_setDisableYieldValue,_r=null,ir=null;function Et(s){if(typeof ur=="function"&&qt(s),ir&&typeof ir.setStrictMode=="function")try{ir.setStrictMode(_r,s)}catch{}}var De=Math.clz32?Math.clz32:Be,Re=Math.log,xe=Math.LN2;function Be(s){return s>>>=0,s===0?32:31-(Re(s)/xe|0)|0}var He=256,Kt=4194304;function Dr(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function os(s,i,u){var h=s.pendingLanes;if(h===0)return 0;var g=0,w=s.suspendedLanes,j=s.pingedLanes;s=s.warmLanes;var P=h&134217727;return P!==0?(h=P&~w,h!==0?g=Dr(h):(j&=P,j!==0?g=Dr(j):u||(u=P&~s,u!==0&&(g=Dr(u))))):(P=h&~w,P!==0?g=Dr(P):j!==0?g=Dr(j):u||(u=h&~s,u!==0&&(g=Dr(u)))),g===0?0:i!==0&&i!==g&&(i&w)===0&&(w=g&-g,u=i&-i,w>=u||w===32&&(u&4194048)!==0)?i:g}function Hn(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Hi(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hs(){var s=He;return He<<=1,(He&4194048)===0&&(He=256),s}function fc(){var s=Kt;return Kt<<=1,(Kt&62914560)===0&&(Kt=4194304),s}function dc(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function Gi(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Vl(s,i,u,h,g,w){var j=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var P=s.entanglements,J=s.expirationTimes,de=s.hiddenUpdates;for(u=j&~u;0<u;){var Te=31-De(u),Ae=1<<Te;P[Te]=0,J[Te]=-1;var pe=de[Te];if(pe!==null)for(de[Te]=null,Te=0;Te<pe.length;Te++){var ve=pe[Te];ve!==null&&(ve.lane&=-536870913)}u&=~Ae}h!==0&&Su(s,h,0),w!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=w&~(j&~i))}function Su(s,i,u){s.pendingLanes|=i,s.suspendedLanes&=~i;var h=31-De(i);s.entangledLanes|=i,s.entanglements[h]=s.entanglements[h]|1073741824|u&4194090}function Eu(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var h=31-De(u),g=1<<h;g&i|s[h]&i&&(s[h]|=i),u&=~g}}function hc(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xc(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function _u(){var s=ie.p;return s!==0?s:(s=window.event,s===void 0?32:F2(s.type))}function ih(s,i){var u=ie.p;try{return ie.p=s,i()}finally{ie.p=u}}var Gn=Math.random().toString(36).slice(2),Ir="__reactFiber$"+Gn,Ur="__reactProps$"+Gn,Gs="__reactContainer$"+Gn,mc="__reactEvents$"+Gn,lh="__reactListeners$"+Gn,L="__reactHandles$"+Gn,K="__reactResources$"+Gn,H="__reactMarker$"+Gn;function G(s){delete s[Ir],delete s[Ur],delete s[mc],delete s[lh],delete s[L]}function Y(s){var i=s[Ir];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Gs]||u[Ir]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=v2(s);s!==null;){if(u=s[Ir])return u;s=v2(s)}return i}s=u,u=s.parentNode}return null}function Q(s){if(s=s[Ir]||s[Gs]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function he(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function Ee(s){var i=s[K];return i||(i=s[K]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ue(s){s[H]=!0}var me=new Set,ge={};function Fe(s,i){Pe(s,i),Pe(s+"Capture",i)}function Pe(s,i){for(ge[s]=i,s=0;s<i.length;s++)me.add(i[s])}var Ge=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},ze={};function it(s){return V.call(ze,s)?!0:V.call(Me,s)?!1:Ge.test(s)?ze[s]=!0:(Me[s]=!0,!1)}function It(s,i,u){if(it(i))if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var h=i.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+u)}}function Ut(s,i,u){if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+u)}}function Qt(s,i,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(i,u,""+h)}}var cs,Vs;function Qa(s){if(cs===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);cs=i&&i[1]||"",Vs=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+cs+s+Vs}var Sn=!1;function Vi(s,i){if(!s||Sn)return"";Sn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(i){var Ae=function(){throw Error()};if(Object.defineProperty(Ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ae,[])}catch(ve){var pe=ve}Reflect.construct(s,[],Ae)}else{try{Ae.call()}catch(ve){pe=ve}s.call(Ae.prototype)}}else{try{throw Error()}catch(ve){pe=ve}(Ae=s())&&typeof Ae.catch=="function"&&Ae.catch(function(){})}}catch(ve){if(ve&&pe&&typeof ve.stack=="string")return[ve.stack,pe.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),j=w[0],P=w[1];if(j&&P){var J=j.split(`
`),de=P.split(`
`);for(g=h=0;h<J.length&&!J[h].includes("DetermineComponentFrameRoot");)h++;for(;g<de.length&&!de[g].includes("DetermineComponentFrameRoot");)g++;if(h===J.length||g===de.length)for(h=J.length-1,g=de.length-1;1<=h&&0<=g&&J[h]!==de[g];)g--;for(;1<=h&&0<=g;h--,g--)if(J[h]!==de[g]){if(h!==1||g!==1)do if(h--,g--,0>g||J[h]!==de[g]){var Te=`
`+J[h].replace(" at new "," at ");return s.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",s.displayName)),Te}while(1<=h&&0<=g);break}}}finally{Sn=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?Qa(u):""}function En(s){switch(s.tag){case 26:case 27:case 5:return Qa(s.type);case 16:return Qa("Lazy");case 13:return Qa("Suspense");case 19:return Qa("SuspenseList");case 0:case 15:return Vi(s.type,!1);case 11:return Vi(s.type.render,!1);case 1:return Vi(s.type,!0);case 31:return Qa("Activity");default:return""}}function l1(s){try{var i="";do i+=En(s),s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function Za(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function o1(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ck(s){var i=o1(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),h=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,w=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return g.call(this)},set:function(j){h=""+j,w.call(this,j)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(j){h=""+j},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ku(s){s._valueTracker||(s._valueTracker=ck(s))}function c1(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),h="";return s&&(h=o1(s)?s.checked?"true":"false":s.value),s=h,s!==u?(i.setValue(s),!0):!1}function Tu(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var uk=/[\n"\\]/g;function Ja(s){return s.replace(uk,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function oh(s,i,u,h,g,w,j,P){s.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?s.type=j:s.removeAttribute("type"),i!=null?j==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+Za(i)):s.value!==""+Za(i)&&(s.value=""+Za(i)):j!=="submit"&&j!=="reset"||s.removeAttribute("value"),i!=null?ch(s,j,Za(i)):u!=null?ch(s,j,Za(u)):h!=null&&s.removeAttribute("value"),g==null&&w!=null&&(s.defaultChecked=!!w),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?s.name=""+Za(P):s.removeAttribute("name")}function u1(s,i,u,h,g,w,j,P){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),i!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||i!=null))return;u=u!=null?""+Za(u):"",i=i!=null?""+Za(i):u,P||i===s.value||(s.value=i),s.defaultValue=i}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=P?s.checked:!!h,s.defaultChecked=!!h,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(s.name=j)}function ch(s,i,u){i==="number"&&Tu(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function ql(s,i,u,h){if(s=s.options,i){i={};for(var g=0;g<u.length;g++)i["$"+u[g]]=!0;for(u=0;u<s.length;u++)g=i.hasOwnProperty("$"+s[u].value),s[u].selected!==g&&(s[u].selected=g),g&&h&&(s[u].defaultSelected=!0)}else{for(u=""+Za(u),i=null,g=0;g<s.length;g++){if(s[g].value===u){s[g].selected=!0,h&&(s[g].defaultSelected=!0);return}i!==null||s[g].disabled||(i=s[g])}i!==null&&(i.selected=!0)}}function f1(s,i,u){if(i!=null&&(i=""+Za(i),i!==s.value&&(s.value=i),u==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=u!=null?""+Za(u):""}function d1(s,i,u,h){if(i==null){if(h!=null){if(u!=null)throw Error(a(92));if(ce(h)){if(1<h.length)throw Error(a(93));h=h[0]}u=h}u==null&&(u=""),i=u}u=Za(i),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h)}function Wl(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var fk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function h1(s,i,u){var h=i.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":h?s.setProperty(i,u):typeof u!="number"||u===0||fk.has(i)?i==="float"?s.cssFloat=u:s[i]=(""+u).trim():s[i]=u+"px"}function x1(s,i,u){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||i!=null&&i.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var g in i)h=i[g],i.hasOwnProperty(g)&&u[g]!==h&&h1(s,g,h)}else for(var w in i)i.hasOwnProperty(w)&&h1(s,w,i[w])}function uh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nu(s){return hk.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var fh=null;function dh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xl=null,Yl=null;function m1(s){var i=Q(s);if(i&&(s=i.stateNode)){var u=s[Ur]||null;e:switch(s=i.stateNode,i.type){case"input":if(oh(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Ja(""+i)+'"][type="radio"]'),i=0;i<u.length;i++){var h=u[i];if(h!==s&&h.form===s.form){var g=h[Ur]||null;if(!g)throw Error(a(90));oh(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<u.length;i++)h=u[i],h.form===s.form&&c1(h)}break e;case"textarea":f1(s,u.value,u.defaultValue);break e;case"select":i=u.value,i!=null&&ql(s,!!u.multiple,i,!1)}}}var hh=!1;function p1(s,i,u){if(hh)return s(i,u);hh=!0;try{var h=s(i);return h}finally{if(hh=!1,(Xl!==null||Yl!==null)&&(hf(),Xl&&(i=Xl,s=Yl,Yl=Xl=null,m1(i),s)))for(i=0;i<s.length;i++)m1(s[i])}}function pc(s,i){var u=s.stateNode;if(u===null)return null;var h=u[Ur]||null;if(h===null)return null;u=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(a(231,i,typeof u));return u}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xh=!1;if(us)try{var gc={};Object.defineProperty(gc,"passive",{get:function(){xh=!0}}),window.addEventListener("test",gc,gc),window.removeEventListener("test",gc,gc)}catch{xh=!1}var qs=null,mh=null,Cu=null;function g1(){if(Cu)return Cu;var s,i=mh,u=i.length,h,g="value"in qs?qs.value:qs.textContent,w=g.length;for(s=0;s<u&&i[s]===g[s];s++);var j=u-s;for(h=1;h<=j&&i[u-h]===g[w-h];h++);return Cu=g.slice(s,1<h?1-h:void 0)}function Au(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ju(){return!0}function v1(){return!1}function ka(s){function i(u,h,g,w,j){this._reactName=u,this._targetInst=g,this.type=h,this.nativeEvent=w,this.target=j,this.currentTarget=null;for(var P in s)s.hasOwnProperty(P)&&(u=s[P],this[P]=u?u(w):w[P]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?ju:v1,this.isPropagationStopped=v1,this}return m(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ju)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ju)},persist:function(){},isPersistent:ju}),i}var qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ru=ka(qi),vc=m({},qi,{view:0,detail:0}),xk=ka(vc),ph,gh,yc,Du=m({},vc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yc&&(yc&&s.type==="mousemove"?(ph=s.screenX-yc.screenX,gh=s.screenY-yc.screenY):gh=ph=0,yc=s),ph)},movementY:function(s){return"movementY"in s?s.movementY:gh}}),y1=ka(Du),mk=m({},Du,{dataTransfer:0}),pk=ka(mk),gk=m({},vc,{relatedTarget:0}),vh=ka(gk),vk=m({},qi,{animationName:0,elapsedTime:0,pseudoElement:0}),yk=ka(vk),bk=m({},qi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),wk=ka(bk),Sk=m({},qi,{data:0}),b1=ka(Sk),Ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_k={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tk(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=kk[s])?!!i[s]:!1}function yh(){return Tk}var Nk=m({},vc,{key:function(s){if(s.key){var i=Ek[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Au(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?_k[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yh,charCode:function(s){return s.type==="keypress"?Au(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Au(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ck=ka(Nk),Ak=m({},Du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),w1=ka(Ak),jk=m({},vc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yh}),Rk=ka(jk),Dk=m({},qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fk=ka(Dk),Ok=m({},Du,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Mk=ka(Ok),Lk=m({},qi,{newState:0,oldState:0}),Bk=ka(Lk),Pk=[9,13,27,32],bh=us&&"CompositionEvent"in window,bc=null;us&&"documentMode"in document&&(bc=document.documentMode);var Ik=us&&"TextEvent"in window&&!bc,S1=us&&(!bh||bc&&8<bc&&11>=bc),E1=" ",_1=!1;function k1(s,i){switch(s){case"keyup":return Pk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T1(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var $l=!1;function Uk(s,i){switch(s){case"compositionend":return T1(i);case"keypress":return i.which!==32?null:(_1=!0,E1);case"textInput":return s=i.data,s===E1&&_1?null:s;default:return null}}function zk(s,i){if($l)return s==="compositionend"||!bh&&k1(s,i)?(s=g1(),Cu=mh=qs=null,$l=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return S1&&i.locale!=="ko"?null:i.data;default:return null}}var Hk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function N1(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Hk[s.type]:i==="textarea"}function C1(s,i,u,h){Xl?Yl?Yl.push(h):Yl=[h]:Xl=h,i=yf(i,"onChange"),0<i.length&&(u=new Ru("onChange","change",null,u,h),s.push({event:u,listeners:i}))}var wc=null,Sc=null;function Gk(s){o2(s,0)}function Fu(s){var i=he(s);if(c1(i))return s}function A1(s,i){if(s==="change")return i}var j1=!1;if(us){var wh;if(us){var Sh="oninput"in document;if(!Sh){var R1=document.createElement("div");R1.setAttribute("oninput","return;"),Sh=typeof R1.oninput=="function"}wh=Sh}else wh=!1;j1=wh&&(!document.documentMode||9<document.documentMode)}function D1(){wc&&(wc.detachEvent("onpropertychange",F1),Sc=wc=null)}function F1(s){if(s.propertyName==="value"&&Fu(Sc)){var i=[];C1(i,Sc,s,dh(s)),p1(Gk,i)}}function Vk(s,i,u){s==="focusin"?(D1(),wc=i,Sc=u,wc.attachEvent("onpropertychange",F1)):s==="focusout"&&D1()}function qk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Fu(Sc)}function Wk(s,i){if(s==="click")return Fu(i)}function Xk(s,i){if(s==="input"||s==="change")return Fu(i)}function Yk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ba=typeof Object.is=="function"?Object.is:Yk;function Ec(s,i){if(Ba(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),h=Object.keys(i);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var g=u[h];if(!V.call(i,g)||!Ba(s[g],i[g]))return!1}return!0}function O1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function M1(s,i){var u=O1(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=i&&h>=i)return{node:u,offset:i-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=O1(u)}}function L1(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?L1(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function B1(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Tu(s.document);i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Tu(s.document)}return i}function Eh(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var $k=us&&"documentMode"in document&&11>=document.documentMode,Kl=null,_h=null,_c=null,kh=!1;function P1(s,i,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;kh||Kl==null||Kl!==Tu(h)||(h=Kl,"selectionStart"in h&&Eh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),_c&&Ec(_c,h)||(_c=h,h=yf(_h,"onSelect"),0<h.length&&(i=new Ru("onSelect","select",null,i,u),s.push({event:i,listeners:h}),i.target=Kl)))}function Wi(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var Ql={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionrun:Wi("Transition","TransitionRun"),transitionstart:Wi("Transition","TransitionStart"),transitioncancel:Wi("Transition","TransitionCancel"),transitionend:Wi("Transition","TransitionEnd")},Th={},I1={};us&&(I1=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function Xi(s){if(Th[s])return Th[s];if(!Ql[s])return s;var i=Ql[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in I1)return Th[s]=i[u];return s}var U1=Xi("animationend"),z1=Xi("animationiteration"),H1=Xi("animationstart"),Kk=Xi("transitionrun"),Qk=Xi("transitionstart"),Zk=Xi("transitioncancel"),G1=Xi("transitionend"),V1=new Map,Nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nh.push("scrollEnd");function _n(s,i){V1.set(s,i),Fe(i,[s])}var q1=new WeakMap;function en(s,i){if(typeof s=="object"&&s!==null){var u=q1.get(s);return u!==void 0?u:(i={value:s,source:i,stack:l1(i)},q1.set(s,i),i)}return{value:s,source:i,stack:l1(i)}}var tn=[],Zl=0,Ch=0;function Ou(){for(var s=Zl,i=Ch=Zl=0;i<s;){var u=tn[i];tn[i++]=null;var h=tn[i];tn[i++]=null;var g=tn[i];tn[i++]=null;var w=tn[i];if(tn[i++]=null,h!==null&&g!==null){var j=h.pending;j===null?g.next=g:(g.next=j.next,j.next=g),h.pending=g}w!==0&&W1(u,g,w)}}function Mu(s,i,u,h){tn[Zl++]=s,tn[Zl++]=i,tn[Zl++]=u,tn[Zl++]=h,Ch|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Ah(s,i,u,h){return Mu(s,i,u,h),Lu(s)}function Jl(s,i){return Mu(s,null,null,i),Lu(s)}function W1(s,i,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var g=!1,w=s.return;w!==null;)w.childLanes|=u,h=w.alternate,h!==null&&(h.childLanes|=u),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(g=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,g&&i!==null&&(g=31-De(u),s=w.hiddenUpdates,h=s[g],h===null?s[g]=[i]:h.push(i),i.lane=u|536870912),w):null}function Lu(s){if(50<$c)throw $c=0,Mx=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var eo={};function Jk(s,i,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pa(s,i,u,h){return new Jk(s,i,u,h)}function jh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function fs(s,i){var u=s.alternate;return u===null?(u=Pa(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function X1(s,i){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,i=u.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Bu(s,i,u,h,g,w){var j=0;if(h=s,typeof s=="function")jh(s)&&(j=1);else if(typeof s=="string")j=tT(s,u,M.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case F:return s=Pa(31,u,i,g),s.elementType=F,s.lanes=w,s;case b:return Yi(u.children,g,w,i);case S:j=8,g|=24;break;case E:return s=Pa(12,u,i,g|2),s.elementType=E,s.lanes=w,s;case A:return s=Pa(13,u,i,g),s.elementType=A,s.lanes=w,s;case D:return s=Pa(19,u,i,g),s.elementType=D,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:case k:j=10;break e;case N:j=9;break e;case R:j=11;break e;case T:j=14;break e;case O:j=16,h=null;break e}j=29,u=Error(a(130,s===null?"null":typeof s,"")),h=null}return i=Pa(j,u,i,g),i.elementType=s,i.type=h,i.lanes=w,i}function Yi(s,i,u,h){return s=Pa(7,s,h,i),s.lanes=u,s}function Rh(s,i,u){return s=Pa(6,s,null,i),s.lanes=u,s}function Dh(s,i,u){return i=Pa(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var to=[],ro=0,Pu=null,Iu=0,rn=[],an=0,$i=null,ds=1,hs="";function Ki(s,i){to[ro++]=Iu,to[ro++]=Pu,Pu=s,Iu=i}function Y1(s,i,u){rn[an++]=ds,rn[an++]=hs,rn[an++]=$i,$i=s;var h=ds;s=hs;var g=32-De(h)-1;h&=~(1<<g),u+=1;var w=32-De(i)+g;if(30<w){var j=g-g%5;w=(h&(1<<j)-1).toString(32),h>>=j,g-=j,ds=1<<32-De(i)+g|u<<g|h,hs=w+s}else ds=1<<w|u<<g|h,hs=s}function Fh(s){s.return!==null&&(Ki(s,1),Y1(s,1,0))}function Oh(s){for(;s===Pu;)Pu=to[--ro],to[ro]=null,Iu=to[--ro],to[ro]=null;for(;s===$i;)$i=rn[--an],rn[an]=null,hs=rn[--an],rn[an]=null,ds=rn[--an],rn[an]=null}var xa=null,fr=null,Rt=!1,Qi=null,Vn=!1,Mh=Error(a(519));function Zi(s){var i=Error(a(418,""));throw Nc(en(i,s)),Mh}function $1(s){var i=s.stateNode,u=s.type,h=s.memoizedProps;switch(i[Ir]=s,i[Ur]=h,u){case"dialog":yt("cancel",i),yt("close",i);break;case"iframe":case"object":case"embed":yt("load",i);break;case"video":case"audio":for(u=0;u<Qc.length;u++)yt(Qc[u],i);break;case"source":yt("error",i);break;case"img":case"image":case"link":yt("error",i),yt("load",i);break;case"details":yt("toggle",i);break;case"input":yt("invalid",i),u1(i,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ku(i);break;case"select":yt("invalid",i);break;case"textarea":yt("invalid",i),d1(i,h.value,h.defaultValue,h.children),ku(i)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||i.textContent===""+u||h.suppressHydrationWarning===!0||d2(i.textContent,u)?(h.popover!=null&&(yt("beforetoggle",i),yt("toggle",i)),h.onScroll!=null&&yt("scroll",i),h.onScrollEnd!=null&&yt("scrollend",i),h.onClick!=null&&(i.onclick=bf),i=!0):i=!1,i||Zi(s)}function K1(s){for(xa=s.return;xa;)switch(xa.tag){case 5:case 13:Vn=!1;return;case 27:case 3:Vn=!0;return;default:xa=xa.return}}function kc(s){if(s!==xa)return!1;if(!Rt)return K1(s),Rt=!0,!1;var i=s.tag,u;if((u=i!==3&&i!==27)&&((u=i===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Qx(s.type,s.memoizedProps)),u=!u),u&&fr&&Zi(s),K1(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(i===0){fr=Tn(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++;s=s.nextSibling}fr=null}}else i===27?(i=fr,li(s.type)?(s=tm,tm=null,fr=s):fr=i):fr=xa?Tn(s.stateNode.nextSibling):null;return!0}function Tc(){fr=xa=null,Rt=!1}function Q1(){var s=Qi;return s!==null&&(Ca===null?Ca=s:Ca.push.apply(Ca,s),Qi=null),s}function Nc(s){Qi===null?Qi=[s]:Qi.push(s)}var Lh=te(null),Ji=null,xs=null;function Ws(s,i,u){I(Lh,i._currentValue),i._currentValue=u}function ms(s){s._currentValue=Lh.current,B(Lh)}function Bh(s,i,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),s===u)break;s=s.return}}function Ph(s,i,u,h){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var w=g.dependencies;if(w!==null){var j=g.child;w=w.firstContext;e:for(;w!==null;){var P=w;w=g;for(var J=0;J<i.length;J++)if(P.context===i[J]){w.lanes|=u,P=w.alternate,P!==null&&(P.lanes|=u),Bh(w.return,u,s),h||(j=null);break e}w=P.next}}else if(g.tag===18){if(j=g.return,j===null)throw Error(a(341));j.lanes|=u,w=j.alternate,w!==null&&(w.lanes|=u),Bh(j,u,s),j=null}else j=g.child;if(j!==null)j.return=g;else for(j=g;j!==null;){if(j===s){j=null;break}if(g=j.sibling,g!==null){g.return=j.return,j=g;break}j=j.return}g=j}}function Cc(s,i,u,h){s=null;for(var g=i,w=!1;g!==null;){if(!w){if((g.flags&524288)!==0)w=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var j=g.alternate;if(j===null)throw Error(a(387));if(j=j.memoizedProps,j!==null){var P=g.type;Ba(g.pendingProps.value,j.value)||(s!==null?s.push(P):s=[P])}}else if(g===ye.current){if(j=g.alternate,j===null)throw Error(a(387));j.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(a0):s=[a0])}g=g.return}s!==null&&Ph(i,s,u,h),i.flags|=262144}function Uu(s){for(s=s.firstContext;s!==null;){if(!Ba(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function el(s){Ji=s,xs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ta(s){return Z1(Ji,s)}function zu(s,i){return Ji===null&&el(s),Z1(s,i)}function Z1(s,i){var u=i._currentValue;if(i={context:i,memoizedValue:u,next:null},xs===null){if(s===null)throw Error(a(308));xs=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else xs=xs.next=i;return u}var e3=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){i.aborted=!0,s.forEach(function(u){return u()})}},t3=e.unstable_scheduleCallback,r3=e.unstable_NormalPriority,Fr={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ih(){return{controller:new e3,data:new Map,refCount:0}}function Ac(s){s.refCount--,s.refCount===0&&t3(r3,function(){s.controller.abort()})}var jc=null,Uh=0,ao=0,no=null;function a3(s,i){if(jc===null){var u=jc=[];Uh=0,ao=Hx(),no={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Uh++,i.then(J1,J1),i}function J1(){if(--Uh===0&&jc!==null){no!==null&&(no.status="fulfilled");var s=jc;jc=null,ao=0,no=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function n3(s,i){var u=[],h={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return s.then(function(){h.status="fulfilled",h.value=i;for(var g=0;g<u.length;g++)(0,u[g])(i)},function(g){for(h.status="rejected",h.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),h}var ev=Z.S;Z.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&a3(s,i),ev!==null&&ev(s,i)};var tl=te(null);function zh(){var s=tl.current;return s!==null?s:Zt.pooledCache}function Hu(s,i){i===null?I(tl,tl.current):I(tl,i.pool)}function tv(){var s=zh();return s===null?null:{parent:Fr._currentValue,pool:s}}var Rc=Error(a(460)),rv=Error(a(474)),Gu=Error(a(542)),Hh={then:function(){}};function av(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Vu(){}function nv(s,i,u){switch(u=s[u],u===void 0?s.push(i):u!==i&&(i.then(Vu,Vu),i=u),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,iv(s),s;default:if(typeof i.status=="string")i.then(Vu,Vu);else{if(s=Zt,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(h){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=h}},function(h){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=h}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,iv(s),s}throw Dc=i,Rc}}var Dc=null;function sv(){if(Dc===null)throw Error(a(459));var s=Dc;return Dc=null,s}function iv(s){if(s===Rc||s===Gu)throw Error(a(483))}var Xs=!1;function Gh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vh(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ys(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function $s(s,i,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Ft&2)!==0){var g=h.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),h.pending=i,i=Lu(s),W1(s,null,u),i}return Mu(s,h,i,u),Lu(s)}function Fc(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194048)!==0)){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,Eu(s,u)}}function qh(s,i){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var g=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var j={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?g=w=j:w=w.next=j,u=u.next}while(u!==null);w===null?g=w=i:w=w.next=i}else g=w=i;u={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}var Wh=!1;function Oc(){if(Wh){var s=no;if(s!==null)throw s}}function Mc(s,i,u,h){Wh=!1;var g=s.updateQueue;Xs=!1;var w=g.firstBaseUpdate,j=g.lastBaseUpdate,P=g.shared.pending;if(P!==null){g.shared.pending=null;var J=P,de=J.next;J.next=null,j===null?w=de:j.next=de,j=J;var Te=s.alternate;Te!==null&&(Te=Te.updateQueue,P=Te.lastBaseUpdate,P!==j&&(P===null?Te.firstBaseUpdate=de:P.next=de,Te.lastBaseUpdate=J))}if(w!==null){var Ae=g.baseState;j=0,Te=de=J=null,P=w;do{var pe=P.lane&-536870913,ve=pe!==P.lane;if(ve?(_t&pe)===pe:(h&pe)===pe){pe!==0&&pe===ao&&(Wh=!0),Te!==null&&(Te=Te.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var nt=s,et=P;pe=i;var Gt=u;switch(et.tag){case 1:if(nt=et.payload,typeof nt=="function"){Ae=nt.call(Gt,Ae,pe);break e}Ae=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=et.payload,pe=typeof nt=="function"?nt.call(Gt,Ae,pe):nt,pe==null)break e;Ae=m({},Ae,pe);break e;case 2:Xs=!0}}pe=P.callback,pe!==null&&(s.flags|=64,ve&&(s.flags|=8192),ve=g.callbacks,ve===null?g.callbacks=[pe]:ve.push(pe))}else ve={lane:pe,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Te===null?(de=Te=ve,J=Ae):Te=Te.next=ve,j|=pe;if(P=P.next,P===null){if(P=g.shared.pending,P===null)break;ve=P,P=ve.next,ve.next=null,g.lastBaseUpdate=ve,g.shared.pending=null}}while(!0);Te===null&&(J=Ae),g.baseState=J,g.firstBaseUpdate=de,g.lastBaseUpdate=Te,w===null&&(g.shared.lanes=0),ai|=j,s.lanes=j,s.memoizedState=Ae}}function lv(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function ov(s,i){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)lv(u[s],i)}var so=te(null),qu=te(0);function cv(s,i){s=Ss,I(qu,s),I(so,i),Ss=s|i.baseLanes}function Xh(){I(qu,Ss),I(so,so.current)}function Yh(){Ss=qu.current,B(so),B(qu)}var Ks=0,xt=null,zt=null,kr=null,Wu=!1,io=!1,rl=!1,Xu=0,Lc=0,lo=null,s3=0;function gr(){throw Error(a(321))}function $h(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Ba(s[u],i[u]))return!1;return!0}function Kh(s,i,u,h,g,w){return Ks=w,xt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Z.H=s===null||s.memoizedState===null?Wv:Xv,rl=!1,w=u(h,g),rl=!1,io&&(w=fv(i,u,h,g)),uv(s),w}function uv(s){Z.H=Ju;var i=zt!==null&&zt.next!==null;if(Ks=0,kr=zt=xt=null,Wu=!1,Lc=0,lo=null,i)throw Error(a(300));s===null||zr||(s=s.dependencies,s!==null&&Uu(s)&&(zr=!0))}function fv(s,i,u,h){xt=s;var g=0;do{if(io&&(lo=null),Lc=0,io=!1,25<=g)throw Error(a(301));if(g+=1,kr=zt=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}Z.H=d3,w=i(u,h)}while(io);return w}function i3(){var s=Z.H,i=s.useState()[0];return i=typeof i.then=="function"?Bc(i):i,s=s.useState()[0],(zt!==null?zt.memoizedState:null)!==s&&(xt.flags|=1024),i}function Qh(){var s=Xu!==0;return Xu=0,s}function Zh(s,i,u){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~u}function Jh(s){if(Wu){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Wu=!1}Ks=0,kr=zt=xt=null,io=!1,Lc=Xu=0,lo=null}function Ta(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?xt.memoizedState=kr=s:kr=kr.next=s,kr}function Tr(){if(zt===null){var s=xt.alternate;s=s!==null?s.memoizedState:null}else s=zt.next;var i=kr===null?xt.memoizedState:kr.next;if(i!==null)kr=i,zt=s;else{if(s===null)throw xt.alternate===null?Error(a(467)):Error(a(310));zt=s,s={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},kr===null?xt.memoizedState=kr=s:kr=kr.next=s}return kr}function ex(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bc(s){var i=Lc;return Lc+=1,lo===null&&(lo=[]),s=nv(lo,s,i),i=xt,(kr===null?i.memoizedState:kr.next)===null&&(i=i.alternate,Z.H=i===null||i.memoizedState===null?Wv:Xv),s}function Yu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Bc(s);if(s.$$typeof===k)return ta(s)}throw Error(a(438,String(s)))}function tx(s){var i=null,u=xt.updateQueue;if(u!==null&&(i=u.memoCache),i==null){var h=xt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(i={data:h.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),u===null&&(u=ex(),xt.updateQueue=u),u.memoCache=i,u=i.data[i.index],u===void 0)for(u=i.data[i.index]=Array(s),h=0;h<s;h++)u[h]=q;return i.index++,u}function ps(s,i){return typeof i=="function"?i(s):i}function $u(s){var i=Tr();return rx(i,zt,s)}function rx(s,i,u){var h=s.queue;if(h===null)throw Error(a(311));h.lastRenderedReducer=u;var g=s.baseQueue,w=h.pending;if(w!==null){if(g!==null){var j=g.next;g.next=w.next,w.next=j}i.baseQueue=g=w,h.pending=null}if(w=s.baseState,g===null)s.memoizedState=w;else{i=g.next;var P=j=null,J=null,de=i,Te=!1;do{var Ae=de.lane&-536870913;if(Ae!==de.lane?(_t&Ae)===Ae:(Ks&Ae)===Ae){var pe=de.revertLane;if(pe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ae===ao&&(Te=!0);else if((Ks&pe)===pe){de=de.next,pe===ao&&(Te=!0);continue}else Ae={lane:0,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},J===null?(P=J=Ae,j=w):J=J.next=Ae,xt.lanes|=pe,ai|=pe;Ae=de.action,rl&&u(w,Ae),w=de.hasEagerState?de.eagerState:u(w,Ae)}else pe={lane:Ae,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},J===null?(P=J=pe,j=w):J=J.next=pe,xt.lanes|=Ae,ai|=Ae;de=de.next}while(de!==null&&de!==i);if(J===null?j=w:J.next=P,!Ba(w,s.memoizedState)&&(zr=!0,Te&&(u=no,u!==null)))throw u;s.memoizedState=w,s.baseState=j,s.baseQueue=J,h.lastRenderedState=w}return g===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function ax(s){var i=Tr(),u=i.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=s;var h=u.dispatch,g=u.pending,w=i.memoizedState;if(g!==null){u.pending=null;var j=g=g.next;do w=s(w,j.action),j=j.next;while(j!==g);Ba(w,i.memoizedState)||(zr=!0),i.memoizedState=w,i.baseQueue===null&&(i.baseState=w),u.lastRenderedState=w}return[w,h]}function dv(s,i,u){var h=xt,g=Tr(),w=Rt;if(w){if(u===void 0)throw Error(a(407));u=u()}else u=i();var j=!Ba((zt||g).memoizedState,u);j&&(g.memoizedState=u,zr=!0),g=g.queue;var P=mv.bind(null,h,g,s);if(Pc(2048,8,P,[s]),g.getSnapshot!==i||j||kr!==null&&kr.memoizedState.tag&1){if(h.flags|=2048,oo(9,Ku(),xv.bind(null,h,g,u,i),null),Zt===null)throw Error(a(349));w||(Ks&124)!==0||hv(h,i,u)}return u}function hv(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=xt.updateQueue,i===null?(i=ex(),xt.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function xv(s,i,u,h){i.value=u,i.getSnapshot=h,pv(i)&&gv(s)}function mv(s,i,u){return u(function(){pv(i)&&gv(s)})}function pv(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Ba(s,u)}catch{return!0}}function gv(s){var i=Jl(s,2);i!==null&&Ga(i,s,2)}function nx(s){var i=Ta();if(typeof s=="function"){var u=s;if(s=u(),rl){Et(!0);try{u()}finally{Et(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:s},i}function vv(s,i,u,h){return s.baseState=u,rx(s,zt,typeof h=="function"?h:ps)}function l3(s,i,u,h,g){if(Zu(s))throw Error(a(485));if(s=i.action,s!==null){var w={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){w.listeners.push(j)}};Z.T!==null?u(!0):w.isTransition=!1,h(w),u=i.pending,u===null?(w.next=i.pending=w,yv(i,w)):(w.next=u.next,i.pending=u.next=w)}}function yv(s,i){var u=i.action,h=i.payload,g=s.state;if(i.isTransition){var w=Z.T,j={};Z.T=j;try{var P=u(g,h),J=Z.S;J!==null&&J(j,P),bv(s,i,P)}catch(de){sx(s,i,de)}finally{Z.T=w}}else try{w=u(g,h),bv(s,i,w)}catch(de){sx(s,i,de)}}function bv(s,i,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){wv(s,i,h)},function(h){return sx(s,i,h)}):wv(s,i,u)}function wv(s,i,u){i.status="fulfilled",i.value=u,Sv(i),s.state=u,i=s.pending,i!==null&&(u=i.next,u===i?s.pending=null:(u=u.next,i.next=u,yv(s,u)))}function sx(s,i,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do i.status="rejected",i.reason=u,Sv(i),i=i.next;while(i!==h)}s.action=null}function Sv(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Ev(s,i){return i}function _v(s,i){if(Rt){var u=Zt.formState;if(u!==null){e:{var h=xt;if(Rt){if(fr){t:{for(var g=fr,w=Vn;g.nodeType!==8;){if(!w){g=null;break t}if(g=Tn(g.nextSibling),g===null){g=null;break t}}w=g.data,g=w==="F!"||w==="F"?g:null}if(g){fr=Tn(g.nextSibling),h=g.data==="F!";break e}}Zi(h)}h=!1}h&&(i=u[0])}}return u=Ta(),u.memoizedState=u.baseState=i,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ev,lastRenderedState:i},u.queue=h,u=Gv.bind(null,xt,h),h.dispatch=u,h=nx(!1),w=ux.bind(null,xt,!1,h.queue),h=Ta(),g={state:i,dispatch:null,action:s,pending:null},h.queue=g,u=l3.bind(null,xt,g,w,u),g.dispatch=u,h.memoizedState=s,[i,u,!1]}function kv(s){var i=Tr();return Tv(i,zt,s)}function Tv(s,i,u){if(i=rx(s,i,Ev)[0],s=$u(ps)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var h=Bc(i)}catch(j){throw j===Rc?Gu:j}else h=i;i=Tr();var g=i.queue,w=g.dispatch;return u!==i.memoizedState&&(xt.flags|=2048,oo(9,Ku(),o3.bind(null,g,u),null)),[h,w,s]}function o3(s,i){s.action=i}function Nv(s){var i=Tr(),u=zt;if(u!==null)return Tv(i,u,s);Tr(),i=i.memoizedState,u=Tr();var h=u.queue.dispatch;return u.memoizedState=s,[i,h,!1]}function oo(s,i,u,h){return s={tag:s,create:u,deps:h,inst:i,next:null},i=xt.updateQueue,i===null&&(i=ex(),xt.updateQueue=i),u=i.lastEffect,u===null?i.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,i.lastEffect=s),s}function Ku(){return{destroy:void 0,resource:void 0}}function Cv(){return Tr().memoizedState}function Qu(s,i,u,h){var g=Ta();h=h===void 0?null:h,xt.flags|=s,g.memoizedState=oo(1|i,Ku(),u,h)}function Pc(s,i,u,h){var g=Tr();h=h===void 0?null:h;var w=g.memoizedState.inst;zt!==null&&h!==null&&$h(h,zt.memoizedState.deps)?g.memoizedState=oo(i,w,u,h):(xt.flags|=s,g.memoizedState=oo(1|i,w,u,h))}function Av(s,i){Qu(8390656,8,s,i)}function jv(s,i){Pc(2048,8,s,i)}function Rv(s,i){return Pc(4,2,s,i)}function Dv(s,i){return Pc(4,4,s,i)}function Fv(s,i){if(typeof i=="function"){s=s();var u=i(s);return function(){typeof u=="function"?u():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Ov(s,i,u){u=u!=null?u.concat([s]):null,Pc(4,4,Fv.bind(null,i,s),u)}function ix(){}function Mv(s,i){var u=Tr();i=i===void 0?null:i;var h=u.memoizedState;return i!==null&&$h(i,h[1])?h[0]:(u.memoizedState=[s,i],s)}function Lv(s,i){var u=Tr();i=i===void 0?null:i;var h=u.memoizedState;if(i!==null&&$h(i,h[1]))return h[0];if(h=s(),rl){Et(!0);try{s()}finally{Et(!1)}}return u.memoizedState=[h,i],h}function lx(s,i,u){return u===void 0||(Ks&1073741824)!==0?s.memoizedState=i:(s.memoizedState=u,s=Iy(),xt.lanes|=s,ai|=s,u)}function Bv(s,i,u,h){return Ba(u,i)?u:so.current!==null?(s=lx(s,u,h),Ba(s,i)||(zr=!0),s):(Ks&42)===0?(zr=!0,s.memoizedState=u):(s=Iy(),xt.lanes|=s,ai|=s,i)}function Pv(s,i,u,h,g){var w=ie.p;ie.p=w!==0&&8>w?w:8;var j=Z.T,P={};Z.T=P,ux(s,!1,i,u);try{var J=g(),de=Z.S;if(de!==null&&de(P,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var Te=n3(J,h);Ic(s,i,Te,Ha(s))}else Ic(s,i,h,Ha(s))}catch(Ae){Ic(s,i,{then:function(){},status:"rejected",reason:Ae},Ha())}finally{ie.p=w,Z.T=j}}function c3(){}function ox(s,i,u,h){if(s.tag!==5)throw Error(a(476));var g=Iv(s).queue;Pv(s,g,i,ke,u===null?c3:function(){return Uv(s),u(h)})}function Iv(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:ke,baseState:ke,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:ke},next:null};var u={};return i.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:u},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Uv(s){var i=Iv(s).next.queue;Ic(s,i,{},Ha())}function cx(){return ta(a0)}function zv(){return Tr().memoizedState}function Hv(){return Tr().memoizedState}function u3(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var u=Ha();s=Ys(u);var h=$s(i,s,u);h!==null&&(Ga(h,i,u),Fc(h,i,u)),i={cache:Ih()},s.payload=i;return}i=i.return}}function f3(s,i,u){var h=Ha();u={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Zu(s)?Vv(i,u):(u=Ah(s,i,u,h),u!==null&&(Ga(u,s,h),qv(u,i,h)))}function Gv(s,i,u){var h=Ha();Ic(s,i,u,h)}function Ic(s,i,u,h){var g={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Zu(s))Vv(i,g);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=i.lastRenderedReducer,w!==null))try{var j=i.lastRenderedState,P=w(j,u);if(g.hasEagerState=!0,g.eagerState=P,Ba(P,j))return Mu(s,i,g,0),Zt===null&&Ou(),!1}catch{}finally{}if(u=Ah(s,i,g,h),u!==null)return Ga(u,s,h),qv(u,i,h),!0}return!1}function ux(s,i,u,h){if(h={lane:2,revertLane:Hx(),action:h,hasEagerState:!1,eagerState:null,next:null},Zu(s)){if(i)throw Error(a(479))}else i=Ah(s,u,h,2),i!==null&&Ga(i,s,2)}function Zu(s){var i=s.alternate;return s===xt||i!==null&&i===xt}function Vv(s,i){io=Wu=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function qv(s,i,u){if((u&4194048)!==0){var h=i.lanes;h&=s.pendingLanes,u|=h,i.lanes=u,Eu(s,u)}}var Ju={readContext:ta,use:Yu,useCallback:gr,useContext:gr,useEffect:gr,useImperativeHandle:gr,useLayoutEffect:gr,useInsertionEffect:gr,useMemo:gr,useReducer:gr,useRef:gr,useState:gr,useDebugValue:gr,useDeferredValue:gr,useTransition:gr,useSyncExternalStore:gr,useId:gr,useHostTransitionStatus:gr,useFormState:gr,useActionState:gr,useOptimistic:gr,useMemoCache:gr,useCacheRefresh:gr},Wv={readContext:ta,use:Yu,useCallback:function(s,i){return Ta().memoizedState=[s,i===void 0?null:i],s},useContext:ta,useEffect:Av,useImperativeHandle:function(s,i,u){u=u!=null?u.concat([s]):null,Qu(4194308,4,Fv.bind(null,i,s),u)},useLayoutEffect:function(s,i){return Qu(4194308,4,s,i)},useInsertionEffect:function(s,i){Qu(4,2,s,i)},useMemo:function(s,i){var u=Ta();i=i===void 0?null:i;var h=s();if(rl){Et(!0);try{s()}finally{Et(!1)}}return u.memoizedState=[h,i],h},useReducer:function(s,i,u){var h=Ta();if(u!==void 0){var g=u(i);if(rl){Et(!0);try{u(i)}finally{Et(!1)}}}else g=i;return h.memoizedState=h.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},h.queue=s,s=s.dispatch=f3.bind(null,xt,s),[h.memoizedState,s]},useRef:function(s){var i=Ta();return s={current:s},i.memoizedState=s},useState:function(s){s=nx(s);var i=s.queue,u=Gv.bind(null,xt,i);return i.dispatch=u,[s.memoizedState,u]},useDebugValue:ix,useDeferredValue:function(s,i){var u=Ta();return lx(u,s,i)},useTransition:function(){var s=nx(!1);return s=Pv.bind(null,xt,s.queue,!0,!1),Ta().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,u){var h=xt,g=Ta();if(Rt){if(u===void 0)throw Error(a(407));u=u()}else{if(u=i(),Zt===null)throw Error(a(349));(_t&124)!==0||hv(h,i,u)}g.memoizedState=u;var w={value:u,getSnapshot:i};return g.queue=w,Av(mv.bind(null,h,w,s),[s]),h.flags|=2048,oo(9,Ku(),xv.bind(null,h,w,u,i),null),u},useId:function(){var s=Ta(),i=Zt.identifierPrefix;if(Rt){var u=hs,h=ds;u=(h&~(1<<32-De(h)-1)).toString(32)+u,i=""+i+"R"+u,u=Xu++,0<u&&(i+="H"+u.toString(32)),i+=""}else u=s3++,i=""+i+"r"+u.toString(32)+"";return s.memoizedState=i},useHostTransitionStatus:cx,useFormState:_v,useActionState:_v,useOptimistic:function(s){var i=Ta();i.memoizedState=i.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=u,i=ux.bind(null,xt,!0,u),u.dispatch=i,[s,i]},useMemoCache:tx,useCacheRefresh:function(){return Ta().memoizedState=u3.bind(null,xt)}},Xv={readContext:ta,use:Yu,useCallback:Mv,useContext:ta,useEffect:jv,useImperativeHandle:Ov,useInsertionEffect:Rv,useLayoutEffect:Dv,useMemo:Lv,useReducer:$u,useRef:Cv,useState:function(){return $u(ps)},useDebugValue:ix,useDeferredValue:function(s,i){var u=Tr();return Bv(u,zt.memoizedState,s,i)},useTransition:function(){var s=$u(ps)[0],i=Tr().memoizedState;return[typeof s=="boolean"?s:Bc(s),i]},useSyncExternalStore:dv,useId:zv,useHostTransitionStatus:cx,useFormState:kv,useActionState:kv,useOptimistic:function(s,i){var u=Tr();return vv(u,zt,s,i)},useMemoCache:tx,useCacheRefresh:Hv},d3={readContext:ta,use:Yu,useCallback:Mv,useContext:ta,useEffect:jv,useImperativeHandle:Ov,useInsertionEffect:Rv,useLayoutEffect:Dv,useMemo:Lv,useReducer:ax,useRef:Cv,useState:function(){return ax(ps)},useDebugValue:ix,useDeferredValue:function(s,i){var u=Tr();return zt===null?lx(u,s,i):Bv(u,zt.memoizedState,s,i)},useTransition:function(){var s=ax(ps)[0],i=Tr().memoizedState;return[typeof s=="boolean"?s:Bc(s),i]},useSyncExternalStore:dv,useId:zv,useHostTransitionStatus:cx,useFormState:Nv,useActionState:Nv,useOptimistic:function(s,i){var u=Tr();return zt!==null?vv(u,zt,s,i):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:tx,useCacheRefresh:Hv},co=null,Uc=0;function ef(s){var i=Uc;return Uc+=1,co===null&&(co=[]),nv(co,s,i)}function zc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function tf(s,i){throw i.$$typeof===p?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Yv(s){var i=s._init;return i(s._payload)}function $v(s){function i(le,se){if(s){var fe=le.deletions;fe===null?(le.deletions=[se],le.flags|=16):fe.push(se)}}function u(le,se){if(!s)return null;for(;se!==null;)i(le,se),se=se.sibling;return null}function h(le){for(var se=new Map;le!==null;)le.key!==null?se.set(le.key,le):se.set(le.index,le),le=le.sibling;return se}function g(le,se){return le=fs(le,se),le.index=0,le.sibling=null,le}function w(le,se,fe){return le.index=fe,s?(fe=le.alternate,fe!==null?(fe=fe.index,fe<se?(le.flags|=67108866,se):fe):(le.flags|=67108866,se)):(le.flags|=1048576,se)}function j(le){return s&&le.alternate===null&&(le.flags|=67108866),le}function P(le,se,fe,Ce){return se===null||se.tag!==6?(se=Rh(fe,le.mode,Ce),se.return=le,se):(se=g(se,fe),se.return=le,se)}function J(le,se,fe,Ce){var qe=fe.type;return qe===b?Te(le,se,fe.props.children,Ce,fe.key):se!==null&&(se.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===O&&Yv(qe)===se.type)?(se=g(se,fe.props),zc(se,fe),se.return=le,se):(se=Bu(fe.type,fe.key,fe.props,null,le.mode,Ce),zc(se,fe),se.return=le,se)}function de(le,se,fe,Ce){return se===null||se.tag!==4||se.stateNode.containerInfo!==fe.containerInfo||se.stateNode.implementation!==fe.implementation?(se=Dh(fe,le.mode,Ce),se.return=le,se):(se=g(se,fe.children||[]),se.return=le,se)}function Te(le,se,fe,Ce,qe){return se===null||se.tag!==7?(se=Yi(fe,le.mode,Ce,qe),se.return=le,se):(se=g(se,fe),se.return=le,se)}function Ae(le,se,fe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Rh(""+se,le.mode,fe),se.return=le,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case v:return fe=Bu(se.type,se.key,se.props,null,le.mode,fe),zc(fe,se),fe.return=le,fe;case y:return se=Dh(se,le.mode,fe),se.return=le,se;case O:var Ce=se._init;return se=Ce(se._payload),Ae(le,se,fe)}if(ce(se)||U(se))return se=Yi(se,le.mode,fe,null),se.return=le,se;if(typeof se.then=="function")return Ae(le,ef(se),fe);if(se.$$typeof===k)return Ae(le,zu(le,se),fe);tf(le,se)}return null}function pe(le,se,fe,Ce){var qe=se!==null?se.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return qe!==null?null:P(le,se,""+fe,Ce);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case v:return fe.key===qe?J(le,se,fe,Ce):null;case y:return fe.key===qe?de(le,se,fe,Ce):null;case O:return qe=fe._init,fe=qe(fe._payload),pe(le,se,fe,Ce)}if(ce(fe)||U(fe))return qe!==null?null:Te(le,se,fe,Ce,null);if(typeof fe.then=="function")return pe(le,se,ef(fe),Ce);if(fe.$$typeof===k)return pe(le,se,zu(le,fe),Ce);tf(le,fe)}return null}function ve(le,se,fe,Ce,qe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return le=le.get(fe)||null,P(se,le,""+Ce,qe);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case v:return le=le.get(Ce.key===null?fe:Ce.key)||null,J(se,le,Ce,qe);case y:return le=le.get(Ce.key===null?fe:Ce.key)||null,de(se,le,Ce,qe);case O:var pt=Ce._init;return Ce=pt(Ce._payload),ve(le,se,fe,Ce,qe)}if(ce(Ce)||U(Ce))return le=le.get(fe)||null,Te(se,le,Ce,qe,null);if(typeof Ce.then=="function")return ve(le,se,fe,ef(Ce),qe);if(Ce.$$typeof===k)return ve(le,se,fe,zu(se,Ce),qe);tf(se,Ce)}return null}function nt(le,se,fe,Ce){for(var qe=null,pt=null,Ye=se,tt=se=0,Gr=null;Ye!==null&&tt<fe.length;tt++){Ye.index>tt?(Gr=Ye,Ye=null):Gr=Ye.sibling;var At=pe(le,Ye,fe[tt],Ce);if(At===null){Ye===null&&(Ye=Gr);break}s&&Ye&&At.alternate===null&&i(le,Ye),se=w(At,se,tt),pt===null?qe=At:pt.sibling=At,pt=At,Ye=Gr}if(tt===fe.length)return u(le,Ye),Rt&&Ki(le,tt),qe;if(Ye===null){for(;tt<fe.length;tt++)Ye=Ae(le,fe[tt],Ce),Ye!==null&&(se=w(Ye,se,tt),pt===null?qe=Ye:pt.sibling=Ye,pt=Ye);return Rt&&Ki(le,tt),qe}for(Ye=h(Ye);tt<fe.length;tt++)Gr=ve(Ye,le,tt,fe[tt],Ce),Gr!==null&&(s&&Gr.alternate!==null&&Ye.delete(Gr.key===null?tt:Gr.key),se=w(Gr,se,tt),pt===null?qe=Gr:pt.sibling=Gr,pt=Gr);return s&&Ye.forEach(function(di){return i(le,di)}),Rt&&Ki(le,tt),qe}function et(le,se,fe,Ce){if(fe==null)throw Error(a(151));for(var qe=null,pt=null,Ye=se,tt=se=0,Gr=null,At=fe.next();Ye!==null&&!At.done;tt++,At=fe.next()){Ye.index>tt?(Gr=Ye,Ye=null):Gr=Ye.sibling;var di=pe(le,Ye,At.value,Ce);if(di===null){Ye===null&&(Ye=Gr);break}s&&Ye&&di.alternate===null&&i(le,Ye),se=w(di,se,tt),pt===null?qe=di:pt.sibling=di,pt=di,Ye=Gr}if(At.done)return u(le,Ye),Rt&&Ki(le,tt),qe;if(Ye===null){for(;!At.done;tt++,At=fe.next())At=Ae(le,At.value,Ce),At!==null&&(se=w(At,se,tt),pt===null?qe=At:pt.sibling=At,pt=At);return Rt&&Ki(le,tt),qe}for(Ye=h(Ye);!At.done;tt++,At=fe.next())At=ve(Ye,le,tt,At.value,Ce),At!==null&&(s&&At.alternate!==null&&Ye.delete(At.key===null?tt:At.key),se=w(At,se,tt),pt===null?qe=At:pt.sibling=At,pt=At);return s&&Ye.forEach(function(hT){return i(le,hT)}),Rt&&Ki(le,tt),qe}function Gt(le,se,fe,Ce){if(typeof fe=="object"&&fe!==null&&fe.type===b&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case v:e:{for(var qe=fe.key;se!==null;){if(se.key===qe){if(qe=fe.type,qe===b){if(se.tag===7){u(le,se.sibling),Ce=g(se,fe.props.children),Ce.return=le,le=Ce;break e}}else if(se.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===O&&Yv(qe)===se.type){u(le,se.sibling),Ce=g(se,fe.props),zc(Ce,fe),Ce.return=le,le=Ce;break e}u(le,se);break}else i(le,se);se=se.sibling}fe.type===b?(Ce=Yi(fe.props.children,le.mode,Ce,fe.key),Ce.return=le,le=Ce):(Ce=Bu(fe.type,fe.key,fe.props,null,le.mode,Ce),zc(Ce,fe),Ce.return=le,le=Ce)}return j(le);case y:e:{for(qe=fe.key;se!==null;){if(se.key===qe)if(se.tag===4&&se.stateNode.containerInfo===fe.containerInfo&&se.stateNode.implementation===fe.implementation){u(le,se.sibling),Ce=g(se,fe.children||[]),Ce.return=le,le=Ce;break e}else{u(le,se);break}else i(le,se);se=se.sibling}Ce=Dh(fe,le.mode,Ce),Ce.return=le,le=Ce}return j(le);case O:return qe=fe._init,fe=qe(fe._payload),Gt(le,se,fe,Ce)}if(ce(fe))return nt(le,se,fe,Ce);if(U(fe)){if(qe=U(fe),typeof qe!="function")throw Error(a(150));return fe=qe.call(fe),et(le,se,fe,Ce)}if(typeof fe.then=="function")return Gt(le,se,ef(fe),Ce);if(fe.$$typeof===k)return Gt(le,se,zu(le,fe),Ce);tf(le,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,se!==null&&se.tag===6?(u(le,se.sibling),Ce=g(se,fe),Ce.return=le,le=Ce):(u(le,se),Ce=Rh(fe,le.mode,Ce),Ce.return=le,le=Ce),j(le)):u(le,se)}return function(le,se,fe,Ce){try{Uc=0;var qe=Gt(le,se,fe,Ce);return co=null,qe}catch(Ye){if(Ye===Rc||Ye===Gu)throw Ye;var pt=Pa(29,Ye,null,le.mode);return pt.lanes=Ce,pt.return=le,pt}finally{}}}var uo=$v(!0),Kv=$v(!1),nn=te(null),qn=null;function Qs(s){var i=s.alternate;I(Or,Or.current&1),I(nn,s),qn===null&&(i===null||so.current!==null||i.memoizedState!==null)&&(qn=s)}function Qv(s){if(s.tag===22){if(I(Or,Or.current),I(nn,s),qn===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(qn=s)}}else Zs()}function Zs(){I(Or,Or.current),I(nn,nn.current)}function gs(s){B(nn),qn===s&&(qn=null),B(Or)}var Or=te(0);function rf(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||em(u)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function fx(s,i,u,h){i=s.memoizedState,u=u(h,i),u=u==null?i:m({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var dx={enqueueSetState:function(s,i,u){s=s._reactInternals;var h=Ha(),g=Ys(h);g.payload=i,u!=null&&(g.callback=u),i=$s(s,g,h),i!==null&&(Ga(i,s,h),Fc(i,s,h))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var h=Ha(),g=Ys(h);g.tag=1,g.payload=i,u!=null&&(g.callback=u),i=$s(s,g,h),i!==null&&(Ga(i,s,h),Fc(i,s,h))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=Ha(),h=Ys(u);h.tag=2,i!=null&&(h.callback=i),i=$s(s,h,u),i!==null&&(Ga(i,s,u),Fc(i,s,u))}};function Zv(s,i,u,h,g,w,j){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,w,j):i.prototype&&i.prototype.isPureReactComponent?!Ec(u,h)||!Ec(g,w):!0}function Jv(s,i,u,h){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,h),i.state!==s&&dx.enqueueReplaceState(i,i.state,null)}function al(s,i){var u=i;if("ref"in i){u={};for(var h in i)h!=="ref"&&(u[h]=i[h])}if(s=s.defaultProps){u===i&&(u=m({},u));for(var g in s)u[g]===void 0&&(u[g]=s[g])}return u}var af=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function ey(s){af(s)}function ty(s){console.error(s)}function ry(s){af(s)}function nf(s,i){try{var u=s.onUncaughtError;u(i.value,{componentStack:i.stack})}catch(h){setTimeout(function(){throw h})}}function ay(s,i,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function hx(s,i,u){return u=Ys(u),u.tag=3,u.payload={element:null},u.callback=function(){nf(s,i)},u}function ny(s){return s=Ys(s),s.tag=3,s}function sy(s,i,u,h){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var w=h.value;s.payload=function(){return g(w)},s.callback=function(){ay(i,u,h)}}var j=u.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(s.callback=function(){ay(i,u,h),typeof g!="function"&&(ni===null?ni=new Set([this]):ni.add(this));var P=h.stack;this.componentDidCatch(h.value,{componentStack:P!==null?P:""})})}function h3(s,i,u,h,g){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(i=u.alternate,i!==null&&Cc(i,u,g,!0),u=nn.current,u!==null){switch(u.tag){case 13:return qn===null?Bx():u.alternate===null&&dr===0&&(dr=3),u.flags&=-257,u.flags|=65536,u.lanes=g,h===Hh?u.flags|=16384:(i=u.updateQueue,i===null?u.updateQueue=new Set([h]):i.add(h),Ix(s,h,g)),!1;case 22:return u.flags|=65536,h===Hh?u.flags|=16384:(i=u.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=i):(u=i.retryQueue,u===null?i.retryQueue=new Set([h]):u.add(h)),Ix(s,h,g)),!1}throw Error(a(435,u.tag))}return Ix(s,h,g),Bx(),!1}if(Rt)return i=nn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,h!==Mh&&(s=Error(a(422),{cause:h}),Nc(en(s,u)))):(h!==Mh&&(i=Error(a(423),{cause:h}),Nc(en(i,u))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,h=en(h,u),g=hx(s.stateNode,h,g),qh(s,g),dr!==4&&(dr=2)),!1;var w=Error(a(520),{cause:h});if(w=en(w,u),Yc===null?Yc=[w]:Yc.push(w),dr!==4&&(dr=2),i===null)return!0;h=en(h,u),u=i;do{switch(u.tag){case 3:return u.flags|=65536,s=g&-g,u.lanes|=s,s=hx(u.stateNode,h,s),qh(u,s),!1;case 1:if(i=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ni===null||!ni.has(w))))return u.flags|=65536,g&=-g,u.lanes|=g,g=ny(g),sy(g,s,u,h),qh(u,g),!1}u=u.return}while(u!==null);return!1}var iy=Error(a(461)),zr=!1;function $r(s,i,u,h){i.child=s===null?Kv(i,null,u,h):uo(i,s.child,u,h)}function ly(s,i,u,h,g){u=u.render;var w=i.ref;if("ref"in h){var j={};for(var P in h)P!=="ref"&&(j[P]=h[P])}else j=h;return el(i),h=Kh(s,i,u,j,w,g),P=Qh(),s!==null&&!zr?(Zh(s,i,g),vs(s,i,g)):(Rt&&P&&Fh(i),i.flags|=1,$r(s,i,h,g),i.child)}function oy(s,i,u,h,g){if(s===null){var w=u.type;return typeof w=="function"&&!jh(w)&&w.defaultProps===void 0&&u.compare===null?(i.tag=15,i.type=w,cy(s,i,w,h,g)):(s=Bu(u.type,null,h,i,i.mode,g),s.ref=i.ref,s.return=i,i.child=s)}if(w=s.child,!wx(s,g)){var j=w.memoizedProps;if(u=u.compare,u=u!==null?u:Ec,u(j,h)&&s.ref===i.ref)return vs(s,i,g)}return i.flags|=1,s=fs(w,h),s.ref=i.ref,s.return=i,i.child=s}function cy(s,i,u,h,g){if(s!==null){var w=s.memoizedProps;if(Ec(w,h)&&s.ref===i.ref)if(zr=!1,i.pendingProps=h=w,wx(s,g))(s.flags&131072)!==0&&(zr=!0);else return i.lanes=s.lanes,vs(s,i,g)}return xx(s,i,u,h,g)}function uy(s,i,u){var h=i.pendingProps,g=h.children,w=s!==null?s.memoizedState:null;if(h.mode==="hidden"){if((i.flags&128)!==0){if(h=w!==null?w.baseLanes|u:u,s!==null){for(g=i.child=s.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;i.childLanes=w&~h}else i.childLanes=0,i.child=null;return fy(s,i,h,u)}if((u&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Hu(i,w!==null?w.cachePool:null),w!==null?cv(i,w):Xh(),Qv(i);else return i.lanes=i.childLanes=536870912,fy(s,i,w!==null?w.baseLanes|u:u,u)}else w!==null?(Hu(i,w.cachePool),cv(i,w),Zs(),i.memoizedState=null):(s!==null&&Hu(i,null),Xh(),Zs());return $r(s,i,g,u),i.child}function fy(s,i,u,h){var g=zh();return g=g===null?null:{parent:Fr._currentValue,pool:g},i.memoizedState={baseLanes:u,cachePool:g},s!==null&&Hu(i,null),Xh(),Qv(i),s!==null&&Cc(s,i,h,!0),null}function sf(s,i){var u=i.ref;if(u===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(a(284));(s===null||s.ref!==u)&&(i.flags|=4194816)}}function xx(s,i,u,h,g){return el(i),u=Kh(s,i,u,h,void 0,g),h=Qh(),s!==null&&!zr?(Zh(s,i,g),vs(s,i,g)):(Rt&&h&&Fh(i),i.flags|=1,$r(s,i,u,g),i.child)}function dy(s,i,u,h,g,w){return el(i),i.updateQueue=null,u=fv(i,h,u,g),uv(s),h=Qh(),s!==null&&!zr?(Zh(s,i,w),vs(s,i,w)):(Rt&&h&&Fh(i),i.flags|=1,$r(s,i,u,w),i.child)}function hy(s,i,u,h,g){if(el(i),i.stateNode===null){var w=eo,j=u.contextType;typeof j=="object"&&j!==null&&(w=ta(j)),w=new u(h,w),i.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=dx,i.stateNode=w,w._reactInternals=i,w=i.stateNode,w.props=h,w.state=i.memoizedState,w.refs={},Gh(i),j=u.contextType,w.context=typeof j=="object"&&j!==null?ta(j):eo,w.state=i.memoizedState,j=u.getDerivedStateFromProps,typeof j=="function"&&(fx(i,u,j,h),w.state=i.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(j=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),j!==w.state&&dx.enqueueReplaceState(w,w.state,null),Mc(i,h,w,g),Oc(),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!0}else if(s===null){w=i.stateNode;var P=i.memoizedProps,J=al(u,P);w.props=J;var de=w.context,Te=u.contextType;j=eo,typeof Te=="object"&&Te!==null&&(j=ta(Te));var Ae=u.getDerivedStateFromProps;Te=typeof Ae=="function"||typeof w.getSnapshotBeforeUpdate=="function",P=i.pendingProps!==P,Te||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(P||de!==j)&&Jv(i,w,h,j),Xs=!1;var pe=i.memoizedState;w.state=pe,Mc(i,h,w,g),Oc(),de=i.memoizedState,P||pe!==de||Xs?(typeof Ae=="function"&&(fx(i,u,Ae,h),de=i.memoizedState),(J=Xs||Zv(i,u,J,h,pe,de,j))?(Te||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=de),w.props=h,w.state=de,w.context=j,h=J):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{w=i.stateNode,Vh(s,i),j=i.memoizedProps,Te=al(u,j),w.props=Te,Ae=i.pendingProps,pe=w.context,de=u.contextType,J=eo,typeof de=="object"&&de!==null&&(J=ta(de)),P=u.getDerivedStateFromProps,(de=typeof P=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(j!==Ae||pe!==J)&&Jv(i,w,h,J),Xs=!1,pe=i.memoizedState,w.state=pe,Mc(i,h,w,g),Oc();var ve=i.memoizedState;j!==Ae||pe!==ve||Xs||s!==null&&s.dependencies!==null&&Uu(s.dependencies)?(typeof P=="function"&&(fx(i,u,P,h),ve=i.memoizedState),(Te=Xs||Zv(i,u,Te,h,pe,ve,J)||s!==null&&s.dependencies!==null&&Uu(s.dependencies))?(de||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,ve,J),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,ve,J)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=ve),w.props=h,w.state=ve,w.context=J,h=Te):(typeof w.componentDidUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||j===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),h=!1)}return w=h,sf(s,i),h=(i.flags&128)!==0,w||h?(w=i.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:w.render(),i.flags|=1,s!==null&&h?(i.child=uo(i,s.child,null,g),i.child=uo(i,null,u,g)):$r(s,i,u,g),i.memoizedState=w.state,s=i.child):s=vs(s,i,g),s}function xy(s,i,u,h){return Tc(),i.flags|=256,$r(s,i,u,h),i.child}var mx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function px(s){return{baseLanes:s,cachePool:tv()}}function gx(s,i,u){return s=s!==null?s.childLanes&~u:0,i&&(s|=sn),s}function my(s,i,u){var h=i.pendingProps,g=!1,w=(i.flags&128)!==0,j;if((j=w)||(j=s!==null&&s.memoizedState===null?!1:(Or.current&2)!==0),j&&(g=!0,i.flags&=-129),j=(i.flags&32)!==0,i.flags&=-33,s===null){if(Rt){if(g?Qs(i):Zs(),Rt){var P=fr,J;if(J=P){e:{for(J=P,P=Vn;J.nodeType!==8;){if(!P){P=null;break e}if(J=Tn(J.nextSibling),J===null){P=null;break e}}P=J}P!==null?(i.memoizedState={dehydrated:P,treeContext:$i!==null?{id:ds,overflow:hs}:null,retryLane:536870912,hydrationErrors:null},J=Pa(18,null,null,0),J.stateNode=P,J.return=i,i.child=J,xa=i,fr=null,J=!0):J=!1}J||Zi(i)}if(P=i.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return em(P)?i.lanes=32:i.lanes=536870912,null;gs(i)}return P=h.children,h=h.fallback,g?(Zs(),g=i.mode,P=lf({mode:"hidden",children:P},g),h=Yi(h,g,u,null),P.return=i,h.return=i,P.sibling=h,i.child=P,g=i.child,g.memoizedState=px(u),g.childLanes=gx(s,j,u),i.memoizedState=mx,h):(Qs(i),vx(i,P))}if(J=s.memoizedState,J!==null&&(P=J.dehydrated,P!==null)){if(w)i.flags&256?(Qs(i),i.flags&=-257,i=yx(s,i,u)):i.memoizedState!==null?(Zs(),i.child=s.child,i.flags|=128,i=null):(Zs(),g=h.fallback,P=i.mode,h=lf({mode:"visible",children:h.children},P),g=Yi(g,P,u,null),g.flags|=2,h.return=i,g.return=i,h.sibling=g,i.child=h,uo(i,s.child,null,u),h=i.child,h.memoizedState=px(u),h.childLanes=gx(s,j,u),i.memoizedState=mx,i=g);else if(Qs(i),em(P)){if(j=P.nextSibling&&P.nextSibling.dataset,j)var de=j.dgst;j=de,h=Error(a(419)),h.stack="",h.digest=j,Nc({value:h,source:null,stack:null}),i=yx(s,i,u)}else if(zr||Cc(s,i,u,!1),j=(u&s.childLanes)!==0,zr||j){if(j=Zt,j!==null&&(h=u&-u,h=(h&42)!==0?1:hc(h),h=(h&(j.suspendedLanes|u))!==0?0:h,h!==0&&h!==J.retryLane))throw J.retryLane=h,Jl(s,h),Ga(j,s,h),iy;P.data==="$?"||Bx(),i=yx(s,i,u)}else P.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=J.treeContext,fr=Tn(P.nextSibling),xa=i,Rt=!0,Qi=null,Vn=!1,s!==null&&(rn[an++]=ds,rn[an++]=hs,rn[an++]=$i,ds=s.id,hs=s.overflow,$i=i),i=vx(i,h.children),i.flags|=4096);return i}return g?(Zs(),g=h.fallback,P=i.mode,J=s.child,de=J.sibling,h=fs(J,{mode:"hidden",children:h.children}),h.subtreeFlags=J.subtreeFlags&65011712,de!==null?g=fs(de,g):(g=Yi(g,P,u,null),g.flags|=2),g.return=i,h.return=i,h.sibling=g,i.child=h,h=g,g=i.child,P=s.child.memoizedState,P===null?P=px(u):(J=P.cachePool,J!==null?(de=Fr._currentValue,J=J.parent!==de?{parent:de,pool:de}:J):J=tv(),P={baseLanes:P.baseLanes|u,cachePool:J}),g.memoizedState=P,g.childLanes=gx(s,j,u),i.memoizedState=mx,h):(Qs(i),u=s.child,s=u.sibling,u=fs(u,{mode:"visible",children:h.children}),u.return=i,u.sibling=null,s!==null&&(j=i.deletions,j===null?(i.deletions=[s],i.flags|=16):j.push(s)),i.child=u,i.memoizedState=null,u)}function vx(s,i){return i=lf({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function lf(s,i){return s=Pa(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function yx(s,i,u){return uo(i,s.child,null,u),s=vx(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function py(s,i,u){s.lanes|=i;var h=s.alternate;h!==null&&(h.lanes|=i),Bh(s.return,i,u)}function bx(s,i,u,h,g){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:g}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=u,w.tailMode=g)}function gy(s,i,u){var h=i.pendingProps,g=h.revealOrder,w=h.tail;if($r(s,i,h.children,u),h=Or.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&py(s,u,i);else if(s.tag===19)py(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}switch(I(Or,h),g){case"forwards":for(u=i.child,g=null;u!==null;)s=u.alternate,s!==null&&rf(s)===null&&(g=u),u=u.sibling;u=g,u===null?(g=i.child,i.child=null):(g=u.sibling,u.sibling=null),bx(i,!1,g,u,w);break;case"backwards":for(u=null,g=i.child,i.child=null;g!==null;){if(s=g.alternate,s!==null&&rf(s)===null){i.child=g;break}s=g.sibling,g.sibling=u,u=g,g=s}bx(i,!0,u,null,w);break;case"together":bx(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function vs(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),ai|=i.lanes,(u&i.childLanes)===0)if(s!==null){if(Cc(s,i,u,!1),(u&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,u=fs(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=fs(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function wx(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Uu(s)))}function x3(s,i,u){switch(i.tag){case 3:be(i,i.stateNode.containerInfo),Ws(i,Fr,s.memoizedState.cache),Tc();break;case 27:case 5:Ne(i);break;case 4:be(i,i.stateNode.containerInfo);break;case 10:Ws(i,i.type,i.memoizedProps.value);break;case 13:var h=i.memoizedState;if(h!==null)return h.dehydrated!==null?(Qs(i),i.flags|=128,null):(u&i.child.childLanes)!==0?my(s,i,u):(Qs(i),s=vs(s,i,u),s!==null?s.sibling:null);Qs(i);break;case 19:var g=(s.flags&128)!==0;if(h=(u&i.childLanes)!==0,h||(Cc(s,i,u,!1),h=(u&i.childLanes)!==0),g){if(h)return gy(s,i,u);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),I(Or,Or.current),h)break;return null;case 22:case 23:return i.lanes=0,uy(s,i,u);case 24:Ws(i,Fr,s.memoizedState.cache)}return vs(s,i,u)}function vy(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps)zr=!0;else{if(!wx(s,u)&&(i.flags&128)===0)return zr=!1,x3(s,i,u);zr=(s.flags&131072)!==0}else zr=!1,Rt&&(i.flags&1048576)!==0&&Y1(i,Iu,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var h=i.elementType,g=h._init;if(h=g(h._payload),i.type=h,typeof h=="function")jh(h)?(s=al(h,s),i.tag=1,i=hy(null,i,h,s,u)):(i.tag=0,i=xx(null,i,h,s,u));else{if(h!=null){if(g=h.$$typeof,g===R){i.tag=11,i=ly(null,i,h,s,u);break e}else if(g===T){i.tag=14,i=oy(null,i,h,s,u);break e}}throw i=oe(h)||h,Error(a(306,i,""))}}return i;case 0:return xx(s,i,i.type,i.pendingProps,u);case 1:return h=i.type,g=al(h,i.pendingProps),hy(s,i,h,g,u);case 3:e:{if(be(i,i.stateNode.containerInfo),s===null)throw Error(a(387));h=i.pendingProps;var w=i.memoizedState;g=w.element,Vh(s,i),Mc(i,h,null,u);var j=i.memoizedState;if(h=j.cache,Ws(i,Fr,h),h!==w.cache&&Ph(i,[Fr],u,!0),Oc(),h=j.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:j.cache},i.updateQueue.baseState=w,i.memoizedState=w,i.flags&256){i=xy(s,i,h,u);break e}else if(h!==g){g=en(Error(a(424)),i),Nc(g),i=xy(s,i,h,u);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(fr=Tn(s.firstChild),xa=i,Rt=!0,Qi=null,Vn=!0,u=Kv(i,null,h,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Tc(),h===g){i=vs(s,i,u);break e}$r(s,i,h,u)}i=i.child}return i;case 26:return sf(s,i),s===null?(u=S2(i.type,null,i.pendingProps,null))?i.memoizedState=u:Rt||(u=i.type,s=i.pendingProps,h=wf(ne.current).createElement(u),h[Ir]=i,h[Ur]=s,Qr(h,u,s),ue(h),i.stateNode=h):i.memoizedState=S2(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Ne(i),s===null&&Rt&&(h=i.stateNode=y2(i.type,i.pendingProps,ne.current),xa=i,Vn=!0,g=fr,li(i.type)?(tm=g,fr=Tn(h.firstChild)):fr=g),$r(s,i,i.pendingProps.children,u),sf(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Rt&&((g=h=fr)&&(h=H3(h,i.type,i.pendingProps,Vn),h!==null?(i.stateNode=h,xa=i,fr=Tn(h.firstChild),Vn=!1,g=!0):g=!1),g||Zi(i)),Ne(i),g=i.type,w=i.pendingProps,j=s!==null?s.memoizedProps:null,h=w.children,Qx(g,w)?h=null:j!==null&&Qx(g,j)&&(i.flags|=32),i.memoizedState!==null&&(g=Kh(s,i,i3,null,null,u),a0._currentValue=g),sf(s,i),$r(s,i,h,u),i.child;case 6:return s===null&&Rt&&((s=u=fr)&&(u=G3(u,i.pendingProps,Vn),u!==null?(i.stateNode=u,xa=i,fr=null,s=!0):s=!1),s||Zi(i)),null;case 13:return my(s,i,u);case 4:return be(i,i.stateNode.containerInfo),h=i.pendingProps,s===null?i.child=uo(i,null,h,u):$r(s,i,h,u),i.child;case 11:return ly(s,i,i.type,i.pendingProps,u);case 7:return $r(s,i,i.pendingProps,u),i.child;case 8:return $r(s,i,i.pendingProps.children,u),i.child;case 12:return $r(s,i,i.pendingProps.children,u),i.child;case 10:return h=i.pendingProps,Ws(i,i.type,h.value),$r(s,i,h.children,u),i.child;case 9:return g=i.type._context,h=i.pendingProps.children,el(i),g=ta(g),h=h(g),i.flags|=1,$r(s,i,h,u),i.child;case 14:return oy(s,i,i.type,i.pendingProps,u);case 15:return cy(s,i,i.type,i.pendingProps,u);case 19:return gy(s,i,u);case 31:return h=i.pendingProps,u=i.mode,h={mode:h.mode,children:h.children},s===null?(u=lf(h,u),u.ref=i.ref,i.child=u,u.return=i,i=u):(u=fs(s.child,h),u.ref=i.ref,i.child=u,u.return=i,i=u),i;case 22:return uy(s,i,u);case 24:return el(i),h=ta(Fr),s===null?(g=zh(),g===null&&(g=Zt,w=Ih(),g.pooledCache=w,w.refCount++,w!==null&&(g.pooledCacheLanes|=u),g=w),i.memoizedState={parent:h,cache:g},Gh(i),Ws(i,Fr,g)):((s.lanes&u)!==0&&(Vh(s,i),Mc(i,null,null,u),Oc()),g=s.memoizedState,w=i.memoizedState,g.parent!==h?(g={parent:h,cache:h},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),Ws(i,Fr,h)):(h=w.cache,Ws(i,Fr,h),h!==g.cache&&Ph(i,[Fr],u,!0))),$r(s,i,i.pendingProps.children,u),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function ys(s){s.flags|=4}function yy(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!N2(i)){if(i=nn.current,i!==null&&((_t&4194048)===_t?qn!==null:(_t&62914560)!==_t&&(_t&536870912)===0||i!==qn))throw Dc=Hh,rv;s.flags|=8192}}function of(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?fc():536870912,s.lanes|=i,mo|=i)}function Hc(s,i){if(!Rt)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function lr(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(i)for(var g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=h,s.childLanes=u,i}function m3(s,i,u){var h=i.pendingProps;switch(Oh(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(i),null;case 1:return lr(i),null;case 3:return u=i.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),i.memoizedState.cache!==h&&(i.flags|=2048),ms(Fr),Se(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(kc(i)?ys(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Q1())),lr(i),null;case 26:return u=i.memoizedState,s===null?(ys(i),u!==null?(lr(i),yy(i,u)):(lr(i),i.flags&=-16777217)):u?u!==s.memoizedState?(ys(i),lr(i),yy(i,u)):(lr(i),i.flags&=-16777217):(s.memoizedProps!==h&&ys(i),lr(i),i.flags&=-16777217),null;case 27:Xe(i),u=ne.current;var g=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==h&&ys(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return lr(i),null}s=M.current,kc(i)?$1(i):(s=y2(g,h,u),i.stateNode=s,ys(i))}return lr(i),null;case 5:if(Xe(i),u=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==h&&ys(i);else{if(!h){if(i.stateNode===null)throw Error(a(166));return lr(i),null}if(s=M.current,kc(i))$1(i);else{switch(g=wf(ne.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?s.multiple=!0:h.size&&(s.size=h.size);break;default:s=typeof h.is=="string"?g.createElement(u,{is:h.is}):g.createElement(u)}}s[Ir]=i,s[Ur]=h;e:for(g=i.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===i)break e;for(;g.sibling===null;){if(g.return===null||g.return===i)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}i.stateNode=s;e:switch(Qr(s,u,h),u){case"button":case"input":case"select":case"textarea":s=!!h.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&ys(i)}}return lr(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==h&&ys(i);else{if(typeof h!="string"&&i.stateNode===null)throw Error(a(166));if(s=ne.current,kc(i)){if(s=i.stateNode,u=i.memoizedProps,h=null,g=xa,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}s[Ir]=i,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||d2(s.nodeValue,u)),s||Zi(i)}else s=wf(s).createTextNode(h),s[Ir]=i,i.stateNode=s}return lr(i),null;case 13:if(h=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=kc(i),h!==null&&h.dehydrated!==null){if(s===null){if(!g)throw Error(a(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(a(317));g[Ir]=i}else Tc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;lr(i),g=!1}else g=Q1(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(gs(i),i):(gs(i),null)}if(gs(i),(i.flags&128)!==0)return i.lanes=u,i;if(u=h!==null,s=s!==null&&s.memoizedState!==null,u){h=i.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var w=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==g&&(h.flags|=2048)}return u!==s&&u&&(i.child.flags|=8192),of(i,i.updateQueue),lr(i),null;case 4:return Se(),s===null&&Wx(i.stateNode.containerInfo),lr(i),null;case 10:return ms(i.type),lr(i),null;case 19:if(B(Or),g=i.memoizedState,g===null)return lr(i),null;if(h=(i.flags&128)!==0,w=g.rendering,w===null)if(h)Hc(g,!1);else{if(dr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(w=rf(s),w!==null){for(i.flags|=128,Hc(g,!1),s=w.updateQueue,i.updateQueue=s,of(i,s),i.subtreeFlags=0,s=u,u=i.child;u!==null;)X1(u,s),u=u.sibling;return I(Or,Or.current&1|2),i.child}s=s.sibling}g.tail!==null&&Oe()>ff&&(i.flags|=128,h=!0,Hc(g,!1),i.lanes=4194304)}else{if(!h)if(s=rf(w),s!==null){if(i.flags|=128,h=!0,s=s.updateQueue,i.updateQueue=s,of(i,s),Hc(g,!0),g.tail===null&&g.tailMode==="hidden"&&!w.alternate&&!Rt)return lr(i),null}else 2*Oe()-g.renderingStartTime>ff&&u!==536870912&&(i.flags|=128,h=!0,Hc(g,!1),i.lanes=4194304);g.isBackwards?(w.sibling=i.child,i.child=w):(s=g.last,s!==null?s.sibling=w:i.child=w,g.last=w)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=Oe(),i.sibling=null,s=Or.current,I(Or,h?s&1|2:s&1),i):(lr(i),null);case 22:case 23:return gs(i),Yh(),h=i.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(i.flags|=8192):h&&(i.flags|=8192),h?(u&536870912)!==0&&(i.flags&128)===0&&(lr(i),i.subtreeFlags&6&&(i.flags|=8192)):lr(i),u=i.updateQueue,u!==null&&of(i,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==u&&(i.flags|=2048),s!==null&&B(tl),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ms(Fr),lr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function p3(s,i){switch(Oh(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ms(Fr),Se(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Xe(i),null;case 13:if(gs(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Tc()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return B(Or),null;case 4:return Se(),null;case 10:return ms(i.type),null;case 22:case 23:return gs(i),Yh(),s!==null&&B(tl),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ms(Fr),null;case 25:return null;default:return null}}function by(s,i){switch(Oh(i),i.tag){case 3:ms(Fr),Se();break;case 26:case 27:case 5:Xe(i);break;case 4:Se();break;case 13:gs(i);break;case 19:B(Or);break;case 10:ms(i.type);break;case 22:case 23:gs(i),Yh(),s!==null&&B(tl);break;case 24:ms(Fr)}}function Gc(s,i){try{var u=i.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&s)===s){h=void 0;var w=u.create,j=u.inst;h=w(),j.destroy=h}u=u.next}while(u!==g)}}catch(P){Wt(i,i.return,P)}}function Js(s,i,u){try{var h=i.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var w=g.next;h=w;do{if((h.tag&s)===s){var j=h.inst,P=j.destroy;if(P!==void 0){j.destroy=void 0,g=i;var J=u,de=P;try{de()}catch(Te){Wt(g,J,Te)}}}h=h.next}while(h!==w)}}catch(Te){Wt(i,i.return,Te)}}function wy(s){var i=s.updateQueue;if(i!==null){var u=s.stateNode;try{ov(i,u)}catch(h){Wt(s,s.return,h)}}}function Sy(s,i,u){u.props=al(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Wt(s,i,h)}}function Vc(s,i){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(g){Wt(s,i,g)}}function Wn(s,i){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(g){Wt(s,i,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){Wt(s,i,g)}else u.current=null}function Ey(s){var i=s.type,u=s.memoizedProps,h=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(g){Wt(s,s.return,g)}}function Sx(s,i,u){try{var h=s.stateNode;B3(h,s.type,u,i),h[Ur]=i}catch(g){Wt(s,s.return,g)}}function _y(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&li(s.type)||s.tag===4}function Ex(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||_y(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&li(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _x(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,i):(i=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,i.appendChild(s),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=bf));else if(h!==4&&(h===27&&li(s.type)&&(u=s.stateNode,i=null),s=s.child,s!==null))for(_x(s,i,u),s=s.sibling;s!==null;)_x(s,i,u),s=s.sibling}function cf(s,i,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(h!==4&&(h===27&&li(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(cf(s,i,u),s=s.sibling;s!==null;)cf(s,i,u),s=s.sibling}function ky(s){var i=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);Qr(i,h,u),i[Ir]=s,i[Ur]=u}catch(w){Wt(s,s.return,w)}}var bs=!1,vr=!1,kx=!1,Ty=typeof WeakSet=="function"?WeakSet:Set,Hr=null;function g3(s,i){if(s=s.containerInfo,$x=Nf,s=B1(s),Eh(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var g=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var j=0,P=-1,J=-1,de=0,Te=0,Ae=s,pe=null;t:for(;;){for(var ve;Ae!==u||g!==0&&Ae.nodeType!==3||(P=j+g),Ae!==w||h!==0&&Ae.nodeType!==3||(J=j+h),Ae.nodeType===3&&(j+=Ae.nodeValue.length),(ve=Ae.firstChild)!==null;)pe=Ae,Ae=ve;for(;;){if(Ae===s)break t;if(pe===u&&++de===g&&(P=j),pe===w&&++Te===h&&(J=j),(ve=Ae.nextSibling)!==null)break;Ae=pe,pe=Ae.parentNode}Ae=ve}u=P===-1||J===-1?null:{start:P,end:J}}else u=null}u=u||{start:0,end:0}}else u=null;for(Kx={focusedElem:s,selectionRange:u},Nf=!1,Hr=i;Hr!==null;)if(i=Hr,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Hr=s;else for(;Hr!==null;){switch(i=Hr,w=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,u=i,g=w.memoizedProps,w=w.memoizedState,h=u.stateNode;try{var nt=al(u.type,g,u.elementType===u.type);s=h.getSnapshotBeforeUpdate(nt,w),h.__reactInternalSnapshotBeforeUpdate=s}catch(et){Wt(u,u.return,et)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,u=s.nodeType,u===9)Jx(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Jx(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,Hr=s;break}Hr=i.return}}function Ny(s,i,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:ei(s,u),h&4&&Gc(5,u);break;case 1:if(ei(s,u),h&4)if(s=u.stateNode,i===null)try{s.componentDidMount()}catch(j){Wt(u,u.return,j)}else{var g=al(u.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(g,i,s.__reactInternalSnapshotBeforeUpdate)}catch(j){Wt(u,u.return,j)}}h&64&&wy(u),h&512&&Vc(u,u.return);break;case 3:if(ei(s,u),h&64&&(s=u.updateQueue,s!==null)){if(i=null,u.child!==null)switch(u.child.tag){case 27:case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}try{ov(s,i)}catch(j){Wt(u,u.return,j)}}break;case 27:i===null&&h&4&&ky(u);case 26:case 5:ei(s,u),i===null&&h&4&&Ey(u),h&512&&Vc(u,u.return);break;case 12:ei(s,u);break;case 13:ei(s,u),h&4&&jy(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=T3.bind(null,u),V3(s,u))));break;case 22:if(h=u.memoizedState!==null||bs,!h){i=i!==null&&i.memoizedState!==null||vr,g=bs;var w=vr;bs=h,(vr=i)&&!w?ti(s,u,(u.subtreeFlags&8772)!==0):ei(s,u),bs=g,vr=w}break;case 30:break;default:ei(s,u)}}function Cy(s){var i=s.alternate;i!==null&&(s.alternate=null,Cy(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&G(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nr=null,Na=!1;function ws(s,i,u){for(u=u.child;u!==null;)Ay(s,i,u),u=u.sibling}function Ay(s,i,u){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(_r,u)}catch{}switch(u.tag){case 26:vr||Wn(u,i),ws(s,i,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:vr||Wn(u,i);var h=nr,g=Na;li(u.type)&&(nr=u.stateNode,Na=!1),ws(s,i,u),Jc(u.stateNode),nr=h,Na=g;break;case 5:vr||Wn(u,i);case 6:if(h=nr,g=Na,nr=null,ws(s,i,u),nr=h,Na=g,nr!==null)if(Na)try{(nr.nodeType===9?nr.body:nr.nodeName==="HTML"?nr.ownerDocument.body:nr).removeChild(u.stateNode)}catch(w){Wt(u,i,w)}else try{nr.removeChild(u.stateNode)}catch(w){Wt(u,i,w)}break;case 18:nr!==null&&(Na?(s=nr,g2(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),l0(s)):g2(nr,u.stateNode));break;case 4:h=nr,g=Na,nr=u.stateNode.containerInfo,Na=!0,ws(s,i,u),nr=h,Na=g;break;case 0:case 11:case 14:case 15:vr||Js(2,u,i),vr||Js(4,u,i),ws(s,i,u);break;case 1:vr||(Wn(u,i),h=u.stateNode,typeof h.componentWillUnmount=="function"&&Sy(u,i,h)),ws(s,i,u);break;case 21:ws(s,i,u);break;case 22:vr=(h=vr)||u.memoizedState!==null,ws(s,i,u),vr=h;break;default:ws(s,i,u)}}function jy(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{l0(s)}catch(u){Wt(i,i.return,u)}}function v3(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new Ty),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new Ty),i;default:throw Error(a(435,s.tag))}}function Tx(s,i){var u=v3(s);i.forEach(function(h){var g=N3.bind(null,s,h);u.has(h)||(u.add(h),h.then(g,g))})}function Ia(s,i){var u=i.deletions;if(u!==null)for(var h=0;h<u.length;h++){var g=u[h],w=s,j=i,P=j;e:for(;P!==null;){switch(P.tag){case 27:if(li(P.type)){nr=P.stateNode,Na=!1;break e}break;case 5:nr=P.stateNode,Na=!1;break e;case 3:case 4:nr=P.stateNode.containerInfo,Na=!0;break e}P=P.return}if(nr===null)throw Error(a(160));Ay(w,j,g),nr=null,Na=!1,w=g.alternate,w!==null&&(w.return=null),g.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)Ry(i,s),i=i.sibling}var kn=null;function Ry(s,i){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ia(i,s),Ua(s),h&4&&(Js(3,s,s.return),Gc(3,s),Js(5,s,s.return));break;case 1:Ia(i,s),Ua(s),h&512&&(vr||u===null||Wn(u,u.return)),h&64&&bs&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var g=kn;if(Ia(i,s),Ua(s),h&512&&(vr||u===null||Wn(u,u.return)),h&4){var w=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){e:{h=s.type,u=s.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":w=g.getElementsByTagName("title")[0],(!w||w[H]||w[Ir]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=g.createElement(h),g.head.insertBefore(w,g.querySelector("head > title"))),Qr(w,h,u),w[Ir]=s,ue(w),h=w;break e;case"link":var j=k2("link","href",g).get(h+(u.href||""));if(j){for(var P=0;P<j.length;P++)if(w=j[P],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){j.splice(P,1);break t}}w=g.createElement(h),Qr(w,h,u),g.head.appendChild(w);break;case"meta":if(j=k2("meta","content",g).get(h+(u.content||""))){for(P=0;P<j.length;P++)if(w=j[P],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){j.splice(P,1);break t}}w=g.createElement(h),Qr(w,h,u),g.head.appendChild(w);break;default:throw Error(a(468,h))}w[Ir]=s,ue(w),h=w}s.stateNode=h}else T2(g,s.type,s.stateNode);else s.stateNode=_2(g,h,s.memoizedProps);else w!==h?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,h===null?T2(g,s.type,s.stateNode):_2(g,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Sx(s,s.memoizedProps,u.memoizedProps)}break;case 27:Ia(i,s),Ua(s),h&512&&(vr||u===null||Wn(u,u.return)),u!==null&&h&4&&Sx(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Ia(i,s),Ua(s),h&512&&(vr||u===null||Wn(u,u.return)),s.flags&32){g=s.stateNode;try{Wl(g,"")}catch(ve){Wt(s,s.return,ve)}}h&4&&s.stateNode!=null&&(g=s.memoizedProps,Sx(s,g,u!==null?u.memoizedProps:g)),h&1024&&(kx=!0);break;case 6:if(Ia(i,s),Ua(s),h&4){if(s.stateNode===null)throw Error(a(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(ve){Wt(s,s.return,ve)}}break;case 3:if(_f=null,g=kn,kn=Sf(i.containerInfo),Ia(i,s),kn=g,Ua(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{l0(i.containerInfo)}catch(ve){Wt(s,s.return,ve)}kx&&(kx=!1,Dy(s));break;case 4:h=kn,kn=Sf(s.stateNode.containerInfo),Ia(i,s),Ua(s),kn=h;break;case 12:Ia(i,s),Ua(s);break;case 13:Ia(i,s),Ua(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Dx=Oe()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Tx(s,h)));break;case 22:g=s.memoizedState!==null;var J=u!==null&&u.memoizedState!==null,de=bs,Te=vr;if(bs=de||g,vr=Te||J,Ia(i,s),vr=Te,bs=de,Ua(s),h&8192)e:for(i=s.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(u===null||J||bs||vr||nl(s)),u=null,i=s;;){if(i.tag===5||i.tag===26){if(u===null){J=u=i;try{if(w=J.stateNode,g)j=w.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{P=J.stateNode;var Ae=J.memoizedProps.style,pe=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null;P.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(ve){Wt(J,J.return,ve)}}}else if(i.tag===6){if(u===null){J=i;try{J.stateNode.nodeValue=g?"":J.memoizedProps}catch(ve){Wt(J,J.return,ve)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;u===i&&(u=null),i=i.return}u===i&&(u=null),i.sibling.return=i.return,i=i.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Tx(s,u))));break;case 19:Ia(i,s),Ua(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Tx(s,h)));break;case 30:break;case 21:break;default:Ia(i,s),Ua(s)}}function Ua(s){var i=s.flags;if(i&2){try{for(var u,h=s.return;h!==null;){if(_y(h)){u=h;break}h=h.return}if(u==null)throw Error(a(160));switch(u.tag){case 27:var g=u.stateNode,w=Ex(s);cf(s,w,g);break;case 5:var j=u.stateNode;u.flags&32&&(Wl(j,""),u.flags&=-33);var P=Ex(s);cf(s,P,j);break;case 3:case 4:var J=u.stateNode.containerInfo,de=Ex(s);_x(s,de,J);break;default:throw Error(a(161))}}catch(Te){Wt(s,s.return,Te)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Dy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Dy(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function ei(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Ny(s,i.alternate,i),i=i.sibling}function nl(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Js(4,i,i.return),nl(i);break;case 1:Wn(i,i.return);var u=i.stateNode;typeof u.componentWillUnmount=="function"&&Sy(i,i.return,u),nl(i);break;case 27:Jc(i.stateNode);case 26:case 5:Wn(i,i.return),nl(i);break;case 22:i.memoizedState===null&&nl(i);break;case 30:nl(i);break;default:nl(i)}s=s.sibling}}function ti(s,i,u){for(u=u&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var h=i.alternate,g=s,w=i,j=w.flags;switch(w.tag){case 0:case 11:case 15:ti(g,w,u),Gc(4,w);break;case 1:if(ti(g,w,u),h=w,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(de){Wt(h,h.return,de)}if(h=w,g=h.updateQueue,g!==null){var P=h.stateNode;try{var J=g.shared.hiddenCallbacks;if(J!==null)for(g.shared.hiddenCallbacks=null,g=0;g<J.length;g++)lv(J[g],P)}catch(de){Wt(h,h.return,de)}}u&&j&64&&wy(w),Vc(w,w.return);break;case 27:ky(w);case 26:case 5:ti(g,w,u),u&&h===null&&j&4&&Ey(w),Vc(w,w.return);break;case 12:ti(g,w,u);break;case 13:ti(g,w,u),u&&j&4&&jy(g,w);break;case 22:w.memoizedState===null&&ti(g,w,u),Vc(w,w.return);break;case 30:break;default:ti(g,w,u)}i=i.sibling}}function Nx(s,i){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Ac(u))}function Cx(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Ac(s))}function Xn(s,i,u,h){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Fy(s,i,u,h),i=i.sibling}function Fy(s,i,u,h){var g=i.flags;switch(i.tag){case 0:case 11:case 15:Xn(s,i,u,h),g&2048&&Gc(9,i);break;case 1:Xn(s,i,u,h);break;case 3:Xn(s,i,u,h),g&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Ac(s)));break;case 12:if(g&2048){Xn(s,i,u,h),s=i.stateNode;try{var w=i.memoizedProps,j=w.id,P=w.onPostCommit;typeof P=="function"&&P(j,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Wt(i,i.return,J)}}else Xn(s,i,u,h);break;case 13:Xn(s,i,u,h);break;case 23:break;case 22:w=i.stateNode,j=i.alternate,i.memoizedState!==null?w._visibility&2?Xn(s,i,u,h):qc(s,i):w._visibility&2?Xn(s,i,u,h):(w._visibility|=2,fo(s,i,u,h,(i.subtreeFlags&10256)!==0)),g&2048&&Nx(j,i);break;case 24:Xn(s,i,u,h),g&2048&&Cx(i.alternate,i);break;default:Xn(s,i,u,h)}}function fo(s,i,u,h,g){for(g=g&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var w=s,j=i,P=u,J=h,de=j.flags;switch(j.tag){case 0:case 11:case 15:fo(w,j,P,J,g),Gc(8,j);break;case 23:break;case 22:var Te=j.stateNode;j.memoizedState!==null?Te._visibility&2?fo(w,j,P,J,g):qc(w,j):(Te._visibility|=2,fo(w,j,P,J,g)),g&&de&2048&&Nx(j.alternate,j);break;case 24:fo(w,j,P,J,g),g&&de&2048&&Cx(j.alternate,j);break;default:fo(w,j,P,J,g)}i=i.sibling}}function qc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var u=s,h=i,g=h.flags;switch(h.tag){case 22:qc(u,h),g&2048&&Nx(h.alternate,h);break;case 24:qc(u,h),g&2048&&Cx(h.alternate,h);break;default:qc(u,h)}i=i.sibling}}var Wc=8192;function ho(s){if(s.subtreeFlags&Wc)for(s=s.child;s!==null;)Oy(s),s=s.sibling}function Oy(s){switch(s.tag){case 26:ho(s),s.flags&Wc&&s.memoizedState!==null&&aT(kn,s.memoizedState,s.memoizedProps);break;case 5:ho(s);break;case 3:case 4:var i=kn;kn=Sf(s.stateNode.containerInfo),ho(s),kn=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Wc,Wc=16777216,ho(s),Wc=i):ho(s));break;default:ho(s)}}function My(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Xc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var h=i[u];Hr=h,By(h,s)}My(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ly(s),s=s.sibling}function Ly(s){switch(s.tag){case 0:case 11:case 15:Xc(s),s.flags&2048&&Js(9,s,s.return);break;case 3:Xc(s);break;case 12:Xc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,uf(s)):Xc(s);break;default:Xc(s)}}function uf(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var h=i[u];Hr=h,By(h,s)}My(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Js(8,i,i.return),uf(i);break;case 22:u=i.stateNode,u._visibility&2&&(u._visibility&=-3,uf(i));break;default:uf(i)}s=s.sibling}}function By(s,i){for(;Hr!==null;){var u=Hr;switch(u.tag){case 0:case 11:case 15:Js(8,u,i);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Ac(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Hr=h;else e:for(u=s;Hr!==null;){h=Hr;var g=h.sibling,w=h.return;if(Cy(h),h===u){Hr=null;break e}if(g!==null){g.return=w,Hr=g;break e}Hr=w}}}var y3={getCacheForType:function(s){var i=ta(Fr),u=i.data.get(s);return u===void 0&&(u=s(),i.data.set(s,u)),u}},b3=typeof WeakMap=="function"?WeakMap:Map,Ft=0,Zt=null,vt=null,_t=0,Ot=0,za=null,ri=!1,xo=!1,Ax=!1,Ss=0,dr=0,ai=0,sl=0,jx=0,sn=0,mo=0,Yc=null,Ca=null,Rx=!1,Dx=0,ff=1/0,df=null,ni=null,Kr=0,si=null,po=null,go=0,Fx=0,Ox=null,Py=null,$c=0,Mx=null;function Ha(){if((Ft&2)!==0&&_t!==0)return _t&-_t;if(Z.T!==null){var s=ao;return s!==0?s:Hx()}return _u()}function Iy(){sn===0&&(sn=(_t&536870912)===0||Rt?Hs():536870912);var s=nn.current;return s!==null&&(s.flags|=32),sn}function Ga(s,i,u){(s===Zt&&(Ot===2||Ot===9)||s.cancelPendingCommit!==null)&&(vo(s,0),ii(s,_t,sn,!1)),Gi(s,u),((Ft&2)===0||s!==Zt)&&(s===Zt&&((Ft&2)===0&&(sl|=u),dr===4&&ii(s,_t,sn,!1)),Yn(s))}function Uy(s,i,u){if((Ft&6)!==0)throw Error(a(327));var h=!u&&(i&124)===0&&(i&s.expiredLanes)===0||Hn(s,i),g=h?E3(s,i):Px(s,i,!0),w=h;do{if(g===0){xo&&!h&&ii(s,i,0,!1);break}else{if(u=s.current.alternate,w&&!w3(u)){g=Px(s,i,!1),w=!1;continue}if(g===2){if(w=i,s.errorRecoveryDisabledLanes&w)var j=0;else j=s.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){i=j;e:{var P=s;g=Yc;var J=P.current.memoizedState.isDehydrated;if(J&&(vo(P,j).flags|=256),j=Px(P,j,!1),j!==2){if(Ax&&!J){P.errorRecoveryDisabledLanes|=w,sl|=w,g=4;break e}w=Ca,Ca=g,w!==null&&(Ca===null?Ca=w:Ca.push.apply(Ca,w))}g=j}if(w=!1,g!==2)continue}}if(g===1){vo(s,0),ii(s,i,0,!0);break}e:{switch(h=s,w=g,w){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:ii(h,i,sn,!ri);break e;case 2:Ca=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(g=Dx+300-Oe(),10<g)){if(ii(h,i,sn,!ri),os(h,0,!0)!==0)break e;h.timeoutHandle=m2(zy.bind(null,h,u,Ca,df,Rx,i,sn,sl,mo,ri,w,2,-0,0),g);break e}zy(h,u,Ca,df,Rx,i,sn,sl,mo,ri,w,0,-0,0)}}break}while(!0);Yn(s)}function zy(s,i,u,h,g,w,j,P,J,de,Te,Ae,pe,ve){if(s.timeoutHandle=-1,Ae=i.subtreeFlags,(Ae&8192||(Ae&16785408)===16785408)&&(r0={stylesheets:null,count:0,unsuspend:rT},Oy(i),Ae=nT(),Ae!==null)){s.cancelPendingCommit=Ae(Yy.bind(null,s,i,w,u,h,g,j,P,J,Te,1,pe,ve)),ii(s,w,j,!de);return}Yy(s,i,w,u,h,g,j,P,J)}function w3(s){for(var i=s;;){var u=i.tag;if((u===0||u===11||u===15)&&i.flags&16384&&(u=i.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var g=u[h],w=g.getSnapshot;g=g.value;try{if(!Ba(w(),g))return!1}catch{return!1}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ii(s,i,u,h){i&=~jx,i&=~sl,s.suspendedLanes|=i,s.pingedLanes&=~i,h&&(s.warmLanes|=i),h=s.expirationTimes;for(var g=i;0<g;){var w=31-De(g),j=1<<w;h[w]=-1,g&=~j}u!==0&&Su(s,u,i)}function hf(){return(Ft&6)===0?(Kc(0),!1):!0}function Lx(){if(vt!==null){if(Ot===0)var s=vt.return;else s=vt,xs=Ji=null,Jh(s),co=null,Uc=0,s=vt;for(;s!==null;)by(s.alternate,s),s=s.return;vt=null}}function vo(s,i){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,I3(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Lx(),Zt=s,vt=u=fs(s.current,null),_t=i,Ot=0,za=null,ri=!1,xo=Hn(s,i),Ax=!1,mo=sn=jx=sl=ai=dr=0,Ca=Yc=null,Rx=!1,(i&8)!==0&&(i|=i&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=i;0<h;){var g=31-De(h),w=1<<g;i|=s[g],h&=~w}return Ss=i,Ou(),u}function Hy(s,i){xt=null,Z.H=Ju,i===Rc||i===Gu?(i=sv(),Ot=3):i===rv?(i=sv(),Ot=4):Ot=i===iy?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,za=i,vt===null&&(dr=1,nf(s,en(i,s.current)))}function Gy(){var s=Z.H;return Z.H=Ju,s===null?Ju:s}function Vy(){var s=Z.A;return Z.A=y3,s}function Bx(){dr=4,ri||(_t&4194048)!==_t&&nn.current!==null||(xo=!0),(ai&134217727)===0&&(sl&134217727)===0||Zt===null||ii(Zt,_t,sn,!1)}function Px(s,i,u){var h=Ft;Ft|=2;var g=Gy(),w=Vy();(Zt!==s||_t!==i)&&(df=null,vo(s,i)),i=!1;var j=dr;e:do try{if(Ot!==0&&vt!==null){var P=vt,J=za;switch(Ot){case 8:Lx(),j=6;break e;case 3:case 2:case 9:case 6:nn.current===null&&(i=!0);var de=Ot;if(Ot=0,za=null,yo(s,P,J,de),u&&xo){j=0;break e}break;default:de=Ot,Ot=0,za=null,yo(s,P,J,de)}}S3(),j=dr;break}catch(Te){Hy(s,Te)}while(!0);return i&&s.shellSuspendCounter++,xs=Ji=null,Ft=h,Z.H=g,Z.A=w,vt===null&&(Zt=null,_t=0,Ou()),j}function S3(){for(;vt!==null;)qy(vt)}function E3(s,i){var u=Ft;Ft|=2;var h=Gy(),g=Vy();Zt!==s||_t!==i?(df=null,ff=Oe()+500,vo(s,i)):xo=Hn(s,i);e:do try{if(Ot!==0&&vt!==null){i=vt;var w=za;t:switch(Ot){case 1:Ot=0,za=null,yo(s,i,w,1);break;case 2:case 9:if(av(w)){Ot=0,za=null,Wy(i);break}i=function(){Ot!==2&&Ot!==9||Zt!==s||(Ot=7),Yn(s)},w.then(i,i);break e;case 3:Ot=7;break e;case 4:Ot=5;break e;case 7:av(w)?(Ot=0,za=null,Wy(i)):(Ot=0,za=null,yo(s,i,w,7));break;case 5:var j=null;switch(vt.tag){case 26:j=vt.memoizedState;case 5:case 27:var P=vt;if(!j||N2(j)){Ot=0,za=null;var J=P.sibling;if(J!==null)vt=J;else{var de=P.return;de!==null?(vt=de,xf(de)):vt=null}break t}}Ot=0,za=null,yo(s,i,w,5);break;case 6:Ot=0,za=null,yo(s,i,w,6);break;case 8:Lx(),dr=6;break e;default:throw Error(a(462))}}_3();break}catch(Te){Hy(s,Te)}while(!0);return xs=Ji=null,Z.H=h,Z.A=g,Ft=u,vt!==null?0:(Zt=null,_t=0,Ou(),dr)}function _3(){for(;vt!==null&&!dt();)qy(vt)}function qy(s){var i=vy(s.alternate,s,Ss);s.memoizedProps=s.pendingProps,i===null?xf(s):vt=i}function Wy(s){var i=s,u=i.alternate;switch(i.tag){case 15:case 0:i=dy(u,i,i.pendingProps,i.type,void 0,_t);break;case 11:i=dy(u,i,i.pendingProps,i.type.render,i.ref,_t);break;case 5:Jh(i);default:by(u,i),i=vt=X1(i,Ss),i=vy(u,i,Ss)}s.memoizedProps=s.pendingProps,i===null?xf(s):vt=i}function yo(s,i,u,h){xs=Ji=null,Jh(i),co=null,Uc=0;var g=i.return;try{if(h3(s,g,i,u,_t)){dr=1,nf(s,en(u,s.current)),vt=null;return}}catch(w){if(g!==null)throw vt=g,w;dr=1,nf(s,en(u,s.current)),vt=null;return}i.flags&32768?(Rt||h===1?s=!0:xo||(_t&536870912)!==0?s=!1:(ri=s=!0,(h===2||h===9||h===3||h===6)&&(h=nn.current,h!==null&&h.tag===13&&(h.flags|=16384))),Xy(i,s)):xf(i)}function xf(s){var i=s;do{if((i.flags&32768)!==0){Xy(i,ri);return}s=i.return;var u=m3(i.alternate,i,Ss);if(u!==null){vt=u;return}if(i=i.sibling,i!==null){vt=i;return}vt=i=s}while(i!==null);dr===0&&(dr=5)}function Xy(s,i){do{var u=p3(s.alternate,s);if(u!==null){u.flags&=32767,vt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!i&&(s=s.sibling,s!==null)){vt=s;return}vt=s=u}while(s!==null);dr=6,vt=null}function Yy(s,i,u,h,g,w,j,P,J){s.cancelPendingCommit=null;do mf();while(Kr!==0);if((Ft&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(w=i.lanes|i.childLanes,w|=Ch,Vl(s,u,w,j,P,J),s===Zt&&(vt=Zt=null,_t=0),po=i,si=s,go=u,Fx=w,Ox=g,Py=h,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,C3(St,function(){return Jy(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||h){h=Z.T,Z.T=null,g=ie.p,ie.p=2,j=Ft,Ft|=4;try{g3(s,i,u)}finally{Ft=j,ie.p=g,Z.T=h}}Kr=1,$y(),Ky(),Qy()}}function $y(){if(Kr===1){Kr=0;var s=si,i=po,u=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||u){u=Z.T,Z.T=null;var h=ie.p;ie.p=2;var g=Ft;Ft|=4;try{Ry(i,s);var w=Kx,j=B1(s.containerInfo),P=w.focusedElem,J=w.selectionRange;if(j!==P&&P&&P.ownerDocument&&L1(P.ownerDocument.documentElement,P)){if(J!==null&&Eh(P)){var de=J.start,Te=J.end;if(Te===void 0&&(Te=de),"selectionStart"in P)P.selectionStart=de,P.selectionEnd=Math.min(Te,P.value.length);else{var Ae=P.ownerDocument||document,pe=Ae&&Ae.defaultView||window;if(pe.getSelection){var ve=pe.getSelection(),nt=P.textContent.length,et=Math.min(J.start,nt),Gt=J.end===void 0?et:Math.min(J.end,nt);!ve.extend&&et>Gt&&(j=Gt,Gt=et,et=j);var le=M1(P,et),se=M1(P,Gt);if(le&&se&&(ve.rangeCount!==1||ve.anchorNode!==le.node||ve.anchorOffset!==le.offset||ve.focusNode!==se.node||ve.focusOffset!==se.offset)){var fe=Ae.createRange();fe.setStart(le.node,le.offset),ve.removeAllRanges(),et>Gt?(ve.addRange(fe),ve.extend(se.node,se.offset)):(fe.setEnd(se.node,se.offset),ve.addRange(fe))}}}}for(Ae=[],ve=P;ve=ve.parentNode;)ve.nodeType===1&&Ae.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<Ae.length;P++){var Ce=Ae[P];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Nf=!!$x,Kx=$x=null}finally{Ft=g,ie.p=h,Z.T=u}}s.current=i,Kr=2}}function Ky(){if(Kr===2){Kr=0;var s=si,i=po,u=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||u){u=Z.T,Z.T=null;var h=ie.p;ie.p=2;var g=Ft;Ft|=4;try{Ny(s,i.alternate,i)}finally{Ft=g,ie.p=h,Z.T=u}}Kr=3}}function Qy(){if(Kr===4||Kr===3){Kr=0,Je();var s=si,i=po,u=go,h=Py;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Kr=5:(Kr=0,po=si=null,Zy(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(ni=null),xc(u),i=i.stateNode,ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(_r,i,void 0,(i.current.flags&128)===128)}catch{}if(h!==null){i=Z.T,g=ie.p,ie.p=2,Z.T=null;try{for(var w=s.onRecoverableError,j=0;j<h.length;j++){var P=h[j];w(P.value,{componentStack:P.stack})}}finally{Z.T=i,ie.p=g}}(go&3)!==0&&mf(),Yn(s),g=s.pendingLanes,(u&4194090)!==0&&(g&42)!==0?s===Mx?$c++:($c=0,Mx=s):$c=0,Kc(0)}}function Zy(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Ac(i)))}function mf(s){return $y(),Ky(),Qy(),Jy()}function Jy(){if(Kr!==5)return!1;var s=si,i=Fx;Fx=0;var u=xc(go),h=Z.T,g=ie.p;try{ie.p=32>u?32:u,Z.T=null,u=Ox,Ox=null;var w=si,j=go;if(Kr=0,po=si=null,go=0,(Ft&6)!==0)throw Error(a(331));var P=Ft;if(Ft|=4,Ly(w.current),Fy(w,w.current,j,u),Ft=P,Kc(0,!1),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(_r,w)}catch{}return!0}finally{ie.p=g,Z.T=h,Zy(s,i)}}function e2(s,i,u){i=en(u,i),i=hx(s.stateNode,i,2),s=$s(s,i,2),s!==null&&(Gi(s,2),Yn(s))}function Wt(s,i,u){if(s.tag===3)e2(s,s,u);else for(;i!==null;){if(i.tag===3){e2(i,s,u);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ni===null||!ni.has(h))){s=en(u,s),u=ny(2),h=$s(i,u,2),h!==null&&(sy(u,h,i,s),Gi(h,2),Yn(h));break}}i=i.return}}function Ix(s,i,u){var h=s.pingCache;if(h===null){h=s.pingCache=new b3;var g=new Set;h.set(i,g)}else g=h.get(i),g===void 0&&(g=new Set,h.set(i,g));g.has(u)||(Ax=!0,g.add(u),s=k3.bind(null,s,i,u),i.then(s,s))}function k3(s,i,u){var h=s.pingCache;h!==null&&h.delete(i),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Zt===s&&(_t&u)===u&&(dr===4||dr===3&&(_t&62914560)===_t&&300>Oe()-Dx?(Ft&2)===0&&vo(s,0):jx|=u,mo===_t&&(mo=0)),Yn(s)}function t2(s,i){i===0&&(i=fc()),s=Jl(s,i),s!==null&&(Gi(s,i),Yn(s))}function T3(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),t2(s,u)}function N3(s,i){var u=0;switch(s.tag){case 13:var h=s.stateNode,g=s.memoizedState;g!==null&&(u=g.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(a(314))}h!==null&&h.delete(i),t2(s,u)}function C3(s,i){return We(s,i)}var pf=null,bo=null,Ux=!1,gf=!1,zx=!1,il=0;function Yn(s){s!==bo&&s.next===null&&(bo===null?pf=bo=s:bo=bo.next=s),gf=!0,Ux||(Ux=!0,j3())}function Kc(s,i){if(!zx&&gf){zx=!0;do for(var u=!1,h=pf;h!==null;){if(s!==0){var g=h.pendingLanes;if(g===0)var w=0;else{var j=h.suspendedLanes,P=h.pingedLanes;w=(1<<31-De(42|s)+1)-1,w&=g&~(j&~P),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,s2(h,w))}else w=_t,w=os(h,h===Zt?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Hn(h,w)||(u=!0,s2(h,w));h=h.next}while(u);zx=!1}}function A3(){r2()}function r2(){gf=Ux=!1;var s=0;il!==0&&(P3()&&(s=il),il=0);for(var i=Oe(),u=null,h=pf;h!==null;){var g=h.next,w=a2(h,i);w===0?(h.next=null,u===null?pf=g:u.next=g,g===null&&(bo=u)):(u=h,(s!==0||(w&3)!==0)&&(gf=!0)),h=g}Kc(s)}function a2(s,i){for(var u=s.suspendedLanes,h=s.pingedLanes,g=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var j=31-De(w),P=1<<j,J=g[j];J===-1?((P&u)===0||(P&h)!==0)&&(g[j]=Hi(P,i)):J<=i&&(s.expiredLanes|=P),w&=~P}if(i=Zt,u=_t,u=os(s,s===i?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===i&&(Ot===2||Ot===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&$e(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Hn(s,u)){if(i=u&-u,i===s.callbackPriority)return i;switch(h!==null&&$e(h),xc(u)){case 2:case 8:u=Rr;break;case 32:u=St;break;case 268435456:u=ha;break;default:u=St}return h=n2.bind(null,s),u=We(u,h),s.callbackPriority=i,s.callbackNode=u,i}return h!==null&&h!==null&&$e(h),s.callbackPriority=2,s.callbackNode=null,2}function n2(s,i){if(Kr!==0&&Kr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(mf()&&s.callbackNode!==u)return null;var h=_t;return h=os(s,s===Zt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(Uy(s,h,i),a2(s,Oe()),s.callbackNode!=null&&s.callbackNode===u?n2.bind(null,s):null)}function s2(s,i){if(mf())return null;Uy(s,i,!0)}function j3(){U3(function(){(Ft&6)!==0?We(Pt,A3):r2()})}function Hx(){return il===0&&(il=Hs()),il}function i2(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Nu(""+s)}function l2(s,i){var u=i.ownerDocument.createElement("input");return u.name=i.name,u.value=i.value,s.id&&u.setAttribute("form",s.id),i.parentNode.insertBefore(u,i),s=new FormData(s),u.parentNode.removeChild(u),s}function R3(s,i,u,h,g){if(i==="submit"&&u&&u.stateNode===g){var w=i2((g[Ur]||null).action),j=h.submitter;j&&(i=(i=j[Ur]||null)?i2(i.formAction):j.getAttribute("formAction"),i!==null&&(w=i,j=null));var P=new Ru("action","action",null,h,g);s.push({event:P,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(il!==0){var J=j?l2(g,j):new FormData(g);ox(u,{pending:!0,data:J,method:g.method,action:w},null,J)}}else typeof w=="function"&&(P.preventDefault(),J=j?l2(g,j):new FormData(g),ox(u,{pending:!0,data:J,method:g.method,action:w},w,J))},currentTarget:g}]})}}for(var Gx=0;Gx<Nh.length;Gx++){var Vx=Nh[Gx],D3=Vx.toLowerCase(),F3=Vx[0].toUpperCase()+Vx.slice(1);_n(D3,"on"+F3)}_n(U1,"onAnimationEnd"),_n(z1,"onAnimationIteration"),_n(H1,"onAnimationStart"),_n("dblclick","onDoubleClick"),_n("focusin","onFocus"),_n("focusout","onBlur"),_n(Kk,"onTransitionRun"),_n(Qk,"onTransitionStart"),_n(Zk,"onTransitionCancel"),_n(G1,"onTransitionEnd"),Pe("onMouseEnter",["mouseout","mouseover"]),Pe("onMouseLeave",["mouseout","mouseover"]),Pe("onPointerEnter",["pointerout","pointerover"]),Pe("onPointerLeave",["pointerout","pointerover"]),Fe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qc));function o2(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],g=h.event;h=h.listeners;e:{var w=void 0;if(i)for(var j=h.length-1;0<=j;j--){var P=h[j],J=P.instance,de=P.currentTarget;if(P=P.listener,J!==w&&g.isPropagationStopped())break e;w=P,g.currentTarget=de;try{w(g)}catch(Te){af(Te)}g.currentTarget=null,w=J}else for(j=0;j<h.length;j++){if(P=h[j],J=P.instance,de=P.currentTarget,P=P.listener,J!==w&&g.isPropagationStopped())break e;w=P,g.currentTarget=de;try{w(g)}catch(Te){af(Te)}g.currentTarget=null,w=J}}}}function yt(s,i){var u=i[mc];u===void 0&&(u=i[mc]=new Set);var h=s+"__bubble";u.has(h)||(c2(i,s,2,!1),u.add(h))}function qx(s,i,u){var h=0;i&&(h|=4),c2(u,s,h,i)}var vf="_reactListening"+Math.random().toString(36).slice(2);function Wx(s){if(!s[vf]){s[vf]=!0,me.forEach(function(u){u!=="selectionchange"&&(O3.has(u)||qx(u,!1,s),qx(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[vf]||(i[vf]=!0,qx("selectionchange",!1,i))}}function c2(s,i,u,h){switch(F2(i)){case 2:var g=lT;break;case 8:g=oT;break;default:g=im}u=g.bind(null,i,u,s),g=void 0,!xh||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),h?g!==void 0?s.addEventListener(i,u,{capture:!0,passive:g}):s.addEventListener(i,u,!0):g!==void 0?s.addEventListener(i,u,{passive:g}):s.addEventListener(i,u,!1)}function Xx(s,i,u,h,g){var w=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var j=h.tag;if(j===3||j===4){var P=h.stateNode.containerInfo;if(P===g)break;if(j===4)for(j=h.return;j!==null;){var J=j.tag;if((J===3||J===4)&&j.stateNode.containerInfo===g)return;j=j.return}for(;P!==null;){if(j=Y(P),j===null)return;if(J=j.tag,J===5||J===6||J===26||J===27){h=w=j;continue e}P=P.parentNode}}h=h.return}p1(function(){var de=w,Te=dh(u),Ae=[];e:{var pe=V1.get(s);if(pe!==void 0){var ve=Ru,nt=s;switch(s){case"keypress":if(Au(u)===0)break e;case"keydown":case"keyup":ve=Ck;break;case"focusin":nt="focus",ve=vh;break;case"focusout":nt="blur",ve=vh;break;case"beforeblur":case"afterblur":ve=vh;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=y1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=pk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=Rk;break;case U1:case z1:case H1:ve=yk;break;case G1:ve=Fk;break;case"scroll":case"scrollend":ve=xk;break;case"wheel":ve=Mk;break;case"copy":case"cut":case"paste":ve=wk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=w1;break;case"toggle":case"beforetoggle":ve=Bk}var et=(i&4)!==0,Gt=!et&&(s==="scroll"||s==="scrollend"),le=et?pe!==null?pe+"Capture":null:pe;et=[];for(var se=de,fe;se!==null;){var Ce=se;if(fe=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||fe===null||le===null||(Ce=pc(se,le),Ce!=null&&et.push(Zc(se,Ce,fe))),Gt)break;se=se.return}0<et.length&&(pe=new ve(pe,nt,null,u,Te),Ae.push({event:pe,listeners:et}))}}if((i&7)===0){e:{if(pe=s==="mouseover"||s==="pointerover",ve=s==="mouseout"||s==="pointerout",pe&&u!==fh&&(nt=u.relatedTarget||u.fromElement)&&(Y(nt)||nt[Gs]))break e;if((ve||pe)&&(pe=Te.window===Te?Te:(pe=Te.ownerDocument)?pe.defaultView||pe.parentWindow:window,ve?(nt=u.relatedTarget||u.toElement,ve=de,nt=nt?Y(nt):null,nt!==null&&(Gt=l(nt),et=nt.tag,nt!==Gt||et!==5&&et!==27&&et!==6)&&(nt=null)):(ve=null,nt=de),ve!==nt)){if(et=y1,Ce="onMouseLeave",le="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(et=w1,Ce="onPointerLeave",le="onPointerEnter",se="pointer"),Gt=ve==null?pe:he(ve),fe=nt==null?pe:he(nt),pe=new et(Ce,se+"leave",ve,u,Te),pe.target=Gt,pe.relatedTarget=fe,Ce=null,Y(Te)===de&&(et=new et(le,se+"enter",nt,u,Te),et.target=fe,et.relatedTarget=Gt,Ce=et),Gt=Ce,ve&&nt)t:{for(et=ve,le=nt,se=0,fe=et;fe;fe=wo(fe))se++;for(fe=0,Ce=le;Ce;Ce=wo(Ce))fe++;for(;0<se-fe;)et=wo(et),se--;for(;0<fe-se;)le=wo(le),fe--;for(;se--;){if(et===le||le!==null&&et===le.alternate)break t;et=wo(et),le=wo(le)}et=null}else et=null;ve!==null&&u2(Ae,pe,ve,et,!1),nt!==null&&Gt!==null&&u2(Ae,Gt,nt,et,!0)}}e:{if(pe=de?he(de):window,ve=pe.nodeName&&pe.nodeName.toLowerCase(),ve==="select"||ve==="input"&&pe.type==="file")var qe=A1;else if(N1(pe))if(j1)qe=Xk;else{qe=qk;var pt=Vk}else ve=pe.nodeName,!ve||ve.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?de&&uh(de.elementType)&&(qe=A1):qe=Wk;if(qe&&(qe=qe(s,de))){C1(Ae,qe,u,Te);break e}pt&&pt(s,pe,de),s==="focusout"&&de&&pe.type==="number"&&de.memoizedProps.value!=null&&ch(pe,"number",pe.value)}switch(pt=de?he(de):window,s){case"focusin":(N1(pt)||pt.contentEditable==="true")&&(Kl=pt,_h=de,_c=null);break;case"focusout":_c=_h=Kl=null;break;case"mousedown":kh=!0;break;case"contextmenu":case"mouseup":case"dragend":kh=!1,P1(Ae,u,Te);break;case"selectionchange":if($k)break;case"keydown":case"keyup":P1(Ae,u,Te)}var Ye;if(bh)e:{switch(s){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else $l?k1(s,u)&&(tt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(tt="onCompositionStart");tt&&(S1&&u.locale!=="ko"&&($l||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&$l&&(Ye=g1()):(qs=Te,mh="value"in qs?qs.value:qs.textContent,$l=!0)),pt=yf(de,tt),0<pt.length&&(tt=new b1(tt,s,null,u,Te),Ae.push({event:tt,listeners:pt}),Ye?tt.data=Ye:(Ye=T1(u),Ye!==null&&(tt.data=Ye)))),(Ye=Ik?Uk(s,u):zk(s,u))&&(tt=yf(de,"onBeforeInput"),0<tt.length&&(pt=new b1("onBeforeInput","beforeinput",null,u,Te),Ae.push({event:pt,listeners:tt}),pt.data=Ye)),R3(Ae,s,de,u,Te)}o2(Ae,i)})}function Zc(s,i,u){return{instance:s,listener:i,currentTarget:u}}function yf(s,i){for(var u=i+"Capture",h=[];s!==null;){var g=s,w=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||w===null||(g=pc(s,u),g!=null&&h.unshift(Zc(s,g,w)),g=pc(s,i),g!=null&&h.push(Zc(s,g,w))),s.tag===3)return h;s=s.return}return[]}function wo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function u2(s,i,u,h,g){for(var w=i._reactName,j=[];u!==null&&u!==h;){var P=u,J=P.alternate,de=P.stateNode;if(P=P.tag,J!==null&&J===h)break;P!==5&&P!==26&&P!==27||de===null||(J=de,g?(de=pc(u,w),de!=null&&j.unshift(Zc(u,de,J))):g||(de=pc(u,w),de!=null&&j.push(Zc(u,de,J)))),u=u.return}j.length!==0&&s.push({event:i,listeners:j})}var M3=/\r\n?/g,L3=/\u0000|\uFFFD/g;function f2(s){return(typeof s=="string"?s:""+s).replace(M3,`
`).replace(L3,"")}function d2(s,i){return i=f2(i),f2(s)===i}function bf(){}function Ht(s,i,u,h,g,w){switch(u){case"children":typeof h=="string"?i==="body"||i==="textarea"&&h===""||Wl(s,h):(typeof h=="number"||typeof h=="bigint")&&i!=="body"&&Wl(s,""+h);break;case"className":Ut(s,"class",h);break;case"tabIndex":Ut(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Ut(s,u,h);break;case"style":x1(s,h,w);break;case"data":if(i!=="object"){Ut(s,"data",h);break}case"src":case"href":if(h===""&&(i!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Nu(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(i!=="input"&&Ht(s,i,"name",g.name,g,null),Ht(s,i,"formEncType",g.formEncType,g,null),Ht(s,i,"formMethod",g.formMethod,g,null),Ht(s,i,"formTarget",g.formTarget,g,null)):(Ht(s,i,"encType",g.encType,g,null),Ht(s,i,"method",g.method,g,null),Ht(s,i,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Nu(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=bf);break;case"onScroll":h!=null&&yt("scroll",s);break;case"onScrollEnd":h!=null&&yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=Nu(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":yt("beforetoggle",s),yt("toggle",s),It(s,"popover",h);break;case"xlinkActuate":Qt(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Qt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Qt(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Qt(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Qt(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Qt(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Qt(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Qt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Qt(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":It(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=dk.get(u)||u,It(s,u,h))}}function Yx(s,i,u,h,g,w){switch(u){case"style":x1(s,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(a(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"children":typeof h=="string"?Wl(s,h):(typeof h=="number"||typeof h=="bigint")&&Wl(s,""+h);break;case"onScroll":h!=null&&yt("scroll",s);break;case"onScrollEnd":h!=null&&yt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=bf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),i=u.slice(2,g?u.length-7:void 0),w=s[Ur]||null,w=w!=null?w[u]:null,typeof w=="function"&&s.removeEventListener(i,w,g),typeof h=="function")){typeof w!="function"&&w!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(i,h,g);break e}u in s?s[u]=h:h===!0?s.setAttribute(u,""):It(s,u,h)}}}function Qr(s,i,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",s),yt("load",s);var h=!1,g=!1,w;for(w in u)if(u.hasOwnProperty(w)){var j=u[w];if(j!=null)switch(w){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Ht(s,i,w,j,u,null)}}g&&Ht(s,i,"srcSet",u.srcSet,u,null),h&&Ht(s,i,"src",u.src,u,null);return;case"input":yt("invalid",s);var P=w=j=g=null,J=null,de=null;for(h in u)if(u.hasOwnProperty(h)){var Te=u[h];if(Te!=null)switch(h){case"name":g=Te;break;case"type":j=Te;break;case"checked":J=Te;break;case"defaultChecked":de=Te;break;case"value":w=Te;break;case"defaultValue":P=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(a(137,i));break;default:Ht(s,i,h,Te,u,null)}}u1(s,w,P,J,de,j,g,!1),ku(s);return;case"select":yt("invalid",s),h=j=w=null;for(g in u)if(u.hasOwnProperty(g)&&(P=u[g],P!=null))switch(g){case"value":w=P;break;case"defaultValue":j=P;break;case"multiple":h=P;default:Ht(s,i,g,P,u,null)}i=w,u=j,s.multiple=!!h,i!=null?ql(s,!!h,i,!1):u!=null&&ql(s,!!h,u,!0);return;case"textarea":yt("invalid",s),w=g=h=null;for(j in u)if(u.hasOwnProperty(j)&&(P=u[j],P!=null))switch(j){case"value":h=P;break;case"defaultValue":g=P;break;case"children":w=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(a(91));break;default:Ht(s,i,j,P,u,null)}d1(s,h,g,w),ku(s);return;case"option":for(J in u)if(u.hasOwnProperty(J)&&(h=u[J],h!=null))switch(J){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ht(s,i,J,h,u,null)}return;case"dialog":yt("beforetoggle",s),yt("toggle",s),yt("cancel",s),yt("close",s);break;case"iframe":case"object":yt("load",s);break;case"video":case"audio":for(h=0;h<Qc.length;h++)yt(Qc[h],s);break;case"image":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"embed":case"source":case"link":yt("error",s),yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in u)if(u.hasOwnProperty(de)&&(h=u[de],h!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Ht(s,i,de,h,u,null)}return;default:if(uh(i)){for(Te in u)u.hasOwnProperty(Te)&&(h=u[Te],h!==void 0&&Yx(s,i,Te,h,u,void 0));return}}for(P in u)u.hasOwnProperty(P)&&(h=u[P],h!=null&&Ht(s,i,P,h,u,null))}function B3(s,i,u,h){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,w=null,j=null,P=null,J=null,de=null,Te=null;for(ve in u){var Ae=u[ve];if(u.hasOwnProperty(ve)&&Ae!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":J=Ae;default:h.hasOwnProperty(ve)||Ht(s,i,ve,null,h,Ae)}}for(var pe in h){var ve=h[pe];if(Ae=u[pe],h.hasOwnProperty(pe)&&(ve!=null||Ae!=null))switch(pe){case"type":w=ve;break;case"name":g=ve;break;case"checked":de=ve;break;case"defaultChecked":Te=ve;break;case"value":j=ve;break;case"defaultValue":P=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(a(137,i));break;default:ve!==Ae&&Ht(s,i,pe,ve,h,Ae)}}oh(s,j,P,J,de,Te,w,g);return;case"select":ve=j=P=pe=null;for(w in u)if(J=u[w],u.hasOwnProperty(w)&&J!=null)switch(w){case"value":break;case"multiple":ve=J;default:h.hasOwnProperty(w)||Ht(s,i,w,null,h,J)}for(g in h)if(w=h[g],J=u[g],h.hasOwnProperty(g)&&(w!=null||J!=null))switch(g){case"value":pe=w;break;case"defaultValue":P=w;break;case"multiple":j=w;default:w!==J&&Ht(s,i,g,w,h,J)}i=P,u=j,h=ve,pe!=null?ql(s,!!u,pe,!1):!!h!=!!u&&(i!=null?ql(s,!!u,i,!0):ql(s,!!u,u?[]:"",!1));return;case"textarea":ve=pe=null;for(P in u)if(g=u[P],u.hasOwnProperty(P)&&g!=null&&!h.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:Ht(s,i,P,null,h,g)}for(j in h)if(g=h[j],w=u[j],h.hasOwnProperty(j)&&(g!=null||w!=null))switch(j){case"value":pe=g;break;case"defaultValue":ve=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(a(91));break;default:g!==w&&Ht(s,i,j,g,h,w)}f1(s,pe,ve);return;case"option":for(var nt in u)if(pe=u[nt],u.hasOwnProperty(nt)&&pe!=null&&!h.hasOwnProperty(nt))switch(nt){case"selected":s.selected=!1;break;default:Ht(s,i,nt,null,h,pe)}for(J in h)if(pe=h[J],ve=u[J],h.hasOwnProperty(J)&&pe!==ve&&(pe!=null||ve!=null))switch(J){case"selected":s.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:Ht(s,i,J,pe,h,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var et in u)pe=u[et],u.hasOwnProperty(et)&&pe!=null&&!h.hasOwnProperty(et)&&Ht(s,i,et,null,h,pe);for(de in h)if(pe=h[de],ve=u[de],h.hasOwnProperty(de)&&pe!==ve&&(pe!=null||ve!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,i));break;default:Ht(s,i,de,pe,h,ve)}return;default:if(uh(i)){for(var Gt in u)pe=u[Gt],u.hasOwnProperty(Gt)&&pe!==void 0&&!h.hasOwnProperty(Gt)&&Yx(s,i,Gt,void 0,h,pe);for(Te in h)pe=h[Te],ve=u[Te],!h.hasOwnProperty(Te)||pe===ve||pe===void 0&&ve===void 0||Yx(s,i,Te,pe,h,ve);return}}for(var le in u)pe=u[le],u.hasOwnProperty(le)&&pe!=null&&!h.hasOwnProperty(le)&&Ht(s,i,le,null,h,pe);for(Ae in h)pe=h[Ae],ve=u[Ae],!h.hasOwnProperty(Ae)||pe===ve||pe==null&&ve==null||Ht(s,i,Ae,pe,h,ve)}var $x=null,Kx=null;function wf(s){return s.nodeType===9?s:s.ownerDocument}function h2(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function x2(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Qx(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Zx=null;function P3(){var s=window.event;return s&&s.type==="popstate"?s===Zx?!1:(Zx=s,!0):(Zx=null,!1)}var m2=typeof setTimeout=="function"?setTimeout:void 0,I3=typeof clearTimeout=="function"?clearTimeout:void 0,p2=typeof Promise=="function"?Promise:void 0,U3=typeof queueMicrotask=="function"?queueMicrotask:typeof p2<"u"?function(s){return p2.resolve(null).then(s).catch(z3)}:m2;function z3(s){setTimeout(function(){throw s})}function li(s){return s==="head"}function g2(s,i){var u=i,h=0,g=0;do{var w=u.nextSibling;if(s.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"){if(0<h&&8>h){u=h;var j=s.ownerDocument;if(u&1&&Jc(j.documentElement),u&2&&Jc(j.body),u&4)for(u=j.head,Jc(u),j=u.firstChild;j;){var P=j.nextSibling,J=j.nodeName;j[H]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&j.rel.toLowerCase()==="stylesheet"||u.removeChild(j),j=P}}if(g===0){s.removeChild(w),l0(i);return}g--}else u==="$"||u==="$?"||u==="$!"?g++:h=u.charCodeAt(0)-48;else h=0;u=w}while(u);l0(i)}function Jx(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var u=i;switch(i=i.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Jx(u),G(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function H3(s,i,u,h){for(;s.nodeType===1;){var g=u;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[H])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var w=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=Tn(s.nextSibling),s===null)break}return null}function G3(s,i,u){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Tn(s.nextSibling),s===null))return null;return s}function em(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function V3(s,i){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")i();else{var h=function(){i(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Tn(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var tm=null;function v2(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}function y2(s,i,u){switch(i=wf(u),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function Jc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);G(s)}var ln=new Map,b2=new Set;function Sf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Es=ie.d;ie.d={f:q3,r:W3,D:X3,C:Y3,L:$3,m:K3,X:Z3,S:Q3,M:J3};function q3(){var s=Es.f(),i=hf();return s||i}function W3(s){var i=Q(s);i!==null&&i.tag===5&&i.type==="form"?Uv(i):Es.r(s)}var So=typeof document>"u"?null:document;function w2(s,i,u){var h=So;if(h&&typeof i=="string"&&i){var g=Ja(i);g='link[rel="'+s+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),b2.has(g)||(b2.add(g),s={rel:s,crossOrigin:u,href:i},h.querySelector(g)===null&&(i=h.createElement("link"),Qr(i,"link",s),ue(i),h.head.appendChild(i)))}}function X3(s){Es.D(s),w2("dns-prefetch",s,null)}function Y3(s,i){Es.C(s,i),w2("preconnect",s,i)}function $3(s,i,u){Es.L(s,i,u);var h=So;if(h&&s&&i){var g='link[rel="preload"][as="'+Ja(i)+'"]';i==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+Ja(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+Ja(u.imageSizes)+'"]')):g+='[href="'+Ja(s)+'"]';var w=g;switch(i){case"style":w=Eo(s);break;case"script":w=_o(s)}ln.has(w)||(s=m({rel:"preload",href:i==="image"&&u&&u.imageSrcSet?void 0:s,as:i},u),ln.set(w,s),h.querySelector(g)!==null||i==="style"&&h.querySelector(e0(w))||i==="script"&&h.querySelector(t0(w))||(i=h.createElement("link"),Qr(i,"link",s),ue(i),h.head.appendChild(i)))}}function K3(s,i){Es.m(s,i);var u=So;if(u&&s){var h=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+Ja(h)+'"][href="'+Ja(s)+'"]',w=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=_o(s)}if(!ln.has(w)&&(s=m({rel:"modulepreload",href:s},i),ln.set(w,s),u.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(t0(w)))return}h=u.createElement("link"),Qr(h,"link",s),ue(h),u.head.appendChild(h)}}}function Q3(s,i,u){Es.S(s,i,u);var h=So;if(h&&s){var g=Ee(h).hoistableStyles,w=Eo(s);i=i||"default";var j=g.get(w);if(!j){var P={loading:0,preload:null};if(j=h.querySelector(e0(w)))P.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":i},u),(u=ln.get(w))&&rm(s,u);var J=j=h.createElement("link");ue(J),Qr(J,"link",s),J._p=new Promise(function(de,Te){J.onload=de,J.onerror=Te}),J.addEventListener("load",function(){P.loading|=1}),J.addEventListener("error",function(){P.loading|=2}),P.loading|=4,Ef(j,i,h)}j={type:"stylesheet",instance:j,count:1,state:P},g.set(w,j)}}}function Z3(s,i){Es.X(s,i);var u=So;if(u&&s){var h=Ee(u).hoistableScripts,g=_o(s),w=h.get(g);w||(w=u.querySelector(t0(g)),w||(s=m({src:s,async:!0},i),(i=ln.get(g))&&am(s,i),w=u.createElement("script"),ue(w),Qr(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(g,w))}}function J3(s,i){Es.M(s,i);var u=So;if(u&&s){var h=Ee(u).hoistableScripts,g=_o(s),w=h.get(g);w||(w=u.querySelector(t0(g)),w||(s=m({src:s,async:!0,type:"module"},i),(i=ln.get(g))&&am(s,i),w=u.createElement("script"),ue(w),Qr(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(g,w))}}function S2(s,i,u,h){var g=(g=ne.current)?Sf(g):null;if(!g)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(i=Eo(u.href),u=Ee(g).hoistableStyles,h=u.get(i),h||(h={type:"style",instance:null,count:0,state:null},u.set(i,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Eo(u.href);var w=Ee(g).hoistableStyles,j=w.get(s);if(j||(g=g.ownerDocument||g,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,j),(w=g.querySelector(e0(s)))&&!w._p&&(j.instance=w,j.state.loading=5),ln.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ln.set(s,u),w||eT(g,s,u,j.state))),i&&h===null)throw Error(a(528,""));return j}if(i&&h!==null)throw Error(a(529,""));return null;case"script":return i=u.async,u=u.src,typeof u=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=_o(u),u=Ee(g).hoistableScripts,h=u.get(i),h||(h={type:"script",instance:null,count:0,state:null},u.set(i,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Eo(s){return'href="'+Ja(s)+'"'}function e0(s){return'link[rel="stylesheet"]['+s+"]"}function E2(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function eT(s,i,u,h){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?h.loading=1:(i=s.createElement("link"),h.preload=i,i.addEventListener("load",function(){return h.loading|=1}),i.addEventListener("error",function(){return h.loading|=2}),Qr(i,"link",u),ue(i),s.head.appendChild(i))}function _o(s){return'[src="'+Ja(s)+'"]'}function t0(s){return"script[async]"+s}function _2(s,i,u){if(i.count++,i.instance===null)switch(i.type){case"style":var h=s.querySelector('style[data-href~="'+Ja(u.href)+'"]');if(h)return i.instance=h,ue(h),h;var g=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),ue(h),Qr(h,"style",g),Ef(h,u.precedence,s),i.instance=h;case"stylesheet":g=Eo(u.href);var w=s.querySelector(e0(g));if(w)return i.state.loading|=4,i.instance=w,ue(w),w;h=E2(u),(g=ln.get(g))&&rm(h,g),w=(s.ownerDocument||s).createElement("link"),ue(w);var j=w;return j._p=new Promise(function(P,J){j.onload=P,j.onerror=J}),Qr(w,"link",h),i.state.loading|=4,Ef(w,u.precedence,s),i.instance=w;case"script":return w=_o(u.src),(g=s.querySelector(t0(w)))?(i.instance=g,ue(g),g):(h=u,(g=ln.get(w))&&(h=m({},u),am(h,g)),s=s.ownerDocument||s,g=s.createElement("script"),ue(g),Qr(g,"link",h),s.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(h=i.instance,i.state.loading|=4,Ef(h,u.precedence,s));return i.instance}function Ef(s,i,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,w=g,j=0;j<h.length;j++){var P=h[j];if(P.dataset.precedence===i)w=P;else if(w!==g)break}w?w.parentNode.insertBefore(s,w.nextSibling):(i=u.nodeType===9?u.head:u,i.insertBefore(s,i.firstChild))}function rm(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function am(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var _f=null;function k2(s,i,u){if(_f===null){var h=new Map,g=_f=new Map;g.set(u,h)}else g=_f,h=g.get(u),h||(h=new Map,g.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),g=0;g<u.length;g++){var w=u[g];if(!(w[H]||w[Ir]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var j=w.getAttribute(i)||"";j=s+j;var P=h.get(j);P?P.push(w):h.set(j,[w])}}return h}function T2(s,i,u){s=s.ownerDocument||s,s.head.insertBefore(u,i==="title"?s.querySelector("head > title"):null)}function tT(s,i,u){if(u===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function N2(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var r0=null;function rT(){}function aT(s,i,u){if(r0===null)throw Error(a(475));var h=r0;if(i.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var g=Eo(u.href),w=s.querySelector(e0(g));if(w){s=w._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(h.count++,h=kf.bind(h),s.then(h,h)),i.state.loading|=4,i.instance=w,ue(w);return}w=s.ownerDocument||s,u=E2(u),(g=ln.get(g))&&rm(u,g),w=w.createElement("link"),ue(w);var j=w;j._p=new Promise(function(P,J){j.onload=P,j.onerror=J}),Qr(w,"link",u),i.instance=w}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(h.count++,i=kf.bind(h),s.addEventListener("load",i),s.addEventListener("error",i))}}function nT(){if(r0===null)throw Error(a(475));var s=r0;return s.stylesheets&&s.count===0&&nm(s,s.stylesheets),0<s.count?function(i){var u=setTimeout(function(){if(s.stylesheets&&nm(s,s.stylesheets),s.unsuspend){var h=s.unsuspend;s.unsuspend=null,h()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(u)}}:null}function kf(){if(this.count--,this.count===0){if(this.stylesheets)nm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Tf=null;function nm(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Tf=new Map,i.forEach(sT,s),Tf=null,kf.call(s))}function sT(s,i){if(!(i.state.loading&4)){var u=Tf.get(s);if(u)var h=u.get(null);else{u=new Map,Tf.set(s,u);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<g.length;w++){var j=g[w];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(u.set(j.dataset.precedence,j),h=j)}h&&u.set(null,h)}g=i.instance,j=g.getAttribute("data-precedence"),w=u.get(j)||h,w===h&&u.set(null,g),u.set(j,g),this.count++,h=kf.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),w?w.parentNode.insertBefore(g,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),i.state.loading|=4}}var a0={$$typeof:k,Provider:null,Consumer:null,_currentValue:ke,_currentValue2:ke,_threadCount:0};function iT(s,i,u,h,g,w,j,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dc(0),this.hiddenUpdates=dc(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=w,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function C2(s,i,u,h,g,w,j,P,J,de,Te,Ae){return s=new iT(s,i,u,j,P,J,de,Ae),i=1,w===!0&&(i|=24),w=Pa(3,null,null,i),s.current=w,w.stateNode=s,i=Ih(),i.refCount++,s.pooledCache=i,i.refCount++,w.memoizedState={element:h,isDehydrated:u,cache:i},Gh(w),s}function A2(s){return s?(s=eo,s):eo}function j2(s,i,u,h,g,w){g=A2(g),h.context===null?h.context=g:h.pendingContext=g,h=Ys(i),h.payload={element:u},w=w===void 0?null:w,w!==null&&(h.callback=w),u=$s(s,h,i),u!==null&&(Ga(u,s,i),Fc(u,s,i))}function R2(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function sm(s,i){R2(s,i),(s=s.alternate)&&R2(s,i)}function D2(s){if(s.tag===13){var i=Jl(s,67108864);i!==null&&Ga(i,s,67108864),sm(s,67108864)}}var Nf=!0;function lT(s,i,u,h){var g=Z.T;Z.T=null;var w=ie.p;try{ie.p=2,im(s,i,u,h)}finally{ie.p=w,Z.T=g}}function oT(s,i,u,h){var g=Z.T;Z.T=null;var w=ie.p;try{ie.p=8,im(s,i,u,h)}finally{ie.p=w,Z.T=g}}function im(s,i,u,h){if(Nf){var g=lm(h);if(g===null)Xx(s,i,h,Cf,u),O2(s,h);else if(uT(g,s,i,u,h))h.stopPropagation();else if(O2(s,h),i&4&&-1<cT.indexOf(s)){for(;g!==null;){var w=Q(g);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var j=Dr(w.pendingLanes);if(j!==0){var P=w;for(P.pendingLanes|=2,P.entangledLanes|=2;j;){var J=1<<31-De(j);P.entanglements[1]|=J,j&=~J}Yn(w),(Ft&6)===0&&(ff=Oe()+500,Kc(0))}}break;case 13:P=Jl(w,2),P!==null&&Ga(P,w,2),hf(),sm(w,2)}if(w=lm(h),w===null&&Xx(s,i,h,Cf,u),w===g)break;g=w}g!==null&&h.stopPropagation()}else Xx(s,i,h,null,u)}}function lm(s){return s=dh(s),om(s)}var Cf=null;function om(s){if(Cf=null,s=Y(s),s!==null){var i=l(s);if(i===null)s=null;else{var u=i.tag;if(u===13){if(s=o(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Cf=s,null}function F2(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ct()){case Pt:return 2;case Rr:return 8;case St:case wn:return 32;case ha:return 268435456;default:return 32}default:return 32}}var cm=!1,oi=null,ci=null,ui=null,n0=new Map,s0=new Map,fi=[],cT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function O2(s,i){switch(s){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":ci=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":n0.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":s0.delete(i.pointerId)}}function i0(s,i,u,h,g,w){return s===null||s.nativeEvent!==w?(s={blockedOn:i,domEventName:u,eventSystemFlags:h,nativeEvent:w,targetContainers:[g]},i!==null&&(i=Q(i),i!==null&&D2(i)),s):(s.eventSystemFlags|=h,i=s.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),s)}function uT(s,i,u,h,g){switch(i){case"focusin":return oi=i0(oi,s,i,u,h,g),!0;case"dragenter":return ci=i0(ci,s,i,u,h,g),!0;case"mouseover":return ui=i0(ui,s,i,u,h,g),!0;case"pointerover":var w=g.pointerId;return n0.set(w,i0(n0.get(w)||null,s,i,u,h,g)),!0;case"gotpointercapture":return w=g.pointerId,s0.set(w,i0(s0.get(w)||null,s,i,u,h,g)),!0}return!1}function M2(s){var i=Y(s.target);if(i!==null){var u=l(i);if(u!==null){if(i=u.tag,i===13){if(i=o(u),i!==null){s.blockedOn=i,ih(s.priority,function(){if(u.tag===13){var h=Ha();h=hc(h);var g=Jl(u,h);g!==null&&Ga(g,u,h),sm(u,h)}});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Af(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=lm(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);fh=h,u.target.dispatchEvent(h),fh=null}else return i=Q(u),i!==null&&D2(i),s.blockedOn=u,!1;i.shift()}return!0}function L2(s,i,u){Af(s)&&u.delete(i)}function fT(){cm=!1,oi!==null&&Af(oi)&&(oi=null),ci!==null&&Af(ci)&&(ci=null),ui!==null&&Af(ui)&&(ui=null),n0.forEach(L2),s0.forEach(L2)}function jf(s,i){s.blockedOn===i&&(s.blockedOn=null,cm||(cm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,fT)))}var Rf=null;function B2(s){Rf!==s&&(Rf=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Rf===s&&(Rf=null);for(var i=0;i<s.length;i+=3){var u=s[i],h=s[i+1],g=s[i+2];if(typeof h!="function"){if(om(h||u)===null)continue;break}var w=Q(u);w!==null&&(s.splice(i,3),i-=3,ox(w,{pending:!0,data:g,method:u.method,action:h},h,g))}}))}function l0(s){function i(J){return jf(J,s)}oi!==null&&jf(oi,s),ci!==null&&jf(ci,s),ui!==null&&jf(ui,s),n0.forEach(i),s0.forEach(i);for(var u=0;u<fi.length;u++){var h=fi[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<fi.length&&(u=fi[0],u.blockedOn===null);)M2(u),u.blockedOn===null&&fi.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var g=u[h],w=u[h+1],j=g[Ur]||null;if(typeof w=="function")j||B2(u);else if(j){var P=null;if(w&&w.hasAttribute("formAction")){if(g=w,j=w[Ur]||null)P=j.formAction;else if(om(g)!==null)continue}else P=j.action;typeof P=="function"?u[h+1]=P:(u.splice(h,3),h-=3),B2(u)}}}function um(s){this._internalRoot=s}Df.prototype.render=um.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var u=i.current,h=Ha();j2(u,h,s,i,null,null)},Df.prototype.unmount=um.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;j2(s.current,2,null,s,null,null),hf(),i[Gs]=null}};function Df(s){this._internalRoot=s}Df.prototype.unstable_scheduleHydration=function(s){if(s){var i=_u();s={blockedOn:null,target:s,priority:i};for(var u=0;u<fi.length&&i!==0&&i<fi[u].priority;u++);fi.splice(u,0,s),u===0&&M2(s)}};var P2=t.version;if(P2!=="19.1.0")throw Error(a(527,P2,"19.1.0"));ie.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=d(i),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var dT={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{_r=Ff.inject(dT),ir=Ff}catch{}}return c0.createRoot=function(s,i){if(!n(s))throw Error(a(299));var u=!1,h="",g=ey,w=ty,j=ry,P=null;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(w=i.onCaughtError),i.onRecoverableError!==void 0&&(j=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(P=i.unstable_transitionCallbacks)),i=C2(s,1,!1,null,null,u,h,g,w,j,P,null),s[Gs]=i.current,Wx(s),new um(i)},c0.hydrateRoot=function(s,i,u){if(!n(s))throw Error(a(299));var h=!1,g="",w=ey,j=ty,P=ry,J=null,de=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(j=u.onCaughtError),u.onRecoverableError!==void 0&&(P=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(J=u.unstable_transitionCallbacks),u.formState!==void 0&&(de=u.formState)),i=C2(s,1,!0,i,u??null,h,g,w,j,P,J,de),i.context=A2(null),u=i.current,h=Ha(),h=hc(h),g=Ys(h),g.callback=null,$s(u,g,h),u=h,i.current.lanes=u,Gi(i,u),Yn(i),s[Gs]=i.current,Wx(s),new Df(i)},c0.version="19.1.0",c0}var $2;function ST(){if($2)return xm.exports;$2=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xm.exports=wT(),xm.exports}var ET=ST(),u0={},K2;function _T(){if(K2)return u0;K2=1,Object.defineProperty(u0,"__esModule",{value:!0}),u0.parse=o,u0.serialize=x;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,l=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,y){const b=new l,S=v.length;if(S<2)return b;const E=(y==null?void 0:y.decode)||m;let _=0;do{const N=v.indexOf("=",_);if(N===-1)break;const k=v.indexOf(";",_),R=k===-1?S:k;if(N>R){_=v.lastIndexOf(";",N-1)+1;continue}const A=f(v,_,N),D=d(v,N,A),T=v.slice(A,D);if(b[T]===void 0){let O=f(v,N+1,R),F=d(v,R,O);const q=E(v.slice(O,F));b[T]=q}_=R+1}while(_<S);return b}function f(v,y,b){do{const S=v.charCodeAt(y);if(S!==32&&S!==9)return y}while(++y<b);return b}function d(v,y,b){for(;y>b;){const S=v.charCodeAt(--y);if(S!==32&&S!==9)return y+1}return b}function x(v,y,b){const S=(b==null?void 0:b.encode)||encodeURIComponent;if(!e.test(v))throw new TypeError(`argument name is invalid: ${v}`);const E=S(y);if(!t.test(E))throw new TypeError(`argument val is invalid: ${y}`);let _=v+"="+E;if(!b)return _;if(b.maxAge!==void 0){if(!Number.isInteger(b.maxAge))throw new TypeError(`option maxAge is invalid: ${b.maxAge}`);_+="; Max-Age="+b.maxAge}if(b.domain){if(!r.test(b.domain))throw new TypeError(`option domain is invalid: ${b.domain}`);_+="; Domain="+b.domain}if(b.path){if(!a.test(b.path))throw new TypeError(`option path is invalid: ${b.path}`);_+="; Path="+b.path}if(b.expires){if(!p(b.expires)||!Number.isFinite(b.expires.valueOf()))throw new TypeError(`option expires is invalid: ${b.expires}`);_+="; Expires="+b.expires.toUTCString()}if(b.httpOnly&&(_+="; HttpOnly"),b.secure&&(_+="; Secure"),b.partitioned&&(_+="; Partitioned"),b.priority)switch(typeof b.priority=="string"?b.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${b.priority}`)}if(b.sameSite)switch(typeof b.sameSite=="string"?b.sameSite.toLowerCase():b.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${b.sameSite}`)}return _}function m(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function p(v){return n.call(v)==="[object Date]"}return u0}_T();var Q2="popstate";function kT(e={}){function t(a,n){let{pathname:l,search:o,hash:f}=a.location;return ap("",{pathname:l,search:o,hash:f},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:j0(n)}return NT(t,r,null,e)}function sr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function pn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function TT(){return Math.random().toString(36).substring(2,10)}function Z2(e,t){return{usr:e.state,key:e.key,idx:t}}function ap(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ec(t):t,state:r,key:t&&t.key||a||TT()}}function j0({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ec(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function NT(e,t,r,a={}){let{window:n=document.defaultView,v5Compat:l=!1}=a,o=n.history,f="POP",d=null,x=m();x==null&&(x=0,o.replaceState({...o.state,idx:x},""));function m(){return(o.state||{idx:null}).idx}function p(){f="POP";let E=m(),_=E==null?null:E-x;x=E,d&&d({action:f,location:S.location,delta:_})}function v(E,_){f="PUSH";let N=ap(S.location,E,_);x=m()+1;let k=Z2(N,x),R=S.createHref(N);try{o.pushState(k,"",R)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;n.location.assign(R)}l&&d&&d({action:f,location:S.location,delta:1})}function y(E,_){f="REPLACE";let N=ap(S.location,E,_);x=m();let k=Z2(N,x),R=S.createHref(N);o.replaceState(k,"",R),l&&d&&d({action:f,location:S.location,delta:0})}function b(E){return CT(E)}let S={get action(){return f},get location(){return e(n,o)},listen(E){if(d)throw new Error("A history only accepts one active listener");return n.addEventListener(Q2,p),d=E,()=>{n.removeEventListener(Q2,p),d=null}},createHref(E){return t(n,E)},createURL:b,encodeLocation(E){let _=b(E);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:v,replace:y,go(E){return o.go(E)}};return S}function CT(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),sr(r,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:j0(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function DS(e,t,r="/"){return AT(e,t,r,!1)}function AT(e,t,r,a){let n=typeof t=="string"?ec(t):t,l=Ls(n.pathname||"/",r);if(l==null)return null;let o=FS(e);jT(o);let f=null;for(let d=0;f==null&&d<o.length;++d){let x=zT(l);f=IT(o[d],x,a)}return f}function FS(e,t=[],r=[],a=""){let n=(l,o,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};d.relativePath.startsWith("/")&&(sr(d.relativePath.startsWith(a),`Absolute route path "${d.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(a.length));let x=Rs([a,d.relativePath]),m=r.concat(d);l.children&&l.children.length>0&&(sr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),FS(l.children,t,m,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:BT(x,l.index),routesMeta:m})};return e.forEach((l,o)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))n(l,o);else for(let d of OS(l.path))n(l,o,d)}),t}function OS(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),l=r.replace(/\?$/,"");if(a.length===0)return n?[l,""]:[l];let o=OS(a.join("/")),f=[];return f.push(...o.map(d=>d===""?l:[l,d].join("/"))),n&&f.push(...o),f.map(d=>e.startsWith("/")&&d===""?"/":d)}function jT(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:PT(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var RT=/^:[\w-]+$/,DT=3,FT=2,OT=1,MT=10,LT=-2,J2=e=>e==="*";function BT(e,t){let r=e.split("/"),a=r.length;return r.some(J2)&&(a+=LT),t&&(a+=FT),r.filter(n=>!J2(n)).reduce((n,l)=>n+(RT.test(l)?DT:l===""?OT:MT),a)}function PT(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function IT(e,t,r=!1){let{routesMeta:a}=e,n={},l="/",o=[];for(let f=0;f<a.length;++f){let d=a[f],x=f===a.length-1,m=l==="/"?t:t.slice(l.length)||"/",p=xd({path:d.relativePath,caseSensitive:d.caseSensitive,end:x},m),v=d.route;if(!p&&x&&r&&!a[a.length-1].route.index&&(p=xd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!p)return null;Object.assign(n,p.params),o.push({params:n,pathname:Rs([l,p.pathname]),pathnameBase:qT(Rs([l,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(l=Rs([l,p.pathnameBase]))}return o}function xd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=UT(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let l=n[0],o=l.replace(/(.)\/+$/,"$1"),f=n.slice(1);return{params:a.reduce((x,{paramName:m,isOptional:p},v)=>{if(m==="*"){let b=f[v]||"";o=l.slice(0,l.length-b.length).replace(/(.)\/+$/,"$1")}const y=f[v];return p&&!y?x[m]=void 0:x[m]=(y||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function UT(e,t=!1,r=!0){pn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,f,d)=>(a.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function zT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return pn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ls(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function HT(e,t="/"){let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?ec(e):e;return{pathname:r?r.startsWith("/")?r:GT(r,t):t,search:WT(a),hash:XT(n)}}function GT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function vm(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function VT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Wp(e){let t=VT(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function Xp(e,t,r,a=!1){let n;typeof e=="string"?n=ec(e):(n={...e},sr(!n.pathname||!n.pathname.includes("?"),vm("?","pathname","search",n)),sr(!n.pathname||!n.pathname.includes("#"),vm("#","pathname","hash",n)),sr(!n.search||!n.search.includes("#"),vm("#","search","hash",n)));let l=e===""||n.pathname==="",o=l?"/":n.pathname,f;if(o==null)f=r;else{let p=t.length-1;if(!a&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),p-=1;n.pathname=v.join("/")}f=p>=0?t[p]:"/"}let d=HT(n,f),x=o&&o!=="/"&&o.endsWith("/"),m=(l||o===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(x||m)&&(d.pathname+="/"),d}var Rs=e=>e.join("/").replace(/\/\/+/g,"/"),qT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),WT=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,XT=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function YT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var MS=["POST","PUT","PATCH","DELETE"];new Set(MS);var $T=["GET",...MS];new Set($T);var tc=C.createContext(null);tc.displayName="DataRouter";var Od=C.createContext(null);Od.displayName="DataRouterState";var LS=C.createContext({isTransitioning:!1});LS.displayName="ViewTransition";var KT=C.createContext(new Map);KT.displayName="Fetchers";var QT=C.createContext(null);QT.displayName="Await";var Pn=C.createContext(null);Pn.displayName="Navigation";var tu=C.createContext(null);tu.displayName="Location";var vn=C.createContext({outlet:null,matches:[],isDataRoute:!1});vn.displayName="Route";var Yp=C.createContext(null);Yp.displayName="RouteError";function ZT(e,{relative:t}={}){sr(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=C.useContext(Pn),{hash:n,pathname:l,search:o}=ru(e,{relative:t}),f=l;return r!=="/"&&(f=l==="/"?r:Rs([r,l])),a.createHref({pathname:f,search:o,hash:n})}function rc(){return C.useContext(tu)!=null}function ss(){return sr(rc(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(tu).location}var BS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function PS(e){C.useContext(Pn).static||C.useLayoutEffect(e)}function _a(){let{isDataRoute:e}=C.useContext(vn);return e?hN():JT()}function JT(){sr(rc(),"useNavigate() may be used only in the context of a <Router> component.");let e=C.useContext(tc),{basename:t,navigator:r}=C.useContext(Pn),{matches:a}=C.useContext(vn),{pathname:n}=ss(),l=JSON.stringify(Wp(a)),o=C.useRef(!1);return PS(()=>{o.current=!0}),C.useCallback((d,x={})=>{if(pn(o.current,BS),!o.current)return;if(typeof d=="number"){r.go(d);return}let m=Xp(d,JSON.parse(l),n,x.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Rs([t,m.pathname])),(x.replace?r.replace:r.push)(m,x.state,x)},[t,r,l,n,e])}var eN=C.createContext(null);function tN(e){let t=C.useContext(vn).outlet;return t&&C.createElement(eN.Provider,{value:e},t)}function yn(){let{matches:e}=C.useContext(vn),t=e[e.length-1];return t?t.params:{}}function ru(e,{relative:t}={}){let{matches:r}=C.useContext(vn),{pathname:a}=ss(),n=JSON.stringify(Wp(r));return C.useMemo(()=>Xp(e,JSON.parse(n),a,t==="path"),[e,n,a,t])}function rN(e,t){return IS(e,t)}function IS(e,t,r,a){var _;sr(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=C.useContext(Pn),{matches:l}=C.useContext(vn),o=l[l.length-1],f=o?o.params:{},d=o?o.pathname:"/",x=o?o.pathnameBase:"/",m=o&&o.route;{let N=m&&m.path||"";US(d,!m||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let p=ss(),v;if(t){let N=typeof t=="string"?ec(t):t;sr(x==="/"||((_=N.pathname)==null?void 0:_.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=p;let y=v.pathname||"/",b=y;if(x!=="/"){let N=x.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(N.length).join("/")}let S=DS(e,{pathname:b});pn(m||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),pn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=lN(S&&S.map(N=>Object.assign({},N,{params:Object.assign({},f,N.params),pathname:Rs([x,n.encodeLocation?n.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?x:Rs([x,n.encodeLocation?n.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),l,r,a);return t&&E?C.createElement(tu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function aN(){let e=dN(),t=YT(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:l},"ErrorBoundary")," or"," ",C.createElement("code",{style:l},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:n},r):null,o)}var nN=C.createElement(aN,null),sN=class extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(vn.Provider,{value:this.props.routeContext},C.createElement(Yp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function iN({routeContext:e,match:t,children:r}){let a=C.useContext(tc);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(vn.Provider,{value:e},r)}function lN(e,t=[],r=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,l=r==null?void 0:r.errors;if(l!=null){let d=n.findIndex(x=>x.route.id&&(l==null?void 0:l[x.route.id])!==void 0);sr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),n=n.slice(0,Math.min(n.length,d+1))}let o=!1,f=-1;if(r)for(let d=0;d<n.length;d++){let x=n[d];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=d),x.route.id){let{loaderData:m,errors:p}=r,v=x.route.loader&&!m.hasOwnProperty(x.route.id)&&(!p||p[x.route.id]===void 0);if(x.route.lazy||v){o=!0,f>=0?n=n.slice(0,f+1):n=[n[0]];break}}}return n.reduceRight((d,x,m)=>{let p,v=!1,y=null,b=null;r&&(p=l&&x.route.id?l[x.route.id]:void 0,y=x.route.errorElement||nN,o&&(f<0&&m===0?(US("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,b=null):f===m&&(v=!0,b=x.route.hydrateFallbackElement||null)));let S=t.concat(n.slice(0,m+1)),E=()=>{let _;return p?_=y:v?_=b:x.route.Component?_=C.createElement(x.route.Component,null):x.route.element?_=x.route.element:_=d,C.createElement(iN,{match:x,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:_})};return r&&(x.route.ErrorBoundary||x.route.errorElement||m===0)?C.createElement(sN,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:E(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):E()},null)}function $p(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oN(e){let t=C.useContext(tc);return sr(t,$p(e)),t}function cN(e){let t=C.useContext(Od);return sr(t,$p(e)),t}function uN(e){let t=C.useContext(vn);return sr(t,$p(e)),t}function Kp(e){let t=uN(e),r=t.matches[t.matches.length-1];return sr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function fN(){return Kp("useRouteId")}function dN(){var a;let e=C.useContext(Yp),t=cN("useRouteError"),r=Kp("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[r]}function hN(){let{router:e}=oN("useNavigate"),t=Kp("useNavigate"),r=C.useRef(!1);return PS(()=>{r.current=!0}),C.useCallback(async(n,l={})=>{pn(r.current,BS),r.current&&(typeof n=="number"?e.navigate(n):await e.navigate(n,{fromRouteId:t,...l}))},[e,t])}var eb={};function US(e,t,r){!t&&!eb[e]&&(eb[e]=!0,pn(!1,r))}C.memo(xN);function xN({routes:e,future:t,state:r}){return IS(e,void 0,r,t)}function ym({to:e,replace:t,state:r,relative:a}){sr(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=C.useContext(Pn);pn(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=C.useContext(vn),{pathname:o}=ss(),f=_a(),d=Xp(e,Wp(l),o,a==="path"),x=JSON.stringify(d);return C.useEffect(()=>{f(JSON.parse(x),{replace:t,state:r,relative:a})},[f,x,a,t,r]),null}function As(e){return tN(e.context)}function lt(e){sr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mN({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:l=!1}){sr(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),f=C.useMemo(()=>({basename:o,navigator:n,static:l,future:{}}),[o,n,l]);typeof r=="string"&&(r=ec(r));let{pathname:d="/",search:x="",hash:m="",state:p=null,key:v="default"}=r,y=C.useMemo(()=>{let b=Ls(d,o);return b==null?null:{location:{pathname:b,search:x,hash:m,state:p,key:v},navigationType:a}},[o,d,x,m,p,v,a]);return pn(y!=null,`<Router basename="${o}"> is not able to match the URL "${d}${x}${m}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:C.createElement(Pn.Provider,{value:f},C.createElement(tu.Provider,{children:t,value:y}))}function pN({children:e,location:t}){return rN(np(e),t)}function np(e,t=[]){let r=[];return C.Children.forEach(e,(a,n)=>{if(!C.isValidElement(a))return;let l=[...t,n];if(a.type===C.Fragment){r.push.apply(r,np(a.props.children,l));return}sr(a.type===lt,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),sr(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=np(a.props.children,l)),r.push(o)}),r}var ad="get",nd="application/x-www-form-urlencoded";function Md(e){return e!=null&&typeof e.tagName=="string"}function gN(e){return Md(e)&&e.tagName.toLowerCase()==="button"}function vN(e){return Md(e)&&e.tagName.toLowerCase()==="form"}function yN(e){return Md(e)&&e.tagName.toLowerCase()==="input"}function bN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function wN(e,t){return e.button===0&&(!t||t==="_self")&&!bN(e)}function sp(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function SN(e,t){let r=sp(e);return t&&t.forEach((a,n)=>{r.has(n)||t.getAll(n).forEach(l=>{r.append(n,l)})}),r}var Lf=null;function EN(){if(Lf===null)try{new FormData(document.createElement("form"),0),Lf=!1}catch{Lf=!0}return Lf}var _N=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bm(e){return e!=null&&!_N.has(e)?(pn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nd}"`),null):e}function kN(e,t){let r,a,n,l,o;if(vN(e)){let f=e.getAttribute("action");a=f?Ls(f,t):null,r=e.getAttribute("method")||ad,n=bm(e.getAttribute("enctype"))||nd,l=new FormData(e)}else if(gN(e)||yN(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||f.getAttribute("action");if(a=d?Ls(d,t):null,r=e.getAttribute("formmethod")||f.getAttribute("method")||ad,n=bm(e.getAttribute("formenctype"))||bm(f.getAttribute("enctype"))||nd,l=new FormData(f,e),!EN()){let{name:x,type:m,value:p}=e;if(m==="image"){let v=x?`${x}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else x&&l.append(x,p)}}else{if(Md(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=ad,a=null,n=nd,o=e}return l&&n==="text/plain"&&(o=l,l=void 0),{action:a,method:r.toLowerCase(),encType:n,formData:l,body:o}}function Qp(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function TN(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NN(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function CN(e,t,r){let a=await Promise.all(e.map(async n=>{let l=t.routes[n.route.id];if(l){let o=await TN(l,r);return o.links?o.links():[]}return[]}));return DN(a.flat(1).filter(NN).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function tb(e,t,r,a,n,l){let o=(d,x)=>r[x]?d.route.id!==r[x].route.id:!0,f=(d,x)=>{var m;return r[x].pathname!==d.pathname||((m=r[x].route.path)==null?void 0:m.endsWith("*"))&&r[x].params["*"]!==d.params["*"]};return l==="assets"?t.filter((d,x)=>o(d,x)||f(d,x)):l==="data"?t.filter((d,x)=>{var p;let m=a.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(o(d,x)||f(d,x))return!0;if(d.route.shouldRevalidate){let v=d.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((p=r[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function AN(e,t,{includeHydrateFallback:r}={}){return jN(e.map(a=>{let n=t.routes[a.route.id];if(!n)return[];let l=[n.module];return n.clientActionModule&&(l=l.concat(n.clientActionModule)),n.clientLoaderModule&&(l=l.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(l=l.concat(n.hydrateFallbackModule)),n.imports&&(l=l.concat(n.imports)),l}).flat(1))}function jN(e){return[...new Set(e)]}function RN(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function DN(e,t){let r=new Set;return new Set(t),e.reduce((a,n)=>{let l=JSON.stringify(RN(n));return r.has(l)||(r.add(l),a.push({key:l,link:n})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var FN=new Set([100,101,204,205]);function ON(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Ls(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function zS(){let e=C.useContext(tc);return Qp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function MN(){let e=C.useContext(Od);return Qp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Zp=C.createContext(void 0);Zp.displayName="FrameworkContext";function HS(){let e=C.useContext(Zp);return Qp(e,"You must render this element inside a <HydratedRouter> element"),e}function LN(e,t){let r=C.useContext(Zp),[a,n]=C.useState(!1),[l,o]=C.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:x,onMouseLeave:m,onTouchStart:p}=t,v=C.useRef(null);C.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let S=_=>{_.forEach(N=>{o(N.isIntersecting)})},E=new IntersectionObserver(S,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[e]),C.useEffect(()=>{if(a){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[a]);let y=()=>{n(!0)},b=()=>{n(!1),o(!1)};return r?e!=="intent"?[l,v,{}]:[l,v,{onFocus:f0(f,y),onBlur:f0(d,b),onMouseEnter:f0(x,y),onMouseLeave:f0(m,b),onTouchStart:f0(p,y)}]:[!1,v,{}]}function f0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function BN({page:e,...t}){let{router:r}=zS(),a=C.useMemo(()=>DS(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?C.createElement(IN,{page:e,matches:a,...t}):null}function PN(e){let{manifest:t,routeModules:r}=HS(),[a,n]=C.useState([]);return C.useEffect(()=>{let l=!1;return CN(e,t,r).then(o=>{l||n(o)}),()=>{l=!0}},[e,t,r]),a}function IN({page:e,matches:t,...r}){let a=ss(),{manifest:n,routeModules:l}=HS(),{basename:o}=zS(),{loaderData:f,matches:d}=MN(),x=C.useMemo(()=>tb(e,t,d,n,a,"data"),[e,t,d,n,a]),m=C.useMemo(()=>tb(e,t,d,n,a,"assets"),[e,t,d,n,a]),p=C.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let b=new Set,S=!1;if(t.forEach(_=>{var k;let N=n.routes[_.route.id];!N||!N.hasLoader||(!x.some(R=>R.route.id===_.route.id)&&_.route.id in f&&((k=l[_.route.id])!=null&&k.shouldRevalidate)||N.hasClientLoader?S=!0:b.add(_.route.id))}),b.size===0)return[];let E=ON(e,o);return S&&b.size>0&&E.searchParams.set("_routes",t.filter(_=>b.has(_.route.id)).map(_=>_.route.id).join(",")),[E.pathname+E.search]},[o,f,a,n,x,t,e,l]),v=C.useMemo(()=>AN(m,n),[m,n]),y=PN(m);return C.createElement(C.Fragment,null,p.map(b=>C.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),v.map(b=>C.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),y.map(({key:b,link:S})=>C.createElement("link",{key:b,...S})))}function UN(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var GS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GS&&(window.__reactRouterVersion="7.6.2")}catch{}function zN({basename:e,children:t,window:r}){let a=C.useRef();a.current==null&&(a.current=kT({window:r,v5Compat:!0}));let n=a.current,[l,o]=C.useState({action:n.action,location:n.location}),f=C.useCallback(d=>{C.startTransition(()=>o(d))},[o]);return C.useLayoutEffect(()=>n.listen(f),[n,f]),C.createElement(mN,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:n})}var VS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wl=C.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:n,reloadDocument:l,replace:o,state:f,target:d,to:x,preventScrollReset:m,viewTransition:p,...v},y){let{basename:b}=C.useContext(Pn),S=typeof x=="string"&&VS.test(x),E,_=!1;if(typeof x=="string"&&S&&(E=x,GS))try{let F=new URL(window.location.href),q=x.startsWith("//")?new URL(F.protocol+x):new URL(x),X=Ls(q.pathname,b);q.origin===F.origin&&X!=null?x=X+q.search+q.hash:_=!0}catch{pn(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=ZT(x,{relative:n}),[k,R,A]=LN(a,v),D=VN(x,{replace:o,state:f,target:d,preventScrollReset:m,relative:n,viewTransition:p});function T(F){t&&t(F),F.defaultPrevented||D(F)}let O=C.createElement("a",{...v,...A,href:E||N,onClick:_||l?t:T,ref:UN(y,R),target:d,"data-discover":!S&&r==="render"?"true":void 0});return k&&!S?C.createElement(C.Fragment,null,O,C.createElement(BN,{page:N})):O});wl.displayName="Link";var R0=C.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:n=!1,style:l,to:o,viewTransition:f,children:d,...x},m){let p=ru(o,{relative:x.relative}),v=ss(),y=C.useContext(Od),{navigator:b,basename:S}=C.useContext(Pn),E=y!=null&&KN(p)&&f===!0,_=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,N=v.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(N=N.toLowerCase(),k=k?k.toLowerCase():null,_=_.toLowerCase()),k&&S&&(k=Ls(k,S)||k);const R=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let A=N===_||!n&&N.startsWith(_)&&N.charAt(R)==="/",D=k!=null&&(k===_||!n&&k.startsWith(_)&&k.charAt(_.length)==="/"),T={isActive:A,isPending:D,isTransitioning:E},O=A?t:void 0,F;typeof a=="function"?F=a(T):F=[a,A?"active":null,D?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let q=typeof l=="function"?l(T):l;return C.createElement(wl,{...x,"aria-current":O,className:F,ref:m,style:q,to:o,viewTransition:f},typeof d=="function"?d(T):d)});R0.displayName="NavLink";var HN=C.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:l,method:o=ad,action:f,onSubmit:d,relative:x,preventScrollReset:m,viewTransition:p,...v},y)=>{let b=YN(),S=$N(f,{relative:x}),E=o.toLowerCase()==="get"?"get":"post",_=typeof f=="string"&&VS.test(f),N=k=>{if(d&&d(k),k.defaultPrevented)return;k.preventDefault();let R=k.nativeEvent.submitter,A=(R==null?void 0:R.getAttribute("formmethod"))||o;b(R||k.currentTarget,{fetcherKey:t,method:A,navigate:r,replace:n,state:l,relative:x,preventScrollReset:m,viewTransition:p})};return C.createElement("form",{ref:y,method:E,action:S,onSubmit:a?d:N,...v,"data-discover":!_&&e==="render"?"true":void 0})});HN.displayName="Form";function GN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qS(e){let t=C.useContext(tc);return sr(t,GN(e)),t}function VN(e,{target:t,replace:r,state:a,preventScrollReset:n,relative:l,viewTransition:o}={}){let f=_a(),d=ss(),x=ru(e,{relative:l});return C.useCallback(m=>{if(wN(m,t)){m.preventDefault();let p=r!==void 0?r:j0(d)===j0(x);f(e,{replace:p,state:a,preventScrollReset:n,relative:l,viewTransition:o})}},[d,f,x,r,a,t,e,n,l,o])}function qN(e){pn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=C.useRef(sp(e)),r=C.useRef(!1),a=ss(),n=C.useMemo(()=>SN(a.search,r.current?null:t.current),[a.search]),l=_a(),o=C.useCallback((f,d)=>{const x=sp(typeof f=="function"?f(n):f);r.current=!0,l("?"+x,d)},[l,n]);return[n,o]}var WN=0,XN=()=>`__${String(++WN)}__`;function YN(){let{router:e}=qS("useSubmit"),{basename:t}=C.useContext(Pn),r=fN();return C.useCallback(async(a,n={})=>{let{action:l,method:o,encType:f,formData:d,body:x}=kN(a,t);if(n.navigate===!1){let m=n.fetcherKey||XN();await e.fetch(m,r,n.action||l,{preventScrollReset:n.preventScrollReset,formData:d,body:x,formMethod:n.method||o,formEncType:n.encType||f,flushSync:n.flushSync})}else await e.navigate(n.action||l,{preventScrollReset:n.preventScrollReset,formData:d,body:x,formMethod:n.method||o,formEncType:n.encType||f,replace:n.replace,state:n.state,fromRouteId:r,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,r])}function $N(e,{relative:t}={}){let{basename:r}=C.useContext(Pn),a=C.useContext(vn);sr(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),l={...ru(e||".",{relative:t})},o=ss();if(e==null){l.search=o.search;let f=new URLSearchParams(l.search),d=f.getAll("index");if(d.some(m=>m==="")){f.delete("index"),d.filter(p=>p).forEach(p=>f.append("index",p));let m=f.toString();l.search=m?`?${m}`:""}}return(!e||e===".")&&n.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:Rs([r,l.pathname])),j0(l)}function KN(e,t={}){let r=C.useContext(LS);sr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=qS("useViewTransitionState"),n=ru(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=Ls(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=Ls(r.nextLocation.pathname,a)||r.nextLocation.pathname;return xd(n.pathname,o)!=null||xd(n.pathname,l)!=null}[...FN];var WS=Fd();const XS=C.createContext({theme:"light",toggle:()=>{}}),QN=()=>C.useContext(XS);function ZN({children:e}){const[t,r]=C.useState("light"),a=()=>r(n=>n==="light"?"dark":"light");return C.useEffect(()=>{document.documentElement.classList.toggle("dark",t==="dark")},[t]),c.jsx(XS.Provider,{value:{theme:t,toggle:a},children:e})}function YS(e,t){return function(){return e.apply(t,arguments)}}const{toString:JN}=Object.prototype,{getPrototypeOf:Jp}=Object,{iterator:Ld,toStringTag:$S}=Symbol,Bd=(e=>t=>{const r=JN.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),In=e=>(e=e.toLowerCase(),t=>Bd(t)===e),Pd=e=>t=>typeof t===e,{isArray:ac}=Array,D0=Pd("undefined");function e5(e){return e!==null&&!D0(e)&&e.constructor!==null&&!D0(e.constructor)&&Da(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const KS=In("ArrayBuffer");function t5(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&KS(e.buffer),t}const r5=Pd("string"),Da=Pd("function"),QS=Pd("number"),Id=e=>e!==null&&typeof e=="object",a5=e=>e===!0||e===!1,sd=e=>{if(Bd(e)!=="object")return!1;const t=Jp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!($S in e)&&!(Ld in e)},n5=In("Date"),s5=In("File"),i5=In("Blob"),l5=In("FileList"),o5=e=>Id(e)&&Da(e.pipe),c5=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Da(e.append)&&((t=Bd(e))==="formdata"||t==="object"&&Da(e.toString)&&e.toString()==="[object FormData]"))},u5=In("URLSearchParams"),[f5,d5,h5,x5]=["ReadableStream","Request","Response","Headers"].map(In),m5=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function au(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,n;if(typeof e!="object"&&(e=[e]),ac(e))for(a=0,n=e.length;a<n;a++)t.call(null,e[a],a,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),o=l.length;let f;for(a=0;a<o;a++)f=l[a],t.call(null,e[f],f,e)}}function ZS(e,t){t=t.toLowerCase();const r=Object.keys(e);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const ol=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,JS=e=>!D0(e)&&e!==ol;function ip(){const{caseless:e}=JS(this)&&this||{},t={},r=(a,n)=>{const l=e&&ZS(t,n)||n;sd(t[l])&&sd(a)?t[l]=ip(t[l],a):sd(a)?t[l]=ip({},a):ac(a)?t[l]=a.slice():t[l]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&au(arguments[a],r);return t}const p5=(e,t,r,{allOwnKeys:a}={})=>(au(t,(n,l)=>{r&&Da(n)?e[l]=YS(n,r):e[l]=n},{allOwnKeys:a}),e),g5=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),v5=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},y5=(e,t,r,a)=>{let n,l,o;const f={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),l=n.length;l-- >0;)o=n[l],(!a||a(o,e,t))&&!f[o]&&(t[o]=e[o],f[o]=!0);e=r!==!1&&Jp(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},b5=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},w5=e=>{if(!e)return null;if(ac(e))return e;let t=e.length;if(!QS(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},S5=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Jp(Uint8Array)),E5=(e,t)=>{const a=(e&&e[Ld]).call(e);let n;for(;(n=a.next())&&!n.done;){const l=n.value;t.call(e,l[0],l[1])}},_5=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},k5=In("HTMLFormElement"),T5=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),rb=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),N5=In("RegExp"),e4=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};au(r,(n,l)=>{let o;(o=t(n,l,e))!==!1&&(a[l]=o||n)}),Object.defineProperties(e,a)},C5=e=>{e4(e,(t,r)=>{if(Da(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(Da(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},A5=(e,t)=>{const r={},a=n=>{n.forEach(l=>{r[l]=!0})};return ac(e)?a(e):a(String(e).split(t)),r},j5=()=>{},R5=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function D5(e){return!!(e&&Da(e.append)&&e[$S]==="FormData"&&e[Ld])}const F5=e=>{const t=new Array(10),r=(a,n)=>{if(Id(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[n]=a;const l=ac(a)?[]:{};return au(a,(o,f)=>{const d=r(o,n+1);!D0(d)&&(l[f]=d)}),t[n]=void 0,l}}return a};return r(e,0)},O5=In("AsyncFunction"),M5=e=>e&&(Id(e)||Da(e))&&Da(e.then)&&Da(e.catch),t4=((e,t)=>e?setImmediate:t?((r,a)=>(ol.addEventListener("message",({source:n,data:l})=>{n===ol&&l===r&&a.length&&a.shift()()},!1),n=>{a.push(n),ol.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Da(ol.postMessage)),L5=typeof queueMicrotask<"u"?queueMicrotask.bind(ol):typeof process<"u"&&process.nextTick||t4,B5=e=>e!=null&&Da(e[Ld]),we={isArray:ac,isArrayBuffer:KS,isBuffer:e5,isFormData:c5,isArrayBufferView:t5,isString:r5,isNumber:QS,isBoolean:a5,isObject:Id,isPlainObject:sd,isReadableStream:f5,isRequest:d5,isResponse:h5,isHeaders:x5,isUndefined:D0,isDate:n5,isFile:s5,isBlob:i5,isRegExp:N5,isFunction:Da,isStream:o5,isURLSearchParams:u5,isTypedArray:S5,isFileList:l5,forEach:au,merge:ip,extend:p5,trim:m5,stripBOM:g5,inherits:v5,toFlatObject:y5,kindOf:Bd,kindOfTest:In,endsWith:b5,toArray:w5,forEachEntry:E5,matchAll:_5,isHTMLForm:k5,hasOwnProperty:rb,hasOwnProp:rb,reduceDescriptors:e4,freezeMethods:C5,toObjectSet:A5,toCamelCase:T5,noop:j5,toFiniteNumber:R5,findKey:ZS,global:ol,isContextDefined:JS,isSpecCompliantForm:D5,toJSONObject:F5,isAsyncFn:O5,isThenable:M5,setImmediate:t4,asap:L5,isIterable:B5};function ot(e,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}we.inherits(ot,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const r4=ot.prototype,a4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{a4[e]={value:e}});Object.defineProperties(ot,a4);Object.defineProperty(r4,"isAxiosError",{value:!0});ot.from=(e,t,r,a,n,l)=>{const o=Object.create(r4);return we.toFlatObject(e,o,function(d){return d!==Error.prototype},f=>f!=="isAxiosError"),ot.call(o,e.message,t,r,a,n),o.cause=e,o.name=e.name,l&&Object.assign(o,l),o};const P5=null;function lp(e){return we.isPlainObject(e)||we.isArray(e)}function n4(e){return we.endsWith(e,"[]")?e.slice(0,-2):e}function ab(e,t,r){return e?e.concat(t).map(function(n,l){return n=n4(n),!r&&l?"["+n+"]":n}).join(r?".":""):t}function I5(e){return we.isArray(e)&&!e.some(lp)}const U5=we.toFlatObject(we,{},null,function(t){return/^is[A-Z]/.test(t)});function Ud(e,t,r){if(!we.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=we.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,E){return!we.isUndefined(E[S])});const a=r.metaTokens,n=r.visitor||m,l=r.dots,o=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(t);if(!we.isFunction(n))throw new TypeError("visitor must be a function");function x(b){if(b===null)return"";if(we.isDate(b))return b.toISOString();if(!d&&we.isBlob(b))throw new ot("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(b)||we.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function m(b,S,E){let _=b;if(b&&!E&&typeof b=="object"){if(we.endsWith(S,"{}"))S=a?S:S.slice(0,-2),b=JSON.stringify(b);else if(we.isArray(b)&&I5(b)||(we.isFileList(b)||we.endsWith(S,"[]"))&&(_=we.toArray(b)))return S=n4(S),_.forEach(function(k,R){!(we.isUndefined(k)||k===null)&&t.append(o===!0?ab([S],R,l):o===null?S:S+"[]",x(k))}),!1}return lp(b)?!0:(t.append(ab(E,S,l),x(b)),!1)}const p=[],v=Object.assign(U5,{defaultVisitor:m,convertValue:x,isVisitable:lp});function y(b,S){if(!we.isUndefined(b)){if(p.indexOf(b)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(b),we.forEach(b,function(_,N){(!(we.isUndefined(_)||_===null)&&n.call(t,_,we.isString(N)?N.trim():N,S,v))===!0&&y(_,S?S.concat(N):[N])}),p.pop()}}if(!we.isObject(e))throw new TypeError("data must be an object");return y(e),t}function nb(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function eg(e,t){this._pairs=[],e&&Ud(e,this,t)}const s4=eg.prototype;s4.append=function(t,r){this._pairs.push([t,r])};s4.toString=function(t){const r=t?function(a){return t.call(this,a,nb)}:nb;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function z5(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function i4(e,t,r){if(!t)return e;const a=r&&r.encode||z5;we.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(t,r):l=we.isURLSearchParams(t)?t.toString():new eg(t,r).toString(a),l){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class sb{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){we.forEach(this.handlers,function(a){a!==null&&t(a)})}}const l4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},H5=typeof URLSearchParams<"u"?URLSearchParams:eg,G5=typeof FormData<"u"?FormData:null,V5=typeof Blob<"u"?Blob:null,q5={isBrowser:!0,classes:{URLSearchParams:H5,FormData:G5,Blob:V5},protocols:["http","https","file","blob","url","data"]},tg=typeof window<"u"&&typeof document<"u",op=typeof navigator=="object"&&navigator||void 0,W5=tg&&(!op||["ReactNative","NativeScript","NS"].indexOf(op.product)<0),X5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Y5=tg&&window.location.href||"http://localhost",$5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:tg,hasStandardBrowserEnv:W5,hasStandardBrowserWebWorkerEnv:X5,navigator:op,origin:Y5},Symbol.toStringTag,{value:"Module"})),oa={...$5,...q5};function K5(e,t){return Ud(e,new oa.classes.URLSearchParams,Object.assign({visitor:function(r,a,n,l){return oa.isNode&&we.isBuffer(r)?(this.append(a,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Q5(e){return we.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Z5(e){const t={},r=Object.keys(e);let a;const n=r.length;let l;for(a=0;a<n;a++)l=r[a],t[l]=e[l];return t}function o4(e){function t(r,a,n,l){let o=r[l++];if(o==="__proto__")return!0;const f=Number.isFinite(+o),d=l>=r.length;return o=!o&&we.isArray(n)?n.length:o,d?(we.hasOwnProp(n,o)?n[o]=[n[o],a]:n[o]=a,!f):((!n[o]||!we.isObject(n[o]))&&(n[o]=[]),t(r,a,n[o],l)&&we.isArray(n[o])&&(n[o]=Z5(n[o])),!f)}if(we.isFormData(e)&&we.isFunction(e.entries)){const r={};return we.forEachEntry(e,(a,n)=>{t(Q5(a),n,r,0)}),r}return null}function J5(e,t,r){if(we.isString(e))try{return(t||JSON.parse)(e),we.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const nu={transitional:l4,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,l=we.isObject(t);if(l&&we.isHTMLForm(t)&&(t=new FormData(t)),we.isFormData(t))return n?JSON.stringify(o4(t)):t;if(we.isArrayBuffer(t)||we.isBuffer(t)||we.isStream(t)||we.isFile(t)||we.isBlob(t)||we.isReadableStream(t))return t;if(we.isArrayBufferView(t))return t.buffer;if(we.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let f;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return K5(t,this.formSerializer).toString();if((f=we.isFileList(t))||a.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Ud(f?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),J5(t)):t}],transformResponse:[function(t){const r=this.transitional||nu.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(we.isResponse(t)||we.isReadableStream(t))return t;if(t&&we.isString(t)&&(a&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(f){if(o)throw f.name==="SyntaxError"?ot.from(f,ot.ERR_BAD_RESPONSE,this,null,this.response):f}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oa.classes.FormData,Blob:oa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],e=>{nu.headers[e]={}});const eC=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),tC=e=>{const t={};let r,a,n;return e&&e.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),a=o.substring(n+1).trim(),!(!r||t[r]&&eC[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},ib=Symbol("internals");function d0(e){return e&&String(e).trim().toLowerCase()}function id(e){return e===!1||e==null?e:we.isArray(e)?e.map(id):String(e)}function rC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const aC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function wm(e,t,r,a,n){if(we.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!we.isString(t)){if(we.isString(a))return t.indexOf(a)!==-1;if(we.isRegExp(a))return a.test(t)}}function nC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function sC(e,t){const r=we.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(n,l,o){return this[a].call(this,t,n,l,o)},configurable:!0})})}let Fa=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function l(f,d,x){const m=d0(d);if(!m)throw new Error("header name must be a non-empty string");const p=we.findKey(n,m);(!p||n[p]===void 0||x===!0||x===void 0&&n[p]!==!1)&&(n[p||d]=id(f))}const o=(f,d)=>we.forEach(f,(x,m)=>l(x,m,d));if(we.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(we.isString(t)&&(t=t.trim())&&!aC(t))o(tC(t),r);else if(we.isObject(t)&&we.isIterable(t)){let f={},d,x;for(const m of t){if(!we.isArray(m))throw TypeError("Object iterator must return a key-value pair");f[x=m[0]]=(d=f[x])?we.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}o(f,r)}else t!=null&&l(r,t,a);return this}get(t,r){if(t=d0(t),t){const a=we.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return rC(n);if(we.isFunction(r))return r.call(this,n,a);if(we.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=d0(t),t){const a=we.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||wm(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function l(o){if(o=d0(o),o){const f=we.findKey(a,o);f&&(!r||wm(a,a[f],f,r))&&(delete a[f],n=!0)}}return we.isArray(t)?t.forEach(l):l(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const l=r[a];(!t||wm(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const r=this,a={};return we.forEach(this,(n,l)=>{const o=we.findKey(a,l);if(o){r[o]=id(n),delete r[l];return}const f=t?nC(l):String(l).trim();f!==l&&delete r[l],r[f]=id(n),a[f]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return we.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&we.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[ib]=this[ib]={accessors:{}}).accessors,n=this.prototype;function l(o){const f=d0(o);a[f]||(sC(n,o),a[f]=!0)}return we.isArray(t)?t.forEach(l):l(t),this}};Fa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(Fa.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});we.freezeMethods(Fa);function Sm(e,t){const r=this||nu,a=t||r,n=Fa.from(a.headers);let l=a.data;return we.forEach(e,function(f){l=f.call(r,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function c4(e){return!!(e&&e.__CANCEL__)}function nc(e,t,r){ot.call(this,e??"canceled",ot.ERR_CANCELED,t,r),this.name="CanceledError"}we.inherits(nc,ot,{__CANCEL__:!0});function u4(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new ot("Request failed with status code "+r.status,[ot.ERR_BAD_REQUEST,ot.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function iC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function lC(e,t){e=e||10;const r=new Array(e),a=new Array(e);let n=0,l=0,o;return t=t!==void 0?t:1e3,function(d){const x=Date.now(),m=a[l];o||(o=x),r[n]=d,a[n]=x;let p=l,v=0;for(;p!==n;)v+=r[p++],p=p%e;if(n=(n+1)%e,n===l&&(l=(l+1)%e),x-o<t)return;const y=m&&x-m;return y?Math.round(v*1e3/y):void 0}}function oC(e,t){let r=0,a=1e3/t,n,l;const o=(x,m=Date.now())=>{r=m,n=null,l&&(clearTimeout(l),l=null),e.apply(null,x)};return[(...x)=>{const m=Date.now(),p=m-r;p>=a?o(x,m):(n=x,l||(l=setTimeout(()=>{l=null,o(n)},a-p)))},()=>n&&o(n)]}const md=(e,t,r=3)=>{let a=0;const n=lC(50,250);return oC(l=>{const o=l.loaded,f=l.lengthComputable?l.total:void 0,d=o-a,x=n(d),m=o<=f;a=o;const p={loaded:o,total:f,progress:f?o/f:void 0,bytes:d,rate:x||void 0,estimated:x&&f&&m?(f-o)/x:void 0,event:l,lengthComputable:f!=null,[t?"download":"upload"]:!0};e(p)},r)},lb=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},ob=e=>(...t)=>we.asap(()=>e(...t)),cC=oa.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,oa.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(oa.origin),oa.navigator&&/(msie|trident)/i.test(oa.navigator.userAgent)):()=>!0,uC=oa.hasStandardBrowserEnv?{write(e,t,r,a,n,l){const o=[e+"="+encodeURIComponent(t)];we.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),we.isString(a)&&o.push("path="+a),we.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function fC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function dC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function f4(e,t,r){let a=!fC(t);return e&&(a||r==!1)?dC(e,t):t}const cb=e=>e instanceof Fa?{...e}:e;function Nl(e,t){t=t||{};const r={};function a(x,m,p,v){return we.isPlainObject(x)&&we.isPlainObject(m)?we.merge.call({caseless:v},x,m):we.isPlainObject(m)?we.merge({},m):we.isArray(m)?m.slice():m}function n(x,m,p,v){if(we.isUndefined(m)){if(!we.isUndefined(x))return a(void 0,x,p,v)}else return a(x,m,p,v)}function l(x,m){if(!we.isUndefined(m))return a(void 0,m)}function o(x,m){if(we.isUndefined(m)){if(!we.isUndefined(x))return a(void 0,x)}else return a(void 0,m)}function f(x,m,p){if(p in t)return a(x,m);if(p in e)return a(void 0,x)}const d={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:f,headers:(x,m,p)=>n(cb(x),cb(m),p,!0)};return we.forEach(Object.keys(Object.assign({},e,t)),function(m){const p=d[m]||n,v=p(e[m],t[m],m);we.isUndefined(v)&&p!==f||(r[m]=v)}),r}const d4=e=>{const t=Nl({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:f}=t;t.headers=o=Fa.from(o),t.url=i4(f4(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),f&&o.set("Authorization","Basic "+btoa((f.username||"")+":"+(f.password?unescape(encodeURIComponent(f.password)):"")));let d;if(we.isFormData(r)){if(oa.hasStandardBrowserEnv||oa.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((d=o.getContentType())!==!1){const[x,...m]=d?d.split(";").map(p=>p.trim()).filter(Boolean):[];o.setContentType([x||"multipart/form-data",...m].join("; "))}}if(oa.hasStandardBrowserEnv&&(a&&we.isFunction(a)&&(a=a(t)),a||a!==!1&&cC(t.url))){const x=n&&l&&uC.read(l);x&&o.set(n,x)}return t},hC=typeof XMLHttpRequest<"u",xC=hC&&function(e){return new Promise(function(r,a){const n=d4(e);let l=n.data;const o=Fa.from(n.headers).normalize();let{responseType:f,onUploadProgress:d,onDownloadProgress:x}=n,m,p,v,y,b;function S(){y&&y(),b&&b(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function _(){if(!E)return;const k=Fa.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),A={data:!f||f==="text"||f==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:k,config:e,request:E};u4(function(T){r(T),S()},function(T){a(T),S()},A),E=null}"onloadend"in E?E.onloadend=_:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(_)},E.onabort=function(){E&&(a(new ot("Request aborted",ot.ECONNABORTED,e,E)),E=null)},E.onerror=function(){a(new ot("Network Error",ot.ERR_NETWORK,e,E)),E=null},E.ontimeout=function(){let R=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||l4;n.timeoutErrorMessage&&(R=n.timeoutErrorMessage),a(new ot(R,A.clarifyTimeoutError?ot.ETIMEDOUT:ot.ECONNABORTED,e,E)),E=null},l===void 0&&o.setContentType(null),"setRequestHeader"in E&&we.forEach(o.toJSON(),function(R,A){E.setRequestHeader(A,R)}),we.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),f&&f!=="json"&&(E.responseType=n.responseType),x&&([v,b]=md(x,!0),E.addEventListener("progress",v)),d&&E.upload&&([p,y]=md(d),E.upload.addEventListener("progress",p),E.upload.addEventListener("loadend",y)),(n.cancelToken||n.signal)&&(m=k=>{E&&(a(!k||k.type?new nc(null,e,E):k),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const N=iC(n.url);if(N&&oa.protocols.indexOf(N)===-1){a(new ot("Unsupported protocol "+N+":",ot.ERR_BAD_REQUEST,e));return}E.send(l||null)})},mC=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,n;const l=function(x){if(!n){n=!0,f();const m=x instanceof Error?x:this.reason;a.abort(m instanceof ot?m:new nc(m instanceof Error?m.message:m))}};let o=t&&setTimeout(()=>{o=null,l(new ot(`timeout ${t} of ms exceeded`,ot.ETIMEDOUT))},t);const f=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(x=>{x.unsubscribe?x.unsubscribe(l):x.removeEventListener("abort",l)}),e=null)};e.forEach(x=>x.addEventListener("abort",l));const{signal:d}=a;return d.unsubscribe=()=>we.asap(f),d}},pC=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let a=0,n;for(;a<r;)n=a+t,yield e.slice(a,n),a=n},gC=async function*(e,t){for await(const r of vC(e))yield*pC(r,t)},vC=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},ub=(e,t,r,a)=>{const n=gC(e,t);let l=0,o,f=d=>{o||(o=!0,a&&a(d))};return new ReadableStream({async pull(d){try{const{done:x,value:m}=await n.next();if(x){f(),d.close();return}let p=m.byteLength;if(r){let v=l+=p;r(v)}d.enqueue(new Uint8Array(m))}catch(x){throw f(x),x}},cancel(d){return f(d),n.return()}},{highWaterMark:2})},zd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",h4=zd&&typeof ReadableStream=="function",yC=zd&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),x4=(e,...t)=>{try{return!!e(...t)}catch{return!1}},bC=h4&&x4(()=>{let e=!1;const t=new Request(oa.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),fb=64*1024,cp=h4&&x4(()=>we.isReadableStream(new Response("").body)),pd={stream:cp&&(e=>e.body)};zd&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!pd[t]&&(pd[t]=we.isFunction(e[t])?r=>r[t]():(r,a)=>{throw new ot(`Response type '${t}' is not supported`,ot.ERR_NOT_SUPPORT,a)})})})(new Response);const wC=async e=>{if(e==null)return 0;if(we.isBlob(e))return e.size;if(we.isSpecCompliantForm(e))return(await new Request(oa.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(we.isArrayBufferView(e)||we.isArrayBuffer(e))return e.byteLength;if(we.isURLSearchParams(e)&&(e=e+""),we.isString(e))return(await yC(e)).byteLength},SC=async(e,t)=>{const r=we.toFiniteNumber(e.getContentLength());return r??wC(t)},EC=zd&&(async e=>{let{url:t,method:r,data:a,signal:n,cancelToken:l,timeout:o,onDownloadProgress:f,onUploadProgress:d,responseType:x,headers:m,withCredentials:p="same-origin",fetchOptions:v}=d4(e);x=x?(x+"").toLowerCase():"text";let y=mC([n,l&&l.toAbortSignal()],o),b;const S=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let E;try{if(d&&bC&&r!=="get"&&r!=="head"&&(E=await SC(m,a))!==0){let A=new Request(t,{method:"POST",body:a,duplex:"half"}),D;if(we.isFormData(a)&&(D=A.headers.get("content-type"))&&m.setContentType(D),A.body){const[T,O]=lb(E,md(ob(d)));a=ub(A.body,fb,T,O)}}we.isString(p)||(p=p?"include":"omit");const _="credentials"in Request.prototype;b=new Request(t,{...v,signal:y,method:r.toUpperCase(),headers:m.normalize().toJSON(),body:a,duplex:"half",credentials:_?p:void 0});let N=await fetch(b);const k=cp&&(x==="stream"||x==="response");if(cp&&(f||k&&S)){const A={};["status","statusText","headers"].forEach(F=>{A[F]=N[F]});const D=we.toFiniteNumber(N.headers.get("content-length")),[T,O]=f&&lb(D,md(ob(f),!0))||[];N=new Response(ub(N.body,fb,T,()=>{O&&O(),S&&S()}),A)}x=x||"text";let R=await pd[we.findKey(pd,x)||"text"](N,e);return!k&&S&&S(),await new Promise((A,D)=>{u4(A,D,{data:R,headers:Fa.from(N.headers),status:N.status,statusText:N.statusText,config:e,request:b})})}catch(_){throw S&&S(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new ot("Network Error",ot.ERR_NETWORK,e,b),{cause:_.cause||_}):ot.from(_,_&&_.code,e,b)}}),up={http:P5,xhr:xC,fetch:EC};we.forEach(up,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const db=e=>`- ${e}`,_C=e=>we.isFunction(e)||e===null||e===!1,m4={getAdapter:e=>{e=we.isArray(e)?e:[e];const{length:t}=e;let r,a;const n={};for(let l=0;l<t;l++){r=e[l];let o;if(a=r,!_C(r)&&(a=up[(o=String(r)).toLowerCase()],a===void 0))throw new ot(`Unknown adapter '${o}'`);if(a)break;n[o||"#"+l]=a}if(!a){const l=Object.entries(n).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=t?l.length>1?`since :
`+l.map(db).join(`
`):" "+db(l[0]):"as no adapter specified";throw new ot("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:up};function Em(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new nc(null,e)}function hb(e){return Em(e),e.headers=Fa.from(e.headers),e.data=Sm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),m4.getAdapter(e.adapter||nu.adapter)(e).then(function(a){return Em(e),a.data=Sm.call(e,e.transformResponse,a),a.headers=Fa.from(a.headers),a},function(a){return c4(a)||(Em(e),a&&a.response&&(a.response.data=Sm.call(e,e.transformResponse,a.response),a.response.headers=Fa.from(a.response.headers))),Promise.reject(a)})}const p4="1.9.0",Hd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Hd[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const xb={};Hd.transitional=function(t,r,a){function n(l,o){return"[Axios v"+p4+"] Transitional option '"+l+"'"+o+(a?". "+a:"")}return(l,o,f)=>{if(t===!1)throw new ot(n(o," has been removed"+(r?" in "+r:"")),ot.ERR_DEPRECATED);return r&&!xb[o]&&(xb[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,o,f):!0}};Hd.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function kC(e,t,r){if(typeof e!="object")throw new ot("options must be an object",ot.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const l=a[n],o=t[l];if(o){const f=e[l],d=f===void 0||o(f,l,e);if(d!==!0)throw new ot("option "+l+" must be "+d,ot.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ot("Unknown option "+l,ot.ERR_BAD_OPTION)}}const ld={assertOptions:kC,validators:Hd},$n=ld.validators;let Sl=class{constructor(t){this.defaults=t||{},this.interceptors={request:new sb,response:new sb}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Nl(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:l}=r;a!==void 0&&ld.assertOptions(a,{silentJSONParsing:$n.transitional($n.boolean),forcedJSONParsing:$n.transitional($n.boolean),clarifyTimeoutError:$n.transitional($n.boolean)},!1),n!=null&&(we.isFunction(n)?r.paramsSerializer={serialize:n}:ld.assertOptions(n,{encode:$n.function,serialize:$n.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ld.assertOptions(r,{baseUrl:$n.spelling("baseURL"),withXsrfToken:$n.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&we.merge(l.common,l[r.method]);l&&we.forEach(["delete","get","head","post","put","patch","common"],b=>{delete l[b]}),r.headers=Fa.concat(o,l);const f=[];let d=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(r)===!1||(d=d&&S.synchronous,f.unshift(S.fulfilled,S.rejected))});const x=[];this.interceptors.response.forEach(function(S){x.push(S.fulfilled,S.rejected)});let m,p=0,v;if(!d){const b=[hb.bind(this),void 0];for(b.unshift.apply(b,f),b.push.apply(b,x),v=b.length,m=Promise.resolve(r);p<v;)m=m.then(b[p++],b[p++]);return m}v=f.length;let y=r;for(p=0;p<v;){const b=f[p++],S=f[p++];try{y=b(y)}catch(E){S.call(this,E);break}}try{m=hb.call(this,y)}catch(b){return Promise.reject(b)}for(p=0,v=x.length;p<v;)m=m.then(x[p++],x[p++]);return m}getUri(t){t=Nl(this.defaults,t);const r=f4(t.baseURL,t.url,t.allowAbsoluteUrls);return i4(r,t.params,t.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(t){Sl.prototype[t]=function(r,a){return this.request(Nl(a||{},{method:t,url:r,data:(a||{}).data}))}});we.forEach(["post","put","patch"],function(t){function r(a){return function(l,o,f){return this.request(Nl(f||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}Sl.prototype[t]=r(),Sl.prototype[t+"Form"]=r(!0)});let TC=class g4{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const a=this;this.promise.then(n=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](n);a._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(f=>{a.subscribe(f),l=f}).then(n);return o.cancel=function(){a.unsubscribe(l)},o},t(function(l,o,f){a.reason||(a.reason=new nc(l,o,f),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new g4(function(n){t=n}),cancel:t}}};function NC(e){return function(r){return e.apply(null,r)}}function CC(e){return we.isObject(e)&&e.isAxiosError===!0}const fp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(fp).forEach(([e,t])=>{fp[t]=e});function v4(e){const t=new Sl(e),r=YS(Sl.prototype.request,t);return we.extend(r,Sl.prototype,t,{allOwnKeys:!0}),we.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return v4(Nl(e,n))},r}const Sr=v4(nu);Sr.Axios=Sl;Sr.CanceledError=nc;Sr.CancelToken=TC;Sr.isCancel=c4;Sr.VERSION=p4;Sr.toFormData=Ud;Sr.AxiosError=ot;Sr.Cancel=Sr.CanceledError;Sr.all=function(t){return Promise.all(t)};Sr.spread=NC;Sr.isAxiosError=CC;Sr.mergeConfig=Nl;Sr.AxiosHeaders=Fa;Sr.formToJSON=e=>o4(we.isHTMLForm(e)?new FormData(e):e);Sr.getAdapter=m4.getAdapter;Sr.HttpStatusCode=fp;Sr.default=Sr;const{Axios:aH,AxiosError:nH,CanceledError:sH,isCancel:iH,CancelToken:lH,VERSION:oH,all:cH,Cancel:uH,isAxiosError:fH,spread:dH,toFormData:hH,AxiosHeaders:xH,HttpStatusCode:mH,formToJSON:pH,getAdapter:gH,mergeConfig:vH}=Sr,Ze=Sr.create({baseURL:"https://api.bigdaysmanager.com/api/v1",withCredentials:!0,headers:{"Content-Type":"application/json"}});Ze.interceptors.request.use(e=>{const t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`);const r="abcd1234",a="my-big-day-prod";return e.headers.apiKey=r,e.headers.author=a,e});var sc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Cl=typeof window>"u"||"Deno"in globalThis;function va(){}function AC(e,t){return typeof e=="function"?e(t):e}function dp(e){return typeof e=="number"&&e>=0&&e!==1/0}function y4(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ri(e,t){return typeof e=="function"?e(t):e}function Dn(e,t){return typeof e=="function"?e(t):e}function mb(e,t){const{type:r="all",exact:a,fetchStatus:n,predicate:l,queryKey:o,stale:f}=e;if(o){if(a){if(t.queryHash!==rg(o,t.options))return!1}else if(!F0(t.queryKey,o))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof f=="boolean"&&t.isStale()!==f||n&&n!==t.state.fetchStatus||l&&!l(t))}function pb(e,t){const{exact:r,status:a,predicate:n,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(r){if(Al(t.options.mutationKey)!==Al(l))return!1}else if(!F0(t.options.mutationKey,l))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function rg(e,t){return((t==null?void 0:t.queryKeyHashFn)||Al)(e)}function Al(e){return JSON.stringify(e,(t,r)=>hp(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function F0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>F0(e[r],t[r])):!1}function b4(e,t){if(e===t)return e;const r=gb(e)&&gb(t);if(r||hp(e)&&hp(t)){const a=r?e:Object.keys(e),n=a.length,l=r?t:Object.keys(t),o=l.length,f=r?[]:{},d=new Set(a);let x=0;for(let m=0;m<o;m++){const p=r?m:l[m];(!r&&d.has(p)||r)&&e[p]===void 0&&t[p]===void 0?(f[p]=void 0,x++):(f[p]=b4(e[p],t[p]),f[p]===e[p]&&e[p]!==void 0&&x++)}return n===o&&x===n?e:f}return t}function gd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function gb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function hp(e){if(!vb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!vb(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function vb(e){return Object.prototype.toString.call(e)==="[object Object]"}function jC(e){return new Promise(t=>{setTimeout(t,e)})}function xp(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?b4(e,t):t}function RC(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function DC(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var ag=Symbol();function w4(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ag?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function S4(e,t){return typeof e=="function"?e(...t):!!e}var dl,vi,Bo,SS,FC=(SS=class extends sc{constructor(){super();Qe(this,dl);Qe(this,vi);Qe(this,Bo);Ve(this,Bo,t=>{if(!Cl&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ae(this,vi)||this.setEventListener(ae(this,Bo))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,vi))==null||t.call(this),Ve(this,vi,void 0))}setEventListener(t){var r;Ve(this,Bo,t),(r=ae(this,vi))==null||r.call(this),Ve(this,vi,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){ae(this,dl)!==t&&(Ve(this,dl,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ae(this,dl)=="boolean"?ae(this,dl):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},dl=new WeakMap,vi=new WeakMap,Bo=new WeakMap,SS),ng=new FC,Po,yi,Io,ES,OC=(ES=class extends sc{constructor(){super();Qe(this,Po,!0);Qe(this,yi);Qe(this,Io);Ve(this,Io,t=>{if(!Cl&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){ae(this,yi)||this.setEventListener(ae(this,Io))}onUnsubscribe(){var t;this.hasListeners()||((t=ae(this,yi))==null||t.call(this),Ve(this,yi,void 0))}setEventListener(t){var r;Ve(this,Io,t),(r=ae(this,yi))==null||r.call(this),Ve(this,yi,t(this.setOnline.bind(this)))}setOnline(t){ae(this,Po)!==t&&(Ve(this,Po,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return ae(this,Po)}},Po=new WeakMap,yi=new WeakMap,Io=new WeakMap,ES),vd=new OC;function mp(){let e,t;const r=new Promise((n,l)=>{e=n,t=l});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),e(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function MC(e){return Math.min(1e3*2**e,3e4)}function E4(e){return(e??"online")==="online"?vd.isOnline():!0}var _4=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function _m(e){return e instanceof _4}function k4(e){let t=!1,r=0,a=!1,n;const l=mp(),o=S=>{var E;a||(v(new _4(S)),(E=e.abort)==null||E.call(e))},f=()=>{t=!0},d=()=>{t=!1},x=()=>ng.isFocused()&&(e.networkMode==="always"||vd.isOnline())&&e.canRun(),m=()=>E4(e.networkMode)&&e.canRun(),p=S=>{var E;a||(a=!0,(E=e.onSuccess)==null||E.call(e,S),n==null||n(),l.resolve(S))},v=S=>{var E;a||(a=!0,(E=e.onError)==null||E.call(e,S),n==null||n(),l.reject(S))},y=()=>new Promise(S=>{var E;n=_=>{(a||x())&&S(_)},(E=e.onPause)==null||E.call(e)}).then(()=>{var S;n=void 0,a||(S=e.onContinue)==null||S.call(e)}),b=()=>{if(a)return;let S;const E=r===0?e.initialPromise:void 0;try{S=E??e.fn()}catch(_){S=Promise.reject(_)}Promise.resolve(S).then(p).catch(_=>{var D;if(a)return;const N=e.retry??(Cl?0:3),k=e.retryDelay??MC,R=typeof k=="function"?k(r,_):k,A=N===!0||typeof N=="number"&&r<N||typeof N=="function"&&N(r,_);if(t||!A){v(_);return}r++,(D=e.onFail)==null||D.call(e,r,_),jC(R).then(()=>x()?void 0:y()).then(()=>{t?v(_):b()})})};return{promise:l,cancel:o,continue:()=>(n==null||n(),l),cancelRetry:f,continueRetry:d,canStart:m,start:()=>(m()?b():y().then(b),l)}}var LC=e=>setTimeout(e,0);function BC(){let e=[],t=0,r=f=>{f()},a=f=>{f()},n=LC;const l=f=>{t?e.push(f):n(()=>{r(f)})},o=()=>{const f=e;e=[],f.length&&n(()=>{a(()=>{f.forEach(d=>{r(d)})})})};return{batch:f=>{let d;t++;try{d=f()}finally{t--,t||o()}return d},batchCalls:f=>(...d)=>{l(()=>{f(...d)})},schedule:l,setNotifyFunction:f=>{r=f},setBatchNotifyFunction:f=>{a=f},setScheduler:f=>{n=f}}}var Lr=BC(),hl,_S,T4=(_S=class{constructor(){Qe(this,hl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dp(this.gcTime)&&Ve(this,hl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Cl?1/0:5*60*1e3))}clearGcTimeout(){ae(this,hl)&&(clearTimeout(ae(this,hl)),Ve(this,hl,void 0))}},hl=new WeakMap,_S),Uo,zo,hn,xl,na,Q0,ml,jn,Ts,kS,PC=(kS=class extends T4{constructor(t){super();Qe(this,jn);Qe(this,Uo);Qe(this,zo);Qe(this,hn);Qe(this,xl);Qe(this,na);Qe(this,Q0);Qe(this,ml);Ve(this,ml,!1),Ve(this,Q0,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ve(this,xl,t.client),Ve(this,hn,ae(this,xl).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ve(this,Uo,IC(this.options)),this.state=t.state??ae(this,Uo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ae(this,na))==null?void 0:t.promise}setOptions(t){this.options={...ae(this,Q0),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ae(this,hn).remove(this)}setData(t,r){const a=xp(this.state.data,t,this.options);return ht(this,jn,Ts).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){ht(this,jn,Ts).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=ae(this,na))==null?void 0:a.promise;return(n=ae(this,na))==null||n.cancel(t),r?r.then(va).catch(va):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ae(this,Uo))}isActive(){return this.observers.some(t=>Dn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ag||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ri(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!y4(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,na))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ae(this,na))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ae(this,hn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ae(this,na)&&(ae(this,ml)?ae(this,na).cancel({revert:!0}):ae(this,na).cancelRetry()),this.scheduleGc()),ae(this,hn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ht(this,jn,Ts).call(this,{type:"invalidate"})}fetch(t,r){var x,m,p;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ae(this,na))return ae(this,na).continueRetry(),ae(this,na).promise}if(t&&this.setOptions(t),!this.options.queryFn){const v=this.observers.find(y=>y.options.queryFn);v&&this.setOptions(v.options)}const a=new AbortController,n=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(Ve(this,ml,!0),a.signal)})},l=()=>{const v=w4(this.options,r),b=(()=>{const S={client:ae(this,xl),queryKey:this.queryKey,meta:this.meta};return n(S),S})();return Ve(this,ml,!1),this.options.persister?this.options.persister(v,b,this):v(b)},f=(()=>{const v={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ae(this,xl),state:this.state,fetchFn:l};return n(v),v})();(x=this.options.behavior)==null||x.onFetch(f,this),Ve(this,zo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=f.fetchOptions)==null?void 0:m.meta))&&ht(this,jn,Ts).call(this,{type:"fetch",meta:(p=f.fetchOptions)==null?void 0:p.meta});const d=v=>{var y,b,S,E;_m(v)&&v.silent||ht(this,jn,Ts).call(this,{type:"error",error:v}),_m(v)||((b=(y=ae(this,hn).config).onError)==null||b.call(y,v,this),(E=(S=ae(this,hn).config).onSettled)==null||E.call(S,this.state.data,v,this)),this.scheduleGc()};return Ve(this,na,k4({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,abort:a.abort.bind(a),onSuccess:v=>{var y,b,S,E;if(v===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(_){d(_);return}(b=(y=ae(this,hn).config).onSuccess)==null||b.call(y,v,this),(E=(S=ae(this,hn).config).onSettled)==null||E.call(S,v,this.state.error,this),this.scheduleGc()},onError:d,onFail:(v,y)=>{ht(this,jn,Ts).call(this,{type:"failed",failureCount:v,error:y})},onPause:()=>{ht(this,jn,Ts).call(this,{type:"pause"})},onContinue:()=>{ht(this,jn,Ts).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0})),ae(this,na).start()}},Uo=new WeakMap,zo=new WeakMap,hn=new WeakMap,xl=new WeakMap,na=new WeakMap,Q0=new WeakMap,ml=new WeakMap,jn=new WeakSet,Ts=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...N4(a.data,this.options),fetchMeta:t.meta??null};case"success":return{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return _m(n)&&n.revert&&ae(this,zo)?{...ae(this,zo),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),Lr.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),ae(this,hn).notify({query:this,type:"updated",action:t})})},kS);function N4(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:E4(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function IC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ts,TS,UC=(TS=class extends sc{constructor(t={}){super();Qe(this,ts);this.config=t,Ve(this,ts,new Map)}build(t,r,a){const n=r.queryKey,l=r.queryHash??rg(n,r);let o=this.get(l);return o||(o=new PC({client:t,queryKey:n,queryHash:l,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){ae(this,ts).has(t.queryHash)||(ae(this,ts).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ae(this,ts).get(t.queryHash);r&&(t.destroy(),r===t&&ae(this,ts).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Lr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ae(this,ts).get(t)}getAll(){return[...ae(this,ts).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>mb(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>mb(t,a)):r}notify(t){Lr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Lr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Lr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ts=new WeakMap,TS),rs,ma,pl,as,pi,NS,zC=(NS=class extends T4{constructor(t){super();Qe(this,as);Qe(this,rs);Qe(this,ma);Qe(this,pl);this.mutationId=t.mutationId,Ve(this,ma,t.mutationCache),Ve(this,rs,[]),this.state=t.state||C4(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ae(this,rs).includes(t)||(ae(this,rs).push(t),this.clearGcTimeout(),ae(this,ma).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ve(this,rs,ae(this,rs).filter(r=>r!==t)),this.scheduleGc(),ae(this,ma).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ae(this,rs).length||(this.state.status==="pending"?this.scheduleGc():ae(this,ma).remove(this))}continue(){var t;return((t=ae(this,pl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,f,d,x,m,p,v,y,b,S,E,_,N,k,R,A,D,T,O;const r=()=>{ht(this,as,pi).call(this,{type:"continue"})};Ve(this,pl,k4({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(F,q)=>{ht(this,as,pi).call(this,{type:"failed",failureCount:F,error:q})},onPause:()=>{ht(this,as,pi).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ae(this,ma).canRun(this)}));const a=this.state.status==="pending",n=!ae(this,pl).canStart();try{if(a)r();else{ht(this,as,pi).call(this,{type:"pending",variables:t,isPaused:n}),await((o=(l=ae(this,ma).config).onMutate)==null?void 0:o.call(l,t,this));const q=await((d=(f=this.options).onMutate)==null?void 0:d.call(f,t));q!==this.state.context&&ht(this,as,pi).call(this,{type:"pending",context:q,variables:t,isPaused:n})}const F=await ae(this,pl).start();return await((m=(x=ae(this,ma).config).onSuccess)==null?void 0:m.call(x,F,t,this.state.context,this)),await((v=(p=this.options).onSuccess)==null?void 0:v.call(p,F,t,this.state.context)),await((b=(y=ae(this,ma).config).onSettled)==null?void 0:b.call(y,F,null,this.state.variables,this.state.context,this)),await((E=(S=this.options).onSettled)==null?void 0:E.call(S,F,null,t,this.state.context)),ht(this,as,pi).call(this,{type:"success",data:F}),F}catch(F){try{throw await((N=(_=ae(this,ma).config).onError)==null?void 0:N.call(_,F,t,this.state.context,this)),await((R=(k=this.options).onError)==null?void 0:R.call(k,F,t,this.state.context)),await((D=(A=ae(this,ma).config).onSettled)==null?void 0:D.call(A,void 0,F,this.state.variables,this.state.context,this)),await((O=(T=this.options).onSettled)==null?void 0:O.call(T,void 0,F,t,this.state.context)),F}finally{ht(this,as,pi).call(this,{type:"error",error:F})}}finally{ae(this,ma).runNext(this)}}},rs=new WeakMap,ma=new WeakMap,pl=new WeakMap,as=new WeakSet,pi=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Lr.batch(()=>{ae(this,rs).forEach(a=>{a.onMutationUpdate(t)}),ae(this,ma).notify({mutation:this,type:"updated",action:t})})},NS);function C4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ns,Rn,Z0,CS,HC=(CS=class extends sc{constructor(t={}){super();Qe(this,Ns);Qe(this,Rn);Qe(this,Z0);this.config=t,Ve(this,Ns,new Set),Ve(this,Rn,new Map),Ve(this,Z0,0)}build(t,r,a){const n=new zC({mutationCache:this,mutationId:++Of(this,Z0)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){ae(this,Ns).add(t);const r=Bf(t);if(typeof r=="string"){const a=ae(this,Rn).get(r);a?a.push(t):ae(this,Rn).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ae(this,Ns).delete(t)){const r=Bf(t);if(typeof r=="string"){const a=ae(this,Rn).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&ae(this,Rn).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Bf(t);if(typeof r=="string"){const a=ae(this,Rn).get(r),n=a==null?void 0:a.find(l=>l.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=Bf(t);if(typeof r=="string"){const n=(a=ae(this,Rn).get(r))==null?void 0:a.find(l=>l!==t&&l.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Lr.batch(()=>{ae(this,Ns).forEach(t=>{this.notify({type:"removed",mutation:t})}),ae(this,Ns).clear(),ae(this,Rn).clear()})}getAll(){return Array.from(ae(this,Ns))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>pb(r,a))}findAll(t={}){return this.getAll().filter(r=>pb(t,r))}notify(t){Lr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Lr.batch(()=>Promise.all(t.map(r=>r.continue().catch(va))))}},Ns=new WeakMap,Rn=new WeakMap,Z0=new WeakMap,CS);function Bf(e){var t;return(t=e.options.scope)==null?void 0:t.id}function yb(e){return{onFetch:(t,r)=>{var m,p,v,y,b;const a=t.options,n=(v=(p=(m=t.fetchOptions)==null?void 0:m.meta)==null?void 0:p.fetchMore)==null?void 0:v.direction,l=((y=t.state.data)==null?void 0:y.pages)||[],o=((b=t.state.data)==null?void 0:b.pageParams)||[];let f={pages:[],pageParams:[]},d=0;const x=async()=>{let S=!1;const E=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(t.signal.aborted?S=!0:t.signal.addEventListener("abort",()=>{S=!0}),t.signal)})},_=w4(t.options,t.fetchOptions),N=async(k,R,A)=>{if(S)return Promise.reject();if(R==null&&k.pages.length)return Promise.resolve(k);const T=(()=>{const X={client:t.client,queryKey:t.queryKey,pageParam:R,direction:A?"backward":"forward",meta:t.options.meta};return E(X),X})(),O=await _(T),{maxPages:F}=t.options,q=A?DC:RC;return{pages:q(k.pages,O,F),pageParams:q(k.pageParams,R,F)}};if(n&&l.length){const k=n==="backward",R=k?GC:bb,A={pages:l,pageParams:o},D=R(a,A);f=await N(A,D,k)}else{const k=e??l.length;do{const R=d===0?o[0]??a.initialPageParam:bb(a,f);if(d>0&&R==null)break;f=await N(f,R),d++}while(d<k)}return f};t.options.persister?t.fetchFn=()=>{var S,E;return(E=(S=t.options).persister)==null?void 0:E.call(S,x,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=x}}}function bb(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function GC(e,{pages:t,pageParams:r}){var a;return t.length>0?(a=e.getPreviousPageParam)==null?void 0:a.call(e,t[0],t,r[0],r):void 0}var hr,bi,wi,Ho,Go,Si,Vo,qo,AS,VC=(AS=class{constructor(e={}){Qe(this,hr);Qe(this,bi);Qe(this,wi);Qe(this,Ho);Qe(this,Go);Qe(this,Si);Qe(this,Vo);Qe(this,qo);Ve(this,hr,e.queryCache||new UC),Ve(this,bi,e.mutationCache||new HC),Ve(this,wi,e.defaultOptions||{}),Ve(this,Ho,new Map),Ve(this,Go,new Map),Ve(this,Si,0)}mount(){Of(this,Si)._++,ae(this,Si)===1&&(Ve(this,Vo,ng.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,hr).onFocus())})),Ve(this,qo,vd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ae(this,hr).onOnline())})))}unmount(){var e,t;Of(this,Si)._--,ae(this,Si)===0&&((e=ae(this,Vo))==null||e.call(this),Ve(this,Vo,void 0),(t=ae(this,qo))==null||t.call(this),Ve(this,qo,void 0))}isFetching(e){return ae(this,hr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ae(this,bi).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,hr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ae(this,hr).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Ri(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return ae(this,hr).findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=ae(this,hr).get(a.queryHash),l=n==null?void 0:n.state.data,o=AC(t,l);if(o!==void 0)return ae(this,hr).build(this,a).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Lr.batch(()=>ae(this,hr).findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ae(this,hr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ae(this,hr);Lr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ae(this,hr);return Lr.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=Lr.batch(()=>ae(this,hr).findAll(e).map(n=>n.cancel(r)));return Promise.all(a).then(va).catch(va)}invalidateQueries(e,t={}){return Lr.batch(()=>(ae(this,hr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=Lr.batch(()=>ae(this,hr).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let l=n.fetch(void 0,r);return r.throwOnError||(l=l.catch(va)),n.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(a).then(va)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ae(this,hr).build(this,t);return r.isStaleByTime(Ri(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(va).catch(va)}fetchInfiniteQuery(e){return e.behavior=yb(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(va).catch(va)}ensureInfiniteQueryData(e){return e.behavior=yb(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return vd.isOnline()?ae(this,bi).resumePausedMutations():Promise.resolve()}getQueryCache(){return ae(this,hr)}getMutationCache(){return ae(this,bi)}getDefaultOptions(){return ae(this,wi)}setDefaultOptions(e){Ve(this,wi,e)}setQueryDefaults(e,t){ae(this,Ho).set(Al(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ae(this,Ho).values()],r={};return t.forEach(a=>{F0(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){ae(this,Go).set(Al(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ae(this,Go).values()],r={};return t.forEach(a=>{F0(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ae(this,wi).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=rg(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ag&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ae(this,wi).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ae(this,hr).clear(),ae(this,bi).clear()}},hr=new WeakMap,bi=new WeakMap,wi=new WeakMap,Ho=new WeakMap,Go=new WeakMap,Si=new WeakMap,Vo=new WeakMap,qo=new WeakMap,AS),Aa,wt,J0,pa,gl,Wo,Ei,_i,eu,Xo,Yo,vl,yl,ki,$o,Dt,g0,pp,gp,vp,yp,bp,wp,Sp,A4,jS,qC=(jS=class extends sc{constructor(t,r){super();Qe(this,Dt);Qe(this,Aa);Qe(this,wt);Qe(this,J0);Qe(this,pa);Qe(this,gl);Qe(this,Wo);Qe(this,Ei);Qe(this,_i);Qe(this,eu);Qe(this,Xo);Qe(this,Yo);Qe(this,vl);Qe(this,yl);Qe(this,ki);Qe(this,$o,new Set);this.options=r,Ve(this,Aa,t),Ve(this,_i,null),Ve(this,Ei,mp()),this.options.experimental_prefetchInRender||ae(this,Ei).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ae(this,wt).addObserver(this),wb(ae(this,wt),this.options)?ht(this,Dt,g0).call(this):this.updateResult(),ht(this,Dt,yp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ep(ae(this,wt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ep(ae(this,wt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ht(this,Dt,bp).call(this),ht(this,Dt,wp).call(this),ae(this,wt).removeObserver(this)}setOptions(t){const r=this.options,a=ae(this,wt);if(this.options=ae(this,Aa).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Dn(this.options.enabled,ae(this,wt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ht(this,Dt,Sp).call(this),ae(this,wt).setOptions(this.options),r._defaulted&&!gd(this.options,r)&&ae(this,Aa).getQueryCache().notify({type:"observerOptionsUpdated",query:ae(this,wt),observer:this});const n=this.hasListeners();n&&Sb(ae(this,wt),a,this.options,r)&&ht(this,Dt,g0).call(this),this.updateResult(),n&&(ae(this,wt)!==a||Dn(this.options.enabled,ae(this,wt))!==Dn(r.enabled,ae(this,wt))||Ri(this.options.staleTime,ae(this,wt))!==Ri(r.staleTime,ae(this,wt)))&&ht(this,Dt,pp).call(this);const l=ht(this,Dt,gp).call(this);n&&(ae(this,wt)!==a||Dn(this.options.enabled,ae(this,wt))!==Dn(r.enabled,ae(this,wt))||l!==ae(this,ki))&&ht(this,Dt,vp).call(this,l)}getOptimisticResult(t){const r=ae(this,Aa).getQueryCache().build(ae(this,Aa),t),a=this.createResult(r,t);return XC(this,a)&&(Ve(this,pa,a),Ve(this,Wo,this.options),Ve(this,gl,ae(this,wt).state)),a}getCurrentResult(){return ae(this,pa)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),Reflect.get(a,n))})}trackProp(t){ae(this,$o).add(t)}getCurrentQuery(){return ae(this,wt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=ae(this,Aa).defaultQueryOptions(t),a=ae(this,Aa).getQueryCache().build(ae(this,Aa),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return ht(this,Dt,g0).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ae(this,pa)))}createResult(t,r){var F;const a=ae(this,wt),n=this.options,l=ae(this,pa),o=ae(this,gl),f=ae(this,Wo),x=t!==a?t.state:ae(this,J0),{state:m}=t;let p={...m},v=!1,y;if(r._optimisticResults){const q=this.hasListeners(),X=!q&&wb(t,r),U=q&&Sb(t,a,r,n);(X||U)&&(p={...p,...N4(m.data,t.options)}),r._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:b,errorUpdatedAt:S,status:E}=p;y=p.data;let _=!1;if(r.placeholderData!==void 0&&y===void 0&&E==="pending"){let q;l!=null&&l.isPlaceholderData&&r.placeholderData===(f==null?void 0:f.placeholderData)?(q=l.data,_=!0):q=typeof r.placeholderData=="function"?r.placeholderData((F=ae(this,Yo))==null?void 0:F.state.data,ae(this,Yo)):r.placeholderData,q!==void 0&&(E="success",y=xp(l==null?void 0:l.data,q,r),v=!0)}if(r.select&&y!==void 0&&!_)if(l&&y===(o==null?void 0:o.data)&&r.select===ae(this,eu))y=ae(this,Xo);else try{Ve(this,eu,r.select),y=r.select(y),y=xp(l==null?void 0:l.data,y,r),Ve(this,Xo,y),Ve(this,_i,null)}catch(q){Ve(this,_i,q)}ae(this,_i)&&(b=ae(this,_i),y=ae(this,Xo),S=Date.now(),E="error");const N=p.fetchStatus==="fetching",k=E==="pending",R=E==="error",A=k&&N,D=y!==void 0,O={status:E,fetchStatus:p.fetchStatus,isPending:k,isSuccess:E==="success",isError:R,isInitialLoading:A,isLoading:A,data:y,dataUpdatedAt:p.dataUpdatedAt,error:b,errorUpdatedAt:S,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>x.dataUpdateCount||p.errorUpdateCount>x.errorUpdateCount,isFetching:N,isRefetching:N&&!k,isLoadingError:R&&!D,isPaused:p.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:R&&D,isStale:sg(t,r),refetch:this.refetch,promise:ae(this,Ei)};if(this.options.experimental_prefetchInRender){const q=ee=>{O.status==="error"?ee.reject(O.error):O.data!==void 0&&ee.resolve(O.data)},X=()=>{const ee=Ve(this,Ei,O.promise=mp());q(ee)},U=ae(this,Ei);switch(U.status){case"pending":t.queryHash===a.queryHash&&q(U);break;case"fulfilled":(O.status==="error"||O.data!==U.value)&&X();break;case"rejected":(O.status!=="error"||O.error!==U.reason)&&X();break}}return O}updateResult(){const t=ae(this,pa),r=this.createResult(ae(this,wt),this.options);if(Ve(this,gl,ae(this,wt).state),Ve(this,Wo,this.options),ae(this,gl).data!==void 0&&Ve(this,Yo,ae(this,wt)),gd(r,t))return;Ve(this,pa,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,l=typeof n=="function"?n():n;if(l==="all"||!l&&!ae(this,$o).size)return!0;const o=new Set(l??ae(this,$o));return this.options.throwOnError&&o.add("error"),Object.keys(ae(this,pa)).some(f=>{const d=f;return ae(this,pa)[d]!==t[d]&&o.has(d)})};ht(this,Dt,A4).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ht(this,Dt,yp).call(this)}},Aa=new WeakMap,wt=new WeakMap,J0=new WeakMap,pa=new WeakMap,gl=new WeakMap,Wo=new WeakMap,Ei=new WeakMap,_i=new WeakMap,eu=new WeakMap,Xo=new WeakMap,Yo=new WeakMap,vl=new WeakMap,yl=new WeakMap,ki=new WeakMap,$o=new WeakMap,Dt=new WeakSet,g0=function(t){ht(this,Dt,Sp).call(this);let r=ae(this,wt).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(va)),r},pp=function(){ht(this,Dt,bp).call(this);const t=Ri(this.options.staleTime,ae(this,wt));if(Cl||ae(this,pa).isStale||!dp(t))return;const a=y4(ae(this,pa).dataUpdatedAt,t)+1;Ve(this,vl,setTimeout(()=>{ae(this,pa).isStale||this.updateResult()},a))},gp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ae(this,wt)):this.options.refetchInterval)??!1},vp=function(t){ht(this,Dt,wp).call(this),Ve(this,ki,t),!(Cl||Dn(this.options.enabled,ae(this,wt))===!1||!dp(ae(this,ki))||ae(this,ki)===0)&&Ve(this,yl,setInterval(()=>{(this.options.refetchIntervalInBackground||ng.isFocused())&&ht(this,Dt,g0).call(this)},ae(this,ki)))},yp=function(){ht(this,Dt,pp).call(this),ht(this,Dt,vp).call(this,ht(this,Dt,gp).call(this))},bp=function(){ae(this,vl)&&(clearTimeout(ae(this,vl)),Ve(this,vl,void 0))},wp=function(){ae(this,yl)&&(clearInterval(ae(this,yl)),Ve(this,yl,void 0))},Sp=function(){const t=ae(this,Aa).getQueryCache().build(ae(this,Aa),this.options);if(t===ae(this,wt))return;const r=ae(this,wt);Ve(this,wt,t),Ve(this,J0,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},A4=function(t){Lr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(ae(this,pa))}),ae(this,Aa).getQueryCache().notify({query:ae(this,wt),type:"observerResultsUpdated"})})},jS);function WC(e,t){return Dn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function wb(e,t){return WC(e,t)||e.state.data!==void 0&&Ep(e,t,t.refetchOnMount)}function Ep(e,t,r){if(Dn(t.enabled,e)!==!1&&Ri(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&sg(e,t)}return!1}function Sb(e,t,r,a){return(e!==t||Dn(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&sg(e,r)}function sg(e,t){return Dn(t.enabled,e)!==!1&&e.isStaleByTime(Ri(t.staleTime,e))}function XC(e,t){return!gd(e.getCurrentResult(),t)}var Ti,Ni,ja,Cs,Ms,od,_p,RS,YC=(RS=class extends sc{constructor(r,a){super();Qe(this,Ms);Qe(this,Ti);Qe(this,Ni);Qe(this,ja);Qe(this,Cs);Ve(this,Ti,r),this.setOptions(a),this.bindMethods(),ht(this,Ms,od).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=ae(this,Ti).defaultMutationOptions(r),gd(this.options,a)||ae(this,Ti).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ae(this,ja),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&Al(a.mutationKey)!==Al(this.options.mutationKey)?this.reset():((n=ae(this,ja))==null?void 0:n.state.status)==="pending"&&ae(this,ja).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=ae(this,ja))==null||r.removeObserver(this)}onMutationUpdate(r){ht(this,Ms,od).call(this),ht(this,Ms,_p).call(this,r)}getCurrentResult(){return ae(this,Ni)}reset(){var r;(r=ae(this,ja))==null||r.removeObserver(this),Ve(this,ja,void 0),ht(this,Ms,od).call(this),ht(this,Ms,_p).call(this)}mutate(r,a){var n;return Ve(this,Cs,a),(n=ae(this,ja))==null||n.removeObserver(this),Ve(this,ja,ae(this,Ti).getMutationCache().build(ae(this,Ti),this.options)),ae(this,ja).addObserver(this),ae(this,ja).execute(r)}},Ti=new WeakMap,Ni=new WeakMap,ja=new WeakMap,Cs=new WeakMap,Ms=new WeakSet,od=function(){var a;const r=((a=ae(this,ja))==null?void 0:a.state)??C4();Ve(this,Ni,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},_p=function(r){Lr.batch(()=>{var a,n,l,o,f,d,x,m;if(ae(this,Cs)&&this.hasListeners()){const p=ae(this,Ni).variables,v=ae(this,Ni).context;(r==null?void 0:r.type)==="success"?((n=(a=ae(this,Cs)).onSuccess)==null||n.call(a,r.data,p,v),(o=(l=ae(this,Cs)).onSettled)==null||o.call(l,r.data,null,p,v)):(r==null?void 0:r.type)==="error"&&((d=(f=ae(this,Cs)).onError)==null||d.call(f,r.error,p,v),(m=(x=ae(this,Cs)).onSettled)==null||m.call(x,void 0,r.error,p,v))}this.listeners.forEach(p=>{p(ae(this,Ni))})})},RS),j4=C.createContext(void 0),bt=e=>{const t=C.useContext(j4);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},$C=({client:e,children:t})=>(C.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(j4.Provider,{value:e,children:t})),R4=C.createContext(!1),KC=()=>C.useContext(R4);R4.Provider;function QC(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var ZC=C.createContext(QC()),JC=()=>C.useContext(ZC),eA=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},tA=e=>{C.useEffect(()=>{e.clearReset()},[e])},rA=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(n&&e.data===void 0||S4(r,[e.error,a])),aA=e=>{if(e.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},nA=(e,t)=>e.isLoading&&e.isFetching&&!t,sA=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Eb=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function iA(e,t,r){var p,v,y,b,S;const a=KC(),n=JC(),l=bt(),o=l.defaultQueryOptions(e);(v=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||v.call(p,o),o._optimisticResults=a?"isRestoring":"optimistic",aA(o),eA(o,n),tA(n);const f=!l.getQueryCache().get(o.queryHash),[d]=C.useState(()=>new t(l,o)),x=d.getOptimisticResult(o),m=!a&&e.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(E=>{const _=m?d.subscribe(Lr.batchCalls(E)):va;return d.updateResult(),_},[d,m]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),C.useEffect(()=>{d.setOptions(o)},[o,d]),sA(o,x))throw Eb(o,d,n);if(rA({result:x,errorResetBoundary:n,throwOnError:o.throwOnError,query:l.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw x.error;if((b=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||b.call(y,o,x),o.experimental_prefetchInRender&&!Cl&&nA(x,a)){const E=f?Eb(o,d,n):(S=l.getQueryCache().get(o.queryHash))==null?void 0:S.promise;E==null||E.catch(va).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?x:d.trackResult(x)}function Xr(e,t){return iA(e,qC)}function kt(e,t){const r=bt(),[a]=C.useState(()=>new YC(r,e));C.useEffect(()=>{a.setOptions(e)},[a,e]);const n=C.useSyncExternalStore(C.useCallback(o=>a.subscribe(Lr.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=C.useCallback((o,f)=>{a.mutate(o,f).catch(va)},[a]);if(n.error&&S4(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}const D4={login:"/User/Login",me:"/auth/me"},ic={all:"/event/GetEventsList",byId:e=>`/event/${e}`,create:"/event/Create",update:"/event/Update",updateTableQuantity:"/event/UpdateTableQuantity",activateEvent:e=>`/event/Activate/${e}`,deactivateEvent:e=>`/event/Deactivate/${e}`,previewEvent:"/event/Preview",delete:e=>`/events/${e}`,importRsvps:e=>`/events/${e}/rsvps/import`,exportRsvps:e=>`/events/${e}/rsvps/export`},su={all:e=>`/rsvp/GetRsvp/List/${e}`,forEvent:e=>`/rsvp/GetRsvp/List/${e}`,byId:(e,t)=>`/events/${e}/rsvps/${t}`,create:()=>"/rsvp/Create",update:()=>"/rsvp/Update",delete:()=>"/rsvp/Delete"},Li={all:e=>`/TableArrangement/Summary/${e}`,byId:e=>`/TableArrangement/Summary/${e}`,create:"/TableArrangement/Create",bulkCreate:"/TableArrangement/BulkCreate",update:"/TableArrangement/Update",delete:e=>`/TableArrangement/Delete/${e}`,updateLayout:e=>`/tables/${e}/layout`,tableGuests:e=>`/tables/${e}/guests`,reassignGuest:(e,t)=>`/tables/${e}/guests/${t}/reassign`},iu={all:e=>`/Guest/ByEvent/${e}`,byTable:e=>`/Guest/ByTable/${e}`,assignTable:(e,t)=>`/Guest/${e}/AssignTable/${t}`,unassignTable:e=>`/Guest/${e}/UnassignTable`},lu={all:"/seating",byId:e=>`/seating/${e}`,create:"/seating",update:e=>`/seating/${e}`,delete:e=>`/seating/${e}`},ou={all:"/users",byId:e=>`/users/${e}`,create:"/users",update:e=>`/users/${e}`,delete:e=>`/users/${e}`},ig={getByEvent:e=>`/Wallet/GetWalletByEvent/${e}`,getByGuid:(e,t)=>`/Wallet/${e}?eventId=${t}`,create:"/Wallet/Create",update:"/Wallet/Update",delete:"/Wallet/Delete",activate:e=>`/Wallet/Activate/${e}`,deactivate:e=>`/Wallet/Deactivate/${e}`},Gd={getByWallet:(e,t)=>`/Transaction/${e}/transactions?eventGuid=${t}`,getById:(e,t)=>`/Transaction/${e}?eventGuid=${t}`,create:"/Transaction/Create",update:"/Transaction/Update",delete:"/Transaction/Delete"},Vd={all:e=>`/question/GetQuestions/${e}`,create:()=>"/question/Create",update:()=>"/question/Update",activate:()=>"/question/Activate",deactivate:()=>"/question/Deactivate",delete:(e,t)=>`/events/${e}/rsvp-form-fields/${t}`},F4={submit:e=>`/events/${e}/rsvps/public`,designByToken:e=>`/RsvpDesign/public/${e}`},O4={get:e=>`/RsvpDesign/${e}/design`,save:e=>`/RsvpDesign/${e}/design`,publish:(e,t)=>`/RsvpDesign/${e}/design/${t}/publish`},lA={summary:e=>`/Dashboard/Summary/${e}`};function oA(){const e=bt();return{login:kt({mutationFn:r=>Ze.post(D4.login,r).then(a=>a.data),onSuccess:({token:r})=>{localStorage.setItem("token",r),e.invalidateQueries({queryKey:["me"]})}})}}const lg=C.createContext({user:null,login:async()=>{},logout:()=>{},loading:!1}),km="temp-admin-token",Tm={id:"temp-admin",name:"Admin",email:"admin@bigdays.com"};function cA({children:e}){const{login:t}=oA(),[r,a]=C.useState(()=>localStorage.getItem("token")===km?Tm:null),[n,l]=C.useState(()=>!!localStorage.getItem("token")&&localStorage.getItem("token")!==km),{data:o,isLoading:f}=Xr({queryKey:["me"],queryFn:()=>Ze.get(D4.me).then(m=>m.data),enabled:n}),d=async m=>{if(m.email===Tm.email&&m.password==="Abc123"){localStorage.setItem("token",km),a(Tm);return}await t.mutateAsync(m),l(!0)},x=()=>{localStorage.removeItem("token"),l(!1),a(null),window.location.replace("/login")};return c.jsx(lg.Provider,{value:{user:r??o??null,login:d,logout:x,loading:f||t.isPending},children:e})}function uA(e){return e.toISOString().slice(0,10)}function _b(e){const t=new Date(e).getTime(),r=Date.now(),a=Math.max(t-r,0),n=Math.floor(a/(1e3*60*60*24)),l=Math.floor(a/(1e3*60*60)%24),o=Math.floor(a/(1e3*60)%60),f=Math.floor(a/1e3%60),d=x=>x.toString().padStart(2,"0");return{days:d(n),hours:d(l),minutes:d(o),seconds:d(f)}}function fA(){const e=_a(),t=C.useMemo(()=>{const f=new Date;return f.setDate(f.getDate()+90),uA(f)},[]),[r,a]=C.useState(t),[n,l]=C.useState(()=>_b(t));C.useEffect(()=>{const f=setInterval(()=>l(_b(r)),1e3);return()=>clearInterval(f)},[r]);const o=[{label:"days",value:n.days},{label:"hours",value:n.hours},{label:"minutes",value:n.minutes},{label:"seconds",value:n.seconds}];return c.jsxs("section",{className:"bg-background text-center text-text py-20 space-y-20",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsx("h2",{className:"text-4xl font-playfair italic text-primary",children:"Save The Date"}),c.jsx("p",{className:"text-lg font-semibold",children:"Customize your countdown"}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-center gap-4 max-w-xl mx-auto",children:[c.jsx("label",{className:"text-sm font-semibold text-gray-600",htmlFor:"wedding-date",children:"Wedding date"}),c.jsx("input",{id:"wedding-date",type:"date",value:r,onChange:f=>a(f.target.value),className:"border rounded-lg px-3 py-2 shadow-sm"})]}),c.jsx("div",{className:"flex justify-center gap-6 mt-8 flex-wrap",children:o.map(({label:f,value:d})=>c.jsxs("div",{className:"w-28 h-28 rounded-full border-2 border-secondary flex flex-col justify-center items-center bg-white/60",children:[c.jsx("span",{className:"text-3xl text-primary font-semibold",children:d}),c.jsx("span",{className:"text-sm text-gray-500 uppercase tracking-wide",children:f})]},f))})]}),c.jsx("div",{className:"bg-[#fffaf0] py-16 px-4",children:c.jsxs("div",{className:"max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8 items-center",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Stress-free planning"}),c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Share timelines, notes, and last-minute updates with everyone helping on your big day. Keep your vision aligned without endless chats."})]}),c.jsx("div",{className:"mx-auto",children:c.jsx("img",{src:"https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e",alt:"Bride and Groom",className:"w-64 h-64 object-cover rounded-md shadow-lg"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Designed for both of you"}),c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:"Give guests a beautiful RSVP experience, track VIPs, and manage seating in minutes. No more juggling spreadsheets or scattered tools."})]})]})}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h2",{className:"text-2xl font-semibold",children:"Plan. Invite. Celebrate."}),c.jsx("p",{className:"max-w-xl mx-auto mt-2 text-gray-600",children:"Streamline your wedding with real-time RSVP analytics, seating charts, and guided setup."}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[c.jsx("button",{className:"px-6 py-3 rounded-2xl bg-accent text-white shadow-lg",onClick:()=>e("/app/events?new=1"),children:"Start a new event"}),c.jsx("button",{className:"px-6 py-3 rounded-2xl border-2 border-accent text-accent shadow-lg",onClick:()=>e("/app/events?demo=1"),children:"Explore a demo setup"})]})]})]})}function cu(){return C.useContext(lg)}function $t({label:e,type:t="text",options:r,value:a,onChange:n,required:l=!1,className:o="",name:f,id:d,placeholder:x,disabled:m,autoFocus:p,min:v,max:y,step:b,rows:S=3,hint:E,error:_,emptyOptionLabel:N=" select "}){const k="w-full border rounded p-2 disabled:opacity-60 disabled:cursor-not-allowed",R=_?"border-red-500":"border-gray-300",A=_?"text-red-600":"text-gray-500";return c.jsxs("div",{className:`space-y-1 ${o}`,children:[c.jsxs("label",{htmlFor:d,className:"block font-medium",children:[e,l&&c.jsx("span",{className:"ml-1 text-red-600",children:"*"})]}),t==="textarea"?c.jsx("textarea",{id:d,name:f,rows:S,className:`${k} ${R}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:p}):t==="select"?c.jsxs("select",{id:d,name:f,className:`${k} ${R}`,value:a,onChange:n,disabled:m,required:l,autoFocus:p,children:[c.jsx("option",{value:"",children:N}),r==null?void 0:r.map(D=>c.jsx("option",{value:D,children:D},D))]}):t==="radio"?c.jsx("div",{className:"flex flex-wrap gap-3",children:r==null?void 0:r.map(D=>c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"radio",id:d?`${d}-${D}`:void 0,name:f,value:D,checked:a===D,onChange:n,disabled:m,required:l}),c.jsx("span",{children:D})]},D))}):t==="checkbox"?c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{id:d,name:f,type:"checkbox",checked:a==="true",onChange:D=>{const T={...D,target:{...D.target,value:D.target.checked?"true":"false"}};n(T)},disabled:m,required:l}),c.jsx("span",{children:e})]}):c.jsx("input",{id:d,name:f,type:t,className:`${k} ${R}`,value:a,onChange:n,placeholder:x,disabled:m,required:l,autoFocus:p,min:v,max:y,step:b}),(E||_)&&c.jsx("p",{className:`text-xs ${A}`,children:_??E})]})}const Un=()=>c.jsxs("svg",{className:"animate-spin h-5 w-5 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),Le=({type:e="button",variant:t="primary",loading:r=!1,children:a,className:n="",...l})=>{const o="px-4 py-2 rounded-xl font-semibold inline-flex items-center justify-center transition focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background disabled:opacity-60 disabled:cursor-not-allowed",f=t==="primary"?"bg-gradient-to-r from-primary to-secondary text-white shadow-lg shadow-primary/25 hover:brightness-105 active:translate-y-[1px] focus:ring-primary/40":t==="secondary"?"bg-white text-text border border-primary/15 hover:border-primary/30 hover:bg-primary/5 dark:bg-accent dark:text-white dark:border-white/10 dark:hover:bg-white/10 focus:ring-primary/25":"bg-transparent text-primary hover:bg-primary/10 dark:hover:bg-white/10 focus:ring-primary/15";return c.jsx("button",{type:e,className:`${o} ${f} ${n}`,disabled:r||l.disabled,...l,children:r?c.jsx(Un,{}):a})};function dA(){var v,y;const{login:e,loading:t}=cu(),r=_a(),n=((y=(v=ss().state)==null?void 0:v.from)==null?void 0:y.pathname)||"/app",[l,o]=C.useState(""),[f,d]=C.useState(""),[x,m]=C.useState(null),p=async b=>{var S,E;b.preventDefault(),m(null);try{await e({email:l,password:f}),r(n,{replace:!0})}catch(_){m(((E=(S=_.response)==null?void 0:S.data)==null?void 0:E.message)||"Login failed")}};return c.jsxs("form",{onSubmit:p,className:"max-w-md mx-auto p-6 bg-background text-text space-y-6 ",children:[c.jsx("h2",{className:"text-2xl font-semibold text-center",children:"Sign In"}),c.jsx($t,{label:"Email",type:"email",value:l,onChange:b=>o(b.target.value)}),c.jsx($t,{label:"Password",type:"password",value:f,onChange:b=>d(b.target.value)}),x&&c.jsx("p",{className:"text-red-500 text-sm",children:x}),c.jsx(Le,{type:"submit",variant:"primary",disabled:t,children:t?"Signing in":"Sign In"})]})}function hA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"}))}const O0=C.forwardRef(hA);function xA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"}))}const kp=C.forwardRef(xA);function mA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"}))}const pA=C.forwardRef(mA);function gA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"}))}const vA=C.forwardRef(gA);function yA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}))}const bA=C.forwardRef(yA);function wA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"}))}const SA=C.forwardRef(wA);function EA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const _A=C.forwardRef(EA);function kA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 10h16M4 14h16M4 18h16"}))}const TA=C.forwardRef(kA);function NA(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}const og=C.forwardRef(NA),kb=[{to:"/",label:"HOME"},{to:"/contact",label:"CONTACT"},{to:"/story",label:"STORY"},{to:"/events",label:"EVENTS"},{to:"/people",label:"PEOPLE"},{to:"/gallery",label:"GALLERY"},{to:"/rsvp",label:"RSVP"},{to:"/blog",label:"BLOG"},{to:"/login",label:"LOGIN"}];function CA(){const[e,t]=C.useState(!1);return c.jsxs("header",{className:"bg-background text-text shadow-sm",children:[c.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between py-4 px-6",children:[c.jsx("div",{className:"text-2xl font-playfair italic text-primary",children:"C & C"}),c.jsx("nav",{className:"hidden md:flex space-x-6 font-medium",children:kb.map(({to:r,label:a})=>c.jsx(R0,{to:r,className:({isActive:n})=>n?"text-secondary underline":"hover:text-secondary",children:a},r))}),c.jsx("button",{className:"md:hidden p-2 rounded hover:bg-secondary/10","aria-label":"Toggle menu",onClick:()=>t(r=>!r),children:e?c.jsx(og,{className:"h-6 w-6 text-text"}):c.jsx(pA,{className:"h-6 w-6 text-text"})})]}),e&&c.jsx("nav",{className:"md:hidden bg-background border-t border-gray-200",children:c.jsx("ul",{className:"space-y-1 py-4 px-6 font-medium",children:kb.map(({to:r,label:a})=>c.jsx("li",{children:c.jsx(R0,{to:r,className:({isActive:n})=>n?"block py-2 text-secondary underline":"block py-2 hover:text-secondary",onClick:()=>t(!1),children:a})},r))})})]})}function AA(){return c.jsx("footer",{className:"bg-background text-text py-8 px-6 mt-20",children:c.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-2 text-sm text-gray-600",children:[c.jsxs("p",{children:[" ",new Date().getFullYear()," My Big Day. All rights reserved."]}),c.jsx("p",{children:"Built with  using React, Vite & Tailwind CSS."})]})})}function jA({children:e}){return c.jsxs("div",{className:"min-h-screen bg-background text-text flex flex-col",children:[c.jsx(CA,{}),c.jsx("main",{className:"flex-1 container mx-auto px-4 pt-3",children:e??c.jsx(As,{})}),c.jsx(AA,{})]})}function Tp(e){return{id:e.eventGuid.toString(),title:e.eventName,date:e.eventDate,noOfTable:e.noOfTable,description:e.eventDescription,location:e.eventLocation,raw:e}}function cg(e=!1){return Xr({queryKey:["events",e],queryFn:async()=>{var n;const t=await Ze.get(ic.all),r=Array.isArray((n=t.data)==null?void 0:n.data)?t.data.data:[];return e?r.map(Tp):r.filter(l=>!l.isDeleted).map(Tp)}})}function RA(e,t){return Xr({queryKey:["event",e],enabled:!!e,queryFn:async()=>{var n;const a=(n=(await Ze.get(ic.byId(e))).data)==null?void 0:n.data;if(!a)throw new Error("Event not found");return Tp(a)}})}function DA(){const e=bt();return kt({mutationFn:async t=>(await Ze.post(ic.create,t)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function FA(){const e=bt();return kt({mutationFn:async t=>(await Ze.post(ic.update,t)).data,onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["events"]}),e.invalidateQueries({queryKey:["event",r.eventGuid]})}})}function M4(){const e=bt();return kt({mutationFn:async t=>(console.log("[mutate] activate",t),(await Ze.put(ic.activateEvent(t))).data),onSuccess:()=>{e.invalidateQueries({queryKey:["events"]})}})}function L4(){const e=bt();return kt({mutationFn:async t=>(console.log("[mutate] deactivate",t),(await Ze.put(ic.deactivateEvent(t))).data),onMutate:t=>{console.log("[onMutate] deactivating",t)},onSuccess:(t,r)=>{console.log("[onSuccess] deactivated",r),e.invalidateQueries({queryKey:["events"]})},onError:(t,r)=>{console.error("[onError] deactivating",r,t)}})}const B4=C.createContext({eventId:void 0,event:void 0,events:[],isSelectorOpen:!1,mustChooseEvent:!1,setEventId:()=>{},openSelector:()=>{},closeSelector:()=>{}});function OA({children:e}){const{data:t}=cg(),[r,a]=C.useState(()=>localStorage.getItem("eventId")||void 0),[n,l]=C.useState(!1),o=!r,f=p=>{localStorage.setItem("eventId",p),a(p),l(!1)},d=()=>l(!0),x=()=>{o||l(!1)},m=t==null?void 0:t.find(p=>p.id===r);return c.jsx(B4.Provider,{value:{eventId:r,event:m,events:t,isSelectorOpen:n,mustChooseEvent:o,setEventId:f,openSelector:d,closeSelector:x},children:e})}function Yr(){return C.useContext(B4)}var Nm,Tb;function MA(){if(Tb)return Nm;Tb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"}))}return Nm=e.forwardRef(t),Nm}var LA=MA();const BA=Bn(LA);var Cm,Nb;function PA(){if(Nb)return Cm;Nb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"}))}return Cm=e.forwardRef(t),Cm}var IA=PA();const UA=Bn(IA);var Am,Cb;function zA(){if(Cb)return Am;Cb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"}))}return Am=e.forwardRef(t),Am}var HA=zA();const GA=Bn(HA);function VA({onMenuToggle:e}){const{theme:t,toggle:r}=QN(),{event:a}=Yr();return c.jsxs("header",{className:"sticky top-0 z-40 flex items-center gap-4 px-6 py-3 bg-background/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-primary/10 dark:border-white/10",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[e&&c.jsx("button",{className:"md:hidden p-2 rounded-lg text-text/70 hover:bg-primary/5 dark:text-white/70 dark:hover:bg-white/10 transition",onClick:e,"aria-label":"Toggle sidebar",children:c.jsx(BA,{className:"h-5 w-5"})}),a&&c.jsxs("div",{className:"hidden md:flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-text/50 dark:text-white/50",children:a.title}),a.date&&c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-text/20 dark:text-white/20",children:"/"}),c.jsx("span",{className:"text-text/40 dark:text-white/40",children:new Date(a.date).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})})]})]})]}),c.jsx("div",{className:"flex-1"}),c.jsx("button",{onClick:r,"aria-label":"Toggle dark mode",className:"p-2 rounded-lg text-text/50 hover:text-text hover:bg-primary/5 dark:text-white/50 dark:hover:text-white dark:hover:bg-white/10 transition",children:t==="light"?c.jsx(UA,{className:"h-5 w-5"}):c.jsx(GA,{className:"h-5 w-5"})})]})}var jm,Ab;function qA(){if(Ab)return jm;Ab=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}return jm=e.forwardRef(t),jm}var WA=qA();const XA=Bn(WA);var Rm,jb;function YA(){if(jb)return Rm;jb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"}))}return Rm=e.forwardRef(t),Rm}var $A=YA();const KA=Bn($A);var Dm,Rb;function QA(){if(Rb)return Dm;Rb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"}))}return Dm=e.forwardRef(t),Dm}var ZA=QA();const JA=Bn(ZA);var Fm,Db;function e6(){if(Db)return Fm;Db=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"}))}return Fm=e.forwardRef(t),Fm}var t6=e6();const Fb=Bn(t6);var Om,Ob;function r6(){if(Ob)return Om;Ob=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"}))}return Om=e.forwardRef(t),Om}var a6=r6();const n6=Bn(a6);var Mm,Mb;function s6(){if(Mb)return Mm;Mb=1;const e=La();function t(a,n){return e.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},a),e.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"}))}return Mm=e.forwardRef(t),Mm}var i6=s6();const l6=Bn(i6);function o6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"}))}const cd=C.forwardRef(o6);function c6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const u6=C.forwardRef(c6);function f6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const M0=C.forwardRef(f6);function d6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),C.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"}))}const Lb=C.forwardRef(d6);function h6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),C.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"}))}const x6=C.forwardRef(h6);function m6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"}))}const p6=C.forwardRef(m6);function g6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),C.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"}))}const Np=C.forwardRef(g6);function v6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"}))}const y6=C.forwardRef(v6);function b6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"}))}const w6=C.forwardRef(b6);function S6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"}))}const E6=C.forwardRef(S6);function _6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),C.createElement("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"}))}const Bb=C.forwardRef(_6);function k6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z",clipRule:"evenodd"}))}const T6=C.forwardRef(k6);function N6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M5 4a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H5zm-1 9v-1h5v2H5a1 1 0 01-1-1zm7 1h4a1 1 0 001-1v-1h-5v2zm0-4h5V8h-5v2zM9 8H4v2h5V8z",clipRule:"evenodd"}))}const Cp=C.forwardRef(N6);function C6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"}))}const ud=C.forwardRef(C6);function A6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"}))}const fd=C.forwardRef(A6);function j6(e,t){return C.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:t},e),C.createElement("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"}))}const R6=C.forwardRef(j6),D6=[{to:"/app/dashboard",label:"Dashboard",Icon:w6},{to:"/app/events",label:"Events",Icon:cd},{to:"/app/rsvps",label:"RSVPs",Icon:x6},{to:"/app/guests",label:"Guests",Icon:ud},{to:"/app/tables",label:"Tables",Icon:Cp,end:!0},{to:"/app/tables/floorplan",label:"Floor Plan",Icon:R6},{to:"/app/wallet",label:"Wallet",Icon:Np},{to:"/app/users",label:"Users",Icon:fd}];function F6({isOpen:e,onClose:t}){const{event:r,openSelector:a,mustChooseEvent:n}=Yr(),{user:l,logout:o}=cu(),[f,d]=bl.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`
          fixed inset-0 bg-black/30 z-20 transition-opacity md:hidden
          ${e?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
        `,onClick:t}),c.jsx("aside",{className:`
          fixed inset-y-0 left-0 w-72 text-text
          bg-background border-r border-primary/10
          dark:bg-slate-900 dark:border-white/10 dark:text-white
          z-30 transform transition-all
          ${e?"translate-x-0":"-translate-x-full"}
          md:static md:translate-x-0
          ${f?"md:w-20":"md:w-64"}
        `,children:c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:`flex items-center justify-between px-4 py-4 border-b border-primary/10 dark:border-white/10 ${f?"md:px-3":"md:px-5"}`,children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"h-9 w-9 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center flex-shrink-0",children:c.jsx(y6,{className:"h-5 w-5"})}),!f&&c.jsx("span",{className:"text-sm font-semibold tracking-tight",children:"My Big Days"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{className:"hidden md:inline-flex p-1.5 rounded-lg text-text/50 hover:text-text hover:bg-primary/5 dark:text-white/40 dark:hover:text-white dark:hover:bg-white/10 transition",onClick:()=>d(x=>!x),"aria-label":f?"Expand sidebar":"Collapse sidebar",children:f?c.jsx(JA,{className:"h-4 w-4"}):c.jsx(KA,{className:"h-4 w-4"})}),c.jsx("button",{className:"md:hidden p-1.5 rounded-lg text-text/50 hover:text-text transition",onClick:t,"aria-label":"Close sidebar",children:c.jsx(XA,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:`flex-1 overflow-y-auto py-3 space-y-3 ${f?"md:px-2":"px-3"}`,children:[c.jsxs("div",{className:"px-1",children:[c.jsx("button",{onClick:a,className:`w-full rounded-xl p-3 text-left transition
                  bg-primary/5 hover:bg-primary/10 border border-primary/10
                  dark:bg-white/5 dark:hover:bg-white/10 dark:border-white/10
                  ${f?"px-2 py-3 flex justify-center":""}
                `,children:c.jsxs("div",{className:`flex items-center gap-3 ${f?"justify-center":""}`,children:[c.jsx(T6,{className:`h-5 w-5 flex-shrink-0 ${n?"text-amber-500":"text-primary"}`}),!f&&c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:`text-[11px] uppercase tracking-wide font-medium ${n?"text-amber-600 dark:text-amber-400":"text-text/50 dark:text-white/50"}`,children:n?"Select an event":"Current event"}),c.jsx("p",{className:"text-sm font-semibold truncate",children:(r==null?void 0:r.title)??"No event selected"})]}),!f&&c.jsx(l6,{className:"h-4 w-4 text-text/30 dark:text-white/30 flex-shrink-0"})]})}),n&&!f&&c.jsx("p",{className:"mt-2 text-xs text-amber-700 dark:text-amber-300 bg-amber-50 dark:bg-amber-500/10 border border-amber-200 dark:border-amber-500/20 rounded-lg px-3 py-2",children:"Select an event to get started."})]}),c.jsx("nav",{className:"space-y-0.5",children:D6.map(({to:x,label:m,Icon:p,end:v})=>c.jsxs(R0,{to:x,end:v,title:m,onClick:t,className:({isActive:y})=>`group flex items-center gap-3 ${f?"justify-center px-2":"px-3"} py-2.5 rounded-lg transition-colors text-sm
                     ${y?"bg-primary/10 text-primary font-semibold dark:bg-primary/20 dark:text-primary":"text-text/70 hover:bg-primary/5 hover:text-text dark:text-white/60 dark:hover:bg-white/5 dark:hover:text-white"}`,children:[c.jsx(p,{className:"h-5 w-5 flex-shrink-0"}),!f&&c.jsx("span",{children:m})]},x))})]}),c.jsx("div",{className:"border-t border-primary/10 dark:border-white/10 p-3",children:f?c.jsx("button",{onClick:o,className:"w-full flex justify-center p-2 rounded-lg text-text/40 hover:text-red-500 hover:bg-red-50 dark:text-white/30 dark:hover:text-red-400 dark:hover:bg-red-500/10 transition","aria-label":"Logout",children:c.jsx(Fb,{className:"h-5 w-5"})}):c.jsxs("div",{className:"flex items-center gap-3 px-2 py-2",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 dark:bg-white/10 grid place-items-center flex-shrink-0",children:c.jsx(n6,{className:"h-5 w-5 text-primary dark:text-white/70"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium truncate",children:(l==null?void 0:l.name)??"User"}),c.jsx("p",{className:"text-xs text-text/50 dark:text-white/40 truncate",children:(l==null?void 0:l.email)??""})]}),c.jsx("button",{onClick:o,className:"p-1.5 rounded-lg text-text/40 hover:text-red-500 hover:bg-red-50 dark:text-white/30 dark:hover:text-red-400 dark:hover:bg-red-500/10 transition","aria-label":"Logout",children:c.jsx(Fb,{className:"h-4 w-4"})})]})})]})})]})}const zn=({isOpen:e,title:t,onClose:r,children:a,className:n=""})=>e?c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-100",children:c.jsxs("div",{className:"bg-background text-text rounded-lg shadow-lg max-w-lg w-full p-6 "+n,children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:t&&c.jsx("h3",{className:"text-lg font-semibold",children:t})}),c.jsx("div",{children:a})]})}):null,uu=({message:e})=>c.jsx("div",{className:"p-2 bg-red-100 text-red-800 rounded text-sm mb-4",children:e});function Pb(e){if(!e)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(isNaN(t.getTime()))return e.slice(0,10);const r=t.getTimezoneOffset()*6e4;return new Date(t.getTime()-r).toISOString().slice(0,10)}const qd=({isOpen:e,onClose:t,onSuccess:r,initial:a,className:n=""})=>{const[l,o]=C.useState((a==null?void 0:a.title)||""),[f,d]=C.useState(Pb(a==null?void 0:a.date)),[x,m]=C.useState(a!=null&&a.noOfTable?Number(a.noOfTable):0),[p,v]=C.useState((a==null?void 0:a.description)||""),[y,b]=C.useState((a==null?void 0:a.location)||""),S=DA(),E=FA(),[_,N]=C.useState(null);C.useEffect(()=>{e&&(o((a==null?void 0:a.title)||""),d(Pb(a==null?void 0:a.date)),m(a!=null&&a.noOfTable?Number(a.noOfTable):0),v((a==null?void 0:a.description)||""),b((a==null?void 0:a.location)||""),N(null))},[e,a]);const k=!!a,R=async A=>{var D,T;A.preventDefault();try{if(k&&a){const O=await E.mutateAsync({eventGuid:a.id,name:l,date:f,time:"",description:p,location:y,userID:0,noOfTable:x});r==null||r(O)}else{const O=await S.mutateAsync({name:l,date:f,description:p,location:y,userID:"0",noOfTable:x.toString()});r==null||r(O)}t()}catch(O){console.error(O),N(((T=(D=O.response)==null?void 0:D.data)==null?void 0:T.message)||"Something went wrong.")}};return c.jsx(zn,{isOpen:e,onClose:t,title:k?"Edit Event":"New Event",className:n,children:c.jsxs("form",{onSubmit:R,className:"space-y-4",children:[_&&c.jsx(uu,{message:_}),c.jsx($t,{label:"Title",value:l,onChange:A=>o(A.target.value)}),c.jsx($t,{label:"Date",type:"date",value:f,onChange:A=>d(A.target.value)}),c.jsx($t,{label:"Number of Tables",type:"number",value:x.toString(),onChange:A=>m(Number(A.target.value))}),c.jsx($t,{label:"Description",value:p,onChange:A=>v(A.target.value)}),c.jsx($t,{label:"Location",value:y,onChange:A=>b(A.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),c.jsx(Le,{type:"submit",variant:"primary",loading:S.isPending||E.isPending,children:k?E.isPending?"Saving":"Save":S.isPending?"Creating":"Create"})]})]})})};function O6(){const{isSelectorOpen:e,mustChooseEvent:t,events:r=[],eventId:a,setEventId:n,closeSelector:l}=Yr(),o=L4(),f=M4(),[d,x]=C.useState(!1),[m,p]=C.useState(void 0);if(!(t||e))return null;const y=T=>{n(T)},b=()=>{p(void 0),x(!0)},S=T=>{p(T),x(!0)},E=T=>o.mutate(T),_=T=>f.mutate(T),N=()=>x(!1),k=T=>{n(T.id),x(!1)},R=t?"Choose an event to unlock your dashboard":"Switch the event you're working on",A=t?"Pick an existing celebration or create a new one to continue planning.":"Keep everything in sync by switching the active event for tables, RSVPs, and wallet.",D=()=>{t||l()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-50 transition-opacity",onClick:D}),c.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center p-4 overflow-auto",children:c.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl grid md:grid-cols-[1fr_1.15fr] overflow-hidden border border-primary/10",children:[c.jsxs("div",{className:"relative bg-gradient-to-br from-primary via-slate-900 to-secondary text-white p-8 flex flex-col gap-6",children:[c.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_18%_22%,rgba(255,255,255,0.08),transparent_35%),radial-gradient(circle_at_88%_12%,rgba(255,255,255,0.12),transparent_35%)]"}),c.jsxs("div",{className:"relative space-y-3",children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-indigo-200/80 font-semibold",children:"Event workspace"}),c.jsx("h2",{className:"text-2xl font-bold leading-tight",children:R}),c.jsx("p",{className:"text-indigo-100/90 text-sm max-w-md",children:A})]}),c.jsxs("div",{className:"relative grid grid-cols-1 gap-3 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(vA,{className:"w-5 h-5 text-amber-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Unified status"}),c.jsx("p",{className:"text-indigo-100/80",children:"Tables, RSVPs, wallet and seating stay on the active event."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(SA,{className:"w-5 h-5 text-sky-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Safe switching"}),c.jsx("p",{className:"text-indigo-100/80",children:"Change events without altering any of your existing data."})]})]}),c.jsxs("div",{className:"flex items-center gap-3 bg-white/10 border border-white/10 rounded-xl p-3",children:[c.jsx(bA,{className:"w-5 h-5 text-emerald-200"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Quick create"}),c.jsx("p",{className:"text-indigo-100/80",children:"Start a fresh celebration directly from this selector."})]})]})]}),c.jsxs("div",{className:"relative mt-auto",children:[c.jsx(Le,{onClick:b,className:"w-full justify-center bg-white text-primary hover:bg-primary/10",children:"Start a new event"}),c.jsx("p",{className:"text-xs text-indigo-100/80 text-center mt-3",children:"You'll return here whenever you need to focus on a different event."})]})]}),c.jsxs("div",{className:"flex flex-col bg-accent/30",children:[c.jsxs("div",{className:"flex items-start justify-between px-6 py-5 border-b border-gray-200",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Event library"}),c.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Active & archived plans"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Select an event to continue. Everything else stays intact."})]}),c.jsx("button",{onClick:l,className:"p-2 rounded-full border text-gray-500 hover:bg-gray-100 transition disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Close selector",disabled:t,children:c.jsx(og,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-3 scrollbar-thin scrollbar-thumb-primary/20",children:r.length===0?c.jsx("div",{className:"h-full min-h-[280px] flex items-center justify-center text-center p-6 bg-white rounded-xl border border-dashed border-primary/20",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-lg font-semibold text-slate-900",children:"No events yet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create your first celebration to unlock the dashboard experience."}),c.jsx(Le,{onClick:b,children:"Create an event"})]})}):c.jsx("ul",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:r.map(T=>{var X;const O=a===T.id,F=!!((X=T==null?void 0:T.raw)!=null&&X.isDeleted),q=T.date?new Date(T.date).toLocaleDateString():"Date pending";return c.jsxs("li",{role:"option","aria-selected":O,tabIndex:0,onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),y(T.id))},onClick:()=>y(T.id),className:`group relative rounded-xl border transition shadow-sm bg-white cursor-pointer outline-none ${O?"border-primary ring-2 ring-primary/25 shadow-primary/15":"border-primary/10 hover:border-primary/30 hover:shadow-md focus:ring-2 focus:ring-primary/25"}`,children:[c.jsx("div",{className:"absolute right-3 top-3",children:O?c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-indigo-50 text-indigo-700",children:[c.jsx(M0,{className:"w-4 h-4"})," Active"]}):F?c.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-amber-50 text-amber-700",children:"Archived"}):c.jsx("span",{className:"inline-flex items-center px-2 py-1 text-[11px] font-semibold rounded-full bg-slate-100 text-slate-700",children:"Ready"})}),c.jsxs("div",{className:"px-4 pt-5 pb-4 space-y-2",children:[c.jsxs("h4",{className:"text-base font-semibold text-slate-900 pr-20 flex items-center gap-2",children:[c.jsx("span",{className:`inline-flex h-2.5 w-2.5 rounded-full ${O?"bg-emerald-500":"bg-primary"}`}),T.title]}),c.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(O0,{className:"w-4 h-4"}),c.jsx("span",{children:q})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(kp,{className:"w-4 h-4"}),c.jsx("span",{children:T.location||"Add a venue"})]})]}),T.description&&c.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 flex-wrap",children:[c.jsxs("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:["Tables: ",T.noOfTable??"-"]}),c.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/70",children:F?"Archived plan":"Live plan"})]})]}),c.jsxs("div",{className:"px-4 pb-4 pt-2 flex flex-wrap gap-2",children:[c.jsx(Le,{onClick:U=>{U.stopPropagation(),y(T.id)},className:`flex-1 justify-center ${O?"bg-emerald-600 hover:bg-emerald-500":""}`,children:O?"Using this event":"Use this event"}),c.jsx(Le,{variant:"secondary",onClick:U=>{U.stopPropagation(),S(T)},children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:U=>{U.stopPropagation(),F?_(T.id):E(T.id)},children:F?"Activate":"Archive"})]})]},T.id)})})}),c.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex flex-wrap gap-3 items-center justify-between bg-white",children:[c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500"}),c.jsx("span",{children:t?"Choose an event to continue":"Switch anytime without losing changes"})]}),c.jsxs("div",{className:"flex gap-2",children:[!t&&c.jsx(Le,{variant:"secondary",onClick:l,children:"Cancel"}),c.jsx(Le,{onClick:b,children:"Create new event"})]})]})]})]})}),c.jsx(qd,{isOpen:d,initial:m,onClose:N,onSuccess:k,className:"z-70"})]})}function M6(){const[e,t]=bl.useState(!1),{isSelectorOpen:r,mustChooseEvent:a}=Yr();return c.jsxs("div",{className:"flex h-screen bg-background dark:bg-slate-950 text-text",children:[c.jsx(F6,{isOpen:e,onClose:()=>t(!1)}),c.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[c.jsx(VA,{onMenuToggle:()=>t(n=>!n)}),c.jsx("main",{className:"flex-1 p-6 overflow-auto",children:c.jsx(As,{})})]}),(a||r)&&c.jsx(O6,{})]})}const Ka=({message:e="Loading..."})=>c.jsxs("div",{className:"flex flex-col items-center justify-center py-32 gap-4 animate-fade-in",children:[c.jsx("div",{className:"text-primary",children:c.jsx(Un,{})}),c.jsx("p",{className:"text-sm text-text/50 dark:text-white/50",children:e})]});function L6(){const[e,t]=C.useState(!1),{data:r=[],isLoading:a,isError:n}=cg(e),l=L4(),o=M4(),[f,d]=C.useState({open:!1}),x=_a(),{setEventId:m,eventId:p}=Yr(),[v,y]=C.useState(""),[b,S]=C.useState("upcoming"),[E,_]=qN();C.useEffect(()=>{const T=E.get("new")==="1",O=E.get("demo")==="1";if(T||O){const F=new Date;F.setMonth(F.getMonth()+2);const q=O?{title:"Sample Summer Wedding",date:F.toISOString().slice(0,10),description:"Pre-fill details to see how planning works.",location:"Pick your dream venue",noOfTable:12}:void 0;d({open:!0,event:q});const X=new URLSearchParams(E);X.delete("new"),X.delete("demo"),_(X,{replace:!0})}},[E,_]);const N=C.useMemo(()=>r.find(T=>T.id===p),[r,p]),k=C.useMemo(()=>{const T=v.toLowerCase();return r.filter(F=>{var q;return F.title.toLowerCase().includes(T)||((q=F.location)==null?void 0:q.toLowerCase().includes(T))}).sort((F,q)=>{if(b==="name")return F.title.localeCompare(q.title);const X=new Date(F.date).getTime(),U=new Date(q.date).getTime();return b==="upcoming"?X-U:U-X})},[r,v,b]),R=r.filter(T=>{var O;return!((O=T.raw)!=null&&O.isDeleted)}).length,A=r.filter(T=>{var O;return(O=T.raw)==null?void 0:O.isDeleted}).length,D=r.length?new Date(Math.min(...r.map(T=>new Date(T.date).getTime()).filter(T=>!Number.isNaN(T)))):void 0;return a?c.jsx(Ka,{message:"Loading events..."}):n?c.jsx("p",{children:"Failed to load events."}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Your Events"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Prioritize the next celebration or revisit archived plans."})]}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsxs(Le,{variant:e?"primary":"secondary",onClick:()=>t(T=>!T),children:[e?"Hide":"Show"," archived"]})})]}),N&&c.jsxs("div",{className:"p-4 rounded-xl border border-primary/25 bg-white shadow-sm shadow-primary/10 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(M0,{className:"w-6 h-6 text-primary mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-primary font-semibold",children:"Active event"}),c.jsx("p",{className:"text-lg font-semibold text-gray-800",children:N.title}),c.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[c.jsx(O0,{className:"w-4 h-4"}),new Date(N.date).toLocaleDateString()," ",c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(kp,{className:"w-4 h-4"}),N.location||"Add a venue"]})]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Le,{onClick:()=>x("/app/rsvps"),children:"Continue planning"}),c.jsx(Le,{variant:"secondary",onClick:()=>x(`${N.id}/form-fields`),children:"Customize fields"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Active events"}),c.jsx("p",{className:"text-2xl font-semibold text-primary",children:R})]}),c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Archived events"}),c.jsx("p",{className:"text-2xl font-semibold text-secondary",children:A})]}),c.jsxs("div",{className:"p-4 rounded-lg bg-white shadow-sm border border-primary/10",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Upcoming next"}),c.jsx("p",{className:"text-md text-gray-700",children:D?D.toLocaleDateString():"Add a date"})]})]}),c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[c.jsxs("div",{className:"flex flex-1 gap-3",children:[c.jsx("input",{type:"search",value:v,onChange:T=>y(T.target.value),placeholder:"Search by name or location",className:"w-full border border-primary/20 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary/20"}),c.jsxs("select",{value:b,onChange:T=>S(T.target.value),className:"border border-primary/20 rounded-lg px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-primary/20",children:[c.jsx("option",{value:"upcoming",children:"Soonest first"}),c.jsx("option",{value:"recent",children:"Most recent"}),c.jsx("option",{value:"name",children:"Alphabetical"})]})]}),c.jsxs("div",{className:"hidden lg:block text-right text-sm text-gray-500",children:["Welcome to ",c.jsx("span",{className:"text-secondary font-semibold",children:"My Big Day"})]})]}),k.length===0?c.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70",children:[c.jsx("p",{className:"text-lg font-semibold",children:"No events match your filters."}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create one to start planning or clear the search."}),c.jsx(Le,{onClick:()=>d({open:!0}),children:"Create your first event"})]}):c.jsx("ul",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:k.map(T=>{var q;const O=p===T.id,F=!!((q=T==null?void 0:T.raw)!=null&&q.isDeleted);return c.jsx("li",{className:`p-4 rounded-xl border shadow-sm transition hover:shadow-md bg-white/90 backdrop-blur dark:bg-gray-800 ${O?"border-primary":"border-gray-100"}`,children:c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:T.title}),O&&c.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-semibold px-2 py-0.5 rounded-full bg-primary/10 text-primary",children:[c.jsx(M0,{className:"w-4 h-4"})," Active"]}),F&&c.jsx("span",{className:"inline-block text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800",children:"Archived"})]}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex flex-wrap items-center gap-2",children:[c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx(O0,{className:"w-4 h-4"}),new Date(T.date).toLocaleDateString()]}),c.jsxs("span",{className:"inline-flex items-center gap-1",children:[c.jsx(kp,{className:"w-4 h-4"}),T.location||"Add a venue"]})]}),T.description&&c.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:T.description}),c.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-3",children:[c.jsxs("span",{children:["Tables: ",T.noOfTable??"Not set"]}),c.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-300"}),c.jsx("span",{children:F?"Archived plan":"Ready for guests"})]})]}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx(Le,{onClick:()=>{m(T.id),x("/app/rsvps")},children:O?" Active":"Select event"}),c.jsx(Le,{variant:"secondary",onClick:()=>x(`${T.id}/form-fields`),children:"Form fields"}),c.jsx(Le,{variant:"secondary",onClick:()=>x(`${T.id}/edit`),children:"Edit details"}),F?c.jsx(Le,{variant:"primary",style:{backgroundColor:"#16a34a",borderColor:"#16a34a"},onClick:()=>o.mutate(T.id),disabled:o.isPending,children:o.isPending?"Activating":"Activate"}):c.jsx(Le,{variant:"secondary",style:{backgroundColor:"#dc2626",borderColor:"#dc2626"},onClick:()=>l.mutate(T.id),disabled:l.isPending,children:l.isPending?"Deactivating":"Archive"})]})]})},T.id)})}),c.jsx(qd,{isOpen:f.open,onClose:()=>d({open:!1}),onSuccess:()=>d({open:!1}),initial:f.event})]}),c.jsx(As,{})]})}function B6(){const{id:e}=yn(),t=_a(),{data:r,isLoading:a,isError:n}=RA(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Un,{})}):n||!r?c.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load Event."}):c.jsx(qd,{isOpen:!0,initial:r,onClose:()=>t(-1)})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yd={};yd.version="0.18.5";var P4=1252,P6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ug={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fg=function(e){P6.indexOf(e)!=-1&&(P4=ug[0]=e)};function I6(){fg(1252)}var Fn=function(e){fg(e)};function dg(){Fn(1200),I6()}function Ib(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function U6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function I4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var v0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?U6(e.slice(2)):t==254&&r==255?I4(e.slice(2)):t==65279?e.slice(1):e},Pf=function(t){return String.fromCharCode(t)},Ub=function(t){return String.fromCharCode(t)},L0,Ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function B0(e){for(var t="",r=0,a=0,n=0,l=0,o=0,f=0,d=0,x=0;x<e.length;)r=e.charCodeAt(x++),l=r>>2,a=e.charCodeAt(x++),o=(r&3)<<4|a>>4,n=e.charCodeAt(x++),f=(a&15)<<2|n>>6,d=n&63,isNaN(a)?f=d=64:isNaN(n)&&(d=64),t+=Ci.charAt(l)+Ci.charAt(o)+Ci.charAt(f)+Ci.charAt(d);return t}function $a(e){var t="",r=0,a=0,n=0,l=0,o=0,f=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Ci.indexOf(e.charAt(x++)),o=Ci.indexOf(e.charAt(x++)),r=l<<2|o>>4,t+=String.fromCharCode(r),f=Ci.indexOf(e.charAt(x++)),a=(o&15)<<4|f>>2,f!==64&&(t+=String.fromCharCode(a)),d=Ci.indexOf(e.charAt(x++)),n=(f&3)<<6|d,d!==64&&(t+=String.fromCharCode(n));return t}var mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Is=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Di(e){return mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zb(e){return mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Wa=function(t){return mt?Is(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wd(e){if(typeof ArrayBuffer>"u")return Wa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Bi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function z6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function hg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return hg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var qr=mt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Is(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function H6(e){for(var t=[],r=0,a=e.length+250,n=Di(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var f=e.charCodeAt(++l)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|f>>6&15|(o&3)<<4,n[r++]=128|f&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Di(65535),a=65530)}return t.push(n.slice(0,r)),qr(t)}var Ea=/\u0000/g,y0=/[\u0001-\u0006]/g;function Fo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function On(e,t){var r=""+e;return r.length>=t?r:xr("0",t-r.length)+r}function xg(e,t){var r=""+e;return r.length>=t?r:xr(" ",t-r.length)+r}function bd(e,t){var r=""+e;return r.length>=t?r:r+xr(" ",t-r.length)}function G6(e,t){var r=""+Math.round(e);return r.length>=t?r:xr("0",t-r.length)+r}function V6(e,t){var r=""+e;return r.length>=t?r:xr("0",t-r.length)+r}var Hb=Math.pow(2,32);function ko(e,t){if(e>Hb||e<-Hb)return G6(e,t);var r=Math.round(e);return V6(r,t)}function wd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Gb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function q6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var rt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Vb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},W6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Sd(e,t,r){for(var a=e<0?-1:1,n=e*a,l=0,o=1,f=0,d=1,x=0,m=0,p=Math.floor(n);x<t&&(p=Math.floor(n),f=p*o+l,m=p*x+d,!(n-p<5e-8));)n=1/(n-p),l=o,o=f,d=x,x=m;if(m>t&&(x>t?(m=d,f=l):(m=x,f=o)),!r)return[0,a*f,m];var v=Math.floor(a*f/m);return[v,a*f-v*m,m]}function cl(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),l=0,o=[],f={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),t&&t.date1904&&(a+=1462),f.u>.9999&&(f.u=0,++n==86400&&(f.T=n=0,++a,++f.D)),a===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),a<60&&(l=(l+6)%7),r&&(l=Z6(d,o))}return f.y=o[0],f.m=o[1],f.d=o[2],f.S=n%60,n=Math.floor(n/60),f.M=n%60,n=Math.floor(n/60),f.H=n,f.q=l,f}var U4=new Date(1899,11,31,0,0,0),X6=U4.getTime(),Y6=new Date(1900,2,1,0,0,0);function z4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Y6&&(r+=24*60*60*1e3),(r-(X6+(e.getTimezoneOffset()-U4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function K6(e){var t=e<0?12:11,r=mg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Q6(e){var t=mg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function P0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=K6(e):t===10?r=e.toFixed(10).substr(0,12):r=Q6(e),mg($6(r.toUpperCase()))}function jl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):P0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gn(14,z4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Z6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function J6(e,t,r,a){var n="",l=0,o=0,f=r.y,d,x=0;switch(e){case 98:f=r.y+543;case 121:switch(t.length){case 1:case 2:d=f%100,x=2;break;default:d=f%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,x=t.length;break;case 3:return Lm[r.m-1][1];case 5:return Lm[r.m-1][0];default:return Lm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,x=t.length;break;case 3:return Gb[r.q][0];default:return Gb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?On(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(n=On(l,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:d=f,x=1;break}var m=x>0?On(d,x):"";return m}function Ai(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var H4=/%/g;function ej(e,t,r){var a=t.replace(H4,""),n=t.length-a.length;return Ds(e,a,r*Math.pow(10,2*n))+xr("%",n)}function tj(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ds(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function G4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+G4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,x,m){return d+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var V4=/# (\?+)( ?)\/( ?)(\d+)/;function rj(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),l=Math.floor(n/a),o=n-l*a,f=a;return r+(l===0?"":""+l)+" "+(o===0?xr(" ",e[1].length+1+e[4].length):xg(o,e[1].length)+e[2]+"/"+e[3]+On(f,e[4].length))}function aj(e,t,r){return r+(t===0?"":""+t)+xr(" ",e[1].length+2+e[4].length)}var q4=/^#*0*\.([0#]+)/,W4=/\).*[0#]/,X4=/\(###\) ###\\?-####/;function ya(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function qb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Wb(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function nj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function sj(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function cn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cn("n",a,r):"("+cn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tj(e,t,r);if(t.indexOf("%")!==-1)return ej(e,t,r);if(t.indexOf("E")!==-1)return G4(t,r);if(t.charCodeAt(0)===36)return"$"+cn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,f,d=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+ko(d,t.length);if(t.match(/^[#?]+$/))return n=ko(r,0),n==="0"&&(n=""),n.length>t.length?n:ya(t.substr(0,t.length-n.length))+n;if(l=t.match(V4))return rj(l,d,x);if(t.match(/^#+0+$/))return x+ko(d,t.length-t.indexOf("0"));if(l=t.match(q4))return n=qb(r,l[1].length).replace(/^([^\.]+)$/,"$1."+ya(l[1])).replace(/\.$/,"."+ya(l[1])).replace(/\.(\d*)$/,function(b,S){return"."+S+xr("0",ya(l[1]).length-S.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+qb(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Ai(ko(d,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cn(e,t,-r):Ai(""+(Math.floor(r)+nj(r,l[1].length)))+"."+On(Wb(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return cn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fo(cn(e,t.replace(/[\\-]/g,""),r)),o=0,Fo(Fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(t.match(X4))return n=cn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=Sd(d,Math.pow(10,o)-1,!1),n=""+x,m=Ds("n",l[1],f[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=bd(f[2],o),m.length<l[4].length&&(m=ya(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=Sd(d,Math.pow(10,o)-1,!0),x+(f[0]||(f[1]?"":"0"))+" "+(f[1]?xg(f[1],o)+l[2]+"/"+l[3]+bd(f[2],o):xr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=ko(r,0),t.length<=n.length?n:ya(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var p=t.indexOf(".")-o,v=t.length-n.length-p;return ya(t.substr(0,p)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=Wb(r,l[1].length),r<0?"-"+cn(e,t,-r):Ai(sj(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?On(0,3-b.length):"")+b})+"."+On(o,l[1].length);switch(t){case"###,##0.00":return cn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Ai(ko(d,0));return y!=="0"?x+y:"";case"###,###.00":return cn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return cn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ij(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ds(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function lj(e,t,r){var a=t.replace(H4,""),n=t.length-a.length;return Ds(e,a,r*Math.pow(10,2*n))+xr("%",n)}function Y4(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y4(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%n;if(l<0&&(l+=n),r=(t/Math.pow(10,l)).toPrecision(a+1+(n+l)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,x,m){return d+x+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W4)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zn("n",a,r):"("+Zn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ij(e,t,r);if(t.indexOf("%")!==-1)return lj(e,t,r);if(t.indexOf("E")!==-1)return Y4(t,r);if(t.charCodeAt(0)===36)return"$"+Zn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,l,o,f,d=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+On(d,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:ya(t.substr(0,t.length-n.length))+n;if(l=t.match(V4))return aj(l,d,x);if(t.match(/^#+0+$/))return x+On(d,t.length-t.indexOf("0"));if(l=t.match(q4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+ya(l[1])).replace(/\.$/,"."+ya(l[1])),n=n.replace(/\.(\d*)$/,function(b,S){return"."+S+xr("0",ya(l[1]).length-S.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+Ai(""+d);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zn(e,t,-r):Ai(""+r)+"."+xr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return Zn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fo(Zn(e,t.replace(/[\\-]/g,""),r)),o=0,Fo(Fo(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<n.length?n.charAt(o++):b==="0"?"0":""}));if(t.match(X4))return n=Zn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),f=Sd(d,Math.pow(10,o)-1,!1),n=""+x,m=Ds("n",l[1],f[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=bd(f[2],o),m.length<l[4].length&&(m=ya(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),f=Sd(d,Math.pow(10,o)-1,!0),x+(f[0]||(f[1]?"":"0"))+" "+(f[1]?xg(f[1],o)+l[2]+"/"+l[3]+bd(f[2],o):xr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:ya(t.substr(0,t.length-n.length))+n;if(l=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var p=t.indexOf(".")-o,v=t.length-n.length-p;return ya(t.substr(0,p)+n+t.substr(t.length-v))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zn(e,t,-r):Ai(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?On(0,3-b.length):"")+b})+"."+On(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Ai(""+d);return y!=="0"?x+y:"";default:if(t.match(/\.[0#?]*$/))return Zn(e,t.slice(0,t.lastIndexOf(".")),r)+ya(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ds(e,t,r){return(r|0)===r?Zn(e,t,r):cn(e,t,r)}function oj(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lc(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":wd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match($4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cj(e,t,r,a){for(var n=[],l="",o=0,f="",d="t",x,m,p,v="H";o<e.length;)switch(f=e.charAt(o)){case"G":if(!wd(e,o))throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(p=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(p);n[n.length]={t:"t",v:l},++o;break;case"\\":var y=e.charAt(++o),b=y==="("||y===")"?y:"t";n[n.length]={t:b,v:y},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=cl(t,r,e.charAt(o+1)==="2"),x==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},d=f,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=cl(t,r),x==null))return"";for(l=f;++o<e.length&&e.charAt(o).toLowerCase()===f;)l+=f;f==="m"&&d.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=v),n[n.length]={t:f,v:l},d=f;break;case"A":case"a":case"":var S={t:f,v:f};if(x==null&&(x=cl(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(S.v=x.H>=12?"P":"A"),S.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(S.v=x.H>=12?"PM":"AM"),S.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(S.v=x.H>=12?"":""),S.t="T",o+=5,v="h"):(S.t="t",++o),x==null&&S.t==="T")return"";n[n.length]=S,d=f;break;case"[":for(l=f;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match($4)){if(x==null&&(x=cl(t,r),x==null))return"";n[n.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",lc(e)||(n[n.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=f;++o<e.length&&(f=e.charAt(o))==="0";)l+=f;n[n.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++o<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(o))>-1;)l+=f;n[n.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++o)===f;)l+=f;n[n.length]={t:f,v:l},d=f;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":f,v:f},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);n[n.length]={t:"D",v:l};break;case" ":n[n.length]={t:f,v:f},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);n[n.length]={t:"t",v:f},++o;break}var E=0,_=0,N;for(o=n.length-1,d="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=v,d="h",E<1&&(E=1);break;case"s":(N=n[o].v.match(/\.0+$/))&&(_=Math.max(_,N[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":d=n[o].t;break;case"m":d==="s"&&(n[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&n[o].v.match(/[Hh]/)&&(E=1),E<2&&n[o].v.match(/[Mm]/)&&(E=2),E<3&&n[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var k="",R;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=J6(n[o].t.charCodeAt(0),n[o].v,x,_),n[o].t="t";break;case"n":case"?":for(R=o+1;n[R]!=null&&((f=n[R].t)==="?"||f==="D"||(f===" "||f==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[o].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[o].v+=n[R].v,n[R]={v:"",t:";"},++R;k+=n[o].v,o=R-1;break;case"G":n[o].t="t",n[o].v=jl(t,r);break}var A="",D,T;if(k.length>0){k.charCodeAt(0)==40?(D=t<0&&k.charCodeAt(0)===45?-t:t,T=Ds("n",k,D)):(D=t<0&&a>1?-t:t,T=Ds("n",k,D),D<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),R=T.length-1;var O=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){O=o;break}var F=n.length;if(O===n.length&&T.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(R>=n[o].v.length-1?(R-=n[o].v.length,n[o].v=T.substr(R+1,n[o].v.length)):R<0?n[o].v="":(n[o].v=T.substr(0,R+1),R=-1),n[o].t="t",F=o);R>=0&&F<n.length&&(n[F].v=T.substr(0,R+1)+n[F].v)}else if(O!==n.length&&T.indexOf("E")===-1){for(R=T.indexOf(".")-1,o=O;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(m=n[o].v.indexOf(".")>-1&&o===O?n[o].v.indexOf(".")-1:n[o].v.length-1,A=n[o].v.substr(m+1);m>=0;--m)R>=0&&(n[o].v.charAt(m)==="0"||n[o].v.charAt(m)==="#")&&(A=T.charAt(R--)+A);n[o].v=A,n[o].t="t",F=o}for(R>=0&&F<n.length&&(n[F].v=T.substr(0,R+1)+n[F].v),R=T.indexOf(".")+1,o=O;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==O)){for(m=n[o].v.indexOf(".")>-1&&o===O?n[o].v.indexOf(".")+1:0,A=n[o].v.substr(0,m);m<n[o].v.length;++m)R<T.length&&(A+=T.charAt(R++));n[o].v=A,n[o].t="t",F=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(D=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Ds(n[o].t,n[o].v,D),n[o].t="t");var q="";for(o=0;o!==n.length;++o)n[o]!=null&&(q+=n[o].v);return q}var Xb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function uj(e,t){var r=oj(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Xb),f=r[1].match(Xb);return Yb(t,o)?[a,r[0]]:Yb(t,f)?[a,r[1]]:[a,r[o!=null&&f!=null?2:1]]}return[a,l]}function gn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:rt)[e],a==null&&(a=r.table&&r.table[Vb[e]]||rt[Vb[e]]),a==null&&(a=W6[e]||"General");break}if(wd(a,0))return jl(t,r);t instanceof Date&&(t=z4(t,r.date1904));var n=uj(a,t);if(wd(n[1]))return jl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return cj(n[1],t,r,n[0])}function Fs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(rt[r]==null){t<0&&(t=r);continue}if(rt[r]==e){t=r;break}}t<0&&(t=391)}return rt[t]=e,t}function Xd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Fs(e[t],t)}function oc(){rt=q6()}var fj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},K4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dj(e){var t=typeof e=="number"?rt[e]:e;return t=t.replace(K4,"(\\d+)"),new RegExp("^"+t+"$")}function hj(e,t,r){var a=-1,n=-1,l=-1,o=-1,f=-1,d=-1;(t.match(K4)||[]).forEach(function(p,v){var y=parseInt(r[v+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=y;break;case"d":l=y;break;case"h":o=y;break;case"s":d=y;break;case"m":o>=0?f=y:n=y;break}}),d>=0&&f==-1&&n>=0&&(f=n,n=-1);var x=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&f==-1&&d==-1?x:a==-1&&n==-1&&l==-1?m:x+"T"+m}var xj=function(){var e={};e.version="1.2.0";function t(){for(var T=0,O=new Array(256),F=0;F!=256;++F)T=F,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,O[F]=T;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function a(T){var O=0,F=0,q=0,X=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)X[q]=T[q];for(q=0;q!=256;++q)for(F=T[q],O=256+q;O<4096;O+=256)F=X[O]=F>>>8^T[F&255];var U=[];for(q=1;q!=16;++q)U[q-1]=typeof Int32Array<"u"?X.subarray(q*256,q*256+256):X.slice(q*256,q*256+256);return U}var n=a(r),l=n[0],o=n[1],f=n[2],d=n[3],x=n[4],m=n[5],p=n[6],v=n[7],y=n[8],b=n[9],S=n[10],E=n[11],_=n[12],N=n[13],k=n[14];function R(T,O){for(var F=O^-1,q=0,X=T.length;q<X;)F=F>>>8^r[(F^T.charCodeAt(q++))&255];return~F}function A(T,O){for(var F=O^-1,q=T.length-15,X=0;X<q;)F=k[T[X++]^F&255]^N[T[X++]^F>>8&255]^_[T[X++]^F>>16&255]^E[T[X++]^F>>>24]^S[T[X++]]^b[T[X++]]^y[T[X++]]^v[T[X++]]^p[T[X++]]^m[T[X++]]^x[T[X++]]^d[T[X++]]^f[T[X++]]^o[T[X++]]^l[T[X++]]^r[T[X++]];for(q+=15;X<q;)F=F>>>8^r[(F^T[X++])&255];return~F}function D(T,O){for(var F=O^-1,q=0,X=T.length,U=0,ee=0;q<X;)U=T.charCodeAt(q++),U<128?F=F>>>8^r[(F^U)&255]:U<2048?(F=F>>>8^r[(F^(192|U>>6&31))&255],F=F>>>8^r[(F^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,ee=T.charCodeAt(q++)&1023,F=F>>>8^r[(F^(240|U>>8&7))&255],F=F>>>8^r[(F^(128|U>>2&63))&255],F=F>>>8^r[(F^(128|ee>>6&15|(U&3)<<4))&255],F=F>>>8^r[(F^(128|ee&63))&255]):(F=F>>>8^r[(F^(224|U>>12&15))&255],F=F>>>8^r[(F^(128|U>>6&63))&255],F=F>>>8^r[(F^(128|U&63))&255]);return~F}return e.table=r,e.bstr=R,e.buf=A,e.str=D,e}(),Ke=function(){var t={};t.version="1.2.1";function r(L,K){for(var H=L.split("/"),G=K.split("/"),Y=0,Q=0,he=Math.min(H.length,G.length);Y<he;++Y){if(Q=H[Y].length-G[Y].length)return Q;if(H[Y]!=G[Y])return H[Y]<G[Y]?-1:1}return H.length-G.length}function a(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:a(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(0,K+1)}function n(L){if(L.charAt(L.length-1)=="/")return n(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(K+1)}function l(L,K){typeof K=="string"&&(K=new Date(K));var H=K.getHours();H=H<<6|K.getMinutes(),H=H<<5|K.getSeconds()>>>1,L.write_shift(2,H);var G=K.getFullYear()-1980;G=G<<4|K.getMonth()+1,G=G<<5|K.getDate(),L.write_shift(2,G)}function o(L){var K=L.read_shift(2)&65535,H=L.read_shift(2)&65535,G=new Date,Y=H&31;H>>>=5;var Q=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(Q-1),G.setDate(Y);var he=K&31;K>>>=5;var Ee=K&63;return K>>>=6,G.setHours(K),G.setMinutes(Ee),G.setSeconds(he<<1),G}function f(L){Jr(L,0);for(var K={},H=0;L.l<=L.length-4;){var G=L.read_shift(2),Y=L.read_shift(2),Q=L.l+Y,he={};switch(G){case 21589:H=L.read_shift(1),H&1&&(he.mtime=L.read_shift(4)),Y>5&&(H&2&&(he.atime=L.read_shift(4)),H&4&&(he.ctime=L.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}L.l=Q,K[G]=he}return K}var d;function x(){return d||(d={})}function m(L,K){if(L[0]==80&&L[1]==75)return fc(L,K);if((L[0]|32)==109&&(L[1]|32)==105)return ih(L,K);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var H=3,G=512,Y=0,Q=0,he=0,Ee=0,ue=0,me=[],ge=L.slice(0,512);Jr(ge,0);var Fe=p(ge);switch(H=Fe[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(Fe[1]==0)return fc(L,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(ge=L.slice(0,G),Jr(ge,28));var Pe=L.slice(0,G);v(ge,H);var Ge=ge.read_shift(4,"i");if(H===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);ge.l+=4,he=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ee=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i"),ue=ge.read_shift(4,"i"),Q=ge.read_shift(4,"i");for(var Me=-1,ze=0;ze<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++ze)me[ze]=Me;var it=y(L,G);E(ue,Q,it,G,me);var It=N(it,he,me,G);It[he].name="!Directory",Y>0&&Ee!==ee&&(It[Ee].name="!MiniFAT"),It[me[0]].name="!FAT",It.fat_addrs=me,It.ssz=G;var Ut={},Qt=[],cs=[],Vs=[];k(he,It,it,Qt,Y,Ut,cs,Ee),b(cs,Vs,Qt),Qt.shift();var Qa={FileIndex:cs,FullPaths:Vs};return K&&K.raw&&(Qa.raw={header:Pe,sectors:it}),Qa}function p(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(oe,"Header Signature: "),L.l+=16;var K=L.read_shift(2,"u");return[L.read_shift(2,"u"),K]}function v(L,K){var H=9;switch(L.l+=2,H=L.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function y(L,K){for(var H=Math.ceil(L.length/K)-1,G=[],Y=1;Y<H;++Y)G[Y-1]=L.slice(Y*K,(Y+1)*K);return G[H-1]=L.slice(H*K),G}function b(L,K,H){for(var G=0,Y=0,Q=0,he=0,Ee=0,ue=H.length,me=[],ge=[];G<ue;++G)me[G]=ge[G]=G,K[G]=H[G];for(;Ee<ge.length;++Ee)G=ge[Ee],Y=L[G].L,Q=L[G].R,he=L[G].C,me[G]===G&&(Y!==-1&&me[Y]!==Y&&(me[G]=me[Y]),Q!==-1&&me[Q]!==Q&&(me[G]=me[Q])),he!==-1&&(me[he]=G),Y!==-1&&G!=me[G]&&(me[Y]=me[G],ge.lastIndexOf(Y)<Ee&&ge.push(Y)),Q!==-1&&G!=me[G]&&(me[Q]=me[G],ge.lastIndexOf(Q)<Ee&&ge.push(Q));for(G=1;G<ue;++G)me[G]===G&&(Q!==-1&&me[Q]!==Q?me[G]=me[Q]:Y!==-1&&me[Y]!==Y&&(me[G]=me[Y]));for(G=1;G<ue;++G)if(L[G].type!==0){if(Ee=G,Ee!=me[Ee])do Ee=me[Ee],K[G]=K[Ee]+"/"+K[G];while(Ee!==0&&me[Ee]!==-1&&Ee!=me[Ee]);me[G]=-1}for(K[0]+="/",G=1;G<ue;++G)L[G].type!==2&&(K[G]+="/")}function S(L,K,H){for(var G=L.start,Y=L.size,Q=[],he=G;H&&Y>0&&he>=0;)Q.push(K.slice(he*U,he*U+U)),Y-=U,he=ll(H,he*4);return Q.length===0?_e(0):qr(Q).slice(0,L.size)}function E(L,K,H,G,Y){var Q=ee;if(L===ee){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var he=H[L],Ee=(G>>>2)-1;if(!he)return;for(var ue=0;ue<Ee&&(Q=ll(he,ue*4))!==ee;++ue)Y.push(Q);E(ll(he,G-4),K-1,H,G,Y)}}function _(L,K,H,G,Y){var Q=[],he=[];Y||(Y=[]);var Ee=G-1,ue=0,me=0;for(ue=K;ue>=0;){Y[ue]=!0,Q[Q.length]=ue,he.push(L[ue]);var ge=H[Math.floor(ue*4/G)];if(me=ue*4&Ee,G<4+me)throw new Error("FAT boundary crossed: "+ue+" 4 "+G);if(!L[ge])break;ue=ll(L[ge],me)}return{nodes:Q,data:iw([he])}}function N(L,K,H,G){var Y=L.length,Q=[],he=[],Ee=[],ue=[],me=G-1,ge=0,Fe=0,Pe=0,Ge=0;for(ge=0;ge<Y;++ge)if(Ee=[],Pe=ge+K,Pe>=Y&&(Pe-=Y),!he[Pe]){ue=[];var Me=[];for(Fe=Pe;Fe>=0;){Me[Fe]=!0,he[Fe]=!0,Ee[Ee.length]=Fe,ue.push(L[Fe]);var ze=H[Math.floor(Fe*4/G)];if(Ge=Fe*4&me,G<4+Ge)throw new Error("FAT boundary crossed: "+Fe+" 4 "+G);if(!L[ze]||(Fe=ll(L[ze],Ge),Me[Fe]))break}Q[Pe]={nodes:Ee,data:iw([ue])}}return Q}function k(L,K,H,G,Y,Q,he,Ee){for(var ue=0,me=G.length?2:0,ge=K[L].data,Fe=0,Pe=0,Ge;Fe<ge.length;Fe+=128){var Me=ge.slice(Fe,Fe+128);Jr(Me,64),Pe=Me.read_shift(2),Ge=Sg(Me,0,Pe-me),G.push(Ge);var ze={name:Ge,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},it=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);it!==0&&(ze.ct=R(Me,Me.l-8));var It=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);It!==0&&(ze.mt=R(Me,Me.l-8)),ze.start=Me.read_shift(4,"i"),ze.size=Me.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=ee,ze.name=""),ze.type===5?(ue=ze.start,Y>0&&ue!==ee&&(K[ue].name="!StreamData")):ze.size>=4096?(ze.storage="fat",K[ze.start]===void 0&&(K[ze.start]=_(H,ze.start,K.fat_addrs,K.ssz)),K[ze.start].name=ze.name,ze.content=K[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ue!==ee&&ze.start!==ee&&K[ue]&&(ze.content=S(ze,K[ue].data,(K[Ee]||{}).data))),ze.content&&Jr(ze.content,0),Q[Ge]=ze,he.push(ze)}}function R(L,K){return new Date((qa(L,K+4)/1e7*Math.pow(2,32)+qa(L,K)/1e7-11644473600)*1e3)}function A(L,K){return x(),m(d.readFileSync(L),K)}function D(L,K){var H=K&&K.type;switch(H||mt&&Buffer.isBuffer(L)&&(H="buffer"),H||"base64"){case"file":return A(L,K);case"base64":return m(Wa($a(L)),K);case"binary":return m(Wa(L),K)}return m(L,K)}function T(L,K){var H=K||{},G=H.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=G+"/",L.FileIndex[0]={name:G,type:5}),H.CLSID&&(L.FileIndex[0].clsid=H.CLSID),O(L)}function O(L){var K="Sh33tJ5";if(!Ke.find(L,"/"+K)){var H=_e(4);H[0]=55,H[1]=H[3]=50,H[2]=54,L.FileIndex.push({name:K,type:2,content:H,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+K),F(L)}}function F(L,K){T(L);for(var H=!1,G=!1,Y=L.FullPaths.length-1;Y>=0;--Y){var Q=L.FileIndex[Y];switch(Q.type){case 0:G?H=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(Q.R*Q.L*Q.C)&&(H=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!K)){var he=new Date(1987,1,19),Ee=0,ue=Object.create?Object.create(null):{},me=[];for(Y=0;Y<L.FullPaths.length;++Y)ue[L.FullPaths[Y]]=!0,L.FileIndex[Y].type!==0&&me.push([L.FullPaths[Y],L.FileIndex[Y]]);for(Y=0;Y<me.length;++Y){var ge=a(me[Y][0]);G=ue[ge],G||(me.push([ge,{name:n(ge).replace("/",""),type:1,clsid:Z,ct:he,mt:he,content:null}]),ue[ge]=!0)}for(me.sort(function(Ge,Me){return r(Ge[0],Me[0])}),L.FullPaths=[],L.FileIndex=[],Y=0;Y<me.length;++Y)L.FullPaths[Y]=me[Y][0],L.FileIndex[Y]=me[Y][1];for(Y=0;Y<me.length;++Y){var Fe=L.FileIndex[Y],Pe=L.FullPaths[Y];if(Fe.name=n(Pe).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||Z,Y===0)Fe.C=me.length>1?1:-1,Fe.size=0,Fe.type=5;else if(Pe.slice(-1)=="/"){for(Ee=Y+1;Ee<me.length&&a(L.FullPaths[Ee])!=Pe;++Ee);for(Fe.C=Ee>=me.length?-1:Ee,Ee=Y+1;Ee<me.length&&a(L.FullPaths[Ee])!=a(Pe);++Ee);Fe.R=Ee>=me.length?-1:Ee,Fe.type=1}else a(L.FullPaths[Y+1]||"")==a(Pe)&&(Fe.R=Y+1),Fe.type=2}}}function q(L,K){var H=K||{};if(H.fileType=="mad")return Gn(L,H);switch(F(L),H.fileType){case"zip":return Gi(L,H)}var G=function(Ge){for(var Me=0,ze=0,it=0;it<Ge.FileIndex.length;++it){var It=Ge.FileIndex[it];if(It.content){var Ut=It.content.length;Ut>0&&(Ut<4096?Me+=Ut+63>>6:ze+=Ut+511>>9)}}for(var Qt=Ge.FullPaths.length+3>>2,cs=Me+7>>3,Vs=Me+127>>7,Qa=cs+ze+Qt+Vs,Sn=Qa+127>>7,Vi=Sn<=109?0:Math.ceil((Sn-109)/127);Qa+Sn+Vi+127>>7>Sn;)Vi=++Sn<=109?0:Math.ceil((Sn-109)/127);var En=[1,Vi,Sn,Vs,Qt,ze,Me,0];return Ge.FileIndex[0].size=Me<<6,En[7]=(Ge.FileIndex[0].start=En[0]+En[1]+En[2]+En[3]+En[4]+En[5])+(En[6]+7>>3),En}(L),Y=_e(G[7]<<9),Q=0,he=0;{for(Q=0;Q<8;++Q)Y.write_shift(1,ce[Q]);for(Q=0;Q<8;++Q)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),Q=0;Q<3;++Q)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,G[2]),Y.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:ee),Y.write_shift(4,G[3]),Y.write_shift(-4,G[1]?G[0]-1:ee),Y.write_shift(4,G[1]),Q=0;Q<109;++Q)Y.write_shift(-4,Q<G[2]?G[1]+Q:-1)}if(G[1])for(he=0;he<G[1];++he){for(;Q<236+he*127;++Q)Y.write_shift(-4,Q<G[2]?G[1]+Q:-1);Y.write_shift(-4,he===G[1]-1?ee:he+1)}var Ee=function(Ge){for(he+=Ge;Q<he-1;++Q)Y.write_shift(-4,Q+1);Ge&&(++Q,Y.write_shift(-4,ee))};for(he=Q=0,he+=G[1];Q<he;++Q)Y.write_shift(-4,ie.DIFSECT);for(he+=G[2];Q<he;++Q)Y.write_shift(-4,ie.FATSECT);Ee(G[3]),Ee(G[4]);for(var ue=0,me=0,ge=L.FileIndex[0];ue<L.FileIndex.length;++ue)ge=L.FileIndex[ue],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=he,Ee(me+511>>9)));for(Ee(G[6]+7>>3);Y.l&511;)Y.write_shift(-4,ie.ENDOFCHAIN);for(he=Q=0,ue=0;ue<L.FileIndex.length;++ue)ge=L.FileIndex[ue],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=he,Ee(me+63>>6)));for(;Y.l&511;)Y.write_shift(-4,ie.ENDOFCHAIN);for(Q=0;Q<G[4]<<2;++Q){var Fe=L.FullPaths[Q];if(!Fe||Fe.length===0){for(ue=0;ue<17;++ue)Y.write_shift(4,0);for(ue=0;ue<3;++ue)Y.write_shift(4,-1);for(ue=0;ue<12;++ue)Y.write_shift(4,0);continue}ge=L.FileIndex[Q],Q===0&&(ge.start=ge.size?ge.start-1:ee);var Pe=Q===0&&H.root||ge.name;if(me=2*(Pe.length+1),Y.write_shift(64,Pe,"utf16le"),Y.write_shift(2,me),Y.write_shift(1,ge.type),Y.write_shift(1,ge.color),Y.write_shift(-4,ge.L),Y.write_shift(-4,ge.R),Y.write_shift(-4,ge.C),ge.clsid)Y.write_shift(16,ge.clsid,"hex");else for(ue=0;ue<4;++ue)Y.write_shift(4,0);Y.write_shift(4,ge.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,ge.start),Y.write_shift(4,ge.size),Y.write_shift(4,0)}for(Q=1;Q<L.FileIndex.length;++Q)if(ge=L.FileIndex[Q],ge.size>=4096)if(Y.l=ge.start+1<<9,mt&&Buffer.isBuffer(ge.content))ge.content.copy(Y,Y.l,0,ge.size),Y.l+=ge.size+511&-512;else{for(ue=0;ue<ge.size;++ue)Y.write_shift(1,ge.content[ue]);for(;ue&511;++ue)Y.write_shift(1,0)}for(Q=1;Q<L.FileIndex.length;++Q)if(ge=L.FileIndex[Q],ge.size>0&&ge.size<4096)if(mt&&Buffer.isBuffer(ge.content))ge.content.copy(Y,Y.l,0,ge.size),Y.l+=ge.size+63&-64;else{for(ue=0;ue<ge.size;++ue)Y.write_shift(1,ge.content[ue]);for(;ue&63;++ue)Y.write_shift(1,0)}if(mt)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function X(L,K){var H=L.FullPaths.map(function(ue){return ue.toUpperCase()}),G=H.map(function(ue){var me=ue.split("/");return me[me.length-(ue.slice(-1)=="/"?2:1)]}),Y=!1;K.charCodeAt(0)===47?(Y=!0,K=H[0].slice(0,-1)+K):Y=K.indexOf("/")!==-1;var Q=K.toUpperCase(),he=Y===!0?H.indexOf(Q):G.indexOf(Q);if(he!==-1)return L.FileIndex[he];var Ee=!Q.match(y0);for(Q=Q.replace(Ea,""),Ee&&(Q=Q.replace(y0,"!")),he=0;he<H.length;++he)if((Ee?H[he].replace(y0,"!"):H[he]).replace(Ea,"")==Q||(Ee?G[he].replace(y0,"!"):G[he]).replace(Ea,"")==Q)return L.FileIndex[he];return null}var U=64,ee=-2,oe="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(L,K,H){x();var G=q(L,H);d.writeFileSync(K,G)}function re(L){for(var K=new Array(L.length),H=0;H<L.length;++H)K[H]=String.fromCharCode(L[H]);return K.join("")}function z(L,K){var H=q(L,K);switch(K&&K.type||"buffer"){case"file":return x(),d.writeFileSync(K.filename,H),H;case"binary":return typeof H=="string"?H:re(H);case"base64":return B0(typeof H=="string"?H:re(H));case"buffer":if(mt)return Buffer.isBuffer(H)?H:Is(H);case"array":return typeof H=="string"?Wa(H):H}return H}var te;function B(L){try{var K=L.InflateRaw,H=new K;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)te=L;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function I(L,K){if(!te)return Hi(L,K);var H=te.InflateRaw,G=new H,Y=G._processChunk(L.slice(L.l),G._finishFlushFlag);return L.l+=G.bytesRead,Y}function M(L){return te?te.deflateRawSync(L):Re(L)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(L){var K=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(K>>16|K>>8|K)&255}for(var Se=typeof Uint8Array<"u",Ne=Se?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)Ne[Xe]=be(Xe);function V(L,K){var H=Ne[L&255];return K<=8?H>>>8-K:(H=H<<8|Ne[L>>8&255],K<=16?H>>>16-K:(H=H<<8|Ne[L>>16&255],H>>>24-K))}function We(L,K){var H=K&7,G=K>>>3;return(L[G]|(H<=6?0:L[G+1]<<8))>>>H&3}function $e(L,K){var H=K&7,G=K>>>3;return(L[G]|(H<=5?0:L[G+1]<<8))>>>H&7}function dt(L,K){var H=K&7,G=K>>>3;return(L[G]|(H<=4?0:L[G+1]<<8))>>>H&15}function Je(L,K){var H=K&7,G=K>>>3;return(L[G]|(H<=3?0:L[G+1]<<8))>>>H&31}function Oe(L,K){var H=K&7,G=K>>>3;return(L[G]|(H<=1?0:L[G+1]<<8))>>>H&127}function Ct(L,K,H){var G=K&7,Y=K>>>3,Q=(1<<H)-1,he=L[Y]>>>G;return H<8-G||(he|=L[Y+1]<<8-G,H<16-G)||(he|=L[Y+2]<<16-G,H<24-G)||(he|=L[Y+3]<<24-G),he&Q}function Pt(L,K,H){var G=K&7,Y=K>>>3;return G<=5?L[Y]|=(H&7)<<G:(L[Y]|=H<<G&255,L[Y+1]=(H&7)>>8-G),K+3}function Rr(L,K,H){var G=K&7,Y=K>>>3;return H=(H&1)<<G,L[Y]|=H,K+1}function St(L,K,H){var G=K&7,Y=K>>>3;return H<<=G,L[Y]|=H&255,H>>>=8,L[Y+1]=H,K+8}function wn(L,K,H){var G=K&7,Y=K>>>3;return H<<=G,L[Y]|=H&255,H>>>=8,L[Y+1]=H&255,L[Y+2]=H>>>8,K+16}function ha(L,K){var H=L.length,G=2*H>K?2*H:K+5,Y=0;if(H>=K)return L;if(mt){var Q=zb(G);if(L.copy)L.copy(Q);else for(;Y<L.length;++Y)Q[Y]=L[Y];return Q}else if(Se){var he=new Uint8Array(G);if(he.set)he.set(L);else for(;Y<H;++Y)he[Y]=L[Y];return he}return L.length=G,L}function ur(L){for(var K=new Array(L),H=0;H<L;++H)K[H]=0;return K}function qt(L,K,H){var G=1,Y=0,Q=0,he=0,Ee=0,ue=L.length,me=Se?new Uint16Array(32):ur(32);for(Q=0;Q<32;++Q)me[Q]=0;for(Q=ue;Q<H;++Q)L[Q]=0;ue=L.length;var ge=Se?new Uint16Array(ue):ur(ue);for(Q=0;Q<ue;++Q)me[Y=L[Q]]++,G<Y&&(G=Y),ge[Q]=0;for(me[0]=0,Q=1;Q<=G;++Q)me[Q+16]=Ee=Ee+me[Q-1]<<1;for(Q=0;Q<ue;++Q)Ee=L[Q],Ee!=0&&(ge[Q]=me[Ee+16]++);var Fe=0;for(Q=0;Q<ue;++Q)if(Fe=L[Q],Fe!=0)for(Ee=V(ge[Q],G)>>G-Fe,he=(1<<G+4-Fe)-1;he>=0;--he)K[Ee|he<<Fe]=Fe&15|Q<<4;return G}var _r=Se?new Uint16Array(512):ur(512),ir=Se?new Uint16Array(32):ur(32);if(!Se){for(var Et=0;Et<512;++Et)_r[Et]=0;for(Et=0;Et<32;++Et)ir[Et]=0}(function(){for(var L=[],K=0;K<32;K++)L.push(5);qt(L,ir,32);var H=[];for(K=0;K<=143;K++)H.push(8);for(;K<=255;K++)H.push(9);for(;K<=279;K++)H.push(7);for(;K<=287;K++)H.push(8);qt(H,_r,288)})();var De=function(){for(var K=Se?new Uint8Array(32768):[],H=0,G=0;H<ye.length-1;++H)for(;G<ye[H+1];++G)K[G]=H;for(;G<32768;++G)K[G]=29;var Y=Se?new Uint8Array(259):[];for(H=0,G=0;H<ne.length-1;++H)for(;G<ne[H+1];++G)Y[G]=H;function Q(Ee,ue){for(var me=0;me<Ee.length;){var ge=Math.min(65535,Ee.length-me),Fe=me+ge==Ee.length;for(ue.write_shift(1,+Fe),ue.write_shift(2,ge),ue.write_shift(2,~ge&65535);ge-- >0;)ue[ue.l++]=Ee[me++]}return ue.l}function he(Ee,ue){for(var me=0,ge=0,Fe=Se?new Uint16Array(32768):[];ge<Ee.length;){var Pe=Math.min(65535,Ee.length-ge);if(Pe<10){for(me=Pt(ue,me,+(ge+Pe==Ee.length)),me&7&&(me+=8-(me&7)),ue.l=me/8|0,ue.write_shift(2,Pe),ue.write_shift(2,~Pe&65535);Pe-- >0;)ue[ue.l++]=Ee[ge++];me=ue.l*8;continue}me=Pt(ue,me,+(ge+Pe==Ee.length)+2);for(var Ge=0;Pe-- >0;){var Me=Ee[ge];Ge=(Ge<<5^Me)&32767;var ze=-1,it=0;if((ze=Fe[Ge])&&(ze|=ge&-32768,ze>ge&&(ze-=32768),ze<ge))for(;Ee[ze+it]==Ee[ge+it]&&it<250;)++it;if(it>2){Me=Y[it],Me<=22?me=St(ue,me,Ne[Me+1]>>1)-1:(St(ue,me,3),me+=5,St(ue,me,Ne[Me-23]>>5),me+=3);var It=Me<8?0:Me-4>>2;It>0&&(wn(ue,me,it-ne[Me]),me+=It),Me=K[ge-ze],me=St(ue,me,Ne[Me]>>3),me-=3;var Ut=Me<4?0:Me-2>>1;Ut>0&&(wn(ue,me,ge-ze-ye[Me]),me+=Ut);for(var Qt=0;Qt<it;++Qt)Fe[Ge]=ge&32767,Ge=(Ge<<5^Ee[ge])&32767,++ge;Pe-=it-1}else Me<=143?Me=Me+48:me=Rr(ue,me,1),me=St(ue,me,Ne[Me]),Fe[Ge]=ge&32767,++ge}me=St(ue,me,0)-1}return ue.l=(me+7)/8|0,ue.l}return function(ue,me){return ue.length<8?Q(ue,me):he(ue,me)}}();function Re(L){var K=_e(50+Math.floor(L.length*1.1)),H=De(L,K);return K.slice(0,H)}var xe=Se?new Uint16Array(32768):ur(32768),Be=Se?new Uint16Array(32768):ur(32768),He=Se?new Uint16Array(128):ur(128),Kt=1,Dr=1;function os(L,K){var H=Je(L,K)+257;K+=5;var G=Je(L,K)+1;K+=5;var Y=dt(L,K)+4;K+=4;for(var Q=0,he=Se?new Uint8Array(19):ur(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,me=Se?new Uint8Array(8):ur(8),ge=Se?new Uint8Array(8):ur(8),Fe=he.length,Pe=0;Pe<Y;++Pe)he[W[Pe]]=Q=$e(L,K),ue<Q&&(ue=Q),me[Q]++,K+=3;var Ge=0;for(me[0]=0,Pe=1;Pe<=ue;++Pe)ge[Pe]=Ge=Ge+me[Pe-1]<<1;for(Pe=0;Pe<Fe;++Pe)(Ge=he[Pe])!=0&&(Ee[Pe]=ge[Ge]++);var Me=0;for(Pe=0;Pe<Fe;++Pe)if(Me=he[Pe],Me!=0){Ge=Ne[Ee[Pe]]>>8-Me;for(var ze=(1<<7-Me)-1;ze>=0;--ze)He[Ge|ze<<Me]=Me&7|Pe<<3}var it=[];for(ue=1;it.length<H+G;)switch(Ge=He[Oe(L,K)],K+=Ge&7,Ge>>>=3){case 16:for(Q=3+We(L,K),K+=2,Ge=it[it.length-1];Q-- >0;)it.push(Ge);break;case 17:for(Q=3+$e(L,K),K+=3;Q-- >0;)it.push(0);break;case 18:for(Q=11+Oe(L,K),K+=7;Q-- >0;)it.push(0);break;default:it.push(Ge),ue<Ge&&(ue=Ge);break}var It=it.slice(0,H),Ut=it.slice(H);for(Pe=H;Pe<286;++Pe)It[Pe]=0;for(Pe=G;Pe<30;++Pe)Ut[Pe]=0;return Kt=qt(It,xe,286),Dr=qt(Ut,Be,30),K}function Hn(L,K){if(L[0]==3&&!(L[1]&3))return[Di(K),2];for(var H=0,G=0,Y=zb(K||1<<18),Q=0,he=Y.length>>>0,Ee=0,ue=0;(G&1)==0;){if(G=$e(L,H),H+=3,G>>>1)G>>1==1?(Ee=9,ue=5):(H=os(L,H),Ee=Kt,ue=Dr);else{H&7&&(H+=8-(H&7));var me=L[H>>>3]|L[(H>>>3)+1]<<8;if(H+=32,me>0)for(!K&&he<Q+me&&(Y=ha(Y,Q+me),he=Y.length);me-- >0;)Y[Q++]=L[H>>>3],H+=8;continue}for(;;){!K&&he<Q+32767&&(Y=ha(Y,Q+32767),he=Y.length);var ge=Ct(L,H,Ee),Fe=G>>>1==1?_r[ge]:xe[ge];if(H+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)Y[Q++]=Fe;else{if(Fe==256)break;Fe-=257;var Pe=Fe<8?0:Fe-4>>2;Pe>5&&(Pe=0);var Ge=Q+ne[Fe];Pe>0&&(Ge+=Ct(L,H,Pe),H+=Pe),ge=Ct(L,H,ue),Fe=G>>>1==1?ir[ge]:Be[ge],H+=Fe&15,Fe>>>=4;var Me=Fe<4?0:Fe-2>>1,ze=ye[Fe];for(Me>0&&(ze+=Ct(L,H,Me),H+=Me),!K&&he<Ge&&(Y=ha(Y,Ge+100),he=Y.length);Q<Ge;)Y[Q]=Y[Q-ze],++Q}}}return K?[Y,H+7>>>3]:[Y.slice(0,Q),H+7>>>3]}function Hi(L,K){var H=L.slice(L.l||0),G=Hn(H,K);return L.l+=G[1],G[0]}function Hs(L,K){if(L)typeof console<"u"&&console.error(K);else throw new Error(K)}function fc(L,K){var H=L;Jr(H,0);var G=[],Y=[],Q={FileIndex:G,FullPaths:Y};T(Q,{root:K.root});for(var he=H.length-4;(H[he]!=80||H[he+1]!=75||H[he+2]!=5||H[he+3]!=6)&&he>=0;)--he;H.l=he+4,H.l+=4;var Ee=H.read_shift(2);H.l+=6;var ue=H.read_shift(4);for(H.l=ue,he=0;he<Ee;++he){H.l+=20;var me=H.read_shift(4),ge=H.read_shift(4),Fe=H.read_shift(2),Pe=H.read_shift(2),Ge=H.read_shift(2);H.l+=8;var Me=H.read_shift(4),ze=f(H.slice(H.l+Fe,H.l+Fe+Pe));H.l+=Fe+Pe+Ge;var it=H.l;H.l=Me+4,dc(H,me,ge,Q,ze),H.l=it}return Q}function dc(L,K,H,G,Y){L.l+=2;var Q=L.read_shift(2),he=L.read_shift(2),Ee=o(L);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var ue=L.read_shift(4),me=L.read_shift(4),ge=L.read_shift(4),Fe=L.read_shift(2),Pe=L.read_shift(2),Ge="",Me=0;Me<Fe;++Me)Ge+=String.fromCharCode(L[L.l++]);if(Pe){var ze=f(L.slice(L.l,L.l+Pe));(ze[21589]||{}).mt&&(Ee=ze[21589].mt),((Y||{})[21589]||{}).mt&&(Ee=Y[21589].mt)}L.l+=Pe;var it=L.slice(L.l,L.l+me);switch(he){case 8:it=I(L,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var It=!1;Q&8&&(ue=L.read_shift(4),ue==134695760&&(ue=L.read_shift(4),It=!0),me=L.read_shift(4),ge=L.read_shift(4)),me!=K&&Hs(It,"Bad compressed size: "+K+" != "+me),ge!=H&&Hs(It,"Bad uncompressed size: "+H+" != "+ge),Ur(G,Ge,it,{unsafe:!0,mt:Ee})}function Gi(L,K){var H=K||{},G=[],Y=[],Q=_e(1),he=H.compression?8:0,Ee=0,ue=0,me=0,ge=0,Fe=0,Pe=L.FullPaths[0],Ge=Pe,Me=L.FileIndex[0],ze=[],it=0;for(ue=1;ue<L.FullPaths.length;++ue)if(Ge=L.FullPaths[ue].slice(Pe.length),Me=L.FileIndex[ue],!(!Me.size||!Me.content||Ge=="Sh33tJ5")){var It=ge,Ut=_e(Ge.length);for(me=0;me<Ge.length;++me)Ut.write_shift(1,Ge.charCodeAt(me)&127);Ut=Ut.slice(0,Ut.l),ze[Fe]=xj.buf(Me.content,0);var Qt=Me.content;he==8&&(Qt=M(Qt)),Q=_e(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Ee),Q.write_shift(2,he),Me.mt?l(Q,Me.mt):Q.write_shift(4,0),Q.write_shift(-4,ze[Fe]),Q.write_shift(4,Qt.length),Q.write_shift(4,Me.content.length),Q.write_shift(2,Ut.length),Q.write_shift(2,0),ge+=Q.length,G.push(Q),ge+=Ut.length,G.push(Ut),ge+=Qt.length,G.push(Qt),Q=_e(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Ee),Q.write_shift(2,he),Q.write_shift(4,0),Q.write_shift(-4,ze[Fe]),Q.write_shift(4,Qt.length),Q.write_shift(4,Me.content.length),Q.write_shift(2,Ut.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,It),it+=Q.l,Y.push(Q),it+=Ut.length,Y.push(Ut),++Fe}return Q=_e(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Fe),Q.write_shift(2,Fe),Q.write_shift(4,it),Q.write_shift(4,ge),Q.write_shift(2,0),qr([qr(G),qr(Y),Q])}var Vl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Su(L,K){if(L.ctype)return L.ctype;var H=L.name||"",G=H.match(/\.([^\.]+)$/);return G&&Vl[G[1]]||K&&(G=(H=K).match(/[\.\\]([^\.\\])+$/),G&&Vl[G[1]])?Vl[G[1]]:"application/octet-stream"}function Eu(L){for(var K=B0(L),H=[],G=0;G<K.length;G+=76)H.push(K.slice(G,G+76));return H.join(`\r
`)+`\r
`}function hc(L){var K=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=K.split(`\r
`),Y=0;Y<G.length;++Y){var Q=G[Y];if(Q.length==0){H.push("");continue}for(var he=0;he<Q.length;){var Ee=76,ue=Q.slice(he,he+Ee);ue.charAt(Ee-1)=="="?Ee--:ue.charAt(Ee-2)=="="?Ee-=2:ue.charAt(Ee-3)=="="&&(Ee-=3),ue=Q.slice(he,he+Ee),he+=Ee,he<Q.length&&(ue+="="),H.push(ue)}}return H.join(`\r
`)}function xc(L){for(var K=[],H=0;H<L.length;++H){for(var G=L[H];H<=L.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+L[++H];K.push(G)}for(var Y=0;Y<K.length;++Y)K[Y]=K[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return Wa(K.join(`\r
`))}function _u(L,K,H){for(var G="",Y="",Q="",he,Ee=0;Ee<10;++Ee){var ue=K[Ee];if(!ue||ue.match(/^\s*$/))break;var me=ue.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":G=me[2].trim();break;case"content-type":Q=me[2].trim();break;case"content-transfer-encoding":Y=me[2].trim();break}}switch(++Ee,Y.toLowerCase()){case"base64":he=Wa($a(K.slice(Ee).join("")));break;case"quoted-printable":he=xc(K.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var ge=Ur(L,G.slice(H.length),he,{unsafe:!0});Q&&(ge.ctype=Q)}function ih(L,K){if(re(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=K&&K.root||"",G=(mt&&Buffer.isBuffer(L)?L.toString("binary"):re(L)).split(`\r
`),Y=0,Q="";for(Y=0;Y<G.length;++Y)if(Q=G[Y],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),H||(H=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),Q.slice(0,H.length)!=H););var he=(G[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ee="--"+(he[1]||""),ue=[],me=[],ge={FileIndex:ue,FullPaths:me};T(ge);var Fe,Pe=0;for(Y=0;Y<G.length;++Y){var Ge=G[Y];Ge!==Ee&&Ge!==Ee+"--"||(Pe++&&_u(ge,G.slice(Fe,Y),H),Fe=Y)}return ge}function Gn(L,K){var H=K||{},G=H.boundary||"SheetJS";G="------="+G;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],Q=L.FullPaths[0],he=Q,Ee=L.FileIndex[0],ue=1;ue<L.FullPaths.length;++ue)if(he=L.FullPaths[ue].slice(Q.length),Ee=L.FileIndex[ue],!(!Ee.size||!Ee.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var me=Ee.content,ge=mt&&Buffer.isBuffer(me)?me.toString("binary"):re(me),Fe=0,Pe=Math.min(1024,ge.length),Ge=0,Me=0;Me<=Pe;++Me)(Ge=ge.charCodeAt(Me))>=32&&Ge<128&&++Fe;var ze=Fe>=Pe*4/5;Y.push(G),Y.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+he),Y.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),Y.push("Content-Type: "+Su(Ee,he)),Y.push(""),Y.push(ze?hc(ge):Eu(ge))}return Y.push(G+`--\r
`),Y.join(`\r
`)}function Ir(L){var K={};return T(K,L),K}function Ur(L,K,H,G){var Y=G&&G.unsafe;Y||T(L);var Q=!Y&&Ke.find(L,K);if(!Q){var he=L.FullPaths[0];K.slice(0,he.length)==he?he=K:(he.slice(-1)!="/"&&(he+="/"),he=(he+K).replace("//","/")),Q={name:n(K),type:2},L.FileIndex.push(Q),L.FullPaths.push(he),Y||Ke.utils.cfb_gc(L)}return Q.content=H,Q.size=H?H.length:0,G&&(G.CLSID&&(Q.clsid=G.CLSID),G.mt&&(Q.mt=G.mt),G.ct&&(Q.ct=G.ct)),Q}function Gs(L,K){T(L);var H=Ke.find(L,K);if(H){for(var G=0;G<L.FileIndex.length;++G)if(L.FileIndex[G]==H)return L.FileIndex.splice(G,1),L.FullPaths.splice(G,1),!0}return!1}function mc(L,K,H){T(L);var G=Ke.find(L,K);if(G){for(var Y=0;Y<L.FileIndex.length;++Y)if(L.FileIndex[Y]==G)return L.FileIndex[Y].name=n(H),L.FullPaths[Y]=H,!0}return!1}function lh(L){F(L,!0)}return t.find=X,t.read=D,t.parse=m,t.write=z,t.writeFile=ke,t.utils={cfb_new:Ir,cfb_add:Ur,cfb_del:Gs,cfb_mov:mc,cfb_gc:lh,ReadShift:w0,CheckField:vE,prep_blob:Jr,bconcat:qr,use_zlib:B,_deflateRaw:Re,_inflateRaw:Hi,consts:ie},t}();function mj(e){return typeof e=="string"?Wd(e):Array.isArray(e)?z6(e):e}function fu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Wd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ns(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([mj(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=Bi(t)),f.write(t),f.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function pj(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function pr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function $b(e,t){for(var r=[],a=pr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Yd(e){for(var t=[],r=pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function $d(e){for(var t=[],r=pr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function gj(e){for(var t=[],r=pr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Ed=new Date(1899,11,30,0,0,0);function Pr(e,t){var r=e.getTime(),a=Ed.getTime()+(e.getTimezoneOffset()-Ed.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var Q4=new Date,vj=Ed.getTime()+(Q4.getTimezoneOffset()-Ed.getTimezoneOffset())*6e4,Kb=Q4.getTimezoneOffset();function Kd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+vj),t.getTimezoneOffset()!==Kb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Kb)*6e4),t}function yj(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=n.length;++l)if(n[l]){switch(r=1,l>3&&(a=!0),n[l].slice(n[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[l].slice(n[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[l],10)}return t}var Qb=new Date("2017-02-19T19:06:09.000Z"),Z4=isNaN(Qb.getFullYear())?new Date("2/19/17"):Qb,bj=Z4.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(bj)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Z4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Rl(e,t){if(mt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ns(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ns(I4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ns(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ns(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function ar(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ar(e[r]));return t}function xr(e,t){for(var r="";r.length<t;)r+=e;return r}function Mn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,l){return r=-r,l}),!isNaN(t=Number(a)))?t/r:t}var wj=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ko(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&wj.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Sj=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var l=r.split(a),o=[l[0]],f=1;f<l.length;++f)o.push(n),o.push(l[f]);return o}}();function J4(e){return e?e.content&&e.type?Rl(e.content,!0):e.data?v0(e.data):e.asNodeBuffer&&mt?v0(e.asNodeBuffer().toString("binary")):e.asBinary?v0(e.asBinary()):e._data&&e._data.getContent?v0(Rl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function eE(e){if(!e)return null;if(e.data)return Ib(e.data);if(e.asNodeBuffer&&mt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ib(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Ej(e){return e&&e.name.slice(-4)===".bin"?eE(e):J4(e)}function dn(e,t){for(var r=e.FullPaths||pr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function pg(e,t){var r=dn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ar(e,t,r){if(!r)return Ej(pg(e,t));if(!t)return null;try{return Ar(e,t)}catch{return null}}function Xa(e,t,r){if(!r)return J4(pg(e,t));if(!t)return null;try{return Xa(e,t)}catch{return null}}function _j(e,t,r){return eE(pg(e,t))}function Zb(e){for(var t=e.FullPaths||pr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function ft(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return mt?a=Is(r):a=H6(r),Ke.utils.cfb_add(e,t,a)}Ke.utils.cfb_add(e,t,r)}else e.file(t,r)}function gg(){return Ke.utils.cfb_new()}function tE(e,t){switch(t.type){case"base64":return Ke.read(e,{type:"base64"});case"binary":return Ke.read(e,{type:"binary"});case"buffer":case"array":return Ke.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function b0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Jb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Tj=/<[^>]*>/g,da=Er.match(Jb)?Jb:Tj,Nj=/<\w*:/,Cj=/<(\/?)\w+:/;function st(e,t,r){for(var a={},n=0,l=0;n!==e.length&&!((l=e.charCodeAt(n))===32||l===10||l===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(kj),f=0,d="",x=0,m="",p="",v=1;if(o)for(x=0;x!=o.length;++x){for(p=o[x],l=0;l!=p.length&&p.charCodeAt(l)!==61;++l);for(m=p.slice(0,l).trim();p.charCodeAt(l+1)==32;)++l;for(v=(n=p.charCodeAt(l+1))==34||n==39?1:0,d=p.slice(l+1+v,p.length-v),f=0;f!=m.length&&m.charCodeAt(f)!==58;++f);if(f===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),a[m]=d,a[m.toLowerCase()]=d;else{var y=(f===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(f+1);if(a[y]&&m.slice(f-3,f)=="ext")continue;a[y]=d,a[y.toLowerCase()]=d}}return a}function is(e){return e.replace(Cj,"<$1")}var rE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vg=Yd(rE),Tt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",l=n.indexOf("<![CDATA[");if(l==-1)return n.replace(e,function(f,d){return rE[f]||String.fromCharCode(parseInt(d,f.indexOf("x")>-1?16:10))||f}).replace(t,function(f,d){return String.fromCharCode(parseInt(d,16))});var o=n.indexOf("]]>");return r(n.slice(0,l))+n.slice(l+9,o)+r(n.slice(o+3))}}(),yg=/[&<>'"]/g,Aj=/[\u0000-\u0008\u000b-\u001f]/g;function Bt(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(Aj,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ew(e){return Bt(e).replace(/ /g,"_x0020_")}var aE=/[\u0000-\u001f]/g;function bg(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(/\n/g,"<br/>").replace(aE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function jj(e){var t=e+"";return t.replace(yg,function(r){return vg[r]}).replace(aE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var tw=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function Rj(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function tr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bm(e){for(var t="",r=0,a=0,n=0,l=0,o=0,f=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|l&63);continue}o=e.charCodeAt(r++),f=((a&7)<<18|(n&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(f>>>10&1023)),t+=String.fromCharCode(56320+(f&1023))}return t}function rw(e){var t=Di(2*e.length),r,a,n=1,l=0,o=0,f;for(a=0;a<e.length;a+=n)n=1,(f=e.charCodeAt(a))<128?r=f:f<224?(r=(f&31)*64+(e.charCodeAt(a+1)&63),n=2):f<240?(r=(f&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(f&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function aw(e){return Is(e,"binary").toString("utf8")}var If="foo bar baz",Vt=mt&&(aw(If)==Bm(If)&&aw||rw(If)==Bm(If)&&rw)||Bm,ns=mt?function(e){return Is(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},I0=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),nE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),Dj=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Fj=/<\/?(?:vt:)?variant>/g,Oj=/<(?:vt:)([^>]*)>([\s\S]*)</;function nw(e,t){var r=st(e),a=e.match(Dj(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(l){var o=l.replace(Fj,"").match(Oj);o&&n.push({v:Vt(o[2]),t:o[1]})}),n}var sE=/(^\s|\s$|\n)/;function ea(e,t){return"<"+e+(t.match(sE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function U0(e){return pr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ie(e,t,r){return"<"+e+(r!=null?U0(r):"")+(t!=null?(t.match(sE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ap(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Mj(e,t){switch(typeof e){case"string":var r=Ie("vt:lpwstr",Bt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ie((e|0)==e?"vt:i4":"vt:r8",Bt(String(e)));case"boolean":return Ie("vt:bool",e?"true":"false")}if(e instanceof Date)return Ie("vt:filetime",Ap(e));throw new Error("Unable to serialize "+e)}function wg(e){if(mt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Vt(Bi(hg(e)));throw new Error("Bad input format: expected Buffer or string")}var z0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Br={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ll=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Va={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Lj(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,l=5;l>=0;--l)n=n*256+e[t+l];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function Bj(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,l=0,o=a?-t:t;isFinite(o)?o==0?n=l=0:(n=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?n=-1022:(l-=Math.pow(2,52),n+=1023)):(n=2047,l=isNaN(t)?26985:0);for(var f=0;f<=5;++f,l/=256)e[r+f]=l&255;e[r+6]=(n&15)<<4|l&15,e[r+7]=n>>4|a}var sw=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,l=e[0][a].length;n<l;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},iw=mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Is(t)})):sw(e)}:sw,lw=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(js(e,n)));return a.join("").replace(Ea,"")},Sg=mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ea,""):lw(e,t,r)}:lw,ow=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},iE=mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ow(e,t,r)}:ow,cw=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(jo(e,n)));return a.join("")},du=mt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):cw(t,r,a)}:cw,lE=function(e,t){var r=qa(e,t);return r>0?du(e,t+4,t+4+r-1):""},oE=lE,cE=function(e,t){var r=qa(e,t);return r>0?du(e,t+4,t+4+r-1):""},uE=cE,fE=function(e,t){var r=2*qa(e,t);return r>0?du(e,t+4,t+4+r-1):""},dE=fE,hE=function(t,r){var a=qa(t,r);return a>0?Sg(t,r+4,r+4+a):""},xE=hE,mE=function(e,t){var r=qa(e,t);return r>0?du(e,t+4,t+4+r):""},pE=mE,gE=function(e,t){return Lj(e,t)},_d=gE,Eg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};mt&&(oE=function(t,r){if(!Buffer.isBuffer(t))return lE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},uE=function(t,r){if(!Buffer.isBuffer(t))return cE(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},dE=function(t,r){if(!Buffer.isBuffer(t))return fE(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},xE=function(t,r){if(!Buffer.isBuffer(t))return hE(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},pE=function(t,r){if(!Buffer.isBuffer(t))return mE(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},_d=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):gE(t,r)},Eg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var jo=function(e,t){return e[t]},js=function(e,t){return e[t+1]*256+e[t]},Pj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ll=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ij=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function w0(e,t){var r="",a,n,l=[],o,f,d,x;switch(t){case"dbcs":if(x=this.l,mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(js(this,x)),x+=2;e*=2;break;case"utf8":r=du(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Sg(this,this.l,this.l+e);break;case"wstr":return w0.call(this,e,"dbcs");case"lpstr-ansi":r=oE(this,this.l),e=4+qa(this,this.l);break;case"lpstr-cp":r=uE(this,this.l),e=4+qa(this,this.l);break;case"lpwstr":r=dE(this,this.l),e=4+2*qa(this,this.l);break;case"lpp4":e=4+qa(this,this.l),r=xE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qa(this,this.l),r=pE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=jo(this,this.l+e++))!==0;)l.push(Pf(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=js(this,this.l+e))!==0;)l.push(Pf(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",x=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(x)!==-1)return o=jo(this,x),this.l=x+1,f=w0.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(Pf(js(this,x))),x+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",x=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(x)!==-1)return o=jo(this,x),this.l=x+1,f=w0.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(Pf(jo(this,x))),x+=1}r=l.join("");break;default:switch(e){case 1:return a=jo(this,this.l),this.l++,a;case 2:return a=(t==="i"?Pj:js)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?ll:Ij)(this,this.l),this.l+=4,a):(n=qa(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=_d(this,this.l):n=_d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=iE(this,this.l,e);break}}return this.l+=e,r}var Uj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},zj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Hj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Gj(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Hj(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Uj(this,t,this.l);break;case 8:if(a=8,r==="f"){Bj(this,t,this.l);break}case 16:break;case-4:a=4,zj(this,t,this.l);break}return this.l+=a,this}function vE(e,t){var r=iE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jr(e,t){e.l=t,e.read_shift=w0,e.chk=vE,e.write_shift=Gj}function fa(e,t){e.l+=t}function _e(e){var t=Di(e);return Jr(t,0),t}function Us(e,t,r){if(e){var a,n,l;Jr(e,e.l||0);for(var o=e.length,f=0,d=0;e.l<o;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var x=X0[f]||X0[65535];for(a=e.read_shift(1),l=a&127,n=1;n<4&&a&128;++n)l+=((a=e.read_shift(1))&127)<<7*n;d=e.l+l;var m=x.f&&x.f(e,l,r);if(e.l=d,t(m,x,f))return}}}function Oa(){var e=[],t=mt?256:2048,r=function(x){var m=_e(x);return Jr(m,0),m},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(x){return a&&x<a.length-a.l?a:(n(),a=r(Math.max(x+1,t)))},o=function(){return n(),qr(e)},f=function(x){n(),a=x,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:f,end:o,_bufs:e}}function je(e,t,r,a){var n=+t,l;if(!isNaN(n)){a||(a=X0[n].p||(r||[]).length||0),l=1+(n>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var f=0;f!=4;++f)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Eg(r)&&e.push(r)}}function S0(e,t,r){var a=ar(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function uw(e,t,r){var a=ar(e);return a.s=S0(a.s,t.s,r),a.e=S0(a.e,t.s,r),a}function E0(e,t){if(e.cRel&&e.c<0)for(e=ar(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ar(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=at(e);return!e.cRel&&e.cRel!=null&&(r=Wj(r)),!e.rRel&&e.rRel!=null&&(r=Vj(r)),r}function Pm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wr(e.s.r)+":"+(e.e.rRel?"":"$")+wr(e.e.r):E0(e.s,t.biff)+":"+E0(e.e,t.biff)}function _g(e){return parseInt(qj(e),10)-1}function wr(e){return""+(e+1)}function Vj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qj(e){return e.replace(/\$(\d+)$/,"$1")}function kg(e){for(var t=Xj(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Wj(e){return e.replace(/^([A-Z])/,"$$$1")}function Xj(e){return e.replace(/^\$([A-Z])/,"$1")}function Yj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function cr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function at(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ma(e){var t=e.indexOf(":");return t==-1?{s:cr(e),e:cr(e)}:{s:cr(e.slice(0,t)),e:cr(e.slice(t+1))}}function ct(e,t){return typeof t>"u"||typeof t=="number"?ct(e.s,e.e):(typeof e!="string"&&(e=at(e)),typeof t!="string"&&(t=at(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,l=e.length;for(r=0;a<l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===l||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=l&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=l&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function fw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gn(e.z,r?Pr(t):t)}catch{}try{return e.w=gn((e.XF||{}).numFmtId||(r?14:0),r?Pr(t):t)}catch{return""+t}}function Bs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zs[e.v]||e.v:t==null?fw(e,e.v):fw(e,t))}function Pi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function yE(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,l=e||(n?[]:{}),o=0,f=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?cr(a.origin):a.origin;o=d.r,f=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=Nt(l["!ref"]);x.s.c=m.s.c,x.s.r=m.s.r,x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),o==-1&&(x.e.r=o=m.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[p].length;++v)if(!(typeof t[p][v]>"u")){var y={v:t[p][v]},b=o+p,S=f+v;if(x.s.r>b&&(x.s.r=b),x.s.c>S&&(x.s.c=S),x.e.r<b&&(x.e.r=b),x.e.c<S&&(x.e.c=S),t[p][v]&&typeof t[p][v]=="object"&&!Array.isArray(t[p][v])&&!(t[p][v]instanceof Date))y=t[p][v];else if(Array.isArray(y.v)&&(y.f=t[p][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(a.nullError)y.t="e",y.v=0;else if(a.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=a.dateNF||rt[14],a.cellDates?(y.t="d",y.w=gn(y.z,Pr(y.v))):(y.t="n",y.v=Pr(y.v),y.w=gn(y.z,y.v))):y.t="s";if(n)l[b]||(l[b]=[]),l[b][S]&&l[b][S].z&&(y.z=l[b][S].z),l[b][S]=y;else{var E=at({c:S,r:b});l[E]&&l[E].z&&(y.z=l[E].z),l[E]=y}}}return x.s.c<1e7&&(l["!ref"]=ct(x)),l}function cc(e,t){return yE(null,e,t)}function $j(e){return e.read_shift(4,"i")}function Ln(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function ua(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Wr(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Kj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Qj(e,t){return t||(t=_e(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Tg(e,t){var r=e.l,a=e.read_shift(1),n=ua(e),l=[],o={t:n,h:n};if((a&1)!==0){for(var f=e.read_shift(4),d=0;d!=f;++d)l.push(Kj(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Zj(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),Wr(e.t,t),r?t.slice(0,t.l):t}var Jj=Tg;function e8(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),Wr(e.t,t),t.write_shift(4,1),Qj({},t),r?t.slice(0,t.l):t}function bn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Bl(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Pl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Il(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var t8=ua,bE=Wr;function Ng(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function kd(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var r8=ua,jp=Ng,Cg=kd;function Ag(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?_d([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ll(t,0)>>2;return r?n/100:n}function wE(e,t){t==null&&(t=_e(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function SE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function a8(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ul=SE,uc=a8;function ca(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Dl(e,t){return(t||_e(8)).write_shift(8,e,"f")}function n8(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var x=El[n];x&&(t.rgb=G0(x));break;case 2:t.rgb=G0([o,f,d]);break;case 3:t.theme=n;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Td(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function s8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function i8(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function EE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function l8(e){return EE(e,1)}function o8(e){return EE(e,2)}var jg=2,Ra=3,Uf=11,dw=12,Nd=19,zf=64,c8=65,u8=71,f8=4108,d8=4126,Vr=80,_E=81,h8=[Vr,_E],Rp={1:{n:"CodePage",t:jg},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Ra},5:{n:"LineCount",t:Ra},6:{n:"ParagraphCount",t:Ra},7:{n:"SlideCount",t:Ra},8:{n:"NoteCount",t:Ra},9:{n:"HiddenCount",t:Ra},10:{n:"MultimediaClipCount",t:Ra},11:{n:"ScaleCrop",t:Uf},12:{n:"HeadingPairs",t:f8},13:{n:"TitlesOfParts",t:d8},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:Uf},17:{n:"CharacterCount",t:Ra},19:{n:"SharedDoc",t:Uf},22:{n:"HyperlinksChanged",t:Uf},23:{n:"AppVersion",t:Ra,p:"version"},24:{n:"DigSig",t:c8},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:Nd},2147483651:{n:"Behavior",t:Nd},1919054434:{}},Dp={1:{n:"CodePage",t:jg},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:zf},11:{n:"LastPrinted",t:zf},12:{n:"CreatedDate",t:zf},13:{n:"ModifiedDate",t:zf},14:{n:"PageCount",t:Ra},15:{n:"WordCount",t:Ra},16:{n:"CharCount",t:Ra},17:{n:"Thumbnail",t:u8},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Ra},255:{},2147483648:{n:"Locale",t:Nd},2147483651:{n:"Behavior",t:Nd},1919054434:{}},hw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},x8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function m8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var p8=m8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),El=ar(p8),zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Rg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function g8(e){var t=Rg();if(!e||!e.match)return t;var r={};if((e.match(da)||[]).forEach(function(a){var n=st(a);switch(n[0].replace(Nj,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Fp[n.ContentType]]!==void 0&&t[Fp[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Br.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function TE(e,t){var r=gj(Fp),a=[],n;a[a.length]=Er,a[a.length]=Ie("Types",null,{xmlns:Br.CT,"xmlns:xsd":Br.xsd,"xmlns:xsi":Br.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ie("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){e[d]&&e[d].length>0&&(n=e[d][0],a[a.length]=Ie("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Hf[d][t.bookType]||Hf[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(x){a[a.length]=Ie("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:Hf[d][t.bookType]||Hf[d].xlsx})})},f=function(d){(e[d]||[]).forEach(function(x){a[a.length]=Ie("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:r[d][0]})})};return l("workbooks"),o("sheets"),o("charts"),f("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),o("metadata"),f("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function H0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function _0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(da)||[]).forEach(function(n){var l=st(n);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:b0(l.Target,t);r[f]=o,a[l.Id]=o}}),r["!id"]=a,r}function Oo(e){var t=[Er,Ie("Relationships",null,{xmlns:Br.RELS})];return pr(e["!id"]).forEach(function(r){t[t.length]=Ie("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Lt(e,t,r,a,n,l){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var v8="application/vnd.oasis.opendocument.spreadsheet";function y8(e,t){for(var r=wg(e),a,n;a=z0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=st(a[0],!1),n.path=="/"&&n.type!==v8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function b8(e){var t=[Er];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function xw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function w8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function S8(e){var t=[Er];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(xw(e[r][0],e[r][1])),t.push(w8("",e[r][0]));return t.push(xw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function NE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yd.version+"</meta:generator></office:meta></office:document-meta>"}var mn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],E8=function(){for(var e=new Array(mn.length),t=0;t<mn.length;++t){var r=mn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function CE(e){var t={};e=Vt(e);for(var r=0;r<mn.length;++r){var a=mn[r],n=e.match(E8[r]);n!=null&&n.length>0&&(t[a[1]]=Tt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=rr(t[a[1]]))}return t}function Im(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Bt(t),a[a.length]=r?Ie(e,t,r):ea(e,t))}function AE(e,t){var r=t||{},a=[Er,Ie("cp:coreProperties",null,{"xmlns:cp":Br.CORE_PROPS,"xmlns:dc":Br.dc,"xmlns:dcterms":Br.dcterms,"xmlns:dcmitype":Br.dcmitype,"xmlns:xsi":Br.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Im("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ap(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Im("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ap(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var l=0;l!=mn.length;++l){var o=mn[l],f=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&Im(o[0],f,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var _l=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function RE(e,t,r,a){var n=[];if(typeof e=="string")n=nw(e,a);else for(var l=0;l<e.length;++l)n=n.concat(e[l].map(function(m){return{v:m}}));var o=typeof t=="string"?nw(t,a).map(function(m){return m.v}):t,f=0,d=0;if(o.length>0)for(var x=0;x!==n.length;x+=2){switch(d=+n[x+1].v,n[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=o.slice(f,f+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=o.slice(f,f+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=o.slice(f,f+d);break}f+=d}}function _8(e,t,r){var a={};return t||(t={}),e=Vt(e),_l.forEach(function(n){var l=(e.match(I0(n[0]))||[])[1];switch(n[2]){case"string":l&&(t[n[1]]=Tt(l));break;case"bool":t[n[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&RE(a.HeadingPairs,a.TitlesOfParts,t,r),t}function DE(e){var t=[],r=Ie;return e||(e={}),e.Application="SheetJS",t[t.length]=Er,t[t.length]=Ie("Properties",null,{xmlns:Br.EXT_PROPS,"xmlns:vt":Br.vt}),_l.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Bt(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Bt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var k8=/<[^>]+>[^<]*/g;function T8(e,t){var r={},a="",n=e.match(k8);if(n)for(var l=0;l!=n.length;++l){var o=n[l],f=st(o);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Tt(f.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var d=o.split(">"),x=d[0].slice(4),m=d[1];switch(x){case"lpstr":case"bstr":case"lpwstr":r[a]=Tt(m);break;case"bool":r[a]=tr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(m);break;case"filetime":case"date":r[a]=rr(m);break;case"cy":case"error":r[a]=Tt(m);break;default:if(x.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,d)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function FE(e){var t=[Er,Ie("Properties",null,{xmlns:Br.CUST_PROPS,"xmlns:vt":Br.vt})];if(!e)return t.join("");var r=1;return pr(e).forEach(function(n){++r,t[t.length]=Ie("property",Mj(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Bt(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Op={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Um;function N8(e,t,r){Um||(Um=Yd(Op)),t=Um[t]||t,e[t]=r}function C8(e,t){var r=[];return pr(Op).map(function(a){for(var n=0;n<mn.length;++n)if(mn[n][1]==a)return mn[n];for(n=0;n<_l.length;++n)if(_l[n][1]==a)return _l[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ea(Op[a[1]]||a[1],n))}}),Ie("DocumentProperties",r.join(""),{xmlns:Va.o})}function A8(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&pr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<mn.length;++o)if(l==mn[o][1])return;for(o=0;o<_l.length;++o)if(l==_l[o][1])return;for(o=0;o<r.length;++o)if(l==r[o])return;var f=e[l],d="string";typeof f=="number"?(d="float",f=String(f)):f===!0||f===!1?(d="boolean",f=f?"1":"0"):f=String(f),n.push(Ie(ew(l),f,{"dt:dt":d}))}}),t&&pr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],f="string";typeof o=="number"?(f="float",o=String(o)):o===!0||o===!1?(f="boolean",o=o?"1":"0"):o instanceof Date?(f="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Ie(ew(l),o,{"dt:dt":f}))}}),"<"+a+' xmlns="'+Va.o+'">'+n.join("")+"</"+a+">"}function Dg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function j8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),n+=l);var o=_e(8);return o.write_shift(4,a),o.write_shift(4,n),o}function OE(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function ME(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function LE(e,t,r){return t===31?ME(e):OE(e,t,r)}function Mp(e,t,r){return LE(e,t,r===!1?0:4)}function R8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return LE(e,t,0)}function D8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Ea,""),e.l-n&2&&(e.l+=2)}return r}function F8(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Ea,"");return r}function O8(e){var t=e.l,r=Cd(e,_E);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Cd(e,Ra);return[r,a]}function M8(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(O8(e));return r}function mw(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var l=e.read_shift(4),o=e.read_shift(4);a[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Ea,"").replace(y0,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function BE(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function L8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Cd(e,t,r){var a=e.read_shift(2),n,l=r||{};if(e.l+=2,t!==dw&&a!==t&&h8.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===dw?a:t){case 2:return n=e.read_shift(2,"i"),l.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return OE(e,a,4).replace(Ea,"");case 31:return ME(e);case 64:return Dg(e);case 65:return BE(e);case 71:return L8(e);case 80:return Mp(e,a,!l.raw).replace(Ea,"");case 81:return R8(e,a).replace(Ea,"");case 4108:return M8(e);case 4126:case 4127:return a==4127?D8(e):F8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function pw(e,t){var r=_e(4),a=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=_e(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=j8(t);break;case 31:case 80:for(a=_e(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return qr([r,a])}function gw(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0,f=0,d=-1,x={};for(o=0;o!=n;++o){var m=e.read_shift(4),p=e.read_shift(4);l[o]=[m,p+r]}l.sort(function(N,k){return N[1]-k[1]});var v={};for(o=0;o!=n;++o){if(e.l!==l[o][1]){var y=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(y=!1,e.l=l[o][1]),y)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var b=t[l[o][0]];if(v[b.n]=Cd(e,b.t,{raw:!0}),b.p==="version"&&(v[b.n]=String(v[b.n]>>16)+"."+("0000"+String(v[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(v[b.n]){case 0:v[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fn(f=v[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[b.n])}}else if(l[o][0]===1){if(f=v.CodePage=Cd(e,jg),Fn(f),d!==-1){var S=e.l;e.l=l[d][1],x=mw(e,f),e.l=S}}else if(l[o][0]===0){if(f===0){d=o,e.l=l[o+1][1];continue}x=mw(e,f)}else{var E=x[l[o][0]],_;switch(e[e.l]){case 65:e.l+=4,_=BE(e);break;case 30:e.l+=4,_=Mp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Mp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=br(e,4);break;case 64:e.l+=4,_=rr(Dg(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[E]=_}}return e.l=r+a,v}var PE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function B8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function vw(e,t,r){var a=_e(8),n=[],l=[],o=8,f=0,d=_e(8),x=_e(8);if(d.write_shift(4,2),d.write_shift(4,1200),x.write_shift(4,1),l.push(d),n.push(x),o+=8+d.length,!t){x=_e(8),x.write_shift(4,0),n.unshift(x);var m=[_e(4)];for(m[0].write_shift(4,e.length),f=0;f<e.length;++f){var p=e[f][0];for(d=_e(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,f+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=qr(m),l.unshift(d),o+=8+d.length}for(f=0;f<e.length;++f)if(!(t&&!t[e[f][0]])&&!(PE.indexOf(e[f][0])>-1||jE.indexOf(e[f][0])>-1)&&e[f][1]!=null){var v=e[f][1],y=0;if(t){y=+t[e[f][0]];var b=r[y];if(b.p=="version"&&typeof v=="string"){var S=v.split(".");v=(+S[0]<<16)+(+S[1]||0)}d=pw(b.t,v)}else{var E=B8(v);E==-1&&(E=31,v=String(v)),d=pw(E,v)}l.push(d),x=_e(8),x.write_shift(4,t?y:2+f),n.push(x),o+=8+d.length}var _=8*(l.length+1);for(f=0;f<l.length;++f)n[f].write_shift(4,_),_+=l[f].length;return a.write_shift(4,o),a.write_shift(4,l.length),qr([a].concat(n).concat(l))}function yw(e,t,r){var a=e.content;if(!a)return{};Jr(a,0);var n,l,o,f,d=0;a.chk("feff","Byte Order: "),a.read_shift(2);var x=a.read_shift(4),m=a.read_shift(16);if(m!==Ke.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(l=a.read_shift(16),f=a.read_shift(4),n===1&&f!==a.l)throw new Error("Length mismatch: "+f+" !== "+a.l);n===2&&(o=a.read_shift(16),d=a.read_shift(4));var p=gw(a,t),v={SystemIdentifier:x};for(var y in p)v[y]=p[y];if(v.FMTID=l,n===1)return v;if(d-a.l==2&&(a.l+=2),a.l!==d)throw new Error("Length mismatch 2: "+a.l+" !== "+d);var b;try{b=gw(a,null)}catch{}for(y in b)v[y]=b[y];return v.FMTID=[l,o],v}function bw(e,t,r,a,n,l){var o=_e(n?68:48),f=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ke.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var d=vw(e,r,a);if(f.push(d),n){var x=vw(n,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+d.length),f.push(x)}return qr(f)}function hi(e,t){return e.read_shift(t),null}function P8(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function I8(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function br(e,t){return e.read_shift(t)===1}function ba(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function jr(e){return e.read_shift(2,"u")}function xn(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function IE(e,t){return I8(e,t,jr)}function U8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function UE(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function hu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function z8(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,l=1+(r&1),o=0,f,d={};n&&(o=e.read_shift(2)),a&&(f=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,x);return n&&(e.l+=4*o),a&&(e.l+=f),d.t=m,n||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function H8(e){var t=e.t||"",r=_e(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=_e(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return qr(n)}function Fl(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function xu(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Fl(e,a,r)}function zl(e,t,r){if(r.biff>5)return xu(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zE(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function G8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function V8(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Ea,"");return a&&(e.l+=24),n}function q8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(Ea,"");return r+o}function W8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return V8(e);case"0303000000000000c000000000000046":return q8(e);default:throw new Error("Unsupported Moniker "+r)}}function Gf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ea,""):"";return r}function ww(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function X8(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var l,o,f,d,x="",m,p;n&16&&(l=Gf(e,r-e.l)),n&128&&(o=Gf(e,r-e.l)),(n&257)===257&&(f=Gf(e,r-e.l)),(n&257)===1&&(d=W8(e,r-e.l)),n&8&&(x=Gf(e,r-e.l)),n&32&&(m=e.read_shift(16)),n&64&&(p=Dg(e)),e.l=r;var v=o||f||d||"";v&&x&&(v+="#"+x),v||(v="#"+x),n&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return m&&(y.guid=m),p&&(y.time=p),l&&(y.Tooltip=l),y}function Y8(e){var t=_e(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),l=n>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(l==28)a=a.slice(1),ww(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var f=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(f.length+1)),r=0;r<f.length;++r)t.write_shift(2,f.charCodeAt(r));t.write_shift(2,0),l&8&&ww(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,a.length-3*d+1),r=0;r<a.length-3*d;++r)t.write_shift(1,a.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function HE(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function GE(e,t){var r=HE(e);return r[3]=0,r}function ls(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Ol(e,t,r,a){return a||(a=_e(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function $8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function K8(e,t,r){return t===0?"":zl(e,t,r)}function Q8(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,l,o]}function VE(e){var t=e.read_shift(2),r=Ag(e);return[t,r]}function Z8(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=hu(e,t,r),l=e.read_shift(2);if(a-=e.l,l!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+l);return e.l+=l,n}function Qd(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function qE(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function WE(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var J8=WE;function XE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function eR(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function tR(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function aa(e){e.l+=2,e.l+=e.read_shift(2)}var rR={0:aa,4:aa,5:aa,6:aa,7:tR,8:aa,9:aa,10:aa,11:aa,12:aa,13:eR,14:aa,15:aa,16:aa,17:aa,18:aa,19:aa,20:aa,21:XE};function aR(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(rR[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Vf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Fg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=_e(n);return l.write_shift(2,a),l.write_shift(2,t),n>4&&l.write_shift(2,29282),n>6&&l.write_shift(2,1997),n>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function nR(e,t){return t===0||e.read_shift(2),1200}function sR(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=zl(e,0,r);return e.read_shift(t+a-e.l),n}function iR(e,t){var r=!t||t.biff==8,a=_e(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function lR(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function oR(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=hu(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:l,name:o}}function cR(e,t){var r=!t||t.biff>=8?2:1,a=_e(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function uR(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),l=[],o=0;o!=n&&e.l<r;++o)l.push(z8(e));return l.Count=a,l.Unique=n,l}function fR(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=H8(e[n]);var l=qr([r].concat(a));return l.parts=[r.length].concat(a.map(function(o){return o.length})),l}function dR(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function hR(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function xR(e){var t=$8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mR(e){return e.read_shift(2),e.read_shift(4)}function Sw(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var l={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[l,n]}function pR(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),x=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:l,CurTab:o,FirstTab:f,Selected:d,TabRatio:x}}function gR(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function vR(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function yR(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function bR(){}function wR(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=hu(e,0,r),a}function SR(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,l=_e(n);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),l}function ER(e){var t=ls(e);return t.isst=e.read_shift(4),t}function _R(e,t,r,a){var n=_e(10);return Ol(e,t,a,n),n.write_shift(4,r),n}function kR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=ls(e);r.biff==2&&e.l++;var l=xu(e,a-e.l,r);return n.val=l,n}function TR(e,t,r,a,n){var l=!n||n.biff==8,o=_e(8+ +l+(1+l)*r.length);return Ol(e,t,a,o),o.write_shift(2,r.length),l&&o.write_shift(1,1),o.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),o}function NR(e,t,r){var a=e.read_shift(2),n=zl(e,0,r);return[a,n]}function CR(e,t,r,a){var n=r&&r.biff==5;a||(a=_e(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}var AR=zl;function Ew(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,l=e.read_shift(n),o=e.read_shift(n),f=e.read_shift(2),d=e.read_shift(2);return e.l=a,{s:{r:l,c:f},e:{r:o,c:d}}}function jR(e,t){var r=t.biff==8||!t.biff?4:2,a=_e(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function RR(e){var t=e.read_shift(2),r=e.read_shift(2),a=VE(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function DR(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push(VE(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:l}}function FR(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:l}}function OR(e,t,r,a){var n={},l=e.read_shift(4),o=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(2);return n.patternType=x8[f>>26],a.cellStyles&&(n.alc=l&7,n.fWrap=l>>3&1,n.alcV=l>>4&7,n.fJustLast=l>>7&1,n.trot=l>>8&255,n.cIndent=l>>16&15,n.fShrinkToFit=l>>20&1,n.iReadOrder=l>>22&2,n.fAtrNum=l>>26&1,n.fAtrFnt=l>>27&1,n.fAtrAlc=l>>28&1,n.fAtrBdr=l>>29&1,n.fAtrPat=l>>30&1,n.fAtrProt=l>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=f&127,n.icvBottom=f>>7&127,n.icvDiag=f>>14&127,n.dgDiag=f>>21&15,n.icvFore=d&127,n.icvBack=d>>7&127,n.fsxButton=d>>14&1),n}function MR(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=OR(e,t,a.fStyle,r),a}function _w(e,t,r,a){var n=r&&r.biff==5;a||(a=_e(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&n&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function LR(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function BR(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function kw(e,t,r){var a=ls(e);(r.biff==2||t==9)&&++e.l;var n=U8(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function PR(e,t,r,a,n,l){var o=_e(8);return Ol(e,t,a,o),UE(r,l,o),o}function IR(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ls(e),n=ca(e);return a.val=n,a}function UR(e,t,r,a){var n=_e(14);return Ol(e,t,a,n),Dl(r,n),n}var Tw=K8;function zR(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,n];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=Fl(e,l),f=[];a>e.l;)f.push(xu(e));return[l,n,o,f]}function Nw(e,t,r){var a=e.read_shift(2),n,l={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=Z8(e,t-2,r)),l.body=n||e.read_shift(t-2),typeof n=="string"&&(l.Name=n),l}var HR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cw(e,t,r){var a=e.l+t,n=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),f=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var x=Fl(e,o,r);n&32&&(x=HR[x.charCodeAt(0)]);var m=a-e.l;r&&r.biff==2&&--m;var p=a==e.l||f===0||!(m>0)?[]:aM(e,m,r,f);return{chKey:l,Name:x,itab:d,rgce:p}}function YE(e,t,r){if(r.biff<8)return GR(e,t,r);for(var a=[],n=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)a.push(Q8(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function GR(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=hu(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function VR(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),l=Fl(e,a,r),o=Fl(e,n,r);return[l,o]}function qR(e,t,r){var a=WE(e);e.l++;var n=e.read_shift(1);return t-=8,[nM(e,t,r),n,a]}function Aw(e,t,r){var a=J8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,tM(e,t,r)]}function WR(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function XR(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),f=zl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},f,o,l]}}function YR(e,t,r){return XR(e,t,r)}function $R(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Qd(e));return r}function KR(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)qE(e[r],t);return t}function QR(e,t,r){if(r&&r.biff<8)return JR(e,t,r);var a=XE(e),n=aR(e,t-22,a[1]);return{cmo:a,ft:n}}var ZR={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function JR(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((ZR[a]||fa)(e,t,r)),{cmo:[n,a,l],ft:o}}function eD(e,t,r){var a=e.l,n="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=G8(e,6,r);var f=e.read_shift(2);e.read_shift(2),jr(e,2);var d=e.read_shift(2);e.l+=d;for(var x=1;x<e.lens.length-1;++x){if(e.l-a!=e.lens[x])throw new Error("TxO: bad continue record");var m=e[e.l],p=Fl(e,e.lens[x+1]-e.lens[x]-1);if(n+=p,n.length>=(m?f:2*f))break}if(n.length!==f&&n.length!==f*2)throw new Error("cchText: "+f+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function tD(e,t){var r=Qd(e);e.l+=16;var a=X8(e,t-24);return[r,a]}function rD(e){var t=_e(24),r=cr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return qr([t,Y8(e[1])])}function aD(e,t){e.read_shift(2);var r=Qd(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Ea,""),[r,a]}function nD(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var a=cr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function sD(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=hw[r]||r,r=e.read_shift(2),t[1]=hw[r]||r,t}function iD(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function lD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GE(e));return r}function oD(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(GE(e));return r}function cD(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function $E(e,t,r){if(!r.cellStyles)return fa(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),f=e.read_shift(a),d=e.read_shift(2);a==2&&(e.l+=2);var x={s:n,e:l,w:o,ixfe:f,flags:d};return(r.biff>=5||!r.biff)&&(x.level=d>>8&7),x}function uD(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function fD(e,t){var r={};return t<32||(e.l+=16,r.header=ca(e),r.footer=ca(e),e.l+=2),r}function dD(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function hD(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var xD=ls,mD=IE,pD=xu;function gD(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function vD(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ls(e);++e.l;var n=zl(e,t-7,r);return a.t="str",a.val=n,a}function yD(e){var t=ls(e);++e.l;var r=ca(e);return t.t="n",t.val=r,t}function bD(e,t,r){var a=_e(15);return vu(a,e,t),a.write_shift(8,r,"f"),a}function wD(e){var t=ls(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function SD(e,t,r){var a=_e(9);return vu(a,e,t),a.write_shift(2,r),a}function ED(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function _D(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function kD(e,t,r){var a=e.l+t,n=ls(e),l=e.read_shift(2),o=Fl(e,l,r);return e.l=a,n.t="str",n.val=o,n}var TD=[2,3,48,49,131,139,140,245],Lp=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(f,d){var x=[],m=Di(1);switch(d.type){case"base64":m=Wa($a(f));break;case"binary":m=Wa(f);break;case"buffer":case"array":m=f;break}Jr(m,0);var p=m.read_shift(1),v=!!(p&136),y=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var S=0,E=521;p==2&&(S=m.read_shift(2)),m.l+=3,p!=2&&(S=m.read_shift(4)),S>1048576&&(S=1e6),p!=2&&(E=m.read_shift(2));var _=m.read_shift(2),N=d.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(N=e[m[m.l]]),m.l+=1,m.l+=2),b&&(m.l+=36);for(var k=[],R={},A=Math.min(m.length,p==2?521:E-10-(y?264:0)),D=b?32:11;m.l<A&&m[m.l]!=13;)switch(R={},R.name=L0.utils.decode(N,m.slice(m.l,m.l+D)).replace(/[\u0000\r\n].*$/g,""),m.l+=D,R.type=String.fromCharCode(m.read_shift(1)),p!=2&&!b&&(R.offset=m.read_shift(4)),R.len=m.read_shift(1),p==2&&(R.offset=m.read_shift(2)),R.dec=m.read_shift(1),R.name.length&&k.push(R),p!=2&&(m.l+=b?13:14),R.type){case"B":(!y||R.len!=8)&&d.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var T=0,O=0;for(x[0]=[],O=0;O!=k.length;++O)x[0][O]=k[O].name;for(;S-- >0;){if(m[m.l]===42){m.l+=_;continue}for(++m.l,x[++T]=[],O=0,O=0;O!=k.length;++O){var F=m.slice(m.l,m.l+k[O].len);m.l+=k[O].len,Jr(F,0);var q=L0.utils.decode(N,F);switch(k[O].type){case"C":q.trim().length&&(x[T][O]=q.replace(/\s+$/,""));break;case"D":q.length===8?x[T][O]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):x[T][O]=q;break;case"F":x[T][O]=parseFloat(q.trim());break;case"+":case"I":x[T][O]=b?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":x[T][O]=!0;break;case"N":case"F":x[T][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));x[T][O]="##MEMO##"+(b?parseInt(q.trim(),10):F.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(x[T][O]=+q||0);break;case"@":x[T][O]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":x[T][O]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":x[T][O]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[T][O]=-F.read_shift(-8,"f");break;case"B":if(y&&k[O].len==8){x[T][O]=F.read_shift(8,"f");break}case"G":case"P":F.l+=k[O].len;break;case"0":if(k[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[O].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),d.DBF=k,x}function a(f,d){var x=d||{};x.dateNF||(x.dateNF="yyyymmdd");var m=cc(r(f,x),x);return m["!cols"]=x.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete x.DBF,m}function n(f,d){try{return Pi(a(f,d),d)}catch(x){if(d&&d.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(f,d){var x=d||{};if(+x.codepage>=0&&Fn(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var m=Oa(),p=Rd(f,{header:1,raw:!0,cellDates:!0}),v=p[0],y=p.slice(1),b=f["!cols"]||[],S=0,E=0,_=0,N=1;for(S=0;S<v.length;++S){if(((b[S]||{}).DBF||{}).name){v[S]=b[S].DBF.name,++_;continue}if(v[S]!=null){if(++_,typeof v[S]=="number"&&(v[S]=v[S].toString(10)),typeof v[S]!="string")throw new Error("DBF Invalid column name "+v[S]+" |"+typeof v[S]+"|");if(v.indexOf(v[S])!==S){for(E=0;E<1024;++E)if(v.indexOf(v[S]+"_"+E)==-1){v[S]+="_"+E;break}}}}var k=Nt(f["!ref"]),R=[],A=[],D=[];for(S=0;S<=k.e.c-k.s.c;++S){var T="",O="",F=0,q=[];for(E=0;E<y.length;++E)y[E][S]!=null&&q.push(y[E][S]);if(q.length==0||v[S]==null){R[S]="?";continue}for(E=0;E<q.length;++E){switch(typeof q[E]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=q[E]instanceof Date?"D":"C";break;default:O="C"}F=Math.max(F,String(q[E]).length),T=T&&T!=O?"C":O}F>250&&(F=250),O=((b[S]||{}).DBF||{}).type,O=="C"&&b[S].DBF.len>F&&(F=b[S].DBF.len),T=="B"&&O=="N"&&(T="N",D[S]=b[S].DBF.dec,F=b[S].DBF.len),A[S]=T=="C"||O=="N"?F:l[T]||0,N+=A[S],R[S]=T}var X=m.next(32);for(X.write_shift(4,318902576),X.write_shift(4,y.length),X.write_shift(2,296+32*_),X.write_shift(2,N),S=0;S<4;++S)X.write_shift(4,0);for(X.write_shift(4,0|(+t[P4]||3)<<8),S=0,E=0;S<v.length;++S)if(v[S]!=null){var U=m.next(32),ee=(v[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,ee,"sbcs"),U.write_shift(1,R[S]=="?"?"C":R[S],"sbcs"),U.write_shift(4,E),U.write_shift(1,A[S]||l[R[S]]||0),U.write_shift(1,D[S]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),E+=A[S]||l[R[S]]||0}var oe=m.next(264);for(oe.write_shift(4,13),S=0;S<65;++S)oe.write_shift(4,0);for(S=0;S<y.length;++S){var ce=m.next(N);for(ce.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(R[E]){case"L":ce.write_shift(1,y[S][E]==null?63:y[S][E]?84:70);break;case"B":ce.write_shift(8,y[S][E]||0,"f");break;case"N":var Z="0";for(typeof y[S][E]=="number"&&(Z=y[S][E].toFixed(D[E]||0)),_=0;_<A[E]-Z.length;++_)ce.write_shift(1,32);ce.write_shift(1,Z,"sbcs");break;case"D":y[S][E]?(ce.write_shift(4,("0000"+y[S][E].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(y[S][E].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+y[S][E].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(y[S][E]!=null?y[S][E]:"").slice(0,A[E]);for(ce.write_shift(1,ie,"sbcs"),_=0;_<A[E]-ie.length;++_)ce.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),KE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+pr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,y){var b=e[y];return typeof b=="number"?Ub(b):b},a=function(v,y,b){var S=y.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return S==59?v:Ub(S)};e["|"]=254;function n(v,y){switch(y.type){case"base64":return l($a(v),y);case"binary":return l(v,y);case"buffer":return l(mt&&Buffer.isBuffer(v)?v.toString("binary"):Bi(v),y);case"array":return l(Rl(v),y)}throw new Error("Unrecognized type "+y.type)}function l(v,y){var b=v.split(/[\n\r]+/),S=-1,E=-1,_=0,N=0,k=[],R=[],A=null,D={},T=[],O=[],F=[],q=0,X;for(+y.codepage>=0&&Fn(+y.codepage);_!==b.length;++_){q=0;var U=b[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),ee=U.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),oe=ee[0],ce;if(U.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&R.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ie=!1,ke=!1,re=!1,z=-1,te=-1;for(N=1;N<ee.length;++N)switch(ee[N].charAt(0)){case"A":break;case"X":E=parseInt(ee[N].slice(1))-1,ie=!0;break;case"Y":for(S=parseInt(ee[N].slice(1))-1,ie||(E=0),X=k.length;X<=S;++X)k[X]=[];break;case"K":ce=ee[N].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(Mn(ce))?isNaN(Ko(ce).getDate())||(ce=rr(ce)):(ce=Mn(ce),A!==null&&lc(A)&&(ce=Kd(ce))),Z=!0;break;case"E":re=!0;var B=Mo(ee[N].slice(1),{r:S,c:E});k[S][E]=[k[S][E],B];break;case"S":ke=!0,k[S][E]=[k[S][E],"S5S"];break;case"G":break;case"R":z=parseInt(ee[N].slice(1))-1;break;case"C":te=parseInt(ee[N].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}if(Z&&(k[S][E]&&k[S][E].length==2?k[S][E][0]=ce:k[S][E]=ce,A=null),ke){if(re)throw new Error("SYLK shared formula cannot have own formula");var I=z>-1&&k[z][te];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");k[S][E][1]=x_(I[1],{r:S-z,c:E-te})}break;case"F":var M=0;for(N=1;N<ee.length;++N)switch(ee[N].charAt(0)){case"X":E=parseInt(ee[N].slice(1))-1,++M;break;case"Y":for(S=parseInt(ee[N].slice(1))-1,X=k.length;X<=S;++X)k[X]=[];break;case"M":q=parseInt(ee[N].slice(1))/20;break;case"F":break;case"G":break;case"P":A=R[parseInt(ee[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=ee[N].slice(1).split(" "),X=parseInt(F[0],10);X<=parseInt(F[1],10);++X)q=parseInt(F[2],10),O[X-1]=q===0?{hidden:!0}:{wch:q},Fi(O[X-1]);break;case"C":E=parseInt(ee[N].slice(1))-1,O[E]||(O[E]={});break;case"R":S=parseInt(ee[N].slice(1))-1,T[S]||(T[S]={}),q>0?(T[S].hpt=q,T[S].hpx=Zo(q)):q===0&&(T[S].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}M<1&&(A=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+U)}}return T.length>0&&(D["!rows"]=T),O.length>0&&(D["!cols"]=O),y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),[k,D]}function o(v,y){var b=n(v,y),S=b[0],E=b[1],_=cc(S,y);return pr(E).forEach(function(N){_[N]=E[N]}),_}function f(v,y){return Pi(o(v,y),y)}function d(v,y,b,S){var E="C;Y"+(b+1)+";X"+(S+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+Ig(v.f,{r:b,c:S}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function x(v,y){y.forEach(function(b,S){var E="F;W"+(S+1)+" "+(S+1)+" ";b.hidden?E+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=V0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=q0(b.wpx)),typeof b.wch=="number"&&(E+=Math.round(b.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,y){y.forEach(function(b,S){var E="F;";b.hidden?E+="M0;":b.hpt?E+="M"+20*b.hpt+";":b.hpx&&(E+="M"+20*W0(b.hpx)+";"),E.length>2&&v.push(E+"R"+(S+1))})}function p(v,y){var b=["ID;PWXL;N;E"],S=[],E=Nt(v["!ref"]),_,N=Array.isArray(v),k=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&x(b,v["!cols"]),v["!rows"]&&m(b,v["!rows"]),b.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var R=E.s.r;R<=E.e.r;++R)for(var A=E.s.c;A<=E.e.c;++A){var D=at({r:R,c:A});_=N?(v[R]||[])[A]:v[D],!(!_||_.v==null&&(!_.f||_.F))&&S.push(d(_,v,R,A))}return b.join(k)+k+S.join(k)+k+"E"+k}return{to_workbook:f,to_sheet:o,from_sheet:p}}(),QE=function(){function e(l,o){switch(o.type){case"base64":return t($a(l),o);case"binary":return t(l,o);case"buffer":return t(mt&&Buffer.isBuffer(l)?l.toString("binary"):Bi(l),o);case"array":return t(Rl(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var f=l.split(`
`),d=-1,x=-1,m=0,p=[];m!==f.length;++m){if(f[m].trim()==="BOT"){p[++d]=[],x=0;continue}if(!(d<0)){var v=f[m].trim().split(","),y=v[0],b=v[1];++m;for(var S=f[m]||"";(S.match(/["]/g)||[]).length&1&&m<f.length-1;)S+=`
`+f[++m];switch(S=S.trim(),+y){case-1:if(S==="BOT"){p[++d]=[],x=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?p[d][x]=!0:S==="FALSE"?p[d][x]=!1:isNaN(Mn(b))?isNaN(Ko(b).getDate())?p[d][x]=b:p[d][x]=rr(b):p[d][x]=Mn(b),++x;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),p[d][x++]=S!==""?S:null;break}if(S==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function r(l,o){return cc(e(l,o),o)}function a(l,o){return Pi(r(l,o),o)}var n=function(){var l=function(d,x,m,p,v){d.push(x),d.push(m+","+p),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,x,m,p){d.push(x+","+m),d.push(x==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(d){var x=[],m=Nt(d["!ref"]),p,v=Array.isArray(d);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,m.e.r-m.s.r+1,""),l(x,"TUPLES",0,m.e.c-m.s.c+1,""),l(x,"DATA",0,0,"");for(var y=m.s.r;y<=m.e.r;++y){o(x,-1,0,"BOT");for(var b=m.s.c;b<=m.e.c;++b){var S=at({r:y,c:b});if(p=v?(d[y]||[])[b]:d[S],!p){o(x,1,0,"");continue}switch(p.t){case"n":var E=p.w;!E&&p.v!=null&&(E=p.v),E==null?p.f&&!p.F?o(x,1,0,"="+p.f):o(x,1,0,""):o(x,0,E,"V");break;case"b":o(x,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=gn(p.z||rt[14],Pr(rr(p.v)))),o(x,0,p.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var _=`\r
`,N=x.join(_);return N}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),ZE=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,v){for(var y=p.split(`
`),b=-1,S=-1,E=0,_=[];E!==y.length;++E){var N=y[E].trim().split(":");if(N[0]==="cell"){var k=cr(N[1]);if(_.length<=k.r)for(b=_.length;b<=k.r;++b)_[b]||(_[b]=[]);switch(b=k.r,S=k.c,N[2]){case"t":_[b][S]=e(N[3]);break;case"v":_[b][S]=+N[3];break;case"vtf":var R=N[N.length-1];case"vtc":switch(N[3]){case"nl":_[b][S]=!!+N[4];break;default:_[b][S]=+N[4];break}N[2]=="vtf"&&(_[b][S]=[_[b][S],R])}}}return v&&v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}function a(p,v){return cc(r(p,v),v)}function n(p,v){return Pi(a(p,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function x(p){if(!p||!p["!ref"])return"";for(var v=[],y=[],b,S="",E=Ma(p["!ref"]),_=Array.isArray(p),N=E.s.r;N<=E.e.r;++N)for(var k=E.s.c;k<=E.e.c;++k)if(S=at({r:N,c:k}),b=_?(p[N]||[])[k]:p[S],!(!b||b.v==null||b.t==="z")){switch(y=["cell",S,"t"],b.t){case"s":case"str":y.push(t(b.v));break;case"n":b.f?(y[2]="vtf",y[3]="n",y[4]=b.v,y[5]=t(b.f)):(y[2]="v",y[3]=b.v);break;case"b":y[2]="vt"+(b.f?"f":"c"),y[3]="nl",y[4]=b.v?"1":"0",y[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var R=Pr(rr(b.v));y[2]="vtc",y[3]="nd",y[4]=""+R,y[5]=b.w||gn(b.z||rt[14],R);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(p){return[l,o,f,o,x(p),d].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:m}}(),Qo=function(){function e(m,p,v,y,b){b.raw?p[v][y]=m:m===""||(m==="TRUE"?p[v][y]=!0:m==="FALSE"?p[v][y]=!1:isNaN(Mn(m))?isNaN(Ko(m).getDate())?p[v][y]=m:p[v][y]=rr(m):p[v][y]=Mn(m))}function t(m,p){var v=p||{},y=[];if(!m||m.length===0)return y;for(var b=m.split(/[\r\n]/),S=b.length-1;S>=0&&b[S].length===0;)--S;for(var E=10,_=0,N=0;N<=S;++N)_=b[N].indexOf(" "),_==-1?_=b[N].length:_++,E=Math.max(E,_);for(N=0;N<=S;++N){y[N]=[];var k=0;for(e(b[N].slice(0,E).trim(),y,N,k,v),k=1;k<=(b[N].length-E)/10+1;++k)e(b[N].slice(E+(k-1)*10,E+k*10).trim(),y,N,k,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(m){for(var p={},v=!1,y=0,b=0;y<m.length;++y)(b=m.charCodeAt(y))==34?v=!v:!v&&b in r&&(p[b]=(p[b]||0)+1);b=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&b.push([p[y],y]);if(!b.length){p=a;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&b.push([p[y],y])}return b.sort(function(S,E){return S[0]-E[0]||a[S[1]]-a[E[1]]}),r[b.pop()[1]]||44}function l(m,p){var v=p||{},y="",b=v.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(y=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(y=m.charAt(4),m=m.slice(6)):y=n(m.slice(0,1024)):v&&v.FS?y=v.FS:y=n(m.slice(0,1024));var E=0,_=0,N=0,k=0,R=0,A=y.charCodeAt(0),D=!1,T=0,O=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var F=v.dateNF!=null?dj(v.dateNF):null;function q(){var X=m.slice(k,R),U={};if(X.charAt(0)=='"'&&X.charAt(X.length-1)=='"'&&(X=X.slice(1,-1).replace(/""/g,'"')),X.length===0)U.t="z";else if(v.raw)U.t="s",U.v=X;else if(X.trim().length===0)U.t="s",U.v=X;else if(X.charCodeAt(0)==61)X.charCodeAt(1)==34&&X.charCodeAt(X.length-1)==34?(U.t="s",U.v=X.slice(2,-1).replace(/""/g,'"')):zO(X)?(U.t="n",U.f=X.slice(1)):(U.t="s",U.v=X);else if(X=="TRUE")U.t="b",U.v=!0;else if(X=="FALSE")U.t="b",U.v=!1;else if(!isNaN(N=Mn(X)))U.t="n",v.cellText!==!1&&(U.w=X),U.v=N;else if(!isNaN(Ko(X).getDate())||F&&X.match(F)){U.z=v.dateNF||rt[14];var ee=0;F&&X.match(F)&&(X=hj(X,v.dateNF,X.match(F)||[]),ee=1),v.cellDates?(U.t="d",U.v=rr(X,ee)):(U.t="n",U.v=Pr(rr(X,ee))),v.cellText!==!1&&(U.w=gn(U.z,U.v instanceof Date?Pr(U.v):U.v)),v.cellNF||delete U.z}else U.t="s",U.v=X;if(U.t=="z"||(v.dense?(b[E]||(b[E]=[]),b[E][_]=U):b[at({c:_,r:E})]=U),k=R+1,O=m.charCodeAt(k),S.e.c<_&&(S.e.c=_),S.e.r<E&&(S.e.r=E),T==A)++_;else if(_=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;R<m.length;++R)switch(T=m.charCodeAt(R)){case 34:O===34&&(D=!D);break;case A:case 10:case 13:if(!D&&q())break e;break}return R-k>0&&q(),b["!ref"]=ct(S),b}function o(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,p):cc(t(m,p),p)}function f(m,p){var v="",y=p.type=="string"?[0,0,0,0]:Xg(m,p);switch(p.type){case"base64":v=$a(m);break;case"binary":v=m;break;case"buffer":p.codepage==65001?v=m.toString("utf8"):p.codepage&&typeof L0<"u"||(v=mt&&Buffer.isBuffer(m)?m.toString("binary"):Bi(m));break;case"array":v=Rl(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=Vt(v.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?v=Vt(v):p.type=="binary"&&typeof L0<"u",v.slice(0,19)=="socialcalc:version:"?ZE.to_sheet(p.type=="string"?v:Vt(v),p):o(v,p)}function d(m,p){return Pi(f(m,p),p)}function x(m){for(var p=[],v=Nt(m["!ref"]),y,b=Array.isArray(m),S=v.s.r;S<=v.e.r;++S){for(var E=[],_=v.s.c;_<=v.e.c;++_){var N=at({r:S,c:_});if(y=b?(m[S]||[])[_]:m[N],!y||y.v==null){E.push("          ");continue}for(var k=(y.w||(Bs(y),y.w)||"").slice(0,10);k.length<10;)k+=" ";E.push(k+(_===0?" ":""))}p.push(E.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:f,from_sheet:x}}();function ND(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=KE.to_workbook(e,r);return r.WTF=a,n}catch(l){if(r.WTF=a,!l.message.match(/SYLK bad record ID/)&&a)throw l;return Qo.to_workbook(e,t)}}var kl=function(){function e(B,I,M){if(B){Jr(B,B.l||0);for(var W=M.Enum||z;B.l<B.length;){var ne=B.read_shift(2),ye=W[ne]||W[65535],be=B.read_shift(2),Se=B.l+be,Ne=ye.f&&ye.f(B,be,M);if(B.l=Se,I(Ne,ye,ne))return}}}function t(B,I){switch(I.type){case"base64":return r(Wa($a(B)),I);case"binary":return r(Wa(B),I);case"buffer":case"array":return r(B,I)}throw"Unsupported type "+I.type}function r(B,I){if(!B)return B;var M=I||{},W=M.dense?[]:{},ne="Sheet1",ye="",be=0,Se={},Ne=[],Xe=[],V={s:{r:0,c:0},e:{r:0,c:0}},We=M.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)M.Enum=z,e(B,function(Oe,Ct,Pt){switch(Pt){case 0:M.vers=Oe,Oe>=4096&&(M.qpro=!0);break;case 6:V=Oe;break;case 204:Oe&&(ye=Oe);break;case 222:ye=Oe;break;case 15:case 51:M.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:Pt==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=M.dateNF||rt[14],M.cellDates&&(Oe[1].t="d",Oe[1].v=Kd(Oe[1].v))),M.qpro&&Oe[3]>be&&(W["!ref"]=ct(V),Se[ne]=W,Ne.push(ne),W=M.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],ne=ye||"Sheet"+(be+1),ye="");var Rr=M.dense?(W[Oe[0].r]||[])[Oe[0].c]:W[at(Oe[0])];if(Rr){Rr.t=Oe[1].t,Rr.v=Oe[1].v,Oe[1].z!=null&&(Rr.z=Oe[1].z),Oe[1].f!=null&&(Rr.f=Oe[1].f);break}M.dense?(W[Oe[0].r]||(W[Oe[0].r]=[]),W[Oe[0].r][Oe[0].c]=Oe[1]):W[at(Oe[0])]=Oe[1];break}},M);else if(B[2]==26||B[2]==14)M.Enum=te,B[2]==14&&(M.qpro=!0,B.l=0),e(B,function(Oe,Ct,Pt){switch(Pt){case 204:ne=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>be&&(W["!ref"]=ct(V),Se[ne]=W,Ne.push(ne),W=M.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],ne="Sheet"+(be+1)),We>0&&Oe[0].r>=We)break;M.dense?(W[Oe[0].r]||(W[Oe[0].r]=[]),W[Oe[0].r][Oe[0].c]=Oe[1]):W[at(Oe[0])]=Oe[1],V.e.c<Oe[0].c&&(V.e.c=Oe[0].c),V.e.r<Oe[0].r&&(V.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Xe[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Xe[Oe[0]]=Oe[1],Oe[0]==be&&(ne=Oe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(W["!ref"]=ct(V),Se[ye||ne]=W,Ne.push(ye||ne),!Xe.length)return{SheetNames:Ne,Sheets:Se};for(var $e={},dt=[],Je=0;Je<Xe.length;++Je)Se[Ne[Je]]?(dt.push(Xe[Je]||Ne[Je]),$e[Xe[Je]]=Se[Xe[Je]]||Se[Ne[Je]]):(dt.push(Xe[Je]),$e[Xe[Je]]={"!ref":"A1"});return{SheetNames:dt,Sheets:$e}}function a(B,I){var M=I||{};if(+M.codepage>=0&&Fn(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Oa(),ne=Nt(B["!ref"]),ye=Array.isArray(B),be=[];Ue(W,0,l(1030)),Ue(W,6,d(ne));for(var Se=Math.min(ne.e.r,8191),Ne=ne.s.r;Ne<=Se;++Ne)for(var Xe=wr(Ne),V=ne.s.c;V<=ne.e.c;++V){Ne===ne.s.r&&(be[V]=or(V));var We=be[V]+Xe,$e=ye?(B[Ne]||[])[V]:B[We];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?Ue(W,13,y(Ne,V,$e.v)):Ue(W,14,S(Ne,V,$e.v));else{var dt=Bs($e);Ue(W,15,p(Ne,V,dt.slice(0,239)))}}return Ue(W,1),W.end()}function n(B,I){var M=I||{};if(+M.codepage>=0&&Fn(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Oa();Ue(W,0,o(B));for(var ne=0,ye=0;ne<B.SheetNames.length;++ne)(B.Sheets[B.SheetNames[ne]]||{})["!ref"]&&Ue(W,27,re(B.SheetNames[ne],ye++));var be=0;for(ne=0;ne<B.SheetNames.length;++ne){var Se=B.Sheets[B.SheetNames[ne]];if(!(!Se||!Se["!ref"])){for(var Ne=Nt(Se["!ref"]),Xe=Array.isArray(Se),V=[],We=Math.min(Ne.e.r,8191),$e=Ne.s.r;$e<=We;++$e)for(var dt=wr($e),Je=Ne.s.c;Je<=Ne.e.c;++Je){$e===Ne.s.r&&(V[Je]=or(Je));var Oe=V[Je]+dt,Ct=Xe?(Se[$e]||[])[Je]:Se[Oe];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")Ue(W,23,q($e,Je,be,Ct.v));else{var Pt=Bs(Ct);Ue(W,22,T($e,Je,be,Pt.slice(0,239)))}}++be}}return Ue(W,1),W.end()}function l(B){var I=_e(2);return I.write_shift(2,B),I}function o(B){var I=_e(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var M=0,W=0,ne=0,ye=0;ye<B.SheetNames.length;++ye){var be=B.SheetNames[ye],Se=B.Sheets[be];if(!(!Se||!Se["!ref"])){++ne;var Ne=Ma(Se["!ref"]);M<Ne.e.r&&(M=Ne.e.r),W<Ne.e.c&&(W=Ne.e.c)}}return M>8191&&(M=8191),I.write_shift(2,M),I.write_shift(1,ne),I.write_shift(1,W),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function f(B,I,M){var W={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&M.qpro?(W.s.c=B.read_shift(1),B.l++,W.s.r=B.read_shift(2),W.e.c=B.read_shift(1),B.l++,W.e.r=B.read_shift(2),W):(W.s.c=B.read_shift(2),W.s.r=B.read_shift(2),I==12&&M.qpro&&(B.l+=2),W.e.c=B.read_shift(2),W.e.r=B.read_shift(2),I==12&&M.qpro&&(B.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function d(B){var I=_e(8);return I.write_shift(2,B.s.c),I.write_shift(2,B.s.r),I.write_shift(2,B.e.c),I.write_shift(2,B.e.r),I}function x(B,I,M){var W=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(W[0].c=B.read_shift(1),W[3]=B.read_shift(1),W[0].r=B.read_shift(2),B.l+=2):(W[2]=B.read_shift(1),W[0].c=B.read_shift(2),W[0].r=B.read_shift(2)),W}function m(B,I,M){var W=B.l+I,ne=x(B,I,M);if(ne[1].t="s",M.vers==20768){B.l++;var ye=B.read_shift(1);return ne[1].v=B.read_shift(ye,"utf8"),ne}return M.qpro&&B.l++,ne[1].v=B.read_shift(W-B.l,"cstr"),ne}function p(B,I,M){var W=_e(7+M.length);W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,B),W.write_shift(1,39);for(var ne=0;ne<W.length;++ne){var ye=M.charCodeAt(ne);W.write_shift(1,ye>=128?95:ye)}return W.write_shift(1,0),W}function v(B,I,M){var W=x(B,I,M);return W[1].v=B.read_shift(2,"i"),W}function y(B,I,M){var W=_e(7);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,B),W.write_shift(2,M,"i"),W}function b(B,I,M){var W=x(B,I,M);return W[1].v=B.read_shift(8,"f"),W}function S(B,I,M){var W=_e(13);return W.write_shift(1,255),W.write_shift(2,I),W.write_shift(2,B),W.write_shift(8,M,"f"),W}function E(B,I,M){var W=B.l+I,ne=x(B,I,M);if(ne[1].v=B.read_shift(8,"f"),M.qpro)B.l=W;else{var ye=B.read_shift(2);R(B.slice(B.l,B.l+ye),ne),B.l+=ye}return ne}function _(B,I,M){var W=I&32768;return I&=-32769,I=(W?B:0)+(I>=8192?I-16384:I),(W?"":"$")+(M?or(I):wr(I))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(B,I){Jr(B,0);for(var M=[],W=0,ne="",ye="",be="",Se="";B.l<B.length;){var Ne=B[B.l++];switch(Ne){case 0:M.push(B.read_shift(8,"f"));break;case 1:ye=_(I[0].c,B.read_shift(2),!0),ne=_(I[0].r,B.read_shift(2),!1),M.push(ye+ne);break;case 2:{var Xe=_(I[0].c,B.read_shift(2),!0),V=_(I[0].r,B.read_shift(2),!1);ye=_(I[0].c,B.read_shift(2),!0),ne=_(I[0].r,B.read_shift(2),!1),M.push(Xe+V+":"+ye+ne)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(B.read_shift(2));break;case 6:{for(var We="";Ne=B[B.l++];)We+=String.fromCharCode(Ne);M.push('"'+We.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:Se=M.pop(),be=M.pop(),M.push(["AND","OR"][Ne-20]+"("+be+","+Se+")");break;default:if(Ne<32&&k[Ne])Se=M.pop(),be=M.pop(),M.push(be+k[Ne]+Se);else if(N[Ne]){if(W=N[Ne][1],W==69&&(W=B[B.l++]),W>M.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+M.join("|")+"|");return}var $e=M.slice(-W);M.length-=W,M.push(N[Ne][0]+"("+$e.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}M.length==1?I[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function A(B){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=B.read_shift(2),I[3]=B[B.l++],I[0].c=B[B.l++],I}function D(B,I){var M=A(B);return M[1].t="s",M[1].v=B.read_shift(I-4,"cstr"),M}function T(B,I,M,W){var ne=_e(6+W.length);ne.write_shift(2,B),ne.write_shift(1,M),ne.write_shift(1,I),ne.write_shift(1,39);for(var ye=0;ye<W.length;++ye){var be=W.charCodeAt(ye);ne.write_shift(1,be>=128?95:be)}return ne.write_shift(1,0),ne}function O(B,I){var M=A(B);M[1].v=B.read_shift(2);var W=M[1].v>>1;if(M[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return M[1].v=W,M}function F(B,I){var M=A(B),W=B.read_shift(4),ne=B.read_shift(4),ye=B.read_shift(2);if(ye==65535)return W===0&&ne===3221225472?(M[1].t="e",M[1].v=15):W===0&&ne===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var be=ye&32768;return ye=(ye&32767)-16446,M[1].v=(1-be*2)*(ne*Math.pow(2,ye+32)+W*Math.pow(2,ye)),M}function q(B,I,M,W){var ne=_e(14);if(ne.write_shift(2,B),ne.write_shift(1,M),ne.write_shift(1,I),W==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var ye=0,be=0,Se=0,Ne=0;return W<0&&(ye=1,W=-W),be=Math.log2(W)|0,W/=Math.pow(2,be-31),Ne=W>>>0,(Ne&2147483648)==0&&(W/=2,++be,Ne=W>>>0),W-=Ne,Ne|=2147483648,Ne>>>=0,W*=Math.pow(2,32),Se=W>>>0,ne.write_shift(4,Se),ne.write_shift(4,Ne),be+=16383+(ye?32768:0),ne.write_shift(2,be),ne}function X(B,I){var M=F(B);return B.l+=I-14,M}function U(B,I){var M=A(B),W=B.read_shift(4);return M[1].v=W>>6,M}function ee(B,I){var M=A(B),W=B.read_shift(8,"f");return M[1].v=W,M}function oe(B,I){var M=ee(B);return B.l+=I-10,M}function ce(B,I){return B[B.l+I-1]==0?B.read_shift(I,"cstr"):""}function Z(B,I){var M=B[B.l++];M>I-1&&(M=I-1);for(var W="";W.length<M;)W+=String.fromCharCode(B[B.l++]);return W}function ie(B,I,M){if(!(!M.qpro||I<21)){var W=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ne=B.read_shift(I-21,"cstr");return[W,ne]}}function ke(B,I){for(var M={},W=B.l+I;B.l<W;){var ne=B.read_shift(2);if(ne==14e3){for(M[ne]=[0,""],M[ne][0]=B.read_shift(2);B[B.l];)M[ne][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return M}function re(B,I){var M=_e(5+B.length);M.write_shift(2,14e3),M.write_shift(2,I);for(var W=0;W<B.length;++W){var ne=B.charCodeAt(W);M[M.l++]=ne>127?95:ne}return M[M.l++]=0,M}var z={0:{n:"BOF",f:jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:X},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function CD(e){var t={},r=e.match(da),a=0,n=!1;if(r)for(;a!=r.length;++a){var l=st(r[a]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=ug[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(l[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+l[0])}}return t}var AD=function(){var e=I0("t"),t=I0("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var f={t:"s",v:Tt(o[1])},d=l.match(t);return d&&(f.s=CD(d[1])),f}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(f){return f.v})}}(),jD=function(){var t=/(\r\n|\n)/g;function r(n,l,o){var f=[];n.u&&f.push("text-decoration: underline;"),n.uval&&f.push("text-underline-style:"+n.uval+";"),n.sz&&f.push("font-size:"+n.sz+"pt;"),n.outline&&f.push("text-effect: outline;"),n.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),n.b&&(l.push("<b>"),o.push("</b>")),n.i&&(l.push("<i>"),o.push("</i>")),n.strike&&(l.push("<s>"),o.push("</s>"));var d=n.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(l.push("<"+d+">"),o.push("</"+d+">")),o.push("</span>"),n}function a(n){var l=[[],n.v,[]];return n.v?(n.s&&r(n.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(a).join("")}}(),RD=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,DD=/<(?:\w+:)?r>/,FD=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Og(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Tt(Vt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Vt(e),r&&(a.h=bg(a.t))):e.match(DD)&&(a.r=Vt(e),a.t=Tt(Vt((e.replace(FD,"").match(RD)||[]).join("").replace(da,""))),r&&(a.h=jD(AD(a.r)))),a):{t:""}}var OD=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,MD=/<(?:\w+:)?(?:si|sstItem)>/g,LD=/<\/(?:\w+:)?(?:si|sstItem)>/;function BD(e,t){var r=[],a="";if(!e)return r;var n=e.match(OD);if(n){a=n[2].replace(MD,"").split(LD);for(var l=0;l!=a.length;++l){var o=Og(a[l].trim(),t);o!=null&&(r[r.length]=o)}n=st(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var PD=/^\s|\s$|[\t\n\r]/;function JE(e,t){if(!t.bookSST)return"";var r=[Er];r[r.length]=Ie("sst",null,{xmlns:Ll[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],l="<si>";n.r?l+=n.r:(l+="<t",n.t||(n.t=""),n.t.match(PD)&&(l+=' xml:space="preserve"'),l+=">"+Bt(n.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ID(e){return[e.read_shift(4),e.read_shift(4)]}function UD(e,t){var r=[],a=!1;return Us(e,function(l,o,f){switch(f){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),r}function zD(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var HD=Zj;function GD(e){var t=Oa();je(t,159,zD(e));for(var r=0;r<e.length;++r)je(t,19,HD(e[r]));return je(t,160),t.end()}function e_(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Os(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function VD(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Os(e,4),t.U=Os(e,4),t.W=Os(e,4),t}function qD(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),l=[];n-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function WD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(qD(e));return t}function XD(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function YD(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Os(e,4),t.U=Os(e,4),t.W=Os(e,4),t}function $D(e){var t=YD(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function t_(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function r_(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function KD(e){var t=Os(e);switch(t.Minor){case 2:return[t.Minor,QD(e)];case 3:return[t.Minor,ZD()];case 4:return[t.Minor,JD(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function QD(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=t_(e,r),n=r_(e,e.length-e.l);return{t:"Std",h:a,v:n}}function ZD(){throw new Error("File is password-protected: ECMA-376 Extensible")}function JD(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(da,function(l){var o=st(l);switch(is(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(f){a[f]=o[f]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function eF(e,t){var r={},a=r.EncryptionVersionInfo=Os(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=t_(e,n),t-=n,r.EncryptionVerifier=r_(e,t),r}function tF(e){var t={},r=t.EncryptionVersionInfo=Os(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Mg(e){var t=0,r,a=e_(e),n=a.length+1,l,o,f,d,x;for(r=Di(n),r[0]=a.length,l=1;l!=n;++l)r[l]=a[l-1];for(l=n-1;l>=0;--l)o=r[l],f=(t&16384)===0?0:1,d=t<<1&32767,x=f|d,t=x^o;return t^52811}var a_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,f){return a(o^f)},l=function(o){for(var f=t[o.length-1],d=104,x=o.length-1;x>=0;--x)for(var m=o[x],p=0;p!=7;++p)m&64&&(f^=r[d]),m*=2,--d;return f};return function(o){for(var f=e_(o),d=l(f),x=f.length,m=Di(16),p=0;p!=16;++p)m[p]=0;var v,y,b;for((x&1)===1&&(v=d>>8,m[x]=n(e[0],v),--x,v=d&255,y=f[f.length-1],m[x]=n(y,v));x>0;)--x,v=d>>8,m[x]=n(f[x],v),--x,v=d&255,m[x]=n(f[x],v);for(x=15,b=15-f.length;b>0;)v=d>>8,m[x]=n(e[b],v),--x,--b,v=d&255,m[x]=n(f[x],v),--x,--b;return m}}(),rF=function(e,t,r,a,n){n||(n=t),a||(a=a_(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=a[r],o=(o>>5|o<<3)&255,n[l]=o,++r;return[n,r,a]},aF=function(e){var t=0,r=a_(e);return function(a){var n=rF("",a,t,r);return t=n[1],n[0]}};function nF(e,t,r,a){var n={key:jr(e),verificationBytes:jr(e)};return r.password&&(n.verifier=Mg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=aF(r.password)),n}function sF(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=tF(e):a.Data=eF(e,t),a}function iF(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?sF(e,t-2,a):nF(e,r.biff>=8?t:t-2,r,a),a}var n_=function(){function e(n,l){switch(l.type){case"base64":return t($a(n),l);case"binary":return t(n,l);case"buffer":return t(mt&&Buffer.isBuffer(n)?n.toString("binary"):Bi(n),l);case"array":return t(Rl(n),l)}throw new Error("Unrecognized type "+l.type)}function t(n,l){var o=l||{},f=o.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,p){Array.isArray(f)&&(f[p]=[]);for(var v=/\\\w+\b/g,y=0,b,S=-1;b=v.exec(m);){switch(b[0]){case"\\cell":var E=m.slice(y,v.lastIndex-b[0].length);if(E[0]==" "&&(E=E.slice(1)),++S,E.length){var _={v:E,t:"s"};Array.isArray(f)?f[p][S]=_:f[at({r:p,c:S})]=_}break}y=v.lastIndex}S>x.e.c&&(x.e.c=S)}),f["!ref"]=ct(x),f}function r(n,l){return Pi(e(n,l),l)}function a(n){for(var l=["{\\rtf1\\ansi"],o=Nt(n["!ref"]),f,d=Array.isArray(n),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var p=at({r:x,c:m});f=d?(n[x]||[])[m]:n[p],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(Bs(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function lF(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function G0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function oF(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),l=Math.min(t,r,a),o=n-l;if(o===0)return[0,0,t];var f=0,d=0,x=n+l;switch(d=o/(x>1?2-x:x),n){case t:f=((r-a)/o+6)%6;break;case r:f=(a-t)/o+2;break;case a:f=(t-r)/o+4;break}return[f/6,d,x/2]}function cF(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),l=a-n/2,o=[l,l,l],f=6*t,d;if(r!==0)switch(f|0){case 0:case 6:d=n*f,o[0]+=n,o[1]+=d;break;case 1:d=n*(2-f),o[0]+=d,o[1]+=n;break;case 2:d=n*(f-2),o[1]+=n,o[2]+=d;break;case 3:d=n*(4-f),o[1]+=d,o[2]+=n;break;case 4:d=n*(f-4),o[2]+=n,o[0]+=d;break;case 5:d=n*(6-f),o[2]+=d,o[0]+=n;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function Ad(e,t){if(t===0)return e;var r=oF(lF(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),G0(cF(r))}var s_=6,uF=15,fF=1,la=s_;function V0(e){return Math.floor((e+Math.round(128/la)/256)*la)}function q0(e){return Math.floor((e-5)/la*100+.5)/100}function jd(e){return Math.round((e*la+5)/la*256)/256}function zm(e){return jd(q0(V0(e)))}function Lg(e){var t=Math.abs(e-zm(e)),r=la;if(t>.005)for(la=fF;la<uF;++la)Math.abs(e-zm(e))<=t&&(t=Math.abs(e-zm(e)),r=la);la=r}function Fi(e){e.width?(e.wpx=V0(e.width),e.wch=q0(e.wpx),e.MDW=la):e.wpx?(e.wch=q0(e.wpx),e.width=jd(e.wch),e.MDW=la):typeof e.wch=="number"&&(e.width=jd(e.wch),e.wpx=V0(e.width),e.MDW=la),e.customWidth&&delete e.customWidth}var dF=96,i_=dF;function W0(e){return e*96/i_}function Zo(e){return e*i_/96}var hF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xF(e,t,r,a){t.Borders=[];var n={},l=!1;(e[0].match(da)||[]).forEach(function(o){var f=st(o);switch(is(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},f.diagonalUp&&(n.diagonalUp=tr(f.diagonalUp)),f.diagonalDown&&(n.diagonalDown=tr(f.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function mF(e,t,r,a){t.Fills=[];var n={},l=!1;(e[0].match(da)||[]).forEach(function(o){var f=st(o);switch(is(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":f.patternType&&(n.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),f.indexed&&(n.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(n.bgColor.theme=parseInt(f.theme,10)),f.tint&&(n.bgColor.tint=parseFloat(f.tint)),f.rgb&&(n.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),f.theme&&(n.fgColor.theme=parseInt(f.theme,10)),f.tint&&(n.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(n.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function pF(e,t,r,a){t.Fonts=[];var n={},l=!1;(e[0].match(da)||[]).forEach(function(o){var f=st(o);switch(is(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":f.val&&(n.name=Vt(f.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=f.val?tr(f.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=f.val?tr(f.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(f.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=f.val?tr(f.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=f.val?tr(f.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=f.val?tr(f.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=f.val?tr(f.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=f.val?tr(f.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":f.val&&(n.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(n.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(n.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(n.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=ug[parseInt(f.val,10)];break;case"<color":if(n.color||(n.color={}),f.auto&&(n.color.auto=tr(f.auto)),f.rgb)n.color.rgb=f.rgb.slice(-6);else if(f.indexed){n.color.index=parseInt(f.indexed,10);var d=El[n.color.index];n.color.index==81&&(d=El[1]),d||(d=El[1]),n.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else f.theme&&(n.color.theme=parseInt(f.theme,10),f.tint&&(n.color.tint=parseFloat(f.tint)),f.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Ad(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(a&&a.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function gF(e,t,r){t.NumberFmt=[];for(var a=pr(rt),n=0;n<a.length;++n)t.NumberFmt[a[n]]=rt[a[n]];var l=e[0].match(da);if(l)for(n=0;n<l.length;++n){var o=st(l[n]);switch(is(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=Tt(Vt(o.formatCode)),d=parseInt(o.numFmtId,10);if(t.NumberFmt[d]=f,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=f}Fs(f,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function vF(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ie("numFmt",null,{numFmtId:a,formatCode:Bt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ie("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var qf=["numFmtId","fillId","fontId","borderId","xfId"],Wf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function yF(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(da)||[]).forEach(function(l){var o=st(l),f=0;switch(is(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],f=0;f<qf.length;++f)a[qf[f]]&&(a[qf[f]]=parseInt(a[qf[f]],10));for(f=0;f<Wf.length;++f)a[Wf[f]]&&(a[Wf[f]]=tr(a[Wf[f]]));if(t.NumberFmt&&a.numFmtId>392){for(f=392;f>60;--f)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[f]){a.numFmtId=f;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};o.vertical&&(d.vertical=o.vertical),o.horizontal&&(d.horizontal=o.horizontal),o.textRotation!=null&&(d.textRotation=o.textRotation),o.indent&&(d.indent=o.indent),o.wrapText&&(d.wrapText=tr(o.wrapText)),a.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function bF(e){var t=[];return t[t.length]=Ie("cellXfs",null),e.forEach(function(r){t[t.length]=Ie("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ie("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var wF=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,d,x){var m={};if(!f)return m;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=f.match(t))&&gF(p,m,x),(p=f.match(n))&&pF(p,m,d,x),(p=f.match(a))&&mF(p,m,d,x),(p=f.match(l))&&xF(p,m,d,x),(p=f.match(r))&&yF(p,m,x),m}}();function l_(e,t){var r=[Er,Ie("styleSheet",null,{xmlns:Ll[0],"xmlns:vt":Br.vt})],a;return e.SSF&&(a=vF(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=bF(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SF(e,t){var r=e.read_shift(2),a=ua(e);return[r,a]}function EF(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),Wr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function _F(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=s8(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var f=e.read_shift(1);f>0&&(a.family=f);var d=e.read_shift(1);switch(d>0&&(a.charset=d),e.l++,a.color=n8(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ua(e),a}function kF(e,t){t||(t=_e(25+4*32)),t.write_shift(2,e.sz*20),i8(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Td(e.color,t);var a=0;return a=2,t.write_shift(1,a),Wr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var TF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hm,NF=fa;function jw(e,t){t||(t=_e(4*3+8*7+16*1)),Hm||(Hm=Yd(TF));var r=Hm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Td({auto:1},t),Td({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function CF(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function o_(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function h0(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var AF=fa;function jF(e,t){return t||(t=_e(51)),t.write_shift(1,0),h0(null,t),h0(null,t),h0(null,t),h0(null,t),h0(null,t),t.length>t.l?t.slice(0,t.l):t}function RF(e,t){return t||(t=_e(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),kd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function DF(e,t,r){var a=_e(2052);return a.write_shift(4,e),kd(t,a),kd(r,a),a.length>a.l?a.slice(0,a.l):a}function FF(e,t,r){var a={};a.NumberFmt=[];for(var n in rt)a.NumberFmt[n]=rt[n];a.CellXf=[],a.Fonts=[];var l=[],o=!1;return Us(e,function(d,x,m){switch(m){case 44:a.NumberFmt[d[0]]=d[1],Fs(d[1],d[0]);break;case 43:a.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=Ad(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&a.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(m),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(m);else if(x.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),a}function OF(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(je(e,615,Ln(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&je(e,44,EF(n,t[n]))}),je(e,616))}}function MF(e){var t=1;je(e,611,Ln(t)),je(e,43,kF({sz:12,color:{theme:1},name:"Calibri",family:2})),je(e,612)}function LF(e){var t=2;je(e,603,Ln(t)),je(e,45,jw({patternType:"none"})),je(e,45,jw({patternType:"gray125"})),je(e,604)}function BF(e){var t=1;je(e,613,Ln(t)),je(e,46,jF()),je(e,614)}function PF(e){var t=1;je(e,626,Ln(t)),je(e,47,o_({numFmtId:0},65535)),je(e,627)}function IF(e,t){je(e,617,Ln(t.length)),t.forEach(function(r){je(e,47,o_(r,0))}),je(e,618)}function UF(e){var t=1;je(e,619,Ln(t)),je(e,48,RF({xfId:0,name:"Normal"})),je(e,620)}function zF(e){var t=0;je(e,505,Ln(t)),je(e,506)}function HF(e){var t=0;je(e,508,DF(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function GF(e,t){var r=Oa();return je(r,278),OF(r,e.SSF),MF(r),LF(r),BF(r),PF(r),IF(r,t.cellXfs),UF(r),zF(r),HF(r),je(r,279),r.end()}var VF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qF(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(da)||[]).forEach(function(n){var l=st(n);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=l.val;break;case"<a:sysClr":a.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[VF.indexOf(l[0])]=a,a={}):a.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function WF(){}function XF(){}var YF=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$F=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,KF=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function QF(e,t,r){t.themeElements={};var a;[["clrScheme",YF,qF],["fontScheme",$F,WF],["fmtScheme",KF,XF]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var ZF=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function c_(e,t){(!e||e.length===0)&&(e=Bg());var r,a={};if(!(r=e.match(ZF)))throw new Error("themeElements not found in theme");return QF(r[0],a,t),a.raw=e,a}function Bg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Er];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function JF(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var l=e.slice(e.l);e.l=a;var o;try{o=tE(l,{type:"array"})}catch{return}var f=Xa(o,"theme/theme/theme1.xml",!0);if(f)return c_(f,r)}}function eO(e){return e.read_shift(4)}function tO(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=rO(e,4);break;case 2:t.xclrValue=HE(e);break;case 3:t.xclrValue=eO(e);break;case 4:e.l+=4;break}return e.l+=8,t}function rO(e,t){return fa(e,t)}function aO(e,t){return fa(e,t)}function nO(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=tO(e);break;case 6:a[1]=aO(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function sO(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),l=[];n-- >0;)l.push(nO(e,r-e.l));return{ixfe:a,ext:l}}function iO(e,t){t.forEach(function(r){r[0]})}function lO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ua(e)}}function oO(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Wr(e.name,t),t.slice(0,t.l)}function cO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function uO(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function fO(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),Wr(t,r),r.slice(0,r.l)}function dO(e){return e.l+=4,e.read_shift(4)!=0}function hO(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,1),r}function xO(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},l=[],o=!1,f=2;return Us(e,function(d,x,m){switch(m){case 335:a.Types.push({name:d.name});break;case 51:d.forEach(function(p){f==1?a.Cell.push({type:a.Types[p[0]-1].name,index:p[1]}):f==0&&a.Value.push({type:a.Types[p[0]-1].name,index:p[1]})});break;case 337:f=d?1:0;break;case 338:f=2;break;case 35:l.push(m),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||n.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}function mO(){var e=Oa();return je(e,332),je(e,334,Ln(1)),je(e,335,oO({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,fO(1,"XLDAPR")),je(e,52),je(e,35,Ln(514)),je(e,4096,Ln(0)),je(e,4097,xn(1)),je(e,36),je(e,53),je(e,340),je(e,337,hO(1)),je(e,51,uO([[1,0]])),je(e,338),je(e,333),e.end()}function pO(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,l=2,o;return e.replace(da,function(f){var d=st(f);switch(is(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<a.Types.length;++x)a.Types[x].name==d.name&&(o=a.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?a.Cell.push({type:a.Types[d.t-1].name,index:+d.v}):l==0&&a.Value.push({type:a.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+d.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return f}),a}function u_(){var e=[Er];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function gO(e){var t=[];if(!e)return t;var r=1;return(e.match(da)||[]).forEach(function(a){var n=st(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function vO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=at(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function yO(e,t,r){var a=[];return Us(e,function(l,o,f){switch(f){case 63:a.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function bO(e,t,r,a){if(!e)return e;var n=a||{},l=!1;Us(e,function(f,d,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!d.T){if(!l||n.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},n)}function wO(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ro=1024;function f_(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Ie("xml",null,{"xmlns:v":Va.v,"xmlns:o":Va.o,"xmlns:x":Va.x,"xmlns:mv":Va.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Ro<e*1e3;)Ro+=1e3;return t.forEach(function(l){var o=cr(l[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var d=f.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Ie("v:fill",d,f),m={on:"t",obscured:"t"};++Ro,n=n.concat(["<v:shape"+U0({id:"_x0000_s"+Ro,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Ie("v:shadow",null,m),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ea("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ea("x:AutoFill","False"),ea("x:Row",String(o.r)),ea("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Rw(e,t,r,a){var n=Array.isArray(e),l;t.forEach(function(o){var f=cr(o.ref);if(n?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[o.ref],!l){l={t:"z"},n?e[f.r][f.c]=l:e[o.ref]=l;var d=Nt(e["!ref"]||"BDWGO1000001:A1");d.s.r>f.r&&(d.s.r=f.r),d.e.r<f.r&&(d.e.r=f.r),d.s.c>f.c&&(d.s.c=f.c),d.e.c<f.c&&(d.e.c=f.c);var x=ct(d);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var p=l.c.length-1;p>=0;--p){if(!r&&l.c[p].T)return;r&&!l.c[p].T&&l.c.splice(p,1)}if(r&&a){for(p=0;p<a.length;++p)if(m.a==a[p].id){m.a=a[p].name||m.a;break}}l.c.push(m)})}function SO(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&r.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var f=o.match(/<(?:\w+:)?comment[^>]*>/);if(f){var d=st(f[0]),x={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=cr(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var p=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!p&&!!p[1]&&Og(p[1])||{r:"",t:"",h:""};x.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),x.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(x.h=v.h),a.push(x)}}}}),a}function d_(e){var t=[Er,Ie("comments",null,{xmlns:Ll[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var l=Bt(n.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(n=r.indexOf(Bt(d.a))),l.push(d.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),l.length<=1)t.push(ea("t",Bt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,f=1;f<l.length;++f)o+=`Reply:
    `+l[f]+`
`;t.push(ea("t",Bt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function EO(e,t){var r=[],a=!1,n={},l=0;return e.replace(da,function(f,d){var x=st(f);switch(is(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":l=d+f.length;break;case"</text>":n.t=e.slice(l,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return f}),r}function _O(e,t,r){var a=[Er,Ie("ThreadedComments",null,{xmlns:Br.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var l="";(n[1]||[]).forEach(function(o,f){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};f==0?l=d.id:d.parentId=l,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Ie("threadedComment",ea("text",o.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function kO(e,t){var r=[],a=!1;return e.replace(da,function(l){var o=st(l);switch(is(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function TO(e){var t=[Er,Ie("personList",null,{xmlns:Br.TCMNT,"xmlns:x":Ll[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ie("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function NO(e){var t={};t.iauthor=e.read_shift(4);var r=Ul(e);return t.rfx=r.s,t.ref=at(r.s),e.l+=16,t}function CO(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),uc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var AO=ua;function jO(e){return Wr(e.slice(0,54))}function RO(e,t){var r=[],a=[],n={},l=!1;return Us(e,function(f,d,x){switch(x){case 632:a.push(f);break;case 635:n=f;break;case 637:n.t=f.t,n.h=f.h,n.r=f.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}function DO(e){var t=Oa(),r=[];return je(t,628),je(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),je(t,632,jO(n.a)))})}),je(t,631),je(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var l={s:cr(a[0]),e:cr(a[0])};je(t,635,CO([l,n])),n.t&&n.t.length>0&&je(t,637,e8(n)),je(t,636),delete n.iauthor})}),je(t,634),je(t,629),t.end()}var FO="application/vnd.ms-office.vbaProject";function OO(e){var t=Ke.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ke.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Ke.write(t)}function MO(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Ke.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var h_=["xlsb","xlsm","xlam","biff8","xla"];function LO(){return{"!type":"dialog"}}function BO(){return{"!type":"dialog"}}function PO(){return{"!type":"macro"}}function IO(){return{"!type":"macro"}}var Mo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,l,o){var f=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return f?m+=t.c:--m,d?x+=t.r:--x,n+(f?"":"$")+or(m)+(d?"":"$")+wr(x)}return function(n,l){return t=l,n.replace(e,r)}}(),Pg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ig=function(){return function(t,r){return t.replace(Pg,function(a,n,l,o,f,d){var x=kg(o)-(l?0:r.c),m=_g(d)-(f?0:r.r),p=m==0?"":f?m+1:"["+m+"]",v=x==0?"":l?x+1:"["+x+"]";return n+"R"+p+"C"+v})}}();function x_(e,t){return e.replace(Pg,function(r,a,n,l,o,f){return a+(n=="$"?n+l:or(kg(l)+t.c))+(o=="$"?o+f:wr(_g(f)+t.r))})}function UO(e,t,r){var a=Ma(t),n=a.s,l=cr(r),o={r:l.r-n.r,c:l.c-n.c};return x_(e,o)}function zO(e){return e.length!=1}function Dw(e){return e.replace(/_xlfn\./g,"")}function Nr(e){e.l+=1}function Oi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m_(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return p_(e);r.biff==12&&(a=4)}var n=e.read_shift(a),l=e.read_shift(a),o=Oi(e),f=Oi(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function p_(e){var t=Oi(e),r=Oi(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function HO(e,t,r){if(r.biff<8)return p_(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),l=Oi(e),o=Oi(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function g_(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return GO(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Oi(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function GO(e){var t=Oi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function VO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function qO(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return WO(e);var n=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;n>524287;)n-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:n,c:l,cRel:o,rRel:f}}function WO(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function XO(e,t,r){var a=(e[e.l++]&96)>>5,n=m_(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function YO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=m_(e,l,r);return[a,n,o]}function $O(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function KO(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,n]}function QO(e,t,r){var a=(e[e.l++]&96)>>5,n=HO(e,t-1,r);return[a,n]}function ZO(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Fw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function JO(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],l=0;l<=a;++l)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function e7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function t7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function r7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function a7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function v_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function n7(e){return e.read_shift(2),v_(e)}function s7(e){return e.read_shift(2),v_(e)}function i7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=g_(e,0,r);return[a,n]}function l7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=qO(e,0,r);return[a,n]}function o7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=g_(e,0,r);return[a,n,l]}function c7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[dM[n],w_[n],a]}function u7(e,t,r){var a=e[e.l++],n=e.read_shift(1),l=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:f7(e);return[n,(l[0]===0?w_:fM)[l[1]]]}function f7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function d7(e,t,r){e.l+=r&&r.biff==2?3:4}function h7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function x7(e){return e.l++,zs[e.read_shift(1)]}function m7(e){return e.l++,e.read_shift(2)}function p7(e){return e.l++,e.read_shift(1)!==0}function g7(e){return e.l++,ca(e)}function v7(e,t,r){return e.l++,hu(e,t-1,r)}function y7(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=br(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ca(e);break;case 2:r[1]=zl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function b7(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],l=0;l!=a;++l)n.push((r.biff==12?Ul:Qd)(e));return n}function w7(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var f=0;f!=n;++f)o[l][f]=y7(e,r.biff);return o}function S7(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,l=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function E7(e,t,r){if(r.biff==5)return _7(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),l=e.read_shift(4);return[a,n,l]}function _7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function k7(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function T7(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function N7(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function C7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,n]}var A7=fa,j7=fa,R7=fa;function mu(e,t,r){return e.l+=2,[VO(e)]}function Ug(e){return e.l+=6,[]}var D7=mu,F7=Ug,O7=Ug,M7=mu;function y_(e){return e.l+=2,[jr(e),e.read_shift(2)&1]}var L7=mu,B7=y_,P7=Ug,I7=mu,U7=mu,z7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),l=e.read_shift(2),o=z7[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:l}}function G7(e){return e.l+=2,[e.read_shift(4)]}function V7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function q7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function W7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function X7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Y7(e){return e.l+=4,[0,0]}var Ow={1:{n:"PtgExp",f:h7},2:{n:"PtgTbl",f:R7},3:{n:"PtgAdd",f:Nr},4:{n:"PtgSub",f:Nr},5:{n:"PtgMul",f:Nr},6:{n:"PtgDiv",f:Nr},7:{n:"PtgPower",f:Nr},8:{n:"PtgConcat",f:Nr},9:{n:"PtgLt",f:Nr},10:{n:"PtgLe",f:Nr},11:{n:"PtgEq",f:Nr},12:{n:"PtgGe",f:Nr},13:{n:"PtgGt",f:Nr},14:{n:"PtgNe",f:Nr},15:{n:"PtgIsect",f:Nr},16:{n:"PtgUnion",f:Nr},17:{n:"PtgRange",f:Nr},18:{n:"PtgUplus",f:Nr},19:{n:"PtgUminus",f:Nr},20:{n:"PtgPercent",f:Nr},21:{n:"PtgParen",f:Nr},22:{n:"PtgMissArg",f:Nr},23:{n:"PtgStr",f:v7},26:{n:"PtgSheet",f:V7},27:{n:"PtgEndSheet",f:q7},28:{n:"PtgErr",f:x7},29:{n:"PtgBool",f:p7},30:{n:"PtgInt",f:m7},31:{n:"PtgNum",f:g7},32:{n:"PtgArray",f:ZO},33:{n:"PtgFunc",f:c7},34:{n:"PtgFuncVar",f:u7},35:{n:"PtgName",f:S7},36:{n:"PtgRef",f:i7},37:{n:"PtgArea",f:XO},38:{n:"PtgMemArea",f:k7},39:{n:"PtgMemErr",f:A7},40:{n:"PtgMemNoMem",f:j7},41:{n:"PtgMemFunc",f:T7},42:{n:"PtgRefErr",f:N7},43:{n:"PtgAreaErr",f:$O},44:{n:"PtgRefN",f:l7},45:{n:"PtgAreaN",f:QO},46:{n:"PtgMemAreaN",f:W7},47:{n:"PtgMemNoMemN",f:X7},57:{n:"PtgNameX",f:E7},58:{n:"PtgRef3d",f:o7},59:{n:"PtgArea3d",f:YO},60:{n:"PtgRefErr3d",f:C7},61:{n:"PtgAreaErr3d",f:KO},255:{}},$7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},K7={1:{n:"PtgElfLel",f:y_},2:{n:"PtgElfRw",f:I7},3:{n:"PtgElfCol",f:D7},6:{n:"PtgElfRwV",f:U7},7:{n:"PtgElfColV",f:M7},10:{n:"PtgElfRadical",f:L7},11:{n:"PtgElfRadicalS",f:P7},13:{n:"PtgElfColS",f:F7},15:{n:"PtgElfColSV",f:O7},16:{n:"PtgElfRadicalLel",f:B7},25:{n:"PtgList",f:H7},29:{n:"PtgSxName",f:G7},255:{}},Q7={0:{n:"PtgAttrNoop",f:Y7},1:{n:"PtgAttrSemi",f:a7},2:{n:"PtgAttrIf",f:t7},4:{n:"PtgAttrChoose",f:JO},8:{n:"PtgAttrGoto",f:e7},16:{n:"PtgAttrSum",f:d7},32:{n:"PtgAttrBaxcel",f:Fw},33:{n:"PtgAttrBaxcel",f:Fw},64:{n:"PtgAttrSpace",f:n7},65:{n:"PtgAttrSpaceSemi",f:s7},128:{n:"PtgAttrIfError",f:r7},255:{}};function pu(e,t,r,a){if(a.biff<8)return fa(e,t);for(var n=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=w7(e,0,a),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=b7(e,r[o][1],a),l.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&l.push(fa(e,t)),l}function gu(e,t,r){for(var a=e.l+t,n,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],n=Ow[l]||Ow[$7[l]],(l===24||l===25)&&(n=(l===24?K7:Q7)[e[e.l+1]]),!n||!n.f?fa(e,t):o.push([n.n,n.f(e,t,r)]);return o}function Z7(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var J7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function eM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function b_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Mw(e,t,r){var a=b_(e,t,r);return a=="#REF"?a:eM(a,r)}function ia(e,t,r,a,n){var l=n&&n.biff||8,o={s:{c:0,r:0}},f=[],d,x,m,p=0,v=0,y,b="";if(!e[0]||!e[0][0])return"";for(var S=-1,E="",_=0,N=e[0].length;_<N;++_){var k=e[0][_];switch(k[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=f.pop(),x=f.pop(),S>=0){switch(e[0][S][1][0]){case 0:E=xr(" ",e[0][S][1][1]);break;case 1:E=xr("\r",e[0][S][1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}x=x+E,S=-1}f.push(x+J7[k[0]]+d);break;case"PtgIsect":d=f.pop(),x=f.pop(),f.push(x+" "+d);break;case"PtgUnion":d=f.pop(),x=f.pop(),f.push(x+","+d);break;case"PtgRange":d=f.pop(),x=f.pop(),f.push(x+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=S0(k[1][1],o,n),f.push(E0(m,l));break;case"PtgRefN":m=r?S0(k[1][1],r,n):k[1][1],f.push(E0(m,l));break;case"PtgRef3d":p=k[1][1],m=S0(k[1][2],o,n),b=Mw(a,p,n),f.push(b+"!"+E0(m,l));break;case"PtgFunc":case"PtgFuncVar":var R=k[1][0],A=k[1][1];R||(R=0),R&=127;var D=R==0?[]:f.slice(-R);f.length-=R,A==="User"&&(A=D.shift()),f.push(A+"("+D.join(",")+")");break;case"PtgBool":f.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(k[1]);break;case"PtgNum":f.push(String(k[1]));break;case"PtgStr":f.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(k[1]);break;case"PtgAreaN":y=uw(k[1][1],r?{s:r}:o,n),f.push(Pm(y,n));break;case"PtgArea":y=uw(k[1][1],o,n),f.push(Pm(y,n));break;case"PtgArea3d":p=k[1][1],y=k[1][2],b=Mw(a,p,n),f.push(b+"!"+Pm(y,n));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=k[1][2];var T=(a.names||[])[v-1]||(a[0]||[])[v],O=T?T.Name:"SH33TJSNAME"+String(v);O&&O.slice(0,6)=="_xlfn."&&!n.xlfn&&(O=O.slice(6)),f.push(O);break;case"PtgNameX":var F=k[1][1];v=k[1][2];var q;if(n.biff<=5)F<0&&(F=-F),a[F]&&(q=a[F][v]);else{var X="";if(((a[F]||[])[0]||[])[0]==14849||(((a[F]||[])[0]||[])[0]==1025?a[F][v]&&a[F][v].itab>0&&(X=a.SheetNames[a[F][v].itab-1]+"!"):X=a.SheetNames[v-1]+"!"),a[F]&&a[F][v])X+=a[F][v].Name;else if(a[0]&&a[0][v])X+=a[0][v].Name;else{var U=(b_(a,F,n)||"").split(";;");U[v-1]?X=U[v-1]:X+="SH33TJSERRX"}f.push(X);break}q||(q={Name:"SH33TJSERRY"}),f.push(q.Name);break;case"PtgParen":var ee="(",oe=")";if(S>=0){switch(E="",e[0][S][1][0]){case 2:ee=xr(" ",e[0][S][1][1])+ee;break;case 3:ee=xr("\r",e[0][S][1][1])+ee;break;case 4:oe=xr(" ",e[0][S][1][1])+oe;break;case 5:oe=xr("\r",e[0][S][1][1])+oe;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}f.push(ee+f.pop()+oe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":m={c:k[1][1],r:k[1][0]};var ce={c:r.c,r:r.r};if(a.sharedf[at(m)]){var Z=a.sharedf[at(m)];f.push(ia(Z,o,ce,a,n))}else{var ie=!1;for(d=0;d!=a.arrayf.length;++d)if(x=a.arrayf[d],!(m.c<x[0].s.c||m.c>x[0].e.c)&&!(m.r<x[0].s.r||m.r>x[0].e.r)){f.push(ia(x[1],o,ce,a,n)),ie=!0;break}ie||f.push(k[1])}break;case"PtgArray":f.push("{"+Z7(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&S>=0&&ke.indexOf(e[0][_][0])==-1){k=e[0][S];var re=!0;switch(k[1][0]){case 4:re=!1;case 0:E=xr(" ",k[1][1]);break;case 5:re=!1;case 1:E=xr("\r",k[1][1]);break;default:if(E="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}f.push((re?E:"")+f.pop()+(re?"":E)),S=-1}}if(f.length>1&&n.WTF)throw new Error("bad formula stack");return f[0]}function tM(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],fa(e,t-2)];var f=gu(e,o,r);return t!==o+n&&(l=pu(e,t-o-n,f,r)),e.l=a,[f,l]}function rM(e,t,r){var a=e.l+t,n=r.biff==2?1:2,l,o=e.read_shift(n);if(o==65535)return[[],fa(e,t-2)];var f=gu(e,o,r);return t!==o+n&&(l=pu(e,t-o-n,f,r)),e.l=a,[f,l]}function aM(e,t,r,a){var n=e.l+t,l=gu(e,a,r),o;return n!==e.l&&(o=pu(e,n-e.l,l,r)),[l,o]}function nM(e,t,r){var a=e.l+t,n,l=e.read_shift(2),o=gu(e,l,r);return l==65535?[[],fa(e,t-2)]:(t!==l+2&&(n=pu(e,a-l-2,o,r)),[o,n])}function sM(e){var t;if(js(e,e.l+6)!==65535)return[ca(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function iM(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Dl(e);return Dl(0)}function Gm(e,t,r){var a=e.l+t,n=ls(e);r.biff==2&&++e.l;var l=sM(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var f=rM(e,a-e.l,r);return{cell:n,val:l[0],formula:f,shared:o>>3&1,tt:l[1]}}function lM(e,t,r,a,n){var l=Ol(t,r,n),o=iM(e.v),f=_e(6),d=33;f.write_shift(2,d),f.write_shift(4,0);for(var x=_e(e.bf.length),m=0;m<e.bf.length;++m)x[m]=e.bf[m];var p=qr([l,o,f,x]);return p}function Zd(e,t,r){var a=e.read_shift(4),n=gu(e,a,r),l=e.read_shift(4),o=l>0?pu(e,l,n,r):null;return[n,o]}var oM=Zd,Jd=Zd,cM=Zd,uM=Zd,fM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},w_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Lw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function hM(e){var t="of:="+e.replace(Pg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Vm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function xM(e){return e.replace(/\./,"!")}var k0={},Lo={},T0=typeof Map<"u";function zg(e,t,r){var a=0,n=e.length;if(r){if(T0?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=T0?r.get(t):r[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(T0?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function eh(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(la=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=q0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=jd(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Tl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ii(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,l=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Fs(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=l;++n)if(e[n].numFmtId===a)return n;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function S_(e,t,r,a,n,l){try{a.cellNF&&(e.z=rt[t])}catch(f){if(a.WTF)throw f}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(rt[t]==null&&Fs(fj[t]||"General",t),e.t==="e")e.w=e.w||zs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v);else if(e.t==="d"){var o=Pr(e.v);(o|0)===o?e.w=o.toString(10):e.w=P0(o)}else{if(e.v===void 0)return"";e.w=jl(e.v,Lo)}else e.t==="d"?e.w=gn(t,Pr(e.v),Lo):e.w=gn(t,e.v,Lo)}catch(f){if(a.WTF)throw f}if(a.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ad(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ad(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(a.WTF&&l.Fills)throw f}}}function mM(e,t,r){if(e&&e["!ref"]){var a=Nt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pM(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ct(r))}var gM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,vM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,yM=/<(?:\w:)?hyperlink [^>]*>/mg,bM=/"(\w*:\w*)"/,wM=/<(?:\w:)?col\b[^>]*[\/]?>/g,SM=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,EM=/<(?:\w:)?pageMargins[^>]*\/>/g,E_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,_M=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kM=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function TM(e,t,r,a,n,l,o){if(!e)return e;a||(a={"!id":{}});var f=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",m="",p=e.match(vM);p?(x=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):x=m=e;var v=x.match(E_);v?Hg(v[0],f,n,r):(v=x.match(_M))&&CM(v[0],v[1]||"",f,n,r);var y=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var b=x.slice(y,y+50).match(bM);b&&pM(f,b[1])}var S=x.match(kM);S&&S[1]&&zM(S[1],n);var E=[];if(t.cellStyles){var _=x.match(wM);_&&LM(E,_)}p&&VM(p[1],f,t,d,l,o);var N=m.match(SM);N&&(f["!autofilter"]=PM(N[0]));var k=[],R=m.match(gM);if(R)for(y=0;y!=R.length;++y)k[y]=Nt(R[y].slice(R[y].indexOf('"')+1));var A=m.match(yM);A&&FM(f,A,a);var D=m.match(EM);if(D&&(f["!margins"]=OM(st(D[0]))),!f["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(f["!ref"]=ct(d)),t.sheetRows>0&&f["!ref"]){var T=Nt(f["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>d.e.r&&(T.e.r=d.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>d.e.c&&(T.e.c=d.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),f["!fullref"]=f["!ref"],f["!ref"]=ct(T))}return E.length>0&&(f["!cols"]=E),k.length>0&&(f["!merges"]=k),f}function NM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ct(e[r])+'"/>';return t+"</mergeCells>"}function Hg(e,t,r,a){var n=st(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Tt(Vt(n.codeName)))}function CM(e,t,r,a,n){Hg(e.slice(0,e.indexOf(">")),r,a,n)}function AM(e,t,r,a,n){var l=!1,o={},f=null;if(a.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}l=!0,o.codeName=ns(Bt(d))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),f=(f||"")+Ie("outlinePr",null,x)}!l&&!f||(n[n.length]=Ie("sheetPr",f,o))}var jM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],RM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function DM(e){var t={sheet:1};return jM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),RM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Mg(e.password).toString(16).toUpperCase()),Ie("sheetProtection",null,t)}function FM(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var l=st(Vt(t[n]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Tt(l.location))):(l.Target="#"+Tt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=Nt(l.ref),d=f.s.r;d<=f.e.r;++d)for(var x=f.s.c;x<=f.e.c;++x){var m=at({c:x,r:d});a?(e[d]||(e[d]=[]),e[d][x]||(e[d][x]={t:"z",v:void 0}),e[d][x].l=l):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=l)}}}function OM(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function MM(e){return Tl(e),Ie("pageMargins",null,e)}function LM(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=st(t[a],!0);n.hidden&&(n.hidden=tr(n.hidden));var l=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Lg(n.width)),Fi(n);l<=o;)e[l++]=ar(n)}}function BM(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Ie("col",null,eh(n,a)));return r[r.length]="</cols>",r.join("")}function PM(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function IM(e,t,r,a){var n=typeof e.ref=="string"?e.ref:ct(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Ma(n);o.s.r==o.e.r&&(o.e.r=Ma(t["!ref"]).e.r,n=ct(o));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Ie("autoFilter",null,{ref:n})}var UM=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function zM(e,t){t.Views||(t.Views=[{}]),(e.match(UM)||[]).forEach(function(r,a){var n=st(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),tr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function HM(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,n),{})}function GM(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=zs[e.v];break;case"d":a&&a.cellDates?n=rr(e.v,-1).toISOString():(e=ar(e),e.t="n",n=""+(e.v=Pr(rr(e.v)))),typeof e.z>"u"&&(e.z=rt[14]);break;default:n=e.v;break}var f=ea("v",Bt(n)),d={r:t},x=Ii(a.cellXfs,e,a);switch(x!==0&&(d.s=x),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){f=ea("v",""+zg(a.Strings,e.v,a.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Ie("f",Bt(e.f),m)+(e.v!=null?f:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Ie("c",f,d)}var VM=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,l=I0("v"),o=I0("f");return function(d,x,m,p,v,y){for(var b=0,S="",E=[],_=[],N=0,k=0,R=0,A="",D,T,O=0,F=0,q,X,U=0,ee=0,oe=Array.isArray(y.CellXf),ce,Z=[],ie=[],ke=Array.isArray(x),re=[],z={},te=!1,B=!!m.sheetStubs,I=d.split(t),M=0,W=I.length;M!=W;++M){S=I[M].trim();var ne=S.length;if(ne!==0){var ye=0;e:for(b=0;b<ne;++b)switch(S[b]){case">":if(S[b-1]!="/"){++b;break e}if(m&&m.cellStyles){if(T=st(S.slice(ye,b),!0),O=T.r!=null?parseInt(T.r,10):O+1,F=-1,m.sheetRows&&m.sheetRows<O)continue;z={},te=!1,T.ht&&(te=!0,z.hpt=parseFloat(T.ht),z.hpx=Zo(z.hpt)),T.hidden=="1"&&(te=!0,z.hidden=!0),T.outlineLevel!=null&&(te=!0,z.level=+T.outlineLevel),te&&(re[O-1]=z)}break;case"<":ye=b;break}if(ye>=b)break;if(T=st(S.slice(ye,b),!0),O=T.r!=null?parseInt(T.r,10):O+1,F=-1,!(m.sheetRows&&m.sheetRows<O)){p.s.r>O-1&&(p.s.r=O-1),p.e.r<O-1&&(p.e.r=O-1),m&&m.cellStyles&&(z={},te=!1,T.ht&&(te=!0,z.hpt=parseFloat(T.ht),z.hpx=Zo(z.hpt)),T.hidden=="1"&&(te=!0,z.hidden=!0),T.outlineLevel!=null&&(te=!0,z.level=+T.outlineLevel),te&&(re[O-1]=z)),E=S.slice(b).split(e);for(var be=0;be!=E.length&&E[be].trim().charAt(0)=="<";++be);for(E=E.slice(be),b=0;b!=E.length;++b)if(S=E[b].trim(),S.length!==0){if(_=S.match(r),N=b,k=0,R=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,_!=null&&_.length===2){for(N=0,A=_[1],k=0;k!=A.length&&!((R=A.charCodeAt(k)-64)<1||R>26);++k)N=26*N+R;--N,F=N}else++F;for(k=0;k!=S.length&&S.charCodeAt(k)!==62;++k);if(++k,T=st(S.slice(0,k),!0),T.r||(T.r=at({r:O-1,c:F})),A=S.slice(k),D={t:""},(_=A.match(l))!=null&&_[1]!==""&&(D.v=Tt(_[1])),m.cellFormula){if((_=A.match(o))!=null&&_[1]!==""){if(D.f=Tt(Vt(_[1])).replace(/\r\n/g,`
`),m.xlfn||(D.f=Dw(D.f)),_[0].indexOf('t="array"')>-1)D.F=(A.match(n)||[])[1],D.F.indexOf(":")>-1&&Z.push([Nt(D.F),D.F]);else if(_[0].indexOf('t="shared"')>-1){X=st(_[0]);var Se=Tt(Vt(_[1]));m.xlfn||(Se=Dw(Se)),ie[parseInt(X.si,10)]=[X,Se,T.r]}}else(_=A.match(/<f[^>]*\/>/))&&(X=st(_[0]),ie[X.si]&&(D.f=UO(ie[X.si][1],ie[X.si][2],T.r)));var Ne=cr(T.r);for(k=0;k<Z.length;++k)Ne.r>=Z[k][0].s.r&&Ne.r<=Z[k][0].e.r&&Ne.c>=Z[k][0].s.c&&Ne.c<=Z[k][0].e.c&&(D.F=Z[k][1])}if(T.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(B)D.t="z";else continue;else D.t=T.t||"n";switch(p.s.c>F&&(p.s.c=F),p.e.c<F&&(p.e.c=F),D.t){case"n":if(D.v==""||D.v==null){if(!B)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!B)continue;D.t="z"}else q=k0[parseInt(D.v,10)],D.v=q.t,D.r=q.r,m.cellHTML&&(D.h=q.h);break;case"str":D.t="s",D.v=D.v!=null?Vt(D.v):"",m.cellHTML&&(D.h=bg(D.v));break;case"inlineStr":_=A.match(a),D.t="s",_!=null&&(q=Og(_[1]))?(D.v=q.t,m.cellHTML&&(D.h=q.h)):D.v="";break;case"b":D.v=tr(D.v);break;case"d":m.cellDates?D.v=rr(D.v,1):(D.v=Pr(rr(D.v,1)),D.t="n");break;case"e":(!m||m.cellText!==!1)&&(D.w=D.v),D.v=kE[D.v];break}if(U=ee=0,ce=null,oe&&T.s!==void 0&&(ce=y.CellXf[T.s],ce!=null&&(ce.numFmtId!=null&&(U=ce.numFmtId),m.cellStyles&&ce.fillId!=null&&(ee=ce.fillId))),S_(D,U,ee,m,v,y),m.cellDates&&oe&&D.t=="n"&&lc(rt[U])&&(D.t="d",D.v=Kd(D.v)),T.cm&&m.xlmeta){var Xe=(m.xlmeta.Cell||[])[+T.cm-1];Xe&&Xe.type=="XLDAPR"&&(D.D=!0)}if(ke){var V=cr(T.r);x[V.r]||(x[V.r]=[]),x[V.r][V.c]=D}else x[T.r]=D}}}}re.length>0&&(x["!rows"]=re)}}();function qM(e,t,r,a){var n=[],l=[],o=Nt(e["!ref"]),f="",d,x="",m=[],p=0,v=0,y=e["!rows"],b=Array.isArray(e),S={r:x},E,_=-1;for(v=o.s.c;v<=o.e.c;++v)m[v]=or(v);for(p=o.s.r;p<=o.e.r;++p){for(l=[],x=wr(p),v=o.s.c;v<=o.e.c;++v){d=m[v]+x;var N=b?(e[p]||[])[v]:e[d];N!==void 0&&(f=GM(N,d,e,t))!=null&&l.push(f)}(l.length>0||y&&y[p])&&(S={r:x},y&&y[p]&&(E=y[p],E.hidden&&(S.hidden=1),_=-1,E.hpx?_=W0(E.hpx):E.hpt&&(_=E.hpt),_>-1&&(S.ht=_,S.customHeight=1),E.level&&(S.outlineLevel=E.level)),n[n.length]=Ie("row",l.join(""),S))}if(y)for(;p<y.length;++p)y&&y[p]&&(S={r:p+1},E=y[p],E.hidden&&(S.hidden=1),_=-1,E.hpx?_=W0(E.hpx):E.hpt&&(_=E.hpt),_>-1&&(S.ht=_,S.customHeight=1),E.level&&(S.outlineLevel=E.level),n[n.length]=Ie("row","",S));return n.join("")}function __(e,t,r,a){var n=[Er,Ie("worksheet",null,{xmlns:Ll[0],"xmlns:r":Br.r})],l=r.SheetNames[e],o=0,f="",d=r.Sheets[l];d==null&&(d={});var x=d["!ref"]||"A1",m=Nt(x);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),x=ct(m)}a||(a={}),d["!comments"]=[];var p=[];AM(d,r,e,t,n),n[n.length]=Ie("dimension",null,{ref:x}),n[n.length]=HM(d,t,e,r),t.sheetFormat&&(n[n.length]=Ie("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=BM(d,d["!cols"])),n[o=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(f=qM(d,t),f.length>0&&(n[n.length]=f)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),d["!protect"]&&(n[n.length]=DM(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=IM(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=NM(d["!merges"]));var v=-1,y,b=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(S){S[1].Target&&(y={ref:S[0]},S[1].Target.charAt(0)!="#"&&(b=Lt(a,-1,Bt(S[1].Target).replace(/#.*$/,""),gt.HLINK),y["r:id"]="rId"+b),(v=S[1].Target.indexOf("#"))>-1&&(y.location=Bt(S[1].Target.slice(v+1))),S[1].Tooltip&&(y.tooltip=Bt(S[1].Tooltip)),n[n.length]=Ie("hyperlink",null,y))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=MM(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ea("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:x}))),p.length>0&&(b=Lt(a,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),n[n.length]=Ie("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=p),d["!comments"].length>0&&(b=Lt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),n[n.length]=Ie("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function WM(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=n/20),r}function XM(e,t,r){var a=_e(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;n.hpx?l=W0(n.hpx)*20:n.hpt&&(l=n.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var f=0,d=a.l;a.l+=4;for(var x={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var p=-1,v=-1,y=m<<10;y<m+1<<10;++y){x.c=y;var b=Array.isArray(r)?(r[x.r]||[])[x.c]:r[at(x)];b&&(p<0&&(p=y),v=y)}p<0||(++f,a.write_shift(4,p),a.write_shift(4,v))}var S=a.l;return a.l=d,a.write_shift(4,f),a.l=S,a.length>a.l?a.slice(0,a.l):a}function YM(e,t,r,a){var n=XM(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&je(e,0,n)}var $M=Ul,KM=uc;function QM(){}function ZM(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=t8(e),r}function JM(e,t,r){r==null&&(r=_e(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Td({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),bE(e,r),r.slice(0,r.l)}function e9(e){var t=bn(e);return[t]}function t9(e,t,r){return r==null&&(r=_e(8)),Bl(t,r)}function r9(e){var t=Pl(e);return[t]}function a9(e,t,r){return r==null&&(r=_e(4)),Il(t,r)}function n9(e){var t=bn(e),r=e.read_shift(1);return[t,r,"b"]}function s9(e,t,r){return r==null&&(r=_e(9)),Bl(t,r),r.write_shift(1,e.v?1:0),r}function i9(e){var t=Pl(e),r=e.read_shift(1);return[t,r,"b"]}function l9(e,t,r){return r==null&&(r=_e(5)),Il(t,r),r.write_shift(1,e.v?1:0),r}function o9(e){var t=bn(e),r=e.read_shift(1);return[t,r,"e"]}function c9(e,t,r){return r==null&&(r=_e(9)),Bl(t,r),r.write_shift(1,e.v),r}function u9(e){var t=Pl(e),r=e.read_shift(1);return[t,r,"e"]}function f9(e,t,r){return r==null&&(r=_e(8)),Il(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function d9(e){var t=bn(e),r=e.read_shift(4);return[t,r,"s"]}function h9(e,t,r){return r==null&&(r=_e(12)),Bl(t,r),r.write_shift(4,t.v),r}function x9(e){var t=Pl(e),r=e.read_shift(4);return[t,r,"s"]}function m9(e,t,r){return r==null&&(r=_e(8)),Il(t,r),r.write_shift(4,t.v),r}function p9(e){var t=bn(e),r=ca(e);return[t,r,"n"]}function g9(e,t,r){return r==null&&(r=_e(16)),Bl(t,r),Dl(e.v,r),r}function k_(e){var t=Pl(e),r=ca(e);return[t,r,"n"]}function v9(e,t,r){return r==null&&(r=_e(12)),Il(t,r),Dl(e.v,r),r}function y9(e){var t=bn(e),r=Ag(e);return[t,r,"n"]}function b9(e,t,r){return r==null&&(r=_e(12)),Bl(t,r),wE(e.v,r),r}function w9(e){var t=Pl(e),r=Ag(e);return[t,r,"n"]}function S9(e,t,r){return r==null&&(r=_e(8)),Il(t,r),wE(e.v,r),r}function E9(e){var t=bn(e),r=Tg(e);return[t,r,"is"]}function _9(e){var t=bn(e),r=ua(e);return[t,r,"str"]}function k9(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),Bl(t,r),Wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function T9(e){var t=Pl(e),r=ua(e);return[t,r,"str"]}function N9(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),Il(t,r),Wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function C9(e,t,r){var a=e.l+t,n=bn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"b"];if(r.cellFormula){e.l+=2;var f=Jd(e,a-e.l,r);o[3]=ia(f,null,n,r.supbooks,r)}else e.l=a;return o}function A9(e,t,r){var a=e.l+t,n=bn(e);n.r=r["!row"];var l=e.read_shift(1),o=[n,l,"e"];if(r.cellFormula){e.l+=2;var f=Jd(e,a-e.l,r);o[3]=ia(f,null,n,r.supbooks,r)}else e.l=a;return o}function j9(e,t,r){var a=e.l+t,n=bn(e);n.r=r["!row"];var l=ca(e),o=[n,l,"n"];if(r.cellFormula){e.l+=2;var f=Jd(e,a-e.l,r);o[3]=ia(f,null,n,r.supbooks,r)}else e.l=a;return o}function R9(e,t,r){var a=e.l+t,n=bn(e);n.r=r["!row"];var l=ua(e),o=[n,l,"str"];if(r.cellFormula){e.l+=2;var f=Jd(e,a-e.l,r);o[3]=ia(f,null,n,r.supbooks,r)}else e.l=a;return o}var D9=Ul,F9=uc;function O9(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function M9(e,t){var r=e.l+t,a=Ul(e),n=Ng(e),l=ua(e),o=ua(e),f=ua(e);e.l=r;var d={rfx:a,relId:n,loc:l,display:f};return o&&(d.Tooltip=o),d}function L9(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));uc({s:cr(e[0]),e:cr(e[0])},r),Cg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Wr(n||"",r),Wr(e[1].Tooltip||"",r),Wr("",r),r.slice(0,r.l)}function B9(){}function P9(e,t,r){var a=e.l+t,n=SE(e),l=e.read_shift(1),o=[n];if(o[2]=l,r.cellFormula){var f=oM(e,a-e.l,r);o[1]=f}else e.l=a;return o}function I9(e,t,r){var a=e.l+t,n=Ul(e),l=[n];if(r.cellFormula){var o=uM(e,a-e.l,r);l[1]=o,e.l=a}else e.l=a;return l}function U9(e,t,r){r==null&&(r=_e(18));var a=eh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var T_=["left","right","top","bottom","header","footer"];function z9(e){var t={};return T_.forEach(function(r){t[r]=ca(e)}),t}function H9(e,t){return t==null&&(t=_e(6*8)),Tl(e),T_.forEach(function(r){Dl(e[r],t)}),t}function G9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function V9(e,t,r){r==null&&(r=_e(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function q9(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),uc(e,t),t}function W9(e,t){return t==null&&(t=_e(16*4+2)),t.write_shift(2,e.password?Mg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function X9(){}function Y9(){}function $9(e,t,r,a,n,l,o){if(!e)return e;var f=t||{};a||(a={"!id":{}});var d=f.dense?[]:{},x,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,v=!1,y,b,S,E,_,N,k,R,A,D=[];f.biff=12,f["!row"]=0;var T=0,O=!1,F=[],q={},X=f.supbooks||n.supbooks||[[]];if(X.sharedf=q,X.arrayf=F,X.SheetNames=n.SheetNames||n.Sheets.map(function(ke){return ke.name}),!f.supbooks&&(f.supbooks=X,n.Names))for(var U=0;U<n.Names.length;++U)X[0][U+1]=n.Names[U];var ee=[],oe=[],ce=!1;X0[16]={n:"BrtShortReal",f:k_};var Z;if(Us(e,function(re,z,te){if(!v)switch(te){case 148:x=re;break;case 0:y=re,f.sheetRows&&f.sheetRows<=y.r&&(v=!0),R=wr(E=y.r),f["!row"]=y.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=Zo(re.hpt)),oe[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:re[2]},re[2]){case"n":b.v=re[1];break;case"s":k=k0[re[1]],b.v=k.t,b.r=k.r;break;case"b":b.v=!!re[1];break;case"e":b.v=re[1],f.cellText!==!1&&(b.w=zs[b.v]);break;case"str":b.t="s",b.v=re[1];break;case"is":b.t="s",b.v=re[1].t;break}if((S=o.CellXf[re[0].iStyleRef])&&S_(b,S.numFmtId,null,f,l,o),_=re[0].c==-1?_+1:re[0].c,f.dense?(d[E]||(d[E]=[]),d[E][_]=b):d[or(_)+R]=b,f.cellFormula){for(O=!1,T=0;T<F.length;++T){var B=F[T];y.r>=B[0].s.r&&y.r<=B[0].e.r&&_>=B[0].s.c&&_<=B[0].e.c&&(b.F=ct(B[0]),O=!0)}!O&&re.length>3&&(b.f=re[3])}if(m.s.r>y.r&&(m.s.r=y.r),m.s.c>_&&(m.s.c=_),m.e.r<y.r&&(m.e.r=y.r),m.e.c<_&&(m.e.c=_),f.cellDates&&S&&b.t=="n"&&lc(rt[S.numFmtId])){var I=cl(b.v);I&&(b.t="d",b.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}Z&&(Z.type=="XLDAPR"&&(b.D=!0),Z=void 0);break;case 1:case 12:if(!f.sheetStubs||p)break;b={t:"z",v:void 0},_=re[0].c==-1?_+1:re[0].c,f.dense?(d[E]||(d[E]=[]),d[E][_]=b):d[or(_)+R]=b,m.s.r>y.r&&(m.s.r=y.r),m.s.c>_&&(m.s.c=_),m.e.r<y.r&&(m.e.r=y.r),m.e.c<_&&(m.e.c=_),Z&&(Z.type=="XLDAPR"&&(b.D=!0),Z=void 0);break;case 176:D.push(re);break;case 49:Z=((f.xlmeta||{}).Cell||[])[re-1];break;case 494:var M=a["!id"][re.relId];for(M?(re.Target=M.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=M):re.relId==""&&(re.Target="#"+re.loc),E=re.rfx.s.r;E<=re.rfx.e.r;++E)for(_=re.rfx.s.c;_<=re.rfx.e.c;++_)f.dense?(d[E]||(d[E]=[]),d[E][_]||(d[E][_]={t:"z",v:void 0}),d[E][_].l=re):(N=at({c:_,r:E}),d[N]||(d[N]={t:"z",v:void 0}),d[N].l=re);break;case 426:if(!f.cellFormula)break;F.push(re),A=f.dense?d[E][_]:d[or(_)+R],A.f=ia(re[1],m,{r:y.r,c:_},X,f),A.F=ct(re[0]);break;case 427:if(!f.cellFormula)break;q[at(re[0].s)]=re[1],A=f.dense?d[E][_]:d[or(_)+R],A.f=ia(re[1],m,{r:y.r,c:_},X,f);break;case 60:if(!f.cellStyles)break;for(;re.e>=re.s;)ee[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},ce||(ce=!0,Lg(re.w/256)),Fi(ee[re.e+1]);break;case 161:d["!autofilter"]={ref:ct(re)};break;case 476:d["!margins"]=re;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),re.name&&(n.Sheets[r].CodeName=re.name),(re.above||re.left)&&(d["!outline"]={above:re.above,left:re.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),re.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!z.T){if(!p||f.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},f),delete f.supbooks,delete f["!row"],!d["!ref"]&&(m.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(d["!ref"]=ct(x||m)),f.sheetRows&&d["!ref"]){var ie=Nt(d["!ref"]);f.sheetRows<=+ie.e.r&&(ie.e.r=f.sheetRows-1,ie.e.r>m.e.r&&(ie.e.r=m.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>m.e.c&&(ie.e.c=m.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),d["!fullref"]=d["!ref"],d["!ref"]=ct(ie))}return D.length>0&&(d["!merges"]=D),ee.length>0&&(d["!cols"]=ee),oe.length>0&&(d["!rows"]=oe),d}function K9(e,t,r,a,n,l,o){if(t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=ar(t),t.z=t.z||rt[14],t.v=Pr(rr(t.v)),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}var d={r,c:a};switch(d.s=Ii(n.cellXfs,t,n),t.l&&l["!links"].push([at(d),t.l]),t.c&&l["!comments"].push([at(d),t.c]),t.t){case"s":case"str":return n.bookSST?(f=zg(n.Strings,t.v,n.revStrings),d.t="s",d.v=f,o?je(e,18,m9(t,d)):je(e,7,h9(t,d))):(d.t="str",o?je(e,17,N9(t,d)):je(e,6,k9(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?je(e,13,S9(t,d)):je(e,2,b9(t,d)):o?je(e,16,v9(t,d)):je(e,5,g9(t,d)),!0;case"b":return d.t="b",o?je(e,15,l9(t,d)):je(e,4,s9(t,d)),!0;case"e":return d.t="e",o?je(e,14,f9(t,d)):je(e,3,c9(t,d)),!0}return o?je(e,12,a9(t,d)):je(e,1,t9(t,d)),!0}function Q9(e,t,r,a){var n=Nt(t["!ref"]||"A1"),l,o="",f=[];je(e,145);var d=Array.isArray(t),x=n.e.r;t["!rows"]&&(x=Math.max(n.e.r,t["!rows"].length-1));for(var m=n.s.r;m<=x;++m){o=wr(m),YM(e,t,n,m);var p=!1;if(m<=n.e.r)for(var v=n.s.c;v<=n.e.c;++v){m===n.s.r&&(f[v]=or(v)),l=f[v]+o;var y=d?(t[m]||[])[v]:t[l];if(!y){p=!1;continue}p=K9(e,y,m,v,a,t,p)}}je(e,146)}function Z9(e,t){!t||!t["!merges"]||(je(e,177,O9(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,F9(r))}),je(e,178))}function J9(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,a){r&&je(e,60,U9(a,r))}),je(e,391))}function eL(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,q9(Nt(t["!ref"]))),je(e,650))}function tL(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Lt(r,-1,a[1].Target.replace(/#.*$/,""),gt.HLINK);je(e,494,L9(a,n))}}),delete t["!links"]}function rL(e,t,r,a){if(t["!comments"].length>0){var n=Lt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);je(e,551,Cg("rId"+n)),t["!legacy"]=n}}function aL(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],l=typeof n.ref=="string"?n.ref:ct(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,f=Ma(l);f.s.r==f.e.r&&(f.e.r=Ma(t["!ref"]).e.r,l=ct(f));for(var d=0;d<o.length;++d){var x=o[d];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==a){x.Ref="'"+r.SheetNames[a]+"'!"+l;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+l}),je(e,161,uc(Nt(l))),je(e,162)}}function nL(e,t,r){je(e,133),je(e,137,V9(t,r)),je(e,138),je(e,134)}function sL(e,t){t["!protect"]&&je(e,535,W9(t["!protect"]))}function iL(e,t,r,a){var n=Oa(),l=r.SheetNames[e],o=r.Sheets[l]||{},f=l;try{r&&r.Workbook&&(f=r.Workbook.Sheets[e].CodeName||f)}catch{}var d=Nt(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],je(n,129),(r.vbaraw||o["!outline"])&&je(n,147,JM(f,o["!outline"])),je(n,148,KM(d)),nL(n,o,r.Workbook),J9(n,o),Q9(n,o,e,t),sL(n,o),aL(n,o,r,e),Z9(n,o),tL(n,o,a),o["!margins"]&&je(n,476,H9(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&eL(n,o),rL(n,o,e,a),je(n,130),n.end()}function lL(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Tt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){a=l.replace(/<.*?>/g,"")}),[t,n,a]}function oL(e,t,r,a,n,l){var o=l||{"!type":"chart"};if(!e)return l;var f=0,d=0,x="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var v=lL(p);m.s.r=m.s.c=0,m.e.c=f,x=or(f),v[0].forEach(function(y,b){o[x+wr(b)]={t:"n",v:y,z:v[1]},d=b}),m.e.r<d&&(m.e.r=d),++f}),f>0&&(o["!ref"]=ct(m)),o}function cL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,f=e.match(E_);return f&&Hg(f[0],l,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}function uL(e,t){e.l+=10;var r=ua(e);return{name:r}}function fL(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Us(e,function(d,x,m){switch(m){case 550:l["!rel"]=d;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),d.name&&(n.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),a["!id"][l["!rel"]]&&(l["!drawel"]=a["!id"][l["!rel"]]),l}var Gg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],hL=[],xL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bw(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var l=t[n];if(a[l[0]]==null)a[l[0]]=l[1];else switch(l[2]){case"bool":typeof a[l[0]]=="string"&&(a[l[0]]=tr(a[l[0]]));break;case"int":typeof a[l[0]]=="string"&&(a[l[0]]=parseInt(a[l[0]],10));break}}}function Pw(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=tr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function N_(e){Pw(e.WBProps,Gg),Pw(e.CalcPr,xL),Bw(e.WBView,dL),Bw(e.Sheets,hL),Lo.date1904=tr(e.WBProps.date1904)}function mL(e){return!e.Workbook||!e.Workbook.WBProps?"false":tr(e.Workbook.WBProps.date1904)?"true":"false"}var pL="][*?/\\".split("");function C_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return pL.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function gL(e,t,r){e.forEach(function(a,n){C_(a);for(var l=0;l<n;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function vL(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];gL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)mM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var yL=/<\w+:workbook/;function bL(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",l={},o=0;if(e.replace(da,function(d,x){var m=st(d);switch(is(m[0])){case"<?xml":break;case"<workbook":d.match(yL)&&(n="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=m[n];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Gg.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=tr(m[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:r.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(r.WBProps.CodeName=Vt(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Tt(Vt(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":l={},l.Name=Vt(m.name),m.comment&&(l.Comment=m.comment),m.localSheetId&&(l.Sheet=+m.localSheetId),tr(m.hidden||"0")&&(l.Hidden=!0),o=x+d.length;break;case"</definedName>":l.Ref=Tt(Vt(e.slice(o,x))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),Ll.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return N_(r),r}function A_(e){var t=[Er];t[t.length]=Ie("workbook",null,{xmlns:Ll[0],"xmlns:r":Br.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Gg.forEach(function(f){e.Workbook.WBProps[f[0]]!=null&&e.Workbook.WBProps[f[0]]!=f[1]&&(a[f[0]]=e.Workbook.WBProps[f[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ie("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],l=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!n[l]||!n[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:Bt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),n[l])switch(n[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Ie("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(f){var d={name:f.Name};f.Comment&&(d.comment=f.Comment),f.Sheet!=null&&(d.localSheetId=""+f.Sheet),f.Hidden&&(d.hidden="1"),f.Ref&&(t[t.length]=Ie("definedName",Bt(f.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function wL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=jp(e),r.name=ua(e),r}function SL(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Cg(e.strRelID,t),Wr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function EL(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?ua(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function _L(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),bE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function kL(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function TL(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),l=r8(e),o=cM(e,0,r),f=Ng(e);e.l=a;var d={Name:l,Ptg:o};return n<268435455&&(d.Sheet=n),f&&(d.Comment=f),d}function NL(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],X0[16]={n:"BrtFRTArchID$",f:kL},Us(e,function(d,x,m){switch(m){case 156:o.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=ia(d.Ptg,null,null,o,t),delete t.SID,delete d.Ptg,l.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,d]):o[0]=[m,d],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(d),o.XTI=o.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(m),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(m),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!x.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),N_(r),r.Names=l,r.supbooks=o,r}function CL(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,SL(n))}je(e,144)}function AL(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Wr("SheetJS",t),Wr(yd.version,t),Wr(yd.version,t),Wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function jL(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function RL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,l=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&l==-1&&(l=a);l>n||(je(e,135),je(e,158,jL(n)),je(e,136))}}function DL(e,t){var r=Oa();return je(r,131),je(r,128,AL()),je(r,153,_L(e.Workbook&&e.Workbook.WBProps||null)),RL(r,e),CL(r,e),je(r,132),r.end()}function FL(e,t,r){return t.slice(-4)===".bin"?NL(e,r):bL(e,r)}function OL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?$9(e,a,r,n,l,o,f):TM(e,a,r,n,l,o,f)}function ML(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?fL(e,a,r,n,l):cL(e,a,r,n,l)}function LL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?PO():IO()}function BL(e,t,r,a,n,l,o,f){return t.slice(-4)===".bin"?LO():BO()}function PL(e,t,r,a){return t.slice(-4)===".bin"?FF(e,r,a):wF(e,r,a)}function IL(e,t,r){return c_(e,r)}function UL(e,t,r){return t.slice(-4)===".bin"?UD(e,r):BD(e,r)}function zL(e,t,r){return t.slice(-4)===".bin"?RO(e,r):SO(e,r)}function HL(e,t,r){return t.slice(-4)===".bin"?yO(e):gO(e)}function GL(e,t,r,a){return r.slice(-4)===".bin"?bO(e,t,r,a):void 0}function VL(e,t,r){return t.slice(-4)===".bin"?xO(e,t,r):pO(e,t,r)}function qL(e,t,r){return(t.slice(-4)===".bin"?DL:A_)(e)}function WL(e,t,r,a,n){return(t.slice(-4)===".bin"?iL:__)(e,r,a,n)}function XL(e,t,r){return(t.slice(-4)===".bin"?GF:l_)(e,r)}function YL(e,t,r){return(t.slice(-4)===".bin"?GD:JE)(e,r)}function $L(e,t,r){return(t.slice(-4)===".bin"?DO:d_)(e)}function KL(e){return(e.slice(-4)===".bin"?mO:u_)()}var j_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,R_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(j_),l,o,f,d;if(n)for(d=0;d!=n.length;++d)l=n[d].match(R_),(o=l[1].indexOf(":"))===-1?a[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(o+1),a[f]=l[2].slice(1,l[2].length-1));return a}function QL(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(j_),n,l,o,f;if(a)for(f=0;f!=a.length;++f)n=a[f].match(R_),(l=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(l+1),r[o]=n[2].slice(1,n[2].length-1));return r}var N0;function ZL(e,t){var r=N0[e]||Tt(e);return r==="General"?jl(t):gn(r,t)}function JL(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=tr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=rr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Tt(t)]=n}function eB(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v):e.w=jl(e.v):e.w=ZL(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var a=N0[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&lc(a)){var n=cl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(l){if(r.WTF)throw l}}}function tB(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=hF[a.Pattern]||a.Pattern)}e[t.ID]=t}function rB(e,t,r,a,n,l,o,f,d,x){var m="General",p=a.StyleID,v={};x=x||{};var y=[],b=0;for(p===void 0&&f&&(p=f.StyleID),p===void 0&&o&&(p=o.StyleID);l[p]!==void 0&&(l[p].nf&&(m=l[p].nf),l[p].Interior&&y.push(l[p].Interior),!!l[p].Parent);)p=l[p].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=tr(e);break;case"String":a.t="s",a.r=tw(Tt(e)),a.v=e.indexOf("<")>-1?Tt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Tt(e):a.v<60&&(a.v=a.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=kE[e],x.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=tw(t||e));break}if(eB(a,m,x),x.cellFormula!==!1)if(a.Formula){var S=Tt(a.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),a.f=Mo(S,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Mo("RC:RC",n):a.ArrayRange&&(a.F=Mo(a.ArrayRange,n),d.push([Nt(a.F),a.F]))}else for(b=0;b<d.length;++b)n.r>=d[b][0].s.r&&n.r<=d[b][0].e.r&&n.c>=d[b][0].s.c&&n.c<=d[b][0].e.c&&(a.F=d[b][1]);x.cellStyles&&(y.forEach(function(E){!v.patternType&&E.patternType&&(v.patternType=E.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function aB(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qm(e,t){var r=t||{};oc();var a=v0(wg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Vt(a));var n=a.slice(0,1024).toLowerCase(),l=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=ar(r);return o.type="string",Qo.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ct){n.indexOf("<"+Ct)>=0&&(l=!0)}),l)return HB(a,r);N0={"General Number":"General","General Date":rt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rt[15],"Short Date":rt[14],"Long Time":rt[19],"Medium Time":rt[18],"Short Time":rt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rt[2],Standard:rt[4],Percent:rt[10],Scientific:rt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,d=[],x,m={},p=[],v=r.dense?[]:{},y="",b={},S={},E=Nn('<Data ss:Type="String">'),_=0,N=0,k=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},D={},T="",O=0,F=[],q={},X={},U=0,ee=[],oe=[],ce={},Z=[],ie,ke=!1,re=[],z=[],te={},B=0,I=0,M={Sheets:[],WBProps:{date1904:!1}},W={};z0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";f=z0.exec(a);)switch(f[3]=(ne=f[3]).toLowerCase()){case"data":if(ne=="data"){if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break}if(d[d.length-1][1])break;f[1]==="/"?rB(a.slice(_,f.index),T,E,d[d.length-1][0]=="comment"?ce:b,{c:N,r:k},A,Z[N],S,re,r):(T="",E=Nn(f[0]),_=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(oe.length>0&&(b.c=oe),(!r.sheetRows||r.sheetRows>k)&&b.v!==void 0&&(r.dense?(v[k]||(v[k]=[]),v[k][N]=b):v[or(N)+wr(k)]=b),b.HRef&&(b.l={Target:Tt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(B=N+(parseInt(b.MergeAcross,10)|0),I=k+(parseInt(b.MergeDown,10)|0),F.push({s:{c:N,r:k},e:{c:B,r:I}})),!r.sheetStubs)b.MergeAcross?N=B+1:++N;else if(b.MergeAcross||b.MergeDown){for(var ye=N;ye<=B;++ye)for(var be=k;be<=I;++be)(ye>N||be>k)&&(r.dense?(v[be]||(v[be]=[]),v[be][ye]={t:"z"}):v[or(ye)+wr(be)]={t:"z"});N=B+1}else++N;else b=QL(f[0]),b.Index&&(N=+b.Index-1),N<R.s.c&&(R.s.c=N),N>R.e.c&&(R.e.c=N),f[0].slice(-2)==="/>"&&++N,oe=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(k<R.s.r&&(R.s.r=k),k>R.e.r&&(R.e.r=k),f[0].slice(-2)==="/>"&&(S=Nn(f[0]),S.Index&&(k=+S.Index-1)),N=0,++k):(S=Nn(f[0]),S.Index&&(k=+S.Index-1),te={},(S.AutoFitHeight=="0"||S.Height)&&(te.hpx=parseInt(S.Height,10),te.hpt=W0(te.hpx),z[k]=te),S.Hidden=="1"&&(te.hidden=!0,z[k]=te));break;case"worksheet":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"));p.push(y),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(v["!ref"]=ct(R),r.sheetRows&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=ct(R))),F.length&&(v["!merges"]=F),Z.length>0&&(v["!cols"]=Z),z.length>0&&(v["!rows"]=z),m[y]=v}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=N=0,d.push([f[3],!1]),x=Nn(f[0]),y=Tt(x.Name),v=r.dense?[]:{},F=[],re=[],z=[],W={name:y,Hidden:0},M.Sheets.push(W);break;case"table":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else{if(f[0].slice(-2)=="/>")break;d.push([f[3],!1]),Z=[],ke=!1}break;case"style":f[1]==="/"?tB(A,D,r):D=Nn(f[0]);break;case"numberformat":D.nf=Tt(Nn(f[0]).Format||"General"),N0[D.nf]&&(D.nf=N0[D.nf]);for(var Se=0;Se!=392&&rt[Se]!=D.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(rt[Se]==null){Fs(D.nf,Se);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ie=Nn(f[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!ke&&ie.wpx>10){ke=!0,la=s_;for(var Ne=0;Ne<Z.length;++Ne)Z[Ne]&&Fi(Z[Ne])}ke&&Fi(ie),Z[ie.Index-1||Z.length]=ie;for(var Xe=0;Xe<+ie.Span;++Xe)Z[Z.length]=ar(ie);break;case"namedrange":if(f[1]==="/")break;M.Names||(M.Names=[]);var V=st(f[0]),We={Name:V.Name,Ref:Mo(V.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(We.Sheet=M.Sheets.length-1),M.Names.push(We);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?T+=a.slice(O,f.index):O=f.index+f[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=Nn(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?N8(q,ne,a.slice(U,f.index)):U=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else d.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"));aB(ce),oe.push(ce)}else d.push([f[3],!1]),x=Nn(f[0]),ce={a:x.Author};break;case"autofilter":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var $e=Nn(f[0]);v["!autofilter"]={ref:Mo($e.Range).replace(/\$/g,"")},d.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((x=d.pop())[0]!==f[3])throw new Error("Bad state: "+x.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"null":break;default:if(d.length==0&&f[3]=="document"||d.length==0&&f[3]=="uof")return Gw(a,r);var dt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(f[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(a.slice(U,f.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else U=f.index+f[0].length;break;case"header":v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+st(f[0]).Margin)||(v["!margins"].header=+st(f[0]).Margin);break;case"footer":v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+st(f[0]).Margin)||(v["!margins"].footer=+st(f[0]).Margin);break;case"pagemargins":var Je=st(f[0]);v["!margins"]||Tl(v["!margins"]={},"xlml"),isNaN(+Je.Top)||(v["!margins"].top=+Je.Top),isNaN(+Je.Left)||(v["!margins"].left=+Je.Left),isNaN(+Je.Right)||(v["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(v["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||f[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?JL(X,ne,ee,a.slice(U,f.index)):(ee=f,U=f.index+f[0].length);break}if(r.WTF)throw"Unrecognized tag: "+f[3]+"|"+d.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=m),Oe.SheetNames=p,Oe.Workbook=M,Oe.SSF=ar(rt),Oe.Props=q,Oe.Custprops=X,Oe}function Bp(e,t){switch(qg(t=t||{}),t.type||"base64"){case"base64":return qm($a(e),t);case"binary":case"buffer":case"file":return qm(e,t);case"array":return qm(Bi(e),t)}}function nB(e,t){var r=[];return e.Props&&r.push(C8(e.Props,t)),e.Custprops&&r.push(A8(e.Props,e.Custprops)),r.join("")}function sB(){return""}function iB(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var l=[];l.push(Ie("NumberFormat",null,{"ss:Format":Bt(rt[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Ie("Style",l.join(""),o))}),Ie("Styles",r.join(""))}function D_(e){return Ie("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ig(e.Ref,{r:0,c:0})})}function lB(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(D_(n)))}return Ie("Names",r.join(""))}function oB(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,l=[],o=0;o<n.length;++o){var f=n[o];f.Sheet==r&&(f.Name.match(/^_xlfn\./)||l.push(D_(f)))}return l.join("")}function cB(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ie("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ie("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ie("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Ie("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ea("ProtectContents","True")),e["!protect"].objects&&n.push(ea("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ea("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ea("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ea("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Ie("WorksheetOptions",n.join(""),{xmlns:Va.x})}function uB(e){return e.map(function(t){var r=Rj(t.t||""),a=Ie("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",a,{"ss:Author":t.a})}).join("")}function fB(e,t,r,a,n,l,o){if(!e||e.v==null&&e.f==null)return"";var f={};if(e.f&&(f["ss:Formula"]="="+Bt(Ig(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=cr(e.F.slice(t.length+1));f["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(f["ss:HRef"]=Bt(e.l.Target),e.l.Tooltip&&(f["x:HRefScreenTip"]=Bt(e.l.Tooltip))),r["!merges"])for(var x=r["!merges"],m=0;m!=x.length;++m)x[m].s.c!=o.c||x[m].s.r!=o.r||(x[m].e.c>x[m].s.c&&(f["ss:MergeAcross"]=x[m].e.c-x[m].s.c),x[m].e.r>x[m].s.r&&(f["ss:MergeDown"]=x[m].e.r-x[m].s.r));var p="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":p="Number",v=String(e.v);break;case"b":p="Boolean",v=e.v?"1":"0";break;case"e":p="Error",v=zs[e.v];break;case"d":p="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||rt[14]);break;case"s":p="String",v=jj(e.v||"");break}var y=Ii(a.cellXfs,e,a);f["ss:StyleID"]="s"+(21+y),f["ss:Index"]=o.c+1;var b=e.v!=null?v:"",S=e.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(e.c||[]).length>0&&(S+=uB(e.c)),Ie("Cell",S,f)}function dB(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Zo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function hB(e,t,r,a){if(!e["!ref"])return"";var n=Nt(e["!ref"]),l=e["!merges"]||[],o=0,f=[];e["!cols"]&&e["!cols"].forEach(function(E,_){Fi(E);var N=!!E.width,k=eh(_,E),R={"ss:Index":_+1};N&&(R["ss:Width"]=V0(k.width)),E.hidden&&(R["ss:Hidden"]="1"),f.push(Ie("Column",null,R))});for(var d=Array.isArray(e),x=n.s.r;x<=n.e.r;++x){for(var m=[dB(x,(e["!rows"]||[])[x])],p=n.s.c;p<=n.e.c;++p){var v=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>p)&&!(l[o].s.r>x)&&!(l[o].e.c<p)&&!(l[o].e.r<x)){(l[o].s.c!=p||l[o].s.r!=x)&&(v=!0);break}if(!v){var y={r:x,c:p},b=at(y),S=d?(e[x]||[])[p]:e[b];m.push(fB(S,b,e,t,r,a,y))}}m.push("</Row>"),m.length>2&&f.push(m.join(""))}return f.join("")}function xB(e,t,r){var a=[],n=r.SheetNames[e],l=r.Sheets[n],o=l?oB(l,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?hB(l,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(cB(l,t,e,r)),a.join("")}function mB(e,t){t||(t={}),e.SSF||(e.SSF=ar(rt)),e.SSF&&(oc(),Xd(e.SSF),t.revssf=$d(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ii(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(nB(e,t)),r.push(sB()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ie("Worksheet",xB(a,t,e),{"ss:Name":Bt(e.SheetNames[a])}));return r[2]=iB(e,t),r[3]=lB(e),Er+Ie("Workbook",r.join(""),{xmlns:Va.ss,"xmlns:o":Va.o,"xmlns:x":Va.x,"xmlns:ss":Va.ss,"xmlns:dt":Va.dt,"xmlns:html":Va.html})}function pB(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=l8(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=o8(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var gB=[60,1084,2066,2165,2175];function vB(e,t,r,a,n){var l=a,o=[],f=r.slice(r.l,r.l+l);if(n&&n.enc&&n.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(f)}o.push(f),r.l+=l;for(var d=js(r,r.l),x=Pp[d],m=0;x!=null&&gB.indexOf(d)>-1;)l=js(r,r.l+2),m=r.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),f=r.slice(m,r.l+4+l),o.push(f),r.l+=4+l,x=Pp[d=js(r,r.l)];var p=qr(o);Jr(p,0);var v=0;p.lens=[];for(var y=0;y<o.length;++y)p.lens.push(v),v+=o[y].length;if(p.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+a;return t.f(p,p.length,n)}function Kn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=rt[a])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v):e.w=jl(e.v):e.w=gn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&a&&e.t=="n"&&lc(rt[a]||String(a))){var n=cl(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Xf(e,t,r){return{v:e,ixfe:t,t:r}}function yB(e,t){var r={opts:{}},a={},n=t.dense?[]:{},l={},o={},f=null,d=[],x="",m={},p,v="",y,b,S,E,_={},N=[],k,R,A=[],D=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},F=function(Re){return Re<8?El[Re]:Re<64&&D[Re-8]||El[Re]},q=function(Re,xe,Be){var He=xe.XF.data;if(!(!He||!He.patternType||!Be||!Be.cellStyles)){xe.s={},xe.s.patternType=He.patternType;var Kt;(Kt=G0(F(He.icvFore)))&&(xe.s.fgColor={rgb:Kt}),(Kt=G0(F(He.icvBack)))&&(xe.s.bgColor={rgb:Kt})}},X=function(Re,xe,Be){if(!(te>1)&&!(Be.sheetRows&&Re.r>=Be.sheetRows)){if(Be.cellStyles&&xe.XF&&xe.XF.data&&q(Re,xe,Be),delete xe.ixfe,delete xe.XF,p=Re,v=at(Re),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<o.s.r&&(o.s.r=Re.r),Re.c<o.s.c&&(o.s.c=Re.c),Re.r+1>o.e.r&&(o.e.r=Re.r+1),Re.c+1>o.e.c&&(o.e.c=Re.c+1),Be.cellFormula&&xe.f){for(var He=0;He<N.length;++He)if(!(N[He][0].s.c>Re.c||N[He][0].s.r>Re.r)&&!(N[He][0].e.c<Re.c||N[He][0].e.r<Re.r)){xe.F=ct(N[He][0]),(N[He][0].s.c!=Re.c||N[He][0].s.r!=Re.r)&&delete xe.f,xe.f&&(xe.f=""+ia(N[He][1],o,Re,re,U));break}}Be.dense?(n[Re.r]||(n[Re.r]=[]),n[Re.r][Re.c]=xe):n[v]=xe}},U={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var ee,oe=[],ce=[],Z=[],ie=[],ke=!1,re=[];re.SheetNames=U.snames,re.sharedf=U.sharedf,re.arrayf=U.arrayf,re.names=[],re.XTI=[];var z=0,te=0,B=0,I=[],M=[],W;U.codepage=1200,Fn(1200);for(var ne=!1;e.l<e.length-1;){var ye=e.l,be=e.read_shift(2);if(be===0&&z===10)break;var Se=e.l===e.length?0:e.read_shift(2),Ne=Pp[be];if(Ne&&Ne.f){if(t.bookSheets&&z===133&&be!==133)break;if(z=be,Ne.r===2||Ne.r==12){var Xe=e.read_shift(2);if(Se-=2,!U.enc&&Xe!==be&&((Xe&255)<<8|Xe>>8)!==be)throw new Error("rt mismatch: "+Xe+"!="+be);Ne.r==12&&(e.l+=10,Se-=10)}var V={};if(be===10?V=Ne.f(e,Se,U):V=vB(be,Ne,e,Se,U),te==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(be){case 34:r.opts.Date1904=T.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=V,!t.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=V;break;case 66:var We=Number(V);switch(We){case 21010:We=1200;break;case 32768:We=1e4;break;case 32769:We=1252;break}Fn(U.codepage=We),ne=!0;break;case 317:U.rrtabid=V;break;case 25:U.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:U.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(n["!type"]="dialog"),V.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),V.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:A.push(V);break;case 430:re.push([V]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(V);break;case 24:case 536:W={Name:V.Name,Ref:ia(V.rgce,o,null,re,U)},V.itab>0&&(W.Sheet=V.itab-1),re.names.push(W),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(M[V.itab-1]={ref:ct(V.rgce[0][0][1][2])});break;case 22:U.ExternCount=V;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(V),re.XTI=re.XTI.concat(V);break;case 2196:if(U.biff<8)break;W!=null&&(W.Comment=V[1]);break;case 18:n["!protect"]=V;break;case 19:V!==0&&U.WTF&&console.error("Password verifier: "+V);break;case 133:l[V.pos]=V,U.snames.push(V.name);break;case 10:{if(--te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=ct(o),t.sheetRows&&t.sheetRows<=o.e.r){var $e=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ct(o),o.e.r=$e}o.e.r++,o.e.c++}oe.length>0&&(n["!merges"]=oe),ce.length>0&&(n["!objects"]=ce),Z.length>0&&(n["!cols"]=Z),ie.length>0&&(n["!rows"]=ie),T.Sheets.push(O)}x===""?m=n:a[x]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),U.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(U.biff=5,ne=!0,Fn(U.codepage=28591)),U.biff==8&&V.BIFFVer==0&&V.dt==16&&(U.biff=2),te++)break;if(n=t.dense?[]:{},U.biff<8&&!ne&&(ne=!0,Fn(U.codepage=t.codepage||1252)),U.biff<5||V.BIFFVer==0&&V.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:e.l-Se,name:x};l[dt.pos]=dt,U.snames.push(x)}else x=(l[ye]||{name:""}).name;V.dt==32&&(n["!type"]="chart"),V.dt==64&&(n["!type"]="macro"),oe=[],ce=[],U.arrayf=N=[],Z=[],ie=[],ke=!1,O={Hidden:(l[ye]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[V.r]||[])[V.c]:n[at({c:V.c,r:V.r})])&&++V.c,k={ixfe:V.ixfe,XF:A[V.ixfe]||{},v:V.val,t:"n"},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t);break;case 5:case 517:k={ixfe:V.ixfe,XF:A[V.ixfe],v:V.val,t:V.t},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t);break;case 638:k={ixfe:V.ixfe,XF:A[V.ixfe],v:V.rknum,t:"n"},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t);break;case 189:for(var Je=V.c;Je<=V.C;++Je){var Oe=V.rkrec[Je-V.c][0];k={ixfe:Oe,XF:A[Oe],v:V.rkrec[Je-V.c][1],t:"n"},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:Je,r:V.r},k,t)}break;case 6:case 518:case 1030:{if(V.val=="String"){f=V;break}if(k=Xf(V.val,V.cell.ixfe,V.tt),k.XF=A[k.ixfe],t.cellFormula){var Ct=V.formula;if(Ct&&Ct[0]&&Ct[0][0]&&Ct[0][0][0]=="PtgExp"){var Pt=Ct[0][0][1][0],Rr=Ct[0][0][1][1],St=at({r:Pt,c:Rr});_[St]?k.f=""+ia(V.formula,o,V.cell,re,U):k.F=((t.dense?(n[Pt]||[])[Rr]:n[St])||{}).F}else k.f=""+ia(V.formula,o,V.cell,re,U)}B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X(V.cell,k,t),f=V}break;case 7:case 519:if(f)f.val=V,k=Xf(V,f.cell.ixfe,"s"),k.XF=A[k.ixfe],t.cellFormula&&(k.f=""+ia(f.formula,o,f.cell,re,U)),B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X(f.cell,k,t),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(V);var wn=at(V[0].s);if(y=t.dense?(n[V[0].s.r]||[])[V[0].s.c]:n[wn],t.cellFormula&&y){if(!f||!wn||!y)break;y.f=""+ia(V[1],o,V[0],re,U),y.F=ct(V[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!f)break;_[at(f.cell)]=V[0],y=t.dense?(n[f.cell.r]||[])[f.cell.c]:n[at(f.cell)],(y||{}).f=""+ia(V[0],o,p,re,U)}}break;case 253:k=Xf(d[V.isst].t,V.ixfe,"s"),d[V.isst].h&&(k.h=d[V.isst].h),k.XF=A[k.ixfe],B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t);break;case 513:t.sheetStubs&&(k={ixfe:V.ixfe,XF:A[V.ixfe],t:"z"},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t));break;case 190:if(t.sheetStubs)for(var ha=V.c;ha<=V.C;++ha){var ur=V.ixfe[ha-V.c];k={ixfe:ur,XF:A[ur],t:"z"},B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:ha,r:V.r},k,t)}break;case 214:case 516:case 4:k=Xf(V.val,V.ixfe,"s"),k.XF=A[k.ixfe],B>0&&(k.z=I[k.ixfe>>8&63]),Kn(k,t,r.opts.Date1904),X({c:V.c,r:V.r},k,t);break;case 0:case 512:te===1&&(o=V);break;case 252:d=V;break;case 1054:if(U.biff==4){I[B++]=V[1];for(var qt=0;qt<B+163&&rt[qt]!=V[1];++qt);qt>=163&&Fs(V[1],B+163)}else Fs(V[1],V[0]);break;case 30:{I[B++]=V;for(var _r=0;_r<B+163&&rt[_r]!=V;++_r);_r>=163&&Fs(V,B+163)}break;case 229:oe=oe.concat(V);break;case 93:ce[V.cmo[0]]=U.lastobj=V;break;case 438:U.lastobj.TxO=V;break;case 127:U.lastobj.ImData=V;break;case 440:for(E=V[0].s.r;E<=V[0].e.r;++E)for(S=V[0].s.c;S<=V[0].e.c;++S)y=t.dense?(n[E]||[])[S]:n[at({c:S,r:E})],y&&(y.l=V[1]);break;case 2048:for(E=V[0].s.r;E<=V[0].e.r;++E)for(S=V[0].s.c;S<=V[0].e.c;++S)y=t.dense?(n[E]||[])[S]:n[at({c:S,r:E})],y&&y.l&&(y.l.Tooltip=V[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;y=t.dense?(n[V[0].r]||[])[V[0].c]:n[at(V[0])];var ir=ce[V[2]];y||(t.dense?(n[V[0].r]||(n[V[0].r]=[]),y=n[V[0].r][V[0].c]={t:"z"}):y=n[at(V[0])]={t:"z"},o.e.r=Math.max(o.e.r,V[0].r),o.s.r=Math.min(o.s.r,V[0].r),o.e.c=Math.max(o.e.c,V[0].c),o.s.c=Math.min(o.s.c,V[0].c)),y.c||(y.c=[]),b={a:V[1],t:ir.TxO.t},y.c.push(b)}break;case 2173:iO(A[V.ixfe],V.ext);break;case 125:{if(!U.cellStyles)break;for(;V.e>=V.s;)Z[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},ke||(ke=!0,Lg(V.w/256)),Fi(Z[V.e+1])}break;case 520:{var Et={};V.level!=null&&(ie[V.r]=Et,Et.level=V.level),V.hidden&&(ie[V.r]=Et,Et.hidden=!0),V.hpt&&(ie[V.r]=Et,Et.hpt=V.hpt,Et.hpx=Zo(V.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Tl(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=V;break;case 161:n["!margins"]||Tl(n["!margins"]={}),n["!margins"].header=V.header,n["!margins"].footer=V.footer;break;case 574:V.RTL&&(T.Views[0].RTL=!0);break;case 146:D=V;break;case 2198:ee=V;break;case 140:R=V;break;case 442:x?O.CodeName=V||O.name:T.WBProps.CodeName=V||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+be.toString(16)),e.l+=Se}return r.SheetNames=pr(l).sort(function(De,Re){return Number(De)-Number(Re)}).map(function(De){return l[De].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&M.forEach(function(De,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=De}),r.Strings=d,r.SSF=ar(rt),U.enc&&(r.Encryption=U.enc),ee&&(r.Themes=ee),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),re.names.length>0&&(T.Names=re.names),r.Workbook=T,r}var C0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bB(e,t,r){var a=Ke.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=yw(a,Rp,C0.DSI);for(var l in n)t[l]=n[l]}catch(x){if(r.WTF)throw x}var o=Ke.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var f=yw(o,Dp,C0.SI);for(var d in f)t[d]==null&&(t[d]=f[d])}catch(x){if(r.WTF)throw x}t.HeadingPairs&&t.TitlesOfParts&&(RE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function wB(e,t){var r=[],a=[],n=[],l=0,o,f=$b(Rp,"n"),d=$b(Dp,"n");if(e.Props)for(o=pr(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(d,o[l])?a:n).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=pr(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(f,o[l])?r:Object.prototype.hasOwnProperty.call(d,o[l])?a:n).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<n.length;++l)PE.indexOf(n[l][0])>-1||jE.indexOf(n[l][0])>-1||n[l][1]!=null&&x.push(n[l]);a.length&&Ke.utils.cfb_add(t,"/SummaryInformation",bw(a,C0.SI,d,Dp)),(r.length||x.length)&&Ke.utils.cfb_add(t,"/DocumentSummaryInformation",bw(r,C0.DSI,f,Rp,x.length?x:null,C0.UDI))}function F_(e,t){t||(t={}),qg(t),dg(),t.codepage&&fg(t.codepage);var r,a;if(e.FullPaths){if(Ke.find(e,"/encryption"))throw new Error("File is password-protected");r=Ke.find(e,"!CompObj"),a=Ke.find(e,"/Workbook")||Ke.find(e,"/Book")}else{switch(t.type){case"base64":e=Wa($a(e));break;case"binary":e=Wa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jr(e,0),a={content:e}}var n,l;if(r&&pB(r),t.bookProps&&!t.bookSheets)n={};else{var o=mt?"buffer":"array";if(a&&a.content)n=yB(a.content,t);else if((l=Ke.find(e,"PerfectOffice_MAIN"))&&l.content)n=kl.to_workbook(l.content,(t.type=o,t));else if((l=Ke.find(e,"NativeContent_MAIN"))&&l.content)n=kl.to_workbook(l.content,(t.type=o,t));else throw(l=Ke.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ke.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=OO(e))}var f={};return e.FullPaths&&bB(e,f,t),n.Props=n.Custprops=f,t.bookFiles&&(n.cfb=e),n}function SB(e,t){var r=t||{},a=Ke.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ke.utils.cfb_add(a,n,O_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&wB(e,a),r.biff==8&&e.vbaraw&&MO(a,Ke.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var X0={0:{f:WM},1:{f:e9},2:{f:y9},3:{f:o9},4:{f:n9},5:{f:p9},6:{f:_9},7:{f:d9},8:{f:R9},9:{f:j9},10:{f:C9},11:{f:A9},12:{f:r9},13:{f:w9},14:{f:u9},15:{f:i9},16:{f:k_},17:{f:T9},18:{f:x9},19:{f:Tg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:TL},40:{},42:{},43:{f:_F},44:{f:SF},45:{f:NF},46:{f:AF},47:{f:CF},48:{},49:{f:$j},50:{},51:{f:cO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$E},62:{f:E9},63:{f:vO},64:{f:X9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:fa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:G9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZM},148:{f:$M,p:16},151:{f:B9},152:{},153:{f:EL},154:{},155:{},156:{f:wL},157:{},158:{},159:{T:1,f:ID},160:{T:-1},161:{T:1,f:Ul},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:D9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lO},336:{T:-1},337:{f:dO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:P9},427:{f:I9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:z9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QM},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:M9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AO},633:{T:1},634:{T:-1},635:{T:1,f:NO},636:{T:-1},637:{f:Jj},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Y9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pp={6:{f:Gm},10:{f:hi},12:{f:jr},13:{f:jr},14:{f:br},15:{f:br},16:{f:ca},17:{f:br},18:{f:br},19:{f:jr},20:{f:Tw},21:{f:Tw},23:{f:YE},24:{f:Cw},25:{f:br},26:{},27:{},28:{f:YR},29:{},34:{f:br},35:{f:Nw},38:{f:ca},39:{f:ca},40:{f:ca},41:{f:ca},42:{f:br},43:{f:br},47:{f:iF},49:{f:wR},51:{f:jr},60:{},61:{f:pR},64:{f:br},65:{f:bR},66:{f:jr},77:{},80:{},81:{},82:{},85:{f:jr},89:{},90:{},91:{},92:{f:sR},93:{f:QR},94:{},95:{f:br},96:{},97:{},99:{f:br},125:{f:$E},128:{f:LR},129:{f:lR},130:{f:jr},131:{f:br},132:{f:br},133:{f:oR},134:{},140:{f:sD},141:{f:jr},144:{},146:{f:oD},151:{},152:{},153:{},154:{},155:{},156:{f:jr},157:{},158:{},160:{f:mD},161:{f:fD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DR},190:{f:FR},193:{f:hi},197:{},198:{},199:{},200:{},201:{},202:{f:br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:jr},220:{},221:{f:br},222:{},224:{f:MR},225:{f:nR},226:{f:hi},227:{},229:{f:$R},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:uR},253:{f:ER},255:{f:dR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:IE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:br},353:{f:hi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zR},431:{f:br},432:{},433:{},434:{},437:{},438:{f:eD},439:{f:br},440:{f:tD},441:{},442:{f:xu},443:{},444:{f:jr},445:{},446:{},448:{f:hi},449:{f:mR,r:2},450:{f:hi},512:{f:Ew},513:{f:xD},515:{f:IR},516:{f:kR},517:{f:kw},519:{f:pD},520:{f:hR},523:{},545:{f:Aw},549:{f:Sw},566:{},574:{f:vR},638:{f:RR},659:{},1048:{},1054:{f:NR},1084:{},1212:{f:qR},2048:{f:aD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Vf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:hi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:cD,r:12},2173:{f:sO,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:VR,r:12},2197:{},2198:{f:JF,r:12},2199:{},2200:{},2201:{},2202:{f:WR,r:12},2203:{f:hi},2204:{},2205:{},2206:{},2207:{},2211:{f:xR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dD},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:lD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ew},1:{},2:{f:wD},3:{f:yD},4:{f:vD},5:{f:kw},7:{f:ED},8:{},9:{f:Vf},11:{},22:{f:jr},30:{f:AR},31:{},32:{},33:{f:Aw},36:{},37:{f:Sw},50:{f:_D},62:{},52:{},67:{},68:{f:jr},69:{},86:{},126:{},127:{f:gD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kD},223:{},234:{},354:{},421:{},518:{f:Gm},521:{f:Vf},536:{f:Cw},547:{f:Nw},561:{},579:{},1030:{f:Gm},1033:{f:Vf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,t,r,a){var n=t;if(!isNaN(n)){var l=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,l),l>0&&Eg(r)&&e.push(r)}}function EB(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Ue(e,t,r,n);var l=t;if(!isNaN(l)){for(var o=r.parts||[],f=0,d=0,x=0;x+(o[f]||8224)<=8224;)x+=o[f]||8224,f++;var m=e.next(4);for(m.write_shift(2,l),m.write_shift(2,x),e.push(r.slice(d,d+x)),d+=x;d<n;){for(m=e.next(4),m.write_shift(2,60),x=0;x+(o[f]||8224)<=8224;)x+=o[f]||8224,f++;m.write_shift(2,x),e.push(r.slice(d,d+x)),d+=x}}}function vu(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function _B(e,t,r,a){var n=_e(9);return vu(n,e,t),UE(r,a||"b",n),n}function kB(e,t,r){var a=_e(8+2*r.length);return vu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function TB(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Pr(rr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Ue(e,2,SD(r,a,n)):Ue(e,3,bD(r,a,n));return;case"b":case"e":Ue(e,5,_B(r,a,t.v,t.t));return;case"s":case"str":Ue(e,4,kB(r,a,(t.v||"").slice(0,255)));return}Ue(e,1,vu(null,r,a))}function NB(e,t,r,a){var n=Array.isArray(t),l=Nt(t["!ref"]||"A1"),o,f="",d=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=ct(l)}for(var x=l.s.r;x<=l.e.r;++x){f=wr(x);for(var m=l.s.c;m<=l.e.c;++m){x===l.s.r&&(d[m]=or(m)),o=d[m]+f;var p=n?(t[x]||[])[m]:t[o];p&&TB(e,p,x,m)}}}function CB(e,t){for(var r=t||{},a=Oa(),n=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(n=l);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(a,r.biff==4?1033:r.biff==3?521:9,Fg(e,16,r)),NB(a,e.Sheets[e.SheetNames[n]],n,r),Ue(a,10),a.end()}function AB(e,t,r){Ue(e,49,SR({sz:12,name:"Arial"},r))}function jB(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Ue(e,1054,CR(n,t[n],r))})}function RB(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),qE(Nt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ue(e,2152,r)}function DB(e,t){for(var r=0;r<16;++r)Ue(e,224,_w({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Ue(e,224,_w(a,0,t))})}function FB(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Ue(e,440,rD(a)),a[1].Tooltip&&Ue(e,2048,nD(a))}delete t["!links"]}function OB(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Ue(e,125,uD(eh(n,a),n))})}}function MB(e,t,r,a,n){var l=16+Ii(n.cellXfs,t,n);if(t.v==null&&!t.bf){Ue(e,513,Ol(r,a,l));return}if(t.bf)Ue(e,6,lM(t,r,a,n,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Pr(rr(t.v)):t.v;Ue(e,515,UR(r,a,o,l));break;case"b":case"e":Ue(e,517,PR(r,a,t.v,l,n,t.t));break;case"s":case"str":if(n.bookSST){var f=zg(n.Strings,t.v,n.revStrings);Ue(e,253,_R(r,a,f,l))}else Ue(e,516,TR(r,a,(t.v||"").slice(0,255),l,n));break;default:Ue(e,513,Ol(r,a,l))}}function LB(e,t,r){var a=Oa(),n=r.SheetNames[e],l=r.Sheets[n]||{},o=(r||{}).Workbook||{},f=(o.Sheets||[])[e]||{},d=Array.isArray(l),x=t.biff==8,m,p="",v=[],y=Nt(l["!ref"]||"A1"),b=x?65536:16384;if(y.e.c>255||y.e.r>=b){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,b-1)}Ue(a,2057,Fg(r,16,t)),Ue(a,13,xn(1)),Ue(a,12,xn(100)),Ue(a,15,ba(!0)),Ue(a,17,ba(!1)),Ue(a,16,Dl(.001)),Ue(a,95,ba(!0)),Ue(a,42,ba(!1)),Ue(a,43,ba(!1)),Ue(a,130,xn(1)),Ue(a,128,BR()),Ue(a,131,ba(!1)),Ue(a,132,ba(!1)),x&&OB(a,l["!cols"]),Ue(a,512,jR(y,t)),x&&(l["!links"]=[]);for(var S=y.s.r;S<=y.e.r;++S){p=wr(S);for(var E=y.s.c;E<=y.e.c;++E){S===y.s.r&&(v[E]=or(E)),m=v[E]+p;var _=d?(l[S]||[])[E]:l[m];_&&(MB(a,_,S,E,t),x&&_.l&&l["!links"].push([m,_.l]))}}var N=f.CodeName||f.name||n;return x&&Ue(a,574,yR((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Ue(a,229,KR(l["!merges"])),x&&FB(a,l),Ue(a,442,zE(N)),x&&RB(a,l),Ue(a,10),a.end()}function BB(e,t,r){var a=Oa(),n=(e||{}).Workbook||{},l=n.Sheets||[],o=n.WBProps||{},f=r.biff==8,d=r.biff==5;if(Ue(a,2057,Fg(e,5,r)),r.bookType=="xla"&&Ue(a,135),Ue(a,225,f?xn(1200):null),Ue(a,193,P8(2)),d&&Ue(a,191),d&&Ue(a,192),Ue(a,226),Ue(a,92,iR("SheetJS",r)),Ue(a,66,xn(f?1200:1252)),f&&Ue(a,353,xn(0)),f&&Ue(a,448),Ue(a,317,hD(e.SheetNames.length)),f&&e.vbaraw&&Ue(a,211),f&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Ue(a,442,zE(x))}Ue(a,156,xn(17)),Ue(a,25,ba(!1)),Ue(a,18,ba(!1)),Ue(a,19,xn(0)),f&&Ue(a,431,ba(!1)),f&&Ue(a,444,xn(0)),Ue(a,61,gR()),Ue(a,64,ba(!1)),Ue(a,141,xn(0)),Ue(a,34,ba(mL(e)=="true")),Ue(a,14,ba(!0)),f&&Ue(a,439,ba(!1)),Ue(a,218,xn(0)),AB(a,e,r),jB(a,e.SSF,r),DB(a,r),f&&Ue(a,352,ba(!1));var m=a.end(),p=Oa();f&&Ue(p,140,iD()),f&&r.Strings&&EB(p,252,fR(r.Strings)),Ue(p,10);var v=p.end(),y=Oa(),b=0,S=0;for(S=0;S<e.SheetNames.length;++S)b+=(f?12:11)+(f?2:1)*e.SheetNames[S].length;var E=m.length+b+v.length;for(S=0;S<e.SheetNames.length;++S){var _=l[S]||{};Ue(y,133,cR({pos:E,hs:_.Hidden||0,dt:0,name:e.SheetNames[S]},r)),E+=t[S].length}var N=y.end();if(b!=N.length)throw new Error("BS8 "+b+" != "+N.length);var k=[];return m.length&&k.push(m),N.length&&k.push(N),v.length&&k.push(v),qr(k)}function PB(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=ar(rt)),e&&e.SSF&&(oc(),Xd(e.SSF),r.revssf=$d(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Wg(r),r.cellXfs=[],Ii(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=LB(n,r,e);return a.unshift(BB(e,a,r)),qr(a)}function O_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ma(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return PB(e,t);case 4:case 3:case 2:return CB(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Iw(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=n.index,f=l&&l.index||e.length,d=Sj(e.slice(o,f),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,m=0,p=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<d.length;++o){var S=d[o].trim(),E=S.slice(0,3).toLowerCase();if(E=="<tr"){if(++x,r.sheetRows&&r.sheetRows<=x){--x;break}m=0;continue}if(!(E!="<td"&&E!="<th")){var _=S.split(/<\/t[dh]>/i);for(f=0;f<_.length;++f){var N=_[f].trim();if(N.match(/<t[dh]/i)){for(var k=N,R=0;k.charAt(0)=="<"&&(R=k.indexOf(">"))>-1;)k=k.slice(R+1);for(var A=0;A<b.length;++A){var D=b[A];D.s.c==m&&D.s.r<x&&x<=D.e.r&&(m=D.e.c+1,A=-1)}var T=st(N.slice(0,N.indexOf(">")));v=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||v>1)&&b.push({s:{r:x,c:m},e:{r:x+(p||1)-1,c:m+v-1}});var O=T.t||T["data-t"]||"";if(!k.length){m+=v;continue}if(k=nE(k),y.s.r>x&&(y.s.r=x),y.e.r<x&&(y.e.r=x),y.s.c>m&&(y.s.c=m),y.e.c<m&&(y.e.c=m),!k.length){m+=v;continue}var F={t:"s",v:k};r.raw||!k.trim().length||O=="s"||(k==="TRUE"?F={t:"b",v:!0}:k==="FALSE"?F={t:"b",v:!1}:isNaN(Mn(k))?isNaN(Ko(k).getDate())||(F={t:"d",v:rr(k)},r.cellDates||(F={t:"n",v:Pr(F.v)}),F.z=r.dateNF||rt[14]):F={t:"n",v:Mn(k)}),r.dense?(a[x]||(a[x]=[]),a[x][m]=F):a[at({r:x,c:m})]=F,m+=v}}}}return a["!ref"]=ct(y),b.length&&(a["!merges"]=b),a}function IB(e,t,r,a){for(var n=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var f=0,d=0,x=0;x<n.length;++x)if(!(n[x].s.r>r||n[x].s.c>o)&&!(n[x].e.r<r||n[x].e.c<o)){if(n[x].s.r<r||n[x].s.c<o){f=-1;break}f=n[x].e.r-n[x].s.r+1,d=n[x].e.c-n[x].s.c+1;break}if(!(f<0)){var m=at({r,c:o}),p=a.dense?(e[r]||[])[o]:e[m],v=p&&p.v!=null&&(p.h||bg(p.w||(Bs(p),p.w)||""))||"",y={};f>1&&(y.rowspan=f),d>1&&(y.colspan=d),a.editable?v='<span contenteditable="true">'+v+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+p.l.Target+'">'+v+"</a>")),y.id=(a.id||"sjs")+"-"+m,l.push(Ie("td",v,y))}}var b="<tr>";return b+l.join("")+"</tr>"}var UB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zB="</body></html>";function HB(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Pi(Iw(r[0],t),t);var a=$g();return r.forEach(function(n,l){Kg(a,Iw(n,t),"Sheet"+(l+1))}),a}function GB(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function M_(e,t){var r=t||{},a=r.header!=null?r.header:UB,n=r.footer!=null?r.footer:zB,l=[a],o=Ma(e["!ref"]);r.dense=Array.isArray(e),l.push(GB(e,o,r));for(var f=o.s.r;f<=o.e.r;++f)l.push(IB(e,o,f,r));return l.push("</table>"+n),l.join("")}function L_(e,t,r){var a=r||{},n=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?cr(a.origin):a.origin;n=o.r,l=o.c}var f=t.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,f.length),x={s:{r:0,c:0},e:{r:n,c:l}};if(e["!ref"]){var m=Ma(e["!ref"]);x.s.r=Math.min(x.s.r,m.s.r),x.s.c=Math.min(x.s.c,m.s.c),x.e.r=Math.max(x.e.r,m.e.r),x.e.c=Math.max(x.e.c,m.e.c),n==-1&&(x.e.r=n=m.e.r+1)}var p=[],v=0,y=e["!rows"]||(e["!rows"]=[]),b=0,S=0,E=0,_=0,N=0,k=0;for(e["!cols"]||(e["!cols"]=[]);b<f.length&&S<d;++b){var R=f[b];if(Uw(R)){if(a.display)continue;y[S]={hidden:!0}}var A=R.children;for(E=_=0;E<A.length;++E){var D=A[E];if(!(a.display&&Uw(D))){var T=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):nE(D.innerHTML),O=D.getAttribute("data-z")||D.getAttribute("z");for(v=0;v<p.length;++v){var F=p[v];F.s.c==_+l&&F.s.r<S+n&&S+n<=F.e.r&&(_=F.e.c+1-l,v=-1)}k=+D.getAttribute("colspan")||1,((N=+D.getAttribute("rowspan")||1)>1||k>1)&&p.push({s:{r:S+n,c:_+l},e:{r:S+n+(N||1)-1,c:_+l+(k||1)-1}});var q={t:"s",v:T},X=D.getAttribute("data-t")||D.getAttribute("t")||"";T!=null&&(T.length==0?q.t=X||"z":a.raw||T.trim().length==0||X=="s"||(T==="TRUE"?q={t:"b",v:!0}:T==="FALSE"?q={t:"b",v:!1}:isNaN(Mn(T))?isNaN(Ko(T).getDate())||(q={t:"d",v:rr(T)},a.cellDates||(q={t:"n",v:Pr(q.v)}),q.z=a.dateNF||rt[14]):q={t:"n",v:Mn(T)})),q.z===void 0&&O!=null&&(q.z=O);var U="",ee=D.getElementsByTagName("A");if(ee&&ee.length)for(var oe=0;oe<ee.length&&!(ee[oe].hasAttribute("href")&&(U=ee[oe].getAttribute("href"),U.charAt(0)!="#"));++oe);U&&U.charAt(0)!="#"&&(q.l={Target:U}),a.dense?(e[S+n]||(e[S+n]=[]),e[S+n][_+l]=q):e[at({c:_+l,r:S+n})]=q,x.e.c<_+l&&(x.e.c=_+l),_+=k}}++S}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),x.e.r=Math.max(x.e.r,S-1+n),e["!ref"]=ct(x),S>=d&&(e["!fullref"]=ct((x.e.r=f.length-b+S-1+n,x))),e}function B_(e,t){var r=t||{},a=r.dense?[]:{};return L_(a,e,t)}function VB(e,t){return Pi(B_(e,t),t)}function Uw(e){var t="",r=qB(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function qB(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function WB(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Tt(t.replace(/<[^>]*>/g,""));return[r]}var zw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function P_(e,t){var r=t||{},a=wg(e),n=[],l,o,f={name:""},d="",x=0,m,p,v={},y=[],b=r.dense?[]:{},S,E,_={value:""},N="",k=0,R=[],A=-1,D=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,F={},q=[],X={},U=0,ee=0,oe=[],ce=1,Z=1,ie=[],ke={Names:[]},re={},z=["",""],te=[],B={},I="",M=0,W=!1,ne=!1,ye=0;for(z0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=z0.exec(a);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?b["!ref"]=ct(T):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(b["!fullref"]=b["!ref"],T.e.r=r.sheetRows-1,b["!ref"]=ct(T)),q.length&&(b["!merges"]=q),oe.length&&(b["!rows"]=oe),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),y.push(m.name),v[m.name]=b,ne=!1):S[0].charAt(S[0].length-2)!=="/"&&(m=st(S[0],!1),A=D=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,b=r.dense?[]:{},q=[],oe=[],ne=!0);break;case"table-row-group":S[1]==="/"?--O:++O;break;case"table-row":case"":if(S[1]==="/"){A+=ce,ce=1;break}if(p=st(S[0],!1),p.?A=p.-1:A==-1&&(A=0),ce=+p["number-rows-repeated"]||1,ce<10)for(ye=0;ye<ce;++ye)O>0&&(oe[A+ye]={level:O});D=-1;break;case"covered-table-cell":S[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(b[A]||(b[A]=[]),b[A][D]={t:"z"}):b[at({r:A,c:D})]={t:"z"}),N="",R=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++D,_=st(S[0],!1),Z=parseInt(_["number-columns-repeated"]||"1",10),E={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(E.f=Lw(Tt(_.formula))),(_.||_["value-type"])=="string"&&(E.t="s",E.v=Tt(_["string-value"]||""),r.dense?(b[A]||(b[A]=[]),b[A][D]=E):b[at({r:A,c:D})]=E),D+=Z-1;else if(S[1]!=="/"){++D,N="",k=0,R=[],Z=1;var be=ce?A+ce-1:A;if(D>T.e.c&&(T.e.c=D),D<T.s.c&&(T.s.c=D),A<T.s.r&&(T.s.r=A),be>T.e.r&&(T.e.r=be),_=st(S[0],!1),te=[],B={},E={t:_.||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=Tt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(U=parseInt(_["number-matrix-rows-spanned"],10)||0,ee=parseInt(_["number-matrix-columns-spanned"],10)||0,X={s:{r:A,c:D},e:{r:A+U-1,c:D+ee-1}},E.F=ct(X),ie.push([X,E.F])),_.formula)E.f=Lw(_.formula);else for(ye=0;ye<ie.length;++ye)A>=ie[ye][0].s.r&&A<=ie[ye][0].e.r&&D>=ie[ye][0].s.c&&D<=ie[ye][0].e.c&&(E.F=ie[ye][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(U=parseInt(_["number-rows-spanned"],10)||0,ee=parseInt(_["number-columns-spanned"],10)||0,X={s:{r:A,c:D},e:{r:A+U-1,c:D+ee-1}},q.push(X)),_["number-columns-repeated"]&&(Z=parseInt(_["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=tr(_["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(_.value);break;case"percentage":E.t="n",E.v=parseFloat(_.value);break;case"currency":E.t="n",E.v=parseFloat(_.value);break;case"date":E.t="d",E.v=rr(_["date-value"]),r.cellDates||(E.t="n",E.v=Pr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=yj(_["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Kd(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(_.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",_["string-value"]!=null&&(N=Tt(_["string-value"]),R=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(W=!1,E.t==="s"&&(E.v=N||"",R.length&&(E.R=R),W=k==0),re.Target&&(E.l=re),te.length>0&&(E.c=te,te=[]),N&&r.cellText!==!1&&(E.w=N),W&&(E.t="z",delete E.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var Se=0;Se<ce;++Se){if(Z=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(b[A+Se]||(b[A+Se]=[]),b[A+Se][D]=Se==0?E:ar(E);--Z>0;)b[A+Se][D+Z]=ar(E);else for(b[at({r:A+Se,c:D})]=E;--Z>0;)b[at({r:A+Se,c:D+Z})]=ar(E);T.e.c<=D&&(T.e.c=D)}Z=parseInt(_["number-columns-repeated"]||"1",10),D+=Z-1,Z=0,E={},N="",R=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((l=n.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&n.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((l=n.pop())[0]!==S[3])throw"Bad state: "+l;B.t=N,R.length&&(B.R=R),B.a=I,te.push(B)}else S[0].charAt(S[0].length-2)!=="/"&&n.push([S[3],!1]);I="",M=0,N="",k=0,R=[];break;case"creator":S[1]==="/"?I=a.slice(M,S.index):M=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((l=n.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&n.push([S[3],!1]);N="",k=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(F[f.name]=d,(l=n.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&(d="",f=st(S[0],!1),n.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=st(S[0],!1),d+=zw[S[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=st(S[0],!1),d+=zw[S[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":d+=a.slice(x,S.index);break}else x=S.index+S[0].length;break;case"named-range":o=st(S[0],!1),z=Vm(o["cell-range-address"]);var Ne={Name:o.name,Ref:z[0]+"!"+z[1]};ne&&(Ne.Sheet=y.length),ke.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(S[1]==="/"&&(!_||!_["string-value"])){var Xe=WB(a.slice(k,S.index));N=(N.length>0?N+`
`:"")+Xe[0]}else st(S[0],!1),k=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{z=Vm(st(S[0])["target-range-address"]),v[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(re=st(S[0],!1),!re.href)break;re.Target=Tt(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(z=Vm(re.Target.slice(1)),re.Target="#"+z[0]+"!"+z[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(S)}}var V={Sheets:v,SheetNames:y,Workbook:ke};return r.bookSheets&&delete V.Sheets,V}function Hw(e,t){t=t||{},dn(e,"META-INF/manifest.xml")&&y8(Ar(e,"META-INF/manifest.xml"),t);var r=Xa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=P_(Vt(r),t);return dn(e,"meta.xml")&&(a.Props=CE(Ar(e,"meta.xml"))),a}function Gw(e,t){return P_(e,t)}var XB=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+U0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Er+t}}(),Vw=function(){var e=function(l){return Bt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(l,o,f){var d=[];d.push('      <table:table table:name="'+Bt(o.SheetNames[f])+`" table:style-name="ta1">
`);var x=0,m=0,p=Ma(l["!ref"]||"A1"),v=l["!merges"]||[],y=0,b=Array.isArray(l);if(l["!cols"])for(m=0;m<=p.e.c;++m)d.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var S="",E=l["!rows"]||[];for(x=0;x<p.s.r;++x)S=E[x]?' table:style-name="ro'+E[x].ods+'"':"",d.push("        <table:table-row"+S+`></table:table-row>
`);for(;x<=p.e.r;++x){for(S=E[x]?' table:style-name="ro'+E[x].ods+'"':"",d.push("        <table:table-row"+S+`>
`),m=0;m<p.s.c;++m)d.push(t);for(;m<=p.e.c;++m){var _=!1,N={},k="";for(y=0;y!=v.length;++y)if(!(v[y].s.c>m)&&!(v[y].s.r>x)&&!(v[y].e.c<m)&&!(v[y].e.r<x)){(v[y].s.c!=m||v[y].s.r!=x)&&(_=!0),N["table:number-columns-spanned"]=v[y].e.c-v[y].s.c+1,N["table:number-rows-spanned"]=v[y].e.r-v[y].s.r+1;break}if(_){d.push(r);continue}var R=at({r:x,c:m}),A=b?(l[x]||[])[m]:l[R];if(A&&A.f&&(N["table:formula"]=Bt(hM(A.f)),A.F&&A.F.slice(0,R.length)==R)){var D=Ma(A.F);N["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,N["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!A){d.push(t);continue}switch(A.t){case"b":k=A.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=A.v?"true":"false";break;case"n":k=A.w||String(A.v||0),N["office:value-type"]="float",N["office:value"]=A.v||0;break;case"s":case"str":k=A.v==null?"":A.v,N["office:value-type"]="string";break;case"d":k=A.w||rr(A.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=rr(A.v).toISOString(),N["table:style-name"]="ce1";break;default:d.push(t);continue}var T=e(k);if(A.l&&A.l.Target){var O=A.l.Target;O=O.charAt(0)=="#"?"#"+xM(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),T=Ie("text:a",T,{"xlink:href":O.replace(/&/g,"&amp;")})}d.push("          "+Ie("table:table-cell",Ie("text:p",T,{}),N)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var f=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var m=0;m<x["!cols"].length;++m)if(x["!cols"][m]){var p=x["!cols"][m];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Fi(p),p.ods=f;var v=x["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++f}}});var d=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var m=0;m<x["!rows"].length;++m)if(x["!rows"][m]){x["!rows"][m].ods=d;var p=x["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,f){var d=[Er],x=U0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=U0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(d.push("<office:document"+x+m+`>
`),d.push(NE().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+x+`>
`),n(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)d.push(a(o.Sheets[o.SheetNames[p]],o,p));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),f.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function I_(e,t){if(t.bookType=="fods")return Vw(e,t);var r=gg(),a="",n=[],l=[];return a="mimetype",ft(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",ft(r,a,Vw(e,t)),n.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",ft(r,a,XB(e,t)),n.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",ft(r,a,Er+NE()),n.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",ft(r,a,S8(l)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",ft(r,a,b8(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ml(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ip(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Vt(Bi(e))}function YB(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Wa(ns(e))}function $B(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Mi(e){var t=e.reduce(function(n,l){return n+l.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function qw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function KB(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function QB(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;n>=1;++l,n/=256)e[t+l]=n&255;e[t+15]|=r>=0?0:128}function Y0(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Mt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function mr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function jt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Y0(e,r),l=n&7;n=Math.floor(n/8);var o=0,f;if(n==0)break;switch(l){case 0:{for(var d=r[0];e[r[0]++]>=128;);f=e.slice(d,r[0])}break;case 5:o=4,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Y0(e,r),f=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(n," at offset ").concat(a))}var x={data:f,type:l};t[n]==null?t[n]=[x]:t[n].push(x)}return t}function Zr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Mt(a*8+n.type)),n.type==2&&t.push(Mt(n.data.length)),t.push(n.data))})}),Mi(t)}function Vg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function un(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Y0(e,a),l=jt(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:mr(l[1][0].data),messages:[]};l[2].forEach(function(f){var d=jt(f.data),x=mr(d[3][0].data);o.messages.push({meta:d,data:e.slice(a[0],a[0]+x)}),a[0]+=x}),(t=l[3])!=null&&t[0]&&(o.merge=mr(l[3][0].data)>>>0>0),r.push(o)}return r}function To(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Mt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Mt(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:Mt(o.data.length)}],a[2].push({data:Zr(o.meta),type:2})});var l=Zr(a);t.push(Mt(l.length)),t.push(l),n.forEach(function(o){return t.push(o)})}),Mi(t)}function ZB(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Y0(t,r),n=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var f=o-59;o=t[r[0]],f>1&&(o|=t[r[0]+1]<<8),f>2&&(o|=t[r[0]+2]<<16),f>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=f}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var d=0,x=0;if(l==1?(x=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(x=(t[r[0]++]>>2)+1,l==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Mi(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(x>=d)for(n.push(n[0].slice(-d)),x-=d;x>=n[n.length-1].length;)n.push(n[n.length-1]),x-=n[n.length-1].length;n.push(n[0].slice(-d,-d+x))}}var m=Mi(n);if(m.length!=a)throw new Error("Unexpected length: ".concat(m.length," != ").concat(a));return m}function fn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ZB(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Mi(t)}function No(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var l=Mt(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Mi(t)}function JB(e,t,r,a){var n=Ml(e),l=n.getUint32(4,!0),o=(a>1?12:8)+qw(l&(a>1?3470:398))*4,f=-1,d=-1,x=NaN,m=new Date(2001,0,1);l&512&&(f=n.getUint32(o,!0),o+=4),o+=qw(l&(a>1?12288:4096))*4,l&16&&(d=n.getUint32(o,!0),o+=4),l&32&&(x=n.getFloat64(o,!0),o+=8),l&64&&(m.setTime(m.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:x};break;case 3:p={t:"s",v:t[d]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:x>0};break;case 7:p={t:"n",v:x/86400};break;case 8:p={t:"e",v:0};break;case 9:if(f>-1)p={t:"s",v:r[f]};else if(d>-1)p={t:"s",v:t[d]};else if(!isNaN(x))p={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function eP(e,t,r){var a=Ml(e),n=a.getUint32(8,!0),l=12,o=-1,f=-1,d=NaN,x=NaN,m=new Date(2001,0,1);n&1&&(d=KB(e,l),l+=16),n&2&&(x=a.getFloat64(l,!0),l+=8),n&4&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8),n&8&&(f=a.getUint32(l,!0),l+=4),n&16&&(o=a.getUint32(l,!0),l+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[f]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:x>0};break;case 7:p={t:"n",v:x/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return p}function Wm(e,t){var r=new Uint8Array(32),a=Ml(r),n=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,QB(r,n,e.v),l|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),l|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),r.slice(0,n)}function Xm(e,t){var r=new Uint8Array(32),a=Ml(r),n=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),l|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),l|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),l|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),r.slice(0,n)}function tP(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return JB(e,t,r,e[0]);case 5:return eP(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function sa(e){var t=jt(e);return Y0(t[1][0].data)}function Ww(e,t){var r=jt(t.data),a=mr(r[1][0].data),n=r[3],l=[];return(n||[]).forEach(function(o){var f=jt(o.data),d=mr(f[1][0].data)>>>0;switch(a){case 1:l[d]=Ip(f[3][0].data);break;case 8:{var x=e[sa(f[9][0].data)][0],m=jt(x.data),p=e[sa(m[1][0].data)][0],v=mr(p.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=jt(p.data);l[d]=y[3].map(function(b){return Ip(b.data)}).join("")}break}}),l}function rP(e,t){var r,a,n,l,o,f,d,x,m,p,v,y,b,S,E=jt(e),_=mr(E[1][0].data)>>>0,N=mr(E[2][0].data)>>>0,k=((a=(r=E[8])==null?void 0:r[0])==null?void 0:a.data)&&mr(E[8][0].data)>0||!1,R,A;if((l=(n=E[7])==null?void 0:n[0])!=null&&l.data&&t!=0)R=(f=(o=E[7])==null?void 0:o[0])==null?void 0:f.data,A=(x=(d=E[6])==null?void 0:d[0])==null?void 0:x.data;else if((p=(m=E[4])==null?void 0:m[0])!=null&&p.data&&t!=1)R=(y=(v=E[4])==null?void 0:v[0])==null?void 0:y.data,A=(S=(b=E[3])==null?void 0:b[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=k?4:1,T=Ml(R),O=[],F=0;F<R.length/2;++F){var q=T.getUint16(F*2,!0);q<65535&&O.push([F,q])}if(O.length!=N)throw"Expected ".concat(N," cells, found ").concat(O.length);var X=[];for(F=0;F<O.length-1;++F)X[O[F][0]]=A.subarray(O[F][1]*D,O[F+1][1]*D);return O.length>=1&&(X[O[O.length-1][0]]=A.subarray(O[O.length-1][1]*D)),{R:_,cells:X}}function aP(e,t){var r,a=jt(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?mr(a[7][0].data)>>>0>0?1:0:-1,l=Vg(a[5],function(o){return rP(o,n)});return{nrows:mr(a[4][0].data)>>>0,data:l.reduce(function(o,f){return o[f.R]||(o[f.R]=[]),f.cells.forEach(function(d,x){if(o[f.R][x])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(x));o[f.R][x]=d}),o},[])}}function nP(e,t,r){var a,n=jt(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(mr(n[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(l.e.c=(mr(n[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=ct(l);var o=jt(n[4][0].data),f=Ww(e,e[sa(o[4][0].data)][0]),d=(a=o[17])!=null&&a[0]?Ww(e,e[sa(o[17][0].data)][0]):[],x=jt(o[3][0].data),m=0;x[1].forEach(function(p){var v=jt(p.data),y=e[sa(v[2][0].data)][0],b=mr(y.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var S=aP(e,y);S.data.forEach(function(E,_){E.forEach(function(N,k){var R=at({r:m+_,c:k}),A=tP(N,f,d);A&&(r[R]=A)})}),m+=S.nrows})}function sP(e,t){var r=jt(t.data),a={"!ref":"A1"},n=e[sa(r[2][0].data)],l=mr(n[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return nP(e,n[0],a),a}function iP(e,t){var r,a=jt(t.data),n={name:(r=a[1])!=null&&r[0]?Ip(a[1][0].data):"",sheets:[]},l=Vg(a[2],sa);return l.forEach(function(o){e[o].forEach(function(f){var d=mr(f.meta[1][0].data);d==6e3&&n.sheets.push(sP(e,f))})}),n}function lP(e,t){var r=$g(),a=jt(t.data),n=Vg(a[1],sa);if(n.forEach(function(l){e[l].forEach(function(o){var f=mr(o.meta[1][0].data);if(f==2){var d=iP(e,o);d.sheets.forEach(function(x,m){Kg(r,x,m==0?d.name:d.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ym(e){var t,r,a,n,l={},o=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var x;try{x=fn(d.content)}catch(p){return console.log("?? "+d.content.length+" "+(p.message||p))}var m;try{m=un(x)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){l[p.id]=p.messages,o.push(p.id)})}}),!o.length)throw new Error("File has no messages");var f=((n=(a=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&mr(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||o.forEach(function(d){l[d].forEach(function(x){var m=mr(x.meta[1][0].data)>>>0;if(m==1)if(!f)f=x;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return lP(l,f)}function oP(e,t,r){var a,n,l,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var f=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&mr(e[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var d=0,x=Ml(e[7][0].data),m=0,p=[],v=Ml(e[4][0].data),y=0,b=[],S=0;S<t.length;++S){if(t[S]==null){x.setUint16(S*2,65535,!0),v.setUint16(S*2,65535);continue}x.setUint16(S*2,m,!0),v.setUint16(S*2,y,!0);var E,_;switch(typeof t[S]){case"string":E=Wm({t:"s",v:t[S]},r),_=Xm({t:"s",v:t[S]},r);break;case"number":E=Wm({t:"n",v:t[S]},r),_=Xm({t:"n",v:t[S]},r);break;case"boolean":E=Wm({t:"b",v:t[S]},r),_=Xm({t:"b",v:t[S]},r);break;default:throw new Error("Unsupported value "+t[S])}p.push(E),m+=E.length,b.push(_),y+=_.length,++d}for(e[2][0].data=Mt(d);S<e[7][0].data.length/2;++S)x.setUint16(S*2,65535,!0),v.setUint16(S*2,65535,!0);return e[6][0].data=Mi(p),e[3][0].data=Mi(b),d}function cP(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ma(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ct(a)));var l=Rd(r,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(I){return I.forEach(function(M){typeof M=="string"&&o.push(M)})});var f={},d=[],x=Ke.read(t.numbers,{type:"base64"});x.FileIndex.map(function(I,M){return[I,x.FullPaths[M]]}).forEach(function(I){var M=I[0],W=I[1];if(M.type==2&&M.name.match(/\.iwa/)){var ne=M.content,ye=fn(ne),be=un(ye);be.forEach(function(Se){d.push(Se.id),f[Se.id]={deps:[],location:W,type:mr(Se.messages[0].meta[1][0].data)}})}}),d.sort(function(I,M){return I-M});var m=d.filter(function(I){return I>1}).map(function(I){return[I,Mt(I)]});x.FileIndex.map(function(I,M){return[I,x.FullPaths[M]]}).forEach(function(I){var M=I[0];if(I[1],!!M.name.match(/\.iwa/)){var W=un(fn(M.content));W.forEach(function(ne){ne.messages.forEach(function(ye){m.forEach(function(be){ne.messages.some(function(Se){return mr(Se.meta[1][0].data)!=11006&&$B(Se.data,be[1])})&&f[be[0]].deps.push(ne.id)})})})}});for(var p=Ke.find(x,f[1].location),v=un(fn(p.content)),y,b=0;b<v.length;++b){var S=v[b];S.id==1&&(y=S)}var E=sa(jt(y.messages[0].data)[1][0].data);for(p=Ke.find(x,f[E].location),v=un(fn(p.content)),b=0;b<v.length;++b)S=v[b],S.id==E&&(y=S);for(E=sa(jt(y.messages[0].data)[2][0].data),p=Ke.find(x,f[E].location),v=un(fn(p.content)),b=0;b<v.length;++b)S=v[b],S.id==E&&(y=S);for(E=sa(jt(y.messages[0].data)[2][0].data),p=Ke.find(x,f[E].location),v=un(fn(p.content)),b=0;b<v.length;++b)S=v[b],S.id==E&&(y=S);var _=jt(y.messages[0].data);{_[6][0].data=Mt(a.e.r+1),_[7][0].data=Mt(a.e.c+1);var N=sa(_[46][0].data),k=Ke.find(x,f[N].location),R=un(fn(k.content));{for(var A=0;A<R.length&&R[A].id!=N;++A);if(R[A].id!=N)throw"Bad ColumnRowUIDMapArchive";var D=jt(R[A].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var T=0;T<=a.e.c;++T){var O=[];O[1]=O[2]=[{type:0,data:Mt(T+420690)}],D[1].push({type:2,data:Zr(O)}),D[2].push({type:0,data:Mt(T)}),D[3].push({type:0,data:Mt(T)})}D[4]=[],D[5]=[],D[6]=[];for(var F=0;F<=a.e.r;++F)O=[],O[1]=O[2]=[{type:0,data:Mt(F+726270)}],D[4].push({type:2,data:Zr(O)}),D[5].push({type:0,data:Mt(F)}),D[6].push({type:0,data:Mt(F)});R[A].messages[0].data=Zr(D)}k.content=No(To(R)),k.size=k.content.length,delete _[46];var q=jt(_[4][0].data);{q[7][0].data=Mt(a.e.r+1);var X=jt(q[1][0].data),U=sa(X[2][0].data);k=Ke.find(x,f[U].location),R=un(fn(k.content));{if(R[0].id!=U)throw"Bad HeaderStorageBucket";var ee=jt(R[0].messages[0].data);for(F=0;F<l.length;++F){var oe=jt(ee[2][0].data);oe[1][0].data=Mt(F),oe[4][0].data=Mt(l[F].length),ee[2][F]={type:ee[2][0].type,data:Zr(oe)}}R[0].messages[0].data=Zr(ee)}k.content=No(To(R)),k.size=k.content.length;var ce=sa(q[2][0].data);k=Ke.find(x,f[ce].location),R=un(fn(k.content));{if(R[0].id!=ce)throw"Bad HeaderStorageBucket";for(ee=jt(R[0].messages[0].data),T=0;T<=a.e.c;++T)oe=jt(ee[2][0].data),oe[1][0].data=Mt(T),oe[4][0].data=Mt(a.e.r+1),ee[2][T]={type:ee[2][0].type,data:Zr(oe)};R[0].messages[0].data=Zr(ee)}k.content=No(To(R)),k.size=k.content.length;var Z=sa(q[4][0].data);(function(){for(var I=Ke.find(x,f[Z].location),M=un(fn(I.content)),W,ne=0;ne<M.length;++ne){var ye=M[ne];ye.id==Z&&(W=ye)}var be=jt(W.messages[0].data);{be[3]=[];var Se=[];o.forEach(function(V,We){Se[1]=[{type:0,data:Mt(We)}],Se[2]=[{type:0,data:Mt(1)}],Se[3]=[{type:2,data:YB(V)}],be[3].push({type:2,data:Zr(Se)})})}W.messages[0].data=Zr(be);var Ne=To(M),Xe=No(Ne);I.content=Xe,I.size=I.content.length})();var ie=jt(q[3][0].data);{var ke=ie[1][0];delete ie[2];var re=jt(ke.data);{var z=sa(re[2][0].data);(function(){for(var I=Ke.find(x,f[z].location),M=un(fn(I.content)),W,ne=0;ne<M.length;++ne){var ye=M[ne];ye.id==z&&(W=ye)}var be=jt(W.messages[0].data);{delete be[6],delete ie[7];var Se=new Uint8Array(be[5][0].data);be[5]=[];for(var Ne=0,Xe=0;Xe<=a.e.r;++Xe){var V=jt(Se);Ne+=oP(V,l[Xe],o),V[1][0].data=Mt(Xe),be[5].push({data:Zr(V),type:2})}be[1]=[{type:0,data:Mt(a.e.c+1)}],be[2]=[{type:0,data:Mt(a.e.r+1)}],be[3]=[{type:0,data:Mt(Ne)}],be[4]=[{type:0,data:Mt(a.e.r+1)}]}W.messages[0].data=Zr(be);var We=To(M),$e=No(We);I.content=$e,I.size=I.content.length})()}ke.data=Zr(re)}q[3][0].data=Zr(ie)}_[4][0].data=Zr(q)}y.messages[0].data=Zr(_);var te=To(v),B=No(te);return p.content=B,p.size=p.content.length,x}function U_(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function qg(e){U_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Wg(e){U_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function uP(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function fP(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,uP(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dP(e,t,r,a,n,l,o,f,d,x,m,p){try{l[a]=_0(Xa(e,r,!0),t);var v=Ar(e,t),y;switch(f){case"sheet":y=OL(v,t,n,d,l[a],x,m,p);break;case"chart":if(y=ML(v,t,n,d,l[a],x,m,p),!y||!y["!drawel"])break;var b=b0(y["!drawel"].Target,t),S=H0(b),E=wO(Xa(e,b,!0),_0(Xa(e,S,!0),b)),_=b0(E,b),N=H0(_);y=oL(Xa(e,_,!0),_,d,_0(Xa(e,N,!0),_),x,y);break;case"macro":y=LL(v,t,n,d,l[a],x,m,p);break;case"dialog":y=BL(v,t,n,d,l[a],x,m,p);break;default:throw new Error("Unrecognized sheet type "+f)}o[a]=y;var k=[];l&&l[a]&&pr(l[a]).forEach(function(R){var A="";if(l[a][R].Type==gt.CMNT){A=b0(l[a][R].Target,t);var D=zL(Ar(e,A,!0),A,d);if(!D||!D.length)return;Rw(y,D,!1)}l[a][R].Type==gt.TCMNT&&(A=b0(l[a][R].Target,t),k=k.concat(EO(Ar(e,A,!0),d)))}),k&&k.length&&Rw(y,k,!0,d.people||[])}catch(R){if(d.WTF)throw R}}function on(e){return e.charAt(0)=="/"?e.slice(1):e}function hP(e,t){if(oc(),t=t||{},qg(t),dn(e,"META-INF/manifest.xml")||dn(e,"objectdata.xml"))return Hw(e,t);if(dn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ym<"u"){if(e.FileIndex)return Ym(e);var r=Ke.utils.cfb_new();return Zb(e).forEach(function(oe){ft(r,oe,_j(e,oe))}),Ym(r)}throw new Error("Unsupported NUMBERS file")}if(!dn(e,"[Content_Types].xml"))throw dn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):dn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Zb(e),n=g8(Xa(e,"[Content_Types].xml")),l=!1,o,f;if(n.workbooks.length===0&&(f="xl/workbook.xml",Ar(e,f,!0)&&n.workbooks.push(f)),n.workbooks.length===0){if(f="xl/workbook.bin",!Ar(e,f,!0))throw new Error("Could not find workbook");n.workbooks.push(f),l=!0}n.workbooks[0].slice(-3)=="bin"&&(l=!0);var d={},x={};if(!t.bookSheets&&!t.bookProps){if(k0=[],n.sst)try{k0=UL(Ar(e,on(n.sst)),n.sst,t)}catch(oe){if(t.WTF)throw oe}t.cellStyles&&n.themes.length&&(d=IL(Xa(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(x=PL(Ar(e,on(n.style)),n.style,d,t))}n.links.map(function(oe){try{var ce=_0(Xa(e,H0(on(oe))),oe);return GL(Ar(e,on(oe)),ce,oe,t)}catch{}});var m=FL(Ar(e,on(n.workbooks[0])),n.workbooks[0],t),p={},v="";n.coreprops.length&&(v=Ar(e,on(n.coreprops[0]),!0),v&&(p=CE(v)),n.extprops.length!==0&&(v=Ar(e,on(n.extprops[0]),!0),v&&_8(v,p,t)));var y={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(v=Xa(e,on(n.custprops[0]),!0),v&&(y=T8(v,t)));var b={};if((t.bookSheets||t.bookProps)&&(m.Sheets?o=m.Sheets.map(function(ce){return ce.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),t.bookProps&&(b.Props=p,b.Custprops=y),t.bookSheets&&typeof o<"u"&&(b.SheetNames=o),t.bookSheets?b.SheetNames:t.bookProps))return b;o={};var S={};t.bookDeps&&n.calcchain&&(S=HL(Ar(e,on(n.calcchain)),n.calcchain));var E=0,_={},N,k;{var R=m.Sheets;p.Worksheets=R.length,p.SheetNames=[];for(var A=0;A!=R.length;++A)p.SheetNames[A]=R[A].name}var D=l?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),O=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");dn(e,O)||(O="xl/_rels/workbook."+D+".rels");var F=_0(Xa(e,O,!0),O.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=VL(Ar(e,on(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=kO(Ar(e,on(n.people[0])),t)),F&&(F=fP(F,m.Sheets));var q=Ar(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=p.Worksheets;++E){var X="sheet";if(F&&F[E]?(N="xl/"+F[E][1].replace(/[\/]?xl\//,""),dn(e,N)||(N=F[E][1]),dn(e,N)||(N=O.replace(/_rels\/.*$/,"")+F[E][1]),X=F[E][2]):(N="xl/worksheets/sheet"+(E+1-q)+"."+D,N=N.replace(/sheet0\./,"sheet.")),k=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(p.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,ee=0;ee!=t.sheets.length;++ee)typeof t.sheets[ee]=="number"&&t.sheets[ee]==E&&(U=1),typeof t.sheets[ee]=="string"&&t.sheets[ee].toLowerCase()==p.SheetNames[E].toLowerCase()&&(U=1);if(!U)continue e}}dP(e,N,k,p.SheetNames[E],E,_,o,X,t,m,d,x)}return b={Directory:n,Workbook:m,Props:p,Custprops:y,Deps:S,Sheets:o,SheetNames:p.SheetNames,Strings:k0,Styles:x,Themes:d,SSF:ar(rt)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(oe,ce){oe=oe.replace(/^Root Entry[\/]/,""),b.keys.push(oe),b.files[oe]=e.FileIndex[ce]}))),t&&t.bookVBA&&(n.vba.length>0?b.vbaraw=Ar(e,on(n.vba[0]),!0):n.defaults&&n.defaults.bin===FO&&(b.vbaraw=Ar(e,"xl/vbaProject.bin",!0))),b}function xP(e,t){var r=t||{},a="Workbook",n=Ke.find(e,a);try{if(a="/!DataSpaces/Version",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(VD(n.content),a="/!DataSpaces/DataSpaceMap",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=WD(n.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=XD(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);$D(n.content)}catch{}if(a="/EncryptionInfo",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var f=KD(n.content);if(a="/EncryptedPackage",n=Ke.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],n.content,r.password||"",r);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function mP(e,t){return t.bookType=="ods"?I_(e,t):t.bookType=="numbers"?cP(e,t):t.bookType=="xlsb"?pP(e,t):gP(e,t)}function pP(e,t){Ro=1024,e&&!e.SSF&&(e.SSF=ar(rt)),e&&e.SSF&&(oc(),Xd(e.SSF),t.revssf=$d(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,T0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=h_.indexOf(t.bookType)>-1,n=Rg();Wg(t=t||{});var l=gg(),o="",f=0;if(t.cellXfs=[],Ii(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ft(l,o,AE(e.Props,t)),n.coreprops.push(o),Lt(t.rels,2,o,gt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&d.push(e.SheetNames[x]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,ft(l,o,DE(e.Props)),n.extprops.push(o),Lt(t.rels,3,o,gt.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ft(l,o,FE(e.Custprops)),n.custprops.push(o),Lt(t.rels,4,o,gt.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var m={"!id":{}},p=e.Sheets[e.SheetNames[f-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,ft(l,o,WL(f-1,o,t,e,m)),n.sheets.push(o),Lt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,gt.WS[0])}if(p){var y=p["!comments"],b=!1,S="";y&&y.length>0&&(S="xl/comments"+f+"."+r,ft(l,S,$L(y,S)),n.comments.push(S),Lt(m,-1,"../comments"+f+"."+r,gt.CMNT),b=!0),p["!legacy"]&&b&&ft(l,"xl/drawings/vmlDrawing"+f+".vml",f_(f,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&ft(l,H0(o),Oo(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ft(l,o,YL(t.Strings,o,t)),n.strs.push(o),Lt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),o="xl/workbook."+r,ft(l,o,qL(e,o)),n.workbooks.push(o),Lt(t.rels,1,o,gt.WB),o="xl/theme/theme1.xml",ft(l,o,Bg(e.Themes,t)),n.themes.push(o),Lt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),o="xl/styles."+r,ft(l,o,XL(e,o,t)),n.styles.push(o),Lt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ft(l,o,e.vbaraw),n.vba.push(o),Lt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),o="xl/metadata."+r,ft(l,o,KL(o)),n.metadata.push(o),Lt(t.wbrels,-1,"metadata."+r,gt.XLMETA),ft(l,"[Content_Types].xml",TE(n,t)),ft(l,"_rels/.rels",Oo(t.rels)),ft(l,"xl/_rels/workbook."+r+".rels",Oo(t.wbrels)),delete t.revssf,delete t.ssf,l}function gP(e,t){Ro=1024,e&&!e.SSF&&(e.SSF=ar(rt)),e&&e.SSF&&(oc(),Xd(e.SSF),t.revssf=$d(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,T0?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=h_.indexOf(t.bookType)>-1,n=Rg();Wg(t=t||{});var l=gg(),o="",f=0;if(t.cellXfs=[],Ii(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ft(l,o,AE(e.Props,t)),n.coreprops.push(o),Lt(t.rels,2,o,gt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&d.push(e.SheetNames[x]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,ft(l,o,DE(e.Props)),n.extprops.push(o),Lt(t.rels,3,o,gt.EXT_PROPS),e.Custprops!==e.Props&&pr(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ft(l,o,FE(e.Custprops)),n.custprops.push(o),Lt(t.rels,4,o,gt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,f=1;f<=e.SheetNames.length;++f){var p={"!id":{}},v=e.Sheets[e.SheetNames[f-1]],y=(v||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+f+"."+r,ft(l,o,__(f-1,t,e,p)),n.sheets.push(o),Lt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,gt.WS[0])}if(v){var b=v["!comments"],S=!1,E="";if(b&&b.length>0){var _=!1;b.forEach(function(N){N[1].forEach(function(k){k.T==!0&&(_=!0)})}),_&&(E="xl/threadedComments/threadedComment"+f+"."+r,ft(l,E,_O(b,m,t)),n.threadedcomments.push(E),Lt(p,-1,"../threadedComments/threadedComment"+f+"."+r,gt.TCMNT)),E="xl/comments"+f+"."+r,ft(l,E,d_(b)),n.comments.push(E),Lt(p,-1,"../comments"+f+"."+r,gt.CMNT),S=!0}v["!legacy"]&&S&&ft(l,"xl/drawings/vmlDrawing"+f+".vml",f_(f,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&ft(l,H0(o),Oo(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ft(l,o,JE(t.Strings,t)),n.strs.push(o),Lt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),o="xl/workbook."+r,ft(l,o,A_(e)),n.workbooks.push(o),Lt(t.rels,1,o,gt.WB),o="xl/theme/theme1.xml",ft(l,o,Bg(e.Themes,t)),n.themes.push(o),Lt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),o="xl/styles."+r,ft(l,o,l_(e,t)),n.styles.push(o),Lt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ft(l,o,e.vbaraw),n.vba.push(o),Lt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),o="xl/metadata."+r,ft(l,o,u_()),n.metadata.push(o),Lt(t.wbrels,-1,"metadata."+r,gt.XLMETA),m.length>1&&(o="xl/persons/person.xml",ft(l,o,TO(m)),n.people.push(o),Lt(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),ft(l,"[Content_Types].xml",TE(n,t)),ft(l,"_rels/.rels",Oo(t.rels)),ft(l,"xl/_rels/workbook."+r+".rels",Oo(t.wbrels)),delete t.revssf,delete t.ssf,l}function Xg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$a(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function vP(e,t){return Ke.find(e,"EncryptedPackage")?xP(e,t):F_(e,t)}function yP(e,t){var r,a=e,n=t||{};return n.type||(n.type=mt&&Buffer.isBuffer(e)?"buffer":"base64"),r=tE(a,n),hP(r,n)}function z_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Bp(e.slice(r),t);default:break e}return Qo.to_workbook(e,t)}function bP(e,t){var r="",a=Xg(e,t);switch(t.type){case"base64":r=$a(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Rl(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Vt(r)),t.type="binary",z_(r,t)}function wP(e,t){var r=e;return t.type=="base64"&&(r=$a(r)),r=L0.utils.decode(1200,r.slice(2),"str"),t.type="binary",z_(r,t)}function SP(e){return e.match(/[^\x00-\x7F]/)?ns(e):e}function $m(e,t,r,a){return a?(r.type="string",Qo.to_workbook(e,r)):Qo.to_workbook(t,r)}function Up(e,t){dg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Up(new Uint8Array(e),(r=ar(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Lo={},r.dateNF&&(Lo.dateNF=r.dateNF),r.type||(r.type=mt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=mt?"buffer":"binary",a=pj(e),typeof Uint8Array<"u"&&!mt&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,a=SP(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),f=new Uint8Array(o);if(f.foo="bar",!f.foo)return r=ar(r),r.type="array",Up(hg(a),r)}switch((n=Xg(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return vP(Ke.read(a,r),r);break;case 9:if(n[1]<=8)return F_(a,r);break;case 60:return Bp(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return ND(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return QE.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?yP(a,r):$m(e,a,r,l);case 239:return n[3]===60?Bp(a,r):$m(e,a,r,l);case 255:if(n[1]===254)return wP(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return kl.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return kl.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Lp.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return n_.to_workbook(a,r);break;case 10:case 13:case 32:return bP(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return TD.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Lp.to_workbook(a,r):$m(e,a,r,l)}function H_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return fu(t.file,Ke.write(e,{type:mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ke.write(e,t)}function EP(e,t){var r=ar(t||{}),a=mP(e,r);return _P(a,r)}function _P(e,t){var r={},a=mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Ke.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(Wd(n))}return t.password&&typeof encrypt_agile<"u"?H_(encrypt_agile(n,t.password),t):t.type==="file"?fu(t.file,n):t.type=="string"?Vt(n):n}function kP(e,t){var r=t||{},a=SB(e,r);return H_(a,r)}function Jn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return B0(ns(a));case"binary":return ns(a);case"string":return e;case"file":return fu(t.file,a,"utf8");case"buffer":return mt?Is(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Jn(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function TP(e,t){switch(t.type){case"base64":return B0(e);case"binary":return e;case"string":return e;case"file":return fu(t.file,e,"binary");case"buffer":return mt?Is(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Yf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?B0(r):t.type=="string"?Vt(r):r;case"file":return fu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function G_(e,t){dg(),vL(e);var r=ar(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=G_(e,r);return r.type="array",Wd(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Jn(mB(e,r),r);case"slk":case"sylk":return Jn(KE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Jn(M_(e.Sheets[e.SheetNames[n]],r),r);case"txt":return TP(V_(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Jn(Yg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Jn(QE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Yf(Lp.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Jn(Qo.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Jn(n_.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Jn(ZE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Jn(I_(e,r),r);case"wk1":return Yf(kl.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Yf(kl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Yf(O_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),kP(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return EP(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function NP(e,t,r,a,n,l,o,f){var d=wr(r),x=f.defval,m=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),p=!0,v=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var b=o?e[r][y]:e[a[y]+d];if(b===void 0||b.t===void 0){if(x===void 0)continue;l[y]!=null&&(v[l[y]]=x);continue}var S=b.v;switch(b.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[y]!=null){if(S==null)if(b.t=="e"&&S===null)v[l[y]]=null;else if(x!==void 0)v[l[y]]=x;else if(m&&S===null)v[l[y]]=null;else continue;else v[l[y]]=m&&(b.t!=="n"||b.t==="n"&&f.rawNumbers!==!1)?S:Bs(b,S,f);S!=null&&(p=!1)}}return{row:v,isempty:p}}function Rd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,l=[],o=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},m=x.range!=null?x.range:e["!ref"];switch(x.header===1?a=1:x.header==="A"?a=2:Array.isArray(x.header)?a=3:x.header==null&&(a=0),typeof m){case"string":d=Nt(m);break;case"number":d=Nt(e["!ref"]),d.s.r=m;break;default:d=m}a>0&&(n=0);var p=wr(d.s.r),v=[],y=[],b=0,S=0,E=Array.isArray(e),_=d.s.r,N=0,k={};E&&!e[_]&&(e[_]=[]);var R=x.skipHidden&&e["!cols"]||[],A=x.skipHidden&&e["!rows"]||[];for(N=d.s.c;N<=d.e.c;++N)if(!(R[N]||{}).hidden)switch(v[N]=or(N),r=E?e[_][N]:e[v[N]+p],a){case 1:l[N]=N-d.s.c;break;case 2:l[N]=v[N];break;case 3:l[N]=x.header[N-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),f=o=Bs(r,null,x),S=k[o]||0,!S)k[o]=1;else{do f=o+"_"+S++;while(k[f]);k[o]=S,k[f]=1}l[N]=f}for(_=d.s.r+n;_<=d.e.r;++_)if(!(A[_]||{}).hidden){var D=NP(e,d,_,v,a,l,E,x);(D.isempty===!1||(a===1?x.blankrows!==!1:x.blankrows))&&(y[b++]=D.row)}return y.length=b,y}var Xw=/"/g;function CP(e,t,r,a,n,l,o,f){for(var d=!0,x=[],m="",p=wr(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var y=f.dense?(e[r]||[])[v]:e[a[v]+p];if(y==null)m="";else if(y.v!=null){d=!1,m=""+(f.rawNumbers&&y.t=="n"?y.v:Bs(y,null,f));for(var b=0,S=0;b!==m.length;++b)if((S=m.charCodeAt(b))===n||S===l||S===34||f.forceQuotes){m='"'+m.replace(Xw,'""')+'"';break}m=="ID"&&(m='"ID"')}else y.f!=null&&!y.F?(d=!1,m="="+y.f,m.indexOf(",")>=0&&(m='"'+m.replace(Xw,'""')+'"')):m="";x.push(m)}return f.blankrows===!1&&d?null:x.join(o)}function Yg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Nt(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),f=a.RS!==void 0?a.RS:`
`,d=f.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),m="",p=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],y=a.skipHidden&&e["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(v[b]||{}).hidden||(p[b]=or(b));for(var S=0,E=n.s.r;E<=n.e.r;++E)(y[E]||{}).hidden||(m=CP(e,n,E,p,o,d,l,a),m!=null&&(a.strip&&(m=m.replace(x,"")),(m||a.blankrows!==!1)&&r.push((S++?f:"")+m)));return delete a.dense,r.join("")}function V_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yg(e,t);return r}function AP(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Nt(e["!ref"]),l="",o=[],f,d=[],x=Array.isArray(e);for(f=n.s.c;f<=n.e.c;++f)o[f]=or(f);for(var m=n.s.r;m<=n.e.r;++m)for(l=wr(m),f=n.s.c;f<=n.e.c;++f)if(t=o[f]+l,r=x?(e[m]||[])[f]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}d[d.length]=t+"="+a}return d}function q_(e,t,r){var a=r||{},n=+!a.skipHeader,l=e||{},o=0,f=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?cr(a.origin):a.origin;o=d.r,f=d.c}var x,m={s:{c:0,r:0},e:{c:f,r:o+t.length-1+n}};if(l["!ref"]){var p=Nt(l["!ref"]);m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),o==-1&&(o=p.e.r+1,m.e.r=o+t.length-1+n)}else o==-1&&(o=0,m.e.r=t.length-1+n);var v=a.header||[],y=0;t.forEach(function(S,E){pr(S).forEach(function(_){(y=v.indexOf(_))==-1&&(v[y=v.length]=_);var N=S[_],k="z",R="",A=at({c:f+y,r:o+E+n});x=$0(l,A),N&&typeof N=="object"&&!(N instanceof Date)?l[A]=N:(typeof N=="number"?k="n":typeof N=="boolean"?k="b":typeof N=="string"?k="s":N instanceof Date?(k="d",a.cellDates||(k="n",N=Pr(N)),R=a.dateNF||rt[14]):N===null&&a.nullError&&(k="e",N=0),x?(x.t=k,x.v=N,delete x.w,delete x.R,R&&(x.z=R)):l[A]=x={t:k,v:N},R&&(x.z=R))})}),m.e.c=Math.max(m.e.c,f+v.length-1);var b=wr(o);if(n)for(y=0;y<v.length;++y)l[or(y+f)+b]={t:"s",v:v[y]};return l["!ref"]=ct(m),l}function jP(e,t){return q_(null,e,t)}function $0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=cr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?$0(e,at(t)):$0(e,at({r:t,c:r||0}))}function RP(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $g(){return{SheetNames:[],Sheets:{}}}function Kg(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);n=l&&+l[2]||0;var o=l&&l[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(C_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function DP(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=RP(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function FP(e,t){return e.z=t,e}function W_(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function OP(e,t,r){return W_(e,"#"+t,r)}function MP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function LP(e,t,r,a){for(var n=typeof t!="string"?t:Nt(t),l=typeof t=="string"?t:ct(t),o=n.s.r;o<=n.e.r;++o)for(var f=n.s.c;f<=n.e.c;++f){var d=$0(e,o,f);d.t="n",d.F=l,delete d.v,o==n.s.r&&f==n.s.c&&(d.f=r,a&&(d.D=!0))}return e}var $f={encode_col:or,encode_row:wr,encode_cell:at,encode_range:ct,decode_col:kg,decode_row:_g,split_cell:Yj,decode_cell:cr,decode_range:Ma,format_cell:Bs,sheet_add_aoa:yE,sheet_add_json:q_,sheet_add_dom:L_,aoa_to_sheet:cc,json_to_sheet:jP,table_to_sheet:B_,table_to_book:VB,sheet_to_csv:Yg,sheet_to_txt:V_,sheet_to_json:Rd,sheet_to_html:M_,sheet_to_formulae:AP,sheet_to_row_object_array:Rd,sheet_get_cell:$0,book_new:$g,book_append_sheet:Kg,book_set_sheet_visibility:DP,cell_set_number_format:FP,cell_set_hyperlink:W_,cell_set_internal_link:OP,cell_add_comment:MP,sheet_set_array_formula:LP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},dd={exports:{}},BP=dd.exports,Yw;function PP(){return Yw||(Yw=1,function(e,t){(function(r,a){a()})(BP,function(){function r(x,m){return typeof m>"u"?m={autoBom:!1}:typeof m!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(x.type)?new Blob(["\uFEFF",x],{type:x.type}):x}function a(x,m,p){var v=new XMLHttpRequest;v.open("GET",x),v.responseType="blob",v.onload=function(){d(v.response,m,p)},v.onerror=function(){console.error("could not download file")},v.send()}function n(x){var m=new XMLHttpRequest;m.open("HEAD",x,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function l(x){try{x.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),x.dispatchEvent(m)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Mf=="object"&&Mf.global===Mf?Mf:void 0,f=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!f?function(x,m,p){var v=o.URL||o.webkitURL,y=document.createElement("a");m=m||x.name||"download",y.download=m,y.rel="noopener",typeof x=="string"?(y.href=x,y.origin===location.origin?l(y):n(y.href)?a(x,m,p):l(y,y.target="_blank")):(y.href=v.createObjectURL(x),setTimeout(function(){v.revokeObjectURL(y.href)},4e4),setTimeout(function(){l(y)},0))}:"msSaveOrOpenBlob"in navigator?function(x,m,p){if(m=m||x.name||"download",typeof x!="string")navigator.msSaveOrOpenBlob(r(x,p),m);else if(n(x))a(x,m,p);else{var v=document.createElement("a");v.href=x,v.target="_blank",setTimeout(function(){l(v)})}}:function(x,m,p,v){if(v=v||open("","_blank"),v&&(v.document.title=v.document.body.innerText="downloading..."),typeof x=="string")return a(x,m,p);var y=x.type==="application/octet-stream",b=/constructor/i.test(o.HTMLElement)||o.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||y&&b||f)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var k=E.result;k=S?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),v?v.location.href=k:location=k,v=null},E.readAsDataURL(x)}else{var _=o.URL||o.webkitURL,N=_.createObjectURL(x);v?v.location=N:location.href=N,v=null,setTimeout(function(){_.revokeObjectURL(N)},4e4)}});o.saveAs=d.saveAs=d,e.exports=d})}(dd)),dd.exports}var IP=PP();let UP={data:""},zP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||UP,HP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,GP=/\/\*[^]*?\*\/|  +/g,$w=/\n+/g,gi=(e,t)=>{let r="",a="",n="";for(let l in e){let o=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+o+";":a+=l[1]=="f"?gi(o,l):l+"{"+gi(o,l[1]=="k"?"":t)+"}":typeof o=="object"?a+=gi(o,t?t.replace(/([^,])+/g,f=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,f):f?f+" "+d:d)):l):o!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=gi.p?gi.p(l,o):l+":"+o+";")}return r+(t&&n?t+"{"+n+"}":n)+a},_s={},X_=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+X_(e[r]);return t}return e},VP=(e,t,r,a,n)=>{let l=X_(e),o=_s[l]||(_s[l]=(d=>{let x=0,m=11;for(;x<d.length;)m=101*m+d.charCodeAt(x++)>>>0;return"go"+m})(l));if(!_s[o]){let d=l!==e?e:(x=>{let m,p,v=[{}];for(;m=HP.exec(x.replace(GP,""));)m[4]?v.shift():m[3]?(p=m[3].replace($w," ").trim(),v.unshift(v[0][p]=v[0][p]||{})):v[0][m[1]]=m[2].replace($w," ").trim();return v[0]})(e);_s[o]=gi(n?{["@keyframes "+o]:d}:d,r?"":"."+o)}let f=r&&_s.g?_s.g:null;return r&&(_s.g=_s[o]),((d,x,m,p)=>{p?x.data=x.data.replace(p,d):x.data.indexOf(d)===-1&&(x.data=m?d+x.data:x.data+d)})(_s[o],t,a,f),o},qP=(e,t,r)=>e.reduce((a,n,l)=>{let o=t[l];if(o&&o.call){let f=o(r),d=f&&f.props&&f.props.className||/^go/.test(f)&&f;o=d?"."+d:f&&typeof f=="object"?f.props?"":gi(f,""):f===!1?"":f}return a+n+(o??"")},"");function th(e){let t=this||{},r=e.call?e(t.p):e;return VP(r.unshift?r.raw?qP(r,[].slice.call(arguments,1),t.p):r.reduce((a,n)=>Object.assign(a,n&&n.call?n(t.p):n),{}):r,zP(t.target),t.g,t.o,t.k)}let Y_,zp,Hp;th.bind({g:1});let Ps=th.bind({k:1});function WP(e,t,r,a){gi.p=t,Y_=e,zp=r,Hp=a}function Ui(e,t){let r=this||{};return function(){let a=arguments;function n(l,o){let f=Object.assign({},l),d=f.className||n.className;r.p=Object.assign({theme:zp&&zp()},f),r.o=/ *go\d+/.test(d),f.className=th.apply(r,a)+(d?" "+d:"");let x=e;return e[0]&&(x=f.as||e,delete f.as),Hp&&x[0]&&Hp(f),Y_(x,f)}return n}}var XP=e=>typeof e=="function",Dd=(e,t)=>XP(e)?e(t):e,YP=(()=>{let e=0;return()=>(++e).toString()})(),$_=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),$P=20,K_=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,$P)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:r}=t;return K_(e,{type:e.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(l=>l.id===a||a===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let n=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+n}))}}},hd=[],ul={toasts:[],pausedAt:void 0},Hl=e=>{ul=K_(ul,e),hd.forEach(t=>{t(ul)})},KP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},QP=(e={})=>{let[t,r]=C.useState(ul),a=C.useRef(ul);C.useEffect(()=>(a.current!==ul&&r(ul),hd.push(r),()=>{let l=hd.indexOf(r);l>-1&&hd.splice(l,1)}),[]);let n=t.toasts.map(l=>{var o,f,d;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((o=e[l.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:l.duration||((f=e[l.type])==null?void 0:f.duration)||(e==null?void 0:e.duration)||KP[l.type],style:{...e.style,...(d=e[l.type])==null?void 0:d.style,...l.style}}});return{...t,toasts:n}},ZP=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||YP()}),yu=e=>(t,r)=>{let a=ZP(t,e,r);return Hl({type:2,toast:a}),a.id},wa=(e,t)=>yu("blank")(e,t);wa.error=yu("error");wa.success=yu("success");wa.loading=yu("loading");wa.custom=yu("custom");wa.dismiss=e=>{Hl({type:3,toastId:e})};wa.remove=e=>Hl({type:4,toastId:e});wa.promise=(e,t,r)=>{let a=wa.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(n=>{let l=t.success?Dd(t.success,n):void 0;return l?wa.success(l,{id:a,...r,...r==null?void 0:r.success}):wa.dismiss(a),n}).catch(n=>{let l=t.error?Dd(t.error,n):void 0;l?wa.error(l,{id:a,...r,...r==null?void 0:r.error}):wa.dismiss(a)}),e};var JP=(e,t)=>{Hl({type:1,toast:{id:e,height:t}})},eI=()=>{Hl({type:5,time:Date.now()})},A0=new Map,tI=1e3,rI=(e,t=tI)=>{if(A0.has(e))return;let r=setTimeout(()=>{A0.delete(e),Hl({type:4,toastId:e})},t);A0.set(e,r)},aI=e=>{let{toasts:t,pausedAt:r}=QP(e);C.useEffect(()=>{if(r)return;let l=Date.now(),o=t.map(f=>{if(f.duration===1/0)return;let d=(f.duration||0)+f.pauseDuration-(l-f.createdAt);if(d<0){f.visible&&wa.dismiss(f.id);return}return setTimeout(()=>wa.dismiss(f.id),d)});return()=>{o.forEach(f=>f&&clearTimeout(f))}},[t,r]);let a=C.useCallback(()=>{r&&Hl({type:6,time:Date.now()})},[r]),n=C.useCallback((l,o)=>{let{reverseOrder:f=!1,gutter:d=8,defaultPosition:x}=o||{},m=t.filter(y=>(y.position||x)===(l.position||x)&&y.height),p=m.findIndex(y=>y.id===l.id),v=m.filter((y,b)=>b<p&&y.visible).length;return m.filter(y=>y.visible).slice(...f?[v+1]:[0,v]).reduce((y,b)=>y+(b.height||0)+d,0)},[t]);return C.useEffect(()=>{t.forEach(l=>{if(l.dismissed)rI(l.id,l.removeDelay);else{let o=A0.get(l.id);o&&(clearTimeout(o),A0.delete(l.id))}})},[t]),{toasts:t,handlers:{updateHeight:JP,startPause:eI,endPause:a,calculateOffset:n}}},nI=Ps`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,sI=Ps`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iI=Ps`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,lI=Ui("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${sI} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${iI} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,oI=Ps`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,cI=Ui("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${oI} 1s linear infinite;
`,uI=Ps`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,fI=Ps`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,dI=Ui("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uI} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${fI} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hI=Ui("div")`
  position: absolute;
`,xI=Ui("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,mI=Ps`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,pI=Ui("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${mI} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,gI=({toast:e})=>{let{icon:t,type:r,iconTheme:a}=e;return t!==void 0?typeof t=="string"?C.createElement(pI,null,t):t:r==="blank"?null:C.createElement(xI,null,C.createElement(cI,{...a}),r!=="loading"&&C.createElement(hI,null,r==="error"?C.createElement(lI,{...a}):C.createElement(dI,{...a})))},vI=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,yI=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,bI="0%{opacity:0;} 100%{opacity:1;}",wI="0%{opacity:1;} 100%{opacity:0;}",SI=Ui("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,EI=Ui("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,_I=(e,t)=>{let r=e.includes("top")?1:-1,[a,n]=$_()?[bI,wI]:[vI(r),yI(r)];return{animation:t?`${Ps(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ps(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},kI=C.memo(({toast:e,position:t,style:r,children:a})=>{let n=e.height?_I(e.position||t||"top-center",e.visible):{opacity:0},l=C.createElement(gI,{toast:e}),o=C.createElement(EI,{...e.ariaProps},Dd(e.message,e));return C.createElement(SI,{className:e.className,style:{...n,...r,...e.style}},typeof a=="function"?a({icon:l,message:o}):C.createElement(C.Fragment,null,l,o))});WP(C.createElement);var TI=({id:e,className:t,style:r,onHeightUpdate:a,children:n})=>{let l=C.useCallback(o=>{if(o){let f=()=>{let d=o.getBoundingClientRect().height;a(e,d)};f(),new MutationObserver(f).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[e,a]);return C.createElement("div",{ref:l,className:t,style:r},n)},NI=(e,t)=>{let r=e.includes("top"),a=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:$_()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...a,...n}},CI=th`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Kf=16,AI=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:a,children:n,containerStyle:l,containerClassName:o})=>{let{toasts:f,handlers:d}=aI(r);return C.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Kf,left:Kf,right:Kf,bottom:Kf,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},f.map(x=>{let m=x.position||t,p=d.calculateOffset(x,{reverseOrder:e,gutter:a,defaultPosition:t}),v=NI(m,p);return C.createElement(TI,{id:x.id,key:x.id,onHeightUpdate:d.updateHeight,className:x.visible?CI:"",style:v},x.type==="custom"?Dd(x.message,x):n?n(x):C.createElement(kI,{toast:x,position:m}))}))},Ya=wa;function jI(e){return Xr({queryKey:["rsvps",e],queryFn:async()=>{var n;const t=await Ze.get(su.forEvent(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:Array.isArray(r==null?void 0:r.data)?r.data:[]).map(l=>({id:l.id??l.rsvpId??l.rsvpGuid??l._id,rsvpId:l.rsvpId??l.id,rsvpGuid:l.rsvpGuid??l.rsvpGuid??void 0,eventId:l.eventId,guestName:l.guestName??l.name??"",noOfPax:l.noOfPax!==void 0&&l.noOfPax!==null?l.noOfPax:1,name:l.name,status:l.status??"",guestType:l.guestType??"",createdBy:l.createdBy??"",remarks:l.remarks??"",phoneNo:l.phoneNo??"",tableId:l.tableId??l.table_id??void 0}))},enabled:!!e,staleTime:6e4})}function RI(e,t){return Xr({queryKey:["rsvp",t],queryFn:async()=>(await Ze.get(su.byId(e,t))).data})}function Qg(e){const t=bt();return kt({mutationFn:r=>Ze.post(su.create(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function Zg(e){const t=bt();return kt({mutationFn:async r=>(await Ze.post(su.update(),r)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function DI(e){const t=bt();return kt({mutationFn:r=>Ze.post(su.delete(),r).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["rsvps",e]}),t.invalidateQueries({queryKey:["guests",e]})}})}function Jg(e,t){return Xr({queryKey:["formFields",e],enabled:!!e&&((t==null?void 0:t.enabled)??!0),queryFn:async()=>{var l;if(!e)return[];const a=((l=(await Ze.get(Vd.all(e))).data)==null?void 0:l.data)??[],n={0:"text",1:"textarea",2:"select",3:"radio",4:"checkbox",5:"email",6:"number",7:"date"};return(Array.isArray(a)?a:[]).map(o=>({questionId:o.id??o.questionId,id:o.id??o.questionId,eventId:o.eventId,label:o.label??o.text??o.name??"",name:o.name??(o.label??o.text??"").toLowerCase().replace(/\s+/g,"_"),text:o.text??o.label??"",isRequired:o.isRequired??o.required??!1,type:typeof o.type=="number"?o.type:void 0,typeKey:typeof o.type=="number"?n[o.type]:o.typeKey??o.type,options:Array.isArray(o.options)||typeof o.options=="string"?o.options:void 0,order:o.order??0}))}})}function FI(e){const t=bt();return kt({mutationFn:r=>Ze.post(Vd.create(),r).then(a=>a.data),onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function OI(e){const t=bt();return kt({mutationFn:r=>{const a={...r,questionId:r.questionId??r.id};return delete a.id,Ze.post(Vd.update(),a).then(n=>n.data)},onSuccess:(r,a)=>t.invalidateQueries({queryKey:["formFields",(a==null?void 0:a.eventId)??(a==null?void 0:a.eventGuid)??(a==null?void 0:a.eventGUID)]})})}function MI(e){const t=bt();return kt({mutationFn:()=>Ze.post(Vd.deactivate()).then(r=>r.data),onSuccess:()=>t.invalidateQueries({queryKey:["formFields",e]})})}const e1=({isOpen:e,onClose:t,eventId:r,initial:a,onSave:n})=>{const{user:l}=cu(),[o,f]=C.useState((a==null?void 0:a.guestName)||(a==null?void 0:a.name)||""),[d,x]=C.useState((a==null?void 0:a.noOfPax)||1),[m,p]=C.useState((a==null?void 0:a.phoneNo)||""),[v,y]=C.useState((a==null?void 0:a.remarks)||""),[b,S]=C.useState((a==null?void 0:a.status)||"Yes"),[E,_]=C.useState((a==null?void 0:a.guestType)||"Family"),[N,k]=C.useState({}),{data:R=[]}=Jg(r),[A,D]=C.useState(!1),[T,O]=C.useState(""),[F,q]=C.useState(""),[X,U]=C.useState("");C.useEffect(()=>{e&&!A&&(f((a==null?void 0:a.name)??""),x((a==null?void 0:a.noOfPax)??1),p((a==null?void 0:a.phoneNo)??""),y((a==null?void 0:a.remarks)??""),S((a==null?void 0:a.status)??"Yes"),k(R.reduce((oe,ce)=>{const Z=ce.name??ce.id??ce.questionId;return Z&&(oe[Z]=(a==null?void 0:a[Z])??""),oe},{})),O(""),q(""),U(""),D(!0)),e||D(!1)},[e,a==null?void 0:a.rsvpId,R,A]);const ee=oe=>{oe.preventDefault();let ce=!1;if(!o||o.trim()===""?(O("Guest name is required"),ce=!0):O(""),!m||m.trim()===""?(q("Phone number is required"),ce=!0):q(""),!d&&d!==0&&d!=="0"?(U("Number of pax is required"),ce=!0):Number(d)<0?(U("Number of pax cannot be negative"),ce=!0):Number.isInteger(Number(d))?U(""):(U("Number of pax must be a whole number"),ce=!0),ce)return;const Z=(l==null?void 0:l.id)??(l==null?void 0:l.name)??"System",ie={eventId:r,guestName:o.trim(),noOfPax:Number(d),status:b,guestType:E,remarks:v.trim(),phoneNo:m.trim(),...N};a?(ie.updatedBy=Z,ie.rsvpGuid=a.rsvpGuid):ie.createdBy=Z,n(ie,(a==null?void 0:a.id)??(a==null?void 0:a.rsvpId)),t()};return c.jsx(zn,{isOpen:e,onClose:t,title:a?"Edit RSVP":"New RSVP",children:c.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx($t,{label:"Guest Name",value:o,onChange:oe=>{f(oe.target.value),O("")},required:!0}),T&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:T})]}),c.jsxs("div",{children:[c.jsx($t,{label:"No Of Pax",type:"number",value:String(d),onChange:oe=>{x(oe.target.value),U("")},min:0,step:1,required:!0}),X&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:X})]}),c.jsxs("div",{children:[c.jsx($t,{label:"Phone",value:m,onChange:oe=>{p(oe.target.value),q("")},required:!0}),F&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:F})]}),c.jsxs("div",{style:{display:"none"},children:[c.jsx("label",{className:"block mb-1",children:"Guest Type"}),c.jsx("select",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:E,onChange:oe=>_(oe.target.value),children:["Family","VIP","Friend","Other"].map(oe=>c.jsx("option",{value:oe,children:oe},oe))})]}),c.jsxs("div",{style:{display:"none"},children:[c.jsx("label",{className:"block mb-1",children:"Reservation Status"}),c.jsx("select",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:b,onChange:oe=>S(oe.target.value),children:["Yes","No","Maybe"].map(oe=>c.jsx("option",{value:oe,children:oe},oe))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1",children:"Remarks"}),c.jsx("textarea",{className:"w-full border rounded p-2 focus:ring-2 focus:ring-primary",value:v,onChange:oe=>y(oe.target.value),rows:3,placeholder:"Add any additional notes or remarks..."})]}),R.map(oe=>c.jsx($t,{label:oe.label,type:oe.type,required:oe.required,options:oe.options,value:N[oe.name]||"",onChange:ce=>k(Z=>({...Z,[oe.name]:ce.target.value}))},oe.id)),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",children:a?"Save":"Create"})]})]})})},bu=({isOpen:e,isDeleting:t,onConfirm:r,onCancel:a,title:n,description:l="This action cannot be undone.",children:o})=>e?c.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[c.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"w-6 h-6 text-red-600 dark:text-red-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:n}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:l})]})]})}),c.jsx("div",{className:"p-6",children:o}),c.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-100 dark:border-gray-700 flex gap-3",children:[c.jsx(Le,{onClick:a,variant:"secondary",disabled:t,className:"flex-1",children:"Cancel"}),c.jsx(Le,{onClick:r,disabled:t,className:"flex-1 bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:t?c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Deleting..."]}):"Delete"})]})]})}):null;function Gl({title:e="No Events Yet",message:t="Create your first event to get started with planning your big day!",showButton:r=!0}){const a=_a(),{data:n=[]}=cg();return n.filter(o=>{var f;return!((f=o.raw)!=null&&f.isDeleted)}).length>0?null:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[c.jsx("div",{className:"h-20 w-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-900/30 dark:to-purple-900/30 grid place-items-center",children:c.jsx(O0,{className:"h-10 w-10 text-indigo-600 dark:text-indigo-400"})}),c.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:e}),c.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:t}),r&&c.jsxs(Le,{onClick:()=>a("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[c.jsx(O0,{className:"h-5 w-5"}),"Create Your First Event"]})]})})}function LI(){const{eventId:e}=Yr(),{data:t=[],isLoading:r,isError:a}=jI(e),n=Qg(e),l=Zg(e),o=DI(e),{user:f}=cu(),d=(f==null?void 0:f.id)??(f==null?void 0:f.name)??"System",x=bt(),[m,p]=C.useState({open:!1}),[v,y]=C.useState({open:!1,rsvp:null}),b=C.useRef(null),[S,E]=C.useState("All"),[_,N]=C.useState(""),[k,R]=C.useState("list");if(!e)return c.jsx(Gl,{title:"No Events to Manage RSVPs",message:"Create your first event to start managing guest responses and invitations."});if(r)return c.jsx(Ka,{message:"Loading RSVPs..."});if(a)return c.jsx("p",{children:"Failed to load RSVPs."});const A=ee=>{y({open:!0,rsvp:ee})},D=()=>{y({open:!1,rsvp:null})},T=async()=>{if(v.rsvp)try{await o.mutateAsync({rsvpGuid:v.rsvp.rsvpGuid??v.rsvp.rsvpId??v.rsvp.id,eventId:e}),y({open:!1,rsvp:null})}catch(ee){console.error("Failed to delete RSVP:",ee)}},O=t.filter(ee=>{const oe=S==="All"||ee.guestType===S,ce=(ee.guestName??"").toLowerCase().includes(_.toLowerCase());return oe&&ce}),F=t.reduce((ee,oe)=>(ee.total+=1,oe.status==="Yes"&&(ee.yes+=1),oe.status==="No"&&(ee.no+=1),oe.status==="Maybe"&&(ee.maybe+=1),oe.guestType==="VIP"&&(ee.vip+=1),ee),{total:0,yes:0,no:0,maybe:0,vip:0}),q=()=>{const ee=t.map(({eventId:ie,...ke})=>ke),oe=$f.json_to_sheet(ee),ce=$f.book_new();$f.book_append_sheet(ce,oe,"RSVPs");const Z=G_(ce,{bookType:"xlsx",type:"array"});IP.saveAs(new Blob([Z]),"rsvps.xlsx")},X=()=>{var ee;return(ee=b.current)==null?void 0:ee.click()},U=async ee=>{var Z;const oe=(Z=ee.target.files)==null?void 0:Z[0];if(!oe)return;const ce=new FileReader;ce.onload=async ie=>{var ke;try{const re=(ke=ie.target)==null?void 0:ke.result;if(!re)throw new Error("Empty file");const z=Up(re,{type:"array"}),te=z.Sheets[z.SheetNames[0]],B=$f.sheet_to_json(te,{header:1,defval:""}),I=B[0].map(W=>W.trim().toLowerCase().replace(/\s+/g,""));let M=0;for(const W of B.slice(1)){const ne=Object.fromEntries(W.map((Se,Ne)=>[I[Ne],String(Se)])),ye={guestName:ne.guestname||"",status:ne.status||"Yes",guestType:ne.guesttype||"Other"},be=t.find(Se=>Se.name===ye.guestName);if(be){const Se=be.rsvpGuid??be.rsvpId??be.id;await l.mutateAsync({rsvpGuid:Se,...ye,updatedBy:d})}else await n.mutateAsync(ye);M++}Ya.success(`Imported ${M} rows`)}catch(re){console.error(re);const z=re instanceof Error?re.message:"Import failed";Ya.error(z)}finally{b.current&&(b.current.value="")}},ce.onerror=()=>Ya.error("File read error"),ce.readAsArrayBuffer(oe)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[c.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"Total guests"}),c.jsx("p",{className:"text-xl font-semibold text-primary",children:F.total})]}),c.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"Yes"}),c.jsx("p",{className:"text-xl font-semibold text-green-600",children:F.yes})]}),c.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"Maybe"}),c.jsx("p",{className:"text-xl font-semibold text-yellow-600",children:F.maybe})]}),c.jsxs("div",{className:"p-3 rounded-lg bg-white shadow border border-gray-100",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"VIPs"}),c.jsx("p",{className:"text-xl font-semibold text-purple-600",children:F.vip})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"RSVPs"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(wl,{to:"/app/rsvps/designer",children:c.jsx(Le,{variant:"secondary",children:"Design RSVP Card"})}),c.jsx(Le,{onClick:()=>p({open:!0}),children:"+ New RSVP"}),c.jsxs(Le,{disabled:!0,variant:"secondary",onClick:X,children:["Import CSV/XLSX",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),c.jsxs(Le,{disabled:!0,variant:"secondary",onClick:q,children:["Export Excel",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]})]})]}),c.jsx("input",{ref:b,type:"file",accept:".csv,.xlsx",className:"hidden",onChange:U}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[c.jsx("select",{value:S,onChange:ee=>E(ee.target.value),className:"w-full md:w-1/4 border rounded p-2",children:["All","Family","VIP","Friend","Other"].map(ee=>c.jsx("option",{value:ee,children:ee},ee))}),c.jsx("input",{type:"text",placeholder:"Search Guests",value:_,onChange:ee=>N(ee.target.value),className:"w-full md:flex-1 border rounded p-2"}),c.jsxs("div",{className:"flex space-x-2 md:ml-auto",children:[c.jsx(Le,{variant:k==="list"?"primary":"secondary",onClick:()=>R("list"),"aria-label":"List view",children:c.jsx(TA,{className:"h-5 w-5"})}),c.jsx(Le,{variant:k==="grid"?"primary":"secondary",onClick:()=>R("grid"),"aria-label":"Grid view",children:c.jsx(_A,{className:"h-5 w-5"})})]})]}),k==="grid"&&c.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:O.map(ee=>{const oe=ee.noOfPax??0,ce=oe>0?"Yes":"No",Z=oe>0?"bg-green-600 text-white":"bg-red-600 text-white",ie=oe>0?"bg-green-50":"bg-red-50";return c.jsxs("li",{className:`
                  relative p-4 rounded-lg shadow flex flex-col justify-between
                  ${ie}
                `,children:[c.jsx("span",{role:"status","aria-label":`RSVP status: ${ce}`,className:`absolute top-2 right-2 inline-block px-2 py-0.5 rounded-full text-xs font-semibold ${Z}`,children:ce}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-xl font-semibold",children:ee.guestName}),ee.phoneNo&&c.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",ee.phoneNo]}),ee.noOfPax!==void 0&&ee.noOfPax!==null&&c.jsxs("p",{className:"text-sm text-gray-600",children:["Pax: ",ee.noOfPax]})]}),c.jsxs("div",{className:"mt-4 flex space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>p({open:!0,rsvp:ee}),children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:()=>A(ee),children:"Delete"})]})]},ee.id)})}),k==="list"&&c.jsx("ul",{className:"space-y-2",children:O.map(ee=>{const ce=(ee.noOfPax??0)>0?"bg-green-50":"bg-red-50";return c.jsxs("li",{className:`flex items-center justify-between p-4 rounded shadow ${ce}`,children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium",children:ee.guestName}),c.jsxs("p",{className:"text-sm text-gray-600",style:{display:"none"},children:[c.jsxs("span",{className:"mr-2",children:["Status: ",ee.status]}),c.jsxs("span",{children:["Type: ",ee.guestType]})]}),ee.phoneNo&&c.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",ee.phoneNo]}),ee.noOfPax!==void 0&&ee.noOfPax!==null&&c.jsxs("p",{className:"text-sm text-gray-600",children:["Pax: ",ee.noOfPax]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>p({open:!0,rsvp:ee}),children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:()=>A(ee),children:"Delete"})]})]},ee.id)})}),c.jsx(e1,{isOpen:m.open,onClose:()=>p({open:!1}),initial:m.rsvp,eventId:e,onSave:async(ee,oe)=>{try{if(oe){const ce=oe;await l.mutateAsync({rsvpGuid:ce,...ee})}else await n.mutateAsync(ee);x.invalidateQueries({queryKey:["rsvps",e]})}catch(ce){console.error("RSVP save error",ce)}finally{p({open:!1})}}}),c.jsx(bu,{isOpen:v.open,isDeleting:o.isPending,onConfirm:T,onCancel:D,title:"Delete RSVP?",description:"Are you sure you want to delete this RSVP? This will permanently remove it from your guest list.",children:v.rsvp&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:v.rsvp.guestName}),v.rsvp.phoneNo&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Phone: ",v.rsvp.phoneNo]}),v.rsvp.noOfPax!==void 0&&v.rsvp.noOfPax!==null&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Pax: ",v.rsvp.noOfPax]}),v.rsvp.guestType&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Type: ",v.rsvp.guestType]})]}),c.jsx("div",{className:"text-right",children:c.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${(v.rsvp.noOfPax??0)>0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:(v.rsvp.noOfPax??0)>0?"Yes":"No"})})]})})})]})}function BI(e,t){const r={id:e.id,type:e.type};if(e.background){const a={opacity:e.background.overlay??.4,color:"#0f172a"},n={images:e.background.images.map(l=>({id:l.id,src:l.src,alt:l.alt})),activeImageId:e.background.activeImageId,overlay:a};r.background=n}switch(e.sectionImage&&(r.sectionImage={id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}),e.type){case"headline":r.title=e.title,r.subtitle=e.subtitle,r.align=e.align,r.accentClass=e.accent,r.accentColor=t;break;case"text":r.body=e.body,r.width=e.width==="full"?100:50,r.align=e.align,r.muted=e.muted;break;case"info":r.label=e.label,r.content=e.content,r.accentClass=e.accent,r.accentColor=t;break;case"formField":if(r.label=e.label,r.placeholder=e.placeholder,r.required=e.required,r.width=e.width==="full"?100:50,r.hint=e.hint,e.questionId){r.questionId=e.questionId;const a=parseInt(e.questionId,10);r.formFieldId=isNaN(a)?void 0:a}break;case"cta":r.ctaLabel=e.label,r.href=e.href,r.align=e.align;break;case"image":r.images=e.images.map(a=>({id:a.id,src:a.src,alt:a.alt})),r.activeImageId=e.activeImageId,r.caption=e.caption,r.height=e.height;break;case"attendance":r.title=e.title,r.subtitle=e.subtitle,r.width=e.width==="half"?50:100;break;case"guestDetails":r.title=e.title,r.subtitle=e.subtitle,r.width=e.width==="half"?50:100,e.showFields&&(r.showFields={...e.showFields});break}return r}function PI(e){var n,l;const t=e.background?{images:e.background.images.map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.background.activeImageId,overlay:((n=e.background.overlay)==null?void 0:n.opacity)??.4}:{images:[],overlay:.4},r=e.sectionImage?{id:e.sectionImage.id,src:e.sectionImage.src,alt:e.sectionImage.alt}:null,a={id:e.id,background:t,sectionImage:r};switch(e.type){case"headline":return{...a,type:"headline",title:e.title??"",subtitle:e.subtitle,align:e.align??"center",accent:e.accentClass??"text-white"};case"text":return{...a,type:"text",body:e.body??"",width:e.width===50?"half":"full",align:e.align??"left",muted:e.muted};case"info":return{...a,type:"info",label:e.label??"",content:e.content??"",accent:e.accentClass??"bg-white/20 text-white"};case"formField":return{...a,type:"formField",label:e.label??"",placeholder:e.placeholder,required:e.required??!1,width:e.width===50?"half":"full",hint:e.hint,questionId:e.questionId??((l=e.formFieldId)==null?void 0:l.toString())};case"cta":return{...a,type:"cta",label:e.ctaLabel??e.label??"",href:e.href,align:e.align??"center"};case"image":return{...a,type:"image",images:(e.images??[]).map(o=>({id:o.id,src:o.src,alt:o.alt})),activeImageId:e.activeImageId,caption:e.caption,height:e.height??"medium"};case"attendance":return{...a,type:"attendance",title:e.title??"Will you be attending?",subtitle:e.subtitle,width:e.width===50?"half":"full"};case"guestDetails":return{...a,type:"guestDetails",title:e.title??"Your details",subtitle:e.subtitle,width:e.width===50?"half":"full",showFields:e.showFields??{name:!0,email:!0,phone:!0,pax:!0,guestType:!0}};default:return{...a,type:"text",body:"Unknown block type",width:"full",align:"left"}}}function II(e,t,r,a,n=!1,l=!0){return{eventId:t,design:{theme:{accentColor:e.accentColor,background:{type:e.globalBackgroundType,color:e.globalBackgroundColor,assetUrl:e.globalBackgroundAsset},overlayOpacity:e.globalOverlay,musicUrl:e.globalMusicUrl??void 0},layout:{width:1200,maxHeight:0},previewModes:["mobile","desktop"],blocks:e.blocks.map(o=>BI(o,e.accentColor)),flowPreset:e.flowPreset,formFieldConfigs:e.formFieldConfigs},isPublished:n,isDraft:l}}function Q_(e){const{design:t}=e,r="version"in e?e.version:void 0,a="shareToken"in e?e.shareToken:void 0,n="eventGuid"in e?e.eventGuid:void 0;return{blocks:t.blocks.map(PI),flowPreset:t.flowPreset??"serene",globalBackgroundType:t.theme.background.type??"color",globalBackgroundAsset:t.theme.background.assetUrl??"",globalBackgroundColor:t.theme.background.color??"#f6f1e4",globalOverlay:t.theme.overlayOpacity??.25,accentColor:t.theme.accentColor??"#f97316",globalMusicUrl:t.theme.musicUrl??void 0,eventGuid:n,version:r,shareToken:a??null,publicLink:null,formFieldConfigs:t.formFieldConfigs}}function UI(e){return Xr({queryKey:["rsvpDesign",e],queryFn:async()=>{var t,r;try{const a=await Ze.get(O4.get(e)),n=((t=a.data)==null?void 0:t.data)??a.data;return!n||!n.design?null:Q_(n)}catch(a){if(((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:5*6e4})}function zI(e){const t=bt();return kt({mutationFn:async({design:r,isPublished:a=!1,isDraft:n=!0,shareToken:l,publicLink:o})=>{const f=II(r,e,l,o,a,n);return(await Ze.post(O4.save(e),f)).data},onSuccess:()=>{t.invalidateQueries({queryKey:["rsvpDesign",e]}),t.refetchQueries({queryKey:["rsvpDesign",e]})}})}function HI({eventName:e,isLoadingDesign:t,isSaving:r,isSaveSuccess:a,eventId:n,publicLink:l,linkCopied:o,onSave:f,onPreview:d,onGenerateLink:x,onCopyLink:m}){return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"RSVP experience designer"}),c.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Design your wedding card"}),e&&c.jsxs("p",{className:"text-sm text-gray-500",children:["Event: ",c.jsx("span",{className:"font-semibold text-gray-700",children:e})]}),t&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-primary",children:[c.jsx(Un,{}),c.jsx("span",{children:"Loading saved design"})]}),a&&!r&&c.jsx("p",{className:"text-sm font-medium text-emerald-600",children:" Design saved"})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[c.jsx(wl,{to:"/app/rsvps",children:c.jsx(Le,{variant:"secondary",children:" Back"})}),c.jsx(Le,{variant:"secondary",onClick:d,children:"Preview"}),c.jsx(Le,{onClick:f,disabled:r||t||!n,children:r?"Saving":"Save Design"})]})]}),c.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-4 shadow-sm",children:[c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Share with guests"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Generate a unique link so guests can view the invitation and submit their RSVP."})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx(Le,{variant:"secondary",onClick:x,children:"Generate link"}),l&&c.jsx("a",{href:l,target:"_blank",rel:"noreferrer",className:"rounded-full border border-gray-200 bg-gray-50 px-4 py-2 text-sm font-semibold text-gray-700 hover:border-primary hover:text-primary",children:"Open as guest"})]})]}),l&&c.jsxs("div",{className:"mt-3 flex flex-col gap-2 rounded-xl border border-dashed border-gray-200 bg-gray-50 p-3 sm:flex-row sm:items-center",children:[c.jsx("input",{value:l,readOnly:!0,className:"flex-1 rounded-lg border px-3 py-2 text-sm text-gray-700 focus:outline-none"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Le,{variant:"secondary",onClick:m,children:o?"Copied!":"Copy link"}),o&&c.jsx("span",{className:"text-xs font-semibold text-emerald-600",children:"Ready to share"})]})]})]})]})}const Kw={headline:"Headline",text:"Paragraph",info:"Info badge",formField:"Form field",cta:"CTA button",image:"Image gallery",attendance:"Attendance",guestDetails:"Guest details"},GI={headline:"H",text:"T",info:"i",formField:"?",cta:"",image:"",attendance:"R",guestDetails:"U"};function VI({block:e,isSelected:t,accentColor:r,onSelect:a,onDragStart:n,onDragOver:l,onDragEnd:o}){var x,m,p,v,y;const f=((x=e.background)==null?void 0:x.images.find(b=>{var S;return b.id===((S=e.background)==null?void 0:S.activeImageId)}))??((p=(m=e.background)==null?void 0:m.images)==null?void 0:p[0]),d=((v=e.background)==null?void 0:v.images.length)??0;return c.jsxs("div",{draggable:!0,onDragStart:n,onDragOver:l,onDragEnd:o,className:`flex cursor-grab items-center gap-3 rounded-xl border px-3 py-2.5 transition active:cursor-grabbing ${t?"border-primary bg-primary/5 shadow-sm":"border-gray-200 bg-gray-50 hover:border-gray-300"}`,children:[c.jsx("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg text-sm font-bold text-white",style:{background:r},title:Kw[e.type],children:GI[e.type]}),c.jsxs("button",{type:"button",onClick:a,className:"min-w-0 flex-1 text-left",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-gray-800",children:[c.jsx("span",{className:"truncate",children:Kw[e.type]}),d>0&&c.jsxs("span",{className:"ml-2 flex-shrink-0 rounded-full bg-gray-200 px-1.5 py-0.5 text-[10px] text-gray-600",children:[d," bg"]})]}),e.type==="headline"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.title}),e.type==="text"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.body}),e.type==="info"&&c.jsxs("p",{className:"truncate text-xs text-gray-500",children:[e.label,": ",e.content]}),e.type==="formField"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.label}),e.type==="cta"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.label}),e.type==="image"&&((y=e.images)==null?void 0:y.length)>0&&c.jsxs("p",{className:"truncate text-xs text-gray-500",children:[e.images.length," image(s)"]}),e.type==="attendance"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.title||"Will you be attending?"}),e.type==="guestDetails"&&c.jsx("p",{className:"truncate text-xs text-gray-500",children:e.title||"Your details"})]}),f?c.jsx("img",{src:f.src,alt:f.alt??"",className:"h-12 w-12 flex-shrink-0 rounded-lg object-cover"}):c.jsx("div",{className:"flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-lg border border-dashed border-gray-300 text-xs text-gray-400",children:"BG"})]})}const qI=[{type:"headline",label:"Headline",desc:"Big title + subtitle",icon:"H"},{type:"text",label:"Paragraph",desc:"Body text section",icon:"T"},{type:"info",label:"Info badge",desc:"Label + content pill",icon:"i"},{type:"attendance",label:"Attendance",desc:"Yes/No/Maybe attendance toggle",icon:"R"},{type:"guestDetails",label:"Guest info",desc:"Name, email, phone, pax fields",icon:"U"},{type:"formField",label:"Form field",desc:"Custom question from Form Fields",icon:"?"},{type:"cta",label:"CTA button",desc:"Styled call-to-action button",icon:""},{type:"image",label:"Image",desc:"Photo or gallery block",icon:""}];function WI({onAdd:e,onUploadImages:t,availableQuestions:r,isFetchingQuestions:a,onInsertQuestion:n}){const[l,o]=C.useState(""),f=()=>{l&&(n(l),o(""))},d=a?"Loading questions...":r.length===0?"No RSVP questions for this event yet.":`${r.length} question(s) available`;return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Add block"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[qI.filter(x=>x.type!=="image").map(({type:x,label:m,desc:p,icon:v})=>c.jsxs("button",{type:"button",onClick:()=>e(x),title:p,className:"flex items-center gap-2 rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-left text-sm font-medium text-gray-700 transition hover:border-primary hover:bg-primary/5 hover:text-primary",children:[c.jsx("span",{className:"flex-shrink-0 text-base",children:v}),m]},x)),c.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm font-medium text-gray-700 transition hover:border-primary hover:bg-primary/5 hover:text-primary",title:"Upload images and create an image block",children:[c.jsx("span",{className:"flex-shrink-0 text-base",children:""}),"Upload image",c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:x=>x.target.files&&t(x.target.files)})]})]})]}),c.jsxs("div",{className:"rounded-xl border border-dashed border-gray-200 bg-gray-50 p-3 space-y-2",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Insert RSVP question"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("select",{value:l,onChange:x=>o(x.target.value),className:"flex-1 rounded-lg border px-2 py-2 text-sm focus:border-primary focus:outline-none",children:[c.jsx("option",{value:"",children:"Select a question"}),r.map(x=>c.jsx("option",{value:x.id??x.questionId,children:x.label||x.text||x.name},x.id??x.questionId))]}),c.jsx(Le,{disabled:!l,onClick:f,className:"flex-shrink-0",children:"Add"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:d})]})]})}function XI({blocks:e,selectedId:t,accentColor:r,formFields:a,isFetchingQuestions:n,onSelect:l,onReorder:o,onAdd:f,onUploadImages:d,onInsertQuestion:x}){const[m,p]=C.useState(null);return c.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-4 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-base font-bold text-gray-800",children:"Blocks"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Drag to reorder  Click to edit"})]}),c.jsx("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-xs font-semibold text-gray-500",children:e.length})]}),e.length===0?c.jsx("div",{className:"rounded-xl border border-dashed border-gray-200 py-8 text-center text-sm text-gray-400",children:"No blocks yet. Add one below."}):c.jsx("div",{className:"space-y-2",children:e.map(v=>c.jsx(VI,{block:v,isSelected:t===v.id,accentColor:r,onSelect:()=>l(v.id),onDragStart:y=>{p(v.id),y.dataTransfer.setData("text/plain",v.id)},onDragOver:y=>{y.preventDefault(),m&&m!==v.id&&o(m,v.id)},onDragEnd:()=>p(null)},v.id))}),c.jsx("div",{className:"border-t border-gray-100 pt-4",children:c.jsx(WI,{onAdd:f,onUploadImages:d,availableQuestions:a,isFetchingQuestions:n,onInsertQuestion:x})})]})}const Km=e=>e==="center"||e==="right"?e:"left",Qf=e=>e==="half"?"half":"full",Cn=({children:e})=>c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:e}),Xt=({label:e,children:t})=>c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs text-gray-500",children:e}),t]}),Yt="w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-primary focus:outline-none",YI={headline:"Headline",text:"Paragraph",info:"Info badge",formField:"Form field",cta:"CTA button",image:"Image gallery",attendance:"Attendance",guestDetails:"Guest details"};function $I({block:e,accentColor:t,formFields:r,onUpdate:a,onRemove:n,onAddBackgroundImages:l,onSetActiveBackground:o,onSetOverlay:f,onSetSectionImage:d,onClearSectionImage:x,onReplaceImage:m,onAppendImages:p,onApplyQuestion:v}){var S,E;if(!e)return c.jsxs("div",{className:"flex h-full flex-col items-center justify-center rounded-xl border border-dashed border-gray-200 bg-gray-50 p-8 text-center text-gray-500",children:[c.jsx("div",{className:"mb-3 flex h-12 w-12 items-center justify-center rounded-full border border-dashed border-gray-300 text-xl",children:""}),c.jsx("p",{className:"text-base font-semibold text-gray-700",children:"Select a block to edit"}),c.jsx("p",{className:"mt-1 text-sm",children:"Choose a block from the list on the left to edit its content, backgrounds, and settings."})]});const y=((S=e.background)==null?void 0:S.images)??[],b=((E=e.background)==null?void 0:E.overlay)??.4;return c.jsxs("div",{className:"space-y-4 rounded-xl border border-gray-200 bg-white p-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Editing block"}),c.jsx("h3",{className:"text-base font-bold text-gray-800",children:YI[e.type]??e.type})]}),c.jsx("button",{type:"button",onClick:()=>n(e.id),className:"rounded-lg border border-rose-100 bg-rose-50 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:bg-rose-100",children:"Remove block"})]}),c.jsxs("div",{className:"space-y-2 rounded-lg border border-gray-100 bg-gray-50 p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Cn,{children:"Block background gallery"}),c.jsxs("span",{className:"text-xs text-gray-400",children:[y.length," image(s)"]})]}),c.jsxs("label",{className:"block cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary",children:["+ Upload background images",c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_=>_.target.files&&l(e.id,_.target.files)})]}),y.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:y.map(_=>{var N;return c.jsx("button",{type:"button",onClick:()=>o(e.id,_.id),className:`h-16 w-20 flex-shrink-0 overflow-hidden rounded-lg border-2 transition ${((N=e.background)==null?void 0:N.activeImageId)===_.id?"border-primary shadow-md":"border-transparent hover:border-gray-300"}`,children:c.jsx("img",{src:_.src,alt:_.alt??"",className:"h-full w-full object-cover"})},_.id)})}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[c.jsx("span",{children:"Overlay strength"}),c.jsxs("span",{children:[Math.round(b*100),"%"]})]}),c.jsx("input",{type:"range",min:0,max:.9,step:.05,value:b,onChange:_=>f(e.id,parseFloat(_.target.value)),className:"w-full accent-primary"})]})]})]}),c.jsxs("div",{className:"space-y-2 rounded-lg border border-gray-100 bg-white p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Cn,{children:"Section spotlight image"}),e.sectionImage&&c.jsx("button",{type:"button",onClick:()=>x(e.id),className:"text-xs font-semibold text-rose-600",children:"Remove"})]}),c.jsx("p",{className:"text-xs text-gray-400",children:"A dedicated backdrop just for this block  ideal for hero moments."}),c.jsxs("label",{className:"block cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary",children:[e.sectionImage?"Replace spotlight image":"+ Set spotlight image",c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_=>{var N;return((N=_.target.files)==null?void 0:N[0])&&d(e.id,_.target.files[0])}})]}),e.sectionImage&&c.jsx("div",{className:"overflow-hidden rounded-lg border",children:c.jsx("img",{src:e.sectionImage.src,alt:e.sectionImage.alt??"",className:"h-32 w-full object-cover"})})]}),e.type==="headline"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Headline content"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title,onChange:_=>a(e.id,{title:_.target.value}),className:Yt,placeholder:"Welcome to our wedding"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:_=>a(e.id,{subtitle:_.target.value}),className:Yt,placeholder:"Save the date"})}),c.jsx(Xt,{label:"Text alignment",children:c.jsxs("select",{value:e.align,onChange:_=>a(e.id,{align:Km(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})}),c.jsx(Xt,{label:"Accent CSS classes",children:c.jsx("input",{value:e.accent,onChange:_=>a(e.id,{accent:_.target.value}),className:Yt,placeholder:"text-white"})})]})]}),e.type==="text"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Paragraph content"}),c.jsx(Xt,{label:"Body text",children:c.jsx("textarea",{value:e.body,onChange:_=>a(e.id,{body:_.target.value}),className:Yt,rows:4,placeholder:"Tell your story"})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width,onChange:_=>a(e.id,{width:Qf(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})}),c.jsx(Xt,{label:"Alignment",children:c.jsxs("select",{value:e.align,onChange:_=>a(e.id,{align:Km(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})})]}),c.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:!!e.muted,onChange:_=>a(e.id,{muted:_.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-primary"}),c.jsx("span",{className:"text-sm text-gray-600",children:"Use softer / muted text tone"})]})]}),e.type==="info"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Info badge content"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Label",children:c.jsx("input",{value:e.label,onChange:_=>a(e.id,{label:_.target.value}),className:Yt,placeholder:"Date"})}),c.jsx(Xt,{label:"Content",children:c.jsx("input",{value:e.content,onChange:_=>a(e.id,{content:_.target.value}),className:Yt,placeholder:"Saturday, 15 March 2025"})})]}),c.jsx(Xt,{label:"Accent CSS classes",children:c.jsx("input",{value:e.accent,onChange:_=>a(e.id,{accent:_.target.value}),className:Yt,placeholder:"bg-white/20 text-white border border-white/30"})})]}),e.type==="formField"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Form field settings"}),c.jsxs(Xt,{label:"Link to RSVP question",children:[c.jsxs("select",{value:e.questionId??"",onChange:_=>v(e.id,_.target.value||void 0),className:Yt,children:[c.jsx("option",{value:"",children:" Choose a question "}),r.map(_=>c.jsxs("option",{value:_.id??_.questionId,children:[_.label||_.text||_.name,_.isRequired?" *":"",_.typeKey?` (${_.typeKey})`:""]},_.id??_.questionId))]}),e.questionId&&c.jsx("p",{className:"mt-1 text-xs text-emerald-600",children:" Linked  input type comes from the question definition."}),!e.questionId&&c.jsx("p",{className:"mt-1 text-xs text-amber-600",children:"Select a question to enable this field for guests."})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Label override",children:c.jsx("input",{value:e.label,onChange:_=>a(e.id,{label:_.target.value}),className:Yt,placeholder:"Leave blank to use question label"})}),c.jsx(Xt,{label:"Placeholder",children:c.jsx("input",{value:e.placeholder??"",onChange:_=>a(e.id,{placeholder:_.target.value}),className:Yt})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width,onChange:_=>a(e.id,{width:Qf(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})}),c.jsx(Xt,{label:"Required",children:c.jsxs("select",{value:e.required?"yes":"no",onChange:_=>a(e.id,{required:_.target.value==="yes"}),className:Yt,children:[c.jsx("option",{value:"yes",children:"Required"}),c.jsx("option",{value:"no",children:"Optional"})]})})]}),c.jsx(Xt,{label:"Hint text (shown under field)",children:c.jsx("input",{value:e.hint??"",onChange:_=>a(e.id,{hint:_.target.value}),className:Yt,placeholder:"e.g. Dietary restrictions or special requests"})})]}),e.type==="cta"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"CTA button"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Button label",children:c.jsx("input",{value:e.label,onChange:_=>a(e.id,{label:_.target.value}),className:Yt,placeholder:"Open RSVP"})}),c.jsx(Xt,{label:"Link / URL (optional)",children:c.jsx("input",{value:e.href??"",onChange:_=>a(e.id,{href:_.target.value}),className:Yt,placeholder:"https://"})}),c.jsx(Xt,{label:"Alignment",children:c.jsxs("select",{value:e.align,onChange:_=>a(e.id,{align:Km(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"left",children:"Left"}),c.jsx("option",{value:"center",children:"Center"}),c.jsx("option",{value:"right",children:"Right"})]})})]}),c.jsx("div",{className:"mt-2 inline-flex items-center rounded-full px-4 py-2 text-sm font-semibold shadow",style:{background:t,color:"#0f172a"},children:e.label||"Preview button"})]}),e.type==="attendance"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Attendance settings"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title??"",onChange:_=>a(e.id,{title:_.target.value}),className:Yt,placeholder:"Will you be attending?"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:_=>a(e.id,{subtitle:_.target.value}),className:Yt,placeholder:"Please let us know"})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width??"full",onChange:_=>a(e.id,{width:Qf(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})})]})]}),e.type==="guestDetails"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Guest details settings"}),c.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[c.jsx(Xt,{label:"Title",children:c.jsx("input",{value:e.title??"",onChange:_=>a(e.id,{title:_.target.value}),className:Yt,placeholder:"Your details"})}),c.jsx(Xt,{label:"Subtitle (optional)",children:c.jsx("input",{value:e.subtitle??"",onChange:_=>a(e.id,{subtitle:_.target.value}),className:Yt,placeholder:"Tell us about yourself"})}),c.jsx(Xt,{label:"Width",children:c.jsxs("select",{value:e.width??"full",onChange:_=>a(e.id,{width:Qf(_.target.value)}),className:Yt,children:[c.jsx("option",{value:"full",children:"Full width"}),c.jsx("option",{value:"half",children:"Half width"})]})})]}),c.jsx(Cn,{children:"Visible fields"}),c.jsx("div",{className:"space-y-2",children:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phone",label:"Phone number"},{key:"pax",label:"Number of guests"},{key:"guestType",label:"Guest type (Family/Friend/VIP)"}].map(({key:_,label:N})=>{var k;return c.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:((k=e.showFields)==null?void 0:k[_])!==!1,onChange:R=>a(e.id,{showFields:{...e.showFields,[_]:R.target.checked}}),className:"h-4 w-4 rounded border-gray-300 text-primary"}),c.jsx("span",{className:"text-sm text-gray-600",children:N})]},_)})})]}),e.type==="image"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx(Cn,{children:"Image gallery"}),c.jsx(Xt,{label:"Caption (optional)",children:c.jsx("input",{value:e.caption??"",onChange:_=>a(e.id,{caption:_.target.value}),className:Yt,placeholder:"A blessed moment"})}),c.jsx(Xt,{label:"Block height",children:c.jsxs("select",{value:e.height??"medium",onChange:_=>a(e.id,{height:_.target.value==="tall"?"tall":_.target.value==="short"?"short":"medium"}),className:Yt,children:[c.jsx("option",{value:"short",children:"Compact"}),c.jsx("option",{value:"medium",children:"Standard"}),c.jsx("option",{value:"tall",children:"Tall"})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("label",{className:"cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary",children:["Replace first image",c.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_=>{var N;return((N=_.target.files)==null?void 0:N[0])&&m(e.id,_.target.files[0])}})]}),c.jsxs("label",{className:"cursor-pointer rounded-lg border border-dashed border-gray-300 px-3 py-2 text-center text-xs text-primary hover:border-primary",children:["Add more images",c.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:_=>_.target.files&&p(e.id,_.target.files)})]})]}),e.images.length>0&&c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1",children:e.images.map(_=>c.jsx("button",{type:"button",onClick:()=>a(e.id,{activeImageId:_.id}),className:`h-16 w-20 flex-shrink-0 overflow-hidden rounded-lg border-2 transition ${e.activeImageId===_.id?"border-primary shadow":"border-transparent hover:border-gray-300"}`,children:c.jsx("img",{src:_.src,alt:_.alt??"",className:"h-full w-full object-cover"})},_.id))}),e.images.length===0&&c.jsx("p",{className:"text-xs text-gray-400",children:"No images uploaded yet. Use the buttons above to add photos."})]})]})}const KI=[{value:"serene",label:"Serene",desc:"Gentle blur, subtle lift on hover"},{value:"parallax",label:"Parallax",desc:"Backgrounds scroll at fixed depth"},{value:"stacked",label:"Stacked",desc:"Snap-scroll between sections"}];function QI({globalBackgroundType:e,globalBackgroundColor:t,globalOverlay:r,accentColor:a,flowPreset:n,globalMusicUrl:l,onChange:o,onUploadBackground:f,hasBackgroundAsset:d}){return c.jsxs("div",{className:"space-y-5 rounded-xl border border-gray-200 p-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Global background"}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:["color","image","video"].map(x=>c.jsx("button",{type:"button",onClick:()=>o({globalBackgroundType:x}),className:`rounded-lg border py-2 text-xs font-semibold uppercase tracking-wide transition ${e===x?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-600 hover:border-gray-300"}`,children:x},x))}),e==="color"&&c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs text-gray-500",children:"Background color"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"color",value:t,onChange:x=>o({globalBackgroundColor:x.target.value}),className:"h-9 w-16 cursor-pointer rounded border p-0.5"}),c.jsx("span",{className:"text-xs font-mono text-gray-500",children:t})]})]}),(e==="image"||e==="video")&&c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs text-gray-500",children:e==="video"?"Upload video":"Upload image"}),c.jsx("input",{type:"file",accept:e==="video"?"video/*":"image/*",onChange:x=>{var m;return((m=x.target.files)==null?void 0:m[0])&&f(x.target.files[0])},className:"w-full text-xs text-gray-600"}),d&&c.jsxs("p",{className:"text-xs font-medium text-emerald-600",children:[" ",e==="video"?"Video":"Image"," attached"]})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Dark overlay"}),c.jsxs("span",{className:"text-xs text-gray-400",children:[Math.round(r*100),"%"]})]}),c.jsx("input",{type:"range",min:0,max:.9,step:.05,value:r,onChange:x=>o({globalOverlay:parseFloat(x.target.value)}),className:"w-full accent-primary"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Keeps text readable over photos/videos."})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Accent color"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"color",value:a,onChange:x=>o({accentColor:x.target.value}),className:"h-9 w-16 cursor-pointer rounded border p-0.5"}),c.jsx("span",{className:"text-xs font-mono text-gray-500",children:a})]}),c.jsx("p",{className:"text-xs text-gray-400",children:"Used for buttons, badges, and highlights."})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Ambient music URL"}),c.jsx("input",{type:"url",value:l,onChange:x=>o({globalMusicUrl:x.target.value}),className:"w-full rounded-lg border px-3 py-2 text-sm focus:border-primary focus:outline-none",placeholder:"https://example.com/music.mp3"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Paste a direct link to an .mp3 or .ogg file. Guests see a floating play button."})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Scroll style"}),c.jsx("div",{className:"space-y-1.5",children:KI.map(({value:x,label:m,desc:p})=>c.jsxs("button",{type:"button",onClick:()=>o({flowPreset:x}),className:`w-full rounded-lg border px-3 py-2 text-left transition ${n===x?"border-primary bg-primary/5 text-primary":"border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[c.jsx("p",{className:"text-sm font-semibold",children:m}),c.jsx("p",{className:"text-xs opacity-70",children:p})]},x))})]})]})}const ks=()=>Math.random().toString(36).slice(2,9);function Z_(e,t){switch(e.type){case"headline":return c.jsxs("div",{className:`text-${e.align}`,children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/70",children:"Welcome"}),c.jsx("h2",{className:`mt-0.5 text-2xl font-extrabold text-white drop-shadow ${e.accent}`,children:e.title}),e.subtitle&&c.jsx("p",{className:"mt-1 text-xs text-white/75",children:e.subtitle})]});case"text":return c.jsx("p",{className:`text-sm leading-relaxed ${e.muted?"text-white/75":"text-white"}`,children:e.body});case"info":return c.jsxs("div",{className:`inline-flex items-center gap-2 rounded-full px-4 py-1.5 text-xs ${e.accent}`,children:[c.jsx("span",{className:"font-semibold uppercase tracking-wide",children:e.label}),c.jsx("span",{className:"text-white/80",children:e.content})]});case"formField":return c.jsxs("div",{className:e.width==="half"?"md:max-w-[50%]":"w-full",children:[c.jsxs("label",{className:"mb-1 block text-xs font-semibold text-white",children:[e.label,e.required&&c.jsx("span",{className:"ml-1 text-rose-300",children:"*"})]}),c.jsx("div",{className:"rounded-lg border border-white/30 bg-white/20 px-3 py-2 text-xs text-white/80",children:e.placeholder||"Guest response here"}),e.hint&&c.jsx("p",{className:"mt-1 text-[10px] text-white/60",children:e.hint})]});case"cta":return c.jsx("div",{className:`flex ${e.align==="center"?"justify-center":e.align==="right"?"justify-end":"justify-start"}`,children:c.jsx("button",{className:"rounded-full px-5 py-2 text-xs font-semibold shadow",style:{background:t,color:"#0f172a"},children:e.label})});case"image":{const r=e.images.find(n=>n.id===e.activeImageId)??e.images[0],a=e.height==="tall"?"h-56":e.height==="short"?"h-32":"h-44";return c.jsxs("div",{className:`overflow-hidden rounded-xl border border-white/15 bg-white/5 ${a}`,children:[r?c.jsx("img",{src:r.src,alt:r.alt??"",className:"h-full w-full object-cover",loading:"lazy"}):c.jsx("div",{className:"flex h-full items-center justify-center text-xs text-white/50",children:"Upload images to display"}),e.caption&&c.jsx("div",{className:"bg-black/35 px-3 py-1.5 text-[10px] text-white/75",children:e.caption})]})}case"attendance":return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-white",children:e.title||"Will you be attending?"}),e.subtitle&&c.jsx("p",{className:"text-[10px] text-white/60",children:e.subtitle}),c.jsx("div",{className:"flex gap-1.5",children:["Yes","No","Maybe"].map(r=>c.jsx("span",{className:"rounded-lg border border-white/20 bg-white/10 px-3 py-1 text-[10px] text-white/80",children:r},r))})]});case"guestDetails":{const r=e.showFields??{name:!0,email:!0,phone:!0,pax:!0,guestType:!0},a=Object.entries(r).filter(([,n])=>n!==!1).map(([n])=>n);return c.jsxs("div",{className:"space-y-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-white",children:e.title||"Your details"}),e.subtitle&&c.jsx("p",{className:"text-[10px] text-white/60",children:e.subtitle}),c.jsx("div",{className:"flex flex-wrap gap-1",children:a.map(n=>c.jsx("span",{className:"rounded-md bg-white/10 px-2 py-0.5 text-[10px] text-white/70 capitalize",children:n},n))})]})}default:return null}}function ZI({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,mode:o,flowPreset:f="serene"}){return c.jsxs("div",{className:`relative overflow-hidden rounded-[28px] border border-white/25 shadow-2xl bg-gradient-to-b from-slate-900 to-black ${o==="mobile"?"w-[360px] max-w-full":"w-full"}`,children:[c.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&c.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${n})`}})]}),c.jsxs("div",{className:"relative z-10 flex items-center justify-between px-4 py-2.5 text-[10px] uppercase tracking-[0.2em] text-white/70 bg-black/20 backdrop-blur-sm",children:[c.jsx("span",{children:o==="mobile"?"Mobile":"Desktop"}),c.jsx("span",{children:"RSVP preview"})]}),c.jsx("div",{className:"relative z-10 overflow-auto px-3 pb-5 pt-3",style:{maxHeight:o==="mobile"?600:700},children:c.jsx("div",{className:`space-y-3 ${f==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:e.map((d,x)=>{var y,b;const m=((y=d.background)==null?void 0:y.images)??[],p=((b=d.background)==null?void 0:b.overlay)??.35,v=m.find(S=>{var E;return S.id===((E=d.background)==null?void 0:E.activeImageId)})??m[0]??d.sectionImage;return c.jsxs("div",{className:`relative overflow-hidden rounded-2xl border border-white/10 bg-white/5 p-3.5 transition duration-300 ${f==="stacked"?"scroll-snap-start":""} ${f==="serene"?"backdrop-blur":""}`,style:{backgroundImage:v?`linear-gradient(rgba(15,23,42,${p}),rgba(15,23,42,${p})),url(${v.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:f==="parallax"?"fixed":"scroll",transitionDelay:`${x*25}ms`},children:[c.jsxs("div",{className:"mb-1.5 flex items-center gap-1.5 text-[10px] uppercase text-white/60",children:[c.jsx("span",{className:"h-1.5 w-1.5 rounded-full",style:{background:l}}),d.type]}),c.jsx("div",{className:"text-white",children:Z_(d,l)})]},d.id)})})})]})}function JI({blocks:e,backgroundColor:t,backgroundAsset:r,backgroundType:a,overlay:n,accentColor:l,flowPreset:o="serene"}){return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-white",children:[c.jsxs("div",{className:"absolute inset-0","aria-hidden":!0,children:[a==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t}}),a==="image"&&r&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${r})`}}),a==="video"&&r&&c.jsx("video",{className:"h-full w-full object-cover",src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${n})`}})]}),c.jsx("div",{className:`relative mx-auto flex max-w-5xl flex-col gap-6 px-4 py-12 ${o==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:e.map((f,d)=>{var y,b;const x=((y=f.background)==null?void 0:y.images)??[],m=x.find(S=>{var E;return S.id===((E=f.background)==null?void 0:E.activeImageId)})??x[0]??f.sectionImage,p=((b=f.background)==null?void 0:b.overlay)??.35,v=o==="serene"?"hover:-translate-y-1":"hover:-translate-y-2";return c.jsxs("section",{className:`group relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6 shadow-2xl ring-1 ring-white/5 transition duration-500 ${o==="stacked"?"scroll-snap-start":""} ${v}`,style:{backgroundImage:m?`linear-gradient(rgba(15,23,42,${p}),rgba(15,23,42,${p})),url(${m.src})`:void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:o==="parallax"?"fixed":"scroll"},children:[c.jsxs("div",{className:"mb-2 flex items-center justify-between text-[11px] uppercase tracking-[0.15em] text-white/60",children:[c.jsxs("span",{className:"inline-flex items-center gap-2",children:[c.jsx("span",{className:"h-2 w-2 rounded-full",style:{background:l}}),f.type]}),c.jsxs("span",{className:"rounded-full bg-black/25 px-2 py-0.5 text-[10px]",children:["Scene ",d+1]})]}),c.jsx("div",{className:"space-y-3 text-white",children:Z_(f,l)})]},f.id)})})]})}function eU(){const{event:e,eventId:t}=Yr()??{},{data:r=[],isFetching:a}=Jg(t,{enabled:!!t}),{data:n,isLoading:l}=UI(t??""),{mutate:o,isPending:f,isSuccess:d,data:x}=zI(t??""),[m,p]=C.useState(!1),[v,y]=C.useState([{id:ks(),type:"headline",title:"Welcome to our wedding",subtitle:"Save the date and RSVP below",align:"center",accent:"text-white",background:{images:[],overlay:.4}},{id:ks(),type:"text",body:"Share your love story, travel tips, or invite message. Guests will scroll through each image-backed section just like an interactive invitation card.",width:"full",align:"left",muted:!0,background:{images:[],overlay:.4}},{id:ks(),type:"attendance",title:"Will you be attending?",subtitle:"Please let us know",background:{images:[],overlay:.4}},{id:ks(),type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,email:!0,phone:!0,pax:!0,guestType:!0},background:{images:[],overlay:.4}}]),[b,S]=C.useState(null),[E,_]=C.useState("color"),[N,k]=C.useState(""),[R,A]=C.useState("#f6f1e4"),[D,T]=C.useState(.25),[O,F]=C.useState("#f97316"),[q,X]=C.useState("serene"),[U,ee]=C.useState(""),[oe,ce]=C.useState(!1),[Z,ie]=C.useState("mobile"),[ke,re]=C.useState(null),[z,te]=C.useState(null),[B,I]=C.useState(!1),[M,W]=C.useState(void 0),ne=C.useRef([]),ye=C.useMemo(()=>r.slice().sort((De,Re)=>(De.order??0)-(Re.order??0)),[r]),be=C.useMemo(()=>v.find(De=>De.id===b)??null,[v,b]);C.useEffect(()=>()=>ne.current.forEach(De=>URL.revokeObjectURL(De)),[]),C.useEffect(()=>{var De;((De=x==null?void 0:x.data)==null?void 0:De.version)!==void 0&&W(x.data.version)},[x]),C.useEffect(()=>{var De;!n||m||((De=n.blocks)!=null&&De.length&&y(n.blocks),n.globalBackgroundType&&_(n.globalBackgroundType),n.globalBackgroundAsset&&k(n.globalBackgroundAsset),n.globalBackgroundColor&&A(n.globalBackgroundColor),n.globalOverlay!==void 0&&T(n.globalOverlay),n.accentColor&&F(n.accentColor),n.flowPreset&&X(n.flowPreset),n.globalMusicUrl&&ee(n.globalMusicUrl),n.version!==void 0&&W(n.version),n.shareToken&&(te(n.shareToken),re(`${window.location.origin}/rsvp/submit/${n.shareToken}`)),p(!0))},[n,m]),C.useEffect(()=>{z&&Ne(z)},[z,v,N,R,E,D,O,q,U]);const Se=De=>{const Re=URL.createObjectURL(De);return ne.current.push(Re),{id:ks(),src:Re,alt:De.name}},Ne=De=>{typeof window>"u"||window.localStorage.setItem(`rsvp-share-${De}`,JSON.stringify({eventTitle:(e==null?void 0:e.title)??"RSVP invite",eventGuid:t??void 0,blocks:v,flowPreset:q,global:{backgroundColor:R,backgroundType:E,backgroundAsset:N,overlay:D,accentColor:O,musicUrl:U||void 0},formFieldConfigs:ye}))},Xe=De=>{const Re=ks(),xe={headline:{id:Re,type:"headline",title:"Custom headline",subtitle:"Add a subheader",align:"center",accent:"text-white",background:{images:[],overlay:.4}},text:{id:Re,type:"text",body:"Tell your guests what to expect.",width:"full",align:"left",muted:!1,background:{images:[],overlay:.4}},info:{id:Re,type:"info",label:"Highlight",content:"Dress code, parking, or venue info",accent:"bg-white/20 text-white border border-white/30",background:{images:[],overlay:.4}},attendance:{id:Re,type:"attendance",title:"Will you be attending?",subtitle:"Please let us know",background:{images:[],overlay:.4}},guestDetails:{id:Re,type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,email:!0,phone:!0,pax:!0,guestType:!0},background:{images:[],overlay:.4}},formField:{id:Re,type:"formField",label:"Custom field",placeholder:"Placeholder",required:!1,width:"full",background:{images:[],overlay:.4}},cta:{id:Re,type:"cta",label:"Open RSVP",href:"#",align:"center",background:{images:[],overlay:.4}},image:{id:Re,type:"image",images:[],activeImageId:void 0,caption:"Add captions",height:"medium",background:{images:[],overlay:.4}}};y(Be=>[...Be,xe[De]]),S(Re)},V=(De,Re)=>y(xe=>xe.map(Be=>Be.id===De?{...Be,...Re}:Be)),We=De=>{y(Re=>Re.filter(xe=>xe.id!==De)),b===De&&S(null)},$e=(De,Re)=>{const xe=v.findIndex(Dr=>Dr.id===De),Be=v.findIndex(Dr=>Dr.id===Re);if(xe===-1||Be===-1||xe===Be)return;const He=[...v],[Kt]=He.splice(xe,1);He.splice(Be,0,Kt),y(He)},dt=De=>{if(!De)return;const Re=ye.find(xe=>(xe.id??xe.questionId)===De);Re&&y(xe=>{if(xe.some(Kt=>Kt.type==="formField"&&Kt.questionId===De))return xe;const Be=ks(),He={id:Be,type:"formField",label:Re.label||Re.text||"Custom field",placeholder:Array.isArray(Re.options)?String(Re.options[0]??""):"",required:Re.isRequired??!1,width:"full",hint:Re.typeKey?`${Re.typeKey}${Re.isRequired?"  required":""}`:void 0,questionId:Re.id??Re.questionId,background:{images:[],overlay:.4}};return S(Be),[...xe,He]})},Je=(De,Re)=>{if(!Re)return;const xe=ye.find(Be=>(Be.id??Be.questionId)===Re);xe&&y(Be=>Be.map(He=>He.id!==De||He.type!=="formField"?He:{...He,label:xe.label||xe.text||He.label,placeholder:Array.isArray(xe.options)?String(xe.options[0]??""):He.placeholder??"",required:xe.isRequired??He.required??!1,hint:xe.typeKey?`${xe.typeKey}${xe.isRequired?"  required":""}`:He.hint,questionId:Re}))},Oe=De=>{const Re=URL.createObjectURL(De);ne.current.push(Re),k(Re)},Ct=De=>{var Be;const Re=Array.from(De).map(Se),xe={id:ks(),type:"image",images:Re,activeImageId:(Be=Re[0])==null?void 0:Be.id,caption:"Add a caption or blessing",height:"medium",background:{images:[],overlay:.4}};y(He=>[...He,xe]),S(xe.id)},Pt=(De,Re)=>{const xe=Array.from(Re).map(Se);y(Be=>Be.map(He=>{var os,Hn,Hi,Hs;if(He.id!==De)return He;const Dr=[...((os=He.background)==null?void 0:os.images)??[],...xe];return{...He,background:{images:Dr,activeImageId:((Hn=He.background)==null?void 0:Hn.activeImageId)??((Hi=Dr[0])==null?void 0:Hi.id),overlay:((Hs=He.background)==null?void 0:Hs.overlay)??.4}}}))},Rr=(De,Re)=>y(xe=>xe.map(Be=>Be.id===De?{...Be,background:{...Be.background??{images:[]},activeImageId:Re}}:Be)),St=(De,Re)=>y(xe=>xe.map(Be=>Be.id===De?{...Be,background:{...Be.background??{images:[]},overlay:Re}}:Be)),wn=(De,Re)=>{const xe=Se(Re);y(Be=>Be.map(He=>He.id===De?{...He,sectionImage:xe}:He))},ha=De=>y(Re=>Re.map(xe=>xe.id===De?{...xe,sectionImage:null}:xe)),ur=(De,Re)=>{const xe=Se(Re);y(Be=>Be.map(He=>He.id!==De||He.type!=="image"?He:{...He,images:[xe,...He.images],activeImageId:xe.id}))},qt=(De,Re)=>{y(xe=>xe.map(Be=>{var Kt;if(Be.id!==De||Be.type!=="image")return Be;const He=[...Be.images,...Array.from(Re).map(Se)];return{...Be,images:He,activeImageId:Be.activeImageId??((Kt=He[0])==null?void 0:Kt.id)}}))},_r=()=>{if(!t)return;o({design:{blocks:v,flowPreset:q,globalBackgroundType:E,globalBackgroundAsset:N,globalBackgroundColor:R,globalOverlay:D,accentColor:O,globalMusicUrl:U||void 0,shareToken:z,publicLink:ke,formFieldConfigs:ye},isPublished:!1,isDraft:!0,shareToken:z,publicLink:ke})},ir=()=>{const De=ks(),Re=`${window.location.origin}/rsvp/submit/${De}`;te(De),re(Re),I(!1),Ne(De)},Et=async()=>{!ke||!navigator.clipboard||(await navigator.clipboard.writeText(ke),I(!0))};return t?c.jsxs("div",{className:"space-y-6",children:[c.jsx(HI,{eventName:e==null?void 0:e.title,isLoadingDesign:l,isSaving:f,isSaveSuccess:d,eventId:t,publicLink:ke,linkCopied:B,onSave:_r,onPreview:()=>ce(!0),onGenerateLink:ir,onCopyLink:Et}),c.jsxs("div",{className:"grid grid-cols-1 gap-5 xl:grid-cols-3",children:[c.jsx("div",{className:"xl:col-span-1",children:c.jsx(XI,{blocks:v,selectedId:b,accentColor:O,formFields:ye,isFetchingQuestions:a,onSelect:S,onReorder:$e,onAdd:Xe,onUploadImages:Ct,onInsertQuestion:dt})}),c.jsxs("div",{className:"space-y-5 xl:col-span-2",children:[c.jsx(QI,{globalBackgroundType:E,globalBackgroundColor:R,globalOverlay:D,accentColor:O,flowPreset:q,globalMusicUrl:U,hasBackgroundAsset:!!N,onChange:De=>{De.globalBackgroundType!==void 0&&_(De.globalBackgroundType),De.globalBackgroundColor!==void 0&&A(De.globalBackgroundColor),De.globalOverlay!==void 0&&T(De.globalOverlay),De.accentColor!==void 0&&F(De.accentColor),De.flowPreset!==void 0&&X(De.flowPreset),De.globalMusicUrl!==void 0&&ee(De.globalMusicUrl)},onUploadBackground:Oe}),c.jsx($I,{block:be,accentColor:O,formFields:ye,onUpdate:V,onRemove:We,onAddBackgroundImages:Pt,onSetActiveBackground:Rr,onSetOverlay:St,onSetSectionImage:wn,onClearSectionImage:ha,onReplaceImage:ur,onAppendImages:qt,onApplyQuestion:Je})]})]}),oe&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4 py-6",children:c.jsxs("div",{className:"relative w-full max-w-5xl rounded-2xl bg-white shadow-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Preview"}),c.jsx("p",{className:"text-lg font-bold text-gray-800",children:(e==null?void 0:e.title)??"Your RSVP invite"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"hidden gap-1 rounded-full bg-gray-100 p-1 text-sm md:flex",children:["mobile","desktop"].map(De=>c.jsx("button",{className:`rounded-full px-3 py-1 font-semibold capitalize transition ${Z===De?"bg-white shadow":"text-gray-500 hover:text-gray-700"}`,onClick:()=>ie(De),children:De},De))}),c.jsx("button",{className:"rounded-full bg-gray-100 px-3 py-1.5 text-sm font-semibold text-gray-700 hover:bg-gray-200",onClick:()=>ce(!1),children:"Close"})]})]}),c.jsx("div",{className:"flex justify-center p-6",children:c.jsx(ZI,{blocks:v,backgroundAsset:N,backgroundColor:R,backgroundType:E,overlay:D,accentColor:O,mode:Z,flowPreset:q})})]})})]}):c.jsx(Gl,{title:"No Event for RSVP Design",message:"Create your first event to start customizing your RSVP page design."})}function tU(){var d;const{token:e}=yn(),[t,r]=C.useState(null),[a,n]=C.useState(!0);C.useEffect(()=>{if(!e||typeof window>"u"){n(!1);return}const x=window.localStorage.getItem(`rsvp-share-${e}`);if(x)try{r(JSON.parse(x))}catch{r(null)}n(!1)},[e]);const l=(t==null?void 0:t.global)??{},o=(t==null?void 0:t.flowPreset)??"serene",f=e?`/rsvp/submit/${e}`:null;return a?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white",children:c.jsx(Un,{})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-b from-slate-900 via-slate-950 to-black px-4 py-10 text-white",children:c.jsxs("div",{className:"mx-auto flex max-w-6xl flex-col gap-6",children:[c.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Guest preview"}),c.jsx("h1",{className:"text-3xl font-bold",children:(t==null?void 0:t.eventTitle)??"Shared RSVP preview"}),c.jsx("p",{className:"text-sm text-white/70",children:"This view mirrors the public invite experience generated from the designer."})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f&&c.jsx(wl,{to:f,children:c.jsx(Le,{children:"RSVP Now"})}),c.jsx(wl,{to:"/login",children:c.jsx(Le,{variant:"secondary",children:"Back to dashboard"})})]})]}),(d=t==null?void 0:t.blocks)!=null&&d.length?c.jsx("div",{className:"overflow-hidden rounded-3xl border border-white/10 bg-white/5 shadow-2xl",children:c.jsx(JI,{blocks:t.blocks,backgroundAsset:l.backgroundAsset??"",backgroundColor:l.backgroundColor??"#0f172a",backgroundType:l.backgroundType??"color",overlay:l.overlay??.3,accentColor:l.accentColor??"#f97316",flowPreset:o})}):c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-6 text-white/80",children:[c.jsx("p",{className:"text-lg font-semibold text-white",children:"This preview link is empty."}),c.jsx("p",{className:"text-sm",children:"Ask the host to regenerate a link from the designer so you can view the invite card."})]}),f&&c.jsx("div",{className:"flex justify-center pt-2 pb-6",children:c.jsx(wl,{to:f,children:c.jsx(Le,{className:"min-w-[180px]",children:"Submit your RSVP "})})})]})})}function rh(e){return Xr({queryKey:["guests",e],queryFn:async()=>{var n;const t=await Ze.get(iu.all(e)),r=((n=t.data)==null?void 0:n.data)??t.data;return(Array.isArray(r)?r:[]).map(l=>({id:l.guestId??l.id,guestId:l.guestId,eventId:l.eventId,eventGuid:l.eventGuid,rsvpId:l.rsvpId,tableId:l.tableId??void 0,name:l.name??"",phoneNo:l.phoneNo??"",pax:l.pax??1,groupId:l.groupId,seatIndex:l.seatIndex,flag:l.flag,notes:l.notes??"",createdDate:l.createdDate,lastUpdated:l.lastUpdated,isDeleted:l.isDeleted??!1,createdBy:l.createdBy??"",updatedBy:l.updatedBy??"",guestName:l.name??"",noOfPax:l.pax??1,guestType:l.flag||l.groupId||"Other",remarks:l.notes??"",status:"Confirmed"}))},staleTime:6e4,enabled:!!e})}function t1(e){const t=bt();return kt({mutationFn:({guestId:r,tableId:a})=>Ze.post(iu.assignTable(r,a)).then(n=>n.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function r1(e){const t=bt();return kt({mutationFn:r=>Ze.post(iu.unassignTable(r)).then(a=>a.data),onSuccess:()=>{t.invalidateQueries({queryKey:["guests",e]}),t.invalidateQueries({queryKey:["tables",e]}),t.refetchQueries({queryKey:["guests",e]}),t.refetchQueries({queryKey:["tables",e]})}})}function ah(e){return Xr({queryKey:["tables",e],queryFn:async()=>{var n;const r=(await Ze.get(Li.all(e))).data;let a=((n=r==null?void 0:r.data)==null?void 0:n.tables)||(r==null?void 0:r.tables)||(r==null?void 0:r.data)||r||[];return Array.isArray(a)?a.map(l=>{var o;return{id:l.tableId,name:l.tableName,capacity:l.maxSeats,guests:l.guests||[],assignedCount:l.assignedCount??((o=l.guests)==null?void 0:o.length)??0,extraGuests:l.extraGuests,layout:l.layout}}):(console.warn("Unexpected tables API response format:",r),[])},enabled:!!e,staleTime:5*6e4})}function wu(e){return Xr({queryKey:["tables",e],queryFn:()=>Ze.get(Li.byId(e)).then(t=>t.data),enabled:!!e})}function zi(e,t,r){t&&(e.invalidateQueries({queryKey:["tables",t]}),e.refetchQueries({queryKey:["tables",t]})),r&&(e.invalidateQueries({queryKey:["tables",r]}),e.invalidateQueries({queryKey:["rsvps",r]}),e.invalidateQueries({queryKey:["guests",r]}),e.refetchQueries({queryKey:["tables",r]}),e.refetchQueries({queryKey:["rsvps",r]}),e.refetchQueries({queryKey:["guests",r]})),!t&&!r&&(e.invalidateQueries({queryKey:["tables"]}),e.refetchQueries({queryKey:["tables"]}))}function rU(e){const t=bt();return kt({mutationFn:({name:r,capacity:a,eventId:n})=>Ze.post(Li.create,{eventGuid:n,tableName:r,maxSeats:a}).then(l=>l.data),onSuccess:()=>zi(t,void 0,e)})}function aU(e){const t=bt();return kt({mutationFn:({eventGuid:r,tableName:a,quantity:n,maxSeats:l})=>Ze.post(Li.bulkCreate,{eventGuid:r,tableName:a,quantity:n,maxSeats:l}).then(o=>o.data),onSuccess:()=>zi(t,void 0,e)})}function nU(e,t){const r=bt();return kt({mutationFn:({name:a,capacity:n})=>Ze.post(Li.update,{tableId:e,tableName:a,maxSeats:n}).then(l=>l.data),onSuccess:()=>zi(r,e,t)})}function J_(e){const t=bt();return kt({mutationFn:r=>Ze.delete(Li.delete(r)).then(a=>a.data),onSuccess:()=>zi(t,void 0,e)})}function sU(e,t){const r=bt();return kt({mutationFn:({extraGuests:a,tableName:n,maxSeats:l})=>Ze.post(Li.update,{tableId:e,tableName:n,maxSeats:l,extraGuests:a}).then(o=>o.data),onSuccess:()=>zi(r,e,t)})}function iU(e,t){const r=bt();return kt({mutationFn:({layout:a})=>Ze.put(Li.updateLayout(e),{layout:a}).then(n=>n.data),onSuccess:()=>zi(r,e,t)})}function lU(e){const t=bt();return kt({mutationFn:({guestId:r,tableId:a})=>Ze.post(iu.assignTable(r,a),{}).then(n=>n.data),onSuccess:()=>zi(t,void 0,e)})}function oU(e){const t=bt();return kt({mutationFn:r=>Ze.post(iu.unassignTable(r),{}).then(a=>a.data),onSuccess:()=>zi(t,void 0,e)})}const ji=({label:e,value:t,variant:r="primary",icon:a})=>{const n={primary:"text-primary bg-primary/5 border-primary/20",secondary:"text-secondary bg-secondary/5 border-secondary/20",accent:"text-button bg-button/5 border-button/20",success:"text-green-600 bg-green-50 border-green-200 dark:text-green-400 dark:bg-green-900/20 dark:border-green-700/30",warning:"text-amber-600 bg-amber-50 border-amber-200 dark:text-amber-400 dark:bg-amber-900/20 dark:border-amber-700/30"},l={primary:"text-primary",secondary:"text-secondary",accent:"text-button",success:"text-green-600 dark:text-green-400",warning:"text-amber-600 dark:text-amber-400"};return c.jsx("div",{className:`p-4 rounded-xl border ${n[r]} transition-all hover:shadow-md`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1",children:e}),c.jsx("p",{className:`text-2xl font-bold ${l[r]}`,children:t})]}),a&&c.jsx("div",{className:`ml-3 ${l[r]} opacity-80`,children:a})]})})},cU=({isOpen:e,onClose:t,guest:r,eventId:a})=>{const{user:n}=cu(),l=Qg(a),o=Zg(a),{data:f=[]}=ah(a),[d,x]=C.useState(""),[m,p]=C.useState(""),[v,y]=C.useState("Family"),[b,S]=C.useState(""),[E,_]=C.useState("");C.useEffect(()=>{e&&r?(x(r.guestName||r.name||""),p(r.phoneNo||""),y(r.guestType||"Family"),S(r.notes||""),_(r.tableId||"")):e&&!r&&(x(""),p(""),y("Family"),S(""),_(""))},[e,r]);const N=async k=>{if(k.preventDefault(),!d.trim()){Ya.error("Guest name is required");return}const R=(n==null?void 0:n.id)??(n==null?void 0:n.name)??"System";try{const A={eventId:a,guestName:d.trim(),phoneNo:m.trim(),guestType:v,remarks:b.trim(),tableId:E||void 0,status:"Yes"};r?(await o.mutateAsync({id:r.rsvpId??r.guestId??r.id,...A,updatedBy:R}),Ya.success(`${d} updated successfully`)):(await l.mutateAsync({...A,createdBy:R}),Ya.success(`${d} created successfully`)),t()}catch(A){console.error("Guest save error:",A),Ya.error(`Failed to ${r?"update":"create"} guest`)}};return c.jsx(zn,{isOpen:e,onClose:t,title:r?"Edit Guest":"New Guest",children:c.jsxs("form",{onSubmit:N,className:"space-y-4",children:[c.jsx($t,{label:"Guest Name",value:d,onChange:k=>x(k.target.value),required:!0}),c.jsx($t,{label:"Phone Number",value:m,onChange:k=>p(k.target.value),type:"text"}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Guest Type"}),c.jsx("select",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:v,onChange:k=>y(k.target.value),children:["Family","VIP","Friend","Other"].map(k=>c.jsx("option",{value:k,children:k},k))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Table Assignment (Optional)"}),c.jsxs("select",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:E,onChange:k=>_(k.target.value),children:[c.jsx("option",{value:"",children:"Unassigned"}),f.map(k=>c.jsxs("option",{value:k.id,children:[k.name," (Capacity: ",k.capacity,")"]},k.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Remarks / Notes"}),c.jsx("textarea",{className:"w-full border rounded-xl p-2 focus:ring-2 focus:ring-primary bg-white dark:bg-accent dark:border-white/10",value:b,onChange:k=>S(k.target.value),rows:3,placeholder:"Any special notes about this guest..."})]}),c.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",loading:l.isPending||o.isPending,children:r?"Save Changes":"Create Guest"})]})]})})};function uU(){const{eventId:e}=Yr(),{data:t=[],isLoading:r,isError:a}=rh(e),{data:n=[],isLoading:l}=ah(e),o=t1(e),f=r1(e),[d,x]=C.useState("All"),[m,p]=C.useState(""),[v,y]=C.useState({open:!1}),[b,S]=C.useState({open:!1}),E=C.useMemo(()=>{const A=t.length,D=t.filter(F=>F.tableId).length,T=t.filter(F=>!F.tableId).length,O=t.filter(F=>F.guestType==="VIP").length;return{total:A,assigned:D,unassigned:T,vips:O}},[t]),_=C.useMemo(()=>{const A=new Map;return n.forEach(D=>{A.set(D.id,D.name)}),A},[n]),N=C.useMemo(()=>t.filter(A=>{const D=d==="All"||A.guestType===d,T=(A.guestName??A.name??"").toLowerCase().includes(m.toLowerCase());return D&&T}),[t,d,m]);if(!e)return c.jsx(Gl,{title:"No Events for Guest Management",message:"Create your first event to start adding and managing your guest list."});if(r||l)return c.jsx(Ka,{message:"Loading guests..."});if(a)return c.jsx("p",{children:"Failed to load guests."});const k=async(A,D)=>{try{await o.mutateAsync({guestId:A.guestId??A.id,tableId:D}),Ya.success(`${A.guestName||A.name} assigned to table successfully`),S({open:!1})}catch(T){console.error("Assign table error:",T),Ya.error("Failed to assign guest to table")}},R=async A=>{if(window.confirm(`Remove ${A.guestName||A.name} from ${_.get(A.tableId||"")}?`))try{await f.mutateAsync(A.guestId??A.id),Ya.success(`${A.guestName||A.name} unassigned from table successfully`)}catch(D){console.error("Unassign table error:",D),Ya.error("Failed to unassign guest from table")}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[c.jsx(ji,{label:"Total Guests",value:E.total,variant:"primary",icon:c.jsx(ud,{className:"h-6 w-6"})}),c.jsx(ji,{label:"Assigned",value:E.assigned,variant:"success",icon:c.jsx(fd,{className:"h-6 w-6"})}),c.jsx(ji,{label:"Unassigned",value:E.unassigned,variant:"warning",icon:c.jsx(fd,{className:"h-6 w-6"})}),c.jsx(ji,{label:"VIPs",value:E.vips,variant:"accent",icon:c.jsx(fd,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Guests"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:c.jsxs("div",{className:"px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl text-sm text-blue-700 dark:text-blue-300",children:[c.jsx("span",{className:"font-medium",children:"Note:"})," Guests are automatically created when RSVP submissions include attendees (pax > 0). ",c.jsx("br",{}),"Guest deletion is only available through the RSVP module."]})})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[c.jsx("select",{value:d,onChange:A=>x(A.target.value),className:"w-full md:w-1/4 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10",children:["All","Family","VIP","Friend","Other"].map(A=>c.jsx("option",{value:A,children:A},A))}),c.jsx("input",{type:"text",placeholder:"Search guests by name...",value:m,onChange:A=>p(A.target.value),className:"w-full md:flex-1 border rounded-xl p-2 bg-white dark:bg-accent dark:border-white/10"})]}),N.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(ud,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m||d!=="All"?"No guests match your filters":"No guests yet. Create your first guest!"})]}),N.length>0&&c.jsx("ul",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:N.map(A=>{const D=!!A.tableId;return c.jsxs("li",{className:`relative p-4 rounded-lg shadow flex flex-col justify-between transition-all ${D?"bg-green-50 dark:bg-green-900/10 border-2 border-green-200 dark:border-green-800":"bg-orange-50 dark:bg-orange-900/10 border-2 border-orange-200 dark:border-orange-800"}`,children:[c.jsx("span",{className:`absolute top-2 right-2 px-3 py-1 text-xs font-bold rounded-full ${D?"bg-green-600 text-white":"bg-orange-600 text-white"}`,children:D?"ASSIGNED":"UNASSIGNED"}),c.jsxs("div",{className:"space-y-2 mt-6",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:A.guestName}),A.phoneNo&&c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Phone: ",A.phoneNo]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ud,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}),c.jsxs("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[A.pax||A.noOfPax||1," ",(A.pax||A.noOfPax||1)===1?"person":"people",(A.pax||A.noOfPax||1)>1&&c.jsxs("span",{className:"ml-2 text-xs font-bold text-primary",children:["(+",(A.pax||A.noOfPax||1)-1,")"]})]})]}),c.jsx("div",{className:"flex flex-wrap gap-2",children:c.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-sm font-medium border-2 ${A.guestType==="Family"?"border-blue-600 text-blue-600 dark:border-blue-400 dark:text-blue-400":A.guestType==="VIP"?"border-purple-600 text-purple-600 dark:border-purple-400 dark:text-purple-400":A.guestType==="Friend"?"border-indigo-600 text-indigo-600 dark:border-indigo-400 dark:text-indigo-400":"border-gray-400 text-gray-600 dark:border-gray-500 dark:text-gray-400"}`,children:A.guestType||"Other"})}),c.jsxs("div",{className:`mt-3 p-3 rounded-lg ${D?"bg-green-100 dark:bg-green-900/30":"bg-orange-100 dark:bg-orange-900/30"}`,children:[c.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1",children:"Table Seating:"}),A.tableId?c.jsx("p",{className:"text-sm font-bold text-green-800 dark:text-green-300",children:_.get(A.tableId)||"Unknown Table"}):c.jsx("p",{className:"text-sm font-bold text-orange-800 dark:text-orange-300",children:"No table assigned"})]})]}),c.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>y({open:!0,guest:A}),children:"Edit"}),A.tableId?c.jsx(Le,{variant:"secondary",onClick:()=>R(A),className:"!bg-orange-600 !text-white hover:!bg-orange-700",children:"Unassign"}):c.jsx(Le,{variant:"primary",onClick:()=>S({open:!0,guest:A}),className:"!bg-green-600 !text-white hover:!bg-green-700",children:"Assign Table"})]})]},A.id)})}),c.jsx(cU,{isOpen:v.open,onClose:()=>y({open:!1}),guest:v.guest,eventId:e}),b.open&&b.guest&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white dark:bg-accent rounded-xl shadow-xl max-w-md w-full p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:["Assign ",b.guest.guestName," to Table"]}),c.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.length===0?c.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No tables available. Please create tables first."}):n.map(A=>c.jsxs("button",{onClick:()=>k(b.guest,A.id),className:"w-full text-left p-3 rounded-lg border-2 border-gray-200 dark:border-gray-700 hover:border-primary dark:hover:border-primary hover:bg-primary/5 transition-colors",children:[c.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:A.name}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Capacity: ",A.capacity]})]},A.id))}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(Le,{variant:"secondary",onClick:()=>S({open:!1}),children:"Cancel"})})]})})]})}const fU=({trigger:e,children:t,className:r=""})=>{const[a,n]=C.useState(!1),l=C.useRef(null);C.useEffect(()=>{const d=x=>{l.current&&!l.current.contains(x.target)&&n(!1)};return a&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[a]);const o=d=>{d(),n(!1)},f=bl.Children.map(t,d=>bl.isValidElement(d)&&d.type===Gp?bl.cloneElement(d,{onClick:()=>o(d.props.onClick)}):d);return c.jsxs("div",{className:`relative inline-block ${r}`,ref:l,children:[c.jsx("div",{onClick:()=>n(!a),className:"cursor-pointer",children:e}),a&&c.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-xl shadow-lg bg-white dark:bg-accent border border-gray-200 dark:border-gray-700 z-50 overflow-hidden",children:c.jsx("div",{className:"py-1",children:f})})]})},Gp=({onClick:e,children:t,className:r=""})=>c.jsx("button",{onClick:e,className:`w-full text-left px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-primary/10 dark:hover:bg-white/10 transition-colors ${r}`,children:t}),dU=({guest:e,onDragStart:t,onDragEnd:r,isDragging:a=!1})=>{var d;const[n,l]=C.useState(!1),o=x=>{x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("guestId",e.id),t==null||t(e.id)},f=()=>{r==null||r()};return c.jsxs("div",{draggable:"true",onDragStart:o,onDragEnd:f,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),className:`
        p-3 rounded-lg border-2 border-dashed border-gray-200 
        bg-white dark:bg-accent/50 dark:border-gray-600
        transition-all cursor-grab active:cursor-grabbing
        touch-none select-none
        ${n?"border-primary bg-indigo-50 dark:bg-primary/10 shadow-md":""}
        ${a?"opacity-50":"opacity-100"}
      `,role:"button",tabIndex:0,"aria-label":`Drag ${e.guestName} to assign to a table`,children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white",children:e.guestName}),e.paxCount&&e.paxCount>1&&c.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-xs font-medium text-gray-700 dark:text-gray-300 rounded",children:["+",e.paxCount-1]})]}),e.phoneNo&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:e.phoneNo}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.isVip&&c.jsx("span",{className:"px-2 py-0.5 bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-300 text-xs font-medium rounded-full",children:"VIP"}),(d=e.dietaryRestrictions)==null?void 0:d.map((x,m)=>c.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 text-xs font-medium rounded-full",children:x},m))]})]})},hU=({table:e,onDrop:t,onEdit:r,onDelete:a,onUnassignGuest:n,draggedGuest:l})=>{const[o,f]=C.useState(!1),d=e.capacity-e.assignedCount,x=l?l.paxCount<=d:d>0,p={vip:{header:"from-purple-50 to-white dark:from-purple-900/20 dark:to-accent",icon:"from-purple-500 to-purple-700",badge:"bg-purple-100 text-purple-800 dark:bg-purple-900/40 dark:text-purple-300"},"family-bride":{header:"from-pink-50 to-white dark:from-pink-900/20 dark:to-accent",icon:"from-pink-500 to-rose-600",badge:"bg-pink-100 text-pink-800 dark:bg-pink-900/40 dark:text-pink-300"},"family-groom":{header:"from-blue-50 to-white dark:from-blue-900/20 dark:to-accent",icon:"from-blue-500 to-blue-700",badge:"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300"},friends:{header:"from-green-50 to-white dark:from-green-900/20 dark:to-accent",icon:"from-green-500 to-emerald-600",badge:"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300"},colleagues:{header:"from-orange-50 to-white dark:from-orange-900/20 dark:to-accent",icon:"from-orange-500 to-amber-600",badge:"bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-300"}}[e.category||"friends"],v=e.assignedCount/e.capacity*100,y=e.assignedCount>=e.capacity,b=_=>{x&&(_.preventDefault(),_.dataTransfer.dropEffect="move",f(!0))},S=()=>{f(!1)},E=_=>{if(_.preventDefault(),f(!1),!x)return;const N=_.dataTransfer.getData("guestId");N&&t&&t(N,e.id)};return c.jsxs("div",{onDragOver:b,onDragLeave:S,onDrop:E,className:`
        relative rounded-xl shadow-lg overflow-hidden transition-all
        ${o&&x?"ring-4 ring-primary ring-offset-2 shadow-2xl scale-[1.02]":""}
        ${!x&&l?"opacity-50 cursor-not-allowed":""}
        ${y?"opacity-75":""}
        hover:shadow-xl
      `,role:"region","aria-label":`${e.name} - ${e.assignedCount} of ${e.capacity} seats filled`,children:[c.jsxs("div",{className:`bg-gradient-to-r ${p.header} p-4 border-b`,children:[c.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white mb-1",children:e.name}),e.category&&c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p.badge}`,children:e.category})})]}),c.jsxs("div",{className:"bg-white dark:bg-accent p-4",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[c.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Seats"}),c.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[e.assignedCount," / ",e.capacity]})]}),c.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-300 ${y?"bg-green-500":v>80?"bg-amber-500":"bg-primary"}`,style:{width:`${Math.min(v,100)}%`}})})]}),c.jsx("div",{className:"space-y-2 mb-4 max-h-48 overflow-y-auto",children:e.guests.length===0?c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-4",children:"No guests assigned yet"}):e.guests.map(_=>c.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-gray-50 dark:bg-gray-800 group hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[c.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-sm font-bold flex-shrink-0",children:_.guestName.charAt(0).toUpperCase()}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:_.guestName}),_.paxCount&&_.paxCount>1&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",_.paxCount-1," guests"]})]}),n&&c.jsx("button",{onClick:()=>n(_.id),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:"Unassign guest",children:c.jsx(og,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]},_.id))}),c.jsxs("div",{className:"flex gap-2 pt-3 border-t dark:border-gray-700",children:[c.jsx(Le,{variant:"secondary",onClick:()=>r==null?void 0:r(e.id),className:"flex-1 text-sm py-2",children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:()=>a==null?void 0:a(e.id),className:"text-sm py-2",children:"Delete"})]})]}),o&&x&&c.jsx("div",{className:"absolute inset-0 bg-primary/10 border-4 border-dashed border-primary rounded-xl flex items-center justify-center pointer-events-none",children:c.jsx("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg",children:c.jsx("p",{className:"text-primary font-semibold",children:"Drop guest here"})})}),l&&!x&&c.jsx("div",{className:"absolute inset-0 bg-red-500/10 border-2 border-red-500 rounded-xl flex items-center justify-center pointer-events-none",children:c.jsxs("div",{className:"bg-white dark:bg-accent px-4 py-2 rounded-lg shadow-lg border-2 border-red-500",children:[c.jsx("p",{className:"text-red-600 font-semibold text-sm",children:"Not enough seats"}),c.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Need ",l.paxCount,", only ",d," available"]})]})})]})},er={NONE:0,BRIDE_FAMILY:1,GROOM_FAMILY:2,BRIDE_RELATIVES:3,GROOM_RELATIVES:4,FRIENDS:5,COLLEAGUES:6,FAMILY_FRIENDS:7,NEIGHBORS:8,VIP:9},xU={[er.NONE]:"None",[er.BRIDE_FAMILY]:"Bride Family",[er.GROOM_FAMILY]:"Groom Family",[er.BRIDE_RELATIVES]:"Bride Relatives",[er.GROOM_RELATIVES]:"Groom Relatives",[er.FRIENDS]:"Friends",[er.COLLEAGUES]:"Colleagues",[er.FAMILY_FRIENDS]:"Family Friends",[er.NEIGHBORS]:"Neighbors",[er.VIP]:"VIP"},Qm={[er.NONE]:"table",[er.BRIDE_FAMILY]:"bridefamily",[er.GROOM_FAMILY]:"groomfamily",[er.BRIDE_RELATIVES]:"briderelatives",[er.GROOM_RELATIVES]:"groomrelatives",[er.FRIENDS]:"friends",[er.COLLEAGUES]:"colleagues",[er.FAMILY_FRIENDS]:"familyfriends",[er.NEIGHBORS]:"neighbors",[er.VIP]:"vip"};function mU(){return[er.VIP,er.BRIDE_FAMILY,er.GROOM_FAMILY,er.FRIENDS,er.COLLEAGUES]}const pU=({isOpen:e,onClose:t})=>{const{eventId:r}=Yr(),[a,n]=C.useState(null),[l,o]=C.useState(!1),[f,d]=C.useState([]),[x,m]=C.useState(""),[p,v]=C.useState(""),[y,b]=C.useState("10"),S=aU(r);C.useEffect(()=>{if(e){const R=mU();d(R.map(A=>({category:A,quantity:0,capacity:10}))),m(""),v(""),b("10"),n(null),o(!1)}},[e]);const E=(R,A)=>{const D=[...f];D[R].quantity=Number(A)||0,d(D)},_=(R,A)=>{const D=[...f];D[R].capacity=Number(A)||1,d(D)},N=async R=>{R.preventDefault(),n(null);const A=f.filter(q=>q.quantity>0),D=Number(p)||0,T=Number(y)||0,O=x.trim()&&D>0;if(A.length===0&&!O){n("Please enter at least one table quantity");return}if(O){if(!x.trim()){n("Please enter a table prefix for custom tables");return}if(D<1){n("Custom table quantity must be at least 1");return}if(T<1){n("Custom table capacity must be at least 1");return}}if(A.find(q=>q.capacity<1)){n("All capacities must be at least 1");return}o(!0);try{for(const q of A){const X=Qm[q.category];await S.mutateAsync({eventGuid:r,tableName:X,quantity:q.quantity,maxSeats:q.capacity})}O&&await S.mutateAsync({eventGuid:r,tableName:x.trim(),quantity:D,maxSeats:T}),t()}catch(q){console.error("Failed to create tables:",q),n(q.message??"Failed to create tables. Please try again.")}finally{o(!1)}},k=f.reduce((R,A)=>R+A.quantity,0)+(Number(p)||0);return c.jsx(zn,{isOpen:e,onClose:t,title:"Bulk Create Tables",className:"!max-w-4xl",children:c.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a&&c.jsx(uu,{message:a}),c.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-3 mb-4",children:c.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[c.jsx("strong",{children:"Quick Setup:"})," Enter quantities for each category. Tables will be auto-named (e.g., vip1, vip2, bridefamily1, friends1, etc.)"]})}),c.jsx("div",{className:"space-y-3",children:f.map((R,A)=>c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-3 bg-white dark:bg-accent/50 rounded-lg border border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300",children:xU[R.category]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",Qm[R.category],"1, ",Qm[R.category],"2...)"]})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("input",{type:"number",min:"0",placeholder:"0",value:R.quantity||"",onChange:D=>E(A,D.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("input",{type:"number",min:"1",value:R.capacity,onChange:D=>_(A,D.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:R.quantity===0}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]},R.category))}),c.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Custom Tables (Optional)"}),c.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mb-3",children:c.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[c.jsx("strong",{children:"Example:"}),' Prefix "family" with 5 tables creates: family1, family2, family3, family4, family5']})}),c.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Table Prefix"}),c.jsx("input",{type:"text",placeholder:"e.g., family, special",value:x,onChange:R=>m(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"(prefix1, prefix2...)"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Quantity"}),c.jsx("input",{type:"number",min:"0",placeholder:"0",value:p,onChange:R=>v(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"tables"})]}),c.jsxs("div",{className:"col-span-4",children:[c.jsx("label",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 block mb-1",children:"Capacity"}),c.jsx("input",{type:"number",min:"1",value:y,onChange:R=>b(R.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",disabled:!p||Number(p)===0}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"seats each"})]})]})]}),k>0&&c.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:c.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:[c.jsx("strong",{children:"Total:"})," ",k," tables will be created"]})}),c.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",disabled:l,children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",loading:l,disabled:k===0,children:l?"Creating...":`Create ${k} Table${k!==1?"s":""}`})]})]})})},nh=({isOpen:e,onClose:t,initial:r})=>{const{eventId:a}=Yr(),[n,l]=C.useState((r==null?void 0:r.name)||""),[o,f]=C.useState((r==null?void 0:r.capacity.toString())||"1"),[d,x]=C.useState(null),m=rU(a),p=nU((r==null?void 0:r.id)||"",a);C.useEffect(()=>{e&&(l((r==null?void 0:r.name)||""),f(((r==null?void 0:r.capacity)??10).toString()),x(null))},[e,r]);const v=!!r,y=async b=>{b.preventDefault();const S={name:n.trim(),capacity:Number(o),eventId:a};try{v&&r?await p.mutateAsync(S):await m.mutateAsync(S),t()}catch(E){console.error(E),x(E.message??"Something went wrong.")}};return c.jsx(zn,{isOpen:e,onClose:t,title:v?"Edit Table":"New Table",children:c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[d&&c.jsx(uu,{message:d}),c.jsx($t,{label:"Table Name",value:n,onChange:b=>l(b.target.value)}),c.jsx($t,{label:"Capacity",type:"number",value:o,onChange:b=>f(b.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",children:v?"Save":"Create"})]})]})})};function gU(){const{eventId:e}=Yr(),{data:t=[],isLoading:r,isError:a}=ah(e),{data:n=[],isLoading:l,isError:o}=rh(e),f=J_(e),d=t1(e||""),x=r1(e||""),[m,p]=C.useState(""),[v,y]=C.useState("all"),[b,S]=C.useState(null),[E,_]=C.useState(null),[N,k]=C.useState(!1),[R,A]=C.useState(!1),[D,T]=C.useState(null),[O,F]=C.useState(null),q=C.useMemo(()=>{const te=n.filter(M=>M.tableId).reduce((M,W)=>M+(W.pax||W.noOfPax||1),0),B=n.filter(M=>!M.tableId).reduce((M,W)=>M+(W.pax||W.noOfPax||1),0),I=t.reduce((M,W)=>M+W.capacity,0);return{totalTables:t.length,seatedGuests:te,unassigned:B,totalCapacity:I}},[t,n]),X=C.useMemo(()=>n.filter(te=>!te.tableId),[n]),U=C.useMemo(()=>t.map(te=>{const B=n.filter(I=>I.tableId===te.id);return{...te,guests:B.map(I=>({id:I.id,guestName:I.guestName||I.name,paxCount:I.pax||I.noOfPax||1})),assignedCount:B.reduce((I,M)=>I+(M.pax||M.noOfPax||1),0)}}),[t,n]),ee=C.useMemo(()=>U.filter(te=>!(m&&!te.name.toLowerCase().includes(m.toLowerCase())&&!te.guests.some(I=>I.guestName.toLowerCase().includes(m.toLowerCase()))||v==="hasEmpty"&&te.assignedCount>=te.capacity||v==="full"&&te.assignedCount<te.capacity)),[U,m,v]);if(!e)return c.jsx(Gl,{title:"No Events for Table Management",message:"Create your first event to start organizing seating arrangements and table assignments."});if(r||l)return c.jsx(Ka,{message:"Loading tables..."});if(a||o)return c.jsx("p",{children:"Failed to load data."});const oe=te=>{const B=n.find(I=>I.id===te);B&&(S(te),_({id:te,paxCount:B.pax||B.noOfPax||1}))},ce=()=>{S(null),_(null)},Z=(te,B)=>{const I=n.find(ye=>ye.id===te),M=U.find(ye=>ye.id===B);if(!I||!M)return;const W=I.pax||I.noOfPax||1,ne=M.capacity-M.assignedCount;if(W>ne){Ya.error(`Cannot assign guest. This guest requires ${W} seat(s), but only ${ne} seat(s) available in ${M.name}.`,{duration:4e3});return}d.mutate({guestId:te,tableId:B})},ie=te=>{x.mutate(te)},ke=te=>{const B=U.find(I=>I.id===te);B&&T({id:B.id,name:B.name,capacity:B.capacity})},re=te=>{const B=U.find(I=>I.id===te);B&&F({id:B.id,name:B.name})},z=()=>{O&&(f.mutate(O.id),F(null))};return c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[c.jsx(ji,{label:"Total Tables",value:q.totalTables,variant:"primary"}),c.jsx(ji,{label:"Seated Guests",value:q.seatedGuests,variant:"success"}),c.jsx(ji,{label:"Unassigned",value:q.unassigned,variant:"warning"}),c.jsx(ji,{label:"Total Capacity",value:q.totalCapacity,variant:"secondary"})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Table Arrangement"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs(Le,{variant:"secondary",disabled:!0,className:"opacity-50 cursor-not-allowed flex items-center gap-2",title:"Coming Soon",children:["Auto-Assign",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),c.jsxs(fU,{trigger:c.jsxs(Le,{children:["+ New Table ",c.jsx("span",{className:"ml-1",children:""})]}),children:[c.jsx(Gp,{onClick:()=>A(!0),children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Create Single Table"}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create one table at a time"})]})}),c.jsx(Gp,{onClick:()=>k(!0),children:c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium",children:["Bulk Create"," ",c.jsx("span",{className:"text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full",children:"Recommended"})]}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Create by category or custom prefix"})]})})]})]})]}),c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center mb-4 gap-4",children:[c.jsxs("select",{className:"w-full md:w-1/4 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:v,onChange:te=>y(te.target.value),children:[c.jsx("option",{value:"all",children:"All Tables"}),c.jsx("option",{value:"hasEmpty",children:"Has Empty Seats"}),c.jsx("option",{value:"full",children:"Full Tables"})]}),c.jsx("input",{placeholder:"Search guests or tables...",className:"w-full md:flex-1 border border-gray-300 dark:border-gray-600 rounded-lg p-2 bg-white dark:bg-accent text-gray-900 dark:text-white",value:m,onChange:te=>p(te.target.value)})]}),c.jsx("div",{className:"mb-6 p-4 rounded-xl bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border border-indigo-100 dark:border-indigo-800",children:c.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:[c.jsx("strong",{children:"Tip:"})," Drag guests from the unassigned panel and drop them onto tables"]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 flex-1 min-h-0",children:[c.jsx("div",{className:"lg:col-span-1 lg:max-h-full",children:c.jsxs("div",{className:"lg:sticky lg:top-0 bg-white dark:bg-accent rounded-xl shadow-lg p-4 border border-gray-200 dark:border-gray-700",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Unassigned Guests (",X.length,")"]}),c.jsx("div",{className:"space-y-2 max-h-96 lg:max-h-[calc(100vh-350px)] overflow-y-auto",children:X.length===0?c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic text-center py-8",children:"All guests have been assigned!"}):X.map(te=>{var B,I;return c.jsx(dU,{guest:{id:te.id,guestName:te.guestName||te.name,phoneNo:te.phoneNo,paxCount:te.pax||te.noOfPax||1,isVip:(B=te.remarks||te.notes)==null?void 0:B.toLowerCase().includes("vip"),dietaryRestrictions:(I=te.remarks||te.notes)!=null&&I.toLowerCase().includes("vegetarian")?["Vegetarian"]:void 0},onDragStart:oe,onDragEnd:ce,isDragging:b===te.id},te.id)})})]})}),c.jsx("div",{className:"lg:col-span-3 overflow-y-auto",children:ee.length===0?c.jsxs("div",{className:"p-6 rounded-lg border-2 border-dashed border-primary/25 text-center space-y-2 bg-white/70 dark:bg-accent/70",children:[c.jsx("p",{className:"text-lg font-semibold",children:"No tables found."}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:m?"No tables match your search. Try a different search term.":"Create your first table to start organizing your seating arrangements."}),c.jsx(Le,{onClick:()=>A(!0),children:"+ Create First Table"})]}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 pb-6",children:ee.map(te=>c.jsx(hU,{table:te,onDrop:Z,onEdit:ke,onDelete:re,onUnassignGuest:ie,isDropTarget:!!b,draggedGuest:E},te.id))})})]}),c.jsx(pU,{isOpen:N,onClose:()=>k(!1)}),c.jsx(nh,{isOpen:R||!!D,onClose:()=>{A(!1),T(null)},initial:D||void 0}),c.jsx(bu,{isOpen:!!O,isDeleting:f.isPending,onConfirm:z,onCancel:()=>F(null),title:"Delete Table",description:"Are you sure you want to delete this table? This action cannot be undone.",children:O&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:O.name}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Table ID: ",O.id]})]})})})})]})}function vU(){const{tableId:e}=yn(),t=_a(),{data:r,isLoading:a,isError:n}=wu(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Un,{})}):n||!r?c.jsx("div",{className:"p-6 text-center text-red-500",children:"Couldnt load table."}):c.jsx(nh,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function yU(){return Xr({queryKey:["seating"],queryFn:async()=>(await Ze.get(lu.all)).data,staleTime:5*6e4})}function bU(e){return Xr({queryKey:["seating",e],queryFn:async()=>(await Ze.get(lu.byId(e))).data})}function wU(){const e=bt();return kt({mutationFn:async t=>(await Ze.post(lu.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}function SU(e){const t=bt();return kt({mutationFn:async r=>(await Ze.put(lu.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["seating"]})})}function EU(){const e=bt();return kt({mutationFn:async t=>(await Ze.delete(lu.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["seating"]})})}const a1=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=C.useState((r==null?void 0:r.tableId)||""),[l,o]=C.useState((r==null?void 0:r.guestId)||""),f=wU(),d=SU((r==null?void 0:r.id)||""),[x,m]=C.useState(null);C.useEffect(()=>{e&&(n((r==null?void 0:r.tableId)||""),o((r==null?void 0:r.guestId)||""))},[e,r]);const p=!!r,v=async y=>{var S,E;y.preventDefault();const b={tableId:a,guestId:l};try{p&&r?await d.mutateAsync(b):await f.mutateAsync(b),t()}catch(_){console.error(_),m(((E=(S=_.response)==null?void 0:S.data)==null?void 0:E.message)||"Something went wrong.")}};return c.jsx(zn,{isOpen:e,onClose:t,title:p?"Edit Seating":"New Seating",children:c.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&c.jsx(uu,{message:x}),c.jsx($t,{label:"Table ID",value:a,onChange:y=>n(y.target.value)}),c.jsx($t,{label:"Guest ID",value:l,onChange:y=>o(y.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",children:p?"Save":"Create"})]})]})})};function _U(){const{data:e,isLoading:t,isError:r}=yU(),a=EU(),[n,l]=C.useState({open:!1}),[o,f]=C.useState({open:!1,seat:null});if(t)return c.jsx(Ka,{});if(r)return c.jsx("p",{children:"Failed to load seating."});const d=p=>{f({open:!0,seat:p})},x=()=>{f({open:!1,seat:null})},m=async()=>{if(o.seat)try{await a.mutateAsync(o.seat.id),f({open:!1,seat:null})}catch(p){console.error("Failed to delete seat:",p)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Seating"}),c.jsx(Le,{onClick:()=>l({open:!0}),children:"New Seating"})]}),c.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-lg font-medium",children:["Table: ",p.tableId]}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Guest: ",p.guestId]})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>l({open:!0,seat:{id:p.id,tableId:p.tableId,guestId:p.guestId}}),children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:()=>d({id:p.id,tableId:p.tableId,guestId:p.guestId}),children:"Delete"})]})]},p.id))}),c.jsx(a1,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.seat}),c.jsx(bu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete Seating Assignment?",description:"Are you sure you want to delete this seating assignment? This action cannot be undone.",children:o.seat&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsxs("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:["Table ID: ",o.seat.tableId]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Guest ID: ",o.seat.guestId]})]})})})})]})}function kU(){const{id:e}=yn(),t=_a(),{data:r,isLoading:a,isError:n}=bU(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Un,{})}):n||!r?c.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load seating."}):c.jsx(a1,{isOpen:!0,initial:r,onClose:()=>t(-1)})}function TU(){return Xr({queryKey:["users"],queryFn:async()=>(await Ze.get(ou.all)).data,staleTime:5*6e4})}function NU(e){return Xr({queryKey:["user",e],queryFn:async()=>(await Ze.get(ou.byId(e))).data})}function CU(){const e=bt();return kt({mutationFn:async t=>(await Ze.post(ou.create,t)).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}function AU(e){const t=bt();return kt({mutationFn:async r=>(await Ze.put(ou.update(e),r)).data,onSuccess:()=>t.invalidateQueries({queryKey:["users"]})})}function jU(){const e=bt();return kt({mutationFn:async t=>(await Ze.delete(ou.delete(t))).data,onSuccess:()=>e.invalidateQueries({queryKey:["users"]})})}const n1=({isOpen:e,onClose:t,initial:r})=>{const[a,n]=C.useState((r==null?void 0:r.name)||""),[l,o]=C.useState((r==null?void 0:r.email)||""),f=CU(),d=AU((r==null?void 0:r.id)||""),[x,m]=C.useState(null);C.useEffect(()=>{e&&(n((r==null?void 0:r.name)||""),o((r==null?void 0:r.email)||""))},[e,r]);const p=!!r,v=async y=>{var S,E;y.preventDefault();const b={name:a,email:l};try{p&&r?await d.mutateAsync(b):await f.mutateAsync(b),t()}catch(_){console.error(_),m(((E=(S=_.response)==null?void 0:S.data)==null?void 0:E.message)||"Something went wrong.")}};return c.jsx(zn,{isOpen:e,onClose:t,title:p?"Edit User":"New User",children:c.jsxs("form",{onSubmit:v,className:"space-y-4",children:[x&&c.jsx(uu,{message:x}),c.jsx($t,{label:"Name",value:a,onChange:y=>n(y.target.value)}),c.jsx($t,{label:"Email",type:"email",value:l,onChange:y=>o(y.target.value)}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:t,type:"button",children:"Cancel"}),c.jsx(Le,{variant:"primary",type:"submit",children:p?"Save":"Create"})]})]})})};function RU(){const{data:e,isLoading:t,isError:r}=TU(),a=jU(),[n,l]=C.useState({open:!1}),[o,f]=C.useState({open:!1,user:null});if(t)return c.jsx(Ka,{message:"Loading users..."});if(r)return c.jsx("p",{children:"Failed to load users."});const d=p=>{f({open:!0,user:p})},x=()=>{f({open:!1,user:null})},m=async()=>{if(o.user)try{await a.mutateAsync(o.user.id),f({open:!1,user:null})}catch(p){console.error("Failed to delete user:",p)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary",children:"Users"}),c.jsx(Le,{onClick:()=>l({open:!0}),children:" New User"})]}),c.jsx("ul",{className:"space-y-2",children:Array.isArray(e)&&e.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-lg font-medium",children:p.name}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.email})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>l({open:!0,user:{id:p.id,name:p.name,email:p.email}}),children:"Edit"}),c.jsx(Le,{variant:"secondary",onClick:()=>d({id:p.id,name:p.name,email:p.email}),children:"Delete"})]})]},p.id))}),c.jsx(n1,{isOpen:n.open,onClose:()=>l({open:!1}),initial:n.user}),c.jsx(bu,{isOpen:o.open,isDeleting:a.isPending,onConfirm:m,onCancel:x,title:"Delete User?",description:"Are you sure you want to delete this user? This action cannot be undone.",children:o.user&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsx("div",{className:"flex items-start gap-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:o.user.name}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Email: ",o.user.email]})]})})})})]})}function DU(){const{id:e}=yn(),t=_a(),{data:r,isLoading:a,isError:n}=NU(e);return a?c.jsx("div",{className:"p-6 flex justify-center",children:c.jsx(Un,{})}):n||!r?c.jsx("div",{className:"p-6 text-red-500 text-center",children:"Couldnt load user."}):c.jsx(n1,{isOpen:!0,initial:r,onClose:()=>t(-1)})}const ek="wallet-budget-",tk=(e,t)=>{try{localStorage.setItem(`${ek}${e}`,t.toString())}catch(r){console.error("Failed to save budget to localStorage:",r)}},FU=e=>{try{const t=localStorage.getItem(`${ek}${e}`);if(t===null)return null;const r=parseFloat(t);return isNaN(r)?null:r}catch(t){return console.error("Failed to read budget from localStorage:",t),null}};function s1(e){return{...e,totalBudget:e.budget,currency:e.currency}}function OU(e){return Xr({queryKey:["wallet",e],queryFn:async()=>{var t,r;try{const a=await Ze.get(ig.getByEvent(e));console.log("Wallet API Response:",a.data);const n=((t=a.data)==null?void 0:t.data)??a.data;if(!n||!Array.isArray(n)||n.length===0)return console.log("No wallet found in response"),null;const l=n[0];console.log("Found wallet (raw):",l);const o=s1(l);if(o.totalBudget===void 0||o.totalBudget===null){const f=FU(o.walletGuid);f!==null&&(o.totalBudget=f,console.log("Using localStorage budget (fallback):",f))}else console.log("Using backend budget:",o.totalBudget);return o}catch(a){if(console.error("Wallet API Error:",a),((r=a.response)==null?void 0:r.status)===404)return null;throw a}},enabled:!!e,staleTime:1*6e4,refetchOnMount:!0})}function MU(){const e=bt();return kt({mutationFn:async({totalBudget:t,...r})=>{var f;const a={...r,budget:t};console.log("Creating wallet, payload:",a);const n=await Ze.post(ig.create,a),l=((f=n.data)==null?void 0:f.data)??n.data;console.log("Wallet created, backend response:",l);const o=s1(l);return t!==void 0&&o.walletGuid&&(tk(o.walletGuid,t),console.log("Saved budget to localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet"]}),e.refetchQueries({queryKey:["wallet",t.eventGuid]})}})}function LU(){const e=bt();return kt({mutationFn:async({totalBudget:t,...r})=>{var f;const a={...r,budget:t};console.log("Updating wallet, payload:",a);const n=await Ze.post(ig.update,a),l=((f=n.data)==null?void 0:f.data)??n.data;console.log("Wallet updated, backend response:",l);const o=s1(l);return t!==void 0&&o.walletGuid&&(tk(o.walletGuid,t),console.log("Updated budget in localStorage as backup:",t)),o},onSuccess:t=>{e.invalidateQueries({queryKey:["wallet",t.eventGuid]}),e.invalidateQueries({queryKey:["wallet",t.walletGuid]})}})}const Sa={Credit:0,Debit:1},ga={Venue:"Venue",Catering:"Catering",Photography:"Photography",Decoration:"Decoration",Attire:"Attire",Entertainment:"Entertainment",Transport:"Transport",Invitation:"Invitation",Gifts:"Gifts",Others:"Others"},Jt={Paid:"Paid",Pending:"Pending",Overdue:"Overdue"},BU=e=>{let t={_extended:{},notes:""};if(e.remarks)try{const r=JSON.parse(e.remarks);r&&typeof r=="object"&&"_extended"in r?t=r:t.notes=e.remarks}catch{t.notes=e.remarks}return{...e,category:e.category,remarks:t.notes||"",vendorName:t._extended.vendorName,vendorContact:t._extended.vendorContact,paymentStatus:t._extended.paymentStatus,dueDate:t._extended.dueDate}},PU=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},IU=e=>{const t={_extended:{vendorName:e.vendorName,vendorContact:e.vendorContact,paymentStatus:e.paymentStatus,dueDate:e.dueDate},notes:e.remarks||""};return{transactionGuid:e.transactionGuid,walletGuid:e.walletGuid,eventGuid:e.eventGuid,type:e.type,transactionName:e.transactionName,transactionDate:e.transactionDate,category:e.category,amount:e.amount,referenceId:e.referenceId,remarks:JSON.stringify(t)}},Do=(e,t="RM")=>{const a=Math.abs(e).toLocaleString("en-MY",{minimumFractionDigits:2,maximumFractionDigits:2});return`${t} ${a}`},rk=e=>e===0?"Credit":"Debit";function UU(e,t){return Xr({queryKey:["transactions",e],queryFn:async()=>{var r,a;try{const n=await Ze.get(Gd.getByWallet(e,t)),l=((r=n.data)==null?void 0:r.data)??n.data;return!l||!Array.isArray(l)?[]:l.map(o=>BU(o))}catch(n){if(((a=n.response)==null?void 0:a.status)===404)return[];throw n}},enabled:!!e&&!!t,staleTime:2*6e4})}function zU(){const e=bt();return kt({mutationFn:async t=>{var n;const r=PU(t),a=await Ze.post(Gd.create,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function HU(){const e=bt();return kt({mutationFn:async t=>{var n;const r=IU(t),a=await Ze.post(Gd.update,r);return((n=a.data)==null?void 0:n.data)??a.data},onSuccess:(t,r)=>{r.walletGuid&&r.eventGuid&&(e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]}))}})}function GU(){const e=bt();return kt({mutationFn:async t=>{var a;const r=await Ze.post(Gd.delete,t);return((a=r.data)==null?void 0:a.data)??r.data},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["transactions",r.walletGuid]}),e.invalidateQueries({queryKey:["transaction",r.transactionGuid]}),e.invalidateQueries({queryKey:["wallet",r.eventGuid]})}})}const fl={MYR:"MYR",USD:"USD",SGD:"SGD",IDR:"IDR"},Jo={[fl.MYR]:{flag:"",label:"Malaysian Ringgit",symbol:"RM"},[fl.USD]:{flag:"",label:"US Dollar",symbol:"$"},[fl.SGD]:{flag:"",label:"Singapore Dollar",symbol:"S$"},[fl.IDR]:{flag:"",label:"Indonesian Rupiah",symbol:"Rp"}},Qw=({isOpen:e,onClose:t,eventGuid:r,userId:a,wallet:n})=>{const[l,o]=C.useState(fl.MYR),[f,d]=C.useState(""),[x,m]=C.useState({}),p=MU(),v=LU(),y=!!n;C.useEffect(()=>{var N;n?(o(n.currency),d(((N=n.totalBudget)==null?void 0:N.toString())||"")):(o(fl.MYR),d("")),m({})},[n,e]);const b=()=>{const N={};if(l||(N.currency="Please select a currency"),f){const k=parseFloat(f);(isNaN(k)||k<=0)&&(N.budget="Budget must be a positive number")}return m(N),Object.keys(N).length===0},S=async N=>{if(N.preventDefault(),!b())return;const k=f?parseFloat(f):void 0;try{if(y&&n)console.log("Updating wallet:",{eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:k}),await v.mutateAsync({eventGuid:r,walletGuid:n.walletGuid,userId:a,currency:l,totalBudget:k});else{console.log("Creating wallet:",{eventGuid:r,userId:a,currency:l,totalBudget:k});const R=await p.mutateAsync({eventGuid:r,userId:a,currency:l,totalBudget:k});console.log("Wallet created successfully:",R)}t()}catch(R){console.error("Failed to save wallet:",R),alert("Failed to save wallet: "+R.message)}},E=()=>{!p.isPending&&!v.isPending&&t()},_=[{label:"Venue",percentage:"30%"},{label:"Catering",percentage:"25%"},{label:"Photography",percentage:"15%"},{label:"Decoration",percentage:"10%"},{label:"Attire",percentage:"10%"},{label:"Others",percentage:"10%"}];return c.jsx(zn,{isOpen:e,onClose:E,title:y?"Update Wallet":"Setup Wallet",className:"max-w-md",children:c.jsxs("form",{onSubmit:S,className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:y?"Update your wallet configuration":"Configure your event budget and currency"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Currency *"}),c.jsx("select",{value:l,onChange:N=>o(N.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:Object.values(fl).map(N=>{const k=Jo[N];return c.jsxs("option",{value:N,children:[k.flag," ",N," - ",k.label]},N)})}),x.currency&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.currency})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Total Budget (Optional)"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:Jo[l].symbol}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:f,onChange:N=>d(N.target.value),placeholder:"50000",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 pl-12 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Set your maximum budget for this event"}),x.budget&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:x.budget})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-primary/5 to-secondary/5 border border-primary/10",children:[c.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:" Suggested Budget Allocation"}),c.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400",children:_.map(N=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:[N.label,":"]}),c.jsx("span",{className:"font-medium",children:N.percentage})]},N.label))})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Le,{type:"button",variant:"secondary",onClick:E,disabled:p.isPending||v.isPending,className:"flex-1",children:"Cancel"}),c.jsx(Le,{type:"submit",variant:"primary",loading:p.isPending||v.isPending,className:"flex-1 bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:y?"Update Wallet":"Create Wallet"})]}),(p.isError||v.isError)&&c.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save wallet. Please try again."})]})})},K0={[ga.Venue]:{emoji:"",label:"Venue",color:"purple",bgColor:"bg-purple-100",textColor:"text-purple-700",borderColor:"border-purple-200"},[ga.Catering]:{emoji:"",label:"Catering",color:"orange",bgColor:"bg-orange-100",textColor:"text-orange-700",borderColor:"border-orange-200"},[ga.Photography]:{emoji:"",label:"Photography",color:"pink",bgColor:"bg-pink-100",textColor:"text-pink-700",borderColor:"border-pink-200"},[ga.Decoration]:{emoji:"",label:"Decoration",color:"teal",bgColor:"bg-teal-100",textColor:"text-teal-700",borderColor:"border-teal-200"},[ga.Attire]:{emoji:"",label:"Attire",color:"indigo",bgColor:"bg-indigo-100",textColor:"text-indigo-700",borderColor:"border-indigo-200"},[ga.Entertainment]:{emoji:"",label:"Entertainment",color:"violet",bgColor:"bg-violet-100",textColor:"text-violet-700",borderColor:"border-violet-200"},[ga.Transport]:{emoji:"",label:"Transport",color:"blue",bgColor:"bg-blue-100",textColor:"text-blue-700",borderColor:"border-blue-200"},[ga.Invitation]:{emoji:"",label:"Invitation",color:"rose",bgColor:"bg-rose-100",textColor:"text-rose-700",borderColor:"border-rose-200"},[ga.Gifts]:{emoji:"",label:"Gifts",color:"amber",bgColor:"bg-amber-100",textColor:"text-amber-700",borderColor:"border-amber-200"},[ga.Others]:{emoji:"",label:"Others",color:"gray",bgColor:"bg-gray-100",textColor:"text-gray-700",borderColor:"border-gray-200"}},Zw=e=>K0[e]||K0[ga.Others],ak=()=>Object.values(ga),VU=({isOpen:e,onClose:t,walletGuid:r,eventGuid:a,transaction:n})=>{const[l,o]=C.useState(Sa.Debit),[f,d]=C.useState(""),[x,m]=C.useState(""),[p,v]=C.useState(""),[y,b]=C.useState(ga.Others),[S,E]=C.useState(""),[_,N]=C.useState(""),[k,R]=C.useState(Jt.Paid),[A,D]=C.useState(""),[T,O]=C.useState(""),[F,q]=C.useState(""),[X,U]=C.useState({}),ee=zU(),oe=HU(),ce=!!n;C.useEffect(()=>{n?(o(n.type),d(n.transactionName),m(n.amount.toString()),v(n.transactionDate?new Date(n.transactionDate).toISOString().split("T")[0]:""),b(n.category),E(n.vendorName||""),N(n.vendorContact||""),R(n.paymentStatus||Jt.Paid),D(n.dueDate?new Date(n.dueDate).toISOString().split("T")[0]:""),O(n.referenceId||""),q(n.remarks||"")):Z(),U({})},[n,e]);const Z=()=>{o(Sa.Debit),d(""),m(""),v(new Date().toISOString().split("T")[0]),b(ga.Others),E(""),N(""),R(Jt.Paid),D(""),O(""),q("")},ie=()=>{const z={};if(f.trim()||(z.transactionName="Transaction name is required"),!x)z.amount="Amount is required";else{const te=parseFloat(x);(isNaN(te)||te<=0)&&(z.amount="Amount must be a positive number")}return p||(z.transactionDate="Transaction date is required"),y||(z.category="Category is required"),U(z),Object.keys(z).length===0},ke=async z=>{if(z.preventDefault(),!ie())return;const te={walletGuid:r,eventGuid:a,type:l,transactionName:f.trim(),amount:parseFloat(x),transactionDate:p,category:y,vendorName:S.trim()||void 0,vendorContact:_.trim()||void 0,paymentStatus:k,dueDate:A||void 0,referenceId:T.trim()||void 0,remarks:F.trim()||void 0};try{ce&&n?await oe.mutateAsync({...te,transactionGuid:n.transactionGuid}):await ee.mutateAsync(te),t()}catch(B){console.error("Failed to save transaction:",B)}},re=()=>{!ee.isPending&&!oe.isPending&&t()};return c.jsx(zn,{isOpen:e,onClose:re,title:ce?"Edit Transaction":"Add Transaction",className:"max-w-lg max-h-[90vh] overflow-y-auto",children:c.jsxs("form",{onSubmit:ke,className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:ce?"Update transaction details":"Record a new expense or income"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Transaction Type *"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>o(Sa.Debit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===Sa.Debit?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-red-500 hover:bg-red-50 dark:hover:bg-red-900/10"}`,children:[c.jsx("span",{children:""})," Debit (Expense)"]}),c.jsxs("button",{type:"button",onClick:()=>o(Sa.Credit),className:`px-4 py-3 rounded-xl font-semibold text-sm border-2 flex items-center justify-center gap-2 transition ${l===Sa.Credit?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400 hover:border-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/10"}`,children:[c.jsx("span",{children:""})," Credit (Income)"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Transaction Name *"}),c.jsx("input",{type:"text",value:f,onChange:z=>d(z.target.value),placeholder:"e.g. Venue Deposit Payment",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),X.transactionName&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:X.transactionName})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount *"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:x,onChange:z=>m(z.target.value),placeholder:"0.00",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),X.amount&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:X.amount})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date *"}),c.jsx("input",{type:"date",value:p,onChange:z=>v(z.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0}),X.transactionDate&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:X.transactionDate})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category *"}),c.jsx("select",{value:y,onChange:z=>b(z.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",required:!0,children:ak().map(z=>{const te=K0[z];return c.jsxs("option",{value:z,children:[te.emoji," ",te.label]},z)})}),X.category&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:X.category})]}),c.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Vendor Information (Optional)"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Vendor Name"}),c.jsx("input",{type:"text",value:S,onChange:z=>E(z.target.value),placeholder:"e.g. Shangri-La Hotel",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Contact Number / Email"}),c.jsx("input",{type:"text",value:_,onChange:z=>N(z.target.value),placeholder:"e.g. +60 3-2074 3900",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Payment Status"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsx("button",{type:"button",onClick:()=>R(Jt.Paid),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===Jt.Paid?"border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Paid"}),c.jsx("button",{type:"button",onClick:()=>R(Jt.Pending),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===Jt.Pending?"border-amber-500 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Pending"}),c.jsx("button",{type:"button",onClick:()=>R(Jt.Overdue),className:`px-3 py-2 rounded-xl text-sm font-medium border-2 transition ${k===Jt.Overdue?"border-red-500 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,children:" Overdue"})]})]}),(k===Jt.Pending||k===Jt.Overdue)&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due Date (Optional)"}),c.jsx("input",{type:"date",value:A,onChange:z=>D(z.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reference ID (Optional)"}),c.jsx("input",{type:"text",value:T,onChange:z=>O(z.target.value),placeholder:"e.g. Invoice number, Receipt ID",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remarks (Optional)"}),c.jsx("textarea",{rows:2,value:F,onChange:z=>q(z.target.value),placeholder:"Additional notes...",className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none"})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Le,{type:"button",variant:"secondary",onClick:re,disabled:ee.isPending||oe.isPending,className:"flex-1",children:"Cancel"}),c.jsx(Le,{type:"submit",variant:"primary",loading:ee.isPending||oe.isPending,className:"flex-1",children:ce?"Update Transaction":"Save Transaction"})]}),(ee.isError||oe.isError)&&c.jsx("p",{className:"text-red-500 text-sm text-center mt-2",children:"Failed to save transaction. Please try again."})]})})},qU=({isOpen:e,onClose:t,transactions:r,wallet:a})=>{const[n,l]=C.useState(""),[o,f]=C.useState(""),[d,x]=C.useState("csv"),[m,p]=C.useState(!0),[v,y]=C.useState(!0),[b,S]=C.useState(!1),E=k=>!n&&!o?k:k.filter(R=>{if(!R.transactionDate)return!1;const A=new Date(R.transactionDate),D=n?new Date(n):null,T=o?new Date(o):null;return!(D&&A<D||T&&A>T)}),_=()=>{const k=E(r);if(k.length===0){alert("No transactions to export with the selected date range.");return}const R=Jo[a.currency].symbol;let A="";if(A+=`Event Wallet Report
`,A+=`Currency: ${a.currency}
`,A+=`Generated: ${new Date().toLocaleDateString()}
`,A+=`Date Range: ${n||"All"} to ${o||"All"}
`,A+=`
`,m){A+=`Transaction Details
`;const F=["Date","Transaction Name","Type","Category",b?"Vendor":null,b?"Vendor Contact":null,"Amount","Status","Reference ID","Remarks"].filter(Boolean);A+=F.join(",")+`
`,k.forEach(q=>{const X=[q.transactionDate||"",`"${q.transactionName.replace(/"/g,'""')}"`,rk(q.type),q.category,b?`"${(q.vendorName||"").replace(/"/g,'""')}"`:null,b?`"${(q.vendorContact||"").replace(/"/g,'""')}"`:null,q.amount,q.paymentStatus||"",q.referenceId||"",`"${(q.remarks||"").replace(/"/g,'""')}"`].filter(U=>U!==null);A+=X.join(",")+`
`}),A+=`
`}if(v){A+=`Category Summary
`,A+=`Category,Total Spent,Percentage,Transaction Count
`;const F=new Map,q=k.filter(X=>X.type===1).reduce((X,U)=>X+U.amount,0);k.filter(X=>X.type===1).forEach(X=>{const U=F.get(X.category)||{amount:0,count:0};F.set(X.category,{amount:U.amount+X.amount,count:U.count+1})}),F.forEach((X,U)=>{const ee=q>0?X.amount/q*100:0;A+=`${U},${R} ${X.amount.toFixed(2)},${ee.toFixed(1)}%,${X.count}
`}),A+=`
`,A+=`Total Spending,${R} ${q.toFixed(2)}
`}const D=new Blob([A],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),O=URL.createObjectURL(D);T.setAttribute("href",O),T.setAttribute("download",`wallet-report-${Date.now()}.csv`),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T),t()},N=()=>{d==="csv"?_():alert(`${d.toUpperCase()} export coming soon!`)};return c.jsx(zn,{isOpen:e,onClose:t,title:"Export Report",className:"max-w-md",children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Download your transaction report"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date Range"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"From"}),c.jsx("input",{type:"date",value:n,onChange:k=>l(k.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"To"}),c.jsx("input",{type:"date",value:o,onChange:k=>f(k.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-lg p-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Export Format"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("button",{type:"button",onClick:()=>x("csv"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="csv"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="csv"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"CSV"})]}),c.jsxs("button",{type:"button",onClick:()=>x("excel"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="excel"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="excel"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"Excel"})]}),c.jsxs("button",{type:"button",onClick:()=>x("pdf"),className:`p-4 rounded-xl border-2 flex flex-col items-center gap-2 transition ${d==="pdf"?"border-primary bg-primary/5":"border-gray-200 dark:border-gray-700 hover:border-primary hover:bg-primary/5"}`,children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:`text-sm font-medium ${d==="pdf"?"text-primary":"text-gray-600 dark:text-gray-400"}`,children:"PDF"})]})]}),d!=="csv"&&c.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:["Note: ",d.toUpperCase()," export is coming soon. CSV is currently available."]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Include in Report"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:m,onChange:k=>p(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Transaction details"})]}),c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:v,onChange:k=>y(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Category summary"})]}),c.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:[c.jsx("input",{type:"checkbox",checked:b,onChange:k=>S(k.target.checked),className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Vendor information"})]})]})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx(Le,{type:"button",variant:"secondary",onClick:t,className:"flex-1",children:"Cancel"}),c.jsxs(Le,{type:"button",variant:"primary",onClick:N,className:"flex-1",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Download"]})]})]})})},WU=({wallet:e,transactions:t,onEditBudget:r})=>{const a=Jo[e.currency].symbol,n=t.filter(m=>m.type===Sa.Debit).reduce((m,p)=>m+p.amount,0),l=t.filter(m=>m.type===Sa.Debit&&(m.paymentStatus===Jt.Pending||m.paymentStatus===Jt.Overdue)).reduce((m,p)=>m+p.amount,0),o=t.filter(m=>m.type===Sa.Debit&&(m.paymentStatus===Jt.Pending||m.paymentStatus===Jt.Overdue)).length,f=e.totalBudget||0,d=f-n,x=f>0?n/f*100:0;return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[c.jsxs("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-primary to-secondary text-white shadow-xl shadow-primary/20 cursor-pointer hover:shadow-2xl transition-shadow",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-white/20 backdrop-blur grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})})}),c.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/20 font-medium",children:e.currency})]}),c.jsx("p",{className:"text-sm text-white/80 font-medium",children:"Total Budget"}),c.jsx("p",{className:"text-3xl font-bold mt-1",children:f>0?Do(f,a):"Not Set"}),c.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-white/70",children:c.jsxs("button",{onClick:r,className:"hover:text-white transition-colors",children:[" Click to ",f>0?"edit":"set"," budget"]})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-red-100 dark:bg-red-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-red-600 dark:text-red-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"})})}),f>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 font-semibold",children:[x.toFixed(0),"%"]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Current Spending"}),c.jsx("p",{className:"text-3xl font-bold text-slate-800 dark:text-white mt-1",children:Do(n,a)}),f>0&&c.jsx("div",{className:"mt-3",children:c.jsx("div",{className:"w-full h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-red-400 to-red-600 rounded-full transition-all duration-500",style:{width:`${Math.min(x,100)}%`}})})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-emerald-100 dark:bg-emerald-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-emerald-600 dark:text-emerald-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 font-semibold",children:[(100-x).toFixed(0),"%"]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Remaining Budget"}),c.jsx("p",{className:`text-3xl font-bold mt-1 ${f>0?d>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:f>0?Do(d,a):"N/A"}),c.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs",children:f>0?d>=0?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:""}),c.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"On track"})]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"text-red-600 dark:text-red-400",children:""}),c.jsx("span",{className:"text-red-600 dark:text-red-400",children:"Over budget"})]}):c.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"Set budget to track"})})]}),c.jsxs("div",{className:"p-5 rounded-2xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-lg",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("div",{className:"h-12 w-12 rounded-xl bg-amber-100 dark:bg-amber-900/30 grid place-items-center",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-amber-600 dark:text-amber-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o>0&&c.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 font-semibold",children:[o," item",o!==1?"s":""]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Pending Payments"}),c.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400 mt-1",children:Do(l,a)}),c.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-amber-600 dark:text-amber-400",children:[t.filter(m=>m.paymentStatus===Jt.Overdue).length>0&&c.jsxs("span",{children:[""," ",t.filter(m=>m.paymentStatus===Jt.Overdue).length," ","overdue payment",t.filter(m=>m.paymentStatus===Jt.Overdue).length!==1?"s":""]}),o===0&&c.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:" All paid"})]})]})]})},XU=({wallet:e,transactions:t})=>{const r=Jo[e.currency].symbol,a=t.filter(o=>o.type===Sa.Debit).reduce((o,f)=>o+f.amount,0),n=new Map;t.filter(o=>o.type===Sa.Debit).forEach(o=>{const f=n.get(o.category)||{amount:0,count:0};n.set(o.category,{amount:f.amount+o.amount,count:f.count+1})});const l=Array.from(n.entries()).map(([o,f])=>({category:o,amount:f.amount,percentage:a>0?f.amount/a*100:0,transactionCount:f.count})).sort((o,f)=>f.amount-o.amount);return l.length===0?c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),c.jsx("div",{className:"p-8 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm text-center",children:c.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No spending data yet. Start adding transactions to see your spending breakdown."})})]}):c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-2",children:" Spending by Category"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[l.map(({category:o,amount:f,percentage:d,transactionCount:x})=>{const m=Zw(o),p=m.color;return c.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-xl",children:m.emoji}),c.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:m.label})]}),c.jsx("p",{className:"text-lg font-bold text-slate-800 dark:text-white",children:Do(f,r)}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:`h-full rounded-full transition-all duration-500 bg-${p}-500`,style:{width:`${Math.min(d,100)}%`}})}),c.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:[d.toFixed(0),"%"]})]}),c.jsxs("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:[x," transaction",x!==1?"s":""]})]},o)}),Object.values(ga).filter(o=>!n.has(o)).slice(0,Math.max(0,6-l.length)).map(o=>{const f=Zw(o);return c.jsxs("div",{className:"p-4 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-100 dark:border-gray-700 opacity-50",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx("span",{className:"text-xl",children:f.emoji}),c.jsx("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:f.label})]}),c.jsxs("p",{className:"text-lg font-bold text-gray-400 dark:text-gray-500",children:[r," 0.00"]}),c.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden",children:c.jsx("div",{className:"h-full rounded-full",style:{width:"0%"}})}),c.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:"0%"})]})]},o)})]})]})},YU=({wallet:e,transactions:t,onEditTransaction:r})=>{const[a,n]=C.useState("All"),[l,o]=C.useState("All"),[f,d]=C.useState("All"),[x,m]=C.useState(""),[p,v]=C.useState({open:!1,transaction:null}),y=GU(),b=Jo[e.currency].symbol,S=C.useMemo(()=>t.filter(D=>{var T,O;if(a!=="All"&&D.category!==a)return!1;if(l!=="All"){const F=l==="Debit";if(F&&D.type!==Sa.Debit||!F&&D.type!==Sa.Credit)return!1}if(f!=="All"&&D.paymentStatus!==f)return!1;if(x){const F=x.toLowerCase();return D.transactionName.toLowerCase().includes(F)||((T=D.vendorName)==null?void 0:T.toLowerCase().includes(F))||((O=D.referenceId)==null?void 0:O.toLowerCase().includes(F))}return!0}),[t,a,l,f,x]),E=C.useMemo(()=>[...S].sort((D,T)=>{const O=D.transactionDate?new Date(D.transactionDate).getTime():0;return(T.transactionDate?new Date(T.transactionDate).getTime():0)-O}),[S]),_=D=>{v({open:!0,transaction:D})},N=()=>{v({open:!1,transaction:null})},k=async()=>{if(p.transaction)try{await y.mutateAsync({transactionGuid:p.transaction.transactionGuid,walletGuid:p.transaction.walletGuid,eventGuid:p.transaction.eventGuid}),v({open:!1,transaction:null})}catch(D){console.error("Failed to delete transaction:",D),alert("Failed to delete transaction. Please try again.")}},R=D=>{if(!D)return null;const O={[Jt.Paid]:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-400",dot:"bg-emerald-500",label:"Paid",icon:""},[Jt.Pending]:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-400",dot:"bg-amber-500",label:"Pending",icon:""},[Jt.Overdue]:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",dot:"bg-red-500 animate-pulse",label:"Overdue",icon:""}}[D];return c.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${O.bg} ${O.text} flex items-center gap-1 w-fit`,children:[c.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${O.dot}`}),O.label]})},A=D=>{let T="transaction-row transition-colors hover:bg-gray-50 dark:hover:bg-gray-800/50";return D.paymentStatus===Jt.Pending?T+=" bg-amber-50/30 dark:bg-amber-900/10":D.paymentStatus===Jt.Overdue&&(T+=" bg-red-50/30 dark:bg-red-900/10"),T};return c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-4",children:[c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:a,onChange:D=>n(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Categories"}),ak().map(D=>{const T=K0[D];return c.jsxs("option",{value:D,children:[T.emoji," ",T.label]},D)})]}),c.jsxs("select",{value:l,onChange:D=>o(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Types"}),c.jsx("option",{value:"Debit",children:" Debit (Expense)"}),c.jsx("option",{value:"Credit",children:" Credit (Income)"})]}),c.jsxs("select",{value:f,onChange:D=>d(D.target.value),className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[c.jsx("option",{value:"All",children:"All Status"}),c.jsx("option",{value:Jt.Paid,children:" Paid"}),c.jsx("option",{value:Jt.Pending,children:" Pending"}),c.jsx("option",{value:Jt.Overdue,children:" Overdue"})]})]}),c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),c.jsx("input",{type:"text",placeholder:"Search transactions, vendors, reference ID...",value:x,onChange:D=>m(D.target.value),className:"w-full border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-xl pl-10 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-lg overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-800 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white",children:"Transaction History"}),c.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-primary/10 text-primary",children:[E.length," transaction",E.length!==1?"s":""]})]}),c.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Sorted by: ",c.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:"Date (Newest)"})]})]}),E.length===0?c.jsx("div",{className:"p-8 text-center",children:c.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:x||a!=="All"||l!=="All"||f!=="All"?"No transactions match your filters. Try adjusting your search criteria.":"No transactions yet. Click 'Add Transaction' to get started."})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50 text-left",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Transaction"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Category"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Vendor"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Amount"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:E.map(D=>{const T=K0[D.category],O=D.vendorName?D.vendorName.split(" ").map(F=>F[0]).join("").substring(0,2).toUpperCase():null;return c.jsxs("tr",{className:A(D),children:[c.jsxs("td",{className:"px-4 py-4",children:[c.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.transactionDate?new Date(D.transactionDate).toLocaleDateString("en-MY",{day:"2-digit",month:"short",year:"numeric"}):"N/A"}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.transactionDate?new Date(D.transactionDate).toLocaleTimeString("en-MY",{hour:"2-digit",minute:"2-digit"}):""})]}),c.jsx("td",{className:"px-4 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`h-10 w-10 rounded-xl ${T.bgColor} grid place-items-center text-lg`,children:T.emoji}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.transactionName}),D.referenceId&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",D.referenceId]})]})]})}),c.jsx("td",{className:"px-4 py-4",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-full ${T.bgColor} ${T.textColor}`,children:T.label})}),c.jsx("td",{className:"px-4 py-4",children:D.vendorName?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`h-7 w-7 rounded-lg bg-gradient-to-br from-${T.color}-500 to-${T.color}-700 text-white text-xs font-bold grid place-items-center`,children:O}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:D.vendorName}),D.vendorContact&&c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:D.vendorContact})]})]}):c.jsx("span",{className:"text-sm text-gray-400 dark:text-gray-500",children:""})}),c.jsxs("td",{className:"px-4 py-4",children:[c.jsxs("div",{className:`text-sm font-bold ${D.type===Sa.Debit?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[D.type===Sa.Debit?"- ":"+ ",Do(D.amount,b)]}),c.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:rk(D.type)})]}),c.jsx("td",{className:"px-4 py-4",children:R(D.paymentStatus)}),c.jsx("td",{className:"px-4 py-4",children:c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:()=>r(D),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 transition",title:"Edit",children:""}),c.jsx("button",{onClick:()=>_(D),disabled:y.isPending,className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-500 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition disabled:opacity-50",title:"Delete",children:""})]})})]},D.transactionGuid)})})]})})]}),c.jsx(bu,{isOpen:p.open,isDeleting:y.isPending,onConfirm:k,onCancel:N,title:"Delete Transaction?",description:"Are you sure you want to delete this transaction? This will permanently remove it from your records.",children:p.transaction&&c.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 border border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white mb-1",children:p.transaction.transactionName}),p.transaction.vendorName&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Vendor: ",p.transaction.vendorName]}),p.transaction.referenceId&&c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Ref: ",p.transaction.referenceId]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:`text-sm font-bold ${p.transaction.type===1?"text-red-600 dark:text-red-400":"text-emerald-600 dark:text-emerald-400"}`,children:[p.transaction.type===1?"-":"+"," ",p.transaction.amount.toFixed(2)]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:p.transaction.category})]})]})})})]})};function $U(){const{eventId:e}=Yr();if(!e)return c.jsx(Gl,{title:"No Events for Budget Tracking",message:"Create your first event to start managing your budget and tracking expenses."});const{user:t}=C.useContext(lg),{data:r,isLoading:a,isError:n}=OU(e),{data:l=[]}=UU((r==null?void 0:r.walletGuid)||"",e),[o,f]=C.useState({open:!1,editMode:!1}),[d,x]=C.useState({open:!1}),[m,p]=C.useState(!1),v=(_=!1)=>{f({open:!0,editMode:_})},y=()=>{f({open:!1,editMode:!1})},b=()=>{x({open:!0,transaction:void 0})},S=_=>{x({open:!0,transaction:_})},E=()=>{x({open:!1,transaction:void 0})};return a?c.jsx(Ka,{message:"Loading wallet..."}):n?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-red-500 mb-4",children:"Failed to load wallet data"}),c.jsx(Le,{onClick:()=>window.location.reload(),variant:"secondary",children:"Try Again"})]})}):r?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-semibold text-primary flex items-center gap-2",children:" Wallet & Budget"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Track your event expenses and manage your budget"})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs(Le,{disabled:!0,variant:"secondary",className:"flex items-center gap-2 opacity-50 cursor-not-allowed relative",title:"Coming Soon",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),"Export Report",c.jsx("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 px-2 py-0.5 rounded-full ml-1",children:"Coming Soon"})]}),c.jsxs(Le,{onClick:()=>v(!0),className:"bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg shadow-emerald-500/25 flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]}),c.jsxs(Le,{onClick:b,variant:"primary",className:"flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),"Add Transaction"]})]})]}),c.jsx(WU,{wallet:r,transactions:l,onEditBudget:()=>v(!0)}),c.jsx(XU,{wallet:r,transactions:l}),c.jsx(YU,{wallet:r,transactions:l,onEditTransaction:S}),c.jsx(Qw,{isOpen:o.open,onClose:y,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:o.editMode?r:null}),c.jsx(VU,{isOpen:d.open,onClose:E,walletGuid:r.walletGuid,eventGuid:e,transaction:d.transaction}),c.jsx(qU,{isOpen:m,onClose:()=>p(!1),transactions:l,wallet:r})]}):c.jsxs("div",{className:"flex items-center justify-center h-screen",children:[c.jsxs("div",{className:"text-center max-w-md",children:[c.jsx("div",{className:"h-24 w-24 rounded-full bg-gradient-to-br from-primary to-secondary text-white text-4xl font-bold grid place-items-center mx-auto mb-6 shadow-xl shadow-primary/25",children:""}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Setup Your Wallet"}),c.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Get started by setting up your event wallet to track expenses and manage your budget."}),c.jsxs(Le,{onClick:()=>v(!1),variant:"primary",className:"bg-gradient-to-r from-emerald-500 to-emerald-600 shadow-lg shadow-emerald-500/25",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 mr-2",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 0V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v3"})}),"Setup Wallet"]})]}),c.jsx(Qw,{isOpen:o.open,onClose:y,eventGuid:e,userId:(t==null?void 0:t.id)||"todo",wallet:null})]})}function KU(e){const t={0:"under_budget",1:"on_budget",2:"over_budget"};return{eventStats:{eventName:e.eventStats.eventName,eventDate:e.eventStats.eventDate,eventTime:e.eventStats.eventTime,eventLocation:e.eventStats.eventLocation,noOfTable:e.eventStats.noOfTable},rsvpStats:{totalRsvpsReceived:e.rsvpStats.totalRsvpsReceived,comingCount:e.rsvpStats.comingCount,notComingCount:e.rsvpStats.notComingCount,pendingCount:e.rsvpStats.pendingCount,totalGuestsConfirmed:e.rsvpStats.totalGuestsConfirmed,responseRate:e.rsvpStats.responseRate,newConfirmationsToday:e.rsvpStats.newConfirmationsToday},tableStats:{totalTables:e.tableStats.totalTables,arrangedTables:e.tableStats.arrangedTables,assignedGuests:e.tableStats.assignedGuests,unassignedGuests:e.tableStats.unassignedGuests,totalSeats:e.tableStats.totalSeats,occupiedSeats:e.tableStats.occupiedSeats},budgetStats:{totalBudget:e.budgetStats.totalBudget,spentAmount:e.budgetStats.spentAmount,remainingAmount:e.budgetStats.remainingAmount,spentPercentage:e.budgetStats.spentPercentage,status:t[e.budgetStats.status]||"under_budget"},recentActivity:e.recentActivity.map(r=>({activityType:r.activityType,description:r.description,details:r.details,timestamp:r.timestamp,icon:r.icon}))}}function QU(e){return Xr({queryKey:["dashboard",e],queryFn:async()=>{const t=await Ze.get(lA.summary(e));return KU(t.data.data)},enabled:!!e})}function ZU(e){const t=new Date,r=new Date(e),a=t.getTime()-r.getTime(),n=Math.floor(a/(1e3*60)),l=Math.floor(a/(1e3*60*60)),o=Math.floor(a/(1e3*60*60*24));return n<1?"Just now":n<60?`${n} min ago`:l<24?`${l} hour${l>1?"s":""} ago`:o===1?"Yesterday":o<7?`${o} days ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function JU(){var o,f,d,x,m,p,v,y,b,S,E,_,N,k,R,A,D;const e=_a(),{eventId:t}=Yr(),{data:r,isLoading:a}=QU(t||""),[n,l]=C.useState({days:0,hours:0,minutes:0});return C.useEffect(()=>{const T=()=>{var ee;const F=(ee=r==null?void 0:r.eventStats)==null?void 0:ee.eventDate;if(!F)return;const q=new Date().getTime(),U=new Date(F).getTime()-q;if(U>0){const oe=Math.floor(U/864e5),ce=Math.floor(U%(1e3*60*60*24)/(1e3*60*60)),Z=Math.floor(U%(1e3*60*60)/(1e3*60));l({days:oe,hours:ce,minutes:Z})}else l({days:0,hours:0,minutes:0})};T();const O=setInterval(T,6e4);return()=>clearInterval(O)},[(o=r==null?void 0:r.eventStats)==null?void 0:o.eventDate]),t?a||!r?c.jsx(Ka,{message:"Loading dashboard..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-white mb-1",children:["Good ",new Date().getHours()<12?"Morning":"Afternoon","! "]}),c.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Here's what's happening with your events today."})]})}),c.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 p-8 text-white shadow-2xl shadow-indigo-500/30",children:[c.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32"}),c.jsx("div",{className:"absolute bottom-0 left-1/2 w-48 h-48 bg-white/5 rounded-full translate-y-24"}),c.jsxs("div",{className:"relative flex flex-col lg:flex-row lg:items-center gap-6",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm font-medium mb-4",children:[c.jsx("span",{className:"h-2 w-2 rounded-full bg-green-400 animate-pulse"}),"Active Event"]}),c.jsx("h2",{className:"text-3xl font-bold mb-2",children:r.eventStats.eventName}),c.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-white/80",children:[r.eventStats.eventDate&&c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(cd,{className:"h-4 w-4"}),new Date(r.eventStats.eventDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),r.eventStats.eventLocation&&c.jsxs("span",{className:"flex items-center gap-1.5",children:[c.jsx(E6,{className:"h-4 w-4"}),r.eventStats.eventLocation]})]})]}),c.jsx("div",{className:"flex flex-col items-center gap-2",children:n.days===0&&n.hours===0&&n.minutes===0?c.jsx("div",{className:"text-center py-4",children:c.jsx("p",{className:"text-2xl font-bold text-white",children:"Today is your big day! "})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.days}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Days"})]}),c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.hours}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Hours"})]}),c.jsxs("div",{className:"px-5 py-3 rounded-xl bg-white/15 backdrop-blur-sm text-center min-w-[90px]",children:[c.jsx("p",{className:"text-3xl font-bold",children:n.minutes}),c.jsx("p",{className:"text-xs text-white/70 mt-0.5",children:"Minutes"})]})]}),c.jsx("p",{className:"text-white/90 text-sm font-medium",children:n.days<15?"Almost there! ":"until your big day"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-green-400 to-emerald-500 grid place-items-center shadow-lg shadow-green-500/20 group-hover:scale-110 transition",children:c.jsx(M0,{className:"h-6 w-6 text-white"})})}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"RSVP Status"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-1",children:[((f=r==null?void 0:r.rsvpStats)==null?void 0:f.totalRsvpsReceived)??0," ",c.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ ",((d=r==null?void 0:r.rsvpStats)==null?void 0:d.totalGuestsConfirmed)??0," responded"]})]}),c.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-0.5",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Coming:"}),c.jsxs("span",{className:"font-semibold",children:[((x=r==null?void 0:r.rsvpStats)==null?void 0:x.comingCount)??0," guests"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Not Coming:"}),c.jsxs("span",{className:"font-semibold",children:[((m=r==null?void 0:r.rsvpStats)==null?void 0:m.notComingCount)??0," guests"]})]})]}),c.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex items-center gap-2 text-xs text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 transition",children:[c.jsx(Bb,{className:"h-4 w-4"}),"View RSVPs"]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-indigo-100 dark:hover:border-indigo-800 transition-all group",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-indigo-400 to-purple-500 grid place-items-center shadow-lg shadow-indigo-500/20 group-hover:scale-110 transition",children:c.jsx(Np,{className:"h-6 w-6 text-white"})}),c.jsxs("span",{className:`text-xs px-2 py-1 rounded-full font-semibold ${((p=r==null?void 0:r.budgetStats)==null?void 0:p.status)==="over_budget"?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300":((v=r==null?void 0:r.budgetStats)==null?void 0:v.status)==="on_budget"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"}`,children:[((y=r==null?void 0:r.budgetStats)==null?void 0:y.spentPercentage)??0,"%"]})]}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Budget"}),c.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-3",children:["$",(((b=r==null?void 0:r.budgetStats)==null?void 0:b.spentAmount)??0).toLocaleString()," ",c.jsxs("span",{className:"text-sm font-normal text-slate-400",children:["/ $",(((S=r==null?void 0:r.budgetStats)==null?void 0:S.totalBudget)??0).toLocaleString()]})]}),c.jsx("div",{className:"w-full h-2 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden mb-2",children:c.jsx("div",{className:`h-full rounded-full transition-all ${(((E=r==null?void 0:r.budgetStats)==null?void 0:E.spentPercentage)??0)>100?"bg-gradient-to-r from-red-400 to-red-500":(((_=r==null?void 0:r.budgetStats)==null?void 0:_.spentPercentage)??0)>=90?"bg-gradient-to-r from-amber-400 to-orange-500":"bg-gradient-to-r from-indigo-400 to-purple-500"}`,style:{width:`${Math.min(((N=r==null?void 0:r.budgetStats)==null?void 0:N.spentPercentage)??0,100)}%`}})}),c.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex items-center gap-2 text-xs text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition",children:[c.jsx(u6,{className:"h-4 w-4"}),"Manage Budget"]})]}),c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg hover:border-pink-100 dark:hover:border-pink-800 transition-all group",children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsx("div",{className:"h-12 w-12 rounded-2xl bg-gradient-to-br from-pink-400 to-rose-500 grid place-items-center shadow-lg shadow-pink-500/20 group-hover:scale-110 transition",children:c.jsx(Lb,{className:"h-6 w-6 text-white"})})}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Seating Progress"}),c.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mb-3 space-y-1",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:"Guests seated:"}),c.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((k=r==null?void 0:r.tableStats)==null?void 0:k.assignedGuests)??0," / ",((R=r==null?void 0:r.tableStats)==null?void 0:R.totalSeats)??0]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:"Tables arranged:"}),c.jsxs("span",{className:"text-lg font-bold text-slate-800 dark:text-white",children:[((A=r==null?void 0:r.tableStats)==null?void 0:A.arrangedTables)??0," / ",((D=r==null?void 0:r.tableStats)==null?void 0:D.totalTables)??0]})]})]}),c.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex items-center gap-2 text-xs text-pink-600 dark:text-pink-400 hover:text-pink-700 dark:hover:text-pink-300 transition",children:[c.jsx(Cp,{className:"h-4 w-4"}),"Manage Tables"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 p-5",children:[c.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("button",{onClick:()=>e("/app/rsvps"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 border border-green-100 dark:border-green-800 hover:border-green-200 dark:hover:border-green-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-green-100 dark:bg-green-900/50 group-hover:bg-green-200 dark:group-hover:bg-green-800 grid place-items-center transition",children:c.jsx(M0,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add RSVP"})]}),c.jsxs("button",{onClick:()=>e("/app/rsvps/designer"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 border border-indigo-100 dark:border-indigo-800 hover:border-indigo-200 dark:hover:border-indigo-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-indigo-100 dark:bg-indigo-900/50 group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800 grid place-items-center transition",children:c.jsx(Lb,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Design RSVP"})]}),c.jsxs("button",{disabled:!0,className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-950/20 dark:to-violet-950/20 border border-purple-100 dark:border-purple-800 opacity-60 cursor-not-allowed",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-purple-100 dark:bg-purple-900/50 grid place-items-center",children:c.jsx(Bb,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Send Invites"})]}),c.jsxs("button",{onClick:()=>e("/app/tables"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-950/20 dark:to-orange-950/20 border border-amber-100 dark:border-amber-800 hover:border-amber-200 dark:hover:border-amber-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-amber-100 dark:bg-amber-900/50 group-hover:bg-amber-200 dark:group-hover:bg-amber-800 grid place-items-center transition",children:c.jsx(Cp,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Arrange Seats"})]}),c.jsxs("button",{onClick:()=>e("/app/wallet"),className:"flex flex-col items-center gap-2 p-4 rounded-xl bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-950/20 dark:to-rose-950/20 border border-pink-100 dark:border-pink-800 hover:border-pink-200 dark:hover:border-pink-700 hover:shadow-md transition group",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-pink-100 dark:bg-pink-900/50 group-hover:bg-pink-200 dark:group-hover:bg-pink-800 grid place-items-center transition",children:c.jsx(Np,{className:"h-5 w-5 text-pink-600 dark:text-pink-400"})}),c.jsx("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:"Add Expense"})]})]})]}),c.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between",children:c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Recent Activity"}),c.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Latest updates from your event"})]})}),c.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700 max-h-[400px] overflow-y-auto",children:r!=null&&r.recentActivity&&r.recentActivity.length>0?r.recentActivity.map((T,O)=>c.jsxs("div",{className:"px-6 py-4 hover:bg-slate-50/50 dark:hover:bg-slate-700/50 transition flex items-start gap-4",children:[c.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 grid place-items-center flex-shrink-0",children:c.jsx("span",{className:"text-lg",children:T.icon})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm text-slate-800 dark:text-white",children:T.description}),T.details&&c.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:T.details})]}),c.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 flex-shrink-0",children:ZU(T.timestamp)})]},O)):c.jsxs("div",{className:"px-6 py-12 text-center",children:[c.jsx("div",{className:"h-16 w-16 rounded-2xl bg-slate-100 dark:bg-slate-700 grid place-items-center mx-auto mb-4",children:c.jsx(p6,{className:"h-8 w-8 text-slate-400 dark:text-slate-500"})}),c.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-2 font-medium",children:"No activity yet"}),c.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:"Activity will appear here as guests respond and you manage your event"})]})})]})]})]}):c.jsx("div",{className:"space-y-6",children:c.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-950/20 dark:to-purple-950/20 rounded-2xl p-8 text-center",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsx("div",{className:"h-20 w-20 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 grid place-items-center",children:c.jsx(cd,{className:"h-10 w-10 text-white"})}),c.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-2",children:"Welcome to MyBigDays! "}),c.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"Select an event from the sidebar to get started with your planning dashboard"}),c.jsxs(Le,{onClick:()=>e("/app/events?new=1"),className:"inline-flex items-center gap-2",children:[c.jsx(cd,{className:"h-5 w-5"}),"Create Your First Event"]})]})})})}function ez(e){return Xr({queryKey:["rsvpDesign","public",e],enabled:!!e,staleTime:5*6e4,queryFn:async()=>{var t,r,a,n,l,o,f,d;try{const x=await Ze.get(F4.designByToken(e)),m=((t=x.data)==null?void 0:t.data)??x.data;if(m!=null&&m.design){const p=Q_(m);return!p.formFieldConfigs&&((r=m.design)!=null&&r.formFieldConfigs)&&(p.formFieldConfigs=m.design.formFieldConfigs),p}}catch{}if(typeof window<"u"){const x=window.localStorage.getItem(`rsvp-share-${e}`);if(x)try{const m=JSON.parse(x);return{blocks:m.blocks??[],flowPreset:m.flowPreset??"serene",globalBackgroundType:((a=m.global)==null?void 0:a.backgroundType)??"color",globalBackgroundAsset:((n=m.global)==null?void 0:n.backgroundAsset)??"",globalBackgroundColor:((l=m.global)==null?void 0:l.backgroundColor)??"#0f172a",globalOverlay:((o=m.global)==null?void 0:o.overlay)??.3,accentColor:((f=m.global)==null?void 0:f.accentColor)??"#f97316",globalMusicUrl:((d=m.global)==null?void 0:d.musicUrl)??void 0,eventGuid:m.eventGuid??void 0,formFieldConfigs:m.formFieldConfigs??[]}}catch{}}return null}})}function tz(){return kt({mutationFn:e=>Ze.post(F4.submit(e.eventId),{guestName:e.guestName,guestEmail:e.guestEmail,status:e.status,guestType:e.guestType,noOfPax:e.noOfPax,phoneNo:e.phoneNo??"",answers:e.answers,...e.answers}).then(t=>t.data)})}function rz(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}const az=["Family","Friend","VIP","Other"],nz=[{value:"Yes",label:"Yes, I'll be there",icon:"",activeClass:"border-emerald-400 bg-emerald-500/20 text-emerald-300"},{value:"No",label:"Sorry, can't make it",icon:"",activeClass:"border-rose-400 bg-rose-500/20 text-rose-300"},{value:"Maybe",label:"Maybe / Tentative",icon:"~",activeClass:"border-amber-400 bg-amber-500/20 text-amber-300"}];function sz({design:e,formFields:t,eventId:r,onSubmit:a,isSubmitting:n}){const{blocks:l,flowPreset:o="serene",globalBackgroundType:f,globalBackgroundAsset:d,globalBackgroundColor:x,globalOverlay:m,accentColor:p,globalMusicUrl:v}=e,y=C.useMemo(()=>{const M=[...l],W=M.some(ye=>ye.type==="attendance"),ne=M.some(ye=>ye.type==="guestDetails");if(W||M.splice(0,0,{id:"__auto_attendance__",type:"attendance",title:"Will you be attending?",subtitle:"Please let us know"}),!ne){const ye=M.findIndex(be=>be.type==="attendance");M.splice(ye+1,0,{id:"__auto_guest_details__",type:"guestDetails",title:"Your details",subtitle:"Tell us about yourself",showFields:{name:!0,email:!0,phone:!0,pax:!0,guestType:!0}})}return M},[l]),[b,S]=C.useState(""),[E,_]=C.useState(""),[N,k]=C.useState(null),[R,A]=C.useState("Family"),[D,T]=C.useState(1),[O,F]=C.useState(""),[q,X]=C.useState({}),[U,ee]=C.useState({}),[oe,ce]=C.useState(!1),Z=C.useRef(null),ie=M=>ee(W=>{const ne={...W};return delete ne[M],ne}),ke=(M,W)=>{X(ne=>({...ne,[M]:W})),ie(M)},re=(M,W)=>{X(ne=>{const ye=ne[M],be=Array.isArray(ye)?ye:ye?[ye]:[],Se=be.includes(W)?be.filter(Ne=>Ne!==W):[...be,W];return{...ne,[M]:Se}}),ie(M)},z=()=>{Z.current&&(oe?(Z.current.pause(),ce(!1)):(Z.current.play().catch(()=>{}),ce(!0)))},te=()=>{const M={},W=y.find(ye=>ye.type==="guestDetails"),ne=((W==null?void 0:W.type)==="guestDetails"?W.showFields:void 0)??{name:!0,email:!0,phone:!0,pax:!0};return ne.name!==!1&&!b.trim()&&(M.guestName="Name is required"),ne.email!==!1&&(E.trim()?rz(E)||(M.guestEmail="Enter a valid email address"):M.guestEmail="Email is required"),N||(M.status="Please select an attendance option"),ne.phone!==!1&&!O.trim()&&(M.phoneNo="Phone number is required"),ne.pax!==!1&&(!D||D<1)&&(M.noOfPax="Please enter the number of guests"),y.forEach(ye=>{if(ye.type!=="formField"||!ye.questionId)return;const be=t.find(V=>(V.questionId??V.id)===ye.questionId);if(!(ye.required??(be==null?void 0:be.isRequired)??!1))return;const Ne=q[ye.questionId];(Array.isArray(Ne)?Ne.length===0:!(Ne??"").trim())&&(M[ye.questionId]=`${ye.label||(be==null?void 0:be.label)||"This field"} is required`)}),ee(M),Object.keys(M).length===0},B=async M=>{M.preventDefault(),te()&&await a({eventId:r,guestName:b.trim(),guestEmail:E.trim(),status:N,guestType:R,noOfPax:D,phoneNo:O.trim(),answers:q})},I=M=>{var Ne,Xe;const W=((Ne=M.background)==null?void 0:Ne.images)??[],ne=W.find(V=>{var We;return V.id===((We=M.background)==null?void 0:We.activeImageId)})??W[0]??M.sectionImage,ye=((Xe=M.background)==null?void 0:Xe.overlay)??.35,be=ne?{backgroundImage:`linear-gradient(rgba(15,23,42,${ye}),rgba(15,23,42,${ye})),url(${ne.src})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:o==="parallax"?"fixed":"scroll"}:{};let Se=null;if(M.type==="headline")Se=c.jsxs("div",{className:`text-${M.align}`,children:[c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Welcome"}),c.jsx("h2",{className:`mt-1 text-4xl font-extrabold text-white drop-shadow ${M.accent}`,children:M.title}),M.subtitle&&c.jsx("p",{className:"mt-2 text-base text-white/80",children:M.subtitle})]});else if(M.type==="text")Se=c.jsx("p",{className:`leading-relaxed text-base ${M.muted?"text-white/70":"text-white"} ${M.width==="half"?"md:max-w-[50%]":"w-full"}`,children:M.body});else if(M.type==="info")Se=c.jsxs("div",{className:`inline-flex items-center gap-3 rounded-full px-5 py-2.5 text-sm ${M.accent}`,children:[c.jsx("span",{className:"font-semibold uppercase tracking-wide",children:M.label}),c.jsx("span",{className:"opacity-80",children:M.content})]});else if(M.type==="attendance")Se=c.jsxs("div",{className:`space-y-4 ${M.width==="half"?"md:max-w-[50%]":"w-full"}`,children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-semibold text-white",children:[M.title||"Will you be attending?",c.jsx("span",{className:"ml-1 text-rose-400",children:"*"})]}),M.subtitle&&c.jsx("p",{className:"mt-0.5 text-xs text-white/60",children:M.subtitle})]}),c.jsx("div",{className:"grid grid-cols-3 gap-2",children:nz.map(({value:V,label:We,icon:$e,activeClass:dt})=>c.jsxs("button",{type:"button",onClick:()=>{k(V),ie("status")},className:`rounded-xl border-2 py-3 text-xs font-semibold transition ${N===V?dt:"border-white/20 bg-white/5 text-white/80 hover:border-white/40 hover:bg-white/10"}`,children:[c.jsx("span",{className:"block text-base",children:$e}),We]},V))}),U.status&&c.jsx("p",{className:"text-xs text-rose-400",children:U.status})]});else if(M.type==="guestDetails"){const V=M.showFields??{name:!0,email:!0,phone:!0,pax:!0,guestType:!0};Se=c.jsxs("div",{className:`space-y-4 ${M.width==="half"?"md:max-w-[50%]":"w-full"}`,children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:M.title||"Your details"}),M.subtitle&&c.jsx("p",{className:"mt-0.5 text-xs text-white/60",children:M.subtitle})]}),c.jsxs("div",{className:"rounded-xl bg-white p-4 shadow-sm space-y-4 text-gray-900",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[V.name!==!1&&c.jsx($t,{label:"Your name",type:"text",required:!0,value:b,onChange:We=>{S(We.target.value),ie("guestName")},placeholder:"Full name",error:U.guestName}),V.email!==!1&&c.jsx($t,{label:"Email address",type:"email",required:!0,value:E,onChange:We=>{_(We.target.value),ie("guestEmail")},placeholder:"you@example.com",error:U.guestEmail}),V.phone!==!1&&c.jsx($t,{label:"Phone number",type:"text",required:!0,value:O,onChange:We=>{F(We.target.value),ie("phoneNo")},placeholder:"+60 12-345 6789",error:U.phoneNo}),V.pax!==!1&&c.jsx($t,{label:"Number of guests",type:"number",required:!0,value:String(D),onChange:We=>{const $e=parseInt(We.target.value,10);T(isNaN($e)?1:Math.max(1,$e)),ie("noOfPax")},placeholder:"1",error:U.noOfPax})]}),V.guestType!==!1&&c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700",children:"How do you know the couple?"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:az.map(We=>c.jsx("button",{type:"button",onClick:()=>A(We),className:`rounded-full border px-4 py-1.5 text-sm font-medium transition ${R===We?"border-primary bg-primary text-white":"border-gray-200 text-gray-600 hover:border-primary hover:text-primary"}`,children:We},We))})]})]})]})}else if(M.type==="formField"){if(!M.questionId)return null;const V=t.find(St=>(St.questionId??St.id)===M.questionId),We=(V==null?void 0:V.options)??void 0,$e=Array.isArray(We)?We:typeof We=="string"?We.split(",").map(St=>St.trim()):void 0,dt=(V==null?void 0:V.typeKey)??"text",Je=M.label||(V==null?void 0:V.label)||(V==null?void 0:V.text)||"Custom field",Oe=M.required??(V==null?void 0:V.isRequired)??!1,Ct=dt==="checkbox"&&$e&&$e.length>1,Pt=q[M.questionId],Rr=Array.isArray(Pt)?Pt:Pt?[Pt]:[];Se=c.jsx("div",{className:M.width==="half"?"md:max-w-[50%]":"w-full",children:c.jsx("div",{className:"rounded-xl bg-white p-4 shadow-sm text-gray-900",children:Ct?c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[Je,Oe&&c.jsx("span",{className:"ml-1 text-rose-500",children:"*"})]}),$e.map(St=>c.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:Rr.includes(St),onChange:()=>re(M.questionId,St),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),c.jsx("span",{className:"text-sm text-gray-700",children:St})]},St)),U[M.questionId]&&c.jsx("p",{className:"text-xs text-rose-500",children:U[M.questionId]})]}):c.jsx($t,{label:Je,type:dt,options:$e,required:Oe,placeholder:M.placeholder,hint:M.hint,value:Pt??"",onChange:St=>ke(M.questionId,St.target.value),error:U[M.questionId]})})})}else if(M.type==="cta")Se=c.jsx("div",{className:`flex ${M.align==="center"?"justify-center":M.align==="right"?"justify-end":"justify-start"}`,children:c.jsx("span",{className:"inline-block rounded-full px-8 py-3 text-sm font-semibold shadow-lg",style:{background:p,color:"#0f172a"},children:M.label})});else if(M.type==="image"){const V=M.images.find($e=>$e.id===M.activeImageId)??M.images[0],We=M.height==="tall"?"h-80":M.height==="short"?"h-48":"h-64";Se=c.jsxs("div",{className:`overflow-hidden rounded-2xl ${We}`,children:[V?c.jsx("img",{src:V.src,alt:V.alt??"",className:"h-full w-full object-cover",loading:"lazy"}):null,M.caption&&c.jsx("p",{className:"bg-black/40 px-4 py-2 text-xs text-white/80",children:M.caption})]})}return Se?c.jsx("section",{className:`relative overflow-hidden rounded-3xl border border-white/10 bg-white/5 p-6 shadow-xl ring-1 ring-white/5 backdrop-blur-sm transition duration-500 hover:-translate-y-1 ${o==="stacked"?"scroll-snap-start":""}`,style:be,children:Se},M.id):null};return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 text-white",children:[c.jsxs("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":!0,children:[f==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:x}}),f==="image"&&d&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${d})`}}),f==="video"&&d&&c.jsx("video",{className:"h-full w-full object-cover",src:d,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${m})`}})]}),v&&c.jsxs(c.Fragment,{children:[c.jsx("audio",{ref:Z,src:v,loop:!0,preload:"none"}),c.jsx("button",{type:"button",onClick:z,title:oe?"Pause music":"Play ambient music",className:"fixed bottom-6 right-6 z-50 flex h-12 w-12 items-center justify-center rounded-full border border-white/20 bg-black/60 text-white shadow-xl backdrop-blur-sm transition hover:bg-black/80",style:{borderColor:`${p}40`},children:oe?c.jsxs("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}),c.jsx("rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"})]}):c.jsx("svg",{className:"h-5 w-5 translate-x-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M8 5v14l11-7z"})})})]}),c.jsx("form",{onSubmit:B,noValidate:!0,children:c.jsxs("div",{className:`relative mx-auto flex max-w-3xl flex-col gap-6 px-4 py-12 ${o==="stacked"?"scroll-snap-y scroll-smooth":""}`,children:[y.map(M=>I(M)),c.jsx("div",{className:"flex justify-center pb-8",children:c.jsxs("button",{type:"submit",disabled:n,className:"flex min-w-[220px] items-center justify-center gap-2 rounded-full px-8 py-4 text-base font-semibold shadow-xl transition hover:opacity-90 disabled:opacity-60",style:{background:p,color:"#0f172a"},children:[n&&c.jsx(Un,{}),n?"Submitting...":"Submit RSVP"]})})]})})]})}function iz({guestName:e,design:t}){const r=t.accentColor??"#f97316";return c.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-slate-950 flex items-center justify-center px-4 text-white",children:[c.jsxs("div",{className:"absolute inset-0 pointer-events-none","aria-hidden":!0,children:[t.globalBackgroundType==="color"&&c.jsx("div",{className:"h-full w-full",style:{background:t.globalBackgroundColor}}),t.globalBackgroundType==="image"&&t.globalBackgroundAsset&&c.jsx("div",{className:"h-full w-full bg-cover bg-center",style:{backgroundImage:`url(${t.globalBackgroundAsset})`}}),t.globalBackgroundType==="video"&&t.globalBackgroundAsset&&c.jsx("video",{className:"h-full w-full object-cover",src:t.globalBackgroundAsset,autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),c.jsx("div",{className:"absolute inset-0",style:{background:`rgba(15,23,42,${t.globalOverlay})`}})]}),c.jsxs("div",{className:"relative z-10 max-w-md w-full text-center space-y-8",children:[c.jsx("div",{className:"mx-auto flex h-24 w-24 items-center justify-center rounded-full border-2",style:{background:`${r}20`,borderColor:`${r}50`},children:c.jsx("svg",{className:"h-12 w-12",style:{color:r},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h1",{className:"text-4xl font-extrabold text-white drop-shadow",children:e?`Thank you, ${e}!`:"Thank you!"}),c.jsx("p",{className:"text-lg text-white/80",children:"Your RSVP has been received."}),c.jsx("p",{className:"text-sm text-white/50 leading-relaxed",children:"We're looking forward to celebrating with you. A confirmation will be sent to your email."})]}),c.jsx("div",{className:"mx-auto h-px w-16 rounded-full opacity-50",style:{background:r}}),c.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/40",children:"See you soon"})]})]})}function Jw(){var d;const{token:e}=yn(),{data:t,isLoading:r}=ez(e),a=tz(),[n,l]=C.useState(!1),[o,f]=C.useState("");return r?c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-950 text-white gap-3",children:[c.jsx(Un,{}),c.jsx("p",{className:"text-sm text-white/50",children:"Loading invitation..."})]}):!t||!((d=t.blocks)!=null&&d.length)?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-white px-4",children:c.jsxs("div",{className:"max-w-sm text-center space-y-4",children:[c.jsx("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-white/5 border border-white/10",children:c.jsx("svg",{className:"h-8 w-8 text-white/40",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Invalid or expired link"}),c.jsx("p",{className:"text-sm text-white/50 leading-relaxed",children:"This RSVP link doesn't exist or has expired. Please contact the host for the correct link."})]})}):n?c.jsx(iz,{guestName:o,design:t}):c.jsx(sz,{design:t,formFields:t.formFieldConfigs??[],eventId:t.eventGuid??"",onSubmit:async x=>{try{await a.mutateAsync(x),f(x.guestName),l(!0)}catch{Ya.error("Failed to submit your RSVP. Please try again.")}},isSubmitting:a.isPending})}function lz(){return c.jsx("section",{className:"py-20 bg-background text-text",children:c.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[c.jsx("h2",{className:"text-4xl font-playfair italic text-primary text-center",children:"Wedding Events"}),c.jsx("ul",{className:"space-y-4",children:[{label:"Ceremony",date:"Feb 14, 2025",time:"10:00 AM"},{label:"Reception",date:"Feb 14, 2025",time:"6:00 PM"}].map(e=>c.jsxs("li",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow flex justify-between",children:[c.jsx("span",{className:"font-semibold",children:e.label}),c.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.date," @ ",e.time]})]},e.label))})]})})}function oz(){const e=_a(),{eventId:t}=Yr();console.log("NewRsvpModal eventId:",t);const r=Qg(t),a=n=>{r.mutate(n,{onSuccess:()=>{e(-1)}})};return c.jsx(e1,{isOpen:!0,onClose:()=>e(-1),eventId:t,onSave:a})}function cz(){const e=_a(),{eventId:t}=Yr(),{id:r}=yn(),{data:a,isLoading:n}=RI(t,r),l=Zg(t);if(n)return null;const o=(f,d)=>{const x=d;l.mutate({rsvpGuid:x,...f},{onSuccess:()=>e(-1)})};return c.jsx(e1,{isOpen:!0,onClose:()=>e(-1),eventId:t,initial:a,onSave:o})}const Co={text:0,textarea:1,select:2,radio:3,checkbox:4,email:5,number:6,date:7},eS=["select","radio","checkbox"];function uz({isOpen:e,onClose:t,initial:r,onSave:a}){const n=C.useMemo(()=>{const _=Object.entries(Co).find(([,N])=>N===((r==null?void 0:r.type)??Co.text));return(_==null?void 0:_[0])??"text"},[r==null?void 0:r.type]),[l,o]=C.useState((r==null?void 0:r.text)??""),[f,d]=C.useState((r==null?void 0:r.isRequired)??!1),[x,m]=C.useState(n),[p,v]=C.useState((r==null?void 0:r.options)??""),[y,b]=C.useState(Number.isFinite(r==null?void 0:r.order)?r.order:0);C.useEffect(()=>{if(!e)return;o((r==null?void 0:r.text)??""),d((r==null?void 0:r.isRequired)??!1),b(Number.isFinite(r==null?void 0:r.order)?r.order:0);const _=Object.entries(Co).find(([,N])=>N===((r==null?void 0:r.type)??Co.text));m((_==null?void 0:_[0])??"text"),v((r==null?void 0:r.options)??"")},[e,r]);const S=_=>{_.preventDefault();const N={id:r==null?void 0:r.id,text:l,isRequired:f,type:Co[x],options:eS.includes(x)?(p||"").trim():void 0,order:Number.isFinite(y)?y:0,isDeleted:(r==null?void 0:r.isDeleted)??!1};a(N)},E=eS.includes(x);return c.jsx(zn,{isOpen:e,onClose:t,title:r?"Edit Field":"New Field",children:c.jsxs("form",{onSubmit:S,className:"space-y-4",children:[c.jsx($t,{label:"Question Text",value:l,onChange:_=>o(_.target.value),placeholder:"e.g. Do you have any dietary requirements?"}),c.jsxs("div",{children:[c.jsx("label",{className:"block mb-1",children:"Type"}),c.jsx("select",{value:x,onChange:_=>m(_.target.value),className:"w-full border rounded p-2",children:Object.keys(Co).map(_=>c.jsx("option",{value:_,children:_},_))}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"This maps to API numeric codes (e.g. text=0, textarea=1, select=2, )."})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{id:"required",type:"checkbox",checked:f,onChange:_=>d(_.target.checked)}),c.jsx("label",{htmlFor:"required",children:"Required"})]}),E&&c.jsx($t,{label:"Options (comma-separated)",value:p,onChange:_=>v(_.target.value),placeholder:"e.g. Beef, Chicken, Fish, Vegetarian"}),c.jsx($t,{label:"Order",type:"number",value:String(y),onChange:_=>b(Number(_.target.value)),placeholder:"0"}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Le,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),c.jsx(Le,{type:"submit",variant:"primary",children:r?"Save":"Create"})]})]})})}function fz(){const{id:e}=yn(),t=e??"",{data:r,isLoading:a,isError:n}=Jg(t),l=FI(),o=OI(),f=MI(),[d,x]=C.useState({open:!1}),m=C.useMemo(()=>Array.isArray(r)?r:[],[r]);return t?a?c.jsx(Ka,{}):n?c.jsx("p",{children:"Failed to load form fields."}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-semibold",children:"Custom RSVP Fields"}),c.jsx(Le,{onClick:()=>x({open:!0}),children:"+ New Field"})]}),m.length===0?c.jsxs("div",{className:"text-center text-gray-500 py-10 bg-white dark:bg-gray-800 rounded-lg shadow",children:[c.jsx("p",{children:"No custom fields yet."}),c.jsxs("p",{className:"mt-2",children:["Click ",c.jsx("span",{className:"font-semibold",children:"+ New Field"})," to add one."]})]}):c.jsx("ul",{className:"space-y-2",children:m.map(p=>c.jsxs("li",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:p.label??p.text}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[typeof p.type=="number"?p.type:p.typeKey??String(p.type)," ",p.isRequired&&" required"]})]}),c.jsxs("div",{className:"space-x-2",children:[c.jsx(Le,{variant:"secondary",onClick:()=>x({open:!0,initial:p}),children:"Edit"}),c.jsx(Le,{variant:"primary",onClick:()=>{p.questionId&&f.mutate()},children:"Delete"})]})]},p.questionId??p.id))}),d.open&&c.jsx(uz,{isOpen:d.open,onClose:()=>x({open:!1}),initial:d.initial?{id:d.initial.questionId??d.initial.id,text:d.initial.text??d.initial.label??"",isRequired:d.initial.isRequired??!1,order:d.initial.order??0,type:d.initial.type??0,options:Array.isArray(d.initial.options)?d.initial.options.join(","):typeof d.initial.options=="string"?d.initial.options:void 0}:void 0,onSave:p=>{var y;if(!t)return;const v={text:p.text??"",type:p.type,isRequired:p.isRequired,options:p.options??"",eventGuid:t};(y=d.initial)!=null&&y.questionId?o.mutate({...v,questionId:d.initial.questionId.toString()}):l.mutate(v),x({open:!1})}})]}):c.jsx(Gl,{title:"No Event Selected",message:"Create your first event to start customizing your RSVP form fields."})}function dz(){const{tableId:e}=yn(),{eventId:t}=Yr(),{data:r,isLoading:a}=wu(e),{data:n=[],isLoading:l}=rh(t),o=lU(t),f=oU(t),d=sU(e,t),[x,m]=C.useState((r==null?void 0:r.extraGuests)||0);if(a||l)return c.jsx(Ka,{});const p=n.filter(y=>y.tableId===e),v=n.filter(y=>!y.tableId);return c.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Unassigned Guests"}),v.length===0?c.jsx("p",{children:"All guests are assigned."}):c.jsx("ul",{className:"mt-2 space-y-2",children:v.map(y=>c.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[c.jsx("span",{children:y.guestName||y.name}),c.jsx(Le,{onClick:()=>o.mutate({guestId:y.id,tableId:e}),children:"Assign "})]},y.id))})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold",children:"Assigned Guests"}),p.length===0?c.jsx("p",{children:"No one assigned yet."}):c.jsx("ul",{className:"mt-2 space-y-2",children:p.map(y=>c.jsxs("li",{className:"flex justify-between items-center p-2 bg-white dark:bg-gray-800 rounded shadow-sm",children:[c.jsx("span",{children:y.guestName||y.name}),c.jsx(Le,{variant:"secondary",onClick:()=>f.mutate(y.id),children:" Unassign"})]},y.id))}),c.jsxs("div",{className:"mt-6",children:[c.jsx("h3",{className:"font-medium",children:"Additional Guests"}),c.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[c.jsx(Le,{onClick:()=>m(y=>Math.max(0,y-1)),children:""}),c.jsx("span",{className:"px-4",children:x}),c.jsx(Le,{onClick:()=>m(y=>y+1),children:""}),c.jsx(Le,{variant:"primary",onClick:()=>d.mutate({extraGuests:x,tableName:(r==null?void 0:r.name)||"",maxSeats:(r==null?void 0:r.capacity)||0}),children:"Save"})]})]})]})]})}function hz(){return c.jsxs("div",{className:"space-y-4",children:[c.jsx("nav",{className:"border-b pb-2 flex space-x-4",children:[["","Summary"],["assignments","Assign Guests"],["layout","Layout"],["print","Print"],["edit","Edit"]].map(([e,t])=>c.jsx(R0,{to:e,end:e==="",className:({isActive:r})=>r?"border-b-2 border-button":void 0,children:t},e))}),c.jsx(As,{})]})}var x0={exports:{}},Zm={},Jm={exports:{}},ep,tS;function xz(){if(tS)return ep;tS=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ep=e,ep}var tp,rS;function mz(){if(rS)return tp;rS=1;var e=xz();function t(){}function r(){}return r.resetWarningCache=t,tp=function(){function a(o,f,d,x,m,p){if(p!==e){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}a.isRequired=a;function n(){return a}var l={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:n,element:a,elementType:a,instanceOf:n,node:a,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},tp}var aS;function nk(){return aS||(aS=1,Jm.exports=mz()()),Jm.exports}function sk(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=sk(e[t]))&&(a&&(a+=" "),a+=r);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function nS(){for(var e,t,r=0,a="";r<arguments.length;)(e=arguments[r++])&&(t=sk(e))&&(a&&(a+=" "),a+=t);return a}const pz=Object.freeze(Object.defineProperty({__proto__:null,clsx:nS,default:nS},Symbol.toStringTag,{value:"Module"})),gz=xT(pz);var yr={},xi={},sS;function sh(){if(sS)return xi;sS=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.dontSetMe=n,xi.findInArray=e,xi.int=a,xi.isFunction=t,xi.isNum=r;function e(l,o){for(let f=0,d=l.length;f<d;f++)if(o.apply(o,[l[f],f,l]))return l[f]}function t(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Function]"}function r(l){return typeof l=="number"&&!isNaN(l)}function a(l){return parseInt(l,10)}function n(l,o,f){if(l[o])return new Error("Invalid prop ".concat(o," passed to ").concat(f," - do not set this, set it on the child."))}return xi}var mi={},iS;function vz(){if(iS)return mi;iS=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.browserPrefixToKey=r,mi.browserPrefixToStyle=a,mi.default=void 0,mi.getPrefix=t;const e=["Moz","Webkit","O","ms"];function t(){var l;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const f=(l=window.document)===null||l===void 0||(l=l.documentElement)===null||l===void 0?void 0:l.style;if(!f||o in f)return"";for(let d=0;d<e.length;d++)if(r(o,e[d])in f)return e[d];return""}function r(l,o){return o?"".concat(o).concat(n(l)):l}function a(l,o){return o?"-".concat(o.toLowerCase(),"-").concat(l):l}function n(l){let o="",f=!0;for(let d=0;d<l.length;d++)f?(o+=l[d].toUpperCase(),f=!1):l[d]==="-"?f=!0:o+=l[d];return o}return mi.default=t(),mi}var lS;function i1(){if(lS)return yr;lS=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.addClassName=A,yr.addEvent=f,yr.addUserSelectStyles=k,yr.createCSSTransform=b,yr.createSVGTransform=S,yr.getTouch=_,yr.getTouchIdentifier=N,yr.getTranslation=E,yr.innerHeight=p,yr.innerWidth=v,yr.matchesSelector=l,yr.matchesSelectorAndParentsTo=o,yr.offsetXYFromParent=y,yr.outerHeight=x,yr.outerWidth=m,yr.removeClassName=D,yr.removeEvent=d,yr.removeUserSelectStyles=R;var e=sh(),t=a(vz());function r(T){if(typeof WeakMap!="function")return null;var O=new WeakMap,F=new WeakMap;return(r=function(q){return q?F:O})(T)}function a(T,O){if(T&&T.__esModule)return T;if(T===null||typeof T!="object"&&typeof T!="function")return{default:T};var F=r(O);if(F&&F.has(T))return F.get(T);var q={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in T)if(U!=="default"&&Object.prototype.hasOwnProperty.call(T,U)){var ee=X?Object.getOwnPropertyDescriptor(T,U):null;ee&&(ee.get||ee.set)?Object.defineProperty(q,U,ee):q[U]=T[U]}return q.default=T,F&&F.set(T,q),q}let n="";function l(T,O){return n||(n=(0,e.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(F){return(0,e.isFunction)(T[F])})),(0,e.isFunction)(T[n])?T[n](O):!1}function o(T,O,F){let q=T;do{if(l(q,O))return!0;if(q===F)return!1;q=q.parentNode}while(q);return!1}function f(T,O,F,q){if(!T)return;const X={capture:!0,...q};T.addEventListener?T.addEventListener(O,F,X):T.attachEvent?T.attachEvent("on"+O,F):T["on"+O]=F}function d(T,O,F,q){if(!T)return;const X={capture:!0,...q};T.removeEventListener?T.removeEventListener(O,F,X):T.detachEvent?T.detachEvent("on"+O,F):T["on"+O]=null}function x(T){let O=T.clientHeight;const F=T.ownerDocument.defaultView.getComputedStyle(T);return O+=(0,e.int)(F.borderTopWidth),O+=(0,e.int)(F.borderBottomWidth),O}function m(T){let O=T.clientWidth;const F=T.ownerDocument.defaultView.getComputedStyle(T);return O+=(0,e.int)(F.borderLeftWidth),O+=(0,e.int)(F.borderRightWidth),O}function p(T){let O=T.clientHeight;const F=T.ownerDocument.defaultView.getComputedStyle(T);return O-=(0,e.int)(F.paddingTop),O-=(0,e.int)(F.paddingBottom),O}function v(T){let O=T.clientWidth;const F=T.ownerDocument.defaultView.getComputedStyle(T);return O-=(0,e.int)(F.paddingLeft),O-=(0,e.int)(F.paddingRight),O}function y(T,O,F){const X=O===O.ownerDocument.body?{left:0,top:0}:O.getBoundingClientRect(),U=(T.clientX+O.scrollLeft-X.left)/F,ee=(T.clientY+O.scrollTop-X.top)/F;return{x:U,y:ee}}function b(T,O){const F=E(T,O,"px");return{[(0,t.browserPrefixToKey)("transform",t.default)]:F}}function S(T,O){return E(T,O,"")}function E(T,O,F){let{x:q,y:X}=T,U="translate(".concat(q).concat(F,",").concat(X).concat(F,")");if(O){const ee="".concat(typeof O.x=="string"?O.x:O.x+F),oe="".concat(typeof O.y=="string"?O.y:O.y+F);U="translate(".concat(ee,", ").concat(oe,")")+U}return U}function _(T,O){return T.targetTouches&&(0,e.findInArray)(T.targetTouches,F=>O===F.identifier)||T.changedTouches&&(0,e.findInArray)(T.changedTouches,F=>O===F.identifier)}function N(T){if(T.targetTouches&&T.targetTouches[0])return T.targetTouches[0].identifier;if(T.changedTouches&&T.changedTouches[0])return T.changedTouches[0].identifier}function k(T){if(!T)return;let O=T.getElementById("react-draggable-style-el");O||(O=T.createElement("style"),O.type="text/css",O.id="react-draggable-style-el",O.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,O.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,T.getElementsByTagName("head")[0].appendChild(O)),T.body&&A(T.body,"react-draggable-transparent-selection")}function R(T){if(T)try{if(T.body&&D(T.body,"react-draggable-transparent-selection"),T.selection)T.selection.empty();else{const O=(T.defaultView||window).getSelection();O&&O.type!=="Caret"&&O.removeAllRanges()}}catch{}}function A(T,O){T.classList?T.classList.add(O):T.className.match(new RegExp("(?:^|\\s)".concat(O,"(?!\\S)")))||(T.className+=" ".concat(O))}function D(T,O){T.classList?T.classList.remove(O):T.className=T.className.replace(new RegExp("(?:^|\\s)".concat(O,"(?!\\S)"),"g"),"")}return yr}var Qn={},oS;function ik(){if(oS)return Qn;oS=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.canDragX=n,Qn.canDragY=l,Qn.createCoreData=f,Qn.createDraggableData=d,Qn.getBoundPosition=r,Qn.getControlPosition=o,Qn.snapToGrid=a;var e=sh(),t=i1();function r(p,v,y){if(!p.props.bounds)return[v,y];let{bounds:b}=p.props;b=typeof b=="string"?b:x(b);const S=m(p);if(typeof b=="string"){const{ownerDocument:E}=S,_=E.defaultView;let N;if(b==="parent"?N=S.parentNode:N=E.querySelector(b),!(N instanceof _.HTMLElement))throw new Error('Bounds selector "'+b+'" could not find an element.');const k=N,R=_.getComputedStyle(S),A=_.getComputedStyle(k);b={left:-S.offsetLeft+(0,e.int)(A.paddingLeft)+(0,e.int)(R.marginLeft),top:-S.offsetTop+(0,e.int)(A.paddingTop)+(0,e.int)(R.marginTop),right:(0,t.innerWidth)(k)-(0,t.outerWidth)(S)-S.offsetLeft+(0,e.int)(A.paddingRight)-(0,e.int)(R.marginRight),bottom:(0,t.innerHeight)(k)-(0,t.outerHeight)(S)-S.offsetTop+(0,e.int)(A.paddingBottom)-(0,e.int)(R.marginBottom)}}return(0,e.isNum)(b.right)&&(v=Math.min(v,b.right)),(0,e.isNum)(b.bottom)&&(y=Math.min(y,b.bottom)),(0,e.isNum)(b.left)&&(v=Math.max(v,b.left)),(0,e.isNum)(b.top)&&(y=Math.max(y,b.top)),[v,y]}function a(p,v,y){const b=Math.round(v/p[0])*p[0],S=Math.round(y/p[1])*p[1];return[b,S]}function n(p){return p.props.axis==="both"||p.props.axis==="x"}function l(p){return p.props.axis==="both"||p.props.axis==="y"}function o(p,v,y){const b=typeof v=="number"?(0,t.getTouch)(p,v):null;if(typeof v=="number"&&!b)return null;const S=m(y),E=y.props.offsetParent||S.offsetParent||S.ownerDocument.body;return(0,t.offsetXYFromParent)(b||p,E,y.props.scale)}function f(p,v,y){const b=!(0,e.isNum)(p.lastX),S=m(p);return b?{node:S,deltaX:0,deltaY:0,lastX:v,lastY:y,x:v,y}:{node:S,deltaX:v-p.lastX,deltaY:y-p.lastY,lastX:p.lastX,lastY:p.lastY,x:v,y}}function d(p,v){const y=p.props.scale;return{node:v.node,x:p.state.x+v.deltaX/y,y:p.state.y+v.deltaY/y,deltaX:v.deltaX/y,deltaY:v.deltaY/y,lastX:p.state.x,lastY:p.state.y}}function x(p){return{left:p.left,top:p.top,right:p.right,bottom:p.bottom}}function m(p){const v=p.findDOMNode();if(!v)throw new Error("<DraggableCore>: Unmounted during event!");return v}return Qn}var m0={},Zf={},cS;function lk(){if(cS)return Zf;cS=1,Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.default=e;function e(){}return Zf}var uS;function yz(){if(uS)return m0;uS=1,Object.defineProperty(m0,"__esModule",{value:!0}),m0.default=void 0;var e=x(La()),t=f(nk()),r=f(Fd()),a=i1(),n=ik(),l=sh(),o=f(lk());function f(E){return E&&E.__esModule?E:{default:E}}function d(E){if(typeof WeakMap!="function")return null;var _=new WeakMap,N=new WeakMap;return(d=function(k){return k?N:_})(E)}function x(E,_){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var N=d(_);if(N&&N.has(E))return N.get(E);var k={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in E)if(A!=="default"&&Object.prototype.hasOwnProperty.call(E,A)){var D=R?Object.getOwnPropertyDescriptor(E,A):null;D&&(D.get||D.set)?Object.defineProperty(k,A,D):k[A]=E[A]}return k.default=E,N&&N.set(E,k),k}function m(E,_,N){return _=p(_),_ in E?Object.defineProperty(E,_,{value:N,enumerable:!0,configurable:!0,writable:!0}):E[_]=N,E}function p(E){var _=v(E,"string");return typeof _=="symbol"?_:String(_)}function v(E,_){if(typeof E!="object"||E===null)return E;var N=E[Symbol.toPrimitive];if(N!==void 0){var k=N.call(E,_);if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(E)}const y={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let b=y.mouse,S=class extends e.Component{constructor(){super(...arguments),m(this,"dragging",!1),m(this,"lastX",NaN),m(this,"lastY",NaN),m(this,"touchIdentifier",null),m(this,"mounted",!1),m(this,"handleDragStart",_=>{if(this.props.onMouseDown(_),!this.props.allowAnyClick&&typeof _.button=="number"&&_.button!==0)return!1;const N=this.findDOMNode();if(!N||!N.ownerDocument||!N.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:k}=N;if(this.props.disabled||!(_.target instanceof k.defaultView.Node)||this.props.handle&&!(0,a.matchesSelectorAndParentsTo)(_.target,this.props.handle,N)||this.props.cancel&&(0,a.matchesSelectorAndParentsTo)(_.target,this.props.cancel,N))return;_.type==="touchstart"&&_.preventDefault();const R=(0,a.getTouchIdentifier)(_);this.touchIdentifier=R;const A=(0,n.getControlPosition)(_,R,this);if(A==null)return;const{x:D,y:T}=A,O=(0,n.createCoreData)(this,D,T);(0,o.default)("DraggableCore: handleDragStart: %j",O),(0,o.default)("calling",this.props.onStart),!(this.props.onStart(_,O)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,a.addUserSelectStyles)(k),this.dragging=!0,this.lastX=D,this.lastY=T,(0,a.addEvent)(k,b.move,this.handleDrag),(0,a.addEvent)(k,b.stop,this.handleDragStop))}),m(this,"handleDrag",_=>{const N=(0,n.getControlPosition)(_,this.touchIdentifier,this);if(N==null)return;let{x:k,y:R}=N;if(Array.isArray(this.props.grid)){let T=k-this.lastX,O=R-this.lastY;if([T,O]=(0,n.snapToGrid)(this.props.grid,T,O),!T&&!O)return;k=this.lastX+T,R=this.lastY+O}const A=(0,n.createCoreData)(this,k,R);if((0,o.default)("DraggableCore: handleDrag: %j",A),this.props.onDrag(_,A)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const O=document.createEvent("MouseEvents");O.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(O)}return}this.lastX=k,this.lastY=R}),m(this,"handleDragStop",_=>{if(!this.dragging)return;const N=(0,n.getControlPosition)(_,this.touchIdentifier,this);if(N==null)return;let{x:k,y:R}=N;if(Array.isArray(this.props.grid)){let O=k-this.lastX||0,F=R-this.lastY||0;[O,F]=(0,n.snapToGrid)(this.props.grid,O,F),k=this.lastX+O,R=this.lastY+F}const A=(0,n.createCoreData)(this,k,R);if(this.props.onStop(_,A)===!1||this.mounted===!1)return!1;const T=this.findDOMNode();T&&this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(T.ownerDocument),(0,o.default)("DraggableCore: handleDragStop: %j",A),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,T&&((0,o.default)("DraggableCore: Removing handlers"),(0,a.removeEvent)(T.ownerDocument,b.move,this.handleDrag),(0,a.removeEvent)(T.ownerDocument,b.stop,this.handleDragStop))}),m(this,"onMouseDown",_=>(b=y.mouse,this.handleDragStart(_))),m(this,"onMouseUp",_=>(b=y.mouse,this.handleDragStop(_))),m(this,"onTouchStart",_=>(b=y.touch,this.handleDragStart(_))),m(this,"onTouchEnd",_=>(b=y.touch,this.handleDragStop(_)))}componentDidMount(){this.mounted=!0;const _=this.findDOMNode();_&&(0,a.addEvent)(_,y.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const _=this.findDOMNode();if(_){const{ownerDocument:N}=_;(0,a.removeEvent)(N,y.mouse.move,this.handleDrag),(0,a.removeEvent)(N,y.touch.move,this.handleDrag),(0,a.removeEvent)(N,y.mouse.stop,this.handleDragStop),(0,a.removeEvent)(N,y.touch.stop,this.handleDragStop),(0,a.removeEvent)(_,y.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,a.removeUserSelectStyles)(N)}}findDOMNode(){var _,N;return(_=this.props)!==null&&_!==void 0&&_.nodeRef?(N=this.props)===null||N===void 0||(N=N.nodeRef)===null||N===void 0?void 0:N.current:r.default.findDOMNode(this)}render(){return e.cloneElement(e.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return m0.default=S,m(S,"displayName","DraggableCore"),m(S,"propTypes",{allowAnyClick:t.default.bool,children:t.default.node.isRequired,disabled:t.default.bool,enableUserSelectHack:t.default.bool,offsetParent:function(E,_){if(E[_]&&E[_].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:t.default.arrayOf(t.default.number),handle:t.default.string,cancel:t.default.string,nodeRef:t.default.object,onStart:t.default.func,onDrag:t.default.func,onStop:t.default.func,onMouseDown:t.default.func,scale:t.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),m(S,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),m0}var fS;function bz(){return fS||(fS=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),e.default=void 0;var t=v(La()),r=m(nk()),a=m(Fd()),n=m(gz),l=i1(),o=ik(),f=sh(),d=m(yz()),x=m(lk());function m(N){return N&&N.__esModule?N:{default:N}}function p(N){if(typeof WeakMap!="function")return null;var k=new WeakMap,R=new WeakMap;return(p=function(A){return A?R:k})(N)}function v(N,k){if(N&&N.__esModule)return N;if(N===null||typeof N!="object"&&typeof N!="function")return{default:N};var R=p(k);if(R&&R.has(N))return R.get(N);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in N)if(T!=="default"&&Object.prototype.hasOwnProperty.call(N,T)){var O=D?Object.getOwnPropertyDescriptor(N,T):null;O&&(O.get||O.set)?Object.defineProperty(A,T,O):A[T]=N[T]}return A.default=N,R&&R.set(N,A),A}function y(){return y=Object.assign?Object.assign.bind():function(N){for(var k=1;k<arguments.length;k++){var R=arguments[k];for(var A in R)Object.prototype.hasOwnProperty.call(R,A)&&(N[A]=R[A])}return N},y.apply(this,arguments)}function b(N,k,R){return k=S(k),k in N?Object.defineProperty(N,k,{value:R,enumerable:!0,configurable:!0,writable:!0}):N[k]=R,N}function S(N){var k=E(N,"string");return typeof k=="symbol"?k:String(k)}function E(N,k){if(typeof N!="object"||N===null)return N;var R=N[Symbol.toPrimitive];if(R!==void 0){var A=R.call(N,k);if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(N)}class _ extends t.Component{static getDerivedStateFromProps(k,R){let{position:A}=k,{prevPropsPosition:D}=R;return A&&(!D||A.x!==D.x||A.y!==D.y)?((0,x.default)("Draggable: getDerivedStateFromProps %j",{position:A,prevPropsPosition:D}),{x:A.x,y:A.y,prevPropsPosition:{...A}}):null}constructor(k){super(k),b(this,"onDragStart",(R,A)=>{if((0,x.default)("Draggable: onDragStart: %j",A),this.props.onStart(R,(0,o.createDraggableData)(this,A))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),b(this,"onDrag",(R,A)=>{if(!this.state.dragging)return!1;(0,x.default)("Draggable: onDrag: %j",A);const D=(0,o.createDraggableData)(this,A),T={x:D.x,y:D.y,slackX:0,slackY:0};if(this.props.bounds){const{x:F,y:q}=T;T.x+=this.state.slackX,T.y+=this.state.slackY;const[X,U]=(0,o.getBoundPosition)(this,T.x,T.y);T.x=X,T.y=U,T.slackX=this.state.slackX+(F-T.x),T.slackY=this.state.slackY+(q-T.y),D.x=T.x,D.y=T.y,D.deltaX=T.x-this.state.x,D.deltaY=T.y-this.state.y}if(this.props.onDrag(R,D)===!1)return!1;this.setState(T)}),b(this,"onDragStop",(R,A)=>{if(!this.state.dragging||this.props.onStop(R,(0,o.createDraggableData)(this,A))===!1)return!1;(0,x.default)("Draggable: onDragStop: %j",A);const T={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:F,y:q}=this.props.position;T.x=F,T.y=q}this.setState(T)}),this.state={dragging:!1,dragged:!1,x:k.position?k.position.x:k.defaultPosition.x,y:k.position?k.position.y:k.defaultPosition.y,prevPropsPosition:{...k.position},slackX:0,slackY:0,isElementSVG:!1},k.position&&!(k.onDrag||k.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var k,R;return(k=(R=this.props)===null||R===void 0||(R=R.nodeRef)===null||R===void 0?void 0:R.current)!==null&&k!==void 0?k:a.default.findDOMNode(this)}render(){const{axis:k,bounds:R,children:A,defaultPosition:D,defaultClassName:T,defaultClassNameDragging:O,defaultClassNameDragged:F,position:q,positionOffset:X,scale:U,...ee}=this.props;let oe={},ce=null;const ie=!!!q||this.state.dragging,ke=q||D,re={x:(0,o.canDragX)(this)&&ie?this.state.x:ke.x,y:(0,o.canDragY)(this)&&ie?this.state.y:ke.y};this.state.isElementSVG?ce=(0,l.createSVGTransform)(re,X):oe=(0,l.createCSSTransform)(re,X);const z=(0,n.default)(A.props.className||"",T,{[O]:this.state.dragging,[F]:this.state.dragged});return t.createElement(d.default,y({},ee,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(A),{className:z,style:{...A.props.style,...oe},transform:ce}))}}e.default=_,b(_,"displayName","Draggable"),b(_,"propTypes",{...d.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:f.dontSetMe,style:f.dontSetMe,transform:f.dontSetMe}),b(_,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(Zm)),Zm}var dS;function wz(){if(dS)return x0.exports;dS=1;const{default:e,DraggableCore:t}=bz();return x0.exports=e,x0.exports.default=e,x0.exports.DraggableCore=t,x0.exports}var Sz=wz();const Ez=Bn(Sz);var Cr=function(){return Cr=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Cr.apply(this,arguments)},hS={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},xS={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},Jf={width:"20px",height:"20px",position:"absolute",zIndex:1},_z={top:Cr(Cr({},hS),{top:"-5px"}),right:Cr(Cr({},xS),{left:void 0,right:"-5px"}),bottom:Cr(Cr({},hS),{top:void 0,bottom:"-5px"}),left:Cr(Cr({},xS),{left:"-5px"}),topRight:Cr(Cr({},Jf),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:Cr(Cr({},Jf),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:Cr(Cr({},Jf),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:Cr(Cr({},Jf),{left:"-10px",top:"-10px",cursor:"nw-resize"})},kz=C.memo(function(e){var t=e.onResizeStart,r=e.direction,a=e.children,n=e.replaceStyles,l=e.className,o=C.useCallback(function(x){t(x,r)},[t,r]),f=C.useCallback(function(x){t(x,r)},[t,r]),d=C.useMemo(function(){return Cr(Cr({position:"absolute",userSelect:"none"},_z[r]),n??{})},[n,r]);return c.jsx("div",{className:l||void 0,style:d,onMouseDown:o,onTouchStart:f,children:a})}),Tz=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),es=function(){return es=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},es.apply(this,arguments)},Nz={width:"auto",height:"auto"},ed=function(e,t,r){return Math.max(Math.min(e,r),t)},mS=function(e,t,r){var a=Math.round(e/t);return a*t+r*(a-1)},Ao=function(e,t){return new RegExp(e,"i").test(t)},td=function(e){return!!(e.touches&&e.touches.length)},Cz=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},pS=function(e,t,r){r===void 0&&(r=0);var a=t.reduce(function(l,o,f){return Math.abs(o-e)<Math.abs(t[l]-e)?f:l},0),n=Math.abs(t[a]-e);return r===0||n<r?t[a]:e},rp=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:"".concat(e,"px")},rd=function(e,t,r,a){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var n=Number(e.replace("%",""))/100;return t*n}if(e.endsWith("vw")){var n=Number(e.replace("vw",""))/100;return r*n}if(e.endsWith("vh")){var n=Number(e.replace("vh",""))/100;return a*n}}return e},Az=function(e,t,r,a,n,l,o){return a=rd(a,e.width,t,r),n=rd(n,e.height,t,r),l=rd(l,e.width,t,r),o=rd(o,e.height,t,r),{maxWidth:typeof a>"u"?void 0:Number(a),maxHeight:typeof n>"u"?void 0:Number(n),minWidth:typeof l>"u"?void 0:Number(l),minHeight:typeof o>"u"?void 0:Number(o)}},jz=function(e){return Array.isArray(e)?e:[e,e]},Rz=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],gS="__resizable_base__",Dz=function(e){Tz(t,e);function t(r){var a,n,l,o,f=e.call(this,r)||this;return f.ratio=1,f.resizable=null,f.parentLeft=0,f.parentTop=0,f.resizableLeft=0,f.resizableRight=0,f.resizableTop=0,f.resizableBottom=0,f.targetLeft=0,f.targetTop=0,f.delta={width:0,height:0},f.appendBase=function(){if(!f.resizable||!f.window)return null;var d=f.parentNode;if(!d)return null;var x=f.window.document.createElement("div");return x.style.width="100%",x.style.height="100%",x.style.position="absolute",x.style.transform="scale(0, 0)",x.style.left="0",x.style.flex="0 0 100%",x.classList?x.classList.add(gS):x.className+=gS,d.appendChild(x),x},f.removeBase=function(d){var x=f.parentNode;x&&x.removeChild(d)},f.state={isResizing:!1,width:(n=(a=f.propsSize)===null||a===void 0?void 0:a.width)!==null&&n!==void 0?n:"auto",height:(o=(l=f.propsSize)===null||l===void 0?void 0:l.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},f.onResizeStart=f.onResizeStart.bind(f),f.onMouseMove=f.onMouseMove.bind(f),f.onMouseUp=f.onMouseUp.bind(f),f}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Nz},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var r=0,a=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,l=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),r=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:n,a=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:l,this.resizable.style.position=o}return{width:r,height:a}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var r=this,a=this.props.size,n=function(f){var d;if(typeof r.state[f]>"u"||r.state[f]==="auto")return"auto";if(r.propsSize&&r.propsSize[f]&&(!((d=r.propsSize[f])===null||d===void 0)&&d.toString().endsWith("%"))){if(r.state[f].toString().endsWith("%"))return r.state[f].toString();var x=r.getParentSize(),m=Number(r.state[f].toString().replace("px","")),p=m/x[f]*100;return"".concat(p,"%")}return rp(r.state[f])},l=a&&typeof a.width<"u"&&!this.state.isResizing?rp(a.width):n("width"),o=a&&typeof a.height<"u"&&!this.state.isResizing?rp(a.height):n("height");return{width:l,height:o}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var r=this.appendBase();if(!r)return{width:0,height:0};var a=!1,n=this.parentNode.style.flexWrap;n!=="wrap"&&(a=!0,this.parentNode.style.flexWrap="wrap"),r.style.position="relative",r.style.minWidth="100%",r.style.minHeight="100%";var l={width:r.offsetWidth,height:r.offsetHeight};return a&&(this.parentNode.style.flexWrap=n),this.removeBase(r),l},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var r=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:r.flexBasis!=="auto"?r.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(r,a){var n=this.propsSize&&this.propsSize[a];return this.state[a]==="auto"&&this.state.original[a]===r&&(typeof n>"u"||n==="auto")?"auto":r},t.prototype.calculateNewMaxFromBoundary=function(r,a){var n=this.props.boundsByDirection,l=this.state.direction,o=n&&Ao("left",l),f=n&&Ao("top",l),d,x;if(this.props.bounds==="parent"){var m=this.parentNode;m&&(d=o?this.resizableRight-this.parentLeft:m.offsetWidth+(this.parentLeft-this.resizableLeft),x=f?this.resizableBottom-this.parentTop:m.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(d=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,x=f?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(d=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),x=f?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return d&&Number.isFinite(d)&&(r=r&&r<d?r:d),x&&Number.isFinite(x)&&(a=a&&a<x?a:x),{maxWidth:r,maxHeight:a}},t.prototype.calculateNewSizeFromDirection=function(r,a){var n=this.props.scale||1,l=jz(this.props.resizeRatio||1),o=l[0],f=l[1],d=this.state,x=d.direction,m=d.original,p=this.props,v=p.lockAspectRatio,y=p.lockAspectRatioExtraHeight,b=p.lockAspectRatioExtraWidth,S=m.width,E=m.height,_=y||0,N=b||0;return Ao("right",x)&&(S=m.width+(r-m.x)*o/n,v&&(E=(S-N)/this.ratio+_)),Ao("left",x)&&(S=m.width-(r-m.x)*o/n,v&&(E=(S-N)/this.ratio+_)),Ao("bottom",x)&&(E=m.height+(a-m.y)*f/n,v&&(S=(E-_)*this.ratio+N)),Ao("top",x)&&(E=m.height-(a-m.y)*f/n,v&&(S=(E-_)*this.ratio+N)),{newWidth:S,newHeight:E}},t.prototype.calculateNewSizeFromAspectRatio=function(r,a,n,l){var o=this.props,f=o.lockAspectRatio,d=o.lockAspectRatioExtraHeight,x=o.lockAspectRatioExtraWidth,m=typeof l.width>"u"?10:l.width,p=typeof n.width>"u"||n.width<0?r:n.width,v=typeof l.height>"u"?10:l.height,y=typeof n.height>"u"||n.height<0?a:n.height,b=d||0,S=x||0;if(f){var E=(v-b)*this.ratio+S,_=(y-b)*this.ratio+S,N=(m-S)/this.ratio+b,k=(p-S)/this.ratio+b,R=Math.max(m,E),A=Math.min(p,_),D=Math.max(v,N),T=Math.min(y,k);r=ed(r,R,A),a=ed(a,D,T)}else r=ed(r,m,p),a=ed(a,v,y);return{newWidth:r,newHeight:a}},t.prototype.setBoundingClientRect=function(){var r=1/(this.props.scale||1);if(this.props.bounds==="parent"){var a=this.parentNode;if(a){var n=a.getBoundingClientRect();this.parentLeft=n.left*r,this.parentTop=n.top*r}}if(this.props.bounds&&typeof this.props.bounds!="string"){var l=this.props.bounds.getBoundingClientRect();this.targetLeft=l.left*r,this.targetTop=l.top*r}if(this.resizable){var o=this.resizable.getBoundingClientRect(),f=o.left,d=o.top,x=o.right,m=o.bottom;this.resizableLeft=f*r,this.resizableRight=x*r,this.resizableTop=d*r,this.resizableBottom=m*r}},t.prototype.onResizeStart=function(r,a){if(!(!this.resizable||!this.window)){var n=0,l=0;if(r.nativeEvent&&Cz(r.nativeEvent)?(n=r.nativeEvent.clientX,l=r.nativeEvent.clientY):r.nativeEvent&&td(r.nativeEvent)&&(n=r.nativeEvent.touches[0].clientX,l=r.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(r,a,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var f,d=this.window.getComputedStyle(this.resizable);if(d.flexBasis!=="auto"){var x=this.parentNode;if(x){var m=this.window.getComputedStyle(x).flexDirection;this.flexDir=m.startsWith("row")?"row":"column",f=d.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var p={original:{x:n,y:l,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:es(es({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(r.target).cursor||"auto"}),direction:a,flexBasis:f};this.setState(p)}},t.prototype.onMouseMove=function(r){var a=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&td(r))try{r.preventDefault(),r.stopPropagation()}catch{}var n=this.props,l=n.maxWidth,o=n.maxHeight,f=n.minWidth,d=n.minHeight,x=td(r)?r.touches[0].clientX:r.clientX,m=td(r)?r.touches[0].clientY:r.clientY,p=this.state,v=p.direction,y=p.original,b=p.width,S=p.height,E=this.getParentSize(),_=Az(E,this.window.innerWidth,this.window.innerHeight,l,o,f,d);l=_.maxWidth,o=_.maxHeight,f=_.minWidth,d=_.minHeight;var N=this.calculateNewSizeFromDirection(x,m),k=N.newHeight,R=N.newWidth,A=this.calculateNewMaxFromBoundary(l,o);this.props.snap&&this.props.snap.x&&(R=pS(R,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(k=pS(k,this.props.snap.y,this.props.snapGap));var D=this.calculateNewSizeFromAspectRatio(R,k,{width:A.maxWidth,height:A.maxHeight},{width:f,height:d});if(R=D.newWidth,k=D.newHeight,this.props.grid){var T=mS(R,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),O=mS(k,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),F=this.props.snapGap||0,q=F===0||Math.abs(T-R)<=F?T:R,X=F===0||Math.abs(O-k)<=F?O:k;R=q,k=X}var U={width:R-y.width,height:k-y.height};if(this.delta=U,b&&typeof b=="string"){if(b.endsWith("%")){var ee=R/E.width*100;R="".concat(ee,"%")}else if(b.endsWith("vw")){var oe=R/this.window.innerWidth*100;R="".concat(oe,"vw")}else if(b.endsWith("vh")){var ce=R/this.window.innerHeight*100;R="".concat(ce,"vh")}}if(S&&typeof S=="string"){if(S.endsWith("%")){var ee=k/E.height*100;k="".concat(ee,"%")}else if(S.endsWith("vw")){var oe=k/this.window.innerWidth*100;k="".concat(oe,"vw")}else if(S.endsWith("vh")){var ce=k/this.window.innerHeight*100;k="".concat(ce,"vh")}}var Z={width:this.createSizeForCssProperty(R,"width"),height:this.createSizeForCssProperty(k,"height")};this.flexDir==="row"?Z.flexBasis=Z.width:this.flexDir==="column"&&(Z.flexBasis=Z.height);var ie=this.state.width!==Z.width,ke=this.state.height!==Z.height,re=this.state.flexBasis!==Z.flexBasis,z=ie||ke||re;z&&WS.flushSync(function(){a.setState(Z)}),this.props.onResize&&z&&this.props.onResize(r,v,this.resizable,U)}},t.prototype.onMouseUp=function(r){var a,n,l=this.state,o=l.isResizing,f=l.direction;l.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(r,f,this.resizable,this.delta),this.props.size&&this.setState({width:(a=this.props.size.width)!==null&&a!==void 0?a:"auto",height:(n=this.props.size.height)!==null&&n!==void 0?n:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:es(es({},this.state.backgroundStyle),{cursor:"auto"})}))},t.prototype.updateSize=function(r){var a,n;this.setState({width:(a=r.width)!==null&&a!==void 0?a:"auto",height:(n=r.height)!==null&&n!==void 0?n:"auto"})},t.prototype.renderResizer=function(){var r=this,a=this.props,n=a.enable,l=a.handleStyles,o=a.handleClasses,f=a.handleWrapperStyle,d=a.handleWrapperClass,x=a.handleComponent;if(!n)return null;var m=Object.keys(n).map(function(p){return n[p]!==!1?c.jsx(kz,{direction:p,onResizeStart:r.onResizeStart,replaceStyles:l&&l[p],className:o&&o[p],children:x&&x[p]?x[p]:null},p):null});return c.jsx("div",{className:d,style:f,children:m})},t.prototype.render=function(){var r=this,a=Object.keys(this.props).reduce(function(o,f){return Rz.indexOf(f)!==-1||(o[f]=r.props[f]),o},{}),n=es(es(es({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var l=this.props.as||"div";return c.jsxs(l,es({style:n,className:this.props.className},a,{ref:function(o){o&&(r.resizable=o)},children:[this.state.isResizing&&c.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(C.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Vp=function(e,t){return Vp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)a.hasOwnProperty(n)&&(r[n]=a[n])},Vp(e,t)};function Fz(e,t){Vp(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Mr=function(){return Mr=Object.assign||function(t){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Mr.apply(this,arguments)};function Oz(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}var Mz={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},Lz=function(e){return{bottom:e,bottomLeft:e,bottomRight:e,left:e,right:e,top:e,topLeft:e,topRight:e}},Bz=function(e){Fz(t,e);function t(r){var a=e.call(this,r)||this;return a.resizingPosition={x:0,y:0},a.offsetFromParent={left:0,top:0},a.resizableElement={current:null},a.originalPosition={x:0,y:0},a.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:r.maxWidth,maxHeight:r.maxHeight},a.onResizeStart=a.onResizeStart.bind(a),a.onResize=a.onResize.bind(a),a.onResizeStop=a.onResizeStop.bind(a),a.onDragStart=a.onDragStart.bind(a),a.onDrag=a.onDrag.bind(a),a.onDragStop=a.onDragStop.bind(a),a.getMaxSizesFromProps=a.getMaxSizesFromProps.bind(a),a}return t.prototype.componentDidMount=function(){this.updateOffsetFromParent();var r=this.offsetFromParent,a=r.left,n=r.top,l=this.getDraggablePosition(),o=l.x,f=l.y;this.draggable.setState({x:o-a,y:f-n}),this.forceUpdate()},t.prototype.getDraggablePosition=function(){var r=this.draggable.state,a=r.x,n=r.y;return{x:a,y:n}},t.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},t.prototype.getParentSize=function(){return this.resizable.getParentSize()},t.prototype.getMaxSizesFromProps=function(){var r=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,a=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:r,maxHeight:a}},t.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},t.prototype.getOffsetHeight=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/a;case"body":return document.body.offsetHeight/a;default:return r.offsetHeight}},t.prototype.getOffsetWidth=function(r){var a=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/a;case"body":return document.body.offsetWidth/a;default:return r.offsetWidth}},t.prototype.onDragStart=function(r,a){this.props.onDragStart&&this.props.onDragStart(r,a);var n=this.getDraggablePosition();if(this.originalPosition=n,!!this.props.bounds){var l=this.getParent(),o=this.props.scale,f;if(this.props.bounds==="parent")f=l;else if(this.props.bounds==="body"){var d=l.getBoundingClientRect(),x=d.left,m=d.top,p=document.body.getBoundingClientRect(),v=-(x-l.offsetLeft*o-p.left)/o,y=-(m-l.offsetTop*o-p.top)/o,b=(document.body.offsetWidth-this.resizable.size.width*o)/o+v,S=(document.body.offsetHeight-this.resizable.size.height*o)/o+y;return this.setState({bounds:{top:y,right:b,bottom:S,left:v}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var E=l.getBoundingClientRect(),_=E.left,N=E.top,k=-(_-l.offsetLeft*o)/o,R=-(N-l.offsetTop*o)/o,b=(window.innerWidth-this.resizable.size.width*o)/o+k,S=(window.innerHeight-this.resizable.size.height*o)/o+R;return this.setState({bounds:{top:R,right:b,bottom:S,left:k}})}else typeof this.props.bounds=="string"?f=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(f=this.props.bounds);if(!(!(f instanceof HTMLElement)||!(l instanceof HTMLElement))){var A=f.getBoundingClientRect(),D=A.left,T=A.top,O=l.getBoundingClientRect(),F=O.left,q=O.top,X=(D-F)/o,U=T-q;if(this.resizable){this.updateOffsetFromParent();var ee=this.offsetFromParent;this.setState({bounds:{top:U-ee.top,right:X+(f.offsetWidth-this.resizable.size.width)-ee.left/o,bottom:U+(f.offsetHeight-this.resizable.size.height)-ee.top,left:X-ee.left/o}})}}}},t.prototype.onDrag=function(r,a){if(this.props.onDrag){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(r,Mr(Mr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(r,Mr(Mr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(r,Mr(Mr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onDragStop=function(r,a){if(this.props.onDragStop){var n=this.offsetFromParent,l=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(r,Mr(Mr({},a),{x:a.x+l,y:a.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(r,Mr(Mr({},a),{x:a.x+l,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(r,Mr(Mr({},a),{x:this.originalPosition.x+l,y:a.y+o,deltaX:0}))}},t.prototype.onResizeStart=function(r,a,n){r.stopPropagation(),this.setState({resizing:!0});var l=this.props.scale,o=this.offsetFromParent,f=this.getDraggablePosition();if(this.resizingPosition={x:f.x+o.left,y:f.y+o.top},this.originalPosition=f,this.props.bounds){var d=this.getParent(),x=void 0;this.props.bounds==="parent"?x=d:this.props.bounds==="body"?x=document.body:this.props.bounds==="window"?x=window:typeof this.props.bounds=="string"?x=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(x=this.props.bounds);var m=this.getSelfElement();if(m instanceof Element&&(x instanceof HTMLElement||x===window)&&d instanceof HTMLElement){var p=this.getMaxSizesFromProps(),v=p.maxWidth,y=p.maxHeight,b=this.getParentSize();if(v&&typeof v=="string")if(v.endsWith("%")){var S=Number(v.replace("%",""))/100;v=b.width*S}else v.endsWith("px")&&(v=Number(v.replace("px","")));if(y&&typeof y=="string")if(y.endsWith("%")){var S=Number(y.replace("%",""))/100;y=b.height*S}else y.endsWith("px")&&(y=Number(y.replace("px","")));var E=m.getBoundingClientRect(),_=E.left,N=E.top,k=this.props.bounds==="window"?{left:0,top:0}:x.getBoundingClientRect(),R=k.left,A=k.top,D=this.getOffsetWidth(x),T=this.getOffsetHeight(x),O=a.toLowerCase().endsWith("left"),F=a.toLowerCase().endsWith("right"),q=a.startsWith("top"),X=a.startsWith("bottom");if((O||q)&&this.resizable){var U=(_-R)/l+this.resizable.size.width;this.setState({maxWidth:U>Number(v)?v:U})}if(F||this.props.lockAspectRatio&&!O&&!q){var U=D+(R-_)/l;this.setState({maxWidth:U>Number(v)?v:U})}if((q||O)&&this.resizable){var U=(N-A)/l+this.resizable.size.height;this.setState({maxHeight:U>Number(y)?y:U})}if(X||this.props.lockAspectRatio&&!q&&!O){var U=T+(A-N)/l;this.setState({maxHeight:U>Number(y)?y:U})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(r,a,n)},t.prototype.onResize=function(r,a,n,l){var o=this,f={x:this.originalPosition.x,y:this.originalPosition.y},d=-l.width,x=-l.height,m=["top","left","topLeft","bottomLeft","topRight"];m.includes(a)&&(a==="bottomLeft"?f.x+=d:(a==="topRight"||(f.x+=d),f.y+=x));var p=this.draggable.state;(f.x!==p.x||f.y!==p.y)&&WS.flushSync(function(){o.draggable.setState(f)}),this.updateOffsetFromParent();var v=this.offsetFromParent,y=this.getDraggablePosition().x+v.left,b=this.getDraggablePosition().y+v.top;this.resizingPosition={x:y,y:b},this.props.onResize&&this.props.onResize(r,a,n,l,{x:y,y:b})},t.prototype.onResizeStop=function(r,a,n,l){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),f=o.maxWidth,d=o.maxHeight;this.setState({maxWidth:f,maxHeight:d}),this.props.onResizeStop&&this.props.onResizeStop(r,a,n,l,this.resizingPosition)},t.prototype.updateSize=function(r){this.resizable&&this.resizable.updateSize({width:r.width,height:r.height})},t.prototype.updatePosition=function(r){this.draggable.setState(r)},t.prototype.updateOffsetFromParent=function(){var r=this.props.scale,a=this.getParent(),n=this.getSelfElement();if(!a||n===null)return{top:0,left:0};var l=a.getBoundingClientRect(),o=l.left,f=l.top,d=n.getBoundingClientRect(),x=this.getDraggablePosition(),m=a.scrollLeft,p=a.scrollTop;this.offsetFromParent={left:d.left-o+m-x.x*r,top:d.top-f+p-x.y*r}},t.prototype.render=function(){var r=this,a=this.props,n=a.disableDragging,l=a.style,o=a.dragHandleClassName,f=a.position,d=a.onMouseDown,x=a.onMouseUp,m=a.dragAxis,p=a.dragGrid,v=a.bounds,y=a.enableUserSelectHack,b=a.cancel,S=a.children;a.onResizeStart,a.onResize,a.onResizeStop,a.onDragStart,a.onDrag,a.onDragStop;var E=a.resizeHandleStyles,_=a.resizeHandleClasses,N=a.resizeHandleComponent,k=a.enableResizing,R=a.resizeGrid,A=a.resizeHandleWrapperClass,D=a.resizeHandleWrapperStyle,T=a.scale,O=a.allowAnyClick,F=a.dragPositionOffset,q=Oz(a,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),X=this.props.default?Mr({},this.props.default):void 0;delete q.default;var U=n||o?{cursor:"auto"}:{cursor:"move"},ee=Mr(Mr(Mr({},Mz),U),l),oe=this.offsetFromParent,ce=oe.left,Z=oe.top,ie;f&&(ie={x:f.x-ce,y:f.y-Z});var ke=this.state.resizing?void 0:ie,re=this.state.resizing?"both":m;return C.createElement(Ez,{ref:function(z){z&&(r.draggable=z)},handle:o?".".concat(o):void 0,defaultPosition:X,onMouseDown:d,onMouseUp:x,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:re,disabled:n,grid:p,bounds:v?this.state.bounds:void 0,position:ke,enableUserSelectHack:y,cancel:b,scale:T,allowAnyClick:O,nodeRef:this.resizableElement,positionOffset:F},C.createElement(Dz,Mr({},q,{ref:function(z){z&&(r.resizable=z,r.resizableElement.current=z.resizable)},defaultSize:X,size:this.props.size,enable:typeof k=="boolean"?Lz(k):k,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:ee,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:R,handleWrapperClass:A,handleWrapperStyle:D,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:E,handleClasses:_,handleComponent:N,scale:this.props.scale}),S))},t.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},t}(C.PureComponent);function Pz(){const{tableId:e}=yn(),{eventId:t}=Yr(),{data:r,isLoading:a,error:n}=wu(e),l=iU(e,t),[o,f]=C.useState(()=>{var m;return((m=r==null?void 0:r.layout)==null?void 0:m.reduce((p,v)=>({...p,[v.guestId]:{x:v.x,y:v.y}}),{}))??{}});if(a)return c.jsx(Ka,{});if(n||!r)return c.jsx("p",{children:"Error loading layout."});const d=(m,p)=>{f(v=>({...v,[m]:{x:p.x,y:p.y}}))},x=()=>{const m=Object.entries(o).map(([p,v])=>({guestId:p,x:v.x,y:v.y}));l.mutate({layout:m})};return c.jsxs("div",{className:"relative h-[500px] border bg-gray-50",children:[r.guests.map(m=>{const p=o[m.id]??{x:20,y:20};return c.jsx(Bz,{size:{width:80,height:30},position:p,bounds:"parent",onDragStop:(v,y)=>d(m.id,y),children:c.jsx("div",{className:"p-1 bg-white dark:bg-gray-800 border rounded text-sm",children:m.guestName})},m.id)}),c.jsx("button",{onClick:x,className:"absolute bottom-4 right-4 bg-button text-white px-4 py-2 rounded",children:"Save Layout"})]})}function Iz(){const{tableId:e}=yn(),{data:t,isLoading:r,error:a}=wu(e);return r?c.jsx(Ka,{}):a||!t?c.jsx("p",{children:"Error loading print view."}):c.jsxs("div",{className:"p-4 print:p-0",children:[c.jsxs("h1",{className:"text-2xl font-semibold mb-4",children:["Seating Plan: ",t.name]}),c.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.guests.map(n=>c.jsx("div",{className:"border p-2 flex flex-col items-center print:border-gray-800",children:n.guestName},n.id))})]})}function Uz(){const{tableId:e}=yn(),{data:t,isLoading:r,error:a}=wu(e);return r?c.jsx(Ka,{}):a||!t?c.jsx("p",{children:"Failed to load table."}):c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Guests at ",t.name," (",t.assignedCount,"/",t.capacity,")"]}),c.jsx("ul",{className:"space-y-2",children:t.guests.map(n=>c.jsxs("li",{className:"p-3 bg-white dark:bg-gray-800 rounded shadow",children:[c.jsx("p",{className:"font-medium",children:n.guestName}),c.jsxs("p",{className:"text-sm",children:["Status: ",n.status]}),c.jsxs("p",{className:"text-sm",children:["Type: ",n.guestType]})]},n.id))})]})}const ok="floorplan-";function vS(e){try{const t=localStorage.getItem(ok+e);return t?JSON.parse(t):[]}catch{return[]}}function zz(e,t){localStorage.setItem(ok+e,JSON.stringify(t))}function Hz(e){const[t,r]=C.useState(()=>vS(e)),a=C.useRef(!1);C.useEffect(()=>{r(vS(e)),a.current=!1},[e]),C.useEffect(()=>{if(!a.current){a.current=!0;return}zz(e,t)},[e,t]);const n=C.useCallback(p=>{r(v=>[...v,p])},[]),l=C.useCallback((p,v)=>{r(y=>y.map(b=>b.id===p?{...b,...v}:b))},[]),o=C.useCallback(p=>{r(v=>v.filter(y=>y.id!==p))},[]),f=C.useCallback((p,v=3)=>{r(y=>{const b=y.filter(F=>F.type!=="table"),S=y.filter(F=>F.type==="table"),E=S.filter(F=>p.includes(F.id)),_=Math.max(...E.map(F=>F.width),100),N=Math.max(...E.map(F=>F.height),100),k=_+80,R=N+80,A=60,D=60,T=E.map((F,q)=>({...F,x:A+q%v*k,y:D+Math.floor(q/v)*R})),O=S.filter(F=>!p.includes(F.id));return[...b,...T,...O]})},[]),d=C.useCallback((p,v)=>{if(v==="rect")return{width:Math.max(160,60+p*14),height:70};if(v==="square"){const b=Math.max(90,50+Math.ceil(p/4)*20);return{width:b,height:b}}const y=Math.max(100,60+p*6);return{width:y,height:y}},[]),x=C.useCallback((p,v="round")=>{r(y=>{let b=!1;const S=new Map(p.map(X=>[X.id,X.capacity])),E=y.map(X=>{if(X.type==="table"&&(!X.meta||!X.meta.shape)){b=!0;const U=S.get(X.id)??8,ee=d(U,"round");return{...X,...ee,meta:{...X.meta,shape:"round",capacity:U}}}return X}),_=new Set(E.filter(X=>X.type==="table").map(X=>X.id)),N=p.filter(X=>!_.has(X.id));if(N.length===0)return b?E:y;const k=3,R=260,A=240,D=60,T=60,F=E.filter(X=>X.type==="table").length,q=N.map((X,U)=>{const ee=d(X.capacity,v);return{id:X.id,type:"table",x:D+(F+U)%k*R,y:T+Math.floor((F+U)/k)*A,...ee,meta:{shape:v,capacity:X.capacity}}});return[...E,...q]})},[d]),m=C.useCallback((p,v)=>{r(y=>y.map(b=>{var _;if(b.id!==p||b.type!=="table")return b;const S=((_=b.meta)==null?void 0:_.capacity)??8,E=d(S,v);return{...b,...E,meta:{...b.meta,shape:v}}}))},[d]);return{floorItems:t,setFloorItems:r,addItem:n,updateItem:l,removeItem:o,autoArrange:f,syncTables:x,changeTableShape:m}}function yS(e,t,r){return r?Math.round(e/t)*t:e}const qp=26,An=qp/2,p0=6;function Gz(e,t,r,a){const n=[];if(e==="round"){const l=r/2,o=a/2,f=Math.max(r,a)/2+p0+An;for(let d=0;d<t;d++){const x=2*Math.PI*d/t-Math.PI/2;n.push({x:l+Math.cos(x)*f-An,y:o+Math.sin(x)*f-An})}}else if(e==="rect"){const l=t>=6?1:0,o=t-l*2,f=Math.ceil(o/2),d=o-f;let x=0;for(let m=0;m<f&&x<t;m++,x++)n.push({x:r/(f+1)*(m+1)-An,y:-32});for(let m=0;m<l&&x<t;m++,x++)n.push({x:r+p0,y:a/2-An});for(let m=0;m<d&&x<t;m++,x++)n.push({x:r/(d+1)*(m+1)-An,y:a+p0});for(let m=0;m<l&&x<t;m++,x++)n.push({x:-32,y:a/2-An})}else{const l=Math.ceil(t/4);let o=0;for(let f=0;f<l&&o<t;f++,o++){const d=(f+1)/(l+1);n.push({x:d*r-An,y:-32})}for(let f=0;f<l&&o<t;f++,o++){const d=(f+1)/(l+1);n.push({x:r+p0,y:d*a-An})}for(let f=0;f<l&&o<t;f++,o++){const d=(l-f)/(l+1);n.push({x:d*r-An,y:a+p0})}for(let f=0;f<l&&o<t;f++,o++){const d=(l-f)/(l+1);n.push({x:-32,y:d*a-An})}}return n}const bS=["linear-gradient(135deg, #7c3aed, #a855f7)","linear-gradient(135deg, #ec4899, #f43f5e)","linear-gradient(135deg, #3b82f6, #2563eb)","linear-gradient(135deg, #22c55e, #16a34a)","linear-gradient(135deg, #f97316, #ea580c)","linear-gradient(135deg, #8b5cf6, #6366f1)","linear-gradient(135deg, #06b6d4, #0891b2)","linear-gradient(135deg, #eab308, #ca8a04)"];function Vz(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return bS[Math.abs(t)%bS.length]}const qz=({item:e,table:t,assignedGuests:r,zoom:a,selected:n,snapEnabled:l,snapSize:o,onSelect:f,onMove:d,onDoubleClick:x,onDropGuest:m,onSeatClick:p,onResize:v})=>{var X;const y=C.useRef(!1),b=C.useRef({x:0,y:0}),S=C.useRef(!1),E=C.useCallback(U=>{if(U.button!==0)return;U.stopPropagation(),f(e.id),y.current=!0,S.current=!1,b.current={x:(U.clientX-U.currentTarget.getBoundingClientRect().left)/a,y:(U.clientY-U.currentTarget.getBoundingClientRect().top)/a};const ee=ce=>{if(!y.current)return;S.current=!0;const Z=document.getElementById("floor-canvas-content");if(!Z)return;const ie=Z.getBoundingClientRect(),ke=(ce.clientX-ie.left)/a-b.current.x,re=(ce.clientY-ie.top)/a-b.current.y;d(e.id,yS(ke,o,l),yS(re,o,l))},oe=()=>{y.current=!1,window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",oe)};window.addEventListener("mousemove",ee),window.addEventListener("mouseup",oe)},[e.id,a,l,o,f,d]),_=C.useCallback(U=>{U.stopPropagation(),S.current||x(e.id)},[e.id,x]),N=C.useCallback(U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},[]),k=C.useCallback(U=>{U.preventDefault();const ee=U.dataTransfer.getData("guestId");ee&&t&&m(t.id,ee)},[t,m]);if(!t)return null;const R=t.capacity||8,A=r.length,D=((X=e.meta)==null?void 0:X.shape)||"round",T=Vz(e.id),F=D==="round"?"50%":D==="rect"?12:8,q=Gz(D,R,e.width,e.height);return c.jsxs("div",{style:{position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",zIndex:n?100:10,transition:"box-shadow 0.2s, transform 0.1s"},onMouseDown:E,onDoubleClick:_,onDragOver:N,onDrop:k,children:[q.map((U,ee)=>{var ie;const oe=r[ee],ce=!!oe,Z=(oe==null?void 0:oe.flag)==="VIP";return c.jsx("div",{title:ce?`${oe.name}  click to unassign`:`Seat ${ee+1}  click to assign`,onClick:ke=>{ke.stopPropagation();const re=ke.currentTarget.getBoundingClientRect();p(e.id,ee,ce?oe.id:null,re.left+re.width/2,re.top)},style:{position:"absolute",left:U.x,top:U.y,width:qp,height:qp,borderRadius:"50%",border:ce?Z?"2px solid #a855f7":"2px solid #22c55e":"2px dashed #cbd5e1",background:ce?Z?"linear-gradient(135deg, #a855f7, #7c3aed)":"linear-gradient(135deg, #22c55e, #16a34a)":"white",color:ce?"white":"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,cursor:"pointer",transition:"all 0.2s",zIndex:2},children:ce?((ie=oe.name)==null?void 0:ie[0])??"G":ee+1},ee)}),c.jsxs("div",{style:{width:"100%",height:"100%",background:T,borderRadius:F,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",outline:n?"3px solid #4f46e5":"none",outlineOffset:n?4:void 0,boxShadow:n?"0 12px 30px rgba(79, 70, 229, 0.3)":"0 4px 12px rgba(0, 0, 0, 0.08)",transition:"box-shadow 0.2s, outline 0.15s"},children:[c.jsx("span",{style:{color:"white",fontSize:14,lineHeight:1},children:A>=R?"":""}),c.jsx("span",{style:{color:"white",fontSize:10,fontWeight:700,marginTop:2,letterSpacing:.3},children:t.name}),c.jsxs("span",{style:{color:"rgba(255,255,255,0.75)",fontSize:9,fontWeight:500},children:[A,"/",R]})]}),n&&c.jsx("div",{onMouseDown:U=>{U.stopPropagation(),U.preventDefault();const ee=U.clientX,oe=U.clientY,ce=e.width,Z=e.height,ie=re=>{const z=(re.clientX-ee)/a,te=(re.clientY-oe)/a;v(e.id,Math.max(50,ce+z),Math.max(50,Z+te))},ke=()=>{window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",ke)};window.addEventListener("mousemove",ie),window.addEventListener("mouseup",ke)},style:{position:"absolute",bottom:-6,right:-6,width:14,height:14,background:"white",border:"2px solid #4f46e5",borderRadius:3,cursor:"nwse-resize",zIndex:10}})]})},Wz=({item:e,zoom:t,selected:r,onSelect:a,onMove:n,onResize:l})=>{const o=C.useRef(!1),f=C.useRef({x:0,y:0}),d=C.useCallback(b=>{if(b.button!==0)return;b.stopPropagation(),a(e.id),o.current=!0,f.current={x:(b.clientX-b.currentTarget.getBoundingClientRect().left)/t,y:(b.clientY-b.currentTarget.getBoundingClientRect().top)/t};const S=_=>{if(!o.current)return;const N=document.getElementById("floor-canvas-content");if(!N)return;const k=N.getBoundingClientRect(),R=(_.clientX-k.left)/t-f.current.x,A=(_.clientY-k.top)/t-f.current.y;n(e.id,R,A)},E=()=>{o.current=!1,window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",E)};window.addEventListener("mousemove",S),window.addEventListener("mouseup",E)},[e.id,t,a,n]),x=e.type==="stage",m=e.type==="danceFloor",p=e.type==="pillar";let v={position:"absolute",left:e.x,top:e.y,width:e.width,height:e.height,cursor:"move",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:500,fontSize:10,zIndex:r?50:5,transition:"box-shadow 0.2s"};x?v={...v,background:"linear-gradient(135deg, #4f46e5, #7c3aed)",color:"white",fontWeight:600,letterSpacing:2,textTransform:"uppercase",fontSize:12,borderRadius:"4px 4px 40px 40px"}:m?v={...v,background:"repeating-conic-gradient(from 0deg, #f8fafc 0deg 90deg, #e0e7ff 90deg 180deg)",backgroundSize:"40px 40px",border:"3px solid #e2e8f0",borderRadius:8,color:"#64748b",fontSize:11}:p?v={...v,background:"radial-gradient(circle at 30% 30%, #78716c, #57534e)",border:"3px solid #44403c",borderRadius:"50%",boxShadow:"inset 0 -3px 8px rgba(0,0,0,0.3)",color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"}:v={...v,background:"repeating-linear-gradient(45deg, #64748b, #64748b 10px, #475569 10px, #475569 20px)",border:"2px solid #334155",borderRadius:4,color:"white",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},r&&(v.outline="3px solid #4f46e5",v.outlineOffset=4,v.boxShadow="0 8px 25px rgba(79, 70, 229, 0.25)");const y=x?" Stage":m?" Dance Floor":p?"":" Wall";return c.jsxs("div",{style:v,onMouseDown:d,onClick:b=>{b.stopPropagation(),a(e.id)},children:[e.type==="wall"&&e.height>e.width?c.jsx("span",{style:{transform:"rotate(90deg)",whiteSpace:"nowrap"},children:y}):y,r&&c.jsx("div",{onMouseDown:b=>{b.stopPropagation(),b.preventDefault();const S=b.clientX,E=b.clientY,_=e.width,N=e.height,k=A=>{const D=(A.clientX-S)/t,T=(A.clientY-E)/t,O=p?20:30;l(e.id,Math.max(O,_+D),Math.max(O,N+T))},R=()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",R)};window.addEventListener("mousemove",k),window.addEventListener("mouseup",R)},style:{position:"absolute",bottom:-6,right:-6,width:14,height:14,background:"white",border:"2px solid #4f46e5",borderRadius:3,cursor:"nwse-resize",zIndex:10}})]})},Xz=({floorItems:e,tables:t,guests:r,zoom:a,panX:n,panY:l,selectedId:o,snapEnabled:f,snapSize:d,toolMode:x,onZoomChange:m,onPanChange:p,onSelect:v,onMoveItem:y,onDoubleClickTable:b,onDropGuest:S,onDeleteSelected:E,onCanvasClick:_,onSeatClick:N,onResizeItem:k})=>{var te,B;const R=C.useRef(null),A=C.useRef(!1),D=C.useRef({x:0,y:0,px:0,py:0}),[T,O]=C.useState(!0);C.useEffect(()=>{o&&R.current&&R.current.focus()},[o]),C.useEffect(()=>{const I=setTimeout(()=>O(!1),8e3);return()=>clearTimeout(I)},[]),C.useEffect(()=>{const I=R.current;if(!I)return;const M=W=>{W.preventDefault();const ne=W.deltaY>0?-.1:.1;m(Math.min(2,Math.max(.3,a+ne)))};return I.addEventListener("wheel",M,{passive:!1}),()=>I.removeEventListener("wheel",M)},[a,m]);const F=C.useCallback(I=>{var W;if(!I.target.closest("[data-floor-item]")){if(x!=="select"){const ne=(W=R.current)==null?void 0:W.getBoundingClientRect();if(ne){const ye=(I.clientX-ne.left-n)/a,be=(I.clientY-ne.top-l)/a,Se=f?Math.round(ye/d)*d:ye,Ne=f?Math.round(be/d)*d:be;_(Se,Ne)}return}v(null),A.current=!0,D.current={x:I.clientX,y:I.clientY,px:n,py:l}}},[n,l,a,f,d,x,v,_]),q=C.useCallback(I=>{if(!A.current)return;const M=I.clientX-D.current.x,W=I.clientY-D.current.y;p(D.current.px+M,D.current.py+W)},[p]),X=C.useCallback(()=>{A.current=!1},[]),U=C.useCallback(I=>{(I.key==="Delete"||I.key==="Backspace")&&E(),I.key==="Escape"&&v(null)},[E,v]),ee=new Map(t.map(I=>[I.id,I])),oe=180,ce=120,Z=2e3,ie=1400,ke=oe/Z,re=18,z=C.useCallback(I=>{I.stopPropagation(),I.preventDefault();const M=I.currentTarget.getBoundingClientRect(),W=(be,Se)=>{var Ct,Pt;const Ne=be-M.left,Xe=Se-M.top-re,V=Ne/ke,We=Xe/ke,$e=((Ct=R.current)==null?void 0:Ct.clientWidth)??800,dt=((Pt=R.current)==null?void 0:Pt.clientHeight)??500,Je=-(V*a)+$e/2,Oe=-(We*a)+dt/2;p(Je,Oe)};W(I.clientX,I.clientY);const ne=be=>W(be.clientX,be.clientY),ye=()=>{window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",ye)};window.addEventListener("mousemove",ne),window.addEventListener("mouseup",ye)},[a,ke,p]);return c.jsxs("div",{ref:R,className:"floor-canvas flex-1 rounded-xl overflow-hidden border border-gray-200 dark:border-gray-700 shadow-lg bg-white dark:bg-slate-900 relative",style:{background:`
          linear-gradient(90deg, rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(rgba(79,70,229,0.05) 1px, transparent 1px),
          linear-gradient(to bottom right, #f8fafc, #f1f5f9)`,backgroundSize:"40px 40px, 40px 40px, 100% 100%",cursor:x!=="select"?"crosshair":A.current?"grabbing":"grab",minHeight:400},tabIndex:0,onMouseDown:F,onMouseMove:q,onMouseUp:X,onMouseLeave:X,onKeyDown:U,children:[c.jsx("div",{id:"floor-canvas-content",style:{transform:`translate(${n}px, ${l}px) scale(${a})`,transformOrigin:"0 0",width:Z,height:ie,position:"absolute",top:0,left:0},children:e.map(I=>{if(I.type==="table"){const M=ee.get(I.id),W=r.filter(ne=>ne.tableId===I.id);return c.jsx("div",{"data-floor-item":!0,children:c.jsx(qz,{item:I,table:M,assignedGuests:W,zoom:a,selected:o===I.id,snapEnabled:f,snapSize:d,onSelect:v,onMove:y,onDoubleClick:b,onDropGuest:S,onSeatClick:N,onResize:k})},I.id)}return c.jsx("div",{"data-floor-item":!0,children:c.jsx(Wz,{item:I,zoom:a,selected:o===I.id,onSelect:v,onMove:y,onResize:k})},I.id)})}),T&&c.jsxs("div",{className:"absolute top-3 left-3 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-gray-200/80 dark:border-gray-700/80 rounded-lg px-3 py-2.5 shadow-lg max-w-[240px] z-20 animate-fade-in",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[c.jsx("p",{className:"text-xs font-semibold text-slate-700 dark:text-slate-200",children:"Quick Tips"}),c.jsx("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition -mt-0.5",onClick:()=>O(!1),children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("ul",{className:"text-[10px] text-gray-500 dark:text-gray-400 space-y-0.5 leading-relaxed",children:[c.jsx("li",{children:"Drag tables to reposition"}),c.jsx("li",{children:"Double-click table to edit"}),c.jsx("li",{children:"Click seats to assign/unassign guests"}),c.jsx("li",{children:"Drag corner handle to resize"}),c.jsxs("li",{children:["Select + ",c.jsx("kbd",{className:"px-1 py-px bg-gray-100 dark:bg-slate-700 rounded text-[9px] font-mono",children:"Del"})," to remove obstacles"]}),c.jsx("li",{children:"Scroll to zoom, drag minimap to navigate"})]})]}),c.jsxs("div",{className:"absolute bottom-3 right-3 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border border-gray-200/80 dark:border-gray-700/80 rounded-lg overflow-hidden shadow-md z-20",style:{width:oe,height:ce+re,cursor:"pointer"},onMouseDown:z,children:[c.jsx("div",{className:"px-2 py-0.5 text-[8px] text-gray-400 dark:text-gray-500 uppercase tracking-wider border-b border-gray-100 dark:border-gray-700/50 bg-gray-50/80 dark:bg-slate-900/50 font-medium select-none",children:"Overview  drag to navigate"}),c.jsxs("div",{className:"relative",style:{height:ce},children:[e.map(I=>{const M=I.type==="table",W=M?"#7c3aed":I.type==="stage"?"#4f46e5":I.type==="danceFloor"?"#c7d2fe":"#64748b";return c.jsx("div",{style:{position:"absolute",left:I.x*ke,top:I.y*ke,width:Math.max(4,I.width*ke),height:Math.max(4,I.height*ke),background:W,borderRadius:M||I.type==="pillar"?"50%":2,pointerEvents:"none"}},I.id)}),c.jsx("div",{style:{position:"absolute",border:"2px solid #4f46e5",background:"rgba(79, 70, 229, 0.1)",borderRadius:2,pointerEvents:"none",left:Math.max(0,-n/a)*ke,top:Math.max(0,-l/a)*ke,width:(((te=R.current)==null?void 0:te.clientWidth)??800)/a*ke,height:(((B=R.current)==null?void 0:B.clientHeight)??500)/a*ke}})]})]})]})},wS=({guests:e,tables:t})=>{const[r,a]=C.useState(""),[n,l]=C.useState(null),o=C.useMemo(()=>e.filter(m=>!m.tableId),[e]),f=C.useMemo(()=>e.filter(m=>!!m.tableId),[e]),d=C.useMemo(()=>{if(!r)return o;const m=r.toLowerCase();return o.filter(p=>{var v;return p.name.toLowerCase().includes(m)||((v=p.phoneNo)==null?void 0:v.toLowerCase().includes(m))})},[o,r]),x=C.useMemo(()=>new Map(t.map(m=>[m.id,m.name])),[t]);return c.jsxs("div",{className:"w-80 flex-shrink-0 bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4 text-primary",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),c.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:"Guests"})]}),c.jsxs("div",{className:"flex gap-1",children:[c.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-semibold rounded-full bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400",children:[f.length," seated"]}),c.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-semibold rounded-full bg-amber-50 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400",children:[o.length," pending"]})]})]}),c.jsx("div",{className:"px-3 py-2 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"relative",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),c.jsx("input",{type:"text",placeholder:"Search guests...",value:r,onChange:m=>a(m.target.value),className:"w-full border border-gray-200 dark:border-gray-600 rounded-lg pl-8 pr-3 py-1.5 text-xs bg-gray-50 dark:bg-slate-800 text-slate-800 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition"})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",style:{scrollbarWidth:"thin"},children:[c.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-yellow-600 dark:text-yellow-400 font-semibold flex items-center gap-1 mb-2",children:[" Unassigned (",o.length,")"]}),d.length===0?c.jsx("div",{className:"text-center py-6",children:c.jsx("p",{className:"text-sm text-slate-400",children:r?"No matches found":"All guests are assigned!"})}):d.map(m=>c.jsxs("div",{draggable:!0,onDragStart:p=>{p.dataTransfer.effectAllowed="move",p.dataTransfer.setData("guestId",m.id),l(m.id)},onDragEnd:()=>l(null),className:`p-3 rounded-lg border-2 border-dashed border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-slate-800 cursor-grab hover:border-primary hover:bg-indigo-50 dark:hover:bg-primary/10 transition-all ${n===m.id?"opacity-50":""}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),(m.pax??1)>0&&c.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400",children:[m.pax??1," pax"]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[m.phoneNo&&c.jsxs("span",{children:[" ",m.phoneNo]}),m.flag==="VIP"&&c.jsx("span",{className:"px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]})]},m.id)),f.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-[10px] uppercase tracking-wider text-green-600 dark:text-green-400 font-semibold flex items-center gap-1 mt-4 mb-2",children:[" Assigned (",f.length,")"]}),f.slice(0,5).map(m=>c.jsx("div",{className:"p-3 rounded-lg border border-green-200 dark:border-green-800 bg-green-50/50 dark:bg-green-900/20",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-sm text-slate-800 dark:text-white",children:m.name}),c.jsxs("p",{className:"text-[10px] text-green-600 dark:text-green-400",children:[x.get(m.tableId??"")??"Table","  Seat ",m.seatIndex??"?"]})]}),c.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:[m.pax??1," pax"]})]})},m.id)),f.length>5&&c.jsxs("p",{className:"text-center text-xs text-gray-400 py-2",children:["+ ",f.length-5," more assigned..."]})]})]})]})};let Yz=0;function $z(){return`fp-${Date.now()}-${++Yz}`}function Kz(){var Re;const{eventId:e}=Yr(),{data:t=[],isLoading:r}=ah(e??""),{data:a=[],isLoading:n}=rh(e??""),l=t1(e??""),o=r1(e??""),f=J_(e??""),{floorItems:d,addItem:x,updateItem:m,removeItem:p,autoArrange:v,syncTables:y,changeTableShape:b}=Hz(e??""),[S,E]=C.useState(1),[_,N]=C.useState(0),[k,R]=C.useState(0),[A,D]=C.useState(null),[T,O]=C.useState(!0),[F,q]=C.useState("select"),[X,U]=C.useState(!1),[ee,oe]=C.useState(null),[ce,Z]=C.useState(null),[ie,ke]=C.useState(!1),[re,z]=C.useState(null),te=40,B=bl.useRef(null),I=bl.useRef(null);C.useEffect(()=>{if(t.length>0){const xe=I.current||"round";y(t.map(Be=>({id:Be.id,capacity:Be.capacity||8})),xe),I.current=null}},[t,y]),C.useEffect(()=>{if(!ce)return;const xe=setTimeout(()=>Z(null),2500);return()=>clearTimeout(xe)},[ce]);const M=C.useCallback((xe,Be="")=>{Z({message:xe,icon:Be})},[]),W=C.useCallback((xe,Be)=>{N(xe),R(Be)},[]),ne=C.useCallback((xe,Be,He)=>{m(xe,{x:Be,y:He})},[m]),ye=C.useCallback((xe,Be,He)=>{m(xe,{width:Be,height:He})},[m]),be=C.useCallback(xe=>{D(xe)},[]),Se=C.useCallback(()=>{if(!A)return;const xe=d.find(Be=>Be.id===A);if(xe){if(xe.type==="table"){f.mutate(A,{onSuccess:()=>{p(A),D(null),M("Table deleted","")},onError:()=>M("Failed to delete table","")});return}p(A),D(null),M("Element removed","")}},[A,d,p,f,M]),Ne=C.useCallback(xe=>{oe(xe),U(!0)},[]),Xe=C.useCallback(xe=>{if(xe==="select"){q("select");return}if(A){const Be=d.find(He=>He.id===A);if((Be==null?void 0:Be.type)==="table"){b(A,xe),M(`Table shape changed to ${xe}`,"");return}}q(xe),M(`Click on canvas to place ${xe} table`,"")},[A,d,b,M]),V=C.useCallback((xe,Be,He,Kt,Dr)=>{He?o.mutate(He,{onSuccess:()=>M("Guest unassigned",""),onError:()=>M("Failed to unassign guest","")}):z({tableId:xe,seatIndex:Be,guestId:null,anchorX:Kt,anchorY:Dr})},[o,M]),We=C.useCallback(xe=>{re&&(l.mutate({guestId:xe,tableId:re.tableId},{onSuccess:()=>M("Guest assigned!",""),onError:()=>M("Failed to assign guest","")}),z(null))},[re,l,M]),$e=C.useCallback((xe,Be)=>{l.mutate({guestId:Be,tableId:xe},{onSuccess:()=>M("Guest assigned!",""),onError:()=>M("Failed to assign guest","")})},[l,M]),dt=C.useCallback(()=>{v(t.map(xe=>xe.id)),M("Tables auto-arranged","")},[v,t,M]),Je=C.useCallback(xe=>{const Be={stage:{w:280,h:50},danceFloor:{w:180,h:160},pillar:{w:45,h:45},wall:{w:80,h:40}},He={stage:"",danceFloor:"",pillar:"",wall:""},Kt=Be[xe]??{w:100,h:100};x({id:$z(),type:xe,x:200+Math.random()*200,y:100+Math.random()*200,width:Kt.w,height:Kt.h}),M(`${xe==="danceFloor"?"Dance floor":xe.charAt(0).toUpperCase()+xe.slice(1)} added!`,He[xe]??"")},[x,M]),Oe=C.useCallback((xe,Be)=>{F!=="select"&&(B.current={x:xe,y:Be,shape:F},oe(null),U(!0))},[F]),Ct=C.useCallback(()=>{U(!1),oe(null),B.current&&(I.current=B.current.shape,B.current=null,q("select"))},[]),Pt=C.useCallback(()=>{M("Layout saved!","")},[M]),Rr=C.useCallback(()=>{E(1),N(0),R(0),M("View reset","")},[M]),St=C.useMemo(()=>a.filter(xe=>!xe.tableId).length,[a]),wn=a.length-St,ha=t.reduce((xe,Be)=>xe+(Be.capacity||0),0),ur=ee?t.find(xe=>xe.id===ee):void 0,qt=A?d.find(xe=>xe.id===A):null,_r=(qt==null?void 0:qt.type)==="table"?t.find(xe=>xe.id===A):null,ir=(qt==null?void 0:qt.type)==="table"?((Re=qt.meta)==null?void 0:Re.shape)||"round":null;if(!e)return c.jsx(Gl,{title:"No Event Selected",message:"Select or create an event to start designing your floor plan."});const Et=xe=>`p-1.5 rounded-md transition-all ${xe?"bg-primary text-white shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-white dark:hover:bg-slate-700"}`,De="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 transition";return c.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[c.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-3 px-5 pt-4 pb-2 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white tracking-tight",children:"Floor Plan"}),c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400",children:[c.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-400"}),t.length," tables"]}),c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400",children:[wn,"/",ha," seated"]}),St>0&&c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-semibold bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400",children:[St," unassigned"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:dt,className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold bg-emerald-500 text-white hover:bg-emerald-600 shadow-sm transition active:scale-[0.97]",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3.5 w-3.5",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})}),c.jsx("span",{className:"hidden sm:inline",children:"Auto-Arrange"})]}),c.jsxs("button",{onClick:()=>{oe(null),U(!0)},className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold bg-primary text-white hover:brightness-110 shadow-sm transition active:scale-[0.97]",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3.5 w-3.5",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),c.jsx("span",{className:"hidden sm:inline",children:"New Table"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2 px-5 py-1.5 overflow-x-auto",children:[c.jsxs("div",{className:"flex items-center gap-0.5 p-0.5 rounded-lg bg-gray-100/80 dark:bg-slate-800/80 border border-gray-200/60 dark:border-gray-700/60",children:[c.jsx("button",{onClick:()=>Xe("round"),className:Et(F==="round"),title:"Round table",children:c.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${F==="round"?"border-white/60":"border-primary/60"}`})}),c.jsx("button",{onClick:()=>Xe("rect"),className:Et(F==="rect"),title:"Long table",children:c.jsx("div",{className:`w-6 h-3.5 rounded-sm border-2 ${F==="rect"?"border-white/60":"border-secondary/60"}`})}),c.jsx("button",{onClick:()=>Xe("square"),className:Et(F==="square"),title:"Square table",children:c.jsx("div",{className:`w-4 h-4 rounded-sm border-2 ${F==="square"?"border-white/60":"border-emerald-500/60"}`})}),c.jsx("div",{className:"w-px h-5 bg-gray-300/50 dark:bg-gray-600/50 mx-0.5"}),c.jsx("button",{onClick:()=>Je("stage"),className:Et(!1),title:"Add stage",children:c.jsx("span",{className:"text-sm leading-none",children:""})}),c.jsx("button",{onClick:()=>Je("danceFloor"),className:Et(!1),title:"Add dance floor",children:c.jsx("span",{className:"text-sm leading-none",children:""})}),c.jsx("div",{className:"w-px h-5 bg-gray-300/50 dark:bg-gray-600/50 mx-0.5"}),c.jsx("button",{onClick:()=>Je("wall"),className:Et(!1),title:"Add wall",children:c.jsx("div",{className:"w-5 h-3.5 rounded-sm bg-gradient-to-br from-slate-400 to-slate-600"})}),c.jsx("button",{onClick:()=>Je("pillar"),className:Et(!1),title:"Add pillar",children:c.jsx("div",{className:"w-4 h-4 rounded-full bg-gradient-to-br from-stone-400 to-stone-600"})})]}),qt&&c.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-100 dark:border-indigo-800 animate-fade-in",children:[c.jsx("span",{className:"text-[11px] font-semibold text-indigo-600 dark:text-indigo-400 whitespace-nowrap",children:qt.type==="table"?(_r==null?void 0:_r.name)??"Table":qt.type==="stage"?"Stage":qt.type==="danceFloor"?"Dance Floor":qt.type==="pillar"?"Pillar":"Wall"}),qt.type==="table"&&c.jsx("div",{className:"flex items-center gap-0.5 ml-1 p-0.5 rounded bg-indigo-100/80 dark:bg-indigo-800/40",children:["round","rect","square"].map(xe=>c.jsxs("button",{onClick:()=>b(A,xe),className:`p-1 rounded transition ${ir===xe?"bg-white dark:bg-indigo-700 shadow-sm":"hover:bg-white/60 dark:hover:bg-indigo-700/40"}`,title:`Change to ${xe}`,children:[xe==="round"&&c.jsx("div",{className:"w-3 h-3 rounded-full border-2 border-indigo-500"}),xe==="rect"&&c.jsx("div",{className:"w-5 h-2.5 rounded-sm border-2 border-indigo-500"}),xe==="square"&&c.jsx("div",{className:"w-3 h-3 rounded-sm border-2 border-indigo-500"})]},xe))}),c.jsxs("button",{onClick:Se,disabled:f.isPending,className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[11px] font-medium text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition disabled:opacity-50",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),f.isPending?"Deleting...":"Delete"]}),c.jsx("button",{onClick:()=>D(null),className:"ml-0.5 p-0.5 rounded text-indigo-400 hover:text-indigo-600 dark:hover:text-indigo-300 transition",title:"Deselect",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-3 w-3",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"ml-auto flex items-center gap-1.5",children:[c.jsxs("div",{className:"flex items-center rounded-lg bg-white dark:bg-slate-800 border border-gray-200 dark:border-gray-700 overflow-hidden",children:[c.jsx("button",{onClick:()=>E(xe=>Math.max(.3,+(xe-.1).toFixed(1))),className:"px-2 py-1 text-sm text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:""}),c.jsxs("span",{className:"px-2 py-1 text-[11px] font-medium text-gray-600 dark:text-gray-300 min-w-[42px] text-center border-x border-gray-200 dark:border-gray-700",children:[Math.round(S*100),"%"]}),c.jsx("button",{onClick:()=>E(xe=>Math.min(2,+(xe+.1).toFixed(1))),className:"px-2 py-1 text-sm text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-700 transition",children:"+"})]}),c.jsxs("button",{onClick:()=>O(xe=>!xe),className:`px-2 py-1.5 rounded-lg text-[11px] font-semibold border transition ${T?"bg-primary/10 border-primary/30 text-primary dark:bg-primary/20":"bg-white dark:bg-slate-800 border-gray-200 dark:border-gray-700 text-gray-500 dark:text-gray-400"}`,title:`Snap to grid: ${T?"ON":"OFF"}`,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-3.5 w-3.5 inline-block mr-0.5 -mt-px",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z"})}),"Snap"]}),c.jsx("button",{onClick:Rr,className:De,title:"Reset view",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"})})}),c.jsx("div",{className:"w-px h-5 bg-gray-200 dark:bg-gray-700"}),c.jsx("button",{onClick:Pt,className:De,title:"Save layout",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"})})}),c.jsx("button",{onClick:()=>window.print(),className:De,title:"Print layout",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z"})})})]})]}),c.jsx("div",{className:"flex-1 flex gap-3 overflow-hidden px-5 pb-4 min-h-0",children:r||n?c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-3 text-primary animate-fade-in",children:[c.jsx(Un,{}),c.jsx("p",{className:"text-sm text-text/50 dark:text-white/50",children:"Loading floor plan..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Xz,{floorItems:d,tables:t,guests:a,zoom:S,panX:_,panY:k,selectedId:A,snapEnabled:T,snapSize:te,toolMode:F,onZoomChange:E,onPanChange:W,onSelect:be,onMoveItem:ne,onDoubleClickTable:Ne,onDropGuest:$e,onDeleteSelected:Se,onCanvasClick:Oe,onSeatClick:V,onResizeItem:ye}),c.jsx("div",{className:"hidden lg:flex h-full",children:c.jsx(wS,{guests:a,tables:t.map(xe=>({id:xe.id,name:xe.name}))})}),c.jsxs("button",{onClick:()=>ke(!0),className:"lg:hidden fixed bottom-6 left-6 z-40 bg-primary text-white px-4 py-3 rounded-full shadow-lg shadow-primary/25 flex items-center gap-2 hover:brightness-110 transition active:scale-95",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),c.jsx("span",{className:"text-sm font-semibold",children:"Guests"}),St>0&&c.jsx("span",{className:"bg-amber-400 text-amber-900 text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:St})]})]})}),c.jsx(nh,{isOpen:X,onClose:Ct,initial:ur?{id:ur.id,name:ur.name,capacity:ur.capacity}:void 0}),ie&&c.jsxs("div",{className:"lg:hidden fixed inset-0 z-50 flex",children:[c.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>ke(!1)}),c.jsxs("div",{className:"relative ml-auto h-full w-80 max-w-[85vw] animate-slide-left",children:[c.jsx("button",{onClick:()=>ke(!1),className:"absolute top-3 right-3 z-10 bg-gray-100 dark:bg-slate-700 rounded-full w-8 h-8 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-slate-600 transition",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"h-4 w-4",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),c.jsx(wS,{guests:a,tables:t.map(xe=>({id:xe.id,name:xe.name}))})]})]}),re&&c.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>z(null),children:c.jsxs("div",{className:"absolute bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 w-64 max-h-72 overflow-hidden flex flex-col animate-fade-in",style:{left:Math.min(re.anchorX-128,window.innerWidth-272),top:Math.max(8,re.anchorY-280)},onClick:xe=>xe.stopPropagation(),children:[c.jsxs("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-slate-900",children:[c.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:"Assign Guest to Seat"}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Seat #",re.seatIndex+1]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-0.5",style:{scrollbarWidth:"thin"},children:a.filter(xe=>!xe.tableId).length===0?c.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No unassigned guests"}):a.filter(xe=>!xe.tableId).map(xe=>c.jsxs("button",{onClick:()=>We(xe.id),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-indigo-50 dark:hover:bg-slate-700 transition flex items-center justify-between group",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-white",children:xe.name}),xe.flag==="VIP"&&c.jsx("span",{className:"ml-2 px-1.5 py-0.5 rounded bg-amber-400 text-white text-[10px] font-bold",children:"VIP"})]}),c.jsxs("span",{className:"text-xs text-gray-400 group-hover:text-primary",children:[xe.pax??1," pax"]})]},xe.id))})]})}),ce&&c.jsxs("div",{className:"fixed bottom-6 right-6 z-50 bg-slate-800 dark:bg-slate-700 text-white px-5 py-3 rounded-xl shadow-2xl flex items-center gap-2.5 animate-slide-up text-sm",children:[c.jsx("span",{className:"text-base",children:ce.icon}),c.jsx("span",{children:ce.message})]})]})}function Qz(){const e=_a();return c.jsxs(pN,{children:[c.jsx(lt,{path:"/rsvp/submit/:token",element:c.jsx(Jw,{})}),c.jsxs(lt,{element:c.jsx(jA,{}),children:[c.jsx(lt,{path:"/",element:c.jsx(fA,{})}),c.jsx(lt,{path:"/login",element:c.jsx(dA,{})}),c.jsx(lt,{path:"/events",element:c.jsx(lz,{})}),c.jsx(lt,{path:"/rsvp",element:c.jsx(Jw,{})}),c.jsx(lt,{path:"/rsvp/share/:token",element:c.jsx(tU,{})})]}),c.jsxs(lt,{path:"/app",element:c.jsx(M6,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(ym,{to:"dashboard",replace:!0})}),c.jsx(lt,{path:"dashboard",element:c.jsx(JU,{})}),c.jsxs(lt,{path:"events",element:c.jsx(As,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(L6,{})}),c.jsx(lt,{path:"new",element:c.jsx(qd,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(lt,{path:":id/edit",element:c.jsx(B6,{})}),c.jsx(lt,{path:":id/form-fields",element:c.jsx(fz,{})})]}),c.jsxs(lt,{path:"rsvps",element:c.jsx(As,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(LI,{})}),c.jsx(lt,{path:"designer",element:c.jsx(eU,{})}),c.jsx(lt,{path:"new",element:c.jsx(oz,{})}),c.jsx(lt,{path:":id/edit",element:c.jsx(cz,{})})]}),c.jsx(lt,{path:"guests",element:c.jsx(uU,{})}),c.jsxs(lt,{path:"tables",element:c.jsx(As,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(gU,{})}),c.jsx(lt,{path:"floorplan",element:c.jsx(Kz,{})}),c.jsx(lt,{path:"new",element:c.jsx(nh,{isOpen:!0,onClose:()=>e(-1)})}),c.jsxs(lt,{path:":tableId",element:c.jsx(hz,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(Uz,{})}),c.jsx(lt,{path:"assignments",element:c.jsx(dz,{})}),c.jsx(lt,{path:"layout",element:c.jsx(Pz,{})}),c.jsx(lt,{path:"print",element:c.jsx(Iz,{})}),c.jsx(lt,{path:"edit",element:c.jsx(vU,{})})]})]}),c.jsxs(lt,{path:"seating",element:c.jsx(As,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(_U,{})}),c.jsx(lt,{path:"new",element:c.jsx(a1,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(lt,{path:":id/edit",element:c.jsx(kU,{})})]}),c.jsxs(lt,{path:"users",element:c.jsx(As,{}),children:[c.jsx(lt,{index:!0,element:c.jsx(RU,{})}),c.jsx(lt,{path:"new",element:c.jsx(n1,{isOpen:!0,onClose:()=>e(-1)})}),c.jsx(lt,{path:":id/edit",element:c.jsx(DU,{})})]}),c.jsx(lt,{path:"wallet",element:c.jsx($U,{})}),c.jsx(lt,{path:"*",element:c.jsx(ym,{to:"/app/dashboard",replace:!0})})]}),c.jsx(lt,{path:"*",element:c.jsx(ym,{to:"/",replace:!0})})]})}function Zz(){return c.jsx(ZN,{children:c.jsx(cA,{children:c.jsx(zN,{children:c.jsx(Qz,{})})})})}const Jz=new VC;ET.createRoot(document.getElementById("root")).render(c.jsx(C.StrictMode,{children:c.jsxs($C,{client:Jz,children:[c.jsx(OA,{children:c.jsx(Zz,{})}),c.jsx(AI,{position:"top-right"})]})}));
